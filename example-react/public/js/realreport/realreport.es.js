var extendStatics$1=function(e,t){return extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},extendStatics$1(e,t)};function __extends$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}extendStatics$1(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var __assign$1=function(){return __assign$1=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},__assign$1.apply(this,arguments)};function __awaiter$1(e,t,i,r){return new(i||(i=Promise))((function(s,n){function o(e){try{A(r.next(e))}catch(e){n(e)}}function a(e){try{A(r.throw(e))}catch(e){n(e)}}function A(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}A((r=r.apply(e,t||[])).next())}))}function __generator$1(e,t){var i,r,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,r&&(s=2&n[0]?r.return:n[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,n[1])).done)return s;switch(r=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,r=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){o.label=n[1];break}if(6===n[0]&&o.label<s[1]){o.label=s[1],s=n;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(n);break}s[2]&&o.ops.pop(),o.trys.pop();continue}n=t.call(e,o)}catch(e){n=[6,e],r=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}const $_instanceOf=function(e,t){return"object"==typeof e&&Object.prototype.toString.call(e).indexOf(t)>=0};"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});let $$_hash=0;class Base{constructor(){this.$_hash=$$_hash++,this.$_disposed=!1,this.$_disposing=!1}dispose(){return this.$_disposed||this.$_disposing||(this.$_disposed=!0,this.$_disposing=!0,this._doDispose()),null}_doDispose(){}get disposing(){return this.$_disposing}get hash(){return this.$_hash}get shash(){return String(this.$_hash)}isMe(e){return e==this.$_hash}$_getters(e){const t=[],i=Object.getOwnPropertyNames(e);for(let r=0,s=i.length;r<s;r++){const s=i[r],n=Object.getOwnPropertyDescriptor(e,s);n&&n.get&&t.push(s)}return t}doAssignSimple(e){return!1}assignFrom(e){let t=Object.getPrototypeOf(this);if(e instanceof Base){let i=Object.getPrototypeOf(e),r={};for(;i&&i.constructor!=Base;){let s=this.$_getters(i);for(let n=0,o=s.length;n<o;n++){const o=s[n];if(!(o in r)){r[o]=null;let s=Object.getOwnPropertyDescriptor(t,o);if(s){if(s.set){const t=Object.getOwnPropertyDescriptor(i,o),r=t&&t.get;r&&s.set.call(this,r.call(e))}}else{let r=Object.getPrototypeOf(t);for(;r;){let t=Object.getOwnPropertyDescriptor(r,o);if(t){if(t.set){const r=Object.getOwnPropertyDescriptor(i,o),s=r&&r.get;s&&t.set.call(this,s.call(e))}r=null}else r=Object.getPrototypeOf(r)}}}}i=Object.getPrototypeOf(i)}}else if(!this.doAssignSimple(e))for(let i in e){let r=Object.getOwnPropertyDescriptor(t,i);if(r)r.set&&r.set.call(this,e[i]);else{let r=Object.getPrototypeOf(t);for(;r;){let t=Object.getOwnPropertyDescriptor(r,i);t?(t.set&&t.set.call(this,e[i]),r=null):r=Object.getPrototypeOf(r)}}}}extend(e){for(let t in e)t in this&&(this[t]=e[t])}toProxy(){const e={};let t=Object.getPrototypeOf(this);for(;t&&t.constructor!=Base;){let i=this.$_getters(t);for(let r=0,s=i.length;r<s;r++){const s=i[r];let n=Object.getOwnPropertyDescriptor(t,s);if(n)n.get&&n.set&&(e[s]=n.get.call(this));else{let i=Object.getPrototypeOf(t);for(;i;){let t=Object.getOwnPropertyDescriptor(i,s);t?(t.get&&t.set&&(e[s]=t.get.call(this)),i=null):i=Object.getPrototypeOf(i)}}}t=Object.getPrototypeOf(t)}return e}assignProps(e,t,i=!1){return e=e||{},t.forEach((t=>{const r=this[t];(i||void 0!==r)&&(e[t]=r)})),e}toString(){return this.constructor.name}}class EventAware extends Base{constructor(){super(),this._listeners=[]}_doDispose(){for(let e of this._listeners)this.removeListener(e);return this._listeners=null,super._doDispose()}get listenerCount(){return this._listeners.length}addListener(e){return null!=e&&this._listeners.indexOf(e)<0&&this._listeners.push(e),this}removeListener(e){if(this._listeners&&null!=e){const t=this._listeners.indexOf(e);t>=0&&this._listeners.splice(t,1)}return this}isListener(e){return this._listeners&&this._listeners.indexOf(e)>=0}clearListener(){for(let e of this._listeners)this.removeListener(e);this._listeners.length=0}fireEvent(e,...t){let i=Array.prototype.slice.call(arguments,0);i[0]=this;for(let t=0,r=this._listeners.length;t<r;t++){let r=this._listeners[t],s=r[e];s&&s.apply(r,i)}}fireConfirmEvent(e,...t){let i=Array.prototype.slice.call(arguments,0);i[0]=this;for(let t=0,s=this._listeners.length;t<s;t++){let s=this._listeners[t],n=s[e];if(n){var r=n.apply(s,i);if("boolean"==typeof r&&!r)return!1}}return!0}fireMessageEvent(e,...t){let i=Array.prototype.slice.call(arguments,0);i[0]=this;for(let t=0,r=this._listeners.length;t<r;t++){let r=this._listeners[t],s=r[e];if(s){const e=s.apply(r,i);if("string"==typeof e&&e)return e}}return null}fireObjectEvent(e,...t){let i=Array.prototype.slice.call(arguments,0);i[0]=this;for(let t=0,r=this._listeners.length;t<r;t++){let r=this._listeners[t],s=r[e];if(s){const e=s.apply(r,i);if(null!=e)return e}}return null}}class Point{constructor(e=0,t=0){this.x=e,this.y=t}static empty(){return new Point}static create(e=0,t=0){return new Point(e,t)}get isEmpty(){return 0===this.x||0===this.y}clone(){return new Point(this.x,this.y)}equals(e){return e===this||e&&this.x===e.x&&this.y===e.y}setEmpty(){return this.x=this.y=0,this}set(e,t){return this.x=e,this.y=t,this}round(){const e=this.clone();return e.x>>>=0,e.y>>>=0,e}toString(){return"{x: "+this.x+", y: "+this.y+"}"}}class Rectangle{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.width=i,this.height=r}static create(e,t,i,r){return new Rectangle(e,t,i,r)}get left(){return this.x}set left(e){const t=e-this.x;this.x+=t,this.width-=t}get right(){return this.x+this.width}set right(e){const t=e-(this.x+this.width);this.width+=t}get top(){return this.y}set top(e){const t=e-this.y;this.y+=t,this.height-=t}get bottom(){return this.y+this.height}set bottom(e){const t=e-(this.y+this.height);this.height+=t}get isEmpty(){return 0===this.width||0===this.height}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}getInner(){return new Rectangle(0,0,this.width,this.height)}equals(e){return e===this||e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}leftBy(e){return this.x+=e,this.width-=e,this}rightBy(e){return this.width+=e,this}topBy(e){return this.y+=e,this.height-=e,this}bottomBy(e){return this.height+=e,this}shrink(e,t){return this.width-=e,this.height-=t,this}expand(e,t){return this.width+=e,this.height+=t,this}contains(e,t){return e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height}setEmpty(){return this.width=this.height=0,this}move(e=0,t=0){return this.x=e,this.y=t,this}set(e,t,i,r){return this.x=e,this.y=t,this.width=i,this.height=r,this}setWidth(e){return this.width=e,this}copy(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyHorz(e){return this.x=e.x,this.width=e.width,this}copyVert(e){return this.y=e.y,this.height=e.height,this}inflate(e=0,t,i,r){return t=void 0!==t?t:e,i=void 0!==i?i:e,r=void 0!==r?r:t,e&&(this.left=this.x-e),t&&(this.top=this.y-t),i&&(this.right=this.right+i),r&&(this.bottom=this.bottom+r),this}translate(e,t){return this.x+=e,this.y+=t,this}round(){const e=this.clone();return e.x>>>=0,e.y>>>=0,e.width>>>=0,e.height>>>=0,e}union(e){const t=this.clone();return t.left=Math.min(this.x,e.x),t.right=Math.max(this.right,e.right),t.top=Math.min(this.y,e.y),t.bottom=Math.max(this.bottom,e.bottom),t}normalize(){return this.width<0&&(this.x-=this.width,this.width*=-1),this.height<0&&(this.y-=this.height,this.height*=-1),this}intersects(e){return this.x<=e.right&&e.x<=this.right&&this.y<=e.bottom&&e.y<=this.bottom}toString(){return"{x: "+this.x+", y: "+this.y+", width: "+this.width+", height: "+this.height+"}"}}Rectangle.Temp=new Rectangle;const T_MODEL="_m_",T_ROWVIEW="$_rvu",T_HEIGHT="$_h",T_WIDTH="$_w",T_INDEX="$_idx",T_GROUP="$_grp",T_ANCHOR="$_anc",T_ANCHOR_POS="$anp",T_SVG="_svg_",T_ALIGN="_align",T_PAGE="_page_",T_FIELD="$_fld";var Align,VerticalAlign,PrintUnit;!function(e){e.LEFT="left",e.CENTER="center",e.RIGHT="right"}(Align||(Align={})),function(e){e.TOP="top",e.MIDDLE="middle",e.BOTTOM="bottom"}(VerticalAlign||(VerticalAlign={})),function(e){e.PIXEL="px",e.POINT="pt",e.INCH="in",e.CENTCH="cm",e.MILLI="mm"}(PrintUnit||(PrintUnit={}));const $_pixeler={px:e=>e,pt:e=>e*Dimension.HTMLDPI/72,in:e=>e*Dimension.HTMLDPI,mm:e=>e*Dimension.HTMLDPI/25.4,cm:e=>e*Dimension.HTMLDPI/2.54},$_unpixeler={px:e=>e,pt:e=>72*e/Dimension.HTMLDPI,in:e=>e/Dimension.HTMLDPI,mm:e=>25.4*e/Dimension.HTMLDPI,cm:e=>2.54*e/Dimension.HTMLDPI},getPixelsByUnits=function(e,t){return $_pixeler[e](t)},getUnitsByPixels=function(e,t){return $_unpixeler[e](t)};class AlertError extends Error{}const getLinkedSlice=function(e,t){const i=[t],r=e.sort(((e,t)=>e.index-t.index));let s=t.index;const n=r.indexOf(t);for(let e=n+1;e<r.length&&!(r[e].index>s+1);e++,s++)i.push(r[e]);s=t.index;for(let e=n-1;e>=0&&!(r[e].index>s+1);e--,s--)i.unshift(r[e]);return i};class Dimension{constructor(e){if(this._unit=PrintUnit.PIXEL,this._value=NaN,this._fixed=!0,"number"==typeof e)this._value=e;else if("string"==typeof e){const t=e.trim();this._value=parseFloat(e),isNaN(this._value)||(t.endsWith("%")?this._fixed=!1:t.endsWith("pt")?this._unit=PrintUnit.POINT:t.endsWith("in")?this._unit=PrintUnit.INCH:t.endsWith("mm")?this._unit=PrintUnit.MILLI:t.endsWith("cm")&&(this._unit=PrintUnit.CENTCH))}}static create(e){return null==e?null:"string"!=typeof e||(e=e.trim())?new Dimension(e):null}static createDimensions(e){if(e&&(e=e.trim())){const t=e.split(","),i=[];for(let e of t)i.push(e?new Dimension(e):null);return i}}static equals(e,t){return e===t||e&&t&&e.equals(t)}get fixed(){return this._fixed}get unit(){return this._unit}get value(){return this._value}clone(){const e=new Dimension(void 0);return e._fixed=this._fixed,e._unit=this._unit,e._value=this._value,e}equals(e){return e===this||e instanceof Dimension&&(e._fixed==this._fixed&&e._unit==this._unit&&e._value==this._value)}toString(){return isNaN(this._value)?"NaN":this._fixed?this._value+this._unit:this._value+"%"}getValue(){return isNaN(this._value)?"NaN":this._fixed?this.$_getPixel():this._value+"%"}getPixel(e){if(!isNaN(this._value)){let t=this.$_getPixel();return this._fixed||(t=e*t/100),t}return NaN}getFixedPixel(){return isNaN(this._value)?NaN:this.$_getPixel()}$_getPixel(){return $_pixeler[this._unit](this._value)}}Dimension.HTMLDPI=96;class DimensionCollection{constructor(e){if(this._dims=[],this._relative=0,this._fixed=0,this._dirty=!1,e&&(e=e.trim())){const t=e.split(","),i=this._dims=[];for(let e=0;e<t.length;e++){const r=t[e],s=r?new Dimension(r):null;i.push(s)}this.$_refresh()}}get count(){return this._dims.length}get relative(){return this._relative>0}get(e){return this._dims[e]}set(e,t){t!==this._dims[e]&&(this._dims[e]=t,this._dirty=!0)}getSizes(e,t,i,r=!1){this._dirty&&this.$_refresh();const s=this._dims,n=this._values,o=[],a=i?Math.max(0,i.getPixel(t)||0):0;let A=0,l=0,h=0;for(let t=0,i=Math.min(e,s.length);t<i;t++)s[t]&&(s[t].fixed?isNaN(n[t])||(A+=Math.max(0,n[t])):l+=Math.max(0,n[t]));this._dims.forEach(((e,i)=>{const s=this._values[i];if(isNaN(s))o.push(NaN);else if(e.fixed)o.push(Math.max(a,s));else if(isNaN(t))o.push(NaN);else{let e=(t-A)*s/l,i=Math.floor(e);h+=e-i,h>=1&&(i++,h--),o.push(Math.max(a,r?i:e))}}));let d=0,c=0;for(let t=0;t<e;t++){const e=o[t];isNaN(e)?c++:d+=e}if(c>0&&!isNaN(t)){const i=Math.max(0,(t-d)/c);for(let t=0;t<e;t++)isNaN(o[t])&&(o[t]=Math.max(a,i))}return o}getSize(e,t){const i=this._dims[e];if(i){const r=this._values[e];if(!isNaN(r))return i.fixed?r:Math.max(0,(t-this._fixed)*r/this._relative)}return NaN}changeSize(e,t,i,r,s){0!==i&&(this.getSizes(e,r,s),i>0||(i-=i))}$_refresh(){const e=this._values=[];for(let t of this._dims)if(t)if(t.fixed){const i=t.$_getPixel();e.push(i),this._fixed+=i}else e.push(t.value),this._relative+=t.value;else e.push(NaN);this._dirty=!1}$_init(e){this._dims=e.slice(),this.$_refresh()}}var PageBreakMode,EditingKeyCode,ResizeDirection,ReportDataType,ReportDataErrorMessage;DimensionCollection.Empty=new DimensionCollection(null),function(e){e.NONE="none",e.BEFORE="before",e.AFTER="after",e.BOTH="both"}(PageBreakMode||(PageBreakMode={})),function(e){e.Z="KeyZ",e.Y="KeyY",e.C="KeyC",e.V="KeyV",e.X="KeyX",e.DELETE="Delete",e.BACK="Backspace",e.TAB="Tab",e.HOME="Home",e.END="End",e.UP="ArrowUp",e.DOWN="ArrowDown",e.LEFT="ArrowLeft",e.RIGHT="ArrowRight",e.A="KeyA",e._0="Digit0",e.EQUAL="Equal",e.MINUS="Minus"}(EditingKeyCode||(EditingKeyCode={})),function(e){e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom",e.TOP_LEFT="topLeft",e.BOTTOM_RIGHT="bottomRight",e.TOP_RIGHT="topRight",e.BOTTOM_LEFT="bottomLeft"}(ResizeDirection||(ResizeDirection={})),function(e){e.isLeft=function(t){return t===e.LEFT||t===e.TOP_LEFT||t===e.BOTTOM_LEFT},e.isTop=function(t){return t===e.TOP||t===e.TOP_LEFT||t===e.TOP_RIGHT},e.isEdge=function(t){return t===e.TOP_LEFT||t===e.BOTTOM_RIGHT||t===e.TOP_RIGHT||t===e.BOTTOM_LEFT},e.isIn=function(e,...t){for(let i of t)if(i===e)return!0}}(ResizeDirection||(ResizeDirection={})),function(e){e.SIMPLE="simple",e.BAND="band"}(ReportDataType||(ReportDataType={})),function(e){e.DATA_FORMAT_IS_INCORRECT="데이터의 형식이 올바르지 않습니다."}(ReportDataErrorMessage||(ReportDataErrorMessage={}));const _isMac=navigator.platform.toUpperCase().indexOf("MAC")>=0,_isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,_isWhale=!!window.whale,_isChrome=!!window.chrome&&!_isOpera,_isFirefox=void 0!==window.InstallTrigger,_isSafari=Object.prototype.toString.call(HTMLElement).indexOf("Constructor")>0||!_isChrome&&!_isOpera&&navigator.userAgent.indexOf("Safari")>=0,_isWinSafari=_isSafari&&("Win32"==navigator.platform||navigator.userAgent.indexOf("Windows")>=0),_isIE=!!document.documentMode,_isEdge=navigator.userAgent.toLowerCase().indexOf("edge/")>=0,_isiOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,_isChromiumEdge=navigator.userAgent.toLowerCase().indexOf("edg/")>=0&&navigator.userAgent.toLowerCase().indexOf("chrome/")>=0,_ieVer=function(){let e=3,t=document.createElement("div"),i=t.getElementsByTagName("i");for(;t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",i[0];);return e>4?e:undefined}(),_ieOld=void 0!==_ieVer&&_ieVer<=9,_ieLeg=void 0!==_ieVer&&_ieVer<=8,_ieTen=-1!==navigator.appVersion.indexOf("MSIE 10");navigator.appVersion.indexOf("MSIE 9");const __epoch=(new Date).getTime(),xml_chars={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};let $$_mobile,$$_chkMob;const ZWSP="&#8203";function getWin(e){return e&&e.ownerDocument&&(e.ownerDocument.defaultView||e.ownerDocument.parentWindow)}function getDoc(e){return e&&e.ownerDocument}function getDocWin(e){return e.defaultView||e.parentWindow}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){let i=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>i.length)&&(t=i.length),t-=e.length;let r=i.indexOf(e,t);return-1!==r&&r===t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.__name||(this.__name=this.toString().split("(",1)[0].split(" ")[1]),this.__name}}),Number.isNaN=Number.isNaN||function(e){return e!=e};class Utils{static stopEvent(e,t=!1){e.preventDefault?(e.preventDefault(),e.stopPropagation()):e.returnValue=!1,t&&e.stopImmediatePropagation()}static setDebugging(e,t,i){Utils.$$_trace=e,Utils.$$_debugging=t,Utils.$$_keyLog=i}static isDebugging(){return Utils.$$_debugging}static isTrace(){return this.$$_trace}static log(e,...t){Utils.isDebugging()&&console.log(e,t)}static keyLog(e,...t){Utils.$$_keyLog&&console.log(e,t)}static trace(e,...t){Utils.isTrace()&&console.log(e,t)}static getErrorStack(e){const t=e.stack;return t?t.split("\n").map((e=>e+"<br/>")):""}static getBaseClassName(e){return Object.getPrototypeOf(e.constructor).name}static getBaseCtor(e){return Object.getPrototypeOf(e.constructor).$_ctor}static isObject(e){return e&&"object"==typeof e&&!Array.isArray(e)}static isObjectNotEmpty(e){return this.isObject(e)&&0!==Object.keys(e).length}static isArray(e){return Array.isArray(e)}static makeArray(e,t=!1){return null!=e?Array.isArray(e)?e:[e]:t?[]:void 0}static getIntArray(e,t=0){const i=[];for(let r=t,s=t+e;r<s;r++)i.push(r);return i}static isValueArray(e){if(Array.isArray(e)){for(let t=e.length-1;t>=0;t--)if(null!=e[t]&&"object"==typeof e[t])return!1;return!0}}static toArray(e){return Array.isArray(e)?e:null!=e?[e]:null}static push(e,t){if(t&&t.length>0)for(let i=0,r=t.length;i<r;i++)e.push(t[i])}static isDefined(e){return null!=e}static isNotDefined(e){return null==e}static isNumber(e){return"number"==typeof e}static isValidNumber(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}static toNumber(e,t=0){return isNaN(e)?t:+e}static toStrOrNum(e){return isNaN(e)?e:+e}static getEnumValues(e){return Object.keys(e).map((t=>e[t]))}static compareText(e,t,i=!1){return e=e||"",t=t||"",i&&(e=e.toLocaleLowerCase(),t=t.toLocaleLowerCase()),e>t?1:e<t?-1:0}static getTimeF(){return(new Date).getTime()/1e3}static getTimer(){return(new Date).getTime()-__epoch}static isWhiteSpace(e){return!e||!e.trim()}static pad(e,t,i){return t=Math.max(t||2,1),i=i||"0",new Array(t-String(e).length+1).join(i)+e}static pad16(e,t,i){return t=Math.max(t||2,1),i=i||"0",new Array(t-e.toString(16).length+1).join(i)+e.toString(16)}static pick(...e){const t=e.length;let i;for(let r=0;r<t;r++)if(i=e[r],null!=i)return i}static pickNum(...e){const t=e.length;for(let i=0;i<t;i++)if(!isNaN(e[i])&&null!==e[i])return e[i];return NaN}static included(e,...t){const i=t.length;for(let r=0;r<i;r++)if(t[r]==e)return!0;return!1}static compareTextValue(e,t,i,r){if(e===t)return!0;let s=String(e),n=null==t?void 0:String(t);return!s&&!n||!(!s||!n)&&(i||(s=s.toLowerCase(),n=n.toLowerCase()),r?n.indexOf(s)>=0:s==n)}static cast(e,t){return e instanceof t?e:null}static irandom(e,t){if(void 0!==t){const i=Math.floor(e),r=Math.floor(t);return Math.floor(Math.random()*(r-i)+i)}{const t=Math.floor(e);return Math.floor(Math.random()*t)}}static brandom(){return Math.random()>.5}static srandom(e,t){let i="";const r=this.irandom(e,t);for(let e=0;e<r;e++)i+=String.fromCharCode(this.irandom(97,123));return i}static erandom(e){const t=Object.values(e);return t[this.irandom(t.length)]}static arandom(e){return e[this.irandom(e.length)]}static iarandom(e,t,i){const r=[];for(let s=0;s<i;s++)r.push(Utils.irandom(e,t));return r}static alert(e){window.alert(e)}static throwAlert(e){throw new AlertError(e)}static toInt(e,t){const i=parseInt(e,t||10);return isNaN(i)?0:i}static toFloat(e){const t=parseFloat(e);return isNaN(t)?0:t}static toEven(e){return 1&e?e+1:e}static hex(e,t=2,i="0"){t=Math.max(t||2,1);const r=e.toString(16);return i=i||"0",new Array(t-r.length+1).join(i)+r}static toStr(e){return"number"==typeof e?isNaN(e)?"":String(e):null!=e?String(e):""}static extend(e,t){e=e||{};for(let i in t)e[i]=t[i];return e}static setBounds(e,t,i,r,s){const n=e.style;n.left=t+"px",n.top=i+"px",n.width=r+"px",n.height=s+"px"}static setRect(e,t){this.setBounds(e,t.x,t.y,t.width,t.height)}static getOffsetRect(e){return{x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}}static getClientRect(e){const t=e.getBoundingClientRect();return t.cx=e.offsetLeft,t.cy=e.offsetTop,t}static getChildIndex(e){if(e){const t=e.parentNode;if(t){const i=t.children;for(let t=i.length;t--;)if(i[t]===e)return t}}return-1}static clearChildren(e){let t;for(;t=e.lastChild;)e.removeChild(t)}static clearElements(e){let t;for(;t=e.lastChild;)Utils.clearElements(t),e.removeChild(t)}static addChild(e,t){return!(!e||!t||t.parentNode===e)&&(e.appendChild(t),!0)}static removeChild(e,t){return!(!e||!t||t.parentNode!==e)&&(e.removeChild(t),!0)}static remove(e){const t=e&&e.parentElement;t&&t.removeChild(e)}static getPrev(e){const t=e.parentElement.children;if(e!==t[0])for(let i=1;i<t.length;i++)if(t[i]===e)return t[i-1]}static getNext(e){const t=e.parentElement.children;if(e!==t[t.length-1])for(let i=t.length-2;i>=0;i--)if(t[i]===e)return t[i+1]}static disableSelection(e){const t=e.style;t["-moz-user-select"]="-moz-none",t["-khtml-user-select"]="none",t["-webkit-user-select"]="none",t["-o-user-select"]="none",t["-ms-user-select"]="none",t["user-select"]="none"}static selectAll(e){if(e&&window.getSelection&&document.createRange){const t=window.getSelection(),i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i)}}static setMobile(e){$$_mobile=e}static isMobile(){return void 0!==$$_mobile?$$_mobile:(void 0===$$_chkMob&&($$_chkMob=this.$_checkMobile()),$$_chkMob)}static $_checkMobile(){let e=!1;return(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&(e=!0),e||function(t){if((/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),!e&&null!==t.match(/Macintosh/i)){let t=document.createElement("canvas");if(null!==t){let i=t.getContext("webgl")||t.getContext("experimental-webgl");if(i){let t=i.getExtension("WEBGL_debug_renderer_info");if(t){-1!==i.getParameter(t.UNMASKED_RENDERER_WEBGL).indexOf("Apple")&&(e=!0)}}}}}(navigator.userAgent||navigator.vendor||window.opera),e}static getBrowserSize(e){const t=e?e.ownerDocument:document,i=t.defaultView;return{width:i.innerWidth||t.documentElement.clientWidth||t.body.clientWidth,height:i.innerHeight||t.documentElement.clientHeight||t.body.clientHeight}}static move(e,t,i){e.style.left=t+"px",e.style.top=i+"px"}static htmlEncode(e){return document.createElement("a").appendChild(document.createTextNode(e)).parentNode.innerHTML}static detach(e){e&&e.parentNode&&e.parentNode.removeChild(e)}static getSize(e){const t=e.getBoundingClientRect();return{width:t.width,height:t.height}}static getScrolled(e){const t=e.body,i=getDocWin(e),r=e.documentElement;return{sx:i.pageXOffset||r.scrollLeft||t.scrollLeft,sy:i.pageYOffset||r.scrollTop||t.scrollTop}}static getOffset(e){const t=e.ownerDocument,i=t.defaultView,r=e.getBoundingClientRect(),s=t.body,n=t.documentElement,o=i.pageYOffset||n.scrollTop||s.scrollTop,a=i.pageXOffset||n.scrollLeft||s.scrollLeft,A=n.clientTop||s.clientTop||0,l=n.clientLeft||s.clientLeft||0,h=r.left+a-l,d=r.top+o-A;return{x:Math.round(h),y:Math.round(d)}}static isAncestorOf(e,t){let i=t;for(;i;){if(i==e)return!0;i=i.parentElement}return!1}static equalNumbers(e,t){return isNaN(e)==isNaN(t)&&!isNaN(e)&&e==t}static equalArrays(e,t){if(e===t)return!0;if(null==e||null==t)return!1;const i=e.length;if(i!=t.length)return!1;for(let r=0;r<i;++r)if(e[r]!==t[r])return!1;return!0}static parseDate(e,t){const i=new Date(e);return isNaN(i.getTime())?t||new Date:i}static isLeapYear(e){return e%4==0&&e%100!=0||e%400==0}static incMonth(e,t){const i=e.getDate();return e.setDate(1),e.setMonth(e.getMonth()+t),e.setDate(Math.min(i,Utils.month_days[Utils.isLeapYear(e.getFullYear())?1:0][e.getMonth()])),e}static minDate(e,t){return null!==e?e:null!==t?t:e.getTime()<t.getTime()?e:t}static maxDate(e,t){return null!==e?t:null!==t||e.getTime()>t.getTime()?e:t}static setClassName(e,t){t!=e.className&&(e.className=t)}static addClassName(e,t){if(e.classList)e.classList.add(t);else{const i=e.className.split(" ");i.indexOf(t)<0&&i.push(t),e.className=i.join(" ")}}static removeClassName(e,t){if(e.classList)e.classList.remove(t);else{const i=e.className.split(" ");let r;(r=i.indexOf(t))>=0&&i.splice(r,1),e.className=i.join(" ")}}static getBoundingClientRect2(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top,left:t.left,right:t.right,width:t.right-t.left,top:t.top,bottom:t.bottom,height:t.bottom-t.top}}static getBoundingRect(e,t){const i=Utils.getBoundingClientRect2(t),r=Utils.getBoundingClientRect2(e);return new Rectangle(i.left-r.left,i.top-r.top,t.offsetWidth,t.offsetHeight)}static getTextLength(e){let t=0,i=0,r=0;for(;r=e.charCodeAt(i++);t+=r>>7?2:1);return t}static getClassName(e){if(e&&e.constructor)return e.constructor.name||function(e){let t=e.toString();return t=t.substr("function ".length),t=t.substr(0,t.indexOf("(")),t}(e.constructor)}static isInteger(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}static setTextProp(e){e.textProp=this.ieAll?"textContent":"innerText"}static isEmpty(e){if(e)for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}static isNotEmpty(e){if(e)for(let t in e)if(e.hasOwnProperty(t))return!0;return!1}static capitalize(e){if("string"!=typeof e)return"";const t=e.charAt(0);return t>="A"&&t<="Z"?e:t.toUpperCase()+e.slice(1)}static uncapitalize(e){if("string"!=typeof e)return"";const t=e.charAt(0);return t>="a"&&t<="z"?e:t.toLowerCase()+e.slice(1)}static labelize(e){if("string"!=typeof e)return"";const t=e.charAt(0);let i=(e=t>="A"&&t<="Z"?e:t.toUpperCase()+e.slice(1)).charAt(0);for(let t=1;t<e.length;t++){const r=e.charAt(t);r>="A"&&r<="Z"&&(i+=" "),i+=r}return i}static escapeXML(e){return e.replace(/[&<>"']/g,(function(e){return xml_chars[e]}))}static deepClone(e){if(null===e||"object"!=typeof e)return e;const t=Array.isArray(e)?[]:{};for(let i of Object.keys(e))t[i]=Utils.deepClone(e[i]);return t}static getCaretOffset(e){const t=e.ownerDocument.getSelection();return t.rangeCount>0?t.focusOffset:0}static getFocused(){let e=document.getSelection().focusNode;for(;e;){if(e instanceof HTMLElement)return e;e=e.parentElement}}static getArray(e,t){const i=[];for(let r=0;r<e;r++)i.push(t);return i}static getNumArray(e,t=0){const i=[];for(let r=0;r<e;r++)i.push(t);return i}static hasSetter(e,t){for(;e;){const i=Reflect.getOwnPropertyDescriptor(e,t);if(i)return i.writable||!!i.set;e=Object.getPrototypeOf(e)}}static dataUriToBinary(e){const t=";base64,",i=e.indexOf(t)+t.length,r=e.substring(i),s=window.atob(r),n=s.length,o=new Uint8Array(new ArrayBuffer(n));for(let e=0;e<n;e++)o[e]=s.charCodeAt(e);return o}static getImageUrl(e){const t=e.backgroundImage;if(t&&t.startsWith('url("'))return t.substring(5,t.length-2)}static cloneDom(e,t=!1){const i=e.parentElement,r=e.cloneNode(!0);if(t){const t=getComputedStyle(e);r.style.position="absolute",r.style.top=t.top,r.style.left=t.left}return r.style.visibility="hidden",r.style.transform="",i.insertBefore(r,e),r}static getTextRect(e){const t=document.createRange();return t.selectNodeContents(e),t.getBoundingClientRect()}}function assert(e,t){if(!e)throw new Error(t)}Utils.isIE=_isIE,Utils.isEdge=_isEdge,Utils.ieAll=_isIE||_isEdge,Utils.ieOld=_ieOld,Utils.isMac=_isMac,Utils.isSafari=_isSafari,Utils.isWinSafari=_isWinSafari,Utils.isChrome=_isChrome,Utils.isFirefox=_isFirefox,Utils.isOpera=_isOpera,Utils.ieLeg=_ieLeg,Utils.ieTen=_ieTen,Utils.isiOS=_isiOS,Utils.isChromium=_isChrome||_isChromiumEdge||_isWhale||_isOpera,Utils.TextProp=Utils.ieAll?"innerText":"textContent",Utils.week_days=window.RG_CONST&&window.RG_CONST.WEEKDAYS?window.RG_CONST.WEEKDAYS:["일","월","화","수","목","금","토"],Utils.month_days=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]],Utils.colonreg=/;(?=(?:[^"]*"[^"]*")*(?![^"]*"))/,Utils.$$_debugging=!1,Utils.$$_keyLog=!1,Utils.$$_trace=null;class VisualElement extends EventAware{constructor(e,t=null,i=null){super(),this._positionable=!0,this._x=0,this._y=0,this._width=0,this._height=0,this._visible=!0,this._styleName="",this._elements=null,this._dirty=!0,this._hovered=!1,this._className="",this._nodraw=!1,this._name=t;let r=this._dom=this._createDom(e);r&&this._initDom(e,r),i&&i(this,r)}_doDispose(){if(this._dom&&(this._removeEventListeners(this._dom),Utils.detach(this._dom),this._dom=null),this._elements){for(let e of this._elements)e.dispose();this._elements.length=0}this._parent=null,super._doDispose()}get positionable(){return this._positionable}set positionable(e){e!=this._positionable&&(this._positionable=e,this.invalidate())}get name(){return this._name}get styleName(){return this._styleName}set styleName(e){e!=this._styleName&&(this._styleName=e,this.resetStyleName())}get container(){return this._parent&&this._parent.container}get parent(){return this._parent}get elements(){return this._elements?this._elements.slice(0):[]}get childCount(){return this._elements?this._elements.length:0}get isSingleton(){return this._parent&&1==this._parent.childCount&&this._parent._elements[0]===this}get x(){return this._x}set x(e){e!=this._x&&(this._x=e,this.invalidate())}get y(){return this._y}set y(e){e!=this._y&&(this._y=e,this.invalidate())}get width(){return this._width}set width(e){(e=Math.max(0,e))!=this._width&&(this._width=e,this.sizeChanged())}get height(){return this._height}set height(e){(e=Math.max(0,e))!=this._height&&(this._height=e,this.sizeChanged())}get right(){return this._x+this._width}get bottom(){return this._y+this._height}get position(){return new Point(this._x,this._y)}get bounds(){return new Rectangle(this._x,this._y,this._width,this._height)}get clientRect(){return new Rectangle(0,0,this._width,this._height)}get visible(){return this._visible}set visible(e){e!=this._visible&&(this._visible=e,this._dom&&(this._dom.style.display=this._visible?this._getCssDisplay():"none"),this.invalidate(!0),this._visibleChanged())}get findable(){return!0}get hovered(){return this._hovered}set hovered(e){e!=this._hovered&&(this._hovered=e,this._hoverChanged())}get isLayer(){return!1}get blockable(){return!1}get mouseX(){const e=this.container;if(e){let t=e._currentX,i=this;for(;i&&void 0!==i;)t-=i._x,i=i._parent;return t}return NaN}get mouseY(){const e=this.container;if(e){let t=e._currentY,i=this;for(;i&&void 0!==i;)t-=i._y,i=i._parent;return t}return NaN}get dom(){return this._dom}get doc(){return getDoc(this._dom)}get style(){return this._dom&&this._dom.style}get offsetWidth(){return this._dom.offsetWidth}get offsetHeight(){return this._dom.offsetHeight}get offsetSize(){return{width:this._dom.offsetWidth,height:this._dom.offsetHeight}}get printable(){return!0}isDom(e){return e===this._dom}containsDom(e){return this._dom.contains(e)}containsClass(e){return this._dom.classList.contains(e)}canHover(){return!0}getChildren(){return this._elements&&this._elements.slice(0)}getChild(e){return this._elements&&this._elements[e]}indexOf(e){return this._elements?this._elements.indexOf(e):-1}get firstChild(){return this._elements&&this._elements[0]}contains(e){return this._elements&&this._elements.indexOf(e)>=0}getAncestor(e){let t=this._parent;for(;t;){if(t instanceof e)return t;t=t._parent}return null}addDom(e){e&&this._dom.appendChild(e)}addChild(e){return this.insertChild(-1,e)}_getParentDom(){return this._dom}insertChild(e,t){if(t&&!this.contains(t)){const i=this._elements||[],r=t._dom,s=this._getParentDom();if(e<0||e>=i.length)s&&r&&s.appendChild(r),i.push(t);else{if(r){const t=this._elements[e]._dom;s&&t&&s.insertBefore(r,t)}i.splice(e,0,t)}return this._elements=i,t._parent=this,t.$_attached(this),this.invalidate(),!0}return!1}removeChild(e){if(e&&this._elements){const t=this._elements.indexOf(e);if(t>=0)return this.removeChildAt(t)===e}return!1}removeChildAt(e){if(e>=0&&e<this.childCount){const t=this._elements[e],i=this._getParentDom();return this._elements.splice(e,1),i&&t._dom&&i.removeChild(t._dom),t._parent=null,t._dirty=!1,t.$_detached(this),this.invalidate(),t}return null}removeLast(){return this._elements&&this._elements.length>0?this.removeChildAt(this._elements.length-1):null}clear(){const e=this._elements;if((e?e.length:0)>0){for(let t of e)t._parent=null,t.$_detached(this);this._elements=[];const t=this._getParentDom();if(t)for(;t.lastChild;)t.removeChild(t.lastChild);return this.invalidate(),!0}return!1}hideAll(){if(this._elements)for(let e of this._elements)e.visible=!1}invalidate(e=!1,t=!1){if(e||!this._dirty){this._dirty=!0;const e=this.container;e&&e.invalidateElement(this)}if(t&&this._elements)for(let t of this._elements)t.invalidate(e,!0)}validate(){this._dirty=!1}invalidateLayout(){const e=this.container;e&&e.invalidateLayout()}getBounds(e=null){return e?e.set(this._x,this._y,this._width,this._height):new Rectangle(this._x,this._y,this._width,this._height)}getClientRect(e=null){return e?e.set(0,0,this._width,this._height):new Rectangle(0,0,this._width,this._height)}containsInBounds(e,t){return e>=this._x&&e<this._x+this._width&&t>=this._y&&t<this._y+this._height}containsInClient(e,t){return e>=0&&e<this._width&&t>=0&&t<this._height}parentToElement(e,t,i){let r=this;for(;r&&r!=e;)t-=r._x,i-=r._y,r=r._parent;return new Point(t,i)}translateBy(e,t=null){let i=e;for(t||(t=new Rectangle(0,0,this._width,this._height));i&&i!==this;)t.x-=i._x,t.y-=i._y,i=i._parent;return t}topBy(e,t){let i=this._y+t,r=this._parent;for(;r&&r!==e;)i+=r._y,r=r._parent;return i}boundsBy(e,t=null){let i=this._x,r=this._y,s=this._parent;for(t&&(i+=t.x,r+=t.y);s&&s!==e;)i+=s._x,r+=s._y,s=s._parent;return t?new Rectangle(i,r,t.width,t.height):new Rectangle(i,r,this._width,this._height)}boundsByContainer(e=null){let t=this._x,i=this._y;e&&(t+=e.x,i+=e.y);let r=this._parent;for(;r&&void 0!==r._x;)t+=r._x,i+=r._y,r=r._parent;return e?new Rectangle(t,i,e.width,e.height):new Rectangle(t,i,this._width,this._height)}pointByContainer(e,t){let i=this._parent;for(;i&&void 0!==i._x;)e+=i._x,t+=i._y,i=i._parent;return new Point(e+this._x,t+this._y)}containerToElement(e,t){let i=this;for(;i;)e-=i._x,t-=i._y,i=i._parent;return new Point(e,t)}boundsByScreen(e=null){return e=this.boundsByContainer(e),e=this.container.toScreen(e)}offsetFrom(e){const t=e._dom,i=new Point(this._dom.offsetLeft,this._dom.offsetTop);let r=this._dom.offsetParent;for(;r instanceof HTMLElement&&r!==t;)i.x+=r.offsetLeft,i.y+=r.offsetTop,r=r.offsetParent;return i}hitTest(e,t){return e>=0&&e<this._width&&t>=0&&t<this._height}findChildAt(e,t,i,r){const s=this._elements,n=s?s.length:0;if(n>0)for(let o=n-1;o>=0;o--){const n=s[o];if(n.visible){const s=e-n._x,o=t-n._y;if((i||n.findable)&&(n.isLayer||n.hitTest(s,o))){const e=n.findChildAt(s,o,i,r);if(e)return e;if(!n.isLayer||r&&n.blockable)return n}}}return null}findChildOf(e){if(this._elements)for(let t of this._elements){if(t.isDom(e))return t;const i=t.findChildOf(e);if(i)return i}}move(e,t,i=!1){e==this._x&&t==this._y||(this._x=e,this._y=t,i?(!isNaN(e)&&(this._dom.style.left=e+"px"),!isNaN(t)&&(this._dom.style.top=t+"px")):this.invalidate())}moveBy(e,t,i=!1){this.move(this._x+e,this._y+t,i)}resize(e,t,i=!1){e==this._width&&t==this._height||(this._width=e,this._height=t,i?this._setSizeStyle(this._dom.style):this.sizeChanged())}resizeBy(e,t,i=!1){this.resize(this._width+e,this._height+t,i)}setBounds(e,t,i,r){return e==this._x&&t==this._y||(this._x=e,this._y=t,this.invalidate()),this.resize(i,r),this}setBoundsI(e,t,i,r){return t>>=0,i>>=0,r>>=0,(e>>=0)==this._x&&t==this._y||(this._x=e,this._y=t,this.invalidate()),this.resize(i,r),this}setRect(e){return e.x==this._x&&e.y==this._y||(this._x=e.x,this._y=e.y,this.invalidate()),this.resize(e.width,e.height),this}setRectI(e){const t=e.x>>0,i=e.y>>0,r=e.width>>0,s=e.height>>0;return t==this._x&&i==this._y||(this._x=t,this._y=i,this.invalidate()),this.resize(r,s),this}getBoundingRect(){return Utils.getBoundingClientRect2(this._dom)}draw(){this._dirty&&this._dom&&!this._nodraw&&(this._beforeDraw(this._dom),this._doDraw(this._dom),this._afterDraw(this._dom),this._dirty=!1)}drawRecursive(){this.draw();for(let e=0,t=this.childCount;e<t;e++){const t=this._elements[e];t.visible&&t.drawRecursive()}}resetSizeStyle(){this._dom&&this._setSizeStyle(this._dom.style)}getHtml(){return this._dom&&this._dom.outerHTML}setImportantStyle(e,t){this._dom.style.setProperty(e,t,"important")}isAncestorOf(e){let t=e&&e.parent;for(;t;){if(t===this)return!0;t=t.parent}}isAncestorDomOf(e,t=!1){if(t&&this._dom===e)return!0;let i=e.parentElement;for(;i;){if(i===this._dom)return!0;i=i.parentElement}}findDescendantOf(e){for(let t=this.childCount-1;t>=0;t--){let i=this.getChild(t);if(i._dom===e)return i;if(i=i.findDescendantOf(e),i)return i}}setStyles(e){if(e){const t=this._dom.style;for(let i in e)t[i]=e[i]}}get scrollTop(){return this._dom.scrollTop}get scrollLeft(){return this._dom.scrollLeft}scrollDom(e,t){Utils.isIE?(this._dom.scrollTop=t,this._dom.scrollLeft=e):this._dom.scroll(e,t)}setHint(e){this._dom.title=e}setRotation(e){const t=this._dom.style;isNaN(e)||0===e?t.transform="":(t.transformOrigin="center",t.transform="rotate("+e+"deg)")}_isTesting(){return VisualElement.Testing}_getElements(){return this._elements}_createDom(e){return e.createElement("div")}_getCssSelector(){return this._styleName}_initDom(e,t){const i=t.style;i.position="absolute",i.boxSizing="border-box",this._addEventListeners(t)}_addEventListeners(e){}_removeEventListeners(e){}$_attached(e){this._doAttached(e)}_doAttached(e){}$_detached(e){this._doDetached(e)}_doDetached(e){}_isEmptySize(){return!1}_setSizeStyle(e){this._isEmptySize()?(e.width="",e.height=""):(e.width=isNaN(this._width)?"":this._width+"px",e.height=isNaN(this._height)?"":this._height+"px")}setPrintStyles(){const e=this._dom.style;isNaN(this._x)||(e.left=this._x+"px"),isNaN(this._y)||(e.top=this._y+"px"),isNaN(this._width)||(e.width=this._width+"px"),isNaN(this._height)||(e.height=this._height+"px")}_getCssDisplay(){return"block"}resetStyleName(){this._setClassName(this._dom)}_setClassName(e){let t=this._getCssSelector();t!=this._className&&(this._className=t,(e||this._dom).className=t||"")}replaceDom(e){const t=this._dom,i=t.parentElement;i.removeChild(t),i.appendChild(e),this._dom=e}cloneNode(){return this._dom.cloneNode(!0)}applyBounds(){let e=this._dom.style;e.left=this._x+"px",e.top=this._y+"px",this._setSizeStyle(e)}_beforeDraw(e){this._setClassName(e);let t=e.style;this._positionable?(t.left=this._x+"px",t.top=this._y+"px"):(t.left="",t.top=""),this._setSizeStyle(t)}_doDraw(e){}_afterDraw(e){}_hoverChanged(){}_visibleChanged(){}sizeChanged(){this.invalidate(!0,!0),this._doSizeChanged()}_doSizeChanged(){}}VisualElement.Testing=!1;class LayerElement extends VisualElement{get isLayer(){return!0}_doDraw(e){}}const DRAG_THRESHOLD$1=3;class VisualTool extends Base{constructor(e,t){super(),this._clickX=0,this._clickY=0,this._mouseX=0,this._mouseY=0,this._owner=e,this._name=t,this._previous=null}_doDispose(){this._dragTracker=null,this._previous=null,this._owner=null,this._mouseEventTarget=null,super._doDispose()}get owner(){return this._owner}get name(){return this._name}get previous(){return this._previous}get dragTracker(){return this._dragTracker}set dragTracker(e){e!==this._dragTracker&&(this._dragTracker&&this._dragTracker.deactivate(),this._dragTracker=e,this._dragTracker&&this._dragTracker.activate())}get dragging(){return this._dragTracker&&this._dragTracker.dragging}get mouseX(){return this._mouseX}get mouseY(){return this._mouseY}get mouseEventTarget(){return this._mouseEventTarget}findElementAt(e,t,i,r=!1){return this._owner.findElementAt(e,t,i,r)}findElementOf(e){return this._owner.findElementOf(e)}activate(e){this._doActivated(e)}deactivate(){this._doDeactivated()}keyDown(e){return this._doKeyDown(e)}keyUp(e){return this._doKeyUp(e)}keyPress(e){return this._doKeyPress(e)}mouseDown(e){const t=this._mouseX=this._clickX=e.mouseX,i=this._mouseY=this._clickY=e.mouseY;this.dragging&&this._stopDragTracker(t,i,!1);const r=this._doMouseDown(e);return this._dragTracker&&this._dragTracker.startWhenCreated&&this._startDragTracker(t,i,e.shiftKey,e.altKey),r}dragFrom(e,t){}dropFrom(e,t){}mouseMove(e){const t=this._mouseX=e.mouseX,i=this._mouseY=e.mouseY,r=this._dragTracker,s="mousemove"===e.type?e.buttons:"touchmove"===e.type?1:void 0;if(r)if(r.dragging)if(null==s||s>0||Utils.ieOld&&s>=0){if(!r.drag(this._mouseEventTarget,t,i)){const s=r.getNextRequest(t,i);s&&(this._stopDragTracker(t,i,!0),this.dragTracker=this._getDragTracker(s,t,i),this._startDragTracker(t,i,e.shiftKey,e.altKey))}}else this._stopDragTracker(t,i,!0);else Math.abs(t-this._clickX)>=3||Math.abs(i-this._clickY)>=3?this._startDragTracker(t,i,e.shiftKey,e.altKey):this._doMouseMove(e);else this._doMouseMove(e)}mouseUp(e){try{const t=this._mouseX=e.mouseX,i=this._mouseY=e.mouseY;this.dragging?this._stopDragTracker(t,i,!1):this._doMouseUp(e)}finally{this._dragTracker=null}}mouseEnter(e){this._doMouseEnter(e)}mouseLeave(e){this._doMouseLeave(e)}mouseOver(e){this._doMouseOver(e)}mouseOutside(){this._doMouseOutside()}mouseWheel(e){return this._doMouseWheel(e)}contextMenu(e){return this._doContextMenu(e)}click(e){this._doClick(e)}dblclick(e){this._doDblClick(e)}setFocus(e){!Utils.isMobile()&&this._doSetFocus(e)}focusLeave(e){this._doFocusLeave(e)}dragStart(e){this._doDragStart(e)}dragEnd(e){this._doDragEnd(e)}dragEnter(e){this._doDragEnter(e)}dragOver(e){this._doDragOver(e)}dragLeave(e){this._doDragLeave(e)}dragDrop(e){this._doDragDrop(e)}isMouseEventTarget(e){return e._dom===this._mouseEventTarget}_doActivated(e){}_doDeactivated(){}_doKeyDown(e){return!1}_doKeyUp(e){return!1}_doKeyPress(e){return!1}_doMouseDown(e){return!1}_doMouseMove(e){}_doMouseUp(e){}_doMouseEnter(e){}_doMouseLeave(e){}_doMouseOver(e){}_doMouseOutside(){}_doMouseWheel(e){return!1}_doContextMenu(e){}_doClick(e){}_doDblClick(e){}_doSetFocus(e){}_doFocusLeave(e){}_doDragStart(e){}_doDragEnd(e){}_doDragEnter(e){}_doDragOver(e){}_doDragLeave(e){}_doDragDrop(e){}_getDragTracker(e,t,i){return null}_startDragTracker(e,t,i,r){this._dragTracker&&(this._dragTracker.start(this._mouseEventTarget,e,t,i,r)?this._doDragTrackerStarted(this._dragTracker):this._dragTracker=null)}_stopDragTracker(e,t,i){if(this.dragging){const r=this._dragTracker;i?r.cancel():r.drop(this._mouseEventTarget,e,t),this.dragTracker=null,this._doDragTrackerFinished(r,i)}}_doDragTrackerStarted(e){}_doDragTrackerFinished(e,t){}_findTableCell(e){return this.owner.getTableCell(e||this.mouseEventTarget)}_doTouchStart(e){}_doTouchMove(e){}_doTouchEnd(e){}_doTouchCancel(e){}}class DragTracker extends Base{constructor(e,t){super(),this._active=!1,this._completed=!1,this._dragging=!1,this._currentX=0,this._currentY=0,this._container=e,this._name=t}get container(){return this._container}get name(){return this._name}get active(){return this._active}get dragging(){return this._dragging}get startWhenCreated(){return!1}get completed(){return this._completed}get linkable(){return!1}get cursor(){}activate(){this._active||(this._doActivate(),this._active=!0)}deactivate(){this._active&&(this.cancel(),this._doDeactivate(),this._active=!1)}start(e,t,i,r,s){return this.cancel(),!(!this._active||!this._doStart(e,t,i,r,s))&&(this._currentX=this._startX=t,this._currentY=this._startY=i,this._dragging=!0,this._completed=!1,this._showFeedback(t,i),this.container.setCursor(this.cursor||""),!0)}drag(e,t,i){return!(!this._dragging||(this._currentX=t,this._currentY=i,!this._doDrag(e,t,i)))&&(this.container.setCursor(this.cursor||""),this._moveFeedback(t,i),!0)}cancel(){try{if(this._dragging)try{this._dragging=!1,this._doCanceled(this._currentX,this._currentY)}finally{this.end()}}finally{this._hideFeedback()}}drop(e,t,i){try{if(this._dragging)try{this._currentX=t,this._currentY=i,this._dragging=!1,this._canAccept(e,t,i)?(this._doCompleted(e,t,i),this._completed=!0):this._doCanceled(t,i)}finally{this.end()}}finally{this._hideFeedback()}}end(){this.container.setCursor(""),this._doEnded()}getRequest(){return null}getNextRequest(e,t){return null}get startX(){return this._startX}get startY(){return this._startY}get currentX(){return this._currentX}get currentY(){return this._currentY}_showFeedback(e,t){}_moveFeedback(e,t){}_hideFeedback(){}_doActivate(){}_doDeactivate(){}_doStart(e,t,i,r,s){return!0}_doDrag(e,t,i){return!0}_doCanceled(e,t){}_canAccept(e,t,i){return!0}_doCompleted(e,t,i){}_doEnded(){}}var ScrollEventType;!function(e){e.LINE="line",e.PAGE="page",e.THUMB_TRACK="thumbTrack",e.THUMB_END="thumbEnd"}(ScrollEventType||(ScrollEventType={}));class ScrollElement extends VisualElement{constructor(e,t,i){super(e,i),this._scrollBar=t}_doDispose(){this._scrollBar=null,super._doDispose()}get scrollBar(){return this._scrollBar}get vertical(){return this._scrollBar.vertical}_doDraw(e){this._doRender(e)}_doRender(e){}_changed(){this.invalidate()}}class ScrollTrack extends ScrollElement{constructor(e){super(e.doc,e,"scrollTrackView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rg-scrolltrack"}}class ScrollButton extends ScrollElement{constructor(e,t){super(e.doc,e,"scrollButtonView"),this._enabled=!0,this._far=t}get enabled(){return this._enabled}set enabled(e){e!=this._enabled&&(this._enabled=e,this._changed())}get far(){return this._far}_getCssSelector(){return this.scrollBar.vertical?this._far?"rg-scroll-down":"rg-scroll-up":this._far?"rg-scroll-right":"rg-scroll-left"}}class ScrollThumb extends ScrollElement{constructor(e){super(e.doc,e,"scrollThumbView")}_getCssSelector(){return"rg-scrollthumb"}}class ScrollBar$1 extends VisualElement{constructor(e,t=!1){super(e.doc,"scrollBarView"),this._lineScrollSize=1,this._pageScrollSize=1,this._minThumbSize=20,this._min=0,this._max=0,this._pos=0,this._page=0,this._maxPosition=0,this._buttonSize=20,this._needLayout=!0,this._tipView=null,this._container=e,this._vertical=t,this._track=new ScrollTrack(this),this.addChild(this._track),this._thumb=new ScrollThumb(this),this.addChild(this._thumb),this._nearButton=new ScrollButton(this,!1),this.addChild(this._nearButton),this._farButton=new ScrollButton(this,!0),this.addChild(this._farButton)}_doDispose(){this._track=this._track.dispose(),this._thumb=this._thumb.dispose(),this._nearButton=this._nearButton.dispose(),this._farButton=this._farButton.dispose(),super._doDispose()}get container(){return this._container}get lineScrollSize(){return this._lineScrollSize}set lineScrollSize(e){(e=Math.max(1,e))!=this._lineScrollSize&&(this._lineScrollSize=e)}get pageScrollSize(){return this._pageScrollSize}set pageScrollSize(e){(e=Math.max(1,e))!=this._pageScrollSize&&(this._pageScrollSize=e)}get minThumbSize(){return this._minThumbSize}set minThumbSize(e){(e=Math.max(8,e))!=this._minThumbSize&&(this._minThumbSize=e,this.invalidateLayout())}get vertical(){return this._vertical}get pos(){return this._pos}get maxPosition(){return this._maxPosition}get buttonSize(){return this._buttonSize}set tipView(e){this._tipView=e}layoutContent(){this._needLayout&&(this._needLayout=!1,this._doLayoutContent())}setProperties(e,t,i){e=Math.max(0,e),t=Math.max(e,t),e==this._min&&t==this._max&&i==this._page||(this._min=e,this._max=t,this._page=i,this._pos=Math.min(this._max,Math.max(this._min,this._pos)),this._maxPosition=Math.max(0,this._max-this._page),this.invalidate(),this._needLayout=!0)}setPosition(e,t=!0){(e=Math.min(this._maxPosition,Math.max(this._min,e)))!=this._pos&&(this._pos=e,this.invalidate(),this._needLayout=!0,t&&this.layoutContent())}ptInTrack(e,t,i){const r=this.containerToElement(e,t);if(this._vertical){if(r.y>=this._nearButton.height&&r.x<this._farButton.y)return!i&&r.y<this._thumb.y||i&&r.y>=this._thumb.bottom}else if(e>=this._nearButton.width&&e<this._farButton.x)return!i&&r.x<this._thumb.x||i&&r.x>=this._thumb.right;return!1}setText(e){if(this._tipView&&e){let t,i;if(this._tipView.show(),this._tipView.setText(e),this._vertical){let e=this._tipView.width();t=this.x-e-5,i=this._thumb.y}else{let e=this._tipView.height();t=this._thumb.x,i=this.y-e-5}this._tipView.move(t,i)}}_getCssSelector(){return this._vertical?"rg-vscrollbar":"rg-hscrollbar"}draw(){super.draw()}_doDraw(e){}_doSizeChanged(){this.invalidateLayout()}invalidateLayout(){this._needLayout=!0,super.invalidateLayout()}_doLayoutContent(){const e=this._vertical,t=this._buttonSize,i=this.height,r=this.width,s=(e?i:r)-2*t,n=Math.min(s,Math.max(this._minThumbSize,Math.floor(s*this._page/(this._max-this._min+1)))),o=t+Math.min(s-n,Math.max(0,Math.floor((s-n)*this._pos/(this._maxPosition-this._min))));this._track.setBounds(0,0,r,i),e?(this._nearButton.setBounds(0,0,r,t),this._farButton.setBounds(0,i-t,r,t),n<=s&&this._thumb.setBounds(2,o,r-4,n)):(this._nearButton.setBounds(0,0,t,i),this._farButton.setBounds(r-t,0,t,i),n<=s&&this._thumb.setBounds(o,2,n,i-4))}_doScroll(e,t,i){this.fireEvent(ScrollBar$1.SCROLLED,e,t,i)}}ScrollBar$1.SCROLLED="onScrollBarScrolled";class ScrollThumbTracker extends DragTracker{constructor(e){super(e,"scrollThumbTracker")}_doDispose(){this._thumb=this._thumb&&this._thumb.dispose(),super._doDispose()}get thumb(){return this._thumb}set thumb(e){this._thumb=e}get startWhenCreated(){return!0}_doStart(e,t,i){const r=this._thumb.scrollBar,s=r.containerToElement(t,i);return r.vertical?this._offset=s.y-this._thumb.y:this._offset=s.x-this._thumb.x,!0}_doDrag(e,t,i){return this.$_doScroll(t,i,ScrollEventType.THUMB_TRACK)}_doCompleted(e,t,i){return this.$_doScroll(t,i,ScrollEventType.THUMB_END)}_doCanceled(e,t){}_doEnded(){}$_doScroll(e,t,i){const r=this._thumb.scrollBar,s=r._maxPosition-r._min+1,n=r._buttonSize,o=r.containerToElement(e,t);if(r.vertical){const e=r.height-2*n-this._thumb.height;if(e<=0)return!1;o.y-=this._offset,o.y=(o.y-n)*s/e,r._doScroll(i,0,Math.floor(o.y))}else{const e=r.width-2*n-this._thumb.width;if(e<=0)return!1;o.x-=this._offset,o.x=(o.x-n)*s/e,r._doScroll(i,0,Math.floor(o.x))}return!0}}class ScrollButtonTimer extends EventAware{constructor(){super(),this._active=!1,this._timer=void 0,this._ready=!1}get active(){return void 0!==this._timer}start(e){this._button=e,this._scrollBar=e.scrollBar,this._active=!0,setTimeout(function(){this._ready&&(this._ready=!1,this._timer=setInterval(function(){this._active&&this.$_fireEvent()}.bind(this),20))}.bind(this),200),this._ready=!0,this.$_fireEvent()}move(e,t){const i=this._button.containerToElement(e,t);this._active=this._button.containsInClient(i.x,i.y)}stop(){this._ready=!1,this._timer&&(clearInterval(this._timer),this._timer=void 0)}$_fireEvent(){let e=this._button.far?1:-1,t=ScrollEventType.LINE;this._scrollBar._doScroll(t,this._scrollBar.lineScrollSize*e,0)}}class ScrollTrackTimer extends Base{constructor(){super(),this._active=!1,this._timer=void 0,this._ready=!1,this._mouseX=0,this._mouseY=0}get active(){return this._active}start(e,t,i,r){this._scrollBar=e,this._far=t,this._active=!0,setTimeout(function(){this._ready&&(this._ready=!1,this._timer=setInterval(function(){this._active&&this.$_fireEvent()}.bind(this),50))}.bind(this),200),this._ready=!0;const s=this._scrollBar.containerToElement(i,r);this._mouseX=s.x,this._mouseY=s.y,this.$_fireEvent()}move(e,t){const i=this._scrollBar.containerToElement(e,t);this._mouseX=i.x,this._mouseY=i.y,this._active=this._scrollBar.ptInTrack(i.x,i.y,this._far)}stop(){this._ready=!1,this._timer&&clearInterval(this._timer)}$_fireEvent(){let e=null,t=0;const i=this._scrollBar._thumb;if(this._scrollBar.vertical){const r=this._mouseY;this._far&&r>i.bottom?(e=ScrollEventType.PAGE,t=1):!this._far&&r<i.y&&(e=ScrollEventType.PAGE,t=-1)}else{const r=this._mouseX;this._far&&r>i.right?(t=1,e=ScrollEventType.PAGE):r<i.x&&(e=ScrollEventType.PAGE,t=-1)}0!=t&&this._scrollBar._doScroll(e,this._scrollBar.pageScrollSize*t,0)}}class ScrollTool extends VisualTool{constructor(e){super(e,"scrollTool"),this._buttonTimer=new ScrollButtonTimer,this._trackTimer=new ScrollTrackTimer,this._thumbTracker=new ScrollThumbTracker(e)}_doDispose(){this._thumbTracker.cancel(),this._thumbTracker=this._thumbTracker.dispose(),this._buttonTimer.stop(),this._buttonTimer=this._buttonTimer.dispose(),this._trackTimer.stop(),this._trackTimer=this._trackTimer.dispose(),super._doDispose()}_doMouseDown(e){const t=e.mouseX,i=e.mouseY;this._clickElement=null,this._buttonTimer.stop(),this._trackTimer.stop();const r=this.findElementAt(t,i,!1);if(r instanceof ScrollElement){if(this._clickElement=r,r instanceof ScrollButton)this._buttonTimer.start(r);else if(r instanceof ScrollThumb)this._thumbTracker.thumb=r,this.dragTracker=this._thumbTracker;else if(r instanceof ScrollTrack){const e=r.scrollBar.ptInTrack(t,i,!0);this._trackTimer.start(r.scrollBar,e,t,i)}return!0}}_doMouseMove(e){const t=e.mouseX,i=e.mouseY,r=this._clickElement;r instanceof ScrollButton&&this._buttonTimer.active?this._buttonTimer.move(t,i):r instanceof ScrollTrack&&this._trackTimer.active&&this._trackTimer.move(t,i)}_doMouseUp(e){this._clickElement=null,this._buttonTimer.stop(),this._trackTimer.stop()}_doTouchStart(e){this.mouseDown(e),e.preventDefault()}_doTouchEnd(e){this.mouseUp(e)}_doTouchMove(e){this.mouseMove(e)}}const DRAG_THRESHOLD=3;class UITool extends Base{constructor(e,t){super(),this._clickX=0,this._clickY=0,this._pointerX=0,this._pointerY=0,this._owner=e,this._name=t,this._previous=null}_doDispose(){this._dragTracker=null,this._previous=null,this._owner=null,this._pointerEventTarget=null,super._doDispose()}get owner(){return this._owner}get name(){return this._name}get previous(){return this._previous}get dragTracker(){return this._dragTracker}set dragTracker(e){e!==this._dragTracker&&(this._dragTracker&&this._dragTracker.deactivate(),this._dragTracker=e,this._dragTracker&&this._dragTracker.activate())}get dragging(){return this._dragTracker&&this._dragTracker.dragging}get pointerX(){return this._pointerX}get pointerY(){return this._pointerY}activate(e){this._doActivated(e)}deactivate(){this._doDeactivated()}keyDown(e){return this._doKeyDown(e)}keyUp(e){return this._doKeyUp(e)}keyPress(e){return this._doKeyPress(e)}pointerDown(e){const t=this._pointerX=this._clickX=e.pointerX,i=this._pointerY=this._clickY=e.pointerY;return this.dragging&&this._stopDragTracker(e,t,i,!1),this._doPointerDown(e)}dragFrom(e,t){}dropFrom(e,t){}pointerMove(e){const t=this._pointerX=e.pointerX,i=this._pointerY=e.pointerY,r=this.dragTracker,s="pointermove"===e.type?e.buttons:"touchmove"===e.type?1:void 0;if(r)if(r.dragging)if(null==s||s>0||Utils.ieOld&&s>=0){if(!r.drag(this._pointerEventTarget,t,i)){const s=r.getNextRequest(t,i);s&&(this._stopDragTracker(e,t,i,!0),this.dragTracker=this._getUIDragTracker(s,t,i),this._startDragTracker(e,t,i,e.shiftKey,e.altKey))}}else this._stopDragTracker(e,t,i,!0);else r.startWhenCreated||Math.abs(t-this._clickX)>=3||Math.abs(i-this._clickY)>=3?this._startDragTracker(e,t,i,e.shiftKey,e.altKey):this._doPointerMove(e);else this._doPointerMove(e)}pointerUp(e){const t=this._pointerX=e.pointerX,i=this._pointerY=e.pointerY;this.dragging?this._stopDragTracker(e,t,i,!1):(this._dragTracker=null,this._doPointerUp(e))}pointerEnter(e){this._doPointerEnter(e)}pointerLeave(e){this._doPointerLeave(e)}pointerOver(e){this._doPointerOver(e)}pointerOutside(){this._doPointerOutside()}mouseWheel(e){return this._doMouseWheel(e)}contextMenu(e){return this._doContextMenu(e)}click(e){this._doClick(e)}dblclick(e){this._doDblClick(e)}setFocus(e){!Utils.isMobile()&&this._doSetFocus(e)}focusLeave(e){this._doFocusLeave(e)}get pointerEventTarget(){return this._pointerEventTarget}ispointerEventTarget(e){return e._dom===this._pointerEventTarget}_doActivated(e){}_doDeactivated(){}_doKeyDown(e){return!1}_doKeyUp(e){return!1}_doKeyPress(e){return!1}_doPointerDown(e){return!1}_doPointerMove(e){}_doPointerUp(e){}_doPointerEnter(e){}_doPointerLeave(e){}_doPointerOver(e){}_doPointerOutside(){}_doMouseWheel(e){return!1}_doContextMenu(e){}_doClick(e){}_doDblClick(e){}_doSetFocus(e){}_doFocusLeave(e){}_getUIDragTracker(e,t,i){return null}_startDragTracker(e,t,i,r,s){this._dragTracker&&(this._dragTracker.start(e,this._pointerEventTarget,t,i,r,s)?this._doDragTrackerStarted(this._dragTracker):this._dragTracker=null)}_stopDragTracker(e,t,i,r){if(this.dragging){const s=this._dragTracker;r?s.cancel(e):s.drop(e,this._pointerEventTarget,t,i),this.dragTracker=null,this._doDragTrackerFinished(s,r)}}_doDragTrackerStarted(e){}_doDragTrackerFinished(e,t){}}class UIDragTracker extends Base{constructor(e,t){super(),this._active=!1,this._completed=!1,this._dragging=!1,this._currentX=0,this._currentY=0,this._container=e,this._name=t}get container(){return this._container}get name(){return this._name}get active(){return this._active}get dragging(){return this._dragging}get startWhenCreated(){return!1}get completed(){return this._completed}get linkable(){return!1}activate(){this._active||(this._doActivate(),this._active=!0)}deactivate(){this._active&&(this.cancel(null),this._doDeactivate(),this._active=!1)}start(e,t,i,r,s,n){return this.cancel(e),!(!this._active||!this._doStart(e,t,i,r,s,n))&&(this._currentX=this._startX=i,this._currentY=this._startY=r,this._dragging=!0,this._completed=!1,this._showFeedback(i,r),!0)}drag(e,t,i){return!(!this._dragging||(this._currentX=t,this._currentY=i,!this._doDrag(e,t,i)))&&(this._moveFeedback(t,i),!0)}cancel(e){try{if(this._dragging)try{this._dragging=!1,this._doCanceled(this._currentX,this._currentY)}finally{this._doEnded(e)}}finally{this._hideFeedback()}}drop(e,t,i,r){try{if(this._dragging)try{this._currentX=i,this._currentY=r,this._dragging=!1,this._canAccept(t,i,r)?(this._doCompleted(t,i,r),this._completed=!0):this._doCanceled(i,r)}finally{this._doEnded(e)}}finally{this._hideFeedback()}}getRequest(){return null}getNextRequest(e,t){return null}get startX(){return this._startX}get startY(){return this._startY}get currentX(){return this._currentX}get currentY(){return this._currentY}_showFeedback(e,t){}_moveFeedback(e,t){}_hideFeedback(){}_doActivate(){}_doDeactivate(){}_doStart(e,t,i,r,s,n){return!0}_doDrag(e,t,i){return!0}_doCanceled(e,t){}_canAccept(e,t,i){return!0}_doCompleted(e,t,i){}_doEnded(e){}}class UIElement extends EventAware{constructor(e,t,i="div"){super(),this._elements=[],this._dom=i&&e.createElement(i),this._dom.className=t,this._prepareDom(e,this._dom)}get dom(){return this._dom}get parent(){return this._parent}get container(){return this._parent&&this._parent.container}get x(){return this._dom.offsetLeft}set x(e){this._dom.style.left=e+"px"}get y(){return this._dom.offsetTop}set y(e){this._dom.style.top=e+"px"}get width(){return this._dom.offsetWidth}get height(){return this._dom.offsetHeight}isDom(e){return e===this._dom}setClassName(e){this._dom.className=e}setHint(e){this._dom.title=e}setStyle(e,t){this._dom.style[e]=t}clearStyle(e){this._dom.style[e]=""}setStyles(e){if(e){const t=this._dom.style;for(let i in e){const r=e[i];t[i]=void 0===r?"":r}}}setImportantStyle(e,t){this._dom.style.setProperty(e,t,"important")}getBounds(){return this._dom.getBoundingClientRect()}setBounds(e,t,i,r){Utils.extend(this._dom.style,{left:e+"px",top:t+"px",width:i+"px",height:r+"px"})}setRect(e){this.setBounds(e.x,e.y,e.width,e.height)}move(e,t){return this._dom.style.left=e+"px",this._dom.style.top=t+"px",this}setXP(e){this._dom.style.left=e+"%"}setYP(e){this._dom.style.top=e+"%"}clear(){if(this._elements.length>0){for(let e of this._elements)this._dom.removeChild(e._dom),e._parent=null;this._elements=[]}}addChild(e){if(e&&!this._elements.includes(e,0))return this._addChild(e),!0}removeChild(e){return e&&this._removeChild(e)}removeLast(){if(this._elements.length>0){const e=this._elements[this._elements.length-1];return this._removeChild(e),e}}containerToLocal(e=0,t=0){const i=this.container._containerDiv;let r=this._dom,s=this._dom.offsetParent;for(;s&&(e-=r.offsetLeft,t-=r.offsetTop,s!==i);)r=s,s=r.offsetParent;return{x:e,y:t}}setText(e){this._dom.textContent=e}hide(){this._dom.style.display="none"}show(e="inherit"){this._dom.style.display=e}setRotation(e){const t=this._dom.style;0!==e?(t.transformOrigin="center",t.transform="rotate("+e+"deg)"):t.transform=""}_addChild(e){this._elements.push(e),this._dom.appendChild(e._dom),e._parent=this}_removeChild(e){const t=this._elements.indexOf(e);if(t>=0)return this._dom.removeChild(e._dom),e._parent=null,this._elements.splice(t,1),!0}_prepareDom(e,t){}}class UIDummyTool extends UITool{}class RootElement$1 extends UIElement{constructor(e,t){super(e,null),this._container=t}get container(){return this._container}}class UIContainer extends EventAware{constructor(e){super(),this._layoutNeeded=!1,this._defaultCursor="default",this._eventHandlers={},this._eventNodes=[],this._containerRender=this._render.bind(this),this._saveDisplay="",this.prepareContainer(e),this._registerEventHandlers(this._containerDiv),this._root=new RootElement$1(this.doc,this),this._root._dom=this._containerDiv,this.activeTool=this._defaultTool=this._createDefaultTool(),this._prepareChildren(this.doc,this._containerDiv),this.invalidateLayout()}_doDispose(){this._activeTool=null,this._defaultTool=this._defaultTool.dispose(),this.$_removeListenerAll(null),Utils.clearElements(this._containerDiv),super._doDispose()}get doc(){return this._doc}get visible(){return"none"!==getComputedStyle(this._containerDiv).display}set visible(e){e!=this.visible&&(e?this._containerDiv.style.display=this._saveDisplay:(this._saveDisplay=getComputedStyle(this._containerDiv).display,this._containerDiv.style.display="none"))}get activeTool(){return this._activeTool}set activeTool(e){if((e=e||this._defaultTool)!=this._activeTool){const t=this._activeTool;t&&t.deactivate(),this._activeTool=e,e&&e.activate(t)}}get defaultTool(){return this._defaultTool}get width(){return this._containerDiv.offsetWidth}get height(){return this._containerDiv.offsetHeight}getBound(){const e=this._containerDiv.getBoundingClientRect();return new Rectangle(e.left,e.top,e.width,e.height)}getHtml(){return this._containerDiv.outerHTML}setCursor(e){this._containerDiv.style.cursor=e||this._defaultCursor}contains(e){if(e instanceof getDocWin(this.doc).HTMLElement)return this._containerDiv.contains(e)}prepareContainer(e){if(!e)throw new Error("container is null!");if($_instanceOf(e,"HTMLDivElement")?this._containerDiv=e:this._containerDiv=document.getElementById(e),!$_instanceOf(this._containerDiv,"HTMLDivElement"))throw new Error("Invalid grid container element: "+e);this._containerDiv.className=this._getCssSelector();const t=getDocWin(this._doc=this._containerDiv.ownerDocument);t.requestAnimationFrame=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return t.setTimeout(e,10)}}_addElement(e){this._containerDiv.appendChild(e._dom),this._root._addChild(e)}_prepareChildren(e,t){}_createDefaultTool(){return new UIDummyTool(null,"dummy")}isLayoutNeeded(){return this._layoutNeeded}invalidateLayout(){if(!this._layoutNeeded&&(this._layoutNeeded=!0,!this._requestTimer)){const e=getDocWin(this._doc);this._requestTimer=e.requestAnimationFrame(this._containerRender)}}updateNow(){this._layoutNeeded=!0,this._render(Utils.getTimer())}_render(e){if(!this.disposing)try{this.$$_render(e)}finally{this._requestTimer=null}}$$_render(e){const t=this._containerDiv,i=t.clientWidth,r=t.clientHeight;this._layoutNeeded?(this._doLayout(this._doc,new Rectangle(0,0,i,r)),this._layoutNeeded=!1):this._doPrepareRender(new Rectangle(0,0,i,r)),this._doRenderHtml(new Rectangle(0,0,i,r))}_doLayout(e,t){}_doPrepareRender(e){}_doRenderHtml(e){}_registerEventHandlers(e){const t=getWin(e);e.style.cursor=this._defaultCursor,this.$_addListener(t,"resize",this._resizeHandler.bind(this),!1),this.$_addListener(t,"pointermove",this._pointerMoveHandler.bind(this),!1),this.$_addListener(t,"pointerup",this._pointerUpHandler.bind(this),!1),this.$_addListener(t,"focus",this._focusHandlerFireFox.bind(this),!0),this.$_addListener(t,"focusin",this._focusinHandler.bind(this),!0),this.$_addListener(t,"focusout",this._focusoutHandler.bind(this),!0),this.$_addListener(t,"pointerdown",this._globalPointerDownHandler.bind(this),!1),this.$_addListener(e,"keydown",this._keyDownHandler.bind(this),!1),this.$_addListener(e,"keyup",this._keyUpHandler.bind(this),!1),this.$_addListener(e,"keypress",this._keyPressHandler.bind(this),!1),this.$_addListener(e,"click",this._clickHandler.bind(this),!1),this.$_addListener(e,"dblclick",this._dblclickHandler.bind(this),!1),this.$_addListener(e,"pointerdown",this._pointerDownHandler.bind(this),!1),this.$_addListener(e,"pointerenter",this._pointerEnterHandler.bind(this),!1),this.$_addListener(e,"pointerleave",this._pointerLeaveHandler.bind(this),!1),this.$_addListener(e,"pointerover",this._pointerOverHandler.bind(this),!1),this.$_addListener(e,"focus",this._focusHandler.bind(this),!1),this.$_addListener(e,"contextmenu",this._contextMenuHander.bind(this),!1),this.$_addListener(e,"blur",this._blurHandler.bind(this),!1),this.$_addListener(e,"selectstart",this._selectstartHandler.bind(this),!1),this.$_addListener(e,"wheel",this._wheelHandler.bind(this),!1)}$_addListener(e,t,i,r){e in this._eventHandlers||(this._eventHandlers[e]={}),t in this._eventHandlers[e]||(this._eventHandlers[e][t]=[]),this._eventHandlers[e][t].push([i,r]),e.addEventListener(t,i,r),this._eventNodes.indexOf(e)<0&&this._eventNodes.push(e)}$_removeListener(e,t){if(e in this._eventHandlers){const i=this._eventHandlers[e];if(t in i){const r=i[t];for(let i=r.length;i--;){const s=r[i];e.removeEventListener(t,s[0],s[1])}}}}$_removeListenerAll(e=null){const t=e?[e]:this._eventNodes;for(let e=0,i=t.length;e<i;e++){const i=t[e];if(i in this._eventHandlers){const e=this._eventHandlers[i];for(let t in e){const r=e[t];for(let e=r.length;e--;){const s=r[e];i.removeEventListener(t,s[0],s[1])}}}}}_unloadHandler(){this.$_removeListenerAll(),this._containerDiv=null}_resizeHandler(e){this._doResized(e),this.invalidateLayout()}_doResized(e){}_isEnabled(){return!0}_keyDownHandler(e){this._isEnabled()&&this._activeTool.keyDown(e)}_keyUpHandler(e){this._isEnabled()&&this._activeTool.keyUp(e)}_keyPressHandler(e){this._isEnabled()&&this._activeTool.keyPress(e)}eventToContainer(e){const t=this._containerDiv.getBoundingClientRect();return new Point(e.pageX-t.left,e.pageY-t.top)}toOffset(e){const t=this._containerDiv.getBoundingClientRect();return e.pointerX=e.clientX-t.left,e.pointerY=e.clientY-t.top,e}_clickHandler(e){this._isEnabled()?this._activeTool.click(this.toOffset(e)):e.preventDefault()}_dblclickHandler(e){this._isEnabled()?this._activeTool.dblclick(this.toOffset(e)):e.preventDefault()}$_getHtmlElement(e){return e instanceof getWin(this._containerDiv).HTMLElement?e:e instanceof Node?e.parentElement:void 0}_pointerDownHandler(e){this._isEnabled()?(this.toOffset(e),this.activeTool._pointerEventTarget=this.$_getHtmlElement(e.target),this.activeTool.pointerDown(e)&&e.preventDefault()):e.preventDefault()}_pointerMoveHandler(e){const t=getWin(this._containerDiv);if(this.toOffset(e),this._isEnabled()){const i=this._activeTool;i._pointerEventTarget=e.target instanceof t.HTMLElement?e.target:null,i.pointerMove(e)}}_pointerUpHandler(e){const t=getWin(this._containerDiv);try{this.toOffset(e),this._isEnabled()?(this._activeTool._pointerEventTarget=e.target instanceof t.HTMLElement?e.target:null,this._activeTool.pointerUp(e)):e.preventDefault()}finally{this._activeTool&&(this._activeTool.dragTracker=null)}}_pointerEnterHandler(e){this._isEnabled()&&this._activeTool.pointerEnter(this.toOffset(e))}_pointerLeaveHandler(e){this._isEnabled()&&this._activeTool.pointerLeave(this.toOffset(e))}_pointerOverHandler(e){this._isEnabled()&&this._activeTool.pointerOver(this.toOffset(e))}_contextMenuHander(e){const t=getWin(this._containerDiv);this.toOffset(e),this._isEnabled()&&(this._activeTool._pointerEventTarget=e.target instanceof t.HTMLElement?e.target:null,this._activeTool.contextMenu(this.toOffset(e)))}_wheelHandler(e){this._isEnabled()&&this._activeTool.mouseWheel(this.toOffset(e))&&Utils.stopEvent(e)}_focusHandler(e){}_blurHandler(e){}_selectstartHandler(e){return!1}_focusinHandler(e){}_globalPointerDownHandler(e){Utils.isAncestorOf(this._containerDiv,e.target)||this._isEnabled()&&this._activeTool.pointerOutside()}_focusoutHandler(e){Utils.isAncestorOf(this._containerDiv,e.target)&&e.relatedTarget&&!Utils.isAncestorOf(this._containerDiv,e.relatedTarget)&&this._isEnabled()&&this._activeTool.focusLeave(e)}_focusHandlerFireFox(e){Utils.isAncestorOf(this._containerDiv,e.target)&&this._isEnabled()&&(this._containerDiv.setAttribute("tabindex","0"),this._activeTool.setFocus(e.target))}}class RootElement extends VisualElement{constructor(e,t,i){super(e,t),this._contaner=i}get container(){return this._contaner}_getCssSelector(){return"root-element"}_initDom(e,t){super._initDom(e,t),t.style.width="100%",t.style.height="100%"}_setSizeStyle(e){}_doDraw(e){}}class VisualContainer extends EventAware{constructor(e){super(),this._disabled=!1,this._updateRequested=!1,this._layoutNeeded=!1,this._invalidated=!1,this._scrolling=!1,this._captured=!1,this._focusing=!1,this._focusingTarget=null,this._hovered=null,this._currentX=0,this._currentY=0,this._rendered=0,this._defaultCursor="default",this._drawing=!1,this._offsetX=0,this._offsetY=0,this._eventHandlers={},this._eventNodes=[],this._contextMenu=null,this._containerRender=this._render.bind(this),this._scrollTool=new ScrollTool(this),this._cursor="default",this._testWidth=NaN,this._testHeight=NaN,this._saveDisplay="",this.$_testing=!1,this.$_prepareContainer(e),this.invalidateLayout(),this._registerEventHandlers(this._containerDom),this.activeTool=this._defaultTool=this._createDefaultTool(),VisualContainer.$_Containers[this.$_hash]=this}getMouseContainer(){return VisualContainer.$_Containers[VisualContainer.$_mouseContainer]}static getActiveGrid(){const e=VisualContainer.$_Containers[VisualContainer.$_ActiveGrid];return e&&e._gridView}static setActiveGrid(e){if(e!==VisualContainer.$_ActiveGrid){let t,i=VisualContainer.$_Containers[e];if(i=i&&i._gridView,window.RealGrid&&(t=window.RealGrid.onActiveGridChanged)){let e=VisualContainer.$_Containers[VisualContainer.$_ActiveGrid];e=e&&e._gridView,t(e&&e.handler,i&&i.handler)}i._fireGridActivated()}VisualContainer.$_ActiveGrid=e}static clearContainer(e){VisualContainer[e]&&delete VisualContainer[e],VisualContainer.$_ActiveGrid===e&&(VisualContainer.$_ActiveGrid=null)}static disposeStatic(){this.$_Containers=null,this.$_ActiveGrid=null}_doDispose(){this._activeTool=null,this._defaultTool&&(this._defaultTool=this._defaultTool.dispose()),this._scrollTool&&(this._scrollTool=this._scrollTool.dispose()),this.$_removeListenerAll(null),Utils.detach(this._containerDom),this._containerDom=null,this._doc=null,Utils.clearElements(this._containerDiv),super._doDispose(),delete VisualContainer.$_Containers[this.$_hash]}get doc(){return this._doc}get dom(){return this._containerDom}get visible(){return"none"!==getComputedStyle(this._containerDiv).display}set visible(e){e!=this.visible&&(e?this._containerDiv.style.display=this._saveDisplay:(this._saveDisplay=getComputedStyle(this._containerDiv).display,this._containerDiv.style.display="none"))}get disabled(){return this._disabled}set disabled(e){e!=this._disabled&&(this._disabled=e,this._doDisabledChanged())}get printing(){return!1}get activeTool(){return this._activeTool}set activeTool(e){if((e=e||this._defaultTool)!=this._activeTool){const t=this._activeTool;t&&t.deactivate(),this._activeTool=e,e&&e.activate(t)}}get defaultTool(){return this._defaultTool}get measurer(){return this._measurer}get width(){return this._containerDom.clientWidth}get height(){return this._containerDom.clientHeight}get scrollHeight(){return this._containerDiv.scrollHeight}get scrollTop(){return this._containerDiv.scrollTop}get scrolling(){return this._scrolling}findElementAt(e,t,i,r){return this._rootElement.findChildAt(e-this._rootElement._x,t-this._rootElement._y,i,r)}findElementOf(e){return this._rootElement.findChildOf(e)}getTableCell(e){return null}setCursor(e){e!=this._cursor&&(this._containerDom.style.cursor=this._cursor=e)}setFocus(){this._containerDom.focus()}updateNow(){this._layoutNeeded=!0,this.invalidate(!0),this._render(Utils.getTimer())}toScreen(e){return e.x+=this._offsetX,e.y+=this._offsetY,e}pointToScreen(e,t){return{x:e+this._offsetX,y:t+this._offsetY}}getBound(){const e=this._containerDom.getBoundingClientRect();return new Rectangle(e.left,e.top,e.width,e.height)}getHtml(){return this._containerDom.outerHTML}addElement(e){return this._rootElement.addChild(e)}removeElement(e){return this._rootElement.removeChild(e)}addFeedback(e){if(e instanceof UIElement)return this._feedbackElement.addChild(e);this._feedbackElement.dom.appendChild(e)}addFeedbacks(...e){for(let t of e)this._feedbackElement.addChild(t)}removeFeedback(e){if(e instanceof UIElement)return this._feedbackElement.removeChild(e);this._feedbackElement.dom.removeChild(e)}removeFeedbacks(...e){for(let t of e)this._feedbackElement.removeChild(t)}resetSize(e=null){this.updateNow(),e&&setTimeout(e,0)}measureText(e,t){return this._textMeasurer.className=e,this._textMeasurer.innerHTML=t,this._textMeasurer.offsetWidth}$_refreshCheckMeasurer(){if(!this._checkRect){const e=this._checkMeasurer.getBoundingClientRect(),t=getComputedStyle(this._checkMeasurer);this._checkRect={width:e.width+parseInt(t.marginLeft)+parseInt(t.marginRight),height:e.height+parseInt(t.marginTop)+parseInt(t.marginBottom)}}return this._checkRect}measureCheckWidth(){return this.$_refreshCheckMeasurer().width}measureCheckHeight(){return this.$_refreshCheckMeasurer().height}contains(e){if(e instanceof Element)return this._containerDom.contains(e)}getDomPosition(e,t=!1){return this.$_testing?{x:0,y:0,width:1,height:1}:(e instanceof VisualElement&&(e=e._dom),this.$_offsetDomPosition(e,{x:0,y:0},t))}$_offsetDomPosition(e,t,i){i&&(e=Utils.cloneDom(e));const r=getDocWin(this._doc),s=this._containerDom,n=s.getBoundingClientRect(),o=e.getBoundingClientRect(),a=r.getComputedStyle(s);return t.x=o.left-n.left-Math.round(parseFloat(a.borderLeftWidth)),t.y=o.top-n.top-Math.round(parseFloat(a.borderTopWidth)),t.width=o.width,t.height=o.height,i&&e.remove(),t}getBoundingRect(e){const t=Utils.getBoundingRect(this._containerDom,e._dom);return t.x-=2,t.y-=2,t}$_setTesting(){this.$_testing=!0,VisualElement.Testing=!0}get _isTesting(){return this.$_testing}_doDisabledChanged(){}$_prepareContainer(e){if(!e)throw new Error("container is null!");if($_instanceOf(e,"HTMLDivElement")?this._containerDiv=e:this._containerDiv=document.getElementById(e),!$_instanceOf(this._containerDiv,"HTMLDivElement"))throw new Error("Invalid visual container element: "+e);const t=this._doc=this._containerDiv.ownerDocument,i=getDocWin(t);i.requestAnimationFrame=i.requestAnimationFrame||i.mozRequestAnimationFrame||i.webkitRequestAnimationFrame||i.msRequestAnimationFrame||function(e){return i.setTimeout(e,10)};const r=this._containerDom=t.createElement("div");let s=r.style;this._cursor=s.cursor,this._containerDiv.appendChild(r),r.className="rr-visual-container",r.setAttribute("tabindex","0"),s.position="relative",s.width="100%",s.height="100%",s.boxSizing="border-box",s.overflow="hidden",s["-webkit-touch-callout"]="none",s["-webkit-user-select"]="none",s["user-select"]="none",s["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",this._rootElement=this._createRootElement(t),r.appendChild(this._rootElement._dom),this._feedbackElement=new UIElement(t,"rr-feedback-container"),r.appendChild(this._feedbackElement._dom),this._feedbackElement.dom.style.zIndex=VisualContainer.FEEDBACK_ZINDEX,this._printRoot=new LayerElement(t,"printRoot"),this._measurer=t.createElement("div"),this._containerDom.appendChild(this._measurer),this._doPrepareContainer(r)}_doPrepareContainer(e){}_createRootElement(e){return new RootElement(e,"root",this)}_createDefaultTool(){return null}isLayoutNeeded(){return this._layoutNeeded}invalidateLayout(e=!1){this._scrolling=this._scrolling||e,this._layoutNeeded||(this._layoutNeeded=!0,this.invalidate(!0))}invalidate(e){if((!this._updateRequested||!this._invalidated)&&(e||!this._drawing)){if(!this._requestTimer&&!this.$_testing){const e=getDocWin(this._doc);this._requestTimer=e.requestAnimationFrame(this._containerRender)}this._updateRequested=!0,this._invalidated=!0}}invalidateElement(e){const t=getDocWin(this._doc);this._drawing||this._updateRequested||(this._requestTimer||this.$_testing||(this._requestTimer=t.requestAnimationFrame(this._containerRender)),this._updateRequested=!0)}invalidateElements(e=!0){this._rootElement.invalidate(e,!0)}refresh(){this.invalidateLayout(),this.invalidateElements()}_render(e){if(!this.disposing){this._updateRequested=!1,this._offsetX=this._containerDom.offsetLeft,this._offsetY=this._containerDom.offsetTop,this._drawing=!0;try{this.$$_render(e)}finally{this._scrolling=!1,this._drawing=!1,this._invalidated=!1,this._requestTimer=null,this._doAfterRender()}}}$$_render(e){const t=this._containerDom,i=isNaN(this._testWidth)?t.clientWidth:this._testWidth,r=isNaN(this._testHeight)?t.clientHeight:this._testHeight;this._layoutChildren(new Rectangle(0,0,i,r)),this._layoutNeeded?(this._doLayout(new Rectangle(0,0,i,r)),this._layoutNeeded=!1):this._doPrepareRender(new Rectangle(0,0,i,r)),this._doRenderHtml(new Rectangle(0,0,i,r))}_layoutChildren(e){}_doLayout(e){}_doAfterRender(){}_doPrepareRender(e){}_doRenderHtml(e){this._doDrawContainer(e),this._drawElement(this._rootElement),this._validateChildren(this._rootElement)}_doDrawContainer(e){}_drawElement(e){e.draw();for(let t=0,i=e.childCount;t<i;t++){const i=e.getChild(t);i.visible&&this._drawElement(i)}}_validateChildren(e){for(let t=0,i=e.childCount;t<i;t++){e.getChild(t).validate()}}_registerEventHandlers(e){const t=getWin(e);e.style.cursor=this._defaultCursor,this.$_addListener(t,"resize",this._resizeHandler.bind(this),!1),this.$_addListener(t,"mousemove",this._mouseMoveHandler.bind(this),!1),this.$_addListener(t,"mouseup",this._mouseUpHandler.bind(this),!1),this.$_addListener(t,"focus",this._focusHandlerFireFox.bind(this),!0),this.$_addListener(t,"focusin",this._focusinHandler.bind(this),!0),this.$_addListener(t,"focusout",this._focusoutHandler.bind(this),!0),this.$_addListener(t,"mousedown",this._globalMouseDownHandler.bind(this),!1),this.$_addListener(e,"keydown",this._keyDownHandler.bind(this),!1),this.$_addListener(e,"keyup",this._keyUpHandler.bind(this),!1),this.$_addListener(e,"keypress",this._keyPressHandler.bind(this),!1),this.$_addListener(e,"click",this._clickHandler.bind(this),!1),this.$_addListener(e,"dblclick",this._dblclickHandler.bind(this),!1),this.$_addListener(e,"mousedown",this._mouseDownHandler.bind(this),!1),this.$_addListener(e,"mouseenter",this._mouseEnterHandler.bind(this),!1),this.$_addListener(e,"mouseleave",this._mouseLeaveHandler.bind(this),!1),this.$_addListener(e,"mouseover",this._mouseOverHandler.bind(this),!1),this.$_addListener(e,"focus",this._focusHandler.bind(this),!1),this.$_addListener(e,"contextmenu",this._contextMenuHander.bind(this),!1),this.$_addListener(e,"blur",this._blurHandler.bind(this),!1),this.$_addListener(e,"selectstart",this._selectstartHandler.bind(this),!1),this.$_addListener(e,"wheel",this._wheelHandler.bind(this),!1),this.$_addListener(e,"dragstart",this._dragStartHandler.bind(this),!1),this.$_addListener(e,"dragend",this._dragEndHandler.bind(this),!1),this.$_addListener(e,"dragover",this._dragOverHandler.bind(this),!1),this.$_addListener(e,"dragenter",this._dragEnterHandler.bind(this),!1),this.$_addListener(e,"dragleave",this._dragLeaveHandler.bind(this),!1),this.$_addListener(e,"drop",this._dragDropHandler.bind(this),!1)}$_addListener(e,t,i,r){e in this._eventHandlers||(this._eventHandlers[e]={}),t in this._eventHandlers[e]||(this._eventHandlers[e][t]=[]),this._eventHandlers[e][t].push([i,r]),e.addEventListener(t,i,r),this._eventNodes.indexOf(e)<0&&this._eventNodes.push(e)}$_removeListener(e,t){if(e in this._eventHandlers){const i=this._eventHandlers[e];if(t in i){const r=i[t];for(let i=r.length;i--;){const s=r[i];e.removeEventListener(t,s[0],s[1])}}}}$_removeListenerAll(e=null){const t=e?[e]:this._eventNodes;for(let e=0,i=t.length;e<i;e++){const i=t[e];if(i in this._eventHandlers){const e=this._eventHandlers[i];for(let t in e){const r=e[t];for(let e=r.length;e--;){const s=r[e];i.removeEventListener(t,s[0],s[1])}}}}}_unloadHandler(){this.$_removeListenerAll(),this._containerDiv=null,this._containerDom=null}_resizeHandler(e){this._doResized(e),this.invalidateLayout()}_doResized(e){}_isEnabled(){return this._activeTool&&!this._disabled}_keyDownHandler(e){this._isEnabled()&&this._activeTool.keyDown(e)&&(e.preventDefault(),e.stopImmediatePropagation())}_keyUpHandler(e){this._isEnabled()&&this._activeTool.keyUp(e)}_keyPressHandler(e){this._isEnabled()&&this._activeTool.keyPress(e)}eventToContainer(e){const t=this._containerDom.getBoundingClientRect();return new Point(e.pageX-t.left,e.pageY-t.top)}toOffset(e){if(!this.$_testing){const t=this._containerDom.getBoundingClientRect();e.mouseX=e.clientX-t.left,e.mouseY=e.clientY-t.top}return e}toOffsetTouch(e){const t=this._containerDom.getBoundingClientRect(),i=e.touches[0]||e.changedTouches[0];return e.mouseX=i.clientX-t.left,e.mouseY=i.clientY-t.top,e}_clickHandler(e){this._isEnabled()?this._activeTool.click(this.toOffset(e)):e.preventDefault()}_dblclickHandler(e){this._isEnabled()?this._activeTool.dblclick(this.toOffset(e)):e.preventDefault()}$_getHtmlElement(e){return e instanceof getWin(this._containerDom).HTMLElement?e:e instanceof Node?e.parentElement:void 0}_isAutoFocus(){return!0}_mouseDownHandler(e){var t;if(this._isEnabled()){VisualContainer.$_mouseContainer=this.$_hash,this._isAutoFocus()&&this.setFocus(),this.toOffset(e),this._currentX=e.mouseX,this._currentY=e.mouseY;const i=this.findElementAt(this._currentX,this._currentY,!1,!1);i&&i.getAncestor(ScrollBar$1)?(null===(t=this.activeTool)||void 0===t||t.setFocus(),this._scrollTool._previous=this.activeTool,this.activeTool=this._scrollTool):this.activeTool||(this._defaultTool._previous=this.activeTool,this.activeTool=this._defaultTool),this.activeTool._mouseEventTarget=this.$_getHtmlElement(e.target),this.activeTool.mouseDown(e)}else e.preventDefault()}_mouseMoveHandler(e){const t=getWin(this._containerDom);if(this.toOffset(e),this._currentX=e.mouseX,this._currentY=e.mouseY,this._isEnabled()){const i=this._activeTool;i._mouseEventTarget=e.target instanceof t.HTMLElement?e.target:null,i.mouseMove(e);const r=i.dragTracker;if(r&&VisualContainer.$_mouseContainer==this.$_hash)for(let t in VisualContainer.$_Containers){const i=VisualContainer.$_Containers[t];if(i!==this){const t=i._activeTool;t&&t.dragFrom(e,r)}}}}_mouseUpHandler(e){const t=VisualContainer.$_mouseContainer==this.$_hash,i=getWin(this._containerDom);try{if(this.toOffset(e),this._currentX=e.mouseX,this._currentY=e.mouseY,this._isEnabled()){const r=this._activeTool.dragTracker;if(this._activeTool._mouseEventTarget=e.target instanceof i.HTMLElement?e.target:null,this._activeTool.mouseUp(e),this._activeTool instanceof ScrollTool&&(this.activeTool=this._activeTool.previous),r&&r.linkable&&t)for(let t in VisualContainer.$_Containers){const i=VisualContainer.$_Containers[t];if(i!==this){const t=i._activeTool;t&&t.dropFrom(e,r)}}}else e.preventDefault()}finally{this._activeTool&&(this._activeTool.dragTracker=null),t&&(VisualContainer.$_mouseContainer=-1)}}_mouseEnterHandler(e){this._isEnabled()&&this._activeTool.mouseEnter(this.toOffset(e))}_mouseLeaveHandler(e){this._isEnabled()&&this._activeTool.mouseLeave(this.toOffset(e))}_mouseOverHandler(e){this._isEnabled()&&this._activeTool.mouseOver(this.toOffset(e))}_dragStartHandler(e){this._isEnabled()?this._activeTool.dragStart(e):e.preventDefault()}_dragEndHandler(e){this._isEnabled()?this._activeTool.dragEnd(e):e.preventDefault()}_dragOverHandler(e){this._isEnabled()?(this.activeTool._mouseEventTarget=this.$_getHtmlElement(e.target),this._activeTool.dragOver(e)):e.preventDefault()}_dragEnterHandler(e){this._isEnabled()?(this.activeTool._mouseEventTarget=this.$_getHtmlElement(e.target),this._activeTool.dragEnter(e)):e.preventDefault()}_dragLeaveHandler(e){this._isEnabled()?(this.activeTool._mouseEventTarget=this.$_getHtmlElement(e.target),this._activeTool.dragLeave(e)):e.preventDefault()}_dragDropHandler(e){this._isEnabled()?(this.activeTool._mouseEventTarget=this.$_getHtmlElement(e.target),this._activeTool.dragDrop(e)):e.preventDefault()}_contextMenuHander(e){const t=getWin(this._containerDom);this.toOffset(e),this._currentX=e.mouseX,this._currentY=e.mouseY,this._isEnabled()&&(this._activeTool._mouseEventTarget=e.target instanceof t.HTMLElement?e.target:null,this._activeTool.contextMenu(this.toOffset(e)))}_wheelHandler(e){this._isEnabled()&&this._activeTool.mouseWheel(this.toOffset(e))&&Utils.stopEvent(e)}_focusHandler(e){}_blurHandler(e){}_selectstartHandler(e){return!1}_focusinHandler(e){}_globalMouseDownHandler(e){Utils.isAncestorOf(this._containerDiv,e.target)||this._isEnabled()&&this._activeTool.focusLeave(e)}_focusoutHandler(e){Utils.isAncestorOf(this._containerDiv,e.target)&&e.relatedTarget&&!Utils.isAncestorOf(this._containerDiv,e.relatedTarget)&&this._isEnabled()&&this._activeTool.focusLeave(e)}_focusHandlerFireFox(e){Utils.isAncestorOf(this._containerDiv,e.target)&&this._isEnabled()&&(this._containerDom.setAttribute("tabindex","0"),this._activeTool.setFocus(e.target))}}VisualContainer.FEEDBACK_ZINDEX=1e3,VisualContainer.$_Containers={},VisualContainer.$_mouseContainer=-1,VisualContainer.$_ActiveGrid=null;const $$_DT_DATE_TOKENS=["yy","yyyy","M","MM","d","dd","a","H","HH","h","hh","m","mm","s","ss","S","SS","SSS"],$$_DT_DATE_SEPARATORS=[".","/","-",":"],U_Z="Z".charCodeAt(0),L_Z="z".charCodeAt(0),U_A="A".charCodeAt(0),L_A="a".charCodeAt(0),L_Y="y".charCodeAt(0),U_M="M".charCodeAt(0),L_M="m".charCodeAt(0),L_D="d".charCodeAt(0),U_H="H".charCodeAt(0),L_H="h".charCodeAt(0),U_S="S".charCodeAt(0),L_S="s".charCodeAt(0),pad=function(e){return e<10?"0"+e:String(e)},pad3=function(e){return e<10?"00"+e:e<100?"0":String(e)};class DatetimeFormatter{constructor(e){this._baseYear=2e3,this._preserveTime=!1,this._hasAmPm=!1,this._formatString="",this.formatString=e}static getFormatter(e){let t=DatetimeFormatter.Formatters[e];return t||(DatetimeFormatter.Formatters[e]=t=new DatetimeFormatter(e)),t}static get Default(){return DatetimeFormatter.getFormatter(DatetimeFormatter.DEFAULT_FORMAT)}get format(){return this._format}get formatString(){return this._formatString}set formatString(e){(e=e||DatetimeFormatter.DEFAULT_FORMAT)!=this._formatString&&(this._tokens=[],this.parse(e),this._formatString=e)}getText(e){if(!this._tokens)return"";const t=e instanceof Date?e:new Date(e),i=this._tokens;let r="";for(var s=0,n=i.length;s<n;s++){var o=i[s],a=o.length;switch(o.charCodeAt(0)){case L_Y:r+=a>2?t.getFullYear():pad(t.getFullYear()%100);break;case U_M:r+=a>1?pad(t.getMonth()+1):t.getMonth()+1;break;case L_D:r+=a>1?pad(t.getDate()):t.getDate();break;case U_H:r+=a>1?pad(t.getHours()):t.getHours();break;case L_H:if(this._hasAmPm){let e=t.getHours();0==e?e=12:e>12&&(e-=12),r+=a>1?pad(e):e}else r+=a>1?pad(t.getHours()):t.getHours();break;case L_M:r+=a>1?pad(t.getMinutes()):t.getMinutes();break;case L_S:r+=a>1?pad(t.getSeconds()):t.getSeconds();break;case L_A:case U_A:t.getHours()<12?r+=this._amText:r+=this._pmText;break;case U_S:let e=t.getMilliseconds();r+=3==a?pad3(e):2==a?pad(e):e.toString().substr(0,a);break;default:r+=o}}return r}parseDateFormatTokens(e){var t=[];if(e){const i=e.trim(),r=i.length;let s=0;for(;s<r;){let n=i.charAt(s);if($$_DT_DATE_SEPARATORS.indexOf(n)>=0)t.push(n),s++;else{let o=s++;for(;s<r&&i.charAt(s)==n;)s++;if(n=i.substring(o,s),$$_DT_DATE_TOKENS.indexOf(n)<0){let t=n.charCodeAt(0);if(t>=U_A&&t<=U_Z||t>=L_A&&t<=L_Z)throw new Error("Invalid datetime write format: "+e)}t.push(n)}if(s<r&&Utils.isWhiteSpace(n=i.charAt(s)))for(t.push(n);s<r&&Utils.isWhiteSpace(i.charAt(s));)s++}}return t}parse(e){if(this._amText="AM",this._pmText="PM",e){const t=e.split(";");if(this._format=t[0]||DatetimeFormatter.DEFAULT_FORMAT,this._tokens=this.parseDateFormatTokens(this._format),this._hasAmPm=this._tokens.indexOf("a")>=0||this._tokens.indexOf("A")>=0,t.length>1&&t[1]){const e=t[1].split(",");e.length>0&&e[0]&&(this._amText=e[0]),e.length>1&&e[1]&&(this._pmText=e[1])}}}}DatetimeFormatter.DEFAULT_FORMAT="yyyy/MM/dd",DatetimeFormatter.Formatters={};class DatetimeParser{constructor(e){this._format=null,this._baseYear=2e3,this._patterns=[],this._amText="AM",this._pmText="PM",e&&(this.format=e)}get format(){return this._format}set format(e){if(e!=this._format){if(!e)throw new Error("Invalid empty date format");this._format=e,this.parseFormat(e)}}get baseYear(){return this._baseYear}set baseYear(e){e!=this._baseYear&&(this._baseYear=e)}get amText(){return this._amText}set amText(e){e!=this._amText&&(this._amText=e)}get pmText(){return this._pmText}set pmText(e){e!=this._pmText&&(this._pmText=e)}parse(e){try{let s=0,n=1,o=1,a=0,A=0,l=0,h=0,d=0,c=0,u=this._patterns.length,p=0;const _=e.length;for(let g=0;g<u&&p<_;g++){var t=this._patterns[g],i=t.c,r=t.len;switch(i){case"y":s=parseInt(e.substr(p,r));break;case"M":n=parseInt(e.substr(p,r));break;case"d":o=parseInt(e.substr(p,r));break;case"a":if(this._amText&&e.indexOf(this._amText,p)==p)d=12,r=this._amText.length;else{if(!this._pmText||e.indexOf(this._pmText,p)!=p)return null;c=12,r=this._pmText.length}break;case"H":case"h":a=parseInt(e.substr(p,r));break;case"m":A=parseInt(e.substr(p,r));break;case"s":l=parseInt(e.substr(p,r));break;case"S":h=parseInt(e.substr(p,r));break;case".":case"/":case"-":case":":case" ":if(DatetimeParser.DATE_SEPARATORS.indexOf(e.charAt(p))<0)return null;break;default:return null}p+=r}return s<100&&(s+=this._baseYear),d>0?12==a&&(a=0):c>0&&a<12&&(a+=12),new Date(s,n-1,o,a,A,l,h)}catch(e){return null}}parseFormat(e){var t,i,r,s=e,n=s.length,o=0;for(this._patterns=[];o<n;)if(t=o,i=s.charAt(o),Utils.isWhiteSpace(i)){for(o++;o<n&&Utils.isWhiteSpace(s.charAt(o));)o++;this._patterns.push({c:" ",p:t,len:o-t})}else{switch(r=0,i){case"y":4!=(r=this.getPattern(s,o,i))&&2!=r&&this.throwInvalidFormat(s);break;case"M":case"d":case"H":case"h":case"m":case"s":2!=(r=this.getPattern(s,o,i))&&this.throwInvalidFormat(s);break;case"S":3!=(r=this.getPattern(s,o,i))&&this.throwInvalidFormat(s);break;case"a":case".":case"/":case"-":case":":1!=(r=this.getPattern(s,o,i))&&this.throwInvalidFormat(s);break;default:this.throwInvalidFormat(s)}r>0&&(this._patterns.push({c:i,p:o,len:r}),o+=r)}}throwInvalidFormat(e){throw new Error("Invalid date format: "+e)}throwInvalidValue(e){throw new Error("Invalid date format: "+e)}getPattern(e,t,i){for(var r=1;++t<e.length&&e.charAt(t)==i;)r++;return r}}DatetimeParser.DATE_SEPARATORS="./-: ";class ISODatetimeParser{constructor(){}static parse(e,t){var i=null;try{var r,s,n,o,a=e.indexOf("T"),A=e.substring(0,a),l=e.substring(a+1),h=A.split("-"),d=h.length,c=parseInt(h[0]),u=d>1?parseInt(h[1]):1,p=d>2?parseInt(h[2]):1;-1!=l.indexOf("Z")?(r=1,s=0,n=0,l=l.replace("Z","")):-1!=l.indexOf("+")?(r=1,o=l.substring(l.indexOf("+")+1,l.length),s=Number(o.substring(0,o.indexOf(":"))),n=Number(o.substring(o.indexOf(":")+1,o.length)),l=l.substring(0,l.indexOf("+"))):-1!=l.indexOf("-")?(r=-1,o=l.substring(l.indexOf("-")+1,l.length),s=Number(o.substring(0,o.indexOf(":"))),n=Number(o.substring(o.indexOf(":")+1,o.length)),l=l.substring(0,l.indexOf("-"))):r=0;var _=l.split(":"),g=(d=_?_.length:0)>0?parseInt(_[0]):0,m=d>1?parseInt(_[1]):0,f=d>2?String(_[2]).split("."):null,w=f&&f.length>0?parseInt(f[0]):0,C=f&&f.length>1?1e3*parseFloat("0."+f[1]):0,y=Date.UTC(c,u-1,p,g,m,w,C),E=r?(36e5*s+6e4*n)*r:ISODatetimeParser._zoneOffset;if(i=new Date(y-E),t&&isNaN(i.getTime()))throw"Invalidate date text: "+e}catch(i){if(t){var b="Invalid date Text: "+e;throw b+="\nError: "+i.toString(),b}}return i}}ISODatetimeParser._zoneOffset=60*(new Date).getTimezoneOffset()*1e3;class DatetimeReader{constructor(e){this._format="",this._type=0,this._parser=new DatetimeParser(null),this.format=e}static initialize(){DatetimeReader.Default.amText="AM",DatetimeReader.Default.pmText="PM",DatetimeReader.Default.baseYear=2e3}get format(){return this._format}set format(e){e!=this._format&&(this._format=e,this.parse(e))}get amText(){return this._parser.amText}set amText(e){this._parser.amText=e}get pmText(){return this._parser.pmText}set pmText(e){this._parser.pmText=e}get baseYear(){return this._parser.baseYear}set baseYear(e){this._parser.baseYear=e}toDate(e){if(!e)return null;var t=null;switch(this._type){case 0:t=this._parser.parse(e);break;case 1:t=ISODatetimeParser.parse(e,!1);break;case 2:const i=parseInt(e);t=new Date(i);break;default:t=new Date(e)}return t&&!isNaN(t.getTime())?t:null}parse(e){if(e){const t=e.toLowerCase();this._type=Math.max(0,DatetimeReader.Formats.indexOf(t)),0==this._type&&(this._parser.format=e)}}}DatetimeReader.Formats=["custom","iso","timestamp","platform"],DatetimeReader.Default=new DatetimeReader("yyyy/MM/dd HH:mm:ss"),DatetimeReader.initialize();class ExpressionSyntaxError extends Error{constructor(e,t){super(e),this.message=e,this.tokenPos=t}}class ExpressionEvaluationError extends Error{constructor(e){super(e),this.message=e}}const _pad=function(e,t,i){return t=Math.max(t||2,1),i=i||"0",new Array(t-String(e).length+1).join(i)+e},$$_createTokenArray=function(...e){var t=[];for(var i of e)t[i]=!0;return t},IS_CHECK=$$_createTokenArray(26,27),IS_RELATIVE=$$_createTokenArray(40,45,46,47,48,49,50,51,52,53,41,42,43,44),IS_ADDITIVE=$$_createTokenArray(4,5,18,19),IS_MULTIPLICATIVE=$$_createTokenArray(11,3,2,14,15,16,17);class ExpressionLexer{constructor(){this.IS_IDENT=[],this.IS_INTEGER=[],this.IS_NUMBER=[],this.IS_WHITE=[],this.IS_END=[],this.QUOTATION='"'.charCodeAt(0),this.SQUOTATION="'".charCodeAt(0),this.BACKSLASH="\\".charCodeAt(0),this.BACKTICK="`".charCodeAt(0),this.Keywords={str:20,num:21,bool:23,not:13,len:24,and:11,in:12,mod:15,or:18,div:14,shl:16,shr:17,xor:19,is:26,like:46,ilike:48,match:50,imatch:52,defined:35,null:34,empty:36,nan:37,datestr:90,year:91,month:92,day:93,hour:94,rounddown:95},this._procs=null,this._source=null,this._len=0,this._tokenId=0,this._run=0,this._runAhead=0,this._nextRun=0,this._lineNo=0,this._linePos=0,this._tokenPos=0;for(var e=0;e<256;e++)this.IS_IDENT[e]=e==="_".charCodeAt(0)||e===":".charCodeAt(0)||e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)||e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0),this.IS_INTEGER[e]=e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e>="a".charCodeAt(0)&&e<="f".charCodeAt(0)||e>="A".charCodeAt(0)&&e<="F".charCodeAt(0),this.IS_NUMBER[e]=e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e==".".charCodeAt(0)||e==="e".charCodeAt(0)||e==="E".charCodeAt(0),this.IS_WHITE[e]=e>=1&&e<=9||11==e||e>=14&&e<=32,this.IS_END[e]=0==e;this.initProcs()}clear(){this._source=null}next(){var e=this._source.charCodeAt(this._run);this._tokenPos=this._run,e<256?this._procs[e].call(this):this.identProc()}unkownProc(){this._tokenId=0,this._run++}commaProc(){this._tokenId=32,this._run++}crProc(){this._tokenId=33,10==this._source.charCodeAt(this._run+1)?this._run+=2:this._run++,this._lineNo++,this._linePos=this._run}lfProc(){this._tokenId=33,this._run++,this._lineNo++,this._linePos=this._run}equalProc(){this._tokenId=40,this._run++}greaterProc(){"="==this._source.charAt(this._run+1)?(this._tokenId=42,this._run+=2):(this._tokenId=41,this._run++)}lowerProc(){"="==this._source.charAt(this._run+1)?(this._tokenId=44,this._run+=2):">"==this._source.charAt(this._run+1)?(this._tokenId=45,this._run+=2):(this._tokenId=43,this._run++)}nextIdent(){for(var e=this._run;e<this._len&&!this.IS_IDENT[this._source.charCodeAt(e)];)e++;for(var t=e;e<this._len&&this.IS_IDENT[this._source.charCodeAt(e)];)e++;return e>t?(this._nextRun=e,this._source.substr(t,e-t).toLowerCase()):null}identProc(){for(var e=this._run;this._run<this._len&&(this.IS_IDENT[this._source.charCodeAt(this._run)]||this._source.charCodeAt(this._run)>255);)this._run++;var t=this._source.substr(e,this._run-e).toLowerCase();if(this.Keywords.hasOwnProperty(t))switch(this._tokenId=this.Keywords[t],this._tokenId){case 13:if(t=this.nextIdent())switch(t){case"like":this._tokenId=47,this._run=this._nextRun;break;case"ilike":this._tokenId=49,this._run=this._nextRun;break;case"match":this._tokenId=51,this._run=this._nextRun;break;case"imatch":this._tokenId=53,this._run=this._nextRun}break;case 26:"not"==(t=this.nextIdent())&&(this._tokenId=27,this._run=this._nextRun)}else this._tokenId=10}integerProc(){for(this._tokenId=64,this._run++;this._run<this._len&&this.IS_INTEGER[this._source.charCodeAt(this._run)];)this._run++}numberProc(){for(this._tokenId=64,this._run++;this._run<this._len&&this.IS_NUMBER[this._source.charCodeAt(this._run)];){if("."==this._source.charAt(this._run)){if("."==this._source.charAt(this._run+1))break;this._tokenId=63}this._run++}}minusProc(){this._tokenId=4,this._run++}plusProc(){this._tokenId=5,this._run++}pointProc(){"."==this._source.charAt(this._run+1)?(this._tokenId=68,this._run+=2):(this._tokenId=65,this._run++)}roundOpenProc(){this._tokenId=66,this._run++}roundCloseProc(){this._tokenId=67,this._run++}slashProc(){this._tokenId=2,this._run++}spaceProc(){for(this._tokenId=71,this._run++;this._run<this._len&&this.IS_WHITE[this._source.charCodeAt(this._run)];)this._run++}bracketOpenProc(){this._tokenId=69,this._run++}bracketCloseProc(){this._tokenId=70,this._run++}starProc(){this._tokenId=3,this._run++}modProc(){this._tokenId=15,this._run++}stringProc(){this._tokenId=61;do{var e=this._source.charCodeAt(this._run);if(this.IS_END[e])throw new ExpressionSyntaxError("Untermintated string",e);e==this.BACKSLASH&&this._run++,this._run++}while(this._run<this._len&&this._source.charCodeAt(this._run)!=this.QUOTATION);this._run++}smallStringProc(){this._tokenId=61;do{var e=this._source.charCodeAt(this._run);if(this.IS_END[e])throw new ExpressionSyntaxError("Untermintated string",e);e==this.BACKSLASH&&this._run++,this._run++}while(this._run<this._len&&this._source.charCodeAt(this._run)!=this.SQUOTATION);this._run++}backtickProc(){this._tokenId=96;do{var e=this._source.charCodeAt(this._run);if(this.IS_END[e])throw new ExpressionSyntaxError("Untermintated backtick string",e);this._run++}while(this._run<this._len&&this._source.charCodeAt(this._run)!=this.BACKTICK);this._run++}initProcs(){this._procs=[];for(let e=1;e<=32;e++)this._procs[e]=this.spaceProc;this._procs[10]=this.lfProc,this._procs[13]=this.crProc,this._procs["$".charCodeAt(0)]=this.integerProc,this._procs[this.QUOTATION]=this.stringProc,this._procs[this.SQUOTATION]=this.smallStringProc,this._procs[this.BACKTICK]=this.backtickProc;for(let e=0;e<=9;e++)this._procs["0".charCodeAt(0)+e]=this.numberProc;for(let e="A".charCodeAt(0);e<="Z".charCodeAt(0);e++)this._procs[e]=this.identProc;for(let e="a".charCodeAt(0);e<="z".charCodeAt(0);e++)this._procs[e]=this.identProc;this._procs[":".charCodeAt(0)]=this.identProc,this._procs["_".charCodeAt(0)]=this.identProc,this._procs["(".charCodeAt(0)]=this.roundOpenProc,this._procs[")".charCodeAt(0)]=this.roundCloseProc,this._procs["*".charCodeAt(0)]=this.starProc,this._procs["+".charCodeAt(0)]=this.plusProc,this._procs[",".charCodeAt(0)]=this.commaProc,this._procs["-".charCodeAt(0)]=this.minusProc,this._procs[".".charCodeAt(0)]=this.pointProc,this._procs["/".charCodeAt(0)]=this.slashProc,this._procs["%".charCodeAt(0)]=this.modProc,this._procs["<".charCodeAt(0)]=this.lowerProc,this._procs["=".charCodeAt(0)]=this.equalProc,this._procs[">".charCodeAt(0)]=this.greaterProc,this._procs["[".charCodeAt(0)]=this.bracketOpenProc,this._procs["]".charCodeAt(0)]=this.bracketCloseProc}get tokenId(){return this._tokenId}get tokenLoc(){return{x:this._tokenPos-this._linePos,y:this._lineNo}}get tokenLen(){return this._run-this._tokenPos}get token(){return this._source.substr(this._tokenPos,this.tokenLen)}get isSpace(){return 71==this._tokenId}init(e){this._source=e,this._len=e.length,this._lineNo=0,this._linePos=0,this._tokenPos=0,this._runAhead=this._run=0,this._tokenId=0}charAhread(){for(this._runAhead=this._run;this._runAhead<this._len&&this._source.charCodeAt(this._runAhead)>0&&this._source.charCodeAt(this._runAhead)<=32;)this._runAhead++;return this._source.charCodeAt(this._runAhead)}nextId(e){do{this.next()}while(this._run<this._len&&this._tokenId!=e)}nextNoSpace(){if(this._run<this._len)do{this.next()}while(this._run<this._len&&this.isSpace)}isFirstInLine(){if(0==this._tokenPos)return!0;var e,t=this._tokenPos;for(t--;t>0&&this.IS_WHITE[this._source.charCodeAt(t)];)t--;return 0==t||(10==(e=this._source.charCodeAt(t))||13==e)}}class ExpressionRuntime extends Base{constructor(){super()}isIdentifier(e){throw new Error("Token is not a valid Identifier: "+e)}evaluateIdentifier(e){throw new Error("Invalid identifier key: "+e)}evaluateIndexerI(e,t){throw new Error("Invalid identifier indexer: "+e)}evaluateIndexerS(e,t,i){throw new Error("Invalid identifier indexer: "+e)}evaluateFunc(e,t){throw new Error("Invalid identifier func: "+e)}}class ExpressionNode{constructor(){}get value(){}get asLiteral(){return null}prepareValue(){}getLiteral(){}isIdentifier(e){return!1}toString(){return String(this)}}class LiteralNode extends ExpressionNode{}class EmptyExpressionNode extends ExpressionNode{constructor(){super()}evaluate(e){}toString(){return""}}EmptyExpressionNode.Default=new EmptyExpressionNode;class ExpressionNodeImpl extends ExpressionNode{constructor(){super(),this._operator=0}evaluate(e){if(this._literal)return this._literal.value;if(!this._rightExpr)return this._leftExpr.evaluate(e);var t=this._leftExpr.evaluate(e),i=this._rightExpr.evaluate(e);switch(this._operator){case 40:return t==i;case 45:return t!=i;case 41:return t>i;case 42:return t>=i;case 43:return t<i;case 44:return t<=i;case 46:return this.calcLike(t,i,!1);case 47:return!this.calcLike(t,i,!1);case 48:return this.calcLike(t,i,!0);case 49:return!this.calcLike(t,i,!0);case 50:return this.calcMatch(t,i,!1);case 51:return!this.calcMatch(t,i,!1);case 52:return this.calcMatch(t,i,!0);case 53:return!this.calcMatch(t,i,!0);default:throw new ExpressionEvaluationError("Unknown operator: "+this._operator)}}toString(){var e="";if(this._literal)e=this._literal.toString();else if(this._rightExpr){var t,i=this._leftExpr.toString(),r=this._rightExpr.toString();switch(this._operator){case 40:t="=";break;case 45:t="<>";break;case 41:t=">";break;case 42:t=">=";break;case 43:t="<";break;case 44:t="<=";break;case 46:t="like";break;case 47:t="not like";break;case 48:t="ilike";break;case 49:t="not ilike";break;case 50:t="match";break;case 51:t="not match";break;case 52:t="imatch";break;case 53:t="not imatch";break;case 32:t=",";break;default:t="<<ERROR>>"}e="("+i+" "+t+" "+r+")"}else e=this._leftExpr.toString();return e}isIdentifier(e){return this._leftExpr&&!this._rightExpr&&this._leftExpr.isIdentifier(e)}prepareValue(){this._leftExpr.prepareValue(),null==this._rightExpr?this._literal=this._leftExpr.getLiteral():this._rightExpr.prepareValue()}getLiteral(){return this._literal}calcLike(e,t,i){let r=String(e),s=String(t);if(r&&s){i&&(r=r.toLowerCase(),s=s.toLowerCase());let e=s.length;if(e>1){const t="%"==s.charAt(0),i="%"==s.charAt(e-1);return t&&i?(s=s.substr(1,e-2),r.indexOf(s,0)>=0):t?(s=s.substr(1,e-1),r.lastIndexOf(s)==r.length-s.length):i?(s=s.substr(0,e-1),0==r.indexOf(s,0)):r==s}return"%"!=s&&r==s}return!1}calcMatch(e,t,i){return new RegExp(t,"m"+(i?"i":"")).test(e)}}class CheckableNode extends ExpressionNode{get value(){}get asLiteral(){return this}evaluate(e){}}class DefinedNode extends CheckableNode{toString(){return"defined"}}class EmptyNode extends CheckableNode{toString(){return"empty"}}class NullNode extends CheckableNode{get value(){return NaN}toString(){return"null"}}class NanNode extends CheckableNode{toString(){return"NaN"}}class CheckNode extends ExpressionNodeImpl{constructor(e,t,i){super(),this._leftExpr=e,this._operator=t,this._isNot=27==t,this._value=-1,i instanceof DefinedNode?this._value=CheckNode.DEFINED:i instanceof NullNode?this._value=CheckNode.NULL:i instanceof EmptyNode?this._value=CheckNode.EMPTY:i instanceof NanNode&&(this._value=CheckNode.NAN)}prepareValue(){this._leftExpr.prepareValue(),this._literal=this._leftExpr.getLiteral()}getLiteral(){return null}evaluate(e){var t,i=this._literal?this._literal.value:this._leftExpr.evaluate(e);switch(this._value){case CheckNode.DEFINED:t=void 0!==i;break;case CheckNode.NULL:t=null==i;break;case CheckNode.EMPTY:t=null==i||0==String(i).length;break;case CheckNode.NAN:t=null===i||isNaN(i);break;default:return}return this._isNot?!t:t}toString(){var e="<<ERROR>>";switch(this._value){case CheckNode.DEFINED:e="defined";break;case CheckNode.NULL:e="null";break;case CheckNode.EMPTY:e="empty";break;case CheckNode.NAN:e="NaN"}return"("+(this._isNot?"is not ":"is ")+e+")"}}CheckNode.DEFINED=0,CheckNode.NULL=1,CheckNode.EMPTY=2,CheckNode.NAN=3;class FloatLiteralNode extends LiteralNode{constructor(e){super(),this._value=Number(e)}get value(){return this._value}get asLiteral(){return this}evaluate(e){return this._value}toString(){return String(this._value)}}class IntegerLiteralNode extends LiteralNode{constructor(e){super(),this._value="string"==typeof e?parseInt(e):Math.floor(e)}get value(){return this._value}get asLiteral(){return this}evaluate(e){return this._value}toString(){return String(this._value)}}class StringLiteralNode extends LiteralNode{constructor(e){super(),this._value=e.substr(1,e.length-2);for(var t="",i=0,r=!1;i<this._value.length;)"\\"!=this._value[i]||r?(r=!1,t+=this._value[i++]):(r=!0,i++);this._value=t}get value(){return this._value}get asLiteral(){return this}evaluate(e){return this._value}toString(){return"'"+this._value+"'"}}class IdentifierNode extends ExpressionNode{constructor(e){super(),this._idKey=-651212,this._literal=e}get identifier(){return this._literal}evaluate(e){return-651212==this._idKey&&(this._idKey=e.isIdentifier(this._literal)),e.evaluateIdentifier(this._idKey)}toString(){return this._literal}}class IndexerNode extends ExpressionNodeImpl{constructor(e,t,i){super(),this._idKey=-1490313,this._intIndex=NaN,this._strIndex=null,this._ident=e,this._indexer=t,this._capital=i}prepareValue(){let e=this._indexer.asLiteral;if(e||this._indexer instanceof ExpressionNodeImpl&&(this._indexer.prepareValue(),e=this._indexer.getLiteral()),e){const t=e.value;"string"==typeof t?this._strIndex=t:this._intIndex=parseInt(t),this._capital&&this._strIndex&&(this._strIndex=this._strIndex.toUpperCase())}}getLiteral(){return null}evaluate(e){if(-1490313==this._idKey&&(this._idKey=e.isIdentifier(this._ident)),this._strIndex)return e.evaluateIndexerS(this._idKey,this._strIndex,this._capital);if(isNaN(this._intIndex)){const t=this._indexer.evaluate(e);return"string"==typeof t?e.evaluateIndexerS(this._idKey,t,this._capital):e.evaluateIndexerI(this._idKey,t)}return e.evaluateIndexerI(this._idKey,this._intIndex)}toString(){return this._ident+"["+this._indexer.toString()+"]"}}class FuncNode extends ExpressionNodeImpl{constructor(e,t){super(),this._idKey=-1490313,this._strIndex=null,this._ident=e,this._indexer=t}prepareValue(){let e=this._indexer.asLiteral;if(e||this._indexer instanceof ExpressionNodeImpl&&(this._indexer.prepareValue(),e=this._indexer.getLiteral()),e){const t=e.value;"string"==typeof t&&(this._strIndex=t)}}getLiteral(){return null}evaluate(e){if(-1490313==this._idKey&&(this._idKey=e.isIdentifier(this._ident)),this._strIndex)return e.evaluateFunc(this._idKey,this._strIndex);{const t=this._indexer.evaluate(e);return e.evaluateFunc(this._idKey,t)}}toString(){return this._ident+"("+this._indexer.toString()+")"}}class UnaryNode extends ExpressionNode{constructor(e){super(),this._factor=e}prepareValue(){this._literal=this._factor.asLiteral,!this._literal&&this._factor instanceof ExpressionNode&&(this._factor.prepareValue(),this._literal=this._factor.getLiteral())}getLiteral(){return null}}class LenNode extends UnaryNode{constructor(e){super(e)}evaluate(e){const t=this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e);return t?t.length:0}toString(){return"(len "+this._factor+")"}}class MinusNode extends UnaryNode{constructor(e){super(e)}evaluate(e){return-(this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e))}toString(){return"-"+this._factor}}class PlusNode extends UnaryNode{constructor(e){super(e)}evaluate(e){return this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e)}toString(){return"+"+this._factor}}class NotNode extends UnaryNode{constructor(e){super(e)}evaluate(e){return!(this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e))}toString(){return"(not "+this._factor+")"}}class ToBoolNode extends UnaryNode{constructor(e){super(e)}evaluate(e){var t=this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e);return Boolean(t)}toString(){return"(bool "+this._factor+")"}}class ToNumberNode extends UnaryNode{constructor(e){super(e)}evaluate(e){var t=this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e);return Number(t)}toString(){return"(num "+this._factor+")"}}class ToStringNode extends UnaryNode{constructor(e){super(e)}evaluate(e){var t=this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e);return String(t)}toString(){return"(str "+this._factor+")"}}class ToDateStringNode extends UnaryNode{constructor(e){super(e)}evaluate(e){var t=this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e);return t instanceof Date&&(t=_pad(t.getFullYear(),4)+_pad(t.getMonth()+1,2)+_pad(t.getDate(),2)+_pad(t.getHours(),2)+_pad(t.getMinutes(),2)+_pad(t.getSeconds(),2)+_pad(t.getMilliseconds(),3)),String(t)}toString(){return"(datestr "+this._factor+")"}}class ToYearNode extends UnaryNode{constructor(e){super(e)}evaluate(e){const t=this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e);return t instanceof Date?t.getFullYear():null}toString(){return"(year "+this._factor+")"}}class ToMonthNode extends UnaryNode{constructor(e){super(e)}evaluate(e){const t=this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e);return t instanceof Date?t.getMonth()+1:null}toString(){return"(month "+this._factor+")"}}class ToDayNode extends UnaryNode{constructor(e){super(e)}evaluate(e){const t=this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e);return t instanceof Date?t.getDate():null}toString(){return"(day "+this._factor+")"}}class ToHourNode extends UnaryNode{constructor(e){super(e)}evaluate(e){const t=this._literal instanceof LiteralNode?this._literal.value:this._factor.evaluate(e);return t instanceof Date?t.getHours():null}toString(){return"(hour "+this._factor+")"}}class ToRoundDownNode extends UnaryNode{constructor(e){super(e)}evaluate(e){const t=this._factor,i=t.getLiteral();if(t.getLiteral())return i.value;if(t._rightExpr){const i=t._leftExpr.evaluate(e),s=t._rightExpr.evaluate(e);if(32===t._operator){var r=Math.pow(10,s);return Math.floor(i*r)/r}throw new ExpressionEvaluationError("Unknown operator: "+t._operator)}return t._leftExpr.evaluate(e)}toString(){return"(rounddown "+this._factor+")"}}class TermNode extends ExpressionNode{constructor(){super(),this._factors=[],this._operators=[],this._literal=null}addFactor(e){this._factors.push(e)}addOperator(e){this._operators.push(e)}isIdentifier(e){return 1==this._factors.length&&this._factors[0]instanceof IdentifierNode&&this._factors[0].identifier==e}prepareValue(){var e,t,i;for(e=0,t=this._factors.length;e<t;e++)this._factors[e].prepareValue();0==this._operators.length&&(i=this._factors[0],this._literal=i.asLiteral,this._literal||(this._literal=i.getLiteral()))}getLiteral(){return this._literal}evaluate(e){if(this._literal)return this._literal.value;const t=this._factors.length;let i=this._factors[0].evaluate(e);for(let r=1;r<t;r++){const t=this._factors[r].evaluate(e);switch(this._operators[r-1]){case 11:i=i&&t;break;case 3:i*=t;break;case 2:i/=t;break;case 14:i=Math.floor(Math.floor(i)/Math.floor(t));break;case 15:i%=t;break;case 16:i<<=t;break;case 17:i>>=t}}return i}toString(){var e="";if(this._literal)e=this._literal.toString();else if(1==this._factors.length)e=this._factors[0].toString();else{var t,i=this._factors.length;for(e="("+this._factors[0].toString(),t=1;t<i;t++){switch(this._operators[t-1]){case 11:e+=" and ";break;case 3:e+=" * ";break;case 2:case 14:e+=" / ";break;case 15:e+=" mod ";break;case 16:e+=" shl ";break;case 17:e+=" shr "}e+=this._factors[t].toString()}e+=")"}return e}}class SimpleExpressioNode extends ExpressionNode{constructor(){super(),this._terms=[],this._operators=[],this._literal=null}addTerm(e){this._terms.push(e)}addOperator(e){this._operators.push(e)}isIdentifier(e){return 1==this._terms.length&&this._terms[0].isIdentifier(e)}prepareValue(){for(let e=0,t=this._terms.length;e<t;e++)this._terms[e].prepareValue();0==this._operators.length&&(this._literal=this._terms[0].getLiteral())}getLiteral(){return this._literal}evaluate(e){if(this._literal)return this._literal.value;const t=this._terms.length;let i=this._terms[0].evaluate(e);for(let r=1;r<t;r++){const t=this._terms[r].evaluate(e);switch(this._operators[r-1]){case 4:i-=t;break;case 5:i+=t;break;case 18:i=i||t;break;case 19:i^=t}}return i}toString(){var e="";if(this._literal)e=this._literal.toString();else if(1==this._terms.length)e=this._terms[0].toString();else{var t,i=this._terms.length;for(e="("+this._terms[0].toString(),t=1;t<i;t++){switch(this._operators[t-1]){case 4:e+=" - ";break;case 5:e+=" + ";break;case 18:e+=" or ";break;case 19:e+=" xor ";break;default:e+=" <<ERROR>> "}e+=this._terms[t].toString()}e+=")"}return e}}class ExpressionParser{constructor(){this._node=null,this._capitalIndexers=null,this._lexer=new ExpressionLexer}syntaxError(e,t){throw new ExpressionSyntaxError(e,t)}expected(e){if(e!=this._lexer.tokenId)throw new ExpressionSyntaxError("Token is not a expected kind ["+e+"]: "+this._lexer.tokenId,this._lexer.tokenLoc);this.nextToken()}nextToken(){this._lexer.nextNoSpace()}doExpression(){let e,t=null,i=this.doSimpleExpression();if(IS_CHECK[e=this._lexer.tokenId]){this.nextToken();let r=this.doSimpleExpression();r.prepareValue();let s=r.getLiteral();if(!(s instanceof CheckableNode))throw new ExpressionSyntaxError("is operator's operand must be defined, null or empty: "+this._lexer.tokenId,null);t=new CheckNode(i,e,s)}else t=new ExpressionNodeImpl,t._leftExpr=i,(IS_RELATIVE[this._lexer.tokenId]||32==this._lexer.tokenId)&&(t._operator=this._lexer.tokenId,this.nextToken(),t._rightExpr=this.doSimpleExpression());return t}doSimpleExpression(){let e=new SimpleExpressioNode;for(e.addTerm(this.doTerm());IS_ADDITIVE[this._lexer.tokenId];)e.addOperator(this._lexer.tokenId),this.nextToken(),e.addTerm(this.doTerm());return e}doTerm(){let e=new TermNode;for(e.addFactor(this.doFactor());IS_MULTIPLICATIVE[this._lexer.tokenId];)e.addOperator(this._lexer.tokenId),this.nextToken(),e.addFactor(this.doFactor());return e}doFactor(){var e=this._lexer.tokenId;switch(e){case 61:return this.doCharString();case 96:return this.doBacktick();case 66:return this.doRoundOpen();case 10:return this.doIdentifier();case 64:return this.doInteger();case 63:return this.doNumber();case 4:return this.doMinus();case 5:return this.doPlus();case 13:return this.doNot();case 35:return this.doDefined();case 34:return this.doNull();case 36:return this.doEmpty();case 37:return this.doNaN();case 23:return this.doToBool();case 21:return this.doToNumber();case 20:return this.doToString();case 24:return this.doLength();case 90:return this.doToDateString();case 91:return this.doToYear();case 92:return this.doToMonth();case 93:return this.doToDay();case 94:return this.doToHour();case 95:return this.doRoundDown()}throw new ExpressionSyntaxError("Unkown token: "+e,this._lexer.tokenLoc)}doCharString(){var e=this._lexer.token;return this.nextToken(),new StringLiteralNode(e)}doBacktick(){var e=this._lexer.token;return this.nextToken(),new IdentifierNode(e.substring(1,e.length-1))}doRoundOpen(){this.nextToken();var e=this.doExpression();return this.expected(67),e}doIdentifier(){var e=this._lexer.token;if(this.nextToken(),69==this._lexer.tokenId){this.nextToken();var t=this.doExpression();return this.expected(70),new IndexerNode(e,t,this._capitalIndexers.indexOf(e)>=0)}if(66==this._lexer.tokenId){this.nextToken();t=this.doExpression();return this.expected(67),new FuncNode(e,t)}return new IdentifierNode(e)}doNumber(){var e=this._lexer.token;return this.nextToken(),new FloatLiteralNode(e)}doInteger(){var e=this._lexer.token;return this.nextToken(),new IntegerLiteralNode(e)}doMinus(){return this.nextToken(),new MinusNode(this.doFactor())}doPlus(){return this.nextToken(),new PlusNode(this.doFactor())}doNot(){return this.nextToken(),new NotNode(this.doFactor())}doDefined(){return this.nextToken(),new DefinedNode}doNull(){return this.nextToken(),new NullNode}doEmpty(){return this.nextToken(),new EmptyNode}doNaN(){return this.nextToken(),new NanNode}doToBool(){return this.nextToken(),new ToBoolNode(this.doFactor())}doToNumber(){return this.nextToken(),new ToNumberNode(this.doFactor())}doToString(){return this.nextToken(),new ToStringNode(this.doFactor())}doLength(){return this.nextToken(),new LenNode(this.doFactor())}doToDateString(){return this.nextToken(),new ToDateStringNode(this.doFactor())}doToYear(){return this.nextToken(),new ToYearNode(this.doFactor())}doToMonth(){return this.nextToken(),new ToMonthNode(this.doFactor())}doToDay(){return this.nextToken(),new ToDayNode(this.doFactor())}doToHour(){return this.nextToken(),new ToHourNode(this.doFactor())}doRoundDown(){return this.nextToken(),new ToRoundDownNode(this.doFactor())}parse(e,t){if(e){this._capitalIndexers=t||[],this._lexer.init(e),this.nextToken();var i=this.doExpression();return i&&i.prepareValue(),this._lexer.clear(),this._capitalIndexers=null,i}return null}evaluate(e,t,i){return this.parse(e,i).evaluate(t)}}ExpressionParser.Default=new ExpressionParser;const ID_ROW=0,ID_VALUES=1,IDENTS$1={row:0,values:1},ID_FIELD$1=999;class FieldValueRuntime extends ExpressionRuntime{constructor(){super(),this._fieldMap={}}_doDispose(){super._doDispose()}prepare(e){const t=this._data=e,i=this._fieldMap={};if(t)for(let e=0;e<t.fieldCount;e++){const t=this._data.getField(e).fieldName;i[":"+t]=i[t]=999+e}return this}setRow(e){return this._row=e,this}isIdentifier(e){const t=e.toLocaleLowerCase();return IDENTS$1.hasOwnProperty(t)?IDENTS$1[t]:this._fieldMap.hasOwnProperty(e)?this._fieldMap[e]:super.isIdentifier(e)}evaluateIdentifier(e){if(e>=999)return this._row>=0?this._data.getRowValue(this._row,e-999):void 0;super.evaluateIdentifier(e)}evaluateIndexerS(e,t,i){if(1==e){const e=this._fieldMap[t];return this._row>=0?this._data.getRowValue(this._row,e-999):void 0}throw new ExpressionEvaluationError("Invalid field name: "+e)}evaluateFunc(e,t){return 0===e?this._row:super.evaluateFunc(e,t)}}class ReportDataPath{constructor(e,t){this.data=e,this.path=t}static create(e,t){return new ReportDataPath(e,t)}}class ReportData extends Base{constructor(e,t){super(),this._name=e,this._dp=t}get provider(){return this._dp}get designTime(){var e;return null===(e=this._dp)||void 0===e?void 0:e.designTime}get isBand(){return!1}get name(){return this._name}set name(e){var t;if(e!==this._name){const i=this._name;this._name=e,null===(t=this._dp)||void 0===t||t.dataNameChanged(this,i)}}preparePrint(e,t){}}class ContextData extends ReportData{constructor(e){super("_context_",null),this._context=e}static isValue(e){return this.Values.hasOwnProperty(e)}static isBandValue(e){return this.BandValues.hasOwnProperty(e)}getFieldNames(){return[]}getValue(e){const t=ContextData.Values[e];return t&&t(this._context)}getSaveValues(){}getSaveType(){return"context"}}ContextData.Values={"${page}":e=>e.page+1,"%{page}":e=>e.page+1,"${pages}":e=>e.pageCount,"%{pages}":e=>e.pageCount,"${all-page}":e=>e.compositePrinting?e.compositePage+1:e.page+1,"%{all-page}":e=>e.compositePrinting?e.compositePage+1:e.page+1,"${all-pages}":e=>e.compositePrinting?e.compositePageCount:e.pageCount,"%{all-pages}":e=>e.compositePrinting?e.compositePageCount:e.pageCount,"${date}":e=>e.date,"%{date}":e=>e.date},ContextData.BandValues={"${dpage}":e=>e.detailPage+1,"${dpages}":e=>e.detailPageCount};class SimpleData extends ReportData{constructor(e,t){super(e,null),this.setSample(t),this._isObj=Utils.isObject(t)}getValue(e){if(e&&this._isObj){let t=this._values;const i=e.split(".");for(let e of i)t=t[e];return t}}get sample(){return this._values}setSample(e){e!==this._values&&(this._values=e)}getFieldNames(){if(this._values){const e=[];for(let t in this._values)e.push(t);return e}}getSaveType(){return"simple"}getSaveValues(){return this._values}}var DesignDataMode;!function(e){e.SAMPLE="sample",e.GENERATE="generate"}(DesignDataMode||(DesignDataMode={}));class BandData extends ReportData{constructor(e,t,i){if(super(e,i),this._calcFieldRuntime=new FieldValueRuntime,t){this._fields=t;for(let e of t){if(!e.fieldName)throw new Error("The fieldName must be exists.");e.dataType||(e.dataType="text"),e.dateReader=null}}}get fields(){return this._fields&&this._fields.slice()}get fieldCount(){return this._fields?this._fields.length:0}getFields(){var e;return null===(e=this._fields)||void 0===e?void 0:e.slice(0)}getField(e){return this._fields[e]}getFieldByName(e){if(this._fields)for(let t of this._fields)if(t.fieldName===e)return t}getFieldIndex(e){if(this._fields)for(let t=this._fields.length-1;t>=0;t--)if(this._fields[t].fieldName===e)return t;return-1}containsField(e){return this._fields&&this._fields.some((t=>t.fieldName===e))}indexOfField(e){return this._fields.indexOf(e)}setField(e,t){this._fields[e]={...t}}getSaveFields(){return this._fields}getNextFieldName(e=""){const t=e||"field";let i=t,r=1;for(;this._fields.some((e=>i===e.fieldName));)i=t+"-"+r++;return i}getFieldNames(){return this._fields?this._fields.map((e=>e.fieldName)).sort():[]}addField(e,t){if(t&&!this._fields.includes(t))return e=Math.max(0,Math.min(this._fields.length,e)),this._fields.splice(e,0,t),!0}removeField(e){const t=this._fields.indexOf(e);if(t>=0)return this._fields.splice(t,1),!0}groupBy(e,t){function i(t,r){if(r.push(t),t.level===e.length)for(let e=0;e<t.count;e++)r.push(e+t.row);else for(let e of t.children)i(e,r);r.push({group:t})}const r=t?t.length:this.rowCount;if(e&&e.length>0){const s=[],n={parent:null,level:0,row:0,count:r,children:[]};!function i(r,s){const n=s.row+s.count;let o=s.level+1,a=s.row;const A=e[o-1];let l={parent:s,level:o,row:a,count:1,value:r.getRowValue(a,A),children:[]};for(s.children.push(l);++a<n;){const e=r.getRowValue(t?t[a]:a,A);e!==l.value?(l={parent:s,level:o,row:a,count:1,value:e,children:[]},s.children.push(l)):l.count++}if(o<e.length)for(let e of s.children){let t=e.row;for(;t<e.row+e.count;)i(r,e),t+=e.count}}(this,n);for(let e of n.children)i(e,s);if(t)for(let e=0;e<s.length;e++){const i=s[e];"number"==typeof i?s[e]=t[i]:isNaN(i.row)||(s[e].row=t[i.row])}return s}}readValue(e,t){if(e){const i=e.dataType;if("text"===i)return Utils.isDefined(t)?String(t):t;if("datetime"===i)return e.dateReader||(e.dateReader=new DatetimeReader(e.format)),e.dateReader.toDate(t);if("number"===i)return"number"==typeof t?t:parseFloat(t);if("bool"===i)return"boolean"==typeof t?t:"number"==typeof t?0!==t:"True"===t||"true"===t}return t}readRow(e){if(this._fields){const t=this._fields;if(Utils.isArray(e))for(let i=0;i<t.length;i++)e[i]=this.readValue(t[i],e[i]);else if(e)for(let i in e){const r=this.getFieldIndex(i);r>=0&&(e[i]=this.readValue(t[r],e[i]))}}return e}dateToStr(e,t){const i=e&&e.format&&DatetimeFormatter.getFormatter(e.format);return i?i.getText(t):String(t)}get isBand(){return!0}preparePrint(e,t){super.preparePrint(e,t);const i=this._fields;let r=this._fields;if(!t&&!r){const t=e.designDp.get(this.name);t instanceof BandData&&(r=this._fields=t.getFields())}if(r){const e=this._fieldMap={};for(let t=0;t<r.length;t++)e[r[t].fieldName]=t;i||this._readRows(),this._calcFieldRuntime.prepare(this);for(let t=0;t<r.length;t++){const i=r[t];if(i.expression){const s=ExpressionParser.Default.parse(i.expression);this._prepareCalcField(r,e,i,t,s)}}}}_readRows(){}_prepareCalcField(e,t,i,r,s){}}class BandArrayData extends BandData{constructor(e,t,i,r,s){super(e,t,s),this._sampleCount=-1,r>0&&(this._sampleCount=r),this.setValues(i)}get rowCount(){return this._values.length}getRowValues(e){return this._values[e]}getValue(e){return this.getRowValue(0,e)}getRowValue(e,t){const i=this._values[e];if(i)return"number"==typeof t?i[this.getField(t).fieldName]:i[t]}getFieldValues(e,t){const i=[];if("number"==typeof e&&(e=this.getField(e).fieldName),t)t.forEach((t=>i.push(this._values[t][e])));else for(let t=0;t<this._values.length;t++)i.push(this._values[t][e]);return i}equalValues(e,t,i){for(let r=t.length-1;r>=0;r--)if(this._values[e][t[r]]!==i[r])return!1;return!0}equalRows(e,t,i){const r=this._values;i=i||this._fields.map((e=>e.fieldName));for(let s=i.length-1;s>=0;s--)if(r[e][i[s]]!==r[t][i[s]])return!1;return!0}findRows(e){const t=null!=e&&Object.keys(e),i=[];return t&&t.length>0&&this._values.forEach(((r,s)=>{let n=!0;for(let i of t)if(r[i]!==e[i]){n=!1;break}n&&i.push(s)})),i}get sample(){return this._values}getValues(){const e=[];for(let t=0;t<this._values.length;t++)e.push(this.$_cloneRow(this._values[t]));return e}setValues(e){const t=this._values=[];if(e)for(let i=0,r=e.length;i<r;i++){let r=this.$_cloneRow(e[i]);r=this.readRow(r),t.push(r)}}getSaveType(){return"band"}getSaveValues(){}$_cloneRow(e){if(e){const t={};for(let i in e)t[i]=e[i];return t}return null}$_prepareSample(){const e=this._fields;if(e&&e.length>0){const t={};for(let i of e)t[i.fieldName]=this.readValue(i,i.sample);return t}return{}}_readRows(){const e=this._values;for(let t=0,i=e.length;t<i;t++)e[t]=this.readRow(e[t])}_prepareCalcField(e,t,i,r,s){const n=this._values,o=this._calcFieldRuntime;for(let e=0,t=n.length;e<t;e++){const t=n[e];o.setRow(e);const r=s.evaluate(o);t[i.fieldName]=r}}}class Size{constructor(e=0,t=0){this.width=e,this.height=t}static empty(){return new Size}static create(e=0,t=0){return new Size(e,t)}get isEmpty(){return 0===this.width||0===this.height}clone(){return new Size(this.width,this.height)}equals(e){return e===this||e&&this.width===e.width&&this.height===e.height}setEmpty(){return this.width=this.height=0,this}set(e,t){return this.width=e,this.height=t,this}round(){const e=this.clone();return e.width>>>=0,e.height>>>=0,e}toString(){return"{width: "+this.width+", height: "+this.height+"}"}}Size.EMPTY=new Size;const REG_COLOR=/\s*\,\s*/;class ColorUtils{static get hueCount(){return this.HUES.length}static getHue(e){return this.HUES[e]}static rbg2Hue(e){const t=(16711680&e)>>16,i=(65280&e)>>8,r=255&e,s=Math.min(t,i,r),n=Math.max(t,i,r);if(s==n)return 0;{let e=0;return e=n==t?(i-r)/(n-s):n==i?2+(r-t)/(n-s):4+(t-i)/(n-s),e*=60,e<0&&(e+=360),Math.round(e)}}static rgb2Hsl(e,t,i){if(void 0===t){const r=e;e=(16711680&r)>>16,t=(65280&r)>>8,i=255&r}e/=255,t/=255,i/=255;const r=Math.max(e,t,i),s=Math.min(e,t,i);let n,o,a=(r+s)/2;if(r==s)n=o=0;else{const A=r-s;switch(o=a>.5?A/(2-r-s):A/(r+s),r){case e:n=(t-i)/A+(t<i?6:0);break;case t:n=(i-e)/A+2;break;case i:n=(e-t)/A+4}n/=6}return{h:360*n,s:100*o,l:100*a}}static hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static hsl2Rgb(e,t,i){if(void 0===t){const r=e;e=(16711680&r)>>16,t=(65280&r)>>8,i=255&r}let r,s,n;if(e/=360,i/=100,0==(t/=100))r=s=n=i;else{const o=i<.5?i*(1+t):i+t-i*t,a=2*i-o;r=ColorUtils.hue2rgb(a,o,e+1/3),s=ColorUtils.hue2rgb(a,o,e),n=ColorUtils.hue2rgb(a,o,e-1/3)}return Math.round(255*r)<<16|Math.round(255*s)<<8|Math.round(255*n)}static toHex(e,t=NaN){let i=((16711680&e)>>16).toString(16);1==i.length&&(i="0"+i);let r=((65280&e)>>8).toString(16);1==r.length&&(r="0"+r);let s=(255&e).toString(16);1==s.length&&(s="0"+s);let n="";return isNaN(t)||(n=(255&(t=Math.round(255*t))).toString(16),1==n.length&&(n="0"+n)),"#"+i+r+s+n}static toRgba(e,t){let i="rgba(";return i+=((16711680&e)>>16)+","+((65280&e)>>8)+","+(255&e)+","+t,i+")"}static interpoate(e,t,i){const r=(16711680&e)>>16,s=(65280&e)>>8,n=255&e,o=(16711680&t)>>16,a=(65280&t)>>8,A=255&t;return(Math.floor((o-r)*i+r)<<16)+(Math.floor((a-s)*i+s)<<8)+Math.floor((A-n)*i+n)}static colorToHex(e,t){return"#"+Utils.pad16(e,6)+Utils.pad16(Math.round(255*t),2)}static colorToHex2(e,t){return t<1?"#"+Utils.pad16(e,6)+Utils.pad16(Math.round(255*t),2):"#"+Utils.pad16(e,6)}static colorToCss(e,t){const i=Math.round(100*t)/100;if(1!==i){return"rgba("+((16711680&e)>>16)+","+((65280&e)>>8)+","+(255&e)+","+i+")"}return"#"+Utils.pad16(e,6)}static strToColor(e){let t=0,i=1;if(e)if((e=e.trim()).startsWith("rgba(")&&e.endsWith(")")){const r=e.substring(5,e.length-1).trim().split(REG_COLOR);4===r.length&&(t=parseInt(r[0])<<16|parseInt(r[1])<<8|parseInt(r[2]),i=parseFloat(r[3]))}else if(e.startsWith("rgb(")&&e.endsWith(")")){const i=e.substring(4,e.length-1).trim().split(REG_COLOR);3===i.length&&(t=parseInt(i[0])<<16|parseInt(i[1])<<8|parseInt(i[2]))}else{e.startsWith("#")&&(e=e.substr(1));const r=e.length;r>6?(t=parseInt(e.substr(0,6),16),i=parseInt(e.substring(6),16)/255):r>0&&(3===r&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),t=parseInt(e,16))}return{color:t,alpha:i}}static cssToColor(e,t=!0){if(e)if(e.startsWith("rgba(")){const i=e.substring(5,e.length-1).split(REG_COLOR),r=parseFloat(i[3]);if(r>0||!t){return{color:parseInt(i[0])<<16|parseInt(i[1])<<8|parseInt(i[2]),alpha:r}}}else if(e.startsWith("rgb(")){const t=e.substring(4,e.length-1).split(REG_COLOR);return{color:parseInt(t[0])<<16|parseInt(t[1])<<8|parseInt(t[2]),alpha:1}}}static lighten(e,t){if(t>=1)return e;const i=this.rgb2Hsl(e),r=i.l+i.l*(1-t);return this.hsl2Rgb(i.h,i.s,r)}}ColorUtils.HUE_MAX=360,ColorUtils.SATURATION_MAX=100,ColorUtils.LIGHTNESS_MAX=100,ColorUtils.HUES=[16711680,16776960,65280,65535,255,16711935,16711680];const $_FORBIDDEN_STYLES={position:"poistion",display:"display",marign:"margin"},$_COLOR_STYLES={color:0,backgroundColor:1,fill:2},$_ALIASED_STYLES={};function strToCss(e){if(e&&"#"==e.charAt(0)&&e.length>7){const t=parseInt(e.substring(1,7),16),i=parseInt(e.substring(7),16)/255;e=ColorUtils.colorToCss(t,i)}return e}function aliasStyle(e,t){const i=e.values;return i[t]||i.default}function applyStyles(e,t,i){if(t)for(let r in t){let s=t[r];s&&!e._doApplyStyle(r,s,i)&&(r in $_FORBIDDEN_STYLES||(r in $_COLOR_STYLES?s=strToCss(s):r in $_ALIASED_STYLES&&(s=aliasStyle($_ALIASED_STYLES[r],s),r=$_ALIASED_STYLES[r].css),i[r]=s||""))}}class ReportElement extends VisualElement{get debugging(){return ReportElement.Debugging}get debugLabel(){return this.constructor.name}get guardLabel(){return this.debugLabel}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}get lazyLayout(){return!1}get floating(){return!1}measure(e,t,i){const r=this._dom,s=e&&e.printing;s?delete r.dataset.design:r.dataset.design="",s&&this._clearDesign(),this._doPrepareMeasure(e,r);const n=this._doMeasure(e,r,t,i);return this._doAfterMeasure(e,r,t,i,n),this._measuredWidth=n.width,this._measuredHeight=n.height,n}layoutContent(e){this._doPrepareContent(e),this._doLayoutContent(e),this._doAfterLayout(e)}print(e,t,i=NaN){const r=this._dom;return this._printWidth=i,this._setClassName(r),this._doPrint(e,t),this._setSizeStyle(r.style),this.height}findElement(e){return null}applyMeasure(){this.resize(this._measuredWidth,this._measuredHeight)}_debugBorder(){return"1px solid rgba(0, 61, 0, 0.3)"}_debugColor(){return"rgba(0, 61, 0, 0.4)"}_clearDesign(){}_afterDraw(e){if(this.debugging&&this._debuggable()){if(!this._debugView){this._debugView=e.ownerDocument.createElement("span");const t=this._debugView.style;t.display="inline-block",t.position="absolute",t.pointerEvents="none",t.left="0",t.top="0",t.right="0",t.bottom="0",t.border=this._debugBorder(),t.color=this._debugColor()}this._debugView.textContent=this.debugLabel,e.appendChild(this._debugView)}else this._debugView&&Utils.detach(this._debugView)}_debuggable(){return!0}_doPrepareMeasure(e,t){}_doAfterMeasure(e,t,i,r,s){}_doMeasure(e,t,i,r){return new Size(i,r)}_doPrepareContent(e){}_doLayoutContent(e){}_doAfterLayout(e){}_doSetStyles(e,t){this._setStyles(e,e.styles,t.style)}_setStyles(e,t,i){applyStyles(e,t,i)}_getModelWidth(e,t){return e.getWidth(t)}_getModelHeight(e,t){return e.getHeight(t)}_setModelSize(e,t,i,r,s=!1){const n=this._modelWidth=this._getModelWidth(e,i),o=this._modelHeight=this._getModelHeight(e,r);isNaN(n)?s&&(t.style.width=""):t.style.width=n+"px",isNaN(o)?s&&(t.style.height=""):t.style.height=o+"px"}_doPrint(e,t){const i=this.measure(t,t.pageWidth,t.pageHeight);this.width=i.width,this.height=i.height,this.layoutContent(t)}}ReportElement.Debugging=!1;class ReportPageItemElement extends ReportElement{}class SectionHeadView extends ReportElement{constructor(e,t,i,r,s){super(e,null),this._model=t,this._text=i,this.dom.title=r;let n="rr-section-head";s&&(n+=" "+s),this.styleName=n}get model(){return this._model}set model(e){this._model=e}get text(){return this._text}set text(e){e!==this._text&&(this._text=e,this.invalidateLayout())}setSelected(e){this.model.isAncestorOf(e)?this.dom.dataset.selected="":delete this.dom.dataset.selected}_initDom(e,t){super._initDom(e,t),this._span=e.createElement("span"),t.appendChild(this._span)}_doMeasure(e,t,i,r){const s=this._span;return t.style.width="",t.style.height="",s.textContent=this._text,new Size(Math.ceil(t.offsetWidth),t.offsetHeight)}isDom(e){return super.isDom(e)||e===this._span}}class PopupElement extends ReportElement{}class PropertyItem extends Base{constructor(e){super(),this._prop=e}get group(){return this._group}get prop(){return this._prop}get name(){return this._prop.name}get label(){return this._prop.label||this._prop.name}get domain(){return this._prop.domain}get parent(){return this._prop.parent}isVisible(e){return!this._prop.visible||!1!==this._prop.visible(e)}isReadOnly(e){return this._prop.readonly||e.isReadOnlyProperty(this._prop)}getValue(e){return e.getProperty(this._prop.name)}setValue(e,t){e.setProperty(this._prop.name,t)}setValues(e,t){e[0].setItemsProperty(e,this._prop.name,t)}hasColor(){return!1}}class PropertyGroup extends Base{constructor(e){super(),this._items=[],this._pool=[],this._label=e}get label(){return this._label}get count(){return this._items.length}get(e){return this._items[e]}borrow(e){for(let t=this._pool.length-1;t>=0;t--){const i=this._pool[t];if(i._prop===e)return this._pool.splice(t,1),i}}add(e){e._group=this,this._items.push(e)}clear(){for(let e of this._items)e._group=null,this._pool.push(e);this._items=[]}}class ValueProperty extends PropertyItem{constructor(e){super(e)}get defaultValue(){return this._defaultValue}set defaultValue(e){this._defaultValue=e}}class StylesProperty extends PropertyItem{constructor(e){super(e)}}class StringProperty extends ValueProperty{constructor(e){super(e)}}StringProperty.$_ctor="StringProperty";class NumberProperty extends ValueProperty{constructor(e){super(e),this._minimum=NaN,this._maximum=NaN}get minimum(){return this._minimum}set minimum(e){this._minimum=e}get maximum(){return this._maximum}set maximum(e){this._maximum=e}}NumberProperty.$_ctor="NumberProperty";class DimensionProperty extends StringProperty{constructor(e){super(e),this.percentable=!0}}DimensionProperty.$_ctor="DimensionProperty";class SizeProperty extends DimensionProperty{constructor(e){super(e)}}SizeProperty.$_ctor="SizeProperty";class BooleanProperty extends ValueProperty{constructor(e){super(e)}}BooleanProperty.$_ctor="BooleanProperty";class DateProperty extends ValueProperty{constructor(e){super(e)}}DateProperty.$_ctor="DateProperty";class EnumProperty extends ValueProperty{constructor(e,t){super(e),this._type=t||e.domain}get domain(){const e=Utils.getEnumValues(this._type);return void 0===this.defaultValue&&e.unshift(void 0),e}}EnumProperty.$_ctor="EnumProperty";class ReportItemProperty extends StringProperty{constructor(e){super(e)}}ReportItemProperty.$_ctor="ReportItemProperty";class ListableProperty extends StringProperty{constructor(e){super(e)}}ListableProperty.$_ctor="ListableProperty";class EditListableProperty extends StringProperty{}EditListableProperty.$_ctor="EditListableProperty";class FunctionProperty extends StringProperty{constructor(e){super(e)}}FunctionProperty.$_ctor="FunctionProperty";class NumberArrayProperty extends ValueProperty{constructor(e){super(e)}}NumberArrayProperty.$_ctor="NumberArrayProperty";class StringArrayProperty extends ValueProperty{constructor(e){super(e)}}StringArrayProperty.$_ctor="StringArrayProperty";class ColorProperty extends ValueProperty{constructor(e){super(e)}}ColorProperty.$_ctor="ColorProperty";class PopupProperty extends ValueProperty{constructor(e){super(e)}}PopupProperty.$_ctor="PopupProperty";class StyleProperty extends PropertyItem{constructor(e){super(e)}getValue(e){return this.parent?e.getSubStyleProperty(this.parent,this.name):e.getStyleProperty(this.name)}setValue(e,t){this.parent?e.setSubStyleProperty(this.parent,this.name,t):e.setStyleProperty(this.name,t)}setValues(e,t){const i=e[0];this.parent?i.setItemsSubStyleProperty(e,this.parent,this.name,t):i.setItemsStyleProperty(e,this.name,t)}}class BackgroundStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"background"}}BackgroundStyle.$_ctor="BackgroundStyle";class ColorStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"color"}}ColorStyle.$_ctor="ColorStyle";class FontFamilyStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"fontFamily"}}FontFamilyStyle.VALUES=[void 0,"Arial","Helvetica","Tahoma",'"Trebuchet MS"',"Verdana",'"Courier New"','"Lusida Console"','"Times New Roman"'],FontFamilyStyle.$_ctor="FontFamilyStyle";class FontSizeStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"fontSize"}}FontSizeStyle.$_ctor="FontSizeStyle";class FontStyleStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"fontStyle"}}FontStyleStyle.VALUES=[void 0,"normal","italic","oblique"],FontStyleStyle.$_ctor="FontStyleStyle";class FontWeightStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"fontWeight"}}FontWeightStyle.VALUES=[void 0,"normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900"],FontWeightStyle.$_ctor="FontWeightStyle";class TextAlignStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"textAlign"}}TextAlignStyle.VALUES=[void 0,"left","center","right"],TextAlignStyle.$_ctor="TextAlignStyle";class VerticalAlignStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"verticalAlign"}}VerticalAlignStyle.VALUES=[void 0,"top","middle","bottom"],VerticalAlignStyle.$_ctor="VerticalAlignStyle";class WhiteSpaceStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"whiteSpace"}}WhiteSpaceStyle.VALUES=[void 0,"normal","nowrap","pre","pre-wrap","pre-line"],WhiteSpaceStyle.$_ctor="WhiteSpaceStyle";class TextDecorationStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"textDecoration"}}TextDecorationStyle.VALUES=[void 0,"underline","line-through","overline"],TextDecorationStyle.$_ctor="TextDecorationStyle";class LineHeightStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"line-height"}}LineHeightStyle.$_ctor="LineHeightStyle";class BorderStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"border"}hasColor(){return!0}}BorderStyle.$_ctor="BorderStyle";class BorderItemStyle extends StyleProperty{constructor(e){super(e)}hasColor(){return!0}}BorderItemStyle.$_ctor="BorderItemStyle";class BorderLeftStyle extends BorderItemStyle{constructor(e){super(e)}get styleName(){return"border-left"}}BorderLeftStyle.$_ctor="BorderLeftStyle";class BorderRightStyle extends BorderItemStyle{constructor(e){super(e)}get styleName(){return"border-right"}}BorderRightStyle.$_ctor="BorderRightStyle";class BorderTopStyle extends BorderItemStyle{constructor(e){super(e)}get styleName(){return"border-top"}}BorderTopStyle.$_ctor="BorderTopStyle";class BorderBottomStyle extends BorderItemStyle{constructor(e){super(e)}get styleName(){return"border-bottom"}}BorderBottomStyle.$_ctor="BorderBottomStyle";class PaddingStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"padding"}}PaddingStyle.$_ctor="PaddingStyle";class PaddingItemStyle extends StyleProperty{constructor(e){super(e)}}PaddingItemStyle.$_ctor="PaddingItemStyle";class PaddingLeftStyle extends PaddingItemStyle{constructor(e){super(e)}get styleName(){return"padding-left"}}PaddingLeftStyle.$_ctor="PaddingLeftStyle";class PaddingRightStyle extends PaddingItemStyle{constructor(e){super(e)}get styleName(){return"padding-right"}}PaddingRightStyle.$_ctor="PaddingRightStyle";class PaddingTopStyle extends PaddingItemStyle{constructor(e){super(e)}get styleName(){return"padding-top"}}PaddingTopStyle.$_ctor="PaddingTopStyle";class PaddingBottomStyle extends PaddingItemStyle{constructor(e){super(e)}get styleName(){return"padding-bottom"}}PaddingBottomStyle.$_ctor="PaddingBottomStyle";class MarginItemStyle extends StyleProperty{constructor(e){super(e)}}class MarginLeftStyle extends MarginItemStyle{constructor(e){super(e)}get styleName(){return"margin-left"}}MarginLeftStyle.$_ctor="MarginLeftStyle";class MarginRightStyle extends MarginItemStyle{constructor(e){super(e)}get styleName(){return"margin-right"}}MarginRightStyle.$_ctor="MarginRightStyle";class MarginTopStyle extends MarginItemStyle{constructor(e){super(e)}get styleName(){return"margin-top"}}MarginTopStyle.$_ctor="MarginTopStyle";class MarginBottomStyle extends MarginItemStyle{constructor(e){super(e)}get styleName(){return"margin-bottom"}}MarginBottomStyle.$_ctor="MarginBottomStyle";class OpacityStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"opacity"}}OpacityStyle.$_ctor="OpacityStyle";class CellAlignStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"cellAlign"}}CellAlignStyle.VALUES=[void 0,"left","center","right"],CellAlignStyle.$_ctor="CellAlignStyle";class StrokeWidthStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"strokeWidth"}}StrokeWidthStyle.$_ctor="StrokeWidthStyle";class StrokeDasharrayStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"strokeDasharray"}}StrokeDasharrayStyle.$_ctor="StrokeDasharrayStyle";class WritingModeStyle extends StyleProperty{constructor(e){super(e)}get styleName(){return"writingMode"}}var PropCategory;WritingModeStyle.VALUES=[void 0,"horizontal-tb","vertical-rl","vertical-lr"],WritingModeStyle.$_ctor="WritingModeStyle",function(e){e.DESIGN="design",e.BASIC="basic",e.TEXT="text",e.DATA="data",e.BOUND="bound",e.EVENT="event",e.EDITOR="editor",e.REPORT="report",e.PAPER="paper",e.BOX="box",e.TABLE="table",e.BARCODE="barcode",e.CELL="cell",e.BAND="band",e.BAND_GROUP="band group",e.BAND_CELL="band cell",e.FIELD="field",e.COLUMN="column",e.ROW="row",e.CHART="chart",e.TITLE="title",e.SUBTITLE="subtitle",e.AXIS="axis",e.XAXIS="x Axis",e.YAXIS="y Axis",e.SERIES="series",e.LABEL="label",e.LABELS="labels",e.DATA_LABELS="dataLabels",e.MARKER="marker",e.LEGEND="legend"}(PropCategory||(PropCategory={}));class PropertyModel extends EventAware{constructor(e){super(),this._modelMap={},this._groupMap={},this._styleGroup=new PropertyGroup("Styles"),this._childStyleMap={},this._groups=[],this._models=[],this._name=e}get name(){return this._name}get source(){return this._source}set source(e){e!==this._source&&(this._source=e,this.$_buildItems(),this._fireSourceChanged())}get sources(){return this._sources}set sources(e){this._sources=e,this.source=e&&e.length>0?e[0]:null}get groupCount(){return this._groups.length}get modelCount(){return this._models.length}getGroup(e){return this._groups[e]}getModel(e){return this._models[e]}refresh(){this.$_buildItems()}updateValue(e,t,i){const r=t._prop,s=this._sources;e=e||this.source,t.prop.multiple&&s&&s.length>1?(e=s[0],t.setValues(s,i)):e&&t.setValue(e,i),e&&e.isDominantProp(r)&&(this.refresh(),this._fireSourceChanged())}$_borrowGroup(e){let t=this._groupMap[e];return t||(this._groupMap[e]=t=new PropertyGroup(e)),t.source=null,t}$_borrowModel(e){let t=this._modelMap[e];return t||(this._modelMap[e]=t=new PropertyModel),t}$_clear(){this._models=[];for(let e in this._modelMap)this._modelMap[e].$_clear();this._groups=[];for(let e in this._groupMap)this._groupMap[e].clear();for(let e in this._childStyleMap)this._childStyleMap[e].clear()}$_buildSource(e,t){let i=e.getEditProps();for(let r of i)if(r.type!==StyleProperty){let i=t;i||(i=this.$_borrowGroup(this.name||r.category),this._groups.indexOf(i)<0&&this._groups.push(i));let s=i.borrow(r);s||(s=new r.type(r)),s instanceof ModelProperty&&(s.model.source=e[r.name],r.indented&&(i.source=s.model.source),s.model.$_buildItems(r.indented?i:null)),i.add(s)}let r=e.getStyleProps();if(r&&r.length>0){const e=this._styleGroup;e.source=this.source,e.clear();for(let t of r){let i=e.borrow(t);i||(i=new t.type(t)),e.add(i)}e.count>0&&this._groups.push(e)}for(let t of i)if(t.type===StylesProperty){const i=this.$_borrowGroup(t.name);if(assert(null!=i),i.source=this.source,i.clear(),r=e.getSubStyleProps(t.name),r&&r.length>0)for(let e of r){let t=i.borrow(e);t||(t=new e.type(e)),i.add(t)}i.count>0&&this._groups.push(i)}}$_buildModels(e){for(let t=0;t<e.length;t++){const i=e[t],r=this.$_borrowModel(i.getCollectionLabel()+t);r.source=i,this._models.push(r),r.$_buildItems()}}$_buildItems(e){this.$_clear();const t=this._source;t&&t.getEditProps&&(t.isCollectionProp()?this.$_buildModels(t.getPropertySources()):this.$_buildSource(t,e))}_fireSourceChanged(){this.fireEvent(PropertyModel.SOURCE_CHANGED)}}PropertyModel.SOURCE_CHANGED="onPropertySourceChanged";class ModelProperty extends PropertyItem{constructor(e){super(e),this._model=new PropertyModel(e.name)}get model(){return this._model}}ModelProperty.$_ctor="ModelProperty";const STYLE_CATEGORY="styles",BACKGROUND_COLOR="backgroundColor",COLOR="color",FONT_FAMILY="fontFamily",FONT_SIZE="fontSize",FONT_STYLE="fontStyle",FONT_WEIGHT="fontWeight",TEXT_ALIGN="textAlign",VERTICAL_ALIGN="verticalAlign",WRITING_MODE="writingMode",TEXT_DECORATION="textDecoration",LINE_HEIGHT="lineHeight",PADDING_LEFT="paddingLeft",PADDING_RIGHT="paddingRight",PADDING_TOP="paddingTop",PADDING_BOTTOM="paddingBottom",BORDER="border",BORDER_LEFT$2="borderLeft",BORDER_RIGHT$2="borderRight",BORDER_TOP$2="borderTop",BORDER_BOTTOM$2="borderBottom",OPACITY="opacity",FILL="fill",STROKE="stroke",STROKE_WIDTH="strokeWidth",STROKE_DASHARRAY="strokeDasharray",BACK_FILL="backFill",BACK_STROKE="backStroke",BAR_COLOR="barColor",CELL_ALIGN="cellAlign",STYLE_PROPS={};var DropResultType,ItemMoveType,PrintValue;STYLE_PROPS.backgroundColor={name:BACKGROUND_COLOR,category:"styles",type:ColorStyle,multiple:!0,default:void 0},STYLE_PROPS.color={name:COLOR,category:"styles",type:ColorStyle,multiple:!0,default:void 0},STYLE_PROPS.fontFamily={name:FONT_FAMILY,category:"styles",type:FontFamilyStyle,multiple:!0,default:void 0,domain:FontFamilyStyle.VALUES},STYLE_PROPS.fontSize={name:FONT_SIZE,category:"styles",type:FontSizeStyle,multiple:!0,default:void 0},STYLE_PROPS.fontStyle={name:FONT_STYLE,category:"styles",type:FontStyleStyle,multiple:!0,default:void 0,domain:FontStyleStyle.VALUES},STYLE_PROPS.fontWeight={name:FONT_WEIGHT,category:"styles",type:FontWeightStyle,multiple:!0,default:void 0,domain:FontWeightStyle.VALUES},STYLE_PROPS.textAlign={name:TEXT_ALIGN,category:"styles",type:TextAlignStyle,multiple:!0,default:void 0,domain:TextAlignStyle.VALUES},STYLE_PROPS.verticalAlign={name:VERTICAL_ALIGN,category:"styles",type:VerticalAlignStyle,multiple:!0,default:void 0,domain:VerticalAlignStyle.VALUES},STYLE_PROPS.writingMode={name:WRITING_MODE,category:"styles",type:WritingModeStyle,multiple:!0,default:void 0,domain:WritingModeStyle.VALUES},STYLE_PROPS.textDecoration={name:TEXT_DECORATION,category:"styles",type:TextDecorationStyle,multiple:!0,default:void 0,domain:TextDecorationStyle.VALUES},STYLE_PROPS.lineHeight={name:LINE_HEIGHT,category:"styles",type:LineHeightStyle,multiple:!0,default:void 0},STYLE_PROPS.border={name:BORDER,category:"styles",type:BorderStyle,multiple:!0,default:void 0},STYLE_PROPS.borderLeft={name:"borderLeft",category:"styles",type:BorderLeftStyle,multiple:!0,default:void 0},STYLE_PROPS.borderRight={name:"borderRight",category:"styles",type:BorderRightStyle,multiple:!0,default:void 0},STYLE_PROPS.borderTop={name:"borderTop",category:"styles",type:BorderTopStyle,multiple:!0,default:void 0},STYLE_PROPS.borderBottom={name:"borderBottom",category:"styles",type:BorderBottomStyle,multiple:!0,default:void 0},STYLE_PROPS.paddingLeft={name:PADDING_LEFT,category:"styles",type:PaddingLeftStyle,multiple:!0,default:void 0},STYLE_PROPS.paddingRight={name:PADDING_RIGHT,category:"styles",type:PaddingRightStyle,multiple:!0,default:void 0},STYLE_PROPS.paddingTop={name:PADDING_TOP,category:"styles",type:PaddingTopStyle,multiple:!0,default:void 0},STYLE_PROPS.paddingBottom={name:PADDING_BOTTOM,category:"styles",type:PaddingBottomStyle,multiple:!0,default:void 0},STYLE_PROPS.fill={name:FILL,category:"styles",type:ColorStyle,multiple:!0,default:void 0},STYLE_PROPS.stroke={name:STROKE,category:"styles",type:ColorStyle,multiple:!0,default:void 0},STYLE_PROPS.strokeWidth={name:STROKE_WIDTH,category:"styles",type:StrokeWidthStyle,multiple:!0,default:void 0},STYLE_PROPS.strokeDasharray={name:STROKE_DASHARRAY,category:"styles",type:StrokeDasharrayStyle,multiple:!0,default:void 0},STYLE_PROPS.backFill={name:BACK_FILL,category:"styles",type:ColorStyle,multiple:!0,default:void 0},STYLE_PROPS.backStroke={name:BACK_STROKE,category:"styles",type:ColorStyle,multiple:!0,default:void 0},STYLE_PROPS.barColor={name:BAR_COLOR,category:"styles",type:ColorStyle,multiple:!0,default:void 0},STYLE_PROPS.opacity={name:OPACITY,category:"styles",type:OpacityStyle,multiple:!0,default:void 0},STYLE_PROPS.cellAlign={name:CELL_ALIGN,category:"styles",type:CellAlignStyle,multiple:!0,default:void 0,domain:CellAlignStyle.VALUES},function(e){e.PROP="prop"}(DropResultType||(DropResultType={}));class ReportStyleObject{}ReportStyleObject.Shared=new ReportStyleObject;class ReportPageItem extends Base{constructor(){super(...arguments),this.outlineOrder=0}get selectItem(){return this}canSelectedWith(e){return!0}get index(){return-1}get outlineItems(){return[]}canParentOf(e){return!1}getProperty(e){return this[e]}setProperty(e,t){const i=this.page;i?i.report.setItemProperty(this,e,t):this[e]=t}isReadOnlyProperty(e){return!1}isDominantProp(e){return!1}isCollectionProp(){return!1}isEditableCollection(){return!1}isCollectionItem(){return!1}getPropertySources(){return null}getCollectionLabel(){}setItemsStyleProperty(e,t,i){const r=e.filter((e=>e instanceof ReportPageItem)),s=this.page;if(s){this.styles[t]!==i&&s.report.setItemsStyle(r,t,i)}else r.forEach((e=>{e.setStyle(t,i)}))}getPopupPropLabel(e){}get outlineSource(){return this}get parent(){const e=this.outlineParent;return e instanceof ReportGroupItem?e:null}get dataParent(){return this.parent}get displayParent(){return Utils.cast(this.outlineParent,ReportPageItem)}get marqueeParent(){return null}get printable(){return!0}isAncestorOf(e){return e===this}getProps(){const e={};return this.getEditProps().forEach((t=>{e[t.name]=this[t.name]})),e}setProps(e){Utils.isObject(e)&&this.getEditProps().forEach((t=>{if(!t.readonly){const i=t.name;e.hasOwnProperty(i)&&(this[i]=e[i])}}))}canMove(){return!0}_loadProp(e,t){e.hasOwnProperty(t)&&(this[t]=e[t])}_loadProps(e,...t){for(let i of t)e.hasOwnProperty(i)&&(this[i]=e[i])}_loadPropOf(e,t){if(!t.readonly&&!t.calculated&&t.type!==ModelProperty){const i=t.name;this[i]instanceof ReportItemCollection||e.hasOwnProperty(i)&&(this[i]=e[i])}}_loadPropsOf(e,t){for(let i of t)this._loadPropOf(e,i)}_saveProp(e,t){const i=this[t];void 0===i||Number.isNaN(i)||i instanceof ReportItemCollection||(e[t]=i)}_saveProps(e,...t){for(let i of t){const t=this[i];void 0===t||Number.isNaN(t)||t instanceof ReportItemCollection||(e[i]=t)}}_savePropOf(e,t){if(t.type!==ModelProperty){const i=t.name,r=this[i];void 0===r||Number.isNaN(r)||r===t.default||r instanceof ReportItemCollection||(e[i]=r)}}_savePropsOf(e,t){for(let i of t)i.calculated||this._savePropOf(e,i)}_loadObject(e,t,i){const r=e.getSaveLabel();i.hasOwnProperty(r)&&e.load(t,i[r])}_loadObjects(e,t,i){e.forEach((e=>{this._loadObject(e,t,i)}))}_saveObject(e,t){const i={};e.save(i),Utils.isEmpty(i)||(t[e.getSaveLabel()]=i)}_saveObjects(e,t){e.forEach((e=>{this._saveObject(e,t)}))}_arrangePaddingStyles(e){if(e.hasOwnProperty("padding")){const t=e.padding.split(/\s+/),i=t.length;e.hasOwnProperty("paddingTop")||(e.paddingTop=t[0]),e.hasOwnProperty("paddingBottom")||(e.paddingBottom=i>2?t[2]:t[0]),e.hasOwnProperty("paddingLeft")||(e.paddingLeft=i>3?t[3]:i>1?t[1]:t[0]),e.hasOwnProperty("paddingRight")||(e.paddingRight=i>1?t[1]:t[0]),delete e.padding}}_validateSize(e){if("number"==typeof e){if(!isNaN(e))return Math.max(0,e)}else if(e){const t=e.indexOf("-");if(t>=0)return e.substr(t+1)}return e}}!function(e){e.INNER="inner",e.OUTER="outer"}(ItemMoveType||(ItemMoveType={})),function(e){e.NO="${no}",e._NO="%{no}",e.ROW="${row}",e._ROW="%{row}",e.INDEX="${index}",e._INDEX="%{index}",e.INO="${ino}",e._INO="%{ino}"}(PrintValue||(PrintValue={}));const BLANK_FIELDS="$_blankFlds";class ReportItem extends ReportPageItem{constructor(e){super(),this._visible=!0,this._rotation=0,this._styles={},this._pageBreak=PageBreakMode.NONE,this._designOrder=ReportItem.DEF_DISPLAY_ORDER,this._designBorder=!0,this._index=-1,this._valueCallbackDelegate=(e,t,i,r)=>{try{return this._valueCallbackFunc(e,t,i,r)}catch(e){return console.error(e),"<ERROR>"}},this._styleCallbackDelegate=(e,t,i,r)=>{try{return this._styleCallbackFunc(e,t,i,r)}catch(e){return console.error(e),""}},this._name=e}static findFloatingAnchor(e){if(e instanceof ReportItem){let t=e.getFloatingContainer();if(t&&t.anchorTarget)return t.outlineParent.find(t.anchorTarget,!0)}}get outlineParent(){return this._parent}get outlineExpandable(){return!1}getEditProps(){const e=this._getEditProps();if(e){const t=[];for(let i of e)i&&i.name&&t.push(i);return t}return[]}getStyleProps(){const e=this._getStyleProps();if(e){const t=[];for(let i of e){const e=STYLE_PROPS[i];e&&t.push(e)}return t.length>0?t:null}}getSubStyleProps(e){if(this.isChildProp(e)){const t=this._getChildStyleProps(e);if(t){const i=[];for(let r of t){let t=STYLE_PROPS[r];t&&(t={...t},t.parent=e,i.push(t))}return i.length>0?i:null}}}getPlaceHolder(e){if(e.name===ReportItem.PROP_DATA)return this._getParentData()}getData(){var e;return null===(e=this.page)||void 0===e?void 0:e.report.designData.get(this.data||this._getParentData())}getDataFieldNames(){const e=this.getData();return e instanceof BandData||e instanceof SimpleData?[void 0].concat(e.getFieldNames()):[void 0]}getPropDomain(e){const t=this.page;if(t){if(e.name===ReportItem.PROP_DATA)return[void 0].concat(t.report.designData.getNames());if(e.name===ReportItem.PROP_VALUE)return this.getDataFieldNames()}}getProperty(e){return this.isChildProp(e)?this._childProps&&this._childProps[e]:this[e]}setProperty(e,t){const i=this.report;i?i.setItemProperty(this,e,t):this.isChildProp(e)?(this._childProps||(this._childProps={}),this._childProps[e]=t):this[e]=t}setItemsProperty(e,t,i){const r=e.filter((e=>e instanceof ReportPageItem)),s=this.report;s?s.setItemsProperty(r,t,i):r.forEach((e=>{e instanceof ReportItem&&(e.isChildProp(t)?(e._childProps||(e._childProps={}),e._childProps[t]=i):e[t]=i)}))}getProperties(e){const t={};if(Utils.isArray(e))for(let i of e)t[i]=this.getProperty(i);else for(let i in e)t[i]=this.getProperty(i);return t}setProperties(e){for(let t in e)if(this.isChildProp(t))this.setChildProp(t,e[t]);else{const i=Object.getOwnPropertyDescriptor(this,t);i&&(i.writable||i.set)&&(this[t]=e[t])}}getStyleProperty(e){return this._styles[e]}setStyleProperty(e,t){const i=this.page;if(i){this.styles[e]!==t&&i.report.setItemStyle(this,e,t)}else this.setStyle(e,t)}getSubStyleProperty(e,t){return this._getSubStyle(e,t)}setSubStyleProperty(e,t,i){const r=this.page;if(r){(this._childProps&&this._childProps[e]&&this._childProps[e][t])!=i&&r.report.setChildStyleProperty(this,e,t,i)}else this._setSubStyle(e,t,i)}setItemsSubStyleProperty(e,t,i,r){const s=e.filter((e=>e instanceof ReportItem)),n=this.page;if(n){this.styles[t]!==r&&n.report.setItemsChildStyleProperty(s,t,i,r)}else s.forEach((e=>{e._setSubStyle(t,i,r)}))}canPropAdoptDragSource(e,t){return!1}adoptPropDragSource(e,t){}dataNameChanged(e,t){this._data===t&&(this._data=e.name)}dataFieldNameChanged(e,t,i){}get parent(){return this._parent}get dataParent(){return this._parent}get index(){return this._index}get level(){return this._parent?this._parent.level+1:0}get page(){return this._parent&&this._parent.page}get report(){return this._parent&&this._parent.report}get name(){return this._name}set name(e){if(e!==this._name){const t=this.page,i=this._name;if(t&&e&&t.getItem(e))throw new Error('"'+e+'"는(은) 이미 다른 아이템의 이름으로 사용 중입니다.');this._name=e,t&&t.$_nameChanged(this,i),this._changed(ReportItem.PROP_NAME,e,i)}}get pathLabel(){return this.getSaveType()||Utils.uncapitalize(this.outlineLabel)}get displayPath(){return(this._parent?this._parent.displayPath+".":"")+this.pathLabel}get tag(){return this._tag}set tag(e){if(e!=this._tag){const t=this._tag;this._tag=e,this._changed(ReportItem.PROP_TAG,e,t)}}get isArray(){return!1}get isBand(){return!1}get visible(){return this._visible}set visible(e){e!=this._visible&&(this._visible=e,this._changed(ReportItem.PROP_VISIBLE,e,!e))}get removable(){return!0}get data(){return this._data}set data(e){if(e!=this._data){const t=this._data;this._data=e,this._changed(ReportItem.PROP_DATA,e,t)}}get value(){return this._value}set value(e){if(e!=this._value){const t=this._value;this._value=e,this._changed(ReportItem.PROP_TAG,e,t)}}get hint(){return this._hint}set hint(e){if(e!=this._hint){const t=this._hint;this._hint=e,this._changed(ReportItem.PROP_HINT,e,t)}}get width(){return this._width}set width(e){if((e=this._validateSize(e))!=this._width){const t=this._width;this._width=e,this._widthDim=new Dimension(e),this._changed(ReportItem.PROP_WIDTH,e,t)}}get height(){return this._height}set height(e){if((e=this._validateSize(e))!=this._height){const t=this._height;this._height=e,this._heightDim=new Dimension(e),this._changed(ReportItem.PROP_HEIGHT,e,t)}}get minWidth(){return this._minWidth}set minWidth(e){if(e!=this._minWidth){const t=this._minWidth;this._minWidth=e,this._minWidthDim=new Dimension(e),this._changed(ReportItem.PROP_MIN_WIDTH,e,t)}}get minHeight(){return this._minHeight}set minHeight(e){if(e!=this._minHeight){const t=this._minHeight;this._minHeight=e,this._minHeightDim=new Dimension(e),this._changed(ReportItem.PROP_MIN_HEIGHT,e,t)}}get rotation(){return this.canRotate()?this._rotation:void 0}set rotation(e){if((e=isNaN(e)?void 0:e%360)!==this._rotation){const t=this._rotation;this._rotation=e,this._changed(ReportItem.PROP_ROTATION,e,t)}}get isRotated(){return!isNaN(this.rotation)&&0!==this.rotation}get onGetValue(){return this._onGetValue}set onGetValue(e){if(e!==this._onGetValue){e?(this._valueCallbackFunc=new Function("ctx","item, row, value",e),this._valueCallback=this._valueCallbackDelegate):this._valueCallback===this._valueCallbackDelegate&&(this._valueCallback=null);const t=this._onGetValue;this._onGetValue=e,this._changed(ReportItem.PROP_ON_GET_VALUE,e,t)}}get valueCallback(){return this._valueCallback}set valueCallback(e){if(e!==this._valueCallback){const t=this._valueCallback;this._valueCallback=e,this._changed(ReportItem.PROP_ON_GET_VALUE,e,t)}}get styles(){return this._styles}set styles(e){const t=this._styles={};if(e){const i=this._getStyleProps();for(let r of i)r in e&&(t[r]=e[r])}t&&this._arrangePaddingStyles(t)}get styleCallback(){return this._styleCallback}set styleCallback(e){if(e!==this._styleCallback){const t=this._styleCallback;this._styleCallback=e,this._changed(ReportItem.PROP_STYLE_CALLBACK,e,t)}}get onGetStyles(){return this._onGetStyles}set onGetStyles(e){if(e!==this._onGetStyles){e?(this._styleCallbackFunc=new Function("ctx, item, row, value",e),this._styleCallback=this._styleCallbackDelegate):this._styleCallback===this._styleCallbackDelegate&&(this._styleCallback=null);const t=this._onGetStyles;this._onGetStyles=e,this._changed(ReportItem.PROP_ON_GET_STYLES,e,t)}}get pageBreak(){return this._pageBreak}set pageBreak(e){if(e!=this._pageBreak){const t=this._pageBreak;this._pageBreak=e,this._changed(ReportItem.PROP_PAGE_BREAK,e,t)}}get outlineLabel(){return this.name||this.hint}get designText(){return this.outlineLabel}get designLevel(){return 0}get childPropInfos(){return this._childPropInfos}set childPropInfos(e){this._childPropInfos=e}get floating(){return!!this.getFloatingContainer()}get designOrder(){return this._designOrder}set designOrder(e){this._designOrder=e}get designBorder(){return this._designBorder}set designBorder(e){e!==this._designBorder&&(this._designBorder=e,this._changed(ReportItem.PROP_DESIGN_BORDER,e,!e))}get isRelativeHeight(){return this._heightDim&&!this._heightDim.fixed}get left(){return this.getChildProp("left")}get right(){return this.getChildProp("right")}get top(){return this.getChildProp("top")}get bottom(){return this.getChildProp("bottom")}get row(){return this.getChildProp("row")||0}get col(){return this.getChildProp("col")||0}get equalBlank(){return this.getChildProp("equalBlank")}get blankFields(){return this.getChildProp("blankFields")}get mergedInGroup(){return this.getChildProp("mergedInGroup")}defaultInit(e,t,i,r){this._doDefaultInit(e,t,i,r)}getSaveType(){}getSaveLabel(){return this.getSaveType()}isContextValue(){return this._value&&ContextData.isValue(this._value)}setChildProp(e,t){if(this._childProps||(this._childProps={}),t!==this._childProps[e]){const i=this._childProps[e];return this.$_setChildProp(e,t),this._changed(e,t,i),!0}}$_setChildProp(e,t){switch(void 0===t?delete this._childProps[e]:this._childProps[e]=t,e){case ReportItem.PROP_LEFT:this._leftDim=Dimension.create(t);break;case ReportItem.PROP_RIGHT:this._rightDim=Dimension.create(t);break;case ReportItem.PROP_TOP:this._topDim=Dimension.create(t);break;case ReportItem.PROP_BOTTOM:this._bottomDim=Dimension.create(t)}}isChildProp(e){if(this._childPropInfos)for(let t of this._childPropInfos)if(t.name==e)return!0}getChildProp(e,t){const i=this._childProps&&this._childProps[e];return void 0===i?t:i}getChildProps(){return Object.keys(this._childProps).sort()}isStyleProp(e){const t=this._getStyleProps();return t&&t.includes(e)}canParentOf(e){return!1}canAddTo(e){return!!e}prepareLayout(e){this._doPrepareLayout(e)}preparePrint(e){this.prepareLayout(!0),this._doPreparePrint(e)}getLeft(e){return this._leftDim?this._leftDim.getPixel(e):NaN}setLeft(e){if(e!==this._leftDim){const t=this._leftDim;this._leftDim=e,this._changed(ReportItem.PROP_LEFT,t,e)}}getRight(e){return this._rightDim?this._rightDim.getPixel(e):NaN}setRight(e){if(e!==this._rightDim){const t=this._rightDim;this._rightDim=e,this._changed(ReportItem.PROP_RIGHT,t,e)}}getTop(e){return this._topDim?this._topDim.getPixel(e):NaN}setTop(e){if(e!==this._topDim){const t=this._topDim;this._topDim=e,this._changed(ReportItem.PROP_TOP,t,e)}}getBottom(e){return this._bottomDim?this._bottomDim.getPixel(e):NaN}setBottom(e){if(e!==this._bottomDim){const t=this._bottomDim;this._bottomDim=e,this._changed(ReportItem.PROP_BOTTOM,t,e)}}getWidth(e){return this._widthDim?this._widthDim.getPixel(e):NaN}getHeight(e){return this._heightDim?this._heightDim.getPixel(e):NaN}getMinWidth(e){return this._minWidthDim?this._minWidthDim.getPixel(e):NaN}getMinHeight(e){return this._minHeightDim?this._minHeightDim.getPixel(e):NaN}canSized(){return!0}canResize(e){return!0}canResizeWidth(){return this.canResize(ResizeDirection.LEFT)}canResizeHeight(){return this.canResize(ResizeDirection.TOP)}resize(e,t){return this.canResizeWidth()&&(this.width=e),this.canResizeHeight()&&(this.height=t),this}canRotate(){return!1}hasStyle(e){return this._styles.hasOwnProperty(e)}getStyle(e){return this._styles[e]}setStyle(e,t){const i=this._styles[e];t||(t=void 0),t!==i&&(void 0===t?delete this._styles[e]:this._styles[e]=t,this._changed(e,t,i))}clearStyle(e){if(this._styles.hasOwnProperty(e)){const t=this._styles[e];delete this._styles[e],this._changed(e,void 0,t)}}clearStyles(e){for(let t of this._getStyleProps())e[t]=""}load(e,t){t&&this._doLoad(e,t)}save(e){var t;const i=this.getSaveType();i&&(e.type=i),this._name&&(e.name=this._name);const r=null===(t=this.page)||void 0===t?void 0:t.saveTag;return r&&(e[r]=this),this._doSave(e),this.stylable&&(Utils.isEmpty(this._styles)||(this._saveProp(e,"styles"),r&&(e.styles[r]=ReportStyleObject.Shared)),this._saveProp(e,"styleCallback")),Utils.isNotEmpty(e)}getFloatingContainer(){return this instanceof FloatingContainer?this:this._parent instanceof FloatingContainer?this._parent:void 0}delete(){this._parent&&this._parent.remove(this)}isAncestor(e){let t=this._parent;for(;t;){if(t===e)return!0;t=t._parent}}$_getValue(e,t,i){if(i&&i.indexOf("::")>0)return e.getValue(i,t);if(this._data)return e.getValueAt(this._data,i,t);{const r=this._getParentData();if(r)return e.getValueAt(r,i,t)}}getValue(e,t){var i;const r=null===(i=this.page)||void 0===i?void 0:i.report.data;if(r)return this.$_getValue(r,e,t)}getPrintValue(e,t){return this.$_getValue(e,t,this._value)}_getParentData(){let e=this.dataParent;for(;e;){if(e.data)return e.data;e=e.dataParent}}canRemoveFrom(){return this._parent&&this._parent.canRemove(this)}canAdoptDragSource(e){return!1}adoptDragSource(e){}canPageBreak(){return this.level<=4}isBreakBefore(){return this.canPageBreak()&&(this.pageBreak===PageBreakMode.BEFORE||this.pageBreak==PageBreakMode.BOTH)}isBreakAfter(){return this.canPageBreak()&&(this.pageBreak===PageBreakMode.AFTER||this.pageBreak==PageBreakMode.BOTH)}getInvalids(e){if(this.data){const t=e.designData.get(this.data);if(!t)return['"'+this.data+'" is not a valid data name.'];if(this.value&&t instanceof BandData&&!t.containsField(this.value))return['"'+this.value+'" is not a valid field name.']}}get marqueeParent(){var e;return this||this._parent||(null===(e=this._parent)||void 0===e?void 0:e.marqueeParent)}get printable(){return this.visible}isReadOnlyProperty(e){var t;return!("data"!==e.name||!(null===(t=this.dataParent)||void 0===t?void 0:t.dataDominant))}_sizable(){return!0}_boundable(){return!0}_doDefaultInit(e,t,i,r){}_getSubStyle(e,t){const i=this.getChildProp(e);return i&&i[t]}_setSubStyle(e,t,i){this._childProps||(this._childProps={}),this._childProps[e]||(this._childProps[e]={});let r=this.getChildProp(e);r||(r={},this.setChildProp(e,r));const s=r[t];i!=s&&(void 0===i?delete r[t]:r[t]=i,this._changed(e,i,s))}_doApplyStyle(e,t,i){return!1}_setLeft(e){this._leftDim=new Dimension(e)}_setRight(e){this._rightDim=new Dimension(e)}_setTop(e){this._topDim=new Dimension(e)}_setBottom(e){this._bottomDim=new Dimension(e)}_getEditProps(){let e=ReportItem.PROPINFOS;return this._sizable()&&(e=e.concat(ReportItem.SIZE_PROPINFOS)),this._valueable()?e=e.concat(ReportItem.VALUE_PROPINFOS):this._datable()&&(e=e.concat(ReportItem.VALUE_PROPINFOS[0])),this._childPropInfos&&(e=e.concat(this._childPropInfos)),e}_getStyleProps(){return[]}_getChildStyleProps(e){return"cellStyles"===e?["cellAlign","backgroundColor","paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeft","borderRight","borderTop","borderBottom"]:[]}_valueable(){return!0}_datable(){return!1}$_attached(e){this._parent!==e&&(this._parent=e,e&&this._doAttached())}_doAttached(){}$_detached(){this._parent&&(this._parent=null,this._doDetached())}_doDetached(){}_isLoading(){const e=this.page;return e&&e.loading}_changed(e,t,i){const r=this.page;r&&!r.loading&&(this._parent&&this._parent.$_childChanged(this,e,t,i),r.$_itemChanged(this,e,t,i))}get stylable(){return!0}_doLoad(e,t){this._loadPropsOf(t,ReportItem.PROPINFOS),this._valueable()?this._loadPropsOf(t,ReportItem.VALUE_PROPINFOS):this._datable()&&this._loadPropOf(t,ReportItem.VALUE_PROPINFOS[0]),this._sizable()&&this._loadPropsOf(t,ReportItem.SIZE_PROPINFOS),this.stylable&&this._loadProps(t,"styles","styleCallback")}_saveChildPropsOf(e,t){const i=this._childProps;if(i)for(let r of t){const t=r.name,s=i[t];void 0===s||"number"==typeof s&&isNaN(s)||s===r.default||(e[t]=s)}}_doSave(e){this._valueable()?this._savePropsOf(e,ReportItem.VALUE_PROPINFOS):this._datable()&&this._savePropOf(e,ReportItem.VALUE_PROPINFOS[0]),this._sizable()&&this._savePropsOf(e,ReportItem.SIZE_PROPINFOS),this._savePropsOf(e,ReportItem.PROPINFOS);const t=this._childPropInfos;t&&t.length>0&&this._saveChildPropsOf(e,t)}_doPrepareLayout(e){}_doPreparePrint(e){}}ReportItem.DEF_DISPLAY_ORDER=99,ReportItem.PROP_NAME="name",ReportItem.PROP_TAG="tag",ReportItem.PROP_LEFT="left",ReportItem.PROP_RIGHT="right",ReportItem.PROP_TOP="top",ReportItem.PROP_BOTTOM="bottom",ReportItem.PROP_DESIGN_BORDER="designBorder",ReportItem.PROP_ON_GET_VALUE="onGetValue",ReportItem.PROP_STYLES="styles",ReportItem.PROP_ON_GET_STYLES="onGetStyles",ReportItem.PROP_VISIBLE="visible",ReportItem.PROP_DATA="data",ReportItem.PROP_VALUE="value",ReportItem.PROP_HINT="hint",ReportItem.PROP_WIDTH="width",ReportItem.PROP_HEIGHT="height",ReportItem.PROP_MIN_WIDTH="minWdth",ReportItem.PROP_MIN_HEIGHT="minHeight",ReportItem.PROP_LOCKED="locked",ReportItem.PROP_PAGE_BREAK="pageBreak",ReportItem.PROP_STYLE_CALLBACK="styleCallback",ReportItem.PROP_ROTATION="rotation",ReportItem.DATA_PROP={name:ReportItem.PROP_DATA,category:PropCategory.DATA,type:ListableProperty,multiple:!1,default:void 0,domain:void 0},ReportItem.VALUE_PROP={name:ReportItem.PROP_VALUE,category:PropCategory.DATA,type:ListableProperty,multiple:!1,default:void 0,domain:void 0,validate:(e,t)=>{if(t){if(Utils.getEnumValues(PrintValue).indexOf(t)>=0)return;if(e.getData()&&e.getDataFieldNames().indexOf(t)<0)throw'"'+t+'"는(은) 타당한 출력 변수 혹은 데이터 필드명이 아닙니다.'}}},ReportItem.PROPINFOS=[{name:ReportItem.PROP_NAME,category:PropCategory.BASIC,type:StringProperty,multiple:!1,default:void 0},{name:ReportItem.PROP_TAG,category:PropCategory.BASIC,type:StringProperty,multiple:!1,default:void 0},{name:ReportItem.PROP_DESIGN_BORDER,category:PropCategory.DESIGN,type:BooleanProperty,multiple:!1,default:!0},{name:ReportItem.PROP_VISIBLE,category:PropCategory.BASIC,type:BooleanProperty,multiple:!0,default:!0},{name:ReportItem.PROP_PAGE_BREAK,category:PropCategory.BASIC,type:EnumProperty,multiple:!0,default:PageBreakMode.NONE,domain:PageBreakMode,visible:e=>e.canPageBreak()},{name:ReportItem.PROP_ON_GET_VALUE,category:PropCategory.EVENT,type:FunctionProperty,multiple:!1,default:void 0,signature:"(ctx/* PrintContext*/, item/*ReportItem*/, row/*Number*/, value/*any*/)/*any*/",visible:e=>e instanceof ReportItem&&!(e instanceof ReportGroupItem)},{name:ReportItem.PROP_ON_GET_STYLES,category:PropCategory.EVENT,type:FunctionProperty,multiple:!1,default:void 0,signature:"(ctx/* PrintContext*/, item/*ReportItem*/, row/*Number*/, value/*any*/)/*any*/"}],ReportItem.SIZE_PROPINFOS=[{name:ReportItem.PROP_WIDTH,category:PropCategory.BOUND,type:SizeProperty,multiple:!0,default:void 0,visible:e=>e.canSized()},{name:ReportItem.PROP_HEIGHT,category:PropCategory.BOUND,type:SizeProperty,multiple:!0,default:void 0,visible:e=>e.canSized()},{name:ReportItem.PROP_ROTATION,category:PropCategory.BOUND,type:NumberProperty,default:0,visible:e=>e.canRotate()}],ReportItem.VALUE_PROPINFOS=[ReportItem.DATA_PROP,ReportItem.VALUE_PROP];class ReportGroupItem extends ReportItem{constructor(e){super(e),this._items=[],this.layoutChanged=!1}get outlineExpandable(){return!0}get outlineItems(){return this.items}get isChildPropContainer(){return!0}get count(){return this._items.length}get items(){return this._items.slice()}get designWidth(){return this._designWidth}set designWidth(e){if(e!==this._designWidth){const t=this._designWidth;this._designWidth=e,this._changed(ReportGroupItem.PROP_DESIGN_WIDTH,e,t)}}get designHeight(){return this._designHeight}set designHeight(e){if(e!==this._designHeight){const t=this._designHeight;this._designHeight=e,this._changed(ReportGroupItem.PROP_DESIGN_HEIGHT,e,t)}}get dataDominant(){return!1}get firstChild(){return this._items[0]}get lastChild(){return this._items[this._items.length-1]}get isDataRowContainer(){return!1}needDesignWidth(){return!0}needDesignHeight(){return!0}get(e){return this._items[e]}canContainsBand(){return!1}canContainsBandGroup(){return!1}contains(e,t=!1){if(e instanceof ReportItem){if(this._items.includes(e))return!0;if(t)for(let t of this._items)if(t instanceof ReportGroupItem&&t.contains(e,!0))return!0}return!1}indexOf(e){return e instanceof ReportItem&&this._items.indexOf(e)}getNames(e,t=!0){const i=function(e,r){for(let s=e._items.length-1;s>=0;s--){const n=e._items[s];n.name&&r.push(n.name),t&&n instanceof ReportGroupItem&&i(n,r)}};return i(this,e=e||[]),e}find(e,t=!0){const i=this._items;for(let r=i.length-1;r>=0;r--){let s=i[r];if(s.name===e)return s;if(t&&s instanceof ReportGroupItem&&(s=s.find(e,!0),s))return s}}canAdd(e){return e&&this._items.length<this._maxChildCount()&&e.canAddTo(this)&&!this.contains(e)}append(e,t=!1){return this.add(e,-1,t)}add(e,t=-1,i=!1){if(e instanceof ReportItem&&this.canAdd(e)){let r=e.outlineParent;r&&(r instanceof CellGroup&&(r=r.outlineParent),r instanceof ReportGroupItem&&r.remove(e)),t<0&&(t=this._items.length);const s=this._addItem(e,t,i);return this._doItemAdded(s,t),this.$_resetIndices(),!0}}canRemove(e){return e instanceof ReportItem&&e.removable&&this.contains(e)}remove(e){if(e instanceof ReportItem&&this.canRemove(e)){const t=this._removeItem(e);t>=0&&(this._doItemRemoved(e,t),this.$_resetIndices())}}removeLast(){this.count>0&&this.remove(this.get(this.count-1))}clear(){this._clearItems()}getMoveType(e){}canResizeChild(e,t){return!0}search(e,t,i){for(let r of this._items)if(r instanceof ReportGroupItem)r.search(e,t,i);else{const s=r.designText;if(s){let n=s;t.caseSensitive||(n=n.toLowerCase()),(t.wholeWord&&n===e||!t.wholeWord&&n.indexOf(e)>=0)&&i.push({item:r,prop:s})}}}canChangeChildProp(e,t,i){return!0}changeChildIndex(e,t){const i=this.indexOf(e);if(i>=0&&i!==t)return this._items.splice(i,1),this._items.splice(t,0,e),this.$_resetIndices(),e._changed("index",t,i),!0}canAlign(e){return!1}canAlignTo(e,t){return!0}filter(e){return this._items.filter(e)}getDescendants(e=!1,t=!0){const i=[];return function i(r,s){r._items.forEach((r=>{r instanceof ReportGroupItem?e&&(s.push(r),t&&i(r,s)):s.push(r)}))}(this,i),i}collectInvalids(e,t){this._items.forEach((i=>{const r=i.getInvalids(e);r&&r.forEach((e=>t.push({item:i,reason:e}))),i instanceof ReportGroupItem&&i.collectInvalids(e,t)}))}collectBlankItems(e){const t=[];return(e||this._items).forEach((e=>{if(e.equalBlank){let i=e.value?[e.value]:[],r=e.blankFields;r&&(i=r.split(",").map((e=>e.trim())).filter((e=>!!e))),i.length&&(t.push(e),e.$_blankFlds=i)}})),t.length>0?t:null}_getEditProps(){return super._getEditProps().concat(ReportGroupItem.PROPINFOS)}_getStyleProps(){return["paddingLeft","paddingRight","paddingTop","paddingBottom"]}_maxChildCount(){return Number.MAX_SAFE_INTEGER}isAncestorOf(e){if(e===this)return!0;if(this.contains(e))return!0;for(let t of this._items)if(t.isAncestorOf(e))return!0}canParentOf(e){return!0}prepareLayout(e){super.prepareLayout(e);for(let t of this._items)t.prepareLayout(e)}preparePrint(e){super.preparePrint(e);for(let t of this._items)t.preparePrint(e)}_getNameOfItems(){return"items"}_doLoad(e,t){super._doLoad(e,t);const i=this._getNameOfItems();!this._ignoreItems()&&t.hasOwnProperty(i)&&this._loadItems(e,t[i])}_ignoreItems(){return!1}save(e){let t=super.save(e);return!this._ignoreItems()&&this._items.length>0&&(this._saveItems(e[this._getNameOfItems()]=[]),t=!0),t}dataNameChanged(e,t){super.dataNameChanged(e,t),this._items.forEach((i=>i.dataNameChanged(e,t)))}get internalItems(){return this._items}_valueable(){return!1}_loadChildProp(e,t,i){i.hasOwnProperty(t)&&e.setChildProp(t,i[t])}_loadChildProps(e,t,i){for(let r of t)i.hasOwnProperty(r)&&e.setChildProp(r,i[r])}_loadChildPropsOf(e,t,i){for(let r of i)if(r.name in t){const i=t[r.name];e.setChildProp(r.name,i)}}_getChildPropInfos(e){return null}_loadChild(e,t,i){return t.load(e,i),this.isChildPropContainer&&(t.childPropInfos=this._getChildPropInfos(t)),this._doLoadChild(t,i),t}_loadItems(e,t){const i=Utils.makeArray(t);if(this.clear(),i){const t=this.page,r=[];let s=0;for(let n of i)if(n){let i=e.createItem(n);i&&(i.$_attached(this),i=this._loadChild(e,i,n),!i.parent&&i.$_attached(this),r.push(i),t&&t.$_itemAdded(i,s,!0),this._doItemAdded(i,s++))}r&&r.length>0&&(this._items=r,this.$_resetIndices())}}_doLoadChild(e,t){}_saveItems(e){this._doSaveItems(e,this._items)}_doSaveItems(e,t){for(let i of t){const t={};i.save(t),e.push(t)}}_addItem(e,t,i){const r=this.page,s=this._items;return t=Math.max(0,Math.min(s.length,t)),s.splice(t,0,e),this.isChildPropContainer&&(e.childPropInfos=this._getChildPropInfos(e)),e.$_attached(this),r&&r.$_itemAdded(e,t,i),e}_removeItem(e){const t=e?this._items.indexOf(e):-1;if(t>=0){const i=this.page,r=e.parent;return this._items.splice(t,1),e.$_detached(),i&&i.$_itemRemoved(e,r),t}return-1}_clearItems(){if(this._items.length>0){const e=this.page,t=this._items.slice();this._items=[];for(let e of t)e.$_detached();e&&e.$_itemsRemoved(t)}}_doItemAdded(e,t){}_doItemRemoved(e,t){}$_resetIndices(){for(let e=this._items.length-1;e>=0;e--)this._items[e]._index=e}$_childChanged(e,t,i,r){this._doItemChanged(e,t,i,r)}_doItemChanged(e,t,i,r){}_setOutlineOrders(e,...t){for(let i of t)i.outlineOrder=e++}}ReportGroupItem.PROP_DESIGN_WIDTH="designWidth",ReportGroupItem.PROP_DESIGN_HEIGHT="designHeight",ReportGroupItem.PROPINFOS=[{name:ReportGroupItem.PROP_DESIGN_WIDTH,category:PropCategory.DESIGN,type:DimensionProperty,multiple:!1,default:void 0,visible:e=>e.needDesignWidth()},{name:ReportGroupItem.PROP_DESIGN_HEIGHT,category:PropCategory.DESIGN,type:DimensionProperty,multiple:!1,default:void 0,visible:e=>e.needDesignHeight()}];class ReportItemCollectionItem extends ReportPageItem{constructor(e,t){super(),this._collection=e,t&&this.load(t),this._styles||(this._styles={})}get outlineParent(){return this._collection}get outlineExpandable(){return!1}get outlineLabel(){return"["+this.index+"] "+this.itemType}getSaveType(){return""}canRemoveFrom(){return!0}getPropDomain(e){return null}getStyleProps(){const e=this._getStyleProps(),t=[];for(let i of e)t.push(STYLE_PROPS[i]);return t}getStyle(e){return this._styles[e]}setStyle(e,t){const i=this._styles[e];t!==i&&(void 0===t?delete this._styles[e]:this._styles[e]=t,this._changed(e,t,i))}getStyleProperty(e){return this._styles[e]}setStyleProperty(e,t){const i=this.page;if(i){this._styles[e]!==t&&i.report.setItemStyle(this,e,t)}else this.setStyle(e,t)}getSubStyleProps(e){return null}getPlaceHolder(e){}setItemsProperty(e,t,i){}getSubStyleProperty(e,t){}isChildProp(e){return!1}setSubStyleProperty(e,t,i){}setItemsSubStyleProperty(e,t,i,r){}canPropAdoptDragSource(e,t){return!1}adoptPropDragSource(e,t){}isCollectionItem(){return!0}get styles(){return this._styles}set styles(e){const t=this._styles={};if(e){const i=this._getStyleProps();for(let r of i)r in e&&(t[r]=e[r])}t&&this._arrangePaddingStyles(t)}load(e){this._doLoad(e)}save(e){return this._doSave(e),e}get collection(){return this._collection}get level(){return this._collection?this._collection.level+1:0}_doLoad(e){e.hasOwnProperty("styles")&&(this.styles=e.styles)}_doSave(e){Utils.isEmpty(this._styles)||this._saveProp(e,"styles")}_changed(e,t,i){var r;null===(r=this._collection)||void 0===r||r._itemChanged(this,e,t,i)}}class ReportItemCollection extends ReportPageItem{canRemoveFrom(){return!1}canParentOf(e){return!1}getEditProps(){return[]}getStyleProps(){return[]}getSubStyleProps(e){return null}getPlaceHolder(e){}getPropDomain(e){return null}getProperty(e){}setProperty(e,t){}setItemsProperty(e,t,i){}getStyleProperty(e){}getStyle(e){}setStyle(e,t){}setStyleProperty(e,t){}setItemsStyleProperty(e,t,i){}isChildProp(e){return!1}getSubStyleProperty(e,t){}setSubStyleProperty(e,t,i){}setItemsSubStyleProperty(e,t,i,r){}canPropAdoptDragSource(e,t){return!1}adoptPropDragSource(e,t){}isCollectionProp(){return!0}getPropertySources(){return this.items}preparePrint(e){this._doPreparePrint(e);for(let t=this.count-1;t>=0;t--){const i=this.get(t);i instanceof ReportItem&&i.preparePrint(e)}}forEach(e){for(let t=0,i=this.count;t<i;t++)e(this.get(t),t)}moveItem(e,t){if(e!==t&&e>=0&&e<this.count&&t>=0&&t<this.count&&this._doMoveItem(e,t))return this._indexChanged(),!0}get styles(){return null}_itemChanged(e,t,i,r){var s;null===(s=this.page)||void 0===s||s.$_itemChanged(e,t,i,r)}_itemAdded(e){const t=this.page;t&&t.$_itemAdded(e,e.index,!1)}_itemsAdded(e){const t=this.page;t&&t.$_itemsAdded(e,e[0].index)}_itemRemoved(e,t){const i=this.page;i&&i.$_itemRemoved(e,t)}_itemsRemoved(e){const t=this.page;t&&t.$_itemsRemoved(e)}_indexChanged(){const e=this.page;e&&e.$_collectionChanged(this)}_doPreparePrint(e){}}var AnchorPosition,BandSectionLayout;!function(e){e.CENTER="center",e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom",e.INNER_LEFT="innerLeft",e.INNER_RIGHT="innerRight",e.INNER_TOP="innerTop",e.INNER_BOTTOM="innerBottom"}(AnchorPosition||(AnchorPosition={}));class FloatingContainer extends ReportGroupItem{constructor(e){super(e),this._anchorPosition=AnchorPosition.CENTER,this.designWidth=80,this.designHeight=80}get anchorTarget(){return this._anchorTarget}set anchorTarget(e){if(e!=this._anchorTarget){const t=this._anchorTarget;this._anchorTarget=e,this._changed(FloatingContainer.PROP_ANCHOR_TARGET,e,t)}}get anchorPosition(){return this._anchorPosition}set anchorPosition(e){if(e!=this._anchorPosition){const t=this._anchorPosition;this._anchorPosition=e,this._changed(FloatingContainer.PROP_ANCHOR_POSITION,e,t)}}getSaveType(){return"floating"}get outlineLabel(){return"[Floating]"}_maxChildCount(){return 1}_boundable(){return!1}_getEditProps(){return super._getEditProps().concat(FloatingContainer.PROPINFOS)}getPropDomain(e){return e.name===FloatingContainer.PROP_ANCHOR_TARGET?this.outlineParent.getNames([void 0],!0):super.getPropDomain(e)}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=Math.min(i||100,100),this.height=100}_doLoad(e,t){super._doLoad(e,t),!t.hasOwnProperty("items")&&t.hasOwnProperty("item")&&this._loadItems(e,t.item),this._loadPropsOf(t,FloatingContainer.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,FloatingContainer.PROPINFOS)}canAdd(e){return super.canAdd(e)&&!(e instanceof FloatingContainer)}}FloatingContainer.PROP_ANCHOR_TARGET="anchorTarget",FloatingContainer.PROP_ANCHOR_POSITION="anchorPosition",FloatingContainer.PROPINFOS=[{name:FloatingContainer.PROP_ANCHOR_TARGET,category:"Floating",type:ReportItemProperty,multiple:!1,default:void 0},{name:FloatingContainer.PROP_ANCHOR_POSITION,category:"Floating",type:EnumProperty,multiple:!1,default:AnchorPosition.CENTER,domain:AnchorPosition}],FloatingContainer.$_ctor="FloatingContainer",FloatingContainer.ITEM_TYPE="Floating Container";class BoundedContainer extends ReportGroupItem{constructor(e){super(e)}_getChildPropInfos(e){return e._boundable()?BoundedContainer.CHILD_PROPS:null}_doLoadChild(e,t){super._doLoadChild(e,t),this._loadChildPropsOf(e,t,BoundedContainer.CHILD_PROPS)}}BoundedContainer.CHILD_PROPS=[{name:ReportItem.PROP_LEFT,category:PropCategory.BOUND,type:DimensionProperty,multiple:!0,default:void 0,domain:void 0},{name:ReportItem.PROP_RIGHT,category:PropCategory.BOUND,type:DimensionProperty,multiple:!0,default:void 0,domain:void 0},{name:ReportItem.PROP_TOP,category:PropCategory.BOUND,type:DimensionProperty,multiple:!0,default:void 0,domain:void 0},{name:ReportItem.PROP_BOTTOM,category:PropCategory.BOUND,type:DimensionProperty,multiple:!0,default:void 0,domain:void 0}];class CellGroup extends ReportGroupItem{constructor(e,t){super(t),assert(!!e),this._addItem(this._item=e,0,!0)}get item(){return this._item}get isEmpty(){return!this._item}get isChildPropContainer(){return!1}set childPropInfos(e){this._item.childPropInfos=e}get printable(){return!this._item||this._item.printable}_maxChildCount(){return 1}_doItemChanged(e,t,i,r){this.outlineParent._doItemChanged(e,t,i,r)}}class CellContainer extends ReportGroupItem{constructor(e){super(e),this.noPrepareCell=!1}contains(e,t=!1){if(super.contains(e))return!0;if(!(e instanceof CellGroup))for(let i of this._items){const r=i.item;if(r){if(r===e)return!0;if(t&&r instanceof ReportGroupItem&&r.contains(e))return!0}}}indexOf(e){let t=super.indexOf(e);if(t<=0&&!(e instanceof CellGroup)){const i=this._items;for(let r=i.length-1;r>=0;r--)if(i[r].item===e){t=r;break}}return t}findCell(e){for(let t of this.internalItems)if(t.item===e)return t}find(e,t=!0){const i=this.internalItems;for(let r=i.length-1;r>=0;r--){let s=i[r].item;if(s.name===e)return s;if(t&&s instanceof ReportGroupItem&&(s=s.find(e,!0),s))return s}}_loadChild(e,t,i){return super._loadChild(e,t,i),this.noPrepareCell||(t=this._prepareCellGroup(t)),t}_addItem(e,t,i){return e=this._prepareCellGroup(e),super._addItem(e,t,i)}_removeItem(e){const t=this._unprepareCellGroup(e);if(t){let i=super._removeItem(t);if(i>=0&&e.outlineParent===t)return t._removeItem(e),i}return-1}_unprepareCellGroup(e){return this.findCell(e)}}!function(e){e.ACROSS_DOWN="acrossDown",e.DOWN_ACROSS="downAcross"}(BandSectionLayout||(BandSectionLayout={}));class ReportItemElement extends ReportElement{constructor(e,t,i){super(e,i),this._modelChanged=!0,this._rotation=0,this._model=t,this._doModelChanged(null)}_doDispose(){this._model=null,super._doDispose()}get model(){return this._model}set model(e){if(e!==this._model){const t=this._model;this._model=e,this._modelChanged=!0,this._doModelChanged(t)}}get navigableParent(){let e=this.parent;for(;e;){if(e instanceof ReportGroupItemElement)return e.navigable?e:e.navigableParent;e=e.parent}}get modelParent(){let e=this.parent;for(;e;){if(e instanceof ReportGroupItemElement&&e.model===this._model.outlineParent)return e;e=e.parent}return null}get marqueeParent(){var e;const t=null===(e=this.model)||void 0===e?void 0:e.marqueeParent;if(t){let e=this;for(;e;){if(e instanceof ReportItemElement&&e.model===t)return e;e=e.parent}}return this}get designable(){return!0}get editable(){return!1}get isSpace(){return!1}get isRelativeHeight(){return this._model.isRelativeHeight}get rotation(){return this._rotation}setRotation(e){e!==this._rotation&&this.$_setRotation(this._rotation=e)}_clearDesign(){this._designView&&(Utils.remove(this._designView),this._designView=null),super._clearDesign()}getEditText(){return""}setEditText(e,t){}refreshPrintValues(e){}get printable(){return!this._model||this._model.printable}_initDom(e,t){super._initDom(e,t),this.designable&&(this._designView=e.createElement("div"),this._designView.className="rr-design-back",t.appendChild(this._designView),this._bindMarker=e.createElement("span"),this._bindMarker.className="rr-bind-marker",this._designView.appendChild(this._bindMarker))}_setBindMarker(e=!0,t=!1){e?(this._bindMarker.dataset.vis="1",t?this._bindMarker.dataset.sys="1":delete this._bindMarker.dataset.sys):delete this._bindMarker.dataset.vis}_doPrepareMeasure(e,t){const i=this._model;if(i){if(i.stylable){if(!e.printing){if(this._prevStyles){const e=t.style;for(let t in this._prevStyles)e[t]=""}this._prevStyles=i.styles&&{...i.styles}}this._doSetStyles(i,t)}if(e.printing){t.dataset._m_=i.shash,e.report&&(e.report.models[i.shash]=i);const r=i.styleCallback;if(r)try{const s=this.getPrintValue(e,i),n=r(e,i,e.row,s);n&&Utils.extend(t.style,n)}catch(e){console.error("StyleCallback Error",e)}t.dataset.row=e.row+""}t.title=i.hint||""}}$_setRotation(e){const t=this.dom;isNaN(e)||0===e?(t.style.transform="",this._rotation=0):(t.style.transformOrigin="center",t.style.transform=0===e?"":"rotate("+e+"deg)",this._rotation=e)}_doAfterMeasure(e,t,i,r,s){const n=this._model;if(n){const e=n.getWidth(i),t=n.getHeight(r);isNaN(e)||(s.width=e),isNaN(t)||(s.height=t)}const o=n.canRotate()?n.rotation:void 0;this.$_setRotation(o)}findElement(e){return this._model&&e&&this._model.name===e?this:null}findElementOf(e){return this.isDom(e)?this:null}getPrintValue(e,t,i){let r,s=t.value;switch(s){case PrintValue.NO:case PrintValue._NO:if(e.row>=0)return e.row+1;break;case PrintValue.ROW:case PrintValue._ROW:if(e.row>=0)return e.row;break;case PrintValue.INDEX:case PrintValue._INDEX:return isNaN(e.band.rowIndex)?e.index:e.band.rowIndex;case PrintValue.INO:case PrintValue._INO:return(isNaN(e.band.rowIndex)?e.index:e.band.rowIndex)+1;default:s&&e.dp&&(r=t.getPrintValue(e.dp,e.row))}const n=this._runValueCallback(e,t,r);return void 0!==n&&(r=n),void 0!==r?r:i}_doModelChanged(e){}_setX(e,t){e.style.left=t+"px"}_setY(e,t){e.style.top=t+"px"}_setPos(e,t,i){e.style.left=t+"px",e.style.top=i+"px"}_runValueCallback(e,t,i){if(!e.noValueCallback){const r=t.valueCallback;if(r){const s=r(e,t,e.row,i);if(void 0!==s)return s}}}}class ReportGroupItemElement extends ReportItemElement{constructor(e,t,i){super(e,t,i),this._padLeft=0,this._padRight=0,this._padTop=0,this._padBottom=0,this._borderApplied=!1,this.measureFixed=!1}_doDispose(){this._floatings&&(this._floatings=null),super._doDispose()}get navigable(){return!0}get lazyLayoutChildren(){return!1}isContentDom(e){return e===this._contentBox}findElement(e){let t=super.findElement(e);if(!t){const i=this._getItemsParent();for(let r=0,s=i.childCount;r<s;r++){if(t=i.getChild(r).findElement(e),t)break}}return t}findElementOf(e){let t=super.findElementOf(e);if(!t){const i=this._getItemsParent();for(let r=0,s=i.childCount;r<s;r++){const s=i.getChild(r);if(s instanceof ReportItemElement&&(t=s.findElementOf(e),t))break}}return t||e!==this._contentBox?t:this}getElementOf(e){if(e===this.model)return this;const t=this._getItemsParent();for(let i=0,r=t.childCount;i<r;i++){const r=t.getChild(i);if(r instanceof ReportItemElement&&r.model===e)return r;if(r instanceof ReportGroupItemElement){const t=r.getElementOf(e);if(t)return t}if(r instanceof ReportPageItemElement&&r.isViewOf(e))return r}}indexOfElement(e){return this._getItemsParent().indexOf(e)}getLeaves(){const e=[];return function e(t,i){for(let r=0,s=t.childCount;r<s;r++){const s=t.getChild(r);s instanceof ReportGroupItemElement?e(s,i):s instanceof ReportItemElement&&i.push(s)}}(this._getItemsParent(),e),e}getFirst(){const e=this._getItemsParent();for(let t=0,i=e.childCount;t<i;t++){const i=e.getChild(t);if(i.visible&&i instanceof ReportItemElement)return i}return this}getLast(){const e=this._getItemsParent();for(let t=e.childCount-1;t>=0;t--){const i=e.getChild(t);if(i.visible&&i instanceof ReportItemElement)return i}return this}_getPrev(e){const t=this._getItemsParent(),i=t.indexOf(e);return i>0?t.getChild(i-1):e}_getNext(e){const t=this._getItemsParent(),i=t.indexOf(e);return i<t.childCount-1?t.getChild(i+1):e}getPrev(e){return this._getPrev(e)}getNext(e){return this._getNext(e)}getLeft(e){return this._getPrev(e)}getRight(e){return this._getNext(e)}getUpper(e){return this._getPrev(e)}getLower(e){return this._getNext(e)}itemOfDom(e){if(this.isDom(e))return this.model;const t=this._getElements();if(t)for(let i of t){if(i instanceof ReportGroupItemElement){const t=i.itemOfDom(e);if(t)return t}if(i instanceof ReportItemElement&&i.containsDom(e))return i.model}}setFixedSize(e){return this.width=e,this.measureFixed=!0,this}isDom(e){return super.isDom(e)||e===this._contentBox}_initDom(e,t){if(super._initDom(e,t),this._needContentBox()){const i=this._contentBox=e.createElement("div"),r=i.style;i.className="rr-content-box",r.position="absolute",r.boxSizing="border-box",r.left="0",r.top="0",r.width="100%",r.height="100%",t.appendChild(i)}}replaceDom(e){super.replaceDom(e),this._needContentBox()&&(this._contentBox=e.getElementsByClassName("rr-content-box")[0])}refreshPrintValues(e){for(let t=0;t<this.childCount;t++){const i=this.getChild(t);i instanceof ReportItemElement&&i.refreshPrintValues(e)}}_getItemViews(){const e=this._getElements(),t=[];for(let i of e)i instanceof ReportItemElement&&t.push(i);return t}_getParentDom(){return this._contentBox||this._dom}_getItemsParent(){return this}_needContentBox(){return!0}_needDesignBox(){return!1}_applyPaddings(e,t){const i=getComputedStyle(e),r=this._padTop=Utils.toInt(i.paddingTop)+Utils.toInt(i.borderTopWidth),s=this._padBottom=Utils.toInt(i.paddingBottom)+Utils.toInt(i.borderBottomWidth),n=this._padLeft=Utils.toInt(i.paddingLeft)+Utils.toInt(i.borderLeftWidth),o=this._padRight=Utils.toInt(i.paddingRight)+Utils.toInt(i.borderRightWidth);r>0&&(t.height+=r),s>0&&(t.height+=s),n>0&&(t.width+=n),o>0&&(t.width+=o),this._borderApplied=!0}_applyBorders(e,t){if(!this._borderApplied){const i=getComputedStyle(e),r=this._padTop+=Utils.toInt(i.borderTopWidth),s=this._padBottom+=Utils.toInt(i.borderBottomWidth),n=this._padLeft+=Utils.toInt(i.borderLeftWidth),o=this._padRight+=Utils.toInt(i.borderRightWidth);r>0&&(t.height+=r),s>0&&(t.height+=s),n>0&&(t.width+=n),o>0&&(t.width+=o),this._borderApplied=!0}}_isEmpty(){return this._getItemsParent().childCount<1}_isFocused(){return this.container.focusedElement===this}_isItemFocused(e){return this.container.focusedItem===e}_isItemSelected(e){return this.container._selection.contains(e)}_getFocusedItem(){return this.container.focusedItem}_doMeasure(e,t,i,r){const s=e.printing,n=this.model,o=e.reportView,a=this._getItemsParent();(this._modelChanged||o._modelDirty||n.layoutChanged)&&(a.clear(),this._buildItems(e,o,n),this._modelChanged=!1,n.layoutChanged=!1);const A=this.measureFixed?this.width:Utils.pickNum(this._modelWidth,i),l=a.childCount;for(let t=0;t<l;t++){const i=a.getChild(t);(i.visible=!s||i.printable)&&(this.lazyLayoutChildren||i.lazyLayout||this._doMeasureItem(e,t,i,A,r))}return new Size(this.offsetWidth,this.offsetHeight)}_doPrepareMeasure(e,t){super._doPrepareMeasure(e,t),this._borderApplied=!1,this._padTop=this._padBottom=this._padLeft=this._padRight=0}_getDesignText(){return this.model.outlineLabel}_setDesignContent(e,t){e?(t.textContent=this._getDesignText(),t.style.paddingLeft=12*this.model.designLevel+"px"):t.textContent=""}_doMeasureItem(e,t,i,r,s){e.printing&&i.resetStyleName(),i.measure(e,r,s)}_createElement(e,t,i){const r=e.$_createElement(i);return this._prepareChild(r),t.addChild(r),r}_buildItems(e,t,i){const r=i&&i.items,s=this._getItemsParent();if(r&&r.length>0)for(let e of r)this._createElement(t,s,e)}_prepareChild(e){}_doLayoutContent(e){const t=e.printing,i=this._getItemsParent(),r=this._padLeft,s=this._padTop,n=i.width-r-this._padRight,o=i.height-s-this._padBottom;this._floatings&&(this._floatings=[]);for(let a=0,A=i.childCount;a<A;a++){const A=i.getChild(a);(A.visible=!t||A.printable)&&((this.lazyLayoutChildren||A.lazyLayout)&&this._doMeasureItem(e,a,A,this.width,this.height),A.resize(A.measuredWidth,A.measuredHeight),A.floating||A.draw(),A.layoutContent(e),A instanceof ReportItemElement?A.floating?(this._floatings||(this._floatings=[]),A._nodraw=!0,this._floatings.push(A)):this._layoutItem(e,A,A.model,r,s,n,o):this._layoutChild(e,A,r,s,n,o))}}layoutFloating(e){const t=this._floatings;if(t&&t.length)for(let i=0;i<t.length;i++){const r=t[i];r.visible&&(r._nodraw=!1,this._layoutFloating(e,r,r.model),r.draw())}}_layoutItem(e,t,i,r,s,n,o){}_layoutChild(e,t,i,r,s,n){}_layoutFloating(e,t,i){const r=this.findElement(i.anchorTarget);if(r instanceof ReportItemElement){const e=this.container.getDomPosition(this),s=this.container.getDomPosition(r);let n=s.x-e.x,o=s.y-e.y;switch(i.anchorPosition){case AnchorPosition.INNER_LEFT:o-=(t.height-r.height)/2;break;case AnchorPosition.LEFT:n-=t.width,o-=(t.height-r.height)/2;break;case AnchorPosition.INNER_RIGHT:n+=r.width-t.width,o-=(t.height-r.height)/2;break;case AnchorPosition.RIGHT:n+=r.width,o-=(t.height-r.height)/2;break;case AnchorPosition.INNER_TOP:n-=(t.width-r.width)/2;break;case AnchorPosition.TOP:n-=(t.width-r.width)/2,o-=t.height;break;case AnchorPosition.INNER_BOTTOM:n-=(t.width-r.width)/2,o+=r.height-t.height;break;case AnchorPosition.BOTTOM:n-=(t.width-r.width)/2,o+=r.height;break;case AnchorPosition.CENTER:default:n-=(t.width-r.width)/2,o-=(t.height-r.height)/2}return t.dom.$_anc=r.dom,t.dom.$anp=i.anchorPosition,t.move(n,o),void t.setPrintStyles()}}_doAfterLayout(e){if(!e.printing&&this._designView)if(this._needDesignBox()){const e=this._isEmpty();e?this.dom.setAttribute("data-empty","1"):this.dom.removeAttribute("data-empty"),this._setDesignContent(e,this._designView),!1===this.model.designBorder&&(this._designView.style.border="none")}else this._designView.style.display="none"}_doPrint(e,t){super._doPrint(e,t),this.layoutFloating(t)}}const BAND_ROW_BLANK="$_brb",BAND_ROW_TYPE="$_brt",BAND_ROW_INDEX="$_bri",BAND_MASTER="master",BAND_ROW="r",BAND_DUMMY="d",BAND_GROUP_HEADER="gh",BAND_GROUP_FOOTER="gf";class BandElement extends ReportGroupItemElement{getSibling(e,t){const i=this.getLines(),r=i.indexOf(e);if(t<0&&r>0||t>0&&r<i.length-1)return i[Math.max(0,Math.min(i.length-1,r+t))]}_getNext(e){const t=this.getLines(),i=t.indexOf(e);if(i<t.length-1)return t[i+1]}_getPrev(e){const t=this.getLines(),i=t.indexOf(e);if(i>0)return t[i-1]}}BandElement.END_ROW_MESSAGE_CLASS="rr-end-row-message";class PrintContext extends Base{constructor(e=!1,t=!1){super(),this._pageCount=0,this._page=0,this._detailPageCount=0,this._detailPage=0,this._compositePageCount=0,this._compositePage=0,this.noValueCallback=!1,this.headerHeight=0,this.footerHeight=0,this.reportHeaderHeight=0,this.reportFooterHeight=0,this.bodyTop=0,this.bodyBottom=0,this.bodyHeight=0,this.y=0,this.h=0,this.yBand=0,this.row=-1,this.index=-1,this.contextable=!1,this.contextValues=[],this._userData={row:0},this._tags={},this._bandSave={},this.async=!1,this.reportCount=1,this.reportIndex=0,this.prevPages=0,this._printing=e,this._compositePrinting=t}get printing(){return this._printing}get compositePrinting(){return this._compositePrinting}get dp(){return this._dp}set dp(e){this._dp=e}get designDp(){return this._desingDp}set designDp(e){this._desingDp=e}get assets(){return this._assets}set assets(e){this._assets=e}get reportView(){return this._reportView}set reportView(e){this._reportView=e}get pageWidth(){return this._pageWidth}set pageWidth(e){this._pageWidth=e}get pageHeight(){return this._pageHeight}set pageHeight(e){this._pageHeight=e}get date(){return this._date}get pageCount(){return this._pageCount}get page(){return this._page}get detailPageCount(){return this._detailPageCount}get detailPage(){return this._detailPage}get compositePageCount(){return this._compositePageCount}get compositePage(){return this._compositePage}preparePrint(e){var t;this.contextValues=[],this._date=new Date,this.report=e||(null===(t=this._reportView)||void 0===t?void 0:t.model)}preparePage(e,t){this._page=e,this._compositePage=t}setDetailPage(e,t){this._detailPageCount=e,this._detailPage=t}finishPrint(e){this._pageCount=e}setCompositePageCount(e){this._compositePageCount=e}getUserData(){return this._userData.row=this.row,this._userData}getCurrentValue(e){if("row"===e)return this.row}setTag(e,t){e&&(this._tags[e]=t)}unsetTag(e){delete this._tags[e]}getTag(e,t){const i=this._tags[e];return void 0!==i?i:t}getValue(e,t,i){if(this._dp&&e&&i){const r=this._dp.get(e);if(r)return t>=0||(t=this.row),r instanceof BandData?r.getRowValue(t,i):r.getValue(i)}}saveBand(){this._bandSave=Object.assign({},{y:this.y,h:this.h,yBand:this.yBand,row:this.row,index:this.index})}restoreBand(){Object.assign(this,this._bandSave)}}class PageBreaker{}class BandPrintInfo{setMaxCount(e,t){let i=0,r=0;for(;i<e.length&&r<t;){"number"==typeof e[i++]&&r++}for(;i<e.length&&"number"!=typeof e[i];)i++;e.length=i}isRow(e){return"number"==typeof e}isBand(e){return e instanceof BandPrintInfo}isGroupHeader(e){return"gh"===e.rowType}isGroupFooter(e){return"gf"===e.rowType}_setX(e,t){e.style.left=t+"px"}_setY(e,t){e.style.top=t+"px"}_setPos(e,t,i){e.style.left=t+"px",e.style.top=i+"px"}_createPage(e,t){const i=e.createElement("div");return i.style.position="relative",t.appendChild(i),i}}class AssetItem{constructor(e,t){this.name=e,this.data=t,t&&this._parsetData(t)}get isGroup(){return!1}save(e){return(e=e||{}).name=this.name,this._doSave(e),e}_parsetData(e){}_doSave(e){}}class ImageAsset extends AssetItem{_doSave(e){e.type="img",e.data=this.data,e.description=this.description}}class SvgAsset extends AssetItem{_doSave(e){e.type="svg",e.data=this.data,e.description=this.description}}class ColorPaletteAsset extends AssetItem{_parsetData(e){}_doSave(e){}}class ChartistThemeAsset extends AssetItem{_parsetData(e){this.theme=JSON.parse(e)}_doSave(e){e.type="charitst",e.theme=JSON.stringify(this.theme)}}class HighchartThemeAsset extends AssetItem{_parsetData(e){this.theme=JSON.parse(e)}_doSave(e){e.type="highchart",e.theme=JSON.stringify(this.theme)}}class AssetGroup extends AssetItem{constructor(e){super(e,void 0),this.items=[]}get count(){return this.items.length}get(e){for(let t of this.items)if(t.name==e)return t}save(e){for(let t of this.items)if(!(t instanceof AssetGroup)){let i={};t.save(i),Utils.isNotEmpty(i)&&e.push(i)}}indexOf(e){return this.items.indexOf(e)}get isGroup(){return!0}$_findItem(e,t=!1){let i=e.indexOf("/");i<0&&(i=e.indexOf("\\"));let r=i>=0?e.substring(0,i):e;for(let s of this.items)if(s.name==r)return!t||s instanceof AssetGroup?i>=0&&i<e.length-1&&s instanceof AssetGroup?s.$_findItem(e.substr(i+1)):s:this}}class AssetManager extends EventAware{constructor(){super(),this._nameMap={},this._root=new AssetGroup("_root_"),this._root.path="/"}_doDispose(){super._doDispose()}get root(){return this._root}load(e){for(let t in e){const i=this.forceGroup(t),r=e[t];for(let e of r)if(e.name&&e.type&&e.data){let t;switch(e.type){case"img":t=this.$_addImage(i,e.name,e.data);break;case"svg":t=this.$_addSvg(i,e.name,e.data);break;case"palette":t=this.$_addPalette(i,e.name,e.data);break;case"chartist":t=this.$_addChartist(i,e.name,e.data);break;case"highchart":t=this.$_addHighchart(i,e.name,e.data)}e.hasOwnProperty("description")&&(t.description=e.description)}}}$_collectGroups(e,t){t.push(e);for(let i of e.items)i instanceof AssetGroup&&this.$_collectGroups(i,t)}save(e){const t=[];this.$_collectGroups(this._root,t);for(let i of t){let t=[];i.save(t),e[i.path]=t||[]}}$_checkPath(e){return!e||"/"!=e.charAt(0)&&"\\"!=e.charAt(0)||(e=e.substr(1)),e}get(e){return this._nameMap[e]}getImage(e){const t=this._nameMap[e];if(t instanceof ImageAsset)return t.data}getSvg(e){const t=this._nameMap[e];if(t instanceof SvgAsset)return t.data}getPalette(e){const t=this._nameMap[e];if(t instanceof ColorPaletteAsset)return t}getChartist(e){const t=this._nameMap[e];if(t instanceof ChartistThemeAsset)return t}getHighchart(e){const t=this._nameMap[e];if(t instanceof HighchartThemeAsset)return t}findGroup(e){return this.$_findGroup(e)}forceGroup(e){let t=this._root;if(e=this.$_checkPath(e)){const i=e.split(/[\/\\]/);for(let e of i){const i=t.get(e);if(i)i instanceof AssetGroup&&(t=i);else{const i=new AssetGroup(e);i.path=t.path+(t===this._root?"":"/")+e,i.parent=t,t.items.push(i),t=i}}}return t}addGroup(e,t){const i="string"==typeof e?this.$_findGroup(e):e;return this.$_addGroup(i||this._root,t)}removeGroup(e){const t="string"==typeof e?this.$_findGroup(e):e;if(t&&t!==this._root)return this.$_removeGroup(t),!0}add(e,t){t&&this.$_addItem(e,t)}remove(e){e&&this.$_removeItem(e)}addImage(e,t,i){return this.$_addImage(e,t,i)}addSvg(e,t,i){return this.$_addSvg(e,t,i)}addPalette(e,t,i){return this.$_addPalette(e,t,i)}addCharitst(e,t,i){return this.$_addChartist(e,t,i)}addHighchart(e,t,i){return this.$_addHighchart(e,t,i)}getTree(e="Report"){const t={name:e,editable:!1,tag:this._root};return this.$_parseTree(this._root,t),t}$_parseTree(e,t){if(e.count>0){const i=[];for(let t of e.items)if(t instanceof AssetGroup){const e={name:t.name,tag:t,type:"report-asset-group"};this.$_parseTree(t,e),i.push(e)}i.length>0&&(t.children=i)}}getValidName(e){let t=e,i=1;for(;;){let r=!1;for(let s in this._nameMap)if(t===s){t=e+"-"+i++,r=!0;break}if(!r)break}return t}isValidName(e){return!this._nameMap[e]}$_findGroup(e){let t=e?this._root.$_findItem(e):this._root;return t instanceof AssetGroup?t:null}$_addGroup(e,t){const i=new AssetGroup(t);return i.parent=e,i.path=e.path+(e===this._root?"":"/")+i.name,e.items.push(i),i}$_removeGroup(e){const t=e.parent;t.items.splice(t.items.indexOf(e),1),e.parent=null}$_addItem(e,t){if(t.name in this._nameMap)throw new Error("An asset with the same name alyread exisits: "+t.name);const i=("string"==typeof e?this.$_findGroup(e):e)||this._root;i.items.push(t),t.parent=i,this._nameMap[t.name]=t}$_removeItem(e){const t=e.parent,i=t.items.indexOf(e);i>=0&&(t.items.splice(i,1),delete this._nameMap[e.name])}$_addImage(e,t,i){const r=new ImageAsset(t,i);return this.$_addItem(e,r),r}$_addSvg(e,t,i){const r=new SvgAsset(t,i);return this.$_addItem(e,r),r}$_addPalette(e,t,i){const r=new ColorPaletteAsset(t,i);return this.$_addItem(e,r),r}$_addChartist(e,t,i){const r=new ChartistThemeAsset(t,i);return this.$_addItem(e,r),r}$_addHighchart(e,t,i){const r=new HighchartThemeAsset(t,i);return this.$_addItem(e,r),r}}class StackContainer extends BoundedContainer{constructor(e){super(e),this._overflow=!1}get overflow(){return this._overflow}set overflow(e){e!==this._overflow&&(this._overflow=e,this._changed(StackContainer.PROP_OVERFLOW,e,!e))}get outlineLabel(){return"[Stack]"}getSaveType(){return"stack"}_datable(){return!0}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=Math.min(i||300,300),this.height=100}_getStyleProps(){return StackContainer.STYLE_PROPS}canAlign(e){return!0}canAdoptDragSource(e){return e instanceof ImageAsset}getMoveType(e){return ItemMoveType.INNER}}StackContainer.PROP_OVERFLOW="overflow",StackContainer.PROPINFOS=[{name:StackContainer.PROP_OVERFLOW,category:PropCategory.BOX,type:BooleanProperty,multiple:!1,default:!1}],StackContainer.$_ctor="StackContainer",StackContainer.ITEM_TYPE="Stack Container",StackContainer.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"];class PageSection extends StackContainer{constructor(e){super(e)}get removable(){return!1}get page(){return this.outlineParent}canMove(){return!1}getSaveType(){}canResize(e){return e===ResizeDirection.TOP||e===ResizeDirection.BOTTOM}_getStyleProps(){const e=super._getStyleProps();return[].concat(e)}}class SpaceableSection extends PageSection{constructor(e){super(e)}get spaceTop(){return this._spaceTop}set spaceTop(e){(e=Utils.toNumber(parseFloat(e)))!=this._spaceTop&&(this._spaceTop=e,this._changed(SpaceableSection.PROP_SPACE_TOP,e,!e))}get spaceBottom(){return this._spaceBottom}set spaceBottom(e){(e=Utils.toNumber(parseFloat(e)))!=this._spaceBottom&&(this._spaceBottom=e,this._changed(SpaceableSection.PROP_SPACE_BOTTOM,e,!e))}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,SpaceableSection.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,SpaceableSection.PROPINFOS)}_getEditProps(){return super._getEditProps().concat(SpaceableSection.PROPINFOS)}}SpaceableSection.PROP_SPACE_TOP="spaceTop",SpaceableSection.PROP_SPACE_BOTTOM="spaceBottom",SpaceableSection.PROPINFOS=[{name:SpaceableSection.PROP_SPACE_TOP,category:"Section",type:NumberProperty,multiple:!1,default:void 0},{name:SpaceableSection.PROP_SPACE_BOTTOM,category:"Section",type:NumberProperty,multiple:!1,default:void 0}];class ReportHeader extends SpaceableSection{constructor(){super("reportHeader"),this.designHeight=20}get outlineLabel(){return"Report Header"}get pathLabel(){return"reportHeader"}canResize(e){return e===ResizeDirection.BOTTOM}}ReportHeader.$_ctor="ReportHeader";class ReportFooter extends SpaceableSection{constructor(){super("reportFooter"),this._alignToBottom=!1,this.designHeight=20}get alignToBottom(){return this._alignToBottom}set alignToBottom(e){e!=this._alignToBottom&&(this._alignToBottom=e,this._changed(ReportFooter.PROP_ALIGN_TO_BOTTOM,e,!e))}get outlineLabel(){return"Report Footer"}get pathLabel(){return"reportFooter"}canResize(e){return e===ResizeDirection.TOP}_getEditProps(){return super._getEditProps().concat(ReportFooter.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,ReportFooter.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,ReportFooter.PROPINFOS)}}ReportFooter.PROP_ALIGN_TO_BOTTOM="alignToBottom",ReportFooter.PROPINFOS=[{name:ReportFooter.PROP_ALIGN_TO_BOTTOM,category:PropCategory.BOUND,type:BooleanProperty,multiple:!0,default:!1,domain:void 0}],ReportFooter.$_ctor="ReportFooter";class PageHeader extends SpaceableSection{constructor(){super("pageHeader"),this.designHeight=20}get outlineLabel(){return"Page Header"}get pathLabel(){return"pageHeader"}canResize(e){return e===ResizeDirection.BOTTOM}}PageHeader.$_ctor="PageHeader";class PageFooter extends SpaceableSection{constructor(){super("pageFooter"),this.designHeight=20}get outlineLabel(){return"Page Footer"}get pathLabel(){return"pageFooter"}canResize(e){return e===ResizeDirection.TOP}}PageFooter.$_ctor="PageFooter";class PageItemContainer extends BoundedContainer{constructor(e,t){super(e),this._label=t}get outlineLabel(){return this._label}get isArray(){return!0}canResize(e){return!1}_doLoad(e,t){this._loadItems(e,t)}_doSave(e){this._saveItems(e)}}PageItemContainer.$_ctor="PageItemContainer";class TextItemBase extends ReportItem{constructor(e){super(e),this._wrap=!1,this._multiLine=!1,this._booleanFormat="False:True",this._numberFormat="#,##0",this._dateFormat="yyyy.MM.dd"}get wrap(){return this._wrap}set wrap(e){e!=this._wrap&&(this._wrap=e,this._changed(TextItem.PROP_WRAP,e,!e))}get multiLine(){return this._multiLine}set multiLine(e){e!=this._multiLine&&(this._multiLine=e,this._changed(TextItem.PROP_MULTI_LINE,e,!e))}get booleanFormat(){return this._booleanFormat}set booleanFormat(e){if(e!=this._booleanFormat){const t=this._booleanFormat;this._booleanFormat=e,this._changed(TextItem.PROP_BOOLEAN_FORMAT,e,t)}}get numberFormat(){return this._numberFormat}set numberFormat(e){if(e!=this._numberFormat){const t=this._numberFormat;this._numberFormat=e,this._changed(TextItem.PROP_NUMBER_FORMAT,e,t)}}get dateFormat(){return this._dateFormat}set dateFormat(e){if(e!=this._dateFormat){const t=this._dateFormat;this._dateFormat=e,this._changed(TextItem.PROP_DATE_FORMAT,e,t)}}get textFormat(){return this._textFormat}set textFormat(e){if(e!=this._textFormat){const t=this._textFormat;this._textFormat=e,this._changed(TextItem.PROP_TEXT_FORMAT,e,t)}}get prefix(){return this._prefix}set prefix(e){if(e!=this._prefix){const t=this._prefix;this._prefix=e,this._changed(TextItem.PROP_TEXT_PREFIX,e,t)}}get suffix(){return this._suffix}set suffix(e){if(e!=this._suffix){const t=this._suffix;this._suffix=e,this._changed(TextItem.PROP_TEXT_SUFFIX,e,t)}}_getEditProps(){return super._getEditProps().concat(TextItemBase.PROPINFOS)}_getStyleProps(){return TextItemBase.STYLE_PROPS}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,TextItemBase.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,TextItemBase.PROPINFOS)}_doApplyStyle(e,t,i){return"verticalAlign"===e||"scale"==e&&(i[e="transform"]="scale("+t+")",!0)}canRotate(){return!0}canAdoptDragSource(e){return e instanceof ReportDataPath}adoptDragSource(e){if(e instanceof ReportDataPath)return{type:DropResultType.PROP,prop:"value",value:e.data+"::"+e.path}}canPropAdoptDragSource(e,t){return"value"===e.name&&t instanceof ReportDataPath}adoptPropDragSource(e,t){if("value"===e.name&&t instanceof ReportDataPath)return{type:DropResultType.PROP,prop:"value",value:t.data+"::"+t.path}}getPrintValue(e,t){return this.isContextValue()?e.getContextValue(this.value):super.getPrintValue(e,t)}}TextItemBase.PROP_WRAP="wrap",TextItemBase.PROP_MULTI_LINE="multiLine",TextItemBase.PROP_BOOLEAN_FORMAT="booleanFormat",TextItemBase.PROP_NUMBER_FORMAT="numberFormat",TextItemBase.PROP_DATE_FORMAT="dateFormat",TextItemBase.PROP_TEXT_FORMAT="textFormat",TextItemBase.PROP_TEXT_PREFIX="prefix",TextItemBase.PROP_TEXT_SUFFIX="suffix",TextItemBase.PROPINFOS=[{name:TextItemBase.PROP_WRAP,category:PropCategory.TEXT,type:BooleanProperty,multiple:!0,default:!1,domain:void 0},{name:TextItemBase.PROP_MULTI_LINE,category:PropCategory.TEXT,type:BooleanProperty,multiple:!0,default:!1,domain:void 0},{name:TextItemBase.PROP_BOOLEAN_FORMAT,category:PropCategory.TEXT,type:StringProperty,multiple:!0,default:"False:True"},{name:TextItemBase.PROP_NUMBER_FORMAT,category:PropCategory.TEXT,type:StringProperty,multiple:!0,default:"#,##0"},{name:TextItemBase.PROP_DATE_FORMAT,category:PropCategory.TEXT,type:StringProperty,multiple:!0,default:"yyyy.MM.dd"},{name:TextItemBase.PROP_TEXT_FORMAT,category:PropCategory.TEXT,type:StringProperty,multiple:!0,default:void 0},{name:TextItemBase.PROP_TEXT_PREFIX,category:PropCategory.TEXT,type:StringProperty,multiple:!0,default:void 0},{name:TextItemBase.PROP_TEXT_SUFFIX,category:PropCategory.TEXT,type:StringProperty,multiple:!0,default:void 0}],TextItemBase.STYLE_PROPS=["fontFamily","fontSize","fontStyle","textDecoration","fontWeight","lineHeight","color","backgroundColor","textAlign","verticalAlign","writingMode","scale","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"];class TextItem extends TextItemBase{constructor(e,t){super(e),this._contextValueCallbackDelegate=e=>this._contextValueCallbackFunc(e),t&&(this.text=t)}get text(){return this._text}set text(e){if(e!=this._text){const t=this._text;this._text=e,this._changed(TextItem.PROP_TEXT,e,t)}}get onGetContextValue(){return this._onGetContextValue}set onGetContextValue(e){if(e!==this._onGetContextValue){e?(this._contextValueCallbackFunc=new Function("ctx",e),this._contextValueCallback=this._contextValueCallbackDelegate):this._contextValueCallback===this._contextValueCallbackDelegate&&(this._contextValueCallback=null);const t=this._onGetContextValue;this._onGetContextValue=e,this._changed(TextItem.PROP_ON_GET_CONTEXT_VALUE,e,t)}}get contextValueCallback(){return this._contextValueCallback}set contextValueCallback(e){if(e!==this._contextValueCallback){const t=this._contextValueCallback;this._contextValueCallback=e,this._changed(TextItem.PROP_ON_GET_CONTEXT_VALUE,e,t)}}getSaveType(){return"text"}get outlineLabel(){const e=this.value?"["+this.value+"]":this._text;return"[Text]"+(e?" "+e:"")}get designText(){return this.value||this._text}get pathLabel(){return"text"}isContextValue(){return!!this._contextValueCallback||super.isContextValue()}_getEditProps(){return super._getEditProps().concat(TextItem.PROPINFOS)}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.text="Text"}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,TextItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,TextItem.PROPINFOS)}}TextItem.PROP_MULTI_LINE="multiLine",TextItem.PROP_TEXT="text",TextItem.PROP_ON_GET_CONTEXT_VALUE="onGetContextValue",TextItem.PROPINFOS=[{name:TextItem.PROP_TEXT,category:PropCategory.TEXT,type:StringProperty,multiple:!1,default:void 0},{name:TextItem.PROP_ON_GET_CONTEXT_VALUE,category:PropCategory.EVENT,type:FunctionProperty,multiple:!1,default:void 0,signature:"(ctx/*PrintContext*/)/*any*/"}],TextItem.$_ctor="TextItem",TextItem.ITEM_TYPE="Text";class SpaceItem extends ReportItem{constructor(e){super(e),this.size=10}get size(){return this._size}set size(e){if((e=this._validateSize(e))!=this._size){const t=this._size;this._size=e,this._sizeDim=new Dimension(e),this._changed(SpaceItem.PROP_SIZE,e,t)}}getSize(e){return this._sizeDim.getPixel(e)}getSaveType(){return"space"}get outlineLabel(){return"[Space] "+this.size}_sizable(){return!1}_boundable(){return!1}_getEditProps(){return super._getEditProps().concat(SpaceItem.PROPINFOS)}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.size=10}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,SpaceItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,SpaceItem.PROPINFOS)}canAddTo(e){return e instanceof BoxContainer}}var BoxItemsAlign;SpaceItem.PROP_SIZE="size",SpaceItem.PROPINFOS=[{name:SpaceItem.PROP_SIZE,category:PropCategory.BOUND,type:DimensionProperty,multiple:!1,default:void 0}],SpaceItem.$_ctor="SpaceItem",SpaceItem.ITEM_TYPE="Space",function(e){e.START="start",e.MIDDLE="middle",e.END="end"}(BoxItemsAlign||(BoxItemsAlign={}));class BoxContainer extends ReportGroupItem{constructor(e){super(e),this._overflow=!1,this.itemGap=4}get itemsAlign(){return this._itemsAlign}set itemsAlign(e){if(e!==this._itemsAlign){const t=this._itemsAlign;this._itemsAlign=e,this._changed(BoxContainer.PROP_ITEMS_ALIGN,e,t)}}get itemGap(){return this._itemGap}set itemGap(e){if(Utils.isNotDefined(e)&&(e=0),e!=this._itemGap){const t=this._itemGap;this._itemGap=e,this._itemGapDim=Utils.isNotDefined(e)?null:new Dimension(e),this._changed(BoxContainer.PROP_ITEM_GAP,e,t)}}get overflow(){return this._overflow}set overflow(e){e!==this._overflow&&(this._overflow=e,this._changed(BoxContainer.PROP_OVERFLOW,e,!e))}getItemGap(e){return this._itemGapDim?this._itemGapDim.getPixel(e):0}loadProps(e){this._loadPropsOf(e,BoxContainer.PROPINFOS)}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(BoxContainer.PROPINFOS)}_getStyleProps(){return BoxContainer.STYLE_PROPS}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,BoxContainer.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,BoxContainer.PROPINFOS)}canAlign(e){return!0}canAdoptDragSource(e){return e instanceof ImageAsset}}BoxContainer.PROP_ITEMS_ALIGN="itemsAlign",BoxContainer.PROP_ITEM_GAP="itemGap",BoxContainer.PROP_OVERFLOW="overflow",BoxContainer.PROPINFOS=[{name:BoxContainer.PROP_ITEMS_ALIGN,category:PropCategory.BOX,type:EnumProperty,multiple:!1,default:void 0,domain:BoxItemsAlign},{name:BoxContainer.PROP_ITEM_GAP,category:PropCategory.BOX,type:DimensionProperty,multiple:!1,default:void 0},{name:BoxContainer.PROP_OVERFLOW,category:PropCategory.BOX,type:BooleanProperty,multiple:!1,default:!1}],BoxContainer.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"];class RowBoxContainer extends BoxContainer{constructor(e){super(e),this._child_top=NaN,this._child_bottom=NaN,this.designHeight=50,this.designWidth=300}getTopOf(e){return e.getChildProp(ReportItem.PROP_TOP,this._child_top)}setTopOf(e,t){e.setChildProp(ReportItem.PROP_TOP,t)}getBottomOf(e){return e.getChildProp(ReportItem.PROP_BOTTOM,this._child_bottom)}setBottomOf(e,t){e.setChildProp(ReportItem.PROP_BOTTOM,t)}getSaveType(){return"rbox"}get outlineLabel(){return"[Row Box]"}_getChildPropInfos(e){return e._boundable()?RowBoxContainer.CHILD_PROPS:null}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=Math.min(i||300,300),this.height=50}_doLoadChild(e,t){super._doLoadChild(e,t),this._loadChildPropsOf(e,t,RowBoxContainer.CHILD_PROPS)}canAlignTo(e,t){return"top"===t||"bottom"===t}canResizeChild(e,t){return e instanceof SpaceItem?t===ResizeDirection.RIGHT:ResizeDirection.isIn(t,ResizeDirection.RIGHT,ResizeDirection.TOP,ResizeDirection.BOTTOM,ResizeDirection.TOP_RIGHT,ResizeDirection.BOTTOM_RIGHT)}}RowBoxContainer.CHILD_PROPS=[{name:ReportItem.PROP_TOP,category:PropCategory.BOUND,type:DimensionProperty,multiple:!0,default:void 0,domain:void 0},{name:ReportItem.PROP_BOTTOM,category:PropCategory.BOUND,type:DimensionProperty,multiple:!0,default:void 0,domain:void 0}],RowBoxContainer.$_ctor="RowBoxContainer",RowBoxContainer.ITEM_TYPE="Row Box";class ColumnBoxContainer extends BoxContainer{constructor(e){super(e),this._child_left=NaN,this._child_right=NaN,this.designWidth=100,this.designHeight=100}getLeftOf(e){return e.getChildProp(ReportItem.PROP_LEFT,this._child_left)}setLeftOf(e,t){e.setChildProp(ReportItem.PROP_LEFT,t)}getRightOf(e){return e.getChildProp(ReportItem.PROP_RIGHT,this._child_right)}setRightOf(e,t){e.setChildProp(ReportItem.PROP_RIGHT,t)}getSaveType(){return"cbox"}get outlineLabel(){return"[Column Box]"}get pathLabel(){return"cbox"}_getChildPropInfos(e){return e._boundable()?ColumnBoxContainer.CHILD_PROPS:null}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=Math.min(i||100,100),this.height=100}_doLoadChild(e,t){super._doLoadChild(e,t),this._loadChildPropsOf(e,t,ColumnBoxContainer.CHILD_PROPS)}canAlignTo(e,t){return"left"===t||"right"===t}canResizeChild(e,t){return e instanceof SpaceItem?t===ResizeDirection.BOTTOM:ResizeDirection.isIn(t,ResizeDirection.BOTTOM,ResizeDirection.LEFT,ResizeDirection.RIGHT,ResizeDirection.BOTTOM_LEFT,ResizeDirection.BOTTOM_RIGHT)}}ColumnBoxContainer.CHILD_PROPS=[{name:ReportItem.PROP_LEFT,category:PropCategory.BOUND,type:DimensionProperty,multiple:!0,default:void 0,domain:void 0},{name:ReportItem.PROP_RIGHT,category:PropCategory.BOUND,type:DimensionProperty,multiple:!0,default:void 0,domain:void 0}],ColumnBoxContainer.$_ctor="ColumnBoxContainer",ColumnBoxContainer.ITEM_TYPE="Column Box";class DiagonalBoxContainer extends ReportGroupItem{constructor(e){super(e),this._reversed=!1,this._lineStyles={},this.designWidth=60,this.designHeight=60}getSubStyleProps(e){if(e===DiagonalBoxContainer.PROP_LINE_STYLES){const t=[];for(let i of DiagonalBoxContainer.LINE_STYLE_PROPS){const r={...STYLE_PROPS[i]};r.parent=e,t.push(r)}return t}return super.getSubStyleProps(e)}_getSubStyle(e,t){return e===DiagonalBoxContainer.PROP_LINE_STYLES?this._lineStyles[t]:super._getSubStyle(e,t)}_setSubStyle(e,t,i){if(e===DiagonalBoxContainer.PROP_LINE_STYLES){const r=this._lineStyles[t];this._lineStyles[t]=i,this._changed(e,i,r)}else super._setSubStyle(e,t,i)}get reversed(){return this._reversed}set reversed(e){e!==this._reversed&&(this._reversed=e,this._changed(DiagonalBoxContainer.PROP_REVERSED,e,!e))}get lineStyles(){return this._lineStyles}set lineStyles(e){const t=this._lineStyles={};if(e){const i=DiagonalBoxContainer.LINE_STYLE_PROPS;for(let r of i)r in e&&(t[r]=e[r])}}get firstItem(){return this._firstItem}get secondItem(){return this._secondItem}getSaveType(){return"dbox"}get outlineLabel(){return"[Diagonal Box]"}_getEditProps(){return super._getEditProps().concat(DiagonalBoxContainer.PROPINFOS)}_datable(){return!0}_getStyleProps(){return DiagonalBoxContainer.STYLE_PROPS}_maxChildCount(){return 2}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=60,this.height=45,this.add(new TextItem(null,"Text1")),this.add(new TextItem(null,"Text2"))}_doLoad(e,t){this._firstItem=this._secondItem=null,super._doLoad(e,t),this._loadPropsOf(t,DiagonalBoxContainer.PROPINFOS);const i=t.dpos;if(!isNaN(i))switch(i){case 1:this._firstItem=this.get(0),this._secondItem=null;break;case 2:this._firstItem=null,this._secondItem=this.get(0);break;case 3:this._firstItem=this.get(0),this._secondItem=this.get(1)}}_doSave(e){super._doSave(e),this._savePropsOf(e,DiagonalBoxContainer.PROPINFOS);let t=0;this._firstItem&&(t+=1),this._secondItem&&(t+=2),e.dpos=t}_doItemAdded(e,t){super._doItemAdded(e,t),this._firstItem?this._secondItem||(this._secondItem=e):this._firstItem=e}_doItemRemoved(e,t){super._doItemRemoved(e,t),e===this._firstItem?this._firstItem=null:e===this._secondItem&&(this._secondItem=null)}canAlign(e){return!0}}DiagonalBoxContainer.PROP_REVERSED="reversed",DiagonalBoxContainer.PROP_LINE_STYLES="lineStyles",DiagonalBoxContainer.PROPINFOS=[{name:DiagonalBoxContainer.PROP_REVERSED,category:PropCategory.BOX,type:BooleanProperty,multiple:!0,default:!1},{name:DiagonalBoxContainer.PROP_LINE_STYLES,category:PropCategory.BASIC,type:StylesProperty,multiple:!1,default:void 0}],DiagonalBoxContainer.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"],DiagonalBoxContainer.LINE_STYLE_PROPS=["borderTop"],DiagonalBoxContainer.$_ctor="DiagonalBoxContainer",DiagonalBoxContainer.ITEM_TYPE="Diagonal Box";class EditCommandError extends Error{constructor(e){super(e)}}class EditCommandFailed extends EditCommandError{}class EditCommand extends Base{constructor(e){super(),this._id=-1,this._time=new Date,this._name=e}_doDispose(){}get name(){return this._name}get id(){return this._id}get time(){return this._time}get displayLabel(){return this._name}get description(){return this._name}run(){return this.redo(!1)}}class EditCommandGroup extends EditCommand{constructor(e,t){super(e),assert(t&&t.length>0),this._commands=t.slice()}_doDispose(){for(let e of this._commands)e.dispose();this._commands=null,super._doDispose()}get commands(){return this._commands.slice()}undo(){for(let e=0;e<this._commands.length;e++)this._commands[e].undo()}redo(e){for(let t=this._commands.length-1;t>=0;t--)this._commands[t].redo(e)}get source(){return this._commands[0].source}}class EditCommandStack extends EventAware{constructor(e){super(),this._commands=[],this._current=-1,this._closed=-1,this._undoing=!1,this._redoing=!1,this._owner=e}_doDispose(){this._owner=null,this._commands=null,super._doDispose()}get owner(){return this._owner}get length(){return this._commands.length}get current(){return this._current}get empty(){return 0===this._commands.length}get canUndo(){return this._current>=0}get canRedo(){return this._commands.length>this._current+1}get undoing(){return this._undoing}get redoing(){return this._redoing}get dirty(){return this._closed!==this._current}get(e){return this._commands[e]}undo(){if(this.canUndo){const e=this._commands[this._current];this._undoing=!0;try{e.undo()}finally{this._undoing=!1}const t=this._current;return this._current=this._current-1,this._changed(t,e),!0}}redo(e=!0){if(this.canRedo){const e=this._current+1,t=this._commands[e];this._redoing=!0;try{t.redo(!0)}finally{this._redoing=!1}const i=this._current;return this._current=e,this._changed(i,t),!0}}execute(e){if(e)try{e.run();const t=this._current;return this._current++,this._commands[this._current]=e,e._id=this._current,this.$_shrink(this._current+1),this._changed(t,e),!0}catch(e){if(!(e instanceof EditCommandFailed))throw e}}flush(){let e=this._commands.length;if(e>0){for(;e--;)this._commands[e].dispose();this._commands=[];const t=this._current;this._current=-1,this._changed(t,null)}}close(){this._closed=this._current}getHistory(e=!1){return this._commands.slice(0,e?void 0:this._current+1)}_changed(e,t){const i=this._owner;i&&i.editCommandStackChanged(this,t,this.canUndo,this.canRedo),(this._current<0||e<0)&&i&&i.editCommandStackDirtyChanged(this)}$_shrink(e){const t=this._commands;if(e>=0&&e<t.length){for(let i=t.length-1;i>=e;i--)t[i].dispose();t.splice(e,t.length-e)}}}class Messages{}Messages.E_TABLE_MOVE_MERGE_CELLS="병합된 셀의 일부를 이동할 수 없습니다.",Messages.E_TABLE_MOVE_TARGET_MERGE_CELLS="병합된 셀의 중간으로 이동할 수 없습니다.";class TableCellItem extends CellGroup{constructor(e){super(e,null)}get table(){return this.parent}get col(){const e=this.item.getChildProp(TableBase.PROP_TABLE_COL);return isNaN(e)?0:e}get row(){const e=this.item.getChildProp(TableBase.PROP_TABLE_ROW);return isNaN(e)?0:e}canChangeChildProp(e,t,i){return this.parent.canChangeChildProp(e,t,i)}}class TableRow extends ReportItemCollectionItem{constructor(e,t){super(e,t),this._index=-1}getEditProps(){return TableRow.PROPINFOS}getCollectionLabel(){return"tableRow"}get table(){return this.collection.table}get index(){return this._index}get height(){return this._height}set height(e){if("string"==typeof e&&(e=e.trim()),e!=this._height){const t=this._height;this._height=e,this._heightDim=new Dimension(e),this._changed(TableRow.PROP_HEIGHT,e,t)}}getHeight(e){return this._heightDim?this._heightDim.getPixel(e):NaN}get itemType(){return"Row"}get page(){var e;return null===(e=this.collection)||void 0===e?void 0:e.table.page}get displayPath(){return this.collection?this.collection.table.displayPath+".rows["+this.index+"]":"row"}get collection(){return super.collection}get marqueeParent(){var e;return null===(e=this.collection)||void 0===e?void 0:e.marqueeParent}isAncestor(e){return e===this.collection.table}canRemoveFrom(){return this.collection&&this.collection.count>1}canSelectedWith(e){return e instanceof TableRow&&e.table===this.table}_getStyleProps(){return TableRow.styleProps}_doLoad(e){"string"==typeof e||"number"==typeof e?this.height=e:e&&this._loadPropsOf(e,TableRow.PROPINFOS),super._doLoad(e)}_doSave(e){return this._savePropsOf(e,TableRow.PROPINFOS),super._doSave(e),e}}TableRow.PROP_HEIGHT="height",TableRow.styleProps=["backgroundColor"],TableRow.PROPINFOS=[{name:TableRow.PROP_HEIGHT,category:PropCategory.ROW,type:DimensionProperty,multiple:!1,default:void 0}];class TableRowCollection extends ReportItemCollection{constructor(e){super(),this._rows=[],this._table=e}get outlineParent(){return this._table}get outlineLabel(){return"[Rows]"}get outlineExpandable(){return!0}get outlineItems(){return this._rows.forEach(((e,t)=>e.outlineOrder=t)),this._rows}getSaveType(){return"rows"}get owner(){return this._table}get table(){return this._table}get count(){return this._rows.length}set count(e){const t=this._rows.length;if((e=Math.max(0,Utils.toNumber(e)))!==t)try{if(e>t){for(let t=this._rows.length;t<e;t++)this._rows.push(new TableRow(this,null));this._itemsAdded(this._rows.slice(t,e))}else{const i=this._rows.slice(e,t);this._rows.length=e,this._itemsRemoved(i)}}finally{this.$_invalidateRows()}}get items(){return this._rows.slice(0)}load(e,t){if(this._heights=null,this._rows=[],e&&e.length>0)for(let i of e){const e=new TableRow(this,i);if(this._rows.push(e),t>0&&this._rows.length===t)break}if(t>0)for(;this._rows.length<t;)this._rows.push(new TableRow(this,null));return this.$_invalidateRows(),this._rows.length}save(e){this._rows.forEach((t=>e.push(t.save({}))))}get(e){return e>=0&&e<this._rows.length?this._rows[e]:null}getRange(e,t){return t>=e?this._rows.slice(e,t+1):this._rows.slice(t,e+1)}indexOf(e){return this._rows.indexOf(e)}getHeights(){if(this._heights)this._rows.forEach(((e,t)=>{this._heights.set(t,this._rows[t]._heightDim)}));else{const e=[];this._rows.forEach((t=>{e.push(t._heightDim)})),this._heights=new DimensionCollection(null),this._heights.$_init(e)}return this._heights}add(e,t=-1){t=t<0?this._rows.length:t;const i=this.$_add(e,t);if(i)return this.$_invalidateRows(),this._itemAdded(i),i}remove(e){if(e>=0&&e<this._rows.length){const t=this._rows.splice(e,1)[0];return this.$_invalidateRows(),this._itemRemoved(t,this._table),!0}}move(e,t,i){this._rows.splice(e,t).forEach(((e,t)=>this._rows.splice(i+t,0,e))),this.$_invalidateRows()}adjustHeights(e,t,i){const r=t[e+1]-t[e],s=t[e+2]-t[e+1],n=(i-r)/(r+s),o=this._rows[e]._heightDim||new Dimension(r),a=this._rows[e+1]._heightDim||new Dimension(s),A=o.value,l=a.value,h=[];if(o.fixed&&a.fixed){let e=o.getFixedPixel(),t=a.getFixedPixel();const i=e+t;e=Math.round(e+n*i),t=i-e,e=getUnitsByPixels(o.unit,e),t=getUnitsByPixels(a.unit,t),h.push(e+o.unit,t+a.unit)}else if(o.fixed||a.fixed){const e=t[this._rows.length];let i=o.getPixel(e),r=a.getPixel(e);const s=i+r,A=o.fixed?o.unit:a.unit;i=Math.round(i+n*s),r=s-i,i=getUnitsByPixels(A,i),r=getUnitsByPixels(A,r),h.push(i+A,r+A)}else{const e=A+l,t=+(A+n*e).toFixed(1),i=+(e-t).toFixed(1);h.push(t+"%",i+"%")}return h}get page(){var e;return null===(e=this._table)||void 0===e?void 0:e.page}get displayPath(){return this._table?this._table.displayPath+".rows":"rows"}get level(){return this._table?this._table.level+1:0}get marqueeParent(){return this._table}isAncestor(e){return e===this._table}_doMoveItem(e,t){return!1}$_add(e,t){if(e instanceof TableRow||(e=new TableRow(this,e)),e instanceof TableRow&&this._rows.indexOf(e)<0)return this._rows.splice(Math.min(t,this._rows.length),0,e),e}$_invalidateRows(){this._rows.forEach(((e,t)=>{e._parent=this,e._index=t})),this._heights=null,this.$_rowChanged(null)}$_rowChanged(e){this._table&&this._table.$_rowChanged(e)}}class TableCell extends ReportItemCollectionItem{constructor(e,t,i,r){super(e,r),this._applyEndStyles=!1,this._row=-1,this._col=-1,this._styleCallbackDelegate=(e,t,i)=>this._styleCallbackFunc(e,t,i),this._row=t,this._col=i}get outlineLabel(){const e=this.table.getCell(this._row,this._col),t=["[",this._row,",",this._col,"] Cell"];if(e){const i=e.rowspan,r=e.colspan;i>1&&t.push(" (",i+" rows)"),r>1&&t.push(" (",r+" cols)")}return t.join("")}getEditProps(){return TableCell.PROPINFOS}get table(){return this.collection.table}get row(){return this._row}get col(){return this._col}get height(){return this._rowspan||1}get width(){return this._colspan||1}get bottom(){return this._row+(isNaN(this._rowspan)?0:this._rowspan-1)}get right(){return this._col+(isNaN(this._colspan)?0:this._colspan-1)}get isSingle(){return 1===this.width&&1===this.height}get colspan(){return this._colspan}set colspan(e){var t;if(e<=1&&(e=void 0),e!==this._colspan){const i=this._colspan;this._colspan=e,this._changed(TableCell.PROP_COLSPAN,e,i),null===(t=this.table)||void 0===t||t._spanChanged(this)}}get rowspan(){return this._rowspan}set rowspan(e){var t;if(e<=1&&(e=void 0),e!==this._rowspan){const i=this._rowspan;this._rowspan=e,this._changed(TableCell.PROP_ROWSPAN,e,i),null===(t=this.table)||void 0===t||t._spanChanged(this)}}get applyEndStyles(){return this._applyEndStyles}set applyEndStyles(e){e!==this._applyEndStyles&&(this._applyEndStyles=e,this._changed(TableCell.PROP_APPLY_END_STYLES,e,!e))}get styleCallback(){return this._styleCallback}set styleCallback(e){if(e!==this._styleCallback){const t=this._styleCallback;this._styleCallback=e,this._changed(TableCell.PROP_STYLE_CALLBACK,e,t)}}get onGetStyles(){return this._onGetStyles}set onGetStyles(e){if(e!==this._onGetStyles){e?(this._styleCallbackFunc=new Function("ctx, cell, row, value",e),this._styleCallback=this._styleCallbackDelegate):this._styleCallback===this._styleCallbackDelegate&&(this._styleCallback=null);const t=this._onGetStyles;this._onGetStyles=e,this._changed(ReportItem.PROP_ON_GET_STYLES,e,t)}}adoptDragSource(e){}get itemType(){return"cell"}get collection(){return super.collection}get page(){var e;return null===(e=this.collection)||void 0===e?void 0:e.table.page}get displayPath(){return this.collection?this.collection.table.displayPath+".cells["+this._row+", "+this._col+"]":"cell"}get marqueeParent(){return this.table}_getStyleProps(){return TableCell.styleProps}setProps(e){super.setProps(e),e.hasOwnProperty("row")&&(this._row=e.row),e.hasOwnProperty("col")&&(this._col=e.col)}canSelectedWith(e){return e instanceof TableCell||e instanceof TableSelection}_doLoad(e){this._loadPropsOf(e,TableCell.PROPINFOS),this._loadProps(e,"styleCallback"),super._doLoad(e)}_doSave(e){e.r=this._row,e.c=this._col,this._savePropsOf(e,TableCell.PROPINFOS),delete e.col,delete e.row,e.colspan<=1&&delete e.colspan,e.rowspan<=1&&delete e.rowspan,this._saveProp(e,"styleCallback"),super._doSave(e)}}TableCell.PROP_COL="col",TableCell.PROP_ROW="row",TableCell.PROP_COLSPAN="colspan",TableCell.PROP_ROWSPAN="rowspan",TableCell.PROP_APPLY_END_STYLES="applyEndStyles",TableCell.PROP_ON_GET_STYLES="onGetStyles",TableCell.PROP_STYLE_CALLBACK="styleCallback",TableCell.PROPINFOS=[{name:TableCell.PROP_ROW,category:PropCategory.CELL,type:NumberProperty,multiple:!1,default:void 0,readonly:!0},{name:TableCell.PROP_COL,category:PropCategory.CELL,type:NumberProperty,multiple:!1,default:void 0,readonly:!0},{name:TableCell.PROP_ROWSPAN,category:PropCategory.CELL,type:NumberProperty,multiple:!1,default:void 0},{name:TableCell.PROP_COLSPAN,category:PropCategory.CELL,type:NumberProperty,multiple:!1,default:void 0},{name:TableCell.PROP_APPLY_END_STYLES,category:PropCategory.CELL,type:BooleanProperty,multiple:!1,default:!1},{name:ReportItem.PROP_ON_GET_STYLES,category:PropCategory.EVENT,type:FunctionProperty,multiple:!1,default:void 0,signature:"(ctx/* PrintContext*/, cell/*TableCell*/, row/*Number*/)/*any*/"}],TableCell.styleProps=["cellAlign","backgroundColor","paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeft","borderRight","borderTop","borderBottom"];class TableSelection{constructor(e,t,i){this.cols=1,this.rows=1,this.selectItem=this._cell=e,this.cols=t,this.rows=i}get table(){return this.selectItem.table}get cell(){return this._cell}get col(){return this._cell.col}get row(){return this._cell.row}get right(){return this._cell.col+this.cols-1}get bottom(){return this._cell.row+this.rows-1}canSelectedWith(e){return e instanceof TableCell||e instanceof TableSelection}contains(e,t){return e>=this.row&&e<=this.bottom&&t>=this.col&&t<=this.right}containsCell(e){return e.table===this.table&&this.contains(e.row,e.col)}isSingle(e){const t=this._cell,i=t.table,r=t.row,s=t.col;if(this.rows>1||this.cols>1){if(e){let e=0;for(let t=0;t<this.rows;t++)for(let n=0;n<this.cols;n++)if(!i.isHiddenAt(r+t,s+n)&&(e++,e>1))return!1;return!0}return!1}return!0}getCells(e){const t=this._cell,i=t.table,r=t.row,s=t.col,n=[];for(let t=0;t<this.rows;t++)for(let o=0;o<this.cols;o++){const a=i.getCell(r+t,s+o);e&&i.isHiddenAt(r+t,s+o)||n.push(a)}return n}resizeTo(e){if(e){const t=this._cell.table,i=this.rows,r=this.cols,s=t.cells.getRectangle(this.selectItem,e);return this._cell=t.getCell(s.y,s.x),this.rows=s.height,this.cols=s.width,i!==this.rows||r!==this.cols}}resizeBy(e,t){const i=this.selectItem.table;let r=this.selectItem.col,s=this.selectItem.row,n=this._cell.col,o=this._cell.row;if(r===n?n=this.right+e:n+=e,s===o?o=this.bottom+t:o+=t,e>0){const e=n;for(let t=Math.min(s,o);t<=Math.max(s,o);t++){const r=i.getCell(t,n);r&&i.isHiddenCell(r)&&(n=Math.max(e,e+i.getHeadCell(r).width-1))}}if(t>0){const e=o;for(let t=Math.min(r,n);t<=Math.max(r,n);t++){const r=i.getCell(o,t);r&&i.isHiddenCell(r)&&(o=Math.max(e,e+i.getHeadCell(r).height-1))}}return n=Math.max(0,Math.min(i.colCount,n)),o=Math.max(0,Math.min(i.rowCount,o)),this.resizeTo(i.getCell(o,n))}equals(e){return this._cell===e&&this.rows===e.height&&this.cols===e.width}}class TableCellCollection extends ReportItemCollection{constructor(e){super(),this._cells=[],this._table=e}get outlineParent(){return this._table}get outlineLabel(){return"[Cells]"}get outlineExpandable(){return!0}get outlineItems(){return this._vcells}getSaveType(){return"cells"}isCollectionProp(){return!1}get owner(){return this._table}get table(){return this._table}get count(){return this._vcells.length}get items(){return this._vcells}get rowCount(){return this._cells.length}get colCount(){return this._cells[0].length}getColCount(e){return this._cells[e].length}get(e){return e>=0&&e<this._vcells.length?this._vcells[e]:null}getAt(e,t){if(e>=0&&e<this._cells.length)return this._cells[e][t]}indexOf(e){return this._vcells.indexOf(e)}getRectangle(e,t){const i=this.table,r=Math.min(i.getTopRow(e),i.getTopRow(t)),s=Math.max(e.bottom,t.bottom),n=Math.min(i.getLeftCol(e),i.getLeftCol(t)),o=Math.max(e.right,t.right);return Rectangle.create(n,r,o-n+1,s-r+1)}getRectangleCells(e,t,i=!0){const r=this.table,s=this.getRectangle(e,t),n=[];for(let e=s.y;e<s.y+s.height;e++)for(let t=s.x;t<s.x+s.width;t++)i&&r.isHiddenAt(e,t)||n.push(this._cells[e][t]);return n}prepareCells(){const e=this._table,t=this._cells,i=e.rowCount,r=e.colCount;for(;t.length<i;)t.push([]);for(let e=0;e<i;e++){const i=t[e];for(;i.length<r;)i.push(this._createCell(e,i.length))}}load(e){var t;if(this.prepareCells(),e&&e.length>0){const i=this._cells;for(let r of e){const e=r.r,s=r.c,n=null===(t=i[e])||void 0===t?void 0:t[s];null==n||n.load(r)}}}save(e){this._cells.forEach((t=>{t.forEach((t=>{const i=t.save({});let r=!1;for(let e in i)if("r"!==e&&"c"!==e){r=!0;break}r&&e.push(i)}))}))}resetVisibles(){const e=this._table,t=this._cells,i=e.rowCount,r=e.colCount,s=this._vcells,n=this._vcells=[];for(let s=0;s<i;s++)for(let i=0;i<r;i++)e.isHiddenAt(s,i)||n.push(t[s][i]);s&&!Utils.equalArrays(s,n)&&(s&&this._itemsRemoved(s),this._itemsAdded(n))}saveCells(){const e=this._cells,t=e.length,i=[];for(let r=0;r<t;r++){const t=[];for(let i=0,s=e[r].length;i<s;i++){const s=e[r][i];t.push({props:s.getProps(),styles:s.styles})}i.push(t)}return i}restoreCells(e){const t=e.length,i=this._cells;for(let r=0;r<t;r++)for(let t=0,s=e[r].length;t<s;t++){const s=i[r][t],n=e[r][t];s.setProps(n.props),s.styles=n.styles}}truncateRow(e){const t=this._cells,i=this.saveCells();for(let i=0;i<e;i++)for(let r=0,s=t[i].length;r<s;r++){const s=t[i][r];i+s.rowspan>e&&(s.rowspan=e-i)}return i}truncateCol(e){const t=this._cells,i=this.saveCells();for(let i=0;i<t.length;i++)for(let r=0;r<e;r++){const s=t[i][r];r+s.colspan>e&&(s.colspan=e-r)}return i}removeRow(e){const t=this._cells,i=this.saveCells();t.splice(e,1);for(let t=e;t<this._cells.length;t++)this._cells[t].forEach((e=>{e._row=e.row-1}));for(let i=0;i<e;i++)for(let r=0,s=t[i].length;r<s;r++){const s=t[i][r];i+s.rowspan>e&&s.rowspan--}return i}removeRows(e,t){const i=this._cells,r=this.saveCells();i.splice(e,t);for(let r=0;r<e;r++)for(let s=0,n=i[r].length;s<n;s++){const n=i[r][s],o=n.rowspan;r+o>e+t?n.rowspan=Math.max(1,o-t):r+o>e&&(n.rowspan=Math.max(1,r-e))}return r}addRow(e){const t=this.saveCells(),i=[],r=this._cells.length>0?this._cells[0].length:this.table.colCount;for(let t=0;t<r;t++)i.push(this._createCell(e,t));this._cells.splice(e,0,i);for(let t=e+1;t<this._cells.length;t++)this._cells[t].forEach((e=>{e._row=e.row+1}));for(let t=0;t<e;t++)this._cells[t].forEach((i=>{t+i.rowspan>e&&i.rowspan++}));return t}removeCol(e){const t=this._cells,i=t.length,r=this.saveCells();for(let r=0;r<i;r++)t[r].splice(e,1);for(let r=0;r<i;r++)for(let i=e;i<t[r].length;i++)t[r][i]._col=t[r][i].col-1;for(let r=0;r<i;r++)for(let i=0,s=t[r].length;i<s;i++){const s=t[r][i];i+s.colspan>e&&s.colspan--}return r}removeCols(e,t){}addCol(e){const t=this.saveCells(),i=this._cells,r=i.length;for(let t=0;t<r;t++)i[t].splice(e,0,this._createCell(t,e));for(let t=0;t<i.length;t++)for(let r=e+1;r<i[t].length;r++)i[t][r]._col=i[t][r].col+1;for(let t=0;t<r;t++)for(let r=0;r<e;r++)r+i[t][r].colspan>e&&i[t][r].colspan++;return t}$_resetPositions(){const e=this._cells;for(let t=0;t<e.length;t++){const i=e[t];for(let e=0;e<i.length;e++)i[e]._row=t,i[e]._col=e}}moveRows(e,t,i){const r=this.saveCells(),s=this._cells,n=this._table.rowCount;if(i!==e&&t>=1&&e>=0&&e+t<=n&&i>=0&&i<n){return s.splice(e,t).forEach(((e,t)=>s.splice(i+t,0,e))),this.$_resetPositions(),r}}moveCols(e,t,i){const r=this.saveCells(),s=this._table.rowCount,n=this._table.colCount;if(i!==e&&t>=1&&e>=0&&e+t<=n&&i>=0&&i<n){for(let r=0;r<s;r++){const s=this._cells[r];s.splice(e,t).forEach(((e,t)=>s.splice(i+t,0,e)))}return this.$_resetPositions(),r}}getMergeBounds(e,t,i,r){const s=this._cells;let n=t,o=r;for(let a=e;a<=i;a++){for(let e=t-1;e>=0;e--){if(s[a][e].colspan>t-e){n=Math.min(n,e);break}}for(let e=t;e<=r;e++){const t=s[a][e].colspan;if(e+t-1>r){o=Math.max(o,e+t-1);break}}}let a=e,A=i;for(let n=t;n<=r;n++){for(let t=e-1;t>=0;t--){if(s[t][n].rowspan>e-t){a=Math.min(a,t);break}}for(let t=e;t<=i;t++){const e=s[t][n].rowspan;if(t+e-1>i){A=Math.max(A,t+e-1);break}}}return{r1:a,c1:n,r2:A,c2:o}}mergeBoundsOf(e){return this.getMergeBounds(e.row,e.col,e.bottom,e.right)}merge(e,t,i,r){const s=this._cells,n=this.saveCells();for(let n=e;n<=i;n++)for(let e=t;e<=r;e++)s[n][e].rowspan=s[n][e].colspan=void 0;return s[e][t].rowspan=i-e+1,s[e][t].colspan=r-t+1,n}mergeSelection(e){return this.merge(e.row,e.col,e.bottom,e.right)}unmerge(e){const t=this.saveCells();return e.rowspan=e.colspan=void 0,t}get page(){var e;return null===(e=this._table)||void 0===e?void 0:e.page}get displayPath(){return this._table?this._table.displayPath+".cells":"cells"}get level(){return this._table?this._table.level+1:0}get marqueeParent(){return this._table}isAncestor(e){return e===this._table}_doMoveItem(e,t){return!1}_createCell(e,t){return new TableCell(this,e,t)}}class TableBase extends CellContainer{constructor(e){super(e),this._fixed=!1,this._cellStyles={},this._cellMap=[],this._spans=[],this._spanDirty=!0,this._itemDirty=!1,this._rows=this._createRows(),this._cells=this._createCells(),this._resetCells()}_createCells(){return new TableCellCollection(this)}getSubStyleProps(e){if(e===TableBase.PROP_TABLE_CELL_STYLES){const t=[];for(let i of TableBase.CELL_STYLES){const r={...STYLE_PROPS[i]};r.parent=e,t.push(r)}return t}return super.getSubStyleProps(e)}_getSubStyle(e,t){return e===TableBase.PROP_TABLE_CELL_STYLES?this._cellStyles[t]:super._getSubStyle(e,t)}_setSubStyle(e,t,i){if(e===TableBase.PROP_TABLE_CELL_STYLES){const r=this._cellStyles[t];this._cellStyles[t]=i,this._changed(e,i,r)}else super._setSubStyle(e,t,i)}get outlineItems(){return[this._rows,this._cells].concat(super.outlineItems)}get rowCount(){return this._rowCount||0}set rowCount(e){if((e=Math.max(1,Utils.toNumber(e)))!==this._rowCount){const t=this._rowCount;this._rowCount=e,this._rows.count=e,e<t?this._removeRows(e,t-e):this._resetCells(),this._changed(TableBase.PROP_ROW_COUNT,e,t)}}get rows(){return this._rows}get cells(){return this._cells}get minRowHeight(){return this._minRowHeight}set minRowHeight(e){if(e!=this._minRowHeight){const t=this._minRowHeight;this._minRowHeight=e,this._minRowHeightDim=e?new Dimension(e):null,this._changed(TableBase.PROP_MIN_ROW_HEIGHT,e,t)}}get cellStyles(){return this._cellStyles}set cellStyles(e){const t=this._cellStyles={};if(e){const i=TableBase.CELL_STYLES;for(let r of i)r in e&&(t[r]=e[r])}t&&this._arrangePaddingStyles(t)}get fixed(){return this._fixed}set fixed(e){e!==this._fixed&&(this._fixed=e,this._changed(TableBase.PROP_FIXED,e,!e))}getRow(e){return this._rows.get(e)}getRowHeights(){return this._rows.getHeights()}getCell(e,t){return this._cells.getAt(e,t)}getCellItemAt(e,t){return e>=0&&e<this._cellMap.length?this._cellMap[e][t]:null}getCellItem(e){return this.getCellItemAt(e.row,e.col)}isHiddenAt(e,t){const i=this._spans[e][t];return i.r*i.c==0}isHiddenCell(e){const t=e&&this._spans[e.row][e.col];return t&&t.r*t.c==0}getHeadCell(e){let t=e.row,i=e.col;if(this.isHiddenAt(t,i)){for(;t>0&&this.isHiddenAt(--t,i););for(;i>0&&this.isHiddenAt(t,--i););}return this.getCell(t,i)}getLeftCol(e){const t=e.row;let i=e.col;for(;i>0&&this.isHiddenAt(t,i);)i--;return i}getTopRow(e){const t=e.col;let i=e.row;for(;i>0&&this.isHiddenAt(i,t);)i--;return i}getMinRowHeight(){return this._minRowHeightDim?this._minRowHeightDim.getFixedPixel():NaN}getColItems(e,t=!0){return this.filter((i=>{const r=i.col;return t?r===e:r!==e})).map((e=>e.item))}getRowItems(e,t=!0){return this.filter((i=>{const r=i.row;return t?r===e:r!==e})).map((e=>e.item))}getRowItemsFrom(e){return this.filter((t=>t.row>=e)).map((e=>e.item))}getRectItems(e,t,i,r,s=!1){return this.filter((i=>{const r=i.row,n=i.col;return!s||r!==e||n!==t})).map((e=>e.item))}prepareLayout(){return(this._spanDirty||this._itemDirty)&&(this.$_resetSpans(this._cells,this._spanDirty),this._spanDirty=!1,this._itemDirty=!1),this._spans}setFocus(e){this._focus=e&&{...e}}removeRow(e){const t=this._cellMap,i="number"==typeof e?e:this._rows.indexOf(e);if(i>=0&&i<this._rowCount){this._rows.remove(i);for(let e=0;e<this.colCount;e++){const r=t[i][e];r&&this.remove(r.item)}t.splice(i,1);for(let e=i;e<t.length;e++){const i=t[e];if(i)for(let e=0;e<this.colCount;e++){const t=i[e];t&&t.item&&t.item.$_setChildProp("row",t.item.row-1)}}this._rowCount--,this._resetCells(),this._changed(TableBase.PROP_ROW_COUNT,this._rowCount,this._rowCount+1)}}addRow(e,t){if(e>=0&&e<=this._rowCount){const i=this._rows.add(t,e);return this._rowCount++,this._addRows(e,1),this._resetCells(),this._changed(TableBase.PROP_ROW_COUNT,this._rowCount,this._rowCount-1),i}}canMoveRows(e,t,i,r=!1){const s=this.rowCount;if(i!==e&&e>=0&&e+t<=s&&i>=0&&i<s){let n=e;const o=this._spans,a=this.colCount;for(let e=0;e<a;e++){const t=o[n][e];if(0===t.r&&t.v.row<n){if(r)throw new AlertError(Messages.E_TABLE_MOVE_MERGE_CELLS);return!1}}n=e+t-1;for(let e=0;e<a;e++){const t=o[n][e].v;if(t&&t.row+t.rowspan>n){if(r)throw new AlertError(Messages.E_TABLE_MOVE_MERGE_CELLS);return!1}}if(i>e&&i++,i<s)for(let e=0;e<a;e++){if(0===o[i][e].r){if(r)throw new AlertError(Messages.E_TABLE_MOVE_TARGET_MERGE_CELLS);return!1}}return!0}}getNearestMovableRow(e,t,i){if(i<0)for(;e+i>=0;){if(this.canMoveRows(e,t,e+i))return e+i;i--}else if(i>0)for(;e+t-1+i<this.rowCount;){if(this.canMoveRows(e,t,e+i))return e+t-1+i;i++}return-1}moveRows(e,t,i,r=!1){if(r||this.canMoveRows(e,t,i))return this._rows.move(e,t,i),this._moveRows(e,t,i),this.layoutChanged=!0,this._changed(TableBase.PROP_CELL_LAYOUT,void 0,void 0),!0}canMoveCols(e,t,i,r=!1){const s=this.colCount;if(i!==e&&e>=0&&e+t<=s&&i>=0&&i<s){let n=e;const o=this._spans,a=this.rowCount;for(let e=0;e<a;e++){const t=o[e][n];if(0===t.c&&t.v.col<n){if(r)throw new AlertError(Messages.E_TABLE_MOVE_MERGE_CELLS);return!1}}n=e+t-1;for(let e=0;e<a;e++){const t=o[e][n].v;if(t&&t.col+t.colspan-1>n){if(r)throw new AlertError(Messages.E_TABLE_MOVE_MERGE_CELLS);return!1}}if(i>e&&i++,i<s)for(let e=0;e<a;e++){if(0===o[e][i].c){if(r)throw new AlertError(Messages.E_TABLE_MOVE_TARGET_MERGE_CELLS);return!1}}return!0}}getNearestMovableColumn(e,t,i){if(i<0)for(;e+i>=0;){if(this.canMoveCols(e,t,e+i,!1))return e+i;i--}else if(i>0)for(;e+t-1+i<this.colCount;){if(this.canMoveCols(e,t,e+t-1+i,!1))return e+i;i++}return-1}checkCounts(){const e=this.colCount,t=this.rowCount;assert(this._spans.length===t),this._spans.forEach((t=>{assert(t.length===e)}))}getSelection(e){return new TableSelection(e,e.width,e.height)}mergeCells(e,t,i,r){const s=this._cellMap;let n=e;e=Math.max(0,Math.min(e,i)),i=Math.min(this.rowCount-1,Math.max(n,i)),n=t,t=Math.max(0,Math.min(t,r)),r=Math.min(this.colCount-1,Math.max(n,r));for(let n=e;n<=i;n++)for(let i=t;i<=r;i++)if(n!==e||i!==t){const e=s[n][i];e&&this.remove(e.item)}this._resetCells()}_getEditProps(){return super._getEditProps().concat(TableBase.PROPINFOS)}_getStyleProps(){return TableBase.TABLE_STYLES}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.minRowHeight="24px"}_doLoad(e,t){super._doLoad(e,t),t&&(this._loadProps(t,"rowCount","base","minRowHeight","cellStyles"),t.hasOwnProperty("rows")&&(this._rowCount=this._rows.load(t.rows,this._rowCount)),this._cells.load(t.cells),this.$_resetSpans(this._cells))}_doSave(e){super._doSave(e),this._saveProps(e,"rowCount","base","minRowHeight","cellStyles"),this._rows.count&&this._rows.save(e.rows=[]),this._cells.save(e.cells=[])}_doSaveItems(e,t){for(let i of t){const t={};i.item.save(t),e.push(t)}}_getChildPropInfos(e){return TableBase.TABLE_CHILD_PROPS}_doLoadChild(e,t){this._loadChildProps(e,[TableBase.PROP_TABLE_COL,TableBase.PROP_TABLE_ROW],t)}_prepareCellGroup(e){try{const t=e.getChildProp(TableBase.PROP_TABLE_COL,this._focus?this._focus.col:0),i=e.getChildProp(TableBase.PROP_TABLE_ROW,this._focus?this._focus.row:0),r=this._cellMap;if(t>=0&&i>=0){let s=r[i]&&r[i][t];if(!s)return s=this._createCell(e),r[i]||(r[i]=[]),e.setChildProp(TableBase.PROP_TABLE_COL,t),e.setChildProp(TableBase.PROP_TABLE_ROW,i),r[i][t]=s;if(s.item!==e)throw Error("Only one item can exits in a table cell: "+(e.name||"")+"("+i+","+t+")")}}finally{this._focus=null}}_unprepareCellGroup(e){for(let t=0;t<this._cellMap.length;t++){const i=this._cellMap[t];if(i)for(let t=0;t<i.length;t++)if(i[t]&&i[t].item===e){const e=i[t];return i[t]=null,e}}}_doItemAdded(e,t){this._itemDirty=!0}_doItemRemoved(e,t){this._itemDirty=!0}_doItemChanged(e,t,i,r){if("col"===t||"row"===t){let i;"col"===t?(i=this._cellMap[e.row][r],this._cellMap[e.row][r]=null):(i=this._cellMap[r][e.col],this._cellMap[r][e.col]=null),this._cellMap[e.row][e.col]=i,this.onCellChanged&&this.onCellChanged(e,t,r)}}isAncestorOf(e){return super.isAncestorOf(e)||e instanceof TableCell&&e.table===this}_createRows(){return new TableRowCollection(this)}_spanChanged(e){this._spanDirty=!0}_resetCells(){var e;const t=this._cellMap.length,i=[],r=this.rowCount,s=this.colCount;for(let n=0;n<r;n++){const r=[];for(let i=0;i<s;i++){const s=t>n?null===(e=this._cellMap[n])||void 0===e?void 0:e[i]:null;r.push(s)}i.push(r)}this._cellMap=i,this._cells.prepareCells(),this.$_resetSpans(this._cells)}_removeCols(e,t){let i;this._cellMap.forEach((r=>{for(let s=0;s<t;s++)i=r[s+e],i&&this.remove(i.item);for(let s=e+t;s<r.length;s++)i=r[s],i&&i.item&&i.item.$_setChildProp("col",i.item.col-t);r.splice(e,t)})),this.$_resetSpans(this._cells)}_addCols(e,t){this._cellMap.forEach((i=>{for(let r=0;r<t;r++)i.splice(e,0,null);for(let r=e+t;r<i.length;r++){let e=i[r];e&&e.item&&e.item.$_setChildProp("col",e.item.col+t)}}))}_moveCols(e,t,i){this._cellMap.forEach((r=>{r.splice(e,t).forEach(((e,t)=>{r.splice(i+t,0,e)}));for(let e=0;e<r.length;e++){const t=r[e];t&&t.item&&t.item.$_setChildProp("col",e)}})),this.$_resetSpans(this._cells)}_removeRows(e,t){const i=this._cellMap;let r;for(let s=0;s<t;s++){const t=i[s+e];if(t)for(let e=0;e<this.colCount;e++)r=t[e],r&&this.remove(r.item)}i.splice(e,t);for(let s=e;s<i.length;s++){const n=i[s+e];if(n)for(let e=0;e<this.colCount;e++)r=n[e],r&&r.item&&r.item.$_setChildProp("row",r.item.row-t)}this.$_resetSpans(this._cells)}_addRows(e,t){const i=this._cellMap;for(let r=0;r<t;r++)i.splice(e,0,[]);for(let r=e+t;r<i.length;r++){const e=i[r];e&&e.forEach((e=>{e&&e.item&&e.item.$_setChildProp("row",e.item.row+t)}))}}_moveRows(e,t,i){const r=this._cellMap;r.splice(e,t).forEach(((e,t)=>r.splice(i+t,0,e)));for(let e=0;e<r.length;e++){const t=r[e];if(t)for(let i=0;i<this.colCount;i++){const r=t[i];r&&r.item&&r.item.$_setChildProp("row",e)}}this.$_resetSpans(this._cells)}canChangeChildProp(e,t,i){if("col"===t||"row"===t){if(i!==e.getProperty(t)){const r="row"===t?i:e.getProperty("row"),s="col"===t?i:e.getProperty("col");if(r<0||r>=this._rowCount||s<0||s>=this.colCount)throw new Error("Out of bounds");if(this.getCellItemAt(r,s))throw new Error("Already a item exists at ("+r+", "+s+")")}}return!0}$_rowChanged(e){this._changed(TableBase.PROP_ROWS,this._rows,this._rows)}$_resetSpans(e,t=!0){const i=this._rowCount,r=this.colCount;let s=this._spans;if(t){s=this._spans=[];for(let e=0;e<i;e++){s[e]=[];for(let t=0;t<r;t++)s[e][t]={r:1,c:1,m:null,v:null}}}for(let e=0;e<i;e++){s[e]=[];for(let t=0;t<r;t++)s[e][t]={r:1,c:1,m:null,v:null}}for(let t=0;t<i;t++)for(let n=0;n<r;n++){const o=s[t][n];if(o.r>0&&o.c>0){const a=e.getAt(t,n),A=this.getCellItemAt(t,n);if(a){const e=Math.min(r-n,Utils.pickNum(a.colspan,1)),l=Math.min(i-t,Utils.pickNum(a.rowspan,1));if(e>1||l>1)for(let i=0;i<l;i++)for(let r=0;r<e;r++){const e=s[t+i][n+r];e.m=A,r>0&&(e.c=0),i>0&&(e.r=0),e.v=a}o.m=A,o.v=a,o.r=l,o.c=e}else o.m=o.v=null}}this._cells.resetVisibles()}_addColumn(e){this._addCols(e,1),this._resetCells()}_removeColumn(e){var t,i;const r=this.rowCount,s=this.colCount,n=this._cellMap;for(let o=0;o<r;o++){const r=n[o],a=null===(t=n[o][e])||void 0===t?void 0:t.item;if(a&&this.remove(a),r){r.splice(e,1);for(let t=e;t<s;t++){const e=null===(i=r[t])||void 0===i?void 0:i.item;e&&e.$_setChildProp("col",e.col-1)}}}this._resetCells()}}TableBase.PROP_ROW_COUNT="rowCount",TableBase.PROP_MIN_ROW_HEIGHT="minRowHeight",TableBase.PROP_ROWS="rows",TableBase.PROP_TABLE_CELL_STYLES="cellStyles",TableBase.PROP_CELL_LAYOUT="table_cell_layout",TableBase.PROP_FIXED="fixed",TableBase.PROP_TABLE_COL="col",TableBase.PROP_TABLE_ROW="row",TableBase.PROPINFOS=[{name:TableBase.PROP_ROW_COUNT,category:PropCategory.TABLE,type:NumberProperty,multiple:!1,default:0},{name:TableBase.PROP_MIN_ROW_HEIGHT,category:PropCategory.TABLE,type:DimensionProperty,typeProps:{percentable:!1},multiple:!1,default:"15px"},{name:TableBase.PROP_TABLE_CELL_STYLES,category:PropCategory.BASIC,type:StylesProperty,multiple:!1,default:void 0},{name:TableBase.PROP_FIXED,category:PropCategory.TABLE,type:BooleanProperty,multiple:!0,default:void 0}],TableBase.TABLE_CHILD_PROPS=[{name:TableBase.PROP_TABLE_COL,category:PropCategory.TABLE,type:NumberProperty,multiple:!1,default:void 0,domain:void 0},{name:TableBase.PROP_TABLE_ROW,category:PropCategory.TABLE,type:NumberProperty,multiple:!1,default:void 0,domain:void 0}],TableBase.TABLE_STYLES=["fontFamily","fontSize","fontWeight","color","backgroundColor"],TableBase.CELL_STYLES=["paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeft","borderRight","borderTop","borderBottom"];class TableColumnBase extends ReportItemCollectionItem{constructor(e,t){super(e,t),this._index=-1,this._widthDim||(this.width="20%")}getEditProps(){return TableColumnBase.PROPINFOS}getCollectionLabel(){return"tableColumn"}get index(){return this._index}get width(){return this._width}set width(e){if(e!=this._width){const t=this._width;this._width=e,this._widthDim=new Dimension(e),this._changed(TableColumnBase.PROP_WIDTH,e,t)}}getWidth(e){return this._widthDim?this._widthDim.getPixel(e):NaN}get itemType(){return"Column"}get page(){var e;return null===(e=this.collection)||void 0===e?void 0:e.page}canSelectedWith(e){return e instanceof TableColumnBase&&e.parent===this.parent}_getStyleProps(){return TableColumnBase.styleProps}_doLoad(e){"string"==typeof e||"number"==typeof e?this.width=e:e&&this._loadPropsOf(e,TableColumnBase.PROPINFOS),super._doLoad(e)}_doSave(e){return this._savePropsOf(e,TableColumnBase.PROPINFOS),super._doSave(e),e}}TableColumnBase.PROP_WIDTH="width",TableColumnBase.PROPINFOS=[{name:TableColumnBase.PROP_WIDTH,category:PropCategory.COLUMN,type:DimensionProperty,multiple:!1,default:void 0}],TableColumnBase.styleProps=["cellAlign","backgroundColor"];class TableColumnCollectionBase extends ReportItemCollection{constructor(e){super(),this._columns=[],this._owner=e}get outlineParent(){return this._owner}get outlineLabel(){return"[Columns]"}get outlineExpandable(){return!0}get outlineItems(){return this._columns.forEach(((e,t)=>e.outlineOrder=t)),this._columns}getSaveType(){return"columns"}get owner(){return this._owner}get count(){return this._columns.length}set count(e){const t=this._columns.length;if((e=Math.max(0,Utils.toNumber(e)))!==t)try{if(e>t){for(let t=this._columns.length;t<e;t++)this._columns.push(this._createColumn(null));this._itemsAdded(this._columns.slice(t,e))}else this._itemsRemoved(this._columns.splice(e,t))}finally{this.$_resetColumns()}}get items(){return this.columns}get columns(){return this._columns.slice(0)}load(e,t){if(this._widths=null,this._columns=[],e&&e.length>0)for(let i of e){const e=this._createColumn(i);if(this._columns.push(e),t>0&&this._columns.length===t)break}if(t>0)for(;this._columns.length<t;)this._columns.push(this._createColumn(null));return this.$_resetColumns(),this._columns.length}save(e){this._columns.forEach((t=>e.push(t.save({}))))}get(e){return e>=0&&e<this._columns.length?this._columns[e]:null}getRange(e,t){return t>=e?this._columns.slice(e,t+1):this._columns.slice(t,e+1)}indexOf(e){return this._columns.indexOf(e)}getWidths(){if(this._widths)this._columns.forEach(((e,t)=>{this._widths.set(t,e._widthDim)}));else{const e=[];this._columns.forEach((t=>{e.push(t._widthDim)})),this._widths=new DimensionCollection(null),this._widths.$_init(e)}return this._widths}add(e,t=-1){t=t<0?this._columns.length:t;const i=this.$_add(e,t);if(i)return this.$_resetColumns(),this._itemAdded(i),i}remove(e){if(e>=0&&e<this._columns.length){const t=this._columns.splice(e,1)[0];return this.$_resetColumns(),this._itemRemoved(t,this._owner),!0}}clear(){if(this._columns.length>0)return this._columns=[],this.$_resetColumns(),!0}move(e,t,i){this._columns.splice(e,t).forEach(((e,t)=>this._columns.splice(i+t,0,e))),this.$_resetColumns()}adjustWidths(e,t,i){const r=this._columns[e]._widthDim,s=this._columns[e+1]._widthDim,n=r.value,o=s.value,a=t[e+1]-t[e],A=(i-a)/(a+(t[e+2]-t[e+1])),l=[];if(r.fixed&&s.fixed){let e=r.getFixedPixel(),t=s.getFixedPixel();const i=e+t;e=Math.round(e+A*i),t=i-e,e=getUnitsByPixels(r.unit,e),t=getUnitsByPixels(s.unit,t),l.push(e+r.unit,t+s.unit)}else if(r.fixed||s.fixed){const e=t[this._columns.length];let i=r.getPixel(e),n=s.getPixel(e);const o=i+n,a=r.fixed?r.unit:s.unit;i=Math.round(i+A*o),n=o-i,i=getUnitsByPixels(a,i),n=getUnitsByPixels(a,n),l.push(i+a,n+a)}else{const e=n+o,t=+(n+A*e).toFixed(1),i=+(e-t).toFixed(1);l.push(t+"%",i+"%")}return l}get page(){var e;return null===(e=this._owner)||void 0===e?void 0:e.page}get displayPath(){return this._owner?this._owner.displayPath+".columns":"columns"}get level(){return this._owner?this._owner.level+1:0}get marqueeParent(){return this._owner}isAncestor(e){return e===this._owner}_doMoveItem(e,t){return!1}$_add(e,t){if(e instanceof TableColumnBase||(e=this._createColumn(e)),e instanceof TableColumnBase&&this._columns.indexOf(e)<0)return this._columns.splice(Math.min(t,this._columns.length),0,e),e}$_resetColumns(){this._columns.forEach(((e,t)=>{e._parent=this,e._index=t})),this._widths=null,this.$_columnChanged(null)}$_columnChanged(e){this._owner&&this._owner.$_columnChanged(e)}}const ID_SUM=0,ID_COUNT=1,ID_MIN=2,ID_MAX=3,ID_AVG=4,IDENTS={sum:0,count:1,min:2,max:3,avg:4},ID_FIELD=999,ID_MASTER_FIELD=888;class DataBandSummaryRuntime extends ExpressionRuntime{constructor(e){super(),this._fieldMap={},this._idxMap={},this._masterFieldMap={},this._masterIdxMap={},this._band=e}_doDispose(){super._doDispose()}prepare(e,t){let i=this._data=e;if(this._fieldMap={},this._rowCount=NaN,i)for(let e=0;e<i.fieldCount;e++){const t=i.getField(e).fieldName;this._fieldMap[":"+t]=this._fieldMap[t]=999+e,this._idxMap[999+e]=t}if(t instanceof BandData){i=this._master=t;for(let e=0;e<i.fieldCount;e++){const t=i.getField(e).fieldName;this._masterFieldMap["master:"+t]=888+e,this._masterIdxMap[888+e]=t}}return this}setGroup(e){return this._group=e,this}setRows(e,t=-1){return this._rows=e,this._masterRow=t,this}setRowCount(e){return this._rowCount=e,this}isIdentifier(e){const t=e.toLocaleLowerCase();return IDENTS.hasOwnProperty(t)?IDENTS[t]:this._fieldMap.hasOwnProperty(e)?this._fieldMap[e]:this._masterFieldMap.hasOwnProperty(e)?this._masterFieldMap[e]:super.isIdentifier(e)}evaluateIdentifier(e){return e>=999?this._idxMap[e]:e>=888?this._master.getRowValue(this._masterRow,this._masterIdxMap[e]):void super.evaluateIdentifier(e)}evaluateFunc(e,t){const i=this.$_getRows();switch(e){case 0:return this._band.getSum(t,this._rowCount,i);case 1:return this._band.getCount(t,this._rowCount,i);case 2:return this._band.getMin(t,this._rowCount,i);case 3:return this._band.getMax(t,this._rowCount,i);case 4:return this._band.getAvg(t,this._rowCount,i)}return super.evaluateFunc(e,t)}$_getRows(){let e=this._rows;if(!e&&this._group){e=[];for(let t=0;t<this._group.count;t++)e.push(t+this._group.row)}return e}}class DataBandRowGroup extends ReportGroupItem{constructor(e){super(e)}get outlineLabel(){return"["+this.index+"] Group"}canRemoveFrom(){return!0}getEditProps(){return DataBandRowGroup.PROPINFOS}get field(){return this._field}set field(e){if(e!=this._field){const t=this._field;this._field=e,this._changed(DataBandRowGroup.PROP_FIELD,e,t)}}get pathLabel(){return"group"}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,DataBandRowGroup.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,DataBandRowGroup.PROPINFOS)}getPropDomain(e){if(e.name=DataBandRowGroup.PROP_FIELD)return this.getDataFieldNames()}}DataBandRowGroup.PROP_FIELD="field",DataBandRowGroup.PROPINFOS=[{name:DataBandRowGroup.PROP_FIELD,category:PropCategory.BAND,type:ListableProperty,multiple:!1,default:void 0}];class DataBand extends ReportGroupItem{constructor(e){super(e),this._sectionCount=1,this._sectionLayout=BandSectionLayout.DOWN_ACROSS,this._sectionGap=10,this._repeatMastreRow=!1,this._repeatDetailHeader=!1,this._repeatDetailFooter=!1,this._alwaysHeader=!0,this.pageNo=0,this.prevHead=!1,this.prevIndex=NaN,this.rowIndex=NaN,this.detailRows=NaN,this.add(this._detail=new DataBandCollection(this,"detail")),this._summaryRuntime=new DataBandSummaryRuntime(this)}get dataObj(){return this._dataObj}get designData(){return this._designData}get detail(){return this._detail}get isDetail(){return!!this._master}get master(){return this._master}get bandLevel(){return this._master?this._master.bandLevel+1:0}get sectionCount(){return this.isDetail?1:this._sectionCount}set sectionCount(e){if((e=isNaN(e)?1:Math.max(1,e))!==this._sectionCount){const t=this._sectionCount;this._sectionCount=e,this._changed(DataBand.PROP_DATA_BAND_SECTION_COUNT,e,t)}}get sectionLayout(){return this._sectionLayout}set sectionLayout(e){if(e!==this._sectionLayout){const t=this._sectionLayout;this._sectionLayout=e,this._changed(DataBand.PROP_DATA_BAND_SECTIONLAYOUT,e,t)}}get sectionGap(){return this._sectionGap}set sectionGap(e){if((e=Utils.toNumber(e,0))!=this._sectionGap){const t=this._sectionGap;this._sectionGap=e,this._changed(DataBand.PROP_DATA_BAND_SECTION_GAP,e,t)}}get maxRowCount(){return this._maxRowCount}set maxRowCount(e){if(isNaN(e)?e=void 0:e>>=0,e!==this._maxRowCount){const t=this._maxRowCount;this._maxRowCount=e,this._changed(DataBand.PROP_DATA_BAND_MAX_ROW_COUNT,e,t)}}get rowsPerPage(){return this._rowsPerPage}set rowsPerPage(e){if(isNaN(e)?e=void 0:e>>=0,e!==this._rowsPerPage){const t=this._rowsPerPage;this._rowsPerPage=e,this._changed(DataBand.PROP_DATA_BAND_ROWS_PER_PAGE,e,t)}}get maxRowsPerPage(){return this._maxRowsPerPage}set maxRowsPerPage(e){if(isNaN(e)?e=void 0:e>>=0,e!==this._maxRowsPerPage){const t=this._maxRowsPerPage;this._maxRowsPerPage=e,this._changed(DataBand.PROP_DATA_BAND_MAX_ROWS_PER_PAGE,e,t)}}get endRowCount(){return this._endRowCount}set endRowCount(e){if(isNaN(e)?e=void 0:e>>=0,e!==this._endRowCount){const t=this._endRowCount;this._endRowCount=e,this._changed(DataBand.PROP_DATA_BAND_END_ROW_COUNT,e,t)}}get maxEndRowCount(){return this._maxEndRowCount}set maxEndRowCount(e){if(isNaN(e)?e=void 0:e>>=0,e!==this._maxEndRowCount){const t=this._maxEndRowCount;this._maxEndRowCount=e,this._changed(DataBand.PROP_DATA_BAND_MAX_END_ROW_COUNT,e,t)}}get endRowMessage(){return this._endRowMessage}set endRowMessage(e){if(e!==this._endRowMessage){const t=this._endRowMessage;this._endRowMessage=e,this._changed(DataBand.PROP_DATA_BAND_END_ROW_MESSAGE,e,t)}}get masterFields(){return this._masterFields}set masterFields(e){if(e!=this._masterFields){const t=this._masterFields;this._masterFields=e,this._changed(DataBand.PROP_DATA_BAND_MASTER_FIELDS,e,t)}}get keyFields(){return this._keyFields}set keyFields(e){if(e!=this._keyFields){const t=this._keyFields;this._keyFields=e,this._changed(DataBand.PROP_DATA_BAND_KEY_FIELDS,e,t)}}get rowsPerMaster(){return this._rowsPerMaster}set rowsPerMaster(e){if(isNaN(e)?e=void 0:e>>=0,e!==this._rowsPerMaster){const t=this._rowsPerMaster;this._rowsPerMaster=e,this._changed(DataBand.PROP_DATA_BAND_ROWS_PER_MASTER,e,t)}}get repeatMasterRow(){return this._repeatMastreRow}set repeatMasterRow(e){e!==this._repeatMastreRow&&(this._repeatMastreRow=e,this._changed(DataBand.PROP_DATA_BAND_REPEAT_MASTER_ROW,e,!e))}get repeatDetailHeader(){return this._repeatDetailHeader}set repeatDetailHeader(e){e!==this._repeatDetailHeader&&(this._repeatDetailHeader=e,this._changed(DataBand.PROP_DATA_BAND_REPEAT_DETAIL_HEADER,e,!e))}get repeatDetailFooter(){return this._repeatDetailFooter}set repeatDetailFooter(e){e!==this._repeatDetailFooter&&(this._repeatDetailFooter=e,this._changed(DataBand.PROP_DATA_BAND_REPEAT_DETAIL_FOOTER,e,!e))}get alwaysHeader(){return this._alwaysHeader}set alwaysHeader(e){e!==this._alwaysHeader&&(this._alwaysHeader=e,this._changed(DataBand.PROP_DATA_BAND_ALWAYS_HEADER,e,!e))}get summaryRuntime(){return this._summaryRuntime}prepareIndices(e){this._doPrepareIndices(e);for(let t=0;t<this._detail.count;t++){const i=this._detail.get(t);i instanceof DataBand&&i.prepareIndices(e)}}getColPoints(e,t=0){const i=this.sectionGap,r=this.sectionCount,s=(e-i*(r-1))/r,n=[t];for(let e=0;e<r-1;e++)n.push(t+=s),n.push(t+=i);return n.push(t+=s),n}getColWidth(e){const t=this.sectionGap,i=this.sectionCount;return(e-t*(i-1))/i}getValues(e,t,i){if(i){const r=e.dp.get(this.data),s=[];for(let e=0;e<i.length;e++)s.push(r.getRowValue(t,i[e]));return s}}_selectRow(e,t,i){if(this._keyFlds){for(let i=0;i<Math.min(this._keyFlds.length,this._masterFlds.length);i++){if(e.getRowValue(t,this._keyFlds[i])!==this.masterValues[i])return!1}return!0}return i<this.detailRows}_getNextDetailRows(e,t){const i=[],r=e.dp.get(this.data);if(r){const e=r.rowCount;let s=t,n=0;for(;s<e&&this._selectRow(r,s,n);)i.push(s++),n++}return i}_skipDetailRows(e,t){if(this._keyFields){const i=e.dp.get(this.data);if(i){const e=i.rowCount;let r=t;for(;r<e&&this._selectRow(i,r,0);)r++;return r-t}}return 0}getRowsPerPage(){let e=this._rowsPerPage,t=!1;return e>0?t=!0:e=this._maxRowsPerPage>0?this._maxRowsPerPage:Number.MAX_SAFE_INTEGER,{rowsPerPage:e,breakRowsPerPage:t}}getEndRowCount(e=0){let t=this._endRowCount,i=!0;return t>0?(t+=e,i=!1):t=this._maxEndRowCount>0?this._maxEndRowCount+e:0,{endRowCount:t,stopEndRow:i}}getCount(e,t,i=null){if(isNaN(t)){if(i)return i.length;return this.$_getSummary(e,t).count}return t}getVCount(e,t,i=null){if(i)return t<i.length&&(i=i.slice(0,t)),i.length?this.$_getVCount(e,i):0;return this.$_getSummary(e,t).count}getSum(e,t,i=null){if(i)return t<i.length&&(i=i.slice(0,t)),i.length?this.$_getSum(e,i):0;return this.$_getSummary(e,t).sum}getMin(e,t,i=null){if(i)return t<i.length&&(i=i.slice(0,t)),i.length?this.$_getMin(e,i):NaN;return this.$_getSummary(e,t).min}getMax(e,t,i=null){if(i)return t<i.length&&(i=i.slice(0,t)),i.length?this.$_getMax(e,i):NaN;return this.$_getSummary(e,t).max}getAvg(e,t,i=null){if(i)return t<i.length&&(i=i.slice(0,t)),i.length?this.$_getSum(e,i)/i.length:NaN;return this.$_getSummary(e,t).avg}get designLevel(){return this.bandLevel}get dataDominant(){return!0}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(DataBand.PROPINFOS)}_getStyleProps(){return["fontFamily","fontSize","fontWeight","color","backgroundColor"].concat(super._getStyleProps())}canAddTo(e){return super.canAddTo(e)&&!e.isDataRowContainer}canResize(e){return!1}canPageBreak(){return!0}_doLoad(e,t){super._doLoad(e,t),t.hasOwnProperty("columnCount")&&(this.sectionCount=t.columnCount),t.hasOwnProperty("columnLayout")&&(this.sectionLayout=t.columnLayout),t.hasOwnProperty("columnCount")&&(this.sectionGap=t.columnGap),this._loadPropsOf(t,DataBand.PROPINFOS),t.hasOwnProperty("detail")&&this._detail.load(e,t.detail)}_doSave(e){super._doSave(e),this._savePropsOf(e,DataBand.PROPINFOS),this._detail.save(e.detail={})}_doPreparePrint(e){var t;if(super._doPreparePrint(e),this.detailRows=Number.MAX_SAFE_INTEGER,this._keyFlds=this.isDetail&&this._keyFields?this._keyFields.split(/\s*\,\s*/):null,this._keyFlds){for(let e=0;e<this._keyFlds.length;e++)this._keyFlds[e]=this._keyFlds[e].trim();if(this._masterFields){this._masterFlds=this._masterFields?this._masterFields.split(/\s*\,\s*/):null;for(let e=0;e<this._masterFlds.length;e++)this._masterFlds[e]=this._masterFlds[e].trim()}else this._masterFlds=this._keyFlds}this._dataObj=e.dp.get(this.data),this._designData=null===(t=e.designDp)||void 0===t?void 0:t.get(this.data),this._fieldSummary={},this._summaryRuntime.prepare(this._dataObj,this._master&&this._master._dataObj)}clearSummary(){this._fieldSummary={}}testPrepare(e){this._dataObj=e,this._fieldSummary={}}$_getSummary(e,t){let i=this._fieldSummary[e];return i||(this._fieldSummary[e]=i={},this.$_calcSummary(e,i,t)),i}$_calcSummary(e,t,i){const r=this._dataObj,s=isNaN(i)?r.rowCount:i;let n=0,o=0,a=s?Number.MAX_VALUE:NaN,A=s?Number.MIN_VALUE:NaN;for(let t=0;t<s;t++){const i=+r.getRowValue(t,e);isNaN(i)||(n++,o+=i,a=Math.min(a,i),A=Math.max(A,i))}t.count=s,t.vcount=n,t.sum=o,t.min=a,t.max=A,t.avg=s?o/s:NaN}$_getVCount(e,t){const i=this._dataObj;let r=0;for(let s of t){const t=+i.getRowValue(s,e);isNaN(t)||r++}return r}$_getSum(e,t){const i=this._dataObj;let r=0;for(let s of t){const t=+i.getRowValue(s,e);isNaN(t)||(r+=t)}return r}$_getMin(e,t){const i=this._dataObj;let r=Number.MAX_VALUE;for(let s of t){const t=+i.getRowValue(s,e);isNaN(t)||(r=Math.min(r,t))}return r}$_getMax(e,t){const i=this._dataObj;let r=Number.MIN_VALUE;for(let s of t){const t=+i.getRowValue(s,e);isNaN(t)||(r=Math.max(r,t))}return r}}DataBand.PROP_DATA_BAND_MASTER_FIELDS="masterFields",DataBand.PROP_DATA_BAND_KEY_FIELDS="keyFields",DataBand.PROP_DATA_BAND_ROWS_PER_MASTER="rowsPerMaster",DataBand.PROP_DATA_BAND_SECTION_COUNT="sectionCount",DataBand.PROP_DATA_BAND_SECTIONLAYOUT="sectionLayout",DataBand.PROP_DATA_BAND_SECTION_GAP="sectionGap",DataBand.PROP_DATA_BAND_MAX_ROW_COUNT="maxRowCount",DataBand.PROP_DATA_BAND_ROWS_PER_PAGE="rowsPerPage",DataBand.PROP_DATA_BAND_MAX_ROWS_PER_PAGE="maxRowsPerPage",DataBand.PROP_DATA_BAND_REPEAT_MASTER_ROW="repeatMasterRow",DataBand.PROP_DATA_BAND_REPEAT_DETAIL_HEADER="repeatDetailHeader",DataBand.PROP_DATA_BAND_REPEAT_DETAIL_FOOTER="repeatDetailFooter",DataBand.PROP_DATA_BAND_END_ROW_COUNT="endRowCount",DataBand.PROP_DATA_BAND_MAX_END_ROW_COUNT="maxEndRowCount",DataBand.PROP_DATA_BAND_END_ROW_MESSAGE="endRowMessage",DataBand.PROP_DATA_BAND_ALWAYS_HEADER="alwaysHeader",DataBand.PROPINFOS=[{name:DataBand.PROP_DATA_BAND_MASTER_FIELDS,category:PropCategory.BAND,type:StringProperty,multiple:!1,default:void 0,visible:e=>e.isDetail},{name:DataBand.PROP_DATA_BAND_KEY_FIELDS,category:PropCategory.BAND,type:StringProperty,multiple:!1,default:void 0,visible:e=>e.isDetail},{name:DataBand.PROP_DATA_BAND_ROWS_PER_MASTER,category:PropCategory.BAND,type:NumberProperty,multiple:!1,default:void 0,visible:e=>e.isDetail},{name:DataBand.PROP_DATA_BAND_SECTION_COUNT,category:PropCategory.BAND,type:NumberProperty,multiple:!1,default:1},{name:DataBand.PROP_DATA_BAND_SECTIONLAYOUT,category:PropCategory.BAND,type:EnumProperty,multiple:!1,default:BandSectionLayout.DOWN_ACROSS,domain:BandSectionLayout},{name:DataBand.PROP_DATA_BAND_SECTION_GAP,category:PropCategory.BAND,type:NumberProperty,multiple:!1,default:10},{name:DataBand.PROP_DATA_BAND_MAX_ROW_COUNT,category:PropCategory.DATA,type:NumberProperty,multiple:!1,default:void 0},{name:DataBand.PROP_DATA_BAND_ROWS_PER_PAGE,category:PropCategory.BAND,type:NumberProperty,multiple:!1,default:void 0},{name:DataBand.PROP_DATA_BAND_MAX_ROWS_PER_PAGE,category:PropCategory.BAND,type:NumberProperty,multiple:!1,default:void 0},{name:DataBand.PROP_DATA_BAND_REPEAT_MASTER_ROW,category:PropCategory.BAND,type:BooleanProperty,multiple:!1,default:!1,visible:e=>!e.isDetail},{name:DataBand.PROP_DATA_BAND_REPEAT_DETAIL_HEADER,category:PropCategory.BAND,type:BooleanProperty,multiple:!1,default:!1,visible:e=>e.isDetail},{name:DataBand.PROP_DATA_BAND_REPEAT_DETAIL_FOOTER,category:PropCategory.BAND,type:BooleanProperty,multiple:!1,default:!1,visible:e=>e.isDetail},{name:DataBand.PROP_DATA_BAND_END_ROW_COUNT,category:PropCategory.BAND,type:NumberProperty,multiple:!1,default:void 0},{name:DataBand.PROP_DATA_BAND_MAX_END_ROW_COUNT,category:PropCategory.BAND,type:NumberProperty,multiple:!1,default:void 0},{name:DataBand.PROP_DATA_BAND_END_ROW_MESSAGE,category:PropCategory.BAND,type:StringProperty,multiple:!1,default:void 0},{name:DataBand.PROP_DATA_BAND_ALWAYS_HEADER,category:PropCategory.BAND,type:BooleanProperty,multiple:!1,default:!0}];class DataBandCollection extends ReportGroupItem{constructor(e,t){super(""),this._owner=e,this._label=t,this.width="100%",this.designHeight=24}get owner(){return this._owner}getSaveType(){return this._label}get outlineLabel(){return"["+Utils.capitalize(this._label)+"]"}get designLevel(){return this._owner.designLevel}get marqueeParent(){return this._owner}canAdd(e){return e instanceof DataBand&&super.canAdd(e)}canContainsBand(){return!0}_doItemAdded(e,t){super._doItemAdded(e,t),e instanceof DataBand&&(e._master=this._owner)}}DataBandCollection.PROPINFOS=[];class TableBandColumn extends TableColumnBase{constructor(e,t){super(e,t)}getCollectionLabel(){return"tableBandColumn"}get band(){return this.collection.band}get displayPath(){return this.collection?this.collection.band.displayPath+".columns["+this.index+"]":"column"}get collection(){return super.collection}get marqueeParent(){var e;return null===(e=this.collection)||void 0===e?void 0:e.band}isAncestor(e){return e===this.collection.band}canRemoveFrom(){return this.collection&&this.collection.count>1}_changed(e,t,i){this.collection&&this.collection.$_columnChanged(this)}}class TableBandColumnCollection extends TableColumnCollectionBase{constructor(e){super(e)}get band(){return this.owner}_createColumn(e){return new TableBandColumn(this,e)}}class TableBandCellItem extends TableCellItem{constructor(e){super(e)}}TableBandCellItem.$_ctor="TableBandCellItem";class TableBandSection extends TableBase{constructor(e){super(null),this._band=e,this.rowCount=TableBandSection.DEFAULT_ROWS,this.width="100%"}get band(){return this._band}_getStyleProps(){return TableBandSection.STYLE_PROPS}needDesignWidth(){return!1}needDesignHeight(){return!1}canResize(e){return e===ResizeDirection.TOP||e===ResizeDirection.BOTTOM}get marqueeParent(){return this._band}get colCount(){return this._band?this._band.colCount:0}getColumn(e){return this._band.columns.get(e)}getCellWidths(){var e;return null===(e=this._band)||void 0===e?void 0:e.getCellWidths()}_createCell(e){return new TableBandCellItem(e)}isAncestorOf(e){return!!super.isAncestorOf(e)||(e===this.rows||(e instanceof TableRow&&e.collection===this.rows||(!!this.rows.isAncestorOf(e)||void 0)))}}TableBandSection.PROP_LINES="lines",TableBandSection.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor"],TableBandSection.DEFAULT_ROWS=1;class TableBandHeader extends TableBandSection{constructor(e,t=!1){super(e),this._repeat=!0,this._pageSection=t}get repeat(){return this._repeat}set repeat(e){e!=this._repeat&&(this._repeat=e,this._changed(TableBandHeader.PROP_TABLE_BAND_HEADER_REPEAT,e,!e))}get outlineLabel(){return this._pageSection?"[Page Header]":"[Band Header]"}get pathLabel(){return"header"}}TableBandHeader.PROP_TABLE_BAND_HEADER_REPEAT="repeat",TableBandHeader.$_ctor="TableBandHeader";class TableBandFooter extends TableBandSection{constructor(e,t=!1){super(e),this._attachToBody=!1,this._pageSection=t}get attachToBody(){return this._attachToBody}set attachToBody(e){e!==this._attachToBody&&(this._attachToBody=e,this._changed(TableBandFooter.PROP_ATTACH_TO_BODY,e,!e))}get outlineLabel(){return this._pageSection?"[Page Footer]":"[Band Footer]"}get pathLabel(){return"footer"}_getEditProps(){return super._getEditProps().concat(TableBandFooter.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,TableBandFooter.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,TableBandFooter.PROPINFOS)}}TableBandFooter.PROP_ATTACH_TO_BODY="attachToBody",TableBandFooter.PROPINFOS=[{name:TableBandFooter.PROP_ATTACH_TO_BODY,category:PropCategory.BAND,type:BooleanProperty,multiple:!1,default:!1}],TableBandFooter.$_ctor="TableBandFooter";class TableBandRowCell extends TableCell{constructor(){super(...arguments),this._autoMerge=!1}get autoMerge(){return this._autoMerge}set autoMerge(e){e!==this._autoMerge&&(this._autoMerge=e,this._changed(TableBandRowCell.PROP_AUTO_MERGE,e,!e))}getEditProps(){return super.getEditProps().concat(TableBandRowCell.PROPINFOS)}_doLoad(e){super._doLoad(e),this._loadPropsOf(e,TableBandRowCell.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,TableBandRowCell.PROPINFOS)}}TableBandRowCell.PROP_AUTO_MERGE="autoMerge",TableBandRowCell.$_ctor="TableBandCellItem",TableBandRowCell.PROPINFOS=[{name:TableBandRowCell.PROP_AUTO_MERGE,category:PropCategory.CELL,type:BooleanProperty,multiple:!0,default:!1}];class TableBandRowCellCollection extends TableCellCollection{getMergedCells(){return this._vcells.filter((e=>e.autoMerge))}_createCell(e,t){return new TableBandRowCell(this,e,t)}}class TableBandDataRow extends TableBandSection{constructor(){super(...arguments),this.masterRow=NaN}get blankItems(){return this._blankItems}canBlank(e,t){if(this.band.dataObj.equalRows(t,t-1,e.$_blankFlds))return!0}getMergedColumns(){const e=[];return this.items.forEach((t=>{const i=t.item;if(i.mergedInGroup){const t=i.col;e.indexOf(t)<0&&e.push(t)}})),e.length?e:null}getMergedCells(){let e=1===this.rowCount?this.cells.getMergedCells():null;return e&&e.length>0&&(e=e.filter((e=>{var t;return!(null===(t=this.getCellItem(e))||void 0===t?void 0:t.isEmpty)}))),e}get outlineLabel(){return"[Data Row]"}get pathLabel(){return"dataRow"}get dataDominant(){return!0}get isDataRowContainer(){return!0}_createCells(){return new TableBandRowCellCollection(this)}_getChildPropInfos(e){return TableBandDataRow.CHILD_PROPS.concat(super._getChildPropInfos(e))}_doLoadChild(e,t){super._doLoadChild(e,t),this._loadChildPropsOf(e,t,TableBandDataRow.CHILD_PROPS)}_doPreparePrint(e){super._doPreparePrint(e),this._blankItems=this.$_collectBlankItems()}$_collectBlankItems(){return this.collectBlankItems(this.items.map((e=>e.item)))}}TableBandDataRow.PROP_EQUAL_BLANK="equalBlank",TableBandDataRow.PROP_BLANK_FIELDS="blankFields",TableBandDataRow.PROP_MERGED_IN_GROUP="mergedInGroup",TableBandDataRow.CHILD_PROPS=[{name:TableBandDataRow.PROP_EQUAL_BLANK,category:PropCategory.BAND,type:BooleanProperty,multiple:!1,default:!1},{name:TableBandDataRow.PROP_BLANK_FIELDS,category:PropCategory.BAND,type:StringProperty,multiple:!1,default:void 0},{name:TableBandDataRow.PROP_MERGED_IN_GROUP,category:PropCategory.BAND,type:BooleanProperty,multiple:!1,default:!1}],TableBandDataRow.$_ctor="TableBandRow";class TableBandRowGroupSection extends TableBase{constructor(e,t){super(t),this._group=e,this.rowCount=TableBandRowGroupSection.DEFAULT_ROWS,this.width="100%"}get group(){return this._group}get band(){var e;return null===(e=this._group)||void 0===e?void 0:e.band}_getStyleProps(){return TableBandSection.STYLE_PROPS}needDesignHeight(){return!1}needDesignWidth(){return!1}canResize(e){return e===ResizeDirection.TOP||e===ResizeDirection.BOTTOM}get marqueeParent(){return this.band}get colCount(){return this.band?this.band.colCount:0}getColumn(e){return this.band.columns.get(e)}getCellWidths(){var e;return null===(e=this.band)||void 0===e?void 0:e.getCellWidths()}_createCell(e){return new TableBandCellItem(e)}isAncestorOf(e){return!!super.isAncestorOf(e)||(e===this.rows||(!!this.rows.isAncestorOf(e)||void 0))}}TableBandRowGroupSection.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor"],TableBandRowGroupSection.DEFAULT_ROWS=1;class TableBandRowGroupHeader extends TableBandRowGroupSection{constructor(e){super(e,"groupHeader")}get outlineLabel(){return"[Group Header]"}get pathLabel(){return"header"}}TableBandRowGroupHeader.$_ctor="TableBandRowGroupHeader";class TableBandRowGroupFooter extends TableBandRowGroupSection{constructor(e){super(e,"groupFooter"),this._merged=!0}get merged(){return this._merged}set merged(e){e!=this._merged&&(this._merged=e,this._changed(TableBandRowGroupFooter.PROP_MERGED,e,!e))}get outlineLabel(){return"[Group Footer]"}get pathLabel(){return"footer"}getEditProps(){return super.getEditProps().concat(TableBandRowGroupFooter.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,TableBandRowGroupFooter.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,TableBandRowGroupFooter.PROPINFOS)}}TableBandRowGroupFooter.PROP_MERGED="merged",TableBandRowGroupFooter.PROPINFOS=[],TableBandRowGroupFooter.$_ctor="TableBandRowGroupFooter";class TableBandRowGroup extends DataBandRowGroup{constructor(e){super("tableBandRowGroup"),this._merged=!0,this.add(this._header=new TableBandRowGroupHeader(this)),this.add(this._footer=new TableBandRowGroupFooter(this)),this._collection=e}get outlineParent(){return this._collection}get marqueeParent(){return this.band}getEditProps(){return super.getEditProps().concat(TableBandRowGroup.PROPINFOS)}getCollectionLabel(){return"tableBandGroup"}get header(){return this._header}get footer(){return this._footer}get band(){var e;return null===(e=this._collection)||void 0===e?void 0:e.band}get page(){var e;return null===(e=this.band)||void 0===e?void 0:e.page}get report(){var e;return null===(e=this.band)||void 0===e?void 0:e.report}get collection(){return this._collection}get dataParent(){return this.band}get outlineLabel(){return"[Group]"}get displayPath(){return this.collection?this.collection.band.displayPath+".groups["+this.index+"]":"group"}_ignoreItems(){return!0}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,TableBandRowGroup.PROPINFOS),t.hasOwnProperty("header")&&this._header.load(e,t.header),t.hasOwnProperty("footer")&&this._footer.load(e,t.footer)}_doSave(e){super._doSave(e),this._savePropsOf(e,TableBandRowGroup.PROPINFOS),this._header.save(e.header={}),this._footer.save(e.footer={})}_changed(e,t,i){super._changed(e,t,i),this._collection&&this._collection.$_groupChanged(this)}}TableBandRowGroup.PROPINFOS=[];class TableBandRowGroupCollection extends ReportItemCollection{constructor(e){super(),this._groups=[],this._band=e}get outlineParent(){return this._band}get outlineLabel(){return"[Groups]"}get outlineExpandable(){return!0}get outlineItems(){return this._groups}getSaveType(){return"groups"}get owner(){return this._band}get band(){return this._band}get count(){return this._groups.length}get items(){return this._groups.slice()}get visibleCount(){let e=0;for(let t of this._groups)t.visible&&e++;return e}get groups(){return this._groups.slice()}load(e,t){if(this._groups=[],t&&t.length>0){for(let i of t)if(i){const t=new TableBandRowGroup(this);t.load(e,i),this._groups.push(t)}this.$_invalidateGroups()}}save(e){for(let t of this._groups){const i={};t.save(i),e.push(i)}}get(e){return this._groups[e]}indexOf(e){return this._groups.indexOf(e)}add(e,t=-1){const i=this.$_add(e,t);if(i)return this.$_invalidateGroups(),this._itemAdded(i),i}addAll(e,t=-1){if(!e||e.length<1)return;const i=this._groups.length;t=t<0?this._groups.length:Math.max(0,this._groups.length);for(let i of e)this.$_add(i,t)&&t++;return this._groups.length!=i?(this.$_invalidateGroups(),!0):void 0}removeAt(e){if(e>=0&&e<this._groups.length){const t=this._groups.splice(e,1)[0];return this.$_invalidateGroups(),this._itemRemoved(t,this._band),!0}}remove(e){return this.removeAt(this.indexOf(e))}clear(){if(this._groups.length>0)return this._groups=[],this.$_invalidateGroups(),!0}getValidGroups(e){if(e){const t=[];for(let i of this._groups){const r=i.field;Utils.isNumber(r)?r>=0&&r<e.fieldCount&&t.push(i):e.containsField(r)&&t.push(i)}return t.length?t:null}return null}get page(){var e;return null===(e=this._band)||void 0===e?void 0:e.page}get displayPath(){return this._band?this._band.displayPath+".groups":"groups"}get level(){return this._band?this._band.level+1:0}isAncestorOf(e){if(super.isAncestorOf(e))return!0;if(this._groups.indexOf(e)>=0)return!0;for(let t of this._groups)if(t.indexOf(e))return!0}_doMoveItem(e,t){return!1}$_add(e,t=-1){if(!(e instanceof TableBandRowGroup)){const t=e;e=new TableBandRowGroup(this),t&&e.extend(t),e.header.cells.prepareCells(),e.footer.cells.prepareCells()}if(e instanceof TableBandRowGroup&&this._groups.indexOf(e)<0)return t<0?this._groups.push(e):this._groups.splice(Math.min(t,this._groups.length),0,e),e}$_invalidateGroups(){for(let e=this._groups.length-1;e>=0;e--)this._groups[e]._index=e;this._band&&this._band.$_groupChanged(null)}$_groupChanged(e){this._band&&this._band.$_groupChanged(e)}}class TableBand extends DataBand{constructor(e){super(e),this._columns=new TableBandColumnCollection(this),this._groups=new TableBandRowGroupCollection(this),this.add(this._header=new TableBandHeader(this)),this.add(this._footer=new TableBandFooter(this)),this.add(this._dataRow=new TableBandDataRow(this)),this._tables=[this._header,this._footer,this._dataRow],this._setOutlineOrders(1,this._dataRow,this._footer,this.detail),this.width="100%"}get outlineItems(){return[this._columns,this._groups].concat(super.outlineItems)}get colCount(){return this._colCount||0}set colCount(e){if((e=Math.max(1,e))!==this._colCount){const t=this._colCount,i=t-e;this._colCount=e,this._columns.count=e,e<t?this._tables.forEach((t=>{t._removeCols(e,i)})):this._tables.forEach((e=>{e._resetCells()})),this._changed(TableBand.PROP_COL_COUNT,e,t)}}get columns(){return this._columns}get groups(){return this._groups}get header(){return this._header}get footer(){return this._footer}get dataRow(){return this._dataRow}get pr(){return this._pr}get tr(){return this._tr}get lastTrs(){return this._lastTrs}getColumn(e){return this._columns.get(e)}getGroup(e){return this._groups.get(e)}getTables(){const e=this._groups,t=[this._header,this._dataRow,this._footer];for(let i=0;i<e.count;i++){const r=e.get(i);t.push(r.header,r.footer)}return t}removeColumn(e){const t="number"==typeof e?e:this._columns.indexOf(e);t>=0&&t<this._colCount&&(this._columns.remove(t),this._colCount--,this.getTables().forEach((e=>{e._removeColumn(t)})),this._changed(TableBand.PROP_COL_COUNT,this._colCount,this._colCount+1))}addColumn(e,t){if(e>=0&&e<=this._colCount){const i=this._columns.add(t,e);return this._colCount++,this.getTables().forEach((t=>{t._addColumn(e)})),this._changed(TableBand.PROP_COL_COUNT,this._colCount,this._colCount-1),i}}canMoveColumns(e,t,i,r=!1){return!this.getTables().some((s=>!s.canMoveCols(e,t,i,r)))}getNearestMovableColumn(e,t,i){let r=e+i;return this.getTables().forEach((s=>{const n=s.getNearestMovableColumn(e,t,i);r=i>0?Math.max(r,n):Math.min(r,n)})),r}moveColumns(e,t,i,r=!1){if(r||this.canMoveColumns(e,t,i))return this._columns.move(e,t,i),this.getTables().forEach((r=>{r._moveCols(e,t,i)})),this.layoutChanged=!0,this._changed(TableBase.PROP_CELL_LAYOUT,void 0,void 0),this._columns._indexChanged(),!0}getCellWidths(){return this._columns.getWidths()}setPrinting(e,t,i=0){e.row=this._pr=t,this._tr+=i,this._lastTrs=i}getSaveType(){return"tableband"}get outlineLabel(){return"[Table Band]"}get isBand(){return!0}_ignoreItems(){return!0}_getEditProps(){return super._getEditProps().concat(TableBand.PROPINFOS)}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),isNaN(this._colCount)&&(this.colCount=TableBand.DEFAULT_COL_COUNT)}isAncestorOf(e){return!!super.isAncestorOf(e)||(e instanceof TableBandColumn&&e.band===this||(e===this._groups||(!!this._groups.isAncestorOf(e)||void 0)))}_doLoad(e,t){super._doLoad(e,t),t&&(this._loadProps(t,"colCount"),t.hasOwnProperty("fields")&&(this._colCount=this._columns.load(t.fields,this._colCount)),t.hasOwnProperty("columns")&&(this._colCount=this._columns.load(t.columns,this._colCount)),t.hasOwnProperty("groups")&&this._groups.load(e,t.groups),t.hasOwnProperty("header")&&this._header.load(e,t.header),t.hasOwnProperty("footer")&&this._footer.load(e,t.footer),t.hasOwnProperty("row")&&this._dataRow.load(e,t.row),t.hasOwnProperty("dataRow")&&this._dataRow.load(e,t.dataRow))}_doSave(e){super._doSave(e),this._saveProps(e,"colCount"),this._columns.count&&this._columns.save(e.columns=[]),this._groups.count&&this._groups.save(e.groups=[]),this._header.save(e.header={}),this._footer.save(e.footer={}),this._dataRow.save(e.dataRow={})}$_columnChanged(e){this._changed(TableBand.PROP_COLUMNS,this._columns,this._columns)}$_groupChanged(e){this._changed(TableBand.PROP_GROUPS,this._groups,this._groups)}_doPreparePrint(e){super._doPreparePrint(e),this._groups.preparePrint(e)}_doPrepareIndices(e){e.row=e.index=this._pr=this._tr=0,this._lastTrs=0}remove(e){}getNextDetailRows(e){return this._getNextDetailRows(e,this._pr)}skipDetailRows(e){const t=this._skipDetailRows(e,this._pr);this._pr+=t}containsInSection(e){return this._header.contains(e,!0)||this._footer.contains(e,!0)}}TableBand.PROP_COL_COUNT="colCount",TableBand.PROP_COLUMNS="columns",TableBand.PROP_GROUPS="groups",TableBand.PROPINFOS=[{name:TableBand.PROP_COL_COUNT,category:PropCategory.TABLE,type:NumberProperty,multiple:!1,default:0}],TableBand.DEFAULT_COL_COUNT=5,TableBand.$_ctor="TableBand",TableBand.ITEM_TYPE="Table Band";class ChangeTableBandColCountCommand extends EditCommand{constructor(e,t){if(super("Change tableband cols"),assert(!!e),this._band=e,this._oldCols=e.colCount,this._cols=t,t<this._oldCols){const i=this._deleted=[[],[],[]];e.getTables().forEach((e=>{let r=[];for(let i=t;i<this._oldCols;i++)r=r.concat(e.getColItems(i));i.push(r)}));const r=this._cells=[];e.getTables().forEach((e=>{r.push(e.cells.truncateCol(t))}))}}_doDispose(){this._band=null}get band(){return this._band}get cols(){return this._cols}redo(e){this._band.colCount=this._cols}undo(){const e=this._band,t=this._deleted,i=this._cells;e.colCount=this._oldCols,t&&(e.getTables().forEach(((e,i)=>{t[i].forEach((t=>{e.add(t)}))})),e.getTables().forEach(((e,t)=>{e.cells.restoreCells(i[t])})))}get source(){return this._band}}class AddTableBandColumnCommand extends EditCommand{constructor(e,t,i){super("Add Band Field"),assert(!!e),this._band=e,this._index=t,this._config=i}_doDispose(){this._band=this._column=null}get band(){return this._band}get index(){return this._index}redo(e){const t=this._band,i=this._index,r=this._cells=[];t.getTables().forEach((e=>{r.push(e.cells.addCol(i))})),this._column=t.addColumn(i,this._config)}undo(){const e=this._band,t=this._index;e.getTables().forEach((e=>{e.cells.removeCol(t)})),e.removeColumn(this._column),e.getTables().forEach(((e,t)=>{e.cells.restoreCells(this._cells[t])}))}get source(){return this._column}}class RemoveTableBandColumnCommand extends EditCommand{constructor(e){super("Remove TableBandColumn"),this._deleted=[],assert(!!e);const t=this._band=e.band;assert(!!t),this._column=e;const i=this._index=t.columns.indexOf(e);t.getTables().forEach((e=>{this._deleted.push(e.getColItems(i))}))}_doDispose(){this._band=this._column=null}get band(){return this._band}get column(){return this._column}get index(){return this._index}redo(e){this._cells=[],this._band.getTables().forEach((e=>{this._cells.push(e.cells.removeCol(this._index))})),this._band.removeColumn(this._column)}undo(){const e=this._band,t=this._index;e.getTables().forEach(((e,i)=>{e.cells.addCol(t)})),e.addColumn(t,this._column),e.getTables().forEach(((e,t)=>{this._deleted[t].forEach((t=>{e.add(t)})),e.cells.restoreCells(this._cells[t])}))}get source(){return this._column}}class MoveTableBandColumnsCommand extends EditCommand{constructor(e,t,i,r,s){super("Move TableBand Columns"),this._band=e,assert(!!e),this._column=e.getColumn(this._index=t),this._count=i,this._newIndex=r,this._force=s}_doDispose(){this._band=this._column=null}get band(){return this._band}redo(e){this._cells=[],this._band.getTables().forEach((e=>{if(this._cells.push(e.cells.moveCols(this._index,this._count,this._newIndex)),!this._cells)throw new Error("TableCellCollection.moveCols failed: "+this._index+", "+this._count+", "+this._newIndex)})),this._band.moveColumns(this._index,this._count,this._newIndex,this._force)}undo(){this._band.getTables().forEach(((e,t)=>{e.cells.restoreCells(this._cells[t])})),this._band.moveColumns(this._newIndex,this._count,this._index,!0)}get source(){return this._column}}class TableColumn extends TableColumnBase{constructor(e,t){super(e,t)}get table(){return this.collection.table}get displayPath(){return this.collection?this.collection.table.displayPath+".columns["+this.index+"]":"column"}get collection(){return super.collection}get marqueeParent(){var e;return null===(e=this.collection)||void 0===e?void 0:e.table}isAncestor(e){return e===this.collection.table}canRemoveFrom(){return this.collection&&this.collection.count>1}_changed(e,t,i){this.collection&&this.collection.$_columnChanged(this)}}class TableColumnCollection extends TableColumnCollectionBase{constructor(e){super(e)}get table(){return this.owner}_createColumn(e){return new TableColumn(this,e)}}class TableContainerCellItem extends TableCellItem{constructor(e){super(e)}get pathLabel(){return"cell["+this.row+","+this.col+"]"}}TableContainerCellItem.$_ctor="TableCellItem";class TableContainer extends TableBase{constructor(e){super(e),this._columns=new TableColumnCollection(this)}changeColumnWidth(e,t){}getColumnWidth(e){return this._columns.get(e).width}get outlineItems(){return[this._columns].concat(super.outlineItems)}get baseTable(){return this._baseTable}set baseTable(e){if(e!=this._baseTable){const t=this._baseTable;this._baseTable=e,this._changed(TableContainer.PROP_BASE_TABLE,e,t)}}get colCount(){return this._colCount||0}set colCount(e){if((e=Math.max(1,e))!==this._colCount){const t=this._colCount;this._colCount=e,this._columns.count=e,e<t?this._removeCols(e,t-e):this._resetCells(),this._changed(TableContainer.PROP_COL_COUNT,e,t)}}get columns(){return this._columns}getColumn(e){return this._columns.get(e)}removeColumn(e){const t="number"==typeof e?e:this._columns.indexOf(e);t>=0&&t<this._colCount&&(this._columns.remove(t),this._colCount--,this._removeColumn(t),this._changed(TableContainer.PROP_COL_COUNT,this._colCount,this._colCount+1))}addColumn(e,t){if(e>=0&&e<=this._colCount){const i=this._columns.add(t,e);return this._colCount++,this._addColumn(e),this._changed(TableContainer.PROP_COL_COUNT,this._colCount,this._colCount-1),i}}canMoveColumns(e,t,i,r=!1){return this.canMoveCols(e,t,i,r)}moveColumns(e,t,i,r=!1){if(r||this.canMoveCols(e,t,i))return this._columns.move(e,t,i),this._moveCols(e,t,i),this.layoutChanged=!0,this._changed(TableBase.PROP_CELL_LAYOUT,void 0,void 0),this._columns._indexChanged(),!0}getSaveType(){return"table"}get outlineLabel(){return"[Table] ("+this.rowCount+" x "+this.colCount+")"}get pathLabel(){return"table"}needDesignWidth(){return!1}needDesignHeight(){return!1}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(TableContainer.PROPINFOS)}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),isNaN(this._colCount)&&(this.colCount=TableContainer.DEFAULT_COL_COUNT,this.rowCount=TableContainer.DEFAULT_ROW_COUNT);const s=this.colCount;this.width="100%",this._columns.forEach(((e,t)=>{const i=Math.floor(100/s);e.width=i+"%"}))}_doLoad(e,t){t&&(this._loadProps(t,"data","colCount","baseTable"),t.hasOwnProperty("columns")&&(this._colCount=this._columns.load(t.columns,this._colCount)),super._doLoad(e,t))}_doLoadChild(e,t){super._doLoadChild(e,t),this._loadChildProps(e,[],t)}_doSave(e){super._doSave(e),this._saveProps(e,"data","colCount","baseTable"),this._columns.count&&this._columns.save(e.columns=[])}_createCell(e){return new TableContainerCellItem(e)}getCellWidths(){return this._baseContainer&&this._baseContainer.getCellWidths()||this._columns.getWidths()}prepareLayout(){return this._baseContainer=this._baseTable&&this.page.getItem(this._baseTable),super.prepareLayout()}isAncestorOf(e){return super.isAncestorOf(e)||e instanceof TableColumn&&e.collection.parent===this||e instanceof TableRow&&e.table===this}$_columnChanged(e){this._changed(TableContainer.PROP_COLUMNS,this._columns,this._columns)}}TableContainer.PROP_BASE_TABLE="baseTable",TableContainer.PROP_COL_COUNT="colCount",TableContainer.PROP_COLUMNS="columns",TableContainer.PROPINFOS=[{name:TableContainer.PROP_BASE_TABLE,category:PropCategory.TABLE,type:StringProperty,multiple:!1,default:void 0},{name:TableContainer.PROP_COL_COUNT,category:PropCategory.TABLE,type:NumberProperty,multiple:!1,default:0}],TableContainer.DEFAULT_ROW_COUNT=4,TableContainer.DEFAULT_COL_COUNT=4,TableContainer.$_ctor="TableContainer",TableContainer.ITEM_TYPE="Table";class ChangeTableColCountCommand extends EditCommand{constructor(e,t){if(super("Change table cols"),assert(!!e),this._table=e,this._oldCols=e.colCount,this._cols=t,t<this._oldCols){this._deleted=[],this._indices=[];for(let i=0;i<e.rowCount;i++)for(let r=t;r<this._oldCols;r++){const t=e.getCellItemAt(i,r);t&&(this._deleted.push(t.item),this._indices.push(t.index))}this._deleted=this._deleted.sort(((e,t)=>e.parent.index-t.parent.index)),this._indices=this._indices.sort(((e,t)=>e-t)),this._cells=e.cells.truncateCol(t)}}_doDispose(){this._table=null}get table(){return this._table}get cols(){return this._cols}redo(e){this._table.colCount=this._cols}undo(){const e=this._table;e.colCount=this._oldCols,this._deleted&&(this._deleted.forEach(((t,i)=>{e.add(t,this._indices[i])})),e.cells.restoreCells(this._cells))}get source(){return this._table}}class RemoveTableColumnCommand extends EditCommand{constructor(e){super("Remove TableColumn"),this._deleted=[],assert(!!e);const t=this._table=e.table;assert(!!t),this._column=e;const i=this._index=t.columns.indexOf(e);this._deleted=t.getColItems(i)}_doDispose(){this._table=this._column=null}get table(){return this._table}get column(){return this._column}get index(){return this._index}redo(e){this._cells=this._table.cells.removeCol(this._index),this._table.removeColumn(this._column)}undo(){const e=this._table;e.cells.addCol(this._index),e.addColumn(this._index,this._column),this._deleted.forEach((t=>{e.append(t,!0)})),e.cells.restoreCells(this._cells)}get source(){return this._column}}class AddTableColumnCommand extends EditCommand{constructor(e,t){super("Add Table Column"),this._table=e,assert(!!e),this._index=t}_doDispose(){this._table=this._column=null}get table(){return this._table}get index(){return this._index}redo(e){this._cells=this._table.cells.addCol(this._index),this._column=this._table.addColumn(this._index,null)}undo(){this._table.cells.removeCol(this._index),this._table.removeColumn(this._index),this._table.cells.restoreCells(this._cells)}get source(){return this._column}}class MoveTableColumnsCommand extends EditCommand{constructor(e,t,i,r,s){super("Move Table Columns"),this._table=e,assert(!!e),this._column=e.getColumn(this._index=t),this._count=i,this._newIndex=r,this._force=s}_doDispose(){this._table=this._column=null}get table(){return this._table}redo(e){if(this._cells=this._table.cells.moveCols(this._index,this._count,this._newIndex),!this._cells)throw new Error("TableCellCollection.moveRows failed: "+this._index+", "+this._count+", "+this._newIndex);this._table.moveColumns(this._index,this._count,this._newIndex,this._force)}undo(){this._table.cells.restoreCells(this._cells),this._table.moveColumns(this._newIndex,this._count,this._index,!0)}get source(){return this._column}}class ChangeTableRowCountCommand extends EditCommand{constructor(e,t){super("Change table rows"),assert(!!e);const i=this._oldCount=e.rowCount,r=e.colCount;if(this._table=e,this._rows=t,t<i){this._deleted=[],this._indices=[];for(let s=t;s<i;s++)for(let t=0;t<r;t++){const i=e.getCellItemAt(s,t);i&&(this._deleted.push(i.item),this._indices.push(i.index))}this._deleted=this._deleted.sort(((e,t)=>e.parent.index-t.parent.index)),this._indices=this._indices.sort(((e,t)=>e-t)),this._cells=e.cells.truncateRow(t)}}_doDispose(){this._table=null}get table(){return this._table}get cols(){return this._rows}redo(e){this._table.rowCount=this._rows}undo(){const e=this._table;e.rowCount=this._oldCount,this._deleted&&(this._deleted.forEach(((t,i)=>{e.add(t,this._indices[i])})),e.cells.restoreCells(this._cells))}get source(){return this._table}}class RemoveTableRowCommand extends EditCommand{constructor(e){super("Remove TableRow"),assert(!!e);const t=this._table=e.table;assert(!!t),this._row=e;const i=this._index=t.rows.indexOf(e);this._deleted=t.getRowItems(i)}_doDispose(){this._table=this._row=this._cells=null}get table(){return this._table}get row(){return this._row}get index(){return this._index}redo(e){this._cells=this._table.cells.removeRow(this._index),this._table.removeRow(this._row)}undo(){const e=this._table;e.cells.addRow(this._index),e.addRow(this._index,this._row),this._deleted.forEach((t=>{e.append(t,!0)})),e.cells.restoreCells(this._cells)}get source(){return this._row}}class AddTableRowCommand extends EditCommand{constructor(e,t){super("Add TableRow"),this._table=e,assert(!!e),this._index=t}_doDispose(){this._table=this._row=null}get table(){return this._table}get index(){return this._index}redo(e){this._cells=this._table.cells.addRow(this._index),this._row=this._table.addRow(this._index,null)}undo(){this._table.cells.removeRow(this._index),this._table.removeRow(this._index),this._table.cells.restoreCells(this._cells)}get source(){return this._row}}class MoveTableRowsCommand extends EditCommand{constructor(e,t,i,r,s){super("Move Table Rows"),this._table=e,assert(!!this._table),this._row=e.rows.get(this._index=t),this._count=i,this._newIndex=r,this._force=s}_doDispose(){this._table=this._row=null}get table(){return this._table}redo(e){if(this._cells=this._table.cells.moveRows(this._index,this._count,this._newIndex),!this._cells)throw new Error("TableCellCollection.moveRows failed: "+this._index+", "+this._count+", "+this._newIndex);this._table.moveRows(this._index,this._count,this._newIndex,this._force)}undo(){this._table.cells.restoreCells(this._cells),this._table.moveRows(this._newIndex,this._count,this._index,!0)}get source(){return this._row}}class MergeTableSelectionCommand extends EditCommand{constructor(e){super("Merge Table Selection"),this._table=e.table,assert(!!this._table),this._sel=e;const t=this._bounds=e.table.cells.mergeBoundsOf(e);this._deleted=this._table.getRectItems(t.r1,t.c1,t.r2,t.c2,!0)}_doDispose(){this._table=this._bounds=null}get table(){return this._table}get bounds(){return this._bounds}redo(e){const t=this._bounds;this._cells=this._table.cells.merge(t.r1,t.c1,t.r2,t.c2),this._table.mergeCells(t.r1,t.c1,t.r2,t.c2)}undo(){const e=this._table;this._deleted.forEach((t=>{e.append(t,!0)})),e.cells.restoreCells(this._cells)}get source(){return this._sel.selectItem}}class UnmergeTableCellsCommand extends EditCommand{constructor(e){super("Unmerge Table Cell"),this._table=e.table,assert(!!this._table),this._cell=e}_doDispose(){this._table=this._cell=null}get table(){return this._table}redo(e){this._cells=this._table.cells.unmerge(this._cell)}undo(){this._table.cells.restoreCells(this._cells)}get source(){return this._cell}}class AdjustColumnWidthsCommand extends EditCommand{constructor(e,t,i,r){super("Adjust Table Column Widths"),this._table=e,assert(!!this._table),this._column=e.getColumn(t),assert(!!this._column),this._sibling=e.getColumn(t+1),assert(!!this._sibling),this._colPoints=i.slice(0),this._newSize=r,this._oldWidth=this._column.width,this._oldSiblingWidth=this._sibling.width}_doDispose(){this._table=this._column=this._sibling=null}redo(e){if(Utils.isNotDefined(this._newWidth)){const e=this._table.columns.adjustWidths(this._column.index,this._colPoints,this._newSize);this._newWidth=e[0],this._newSiblingWidth=e[1]}this._column.width=this._newWidth,this._sibling.width=this._newSiblingWidth}undo(){this._column.width=this._oldWidth,this._sibling.width=this._oldSiblingWidth}get source(){return this._column}}class AdjustRowHeightsCommand extends EditCommand{constructor(e,t,i,r){super("Adjust Table Row Heights"),this._table=e,assert(!!this._table),this._row=e.getRow(t),assert(!!this._row),this._sibling=e.getRow(t+1),assert(!!this._sibling),this._rowPoints=i.slice(0),this._newSize=r,this._oldHeight=this._row.height,this._oldSiblingHeight=this._sibling.height}_doDispose(){this._table=this._row=this._sibling=null}redo(e){if(Utils.isNotDefined(this._newHeight)){const e=this._table.rows.adjustHeights(this._row.index,this._rowPoints,this._newSize);this._newHeight=e[0],this._newSiblingHeight=e[1]}this._row.height=this._newHeight,this._sibling.height=this._newSiblingHeight}undo(){this._row.height=this._oldHeight,this._sibling.height=this._oldSiblingHeight}get source(){return this._row}}class ChartObject extends ReportItem{constructor(e,t){super(t),this._chart=e,this.visible=this._isDefaultVisible()}get chart(){return this._chart}canHide(){return!0}getWrapper(){return{enabled:this.visible}}get page(){return this._chart.page}get report(){return this._chart.report}get dataParent(){return this._chart}get marqueeParent(){return this._chart}getSaveType(){return""}_getEditProps(){return ChartObject.PROPINFOS}_doLoad(e,t){t.hasOwnProperty("visible")&&(this.visible=t.visible),this._loadProp(t,"styles")}_doSave(e){e.visible=this.visible,this._saveProp(e,"styles")}_isDefaultVisible(){return!0}_getPropsWrapper(e,t,i){const r=this.getEditProps();return r&&r.forEach((r=>{if(!t||t.indexOf(r.name)<0){const t=this[r.name],s=i&&i[r.name]||r.name;t instanceof ChartObject||void 0!==t&&(e[s]=t)}})),e}}ChartObject.PROPINFOS=[{name:ReportItem.PROP_VISIBLE,category:PropCategory.BASIC,type:BooleanProperty,multiple:!1,default:void 0,visible:e=>e.canHide()}];class ChartTextObject extends ChartObject{constructor(e){super(e),this._text="Title"}get text(){return this._text}set text(e){if(e!==this._text){const t=this._text;this._text=e,this._changed(ChartTextObject.PROP_TEXT,e,t)}}_getEditProps(){return super._getEditProps().concat(ChartTextObject.PROPINFOS)}_getStyleProps(){return["color","fontSize","fontWeight"]}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,ChartTextObject.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,ChartTextObject.PROPINFOS)}getWrapper(){const e=super.getWrapper();return e.text=this.visible?this._text:"",e.style=Utils.extend({},this.styles),e}}ChartTextObject.PROP_TEXT="text",ChartTextObject.PROPINFOS=[{name:ChartTextObject.PROP_TEXT,category:"",type:StringProperty,multiple:!1,default:void 0}];class ChartSeries extends ChartObject{constructor(e){super(e),this._designVisible=!0,this._values=Utils.iarandom(2,9,5)}getPropDomain(e){if(this.report){if(e.name===ChartSeries.PROP_DATA)return[void 0].concat(this.chart.report.designData.getNames());if(e.name===ChartSeries.PROP_VALUE_FIELD)return this.getDataFieldNames()}}get id(){return this._id}set id(e){if(e!==this._id){const t=this._id;this._id=e,this._changed(ChartSeries.PROP_SERIES_ID,e,t)}}get designVisible(){return this._designVisible}set designVisible(e){e!=this._designVisible&&(this._designVisible=e,this._changed(ChartSeries.PROP_DESIGN_VISIBLE,e,!e))}get valueField(){return this._valueField}set valueField(e){if(e!==this._valueField){const t=this._valueField;this._valueField=e,this._changed(ChartSeries.PROP_VALUE_FIELD,e,t)}}get values(){return this._values}set values(e){if(e!==this._values){const t=this._values;this._values=null==e?void 0:e.slice(),this._changed(ChartSeries.PROP_VALUES,e,t)}}hasValuesProp(){return!0}getValues(e,t){if(e.printing&&this._valueField){const e=this.data||this._getParentData();if(e)return t.getFieldValues(e,this._valueField)}return this._values}getSaveType(){return this.seriesType}get displayPath(){return this.chart.displayPath+".series["+this.index+"]"}get outlineLabel(){const e=Utils.capitalize(this.seriesType);return"["+this.index+"] "+(this.name?this.name+"("+e+")":e)}_getEditProps(){return super._getEditProps().concat(ChartSeries.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,ChartSeries.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,ChartSeries.PROPINFOS)}}ChartSeries.PROP_SERIES_ID="id",ChartSeries.PROP_DESIGN_VISIBLE="designVisible",ChartSeries.PROP_VALUE_FIELD="valueField",ChartSeries.PROP_VALUES="values",ChartSeries.PROPINFOS=[{name:ChartSeries.PROP_SERIES_ID,category:PropCategory.SERIES,type:StringProperty},{name:ChartSeries.PROP_DESIGN_VISIBLE,category:PropCategory.DESIGN,type:BooleanProperty,multiple:!1,default:!0},{name:ReportItem.PROP_NAME,category:PropCategory.BASIC,type:StringProperty,multiple:!1,default:void 0},{name:ReportItem.PROP_DATA,category:PropCategory.DATA,type:ListableProperty,multiple:!1,default:void 0},{name:ChartSeries.PROP_VALUE_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0,visible:e=>e.hasValuesProp()},{name:ChartSeries.PROP_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0,visible:e=>e.hasValuesProp()}];class ChartSeriesCollection extends ReportItemCollection{constructor(e){super(),this._series=[],this._chart=e}get outlineParent(){return this._chart}get outlineLabel(){return"[Series]"}get outlineExpandable(){return!0}get outlineItems(){return this._series}get owner(){return this._chart}get chart(){return this._chart}get count(){return this._series.length}get items(){return this._series.slice()}get visibleCount(){let e=0;for(let t of this._series)t.visible&&e++;return e}load(e,t){if(this._series=[],t&&t.length>0){for(let i of t)if(i){const t=this._createSeries(e,i);t.load(e,i),this._series.push(t)}this.$_invalidateSeries()}}save(e){for(let t of this._series){const i={};t.save(i),e.push(i)}}get(e){return this._series[e]}indexOf(e){return this._series.indexOf(e)}add(e,t,i=-1){const r=this.$_add(e,t,i);if(r)return this.$_invalidateSeries(),this._itemAdded(r),r}addAll(e,t,i=-1){if(!t||t.length<1)return;const r=this._series.length;i=i<0?this._series.length:Math.max(0,this._series.length);for(let r of t)this.$_add(e,r,i)&&i++;return this._series.length!=r?(this.$_invalidateSeries(),!0):void 0}removeAt(e){if(e>=0&&e<this._series.length){const t=this._series.splice(e,1)[0];return this.$_invalidateSeries(),this._itemRemoved(t,this._chart),!0}}remove(e){return this.removeAt(this.indexOf(e))}clear(){if(this._series.length>0)return this._series=[],this.$_invalidateSeries(),!0}select(e){for(let t of this._series)t.designVisible=!e||e===t}getSaveType(){return"series"}get page(){var e;return null===(e=this._chart)||void 0===e?void 0:e.page}get displayPath(){return this._chart?this._chart.displayPath+".series":"series"}get level(){return this._chart?this._chart.level+1:0}isAncestorOf(e){return!!super.isAncestorOf(e)||(this._series.indexOf(e)>=0||void 0)}$_add(e,t,i=-1){if(!(t instanceof ChartSeries)){const i=t;t=this._createSeries(e,i),i&&t.load(e,i),t.defaultInit()}if(t instanceof ChartSeries&&this._series.indexOf(t)<0)return i<0?this._series.push(t):this._series.splice(Math.min(i,this._series.length),0,t),t}$_invalidateSeries(){for(let e=this._series.length-1;e>=0;e--)this._series[e]._index=e;this._seriesChanged(null)}$_seriesChanged(e){this._seriesChanged(null)}_doMoveItem(e,t){const i=this._series[t];return this._series[t]=this._series[e],this._series[e]=i,this.$_invalidateSeries(),!0}}var HichartMarkerSymbol,HichartDash,HichartStacking,HichartSymbol,HichartRadialDataLabelsAlignTo,HichartRadialDataLabelsConnectorShape,HichartLegendLayout,CrosstabSummary;!function(e){e.CIRCLE="circle",e.SQUARE="square",e.DIAMOND="diamond",e.TRIANGLE="triangle",e.TRIANGLE_DOWN="triangle-down"}(HichartMarkerSymbol||(HichartMarkerSymbol={})),function(e){e.DASH="Dash",e.DASH_DOT="DashDot",e.DOT="Dot",e.LONG_DASH="LongDash",e.LONG_DASH_DOT="LongDashDot",e.LONG_DASH_DOT_DOT="LongDashDotDot",e.SHORT_DASH="ShortDash",e.SHORT_DASH_DOT="ShortDashDot",e.SHORT_DASH_DOT_DOT="ShortDashDotDot",e.SHORT_DOT="ShortDot",e.SOLID="Solid"}(HichartDash||(HichartDash={}));class HichartTitle extends ChartTextObject{constructor(e){super(e),this._x=0}get align(){return this._align}set align(e){if(e!==this._align){const t=this._align;this._align=e,this._changed(HichartTitle.PROP_TITLE_ALIGN,e,t)}}get verticalAlign(){return this._verticalAlign}set verticalAlign(e){if(e!==this.verticalAlign){const t=this._verticalAlign;this._verticalAlign=e,this._changed(HichartTitle.PROP_TITLE_VERTICAL_ALIGN,e,t)}}get x(){return this._x}set x(e){if(e!==this._x){const t=this._x;this._x=e,this._changed(HichartTitle.PROP_TITLE_X,e,t)}}get y(){return this._y}set y(e){if(e!==this._y){const t=this._y;this._y=e,this._changed(HichartTitle.PROP_TITLE_Y,e,t)}}getWrapper(){const e=super.getWrapper();return this.assignProps(e,["align","verticalAlign","x","y"]),e}getSaveLabel(){return"title"}_getEditProps(){return super._getEditProps().concat(HichartTitle.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartTitle.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartTitle.PROPINFOS)}_doDefaultInit(e,t,i,r){this.text="Title"}}HichartTitle.PROP_TITLE_ALIGN="align",HichartTitle.PROP_TITLE_VERTICAL_ALIGN="verticalAlign",HichartTitle.PROP_TITLE_X="x",HichartTitle.PROP_TITLE_Y="y",HichartTitle.PROPINFOS=[{name:HichartTitle.PROP_TITLE_ALIGN,category:PropCategory.TITLE,type:EnumProperty,multiple:!1,default:void 0,domain:Align},{name:HichartTitle.PROP_TITLE_VERTICAL_ALIGN,category:PropCategory.TITLE,type:EnumProperty,multiple:!1,default:void 0,domain:VerticalAlign},{name:HichartTitle.PROP_TITLE_X,category:PropCategory.TITLE,type:NumberProperty,multiple:!0,default:void 0},{name:HichartTitle.PROP_TITLE_Y,category:PropCategory.TITLE,type:NumberProperty,multiple:!0,default:void 0}];class HichartSubtitle extends HichartTitle{constructor(e){super(e),this.text="Subtitle"}getSaveLabel(){return"subtitle"}_isDefaultVisible(){return!1}_doDefaultInit(e,t,i,r){this.text="Subtitle"}}!function(e){e.NORMAL="normal",e.PERCENT="percent"}(HichartStacking||(HichartStacking={}));class HichartItem extends ReportGroupItem{constructor(e){super(e),this._inverted=!1,this._plotBorderColor="#cccccc",this._title=new HichartTitle(this),this._subtitle=new HichartSubtitle(this),this._xAxis=new HichartXAxis(this),this._yAxis=new HichartYAxis(this),this._legend=new HichartLegend(this),this._series=new HichartSeriesCollection(this),this._xAxis.title.visible=!1,this._xAxis.title.text="Labels",this._yAxis.title.text="Values"}get outlineItems(){return[this._series,this._xAxis,this._yAxis].concat(super.outlineItems)}get theme(){return this._theme}set theme(e){if(e!=this._theme){const t=this._theme;this._theme=e,this._changed(HichartItem.PROP_HICHART_THEME,e,t)}}get inverted(){return this._inverted}set inverted(e){e!==this._inverted&&(this._inverted=e,this._changed(HichartItem.PROP_HICHART_INVERTED,e,!e))}get stacking(){return this._stacking}set stacking(e){if(e!==this._stacking){const t=this._stacking;this._stacking=e,this._changed(HichartItem.PROP_HICHART_STACKING,e,t)}}get plotBorderWidth(){return this._plotBorderWidth}set plotBorderWidth(e){if(e!==this._plotBorderWidth){const t=e;this._plotBorderWidth=e,this._changed(HichartItem.PROP_HICHART_PLOT_BORDER_WIDTH,e,t)}}get plotBorderColor(){return this._plotBorderColor}set plotBorderColor(e){if(e!==this._plotBorderColor){const t=e;this._plotBorderColor=e,this._changed(HichartItem.PROP_HICHART_PLOT_BORDER_COLOR,e,t)}}get title(){return this._title}get subtitle(){return this._subtitle}get xAxis(){return this._xAxis}get yAxis(){return this._yAxis}get legend(){return this._legend}get series(){return this._series}addSeries(e,t){const i=this.report;if(i)return this._series.add(i.loader,e,t)}removeSeries(e){this._series.remove(e)}selectSeries(e){this._series.select(e)}getParentBand(){let e=this.parent;for(;e;){if(e instanceof DataBand)return e;e=e.parent}}getSaveType(){return"hichart"}get outlineLabel(){return"[High Chart]"}needDesignWidth(){return!1}needDesignHeight(){return!1}_getEditProps(){return super._getEditProps().concat(HichartItem.PROPINFOS)}_getStyleProps(){return HichartItem.STYLE_PROPS}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=340,this.height=270,this._title.defaultInit(e,this,i,r),this._subtitle.defaultInit(e,this,i,r),this._xAxis.defaultInit(e,this,i,r),this._yAxis.defaultInit(e,this,i,r),this._legend.defaultInit(e,this,i,r),this._series.add(e,{},0)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartItem.PROPINFOS),this._loadObjects([this._title,this._subtitle,this._xAxis,this._yAxis,this._legend],e,t),t.hasOwnProperty("series")&&this._series.load(e,t.series)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartItem.PROPINFOS),this._saveObjects([this._title,this._subtitle,this._xAxis,this._yAxis,this._legend],e),this._series.count&&this._series.save(e.series=[])}canAddTo(e){return super.canAddTo(e)&&!e.isDataRowContainer}$_seriesChanged(e){this._changed(HichartItem.PROP_HICHART_SERIES,this._series,this._series)}}HichartItem.PROP_HICHART_THEME="theme",HichartItem.PROP_HICHART_INVERTED="inverted",HichartItem.PROP_HICHART_STACKING="stacking",HichartItem.PROP_HICHART_PLOT_BORDER_WIDTH="plotBorderWidth",HichartItem.PROP_HICHART_PLOT_BORDER_COLOR="plotBorderColor",HichartItem.PROP_HICHART_TITLE="title",HichartItem.PROP_HICHART_SUBTITLE="subtitle",HichartItem.PROP_HICHART_XAXIS="xAxis",HichartItem.PROP_HICHART_YAXIS="yAxis",HichartItem.PROP_HICHART_LEGEND="legend",HichartItem.PROP_HICHART_SERIES="series",HichartItem.PROPINFOS=[{name:ReportItem.PROP_DATA,category:PropCategory.DATA,type:ListableProperty,multiple:!1,default:void 0,domain:void 0},{name:HichartItem.PROP_HICHART_INVERTED,category:PropCategory.CHART,type:BooleanProperty,multiple:!1,default:!1},{name:HichartItem.PROP_HICHART_THEME,category:PropCategory.CHART,type:StringProperty,multiple:!1,default:void 0},{name:HichartItem.PROP_HICHART_STACKING,category:PropCategory.CHART,type:EnumProperty,multiple:!1,domain:HichartStacking,default:void 0},{name:HichartItem.PROP_HICHART_PLOT_BORDER_WIDTH,category:PropCategory.CHART,type:NumberProperty,multiple:!1,default:void 0},{name:HichartItem.PROP_HICHART_PLOT_BORDER_COLOR,category:PropCategory.CHART,type:ColorProperty,multiple:!1,default:void 0},{name:HichartItem.PROP_HICHART_TITLE,category:PropCategory.TITLE,type:ModelProperty,indented:!0,multiple:!1,default:void 0},{name:HichartItem.PROP_HICHART_SUBTITLE,category:PropCategory.SUBTITLE,type:ModelProperty,indented:!0,multiple:!1,default:void 0},{name:HichartItem.PROP_HICHART_LEGEND,category:"legend",type:ModelProperty,indented:!0,multiple:!1,default:void 0}],HichartItem.STYLE_PROPS=["border","backgroundColor"],HichartItem.$_ctor="HichartItem",HichartItem.ITEM_TYPE="Highchart";class HichartAxisTitle extends ChartTextObject{constructor(e){super(e),this.rotation=void 0}getSaveLabel(){return"title"}canRotate(){return!0}_getEditProps(){return super._getEditProps().concat(HichartAxisTitle.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartAxisTitle.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartAxisTitle.PROPINFOS)}getWrapper(){const e=super.getWrapper();return this.assignProps(e,[ReportItem.PROP_ROTATION]),e}}HichartAxisTitle.PROPINFOS=[{name:ReportItem.PROP_ROTATION,category:PropCategory.TITLE,type:NumberProperty}];class HichartAxisLabels extends ChartObject{constructor(e){super(e),this._staggerLines=0,this._step=0,this.rotation=0}get align(){return this._align}set align(e){if(e!==this._align){const t=this._align;this._align=e,this._changed(HichartAxisLabels.PROP_ALIGN,e,t)}}get format(){return this._format}set format(e){if(e!==this._format){const t=this._format;this._format=e,this._changed(HichartAxisLabels.PROP_FORMAT,e,t)}}get padding(){return this._padding}set padding(e){if(e!==this._padding){const t=this._padding;this._padding=e,this._changed(HichartAxisLabels.PROP_PADDING,e,t)}}get staggerLines(){return this._staggerLines}set staggerLines(e){if(e!==this._staggerLines){const t=this._staggerLines;this._staggerLines=e,this._changed(HichartAxisLabels.PROP_STAGGER_LINES,e,t)}}get step(){return this._step}set step(e){if(e!==this._step){const t=this._step;this._step=e,this._changed(HichartAxisLabels.PROP_STEP,e,t)}}canRotate(){return!0}getSaveLabel(){return"labels"}_getEditProps(){return super._getEditProps().concat(HichartAxisLabels.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartAxisLabels.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartAxisLabels.PROPINFOS)}getWrapper(){const e=super.getWrapper();return this.assignProps(e,[HichartAxisLabels.PROP_ALIGN,HichartAxisLabels.PROP_FORMAT,HichartAxisLabels.PROP_PADDING,HichartAxisLabels.PROP_ROTATION,HichartAxisLabels.PROP_STAGGER_LINES,HichartAxisLabels.PROP_STEP])}}HichartAxisLabels.PROP_ALIGN="align",HichartAxisLabels.PROP_FORMAT="format",HichartAxisLabels.PROP_PADDING="padding",HichartAxisLabels.PROP_STAGGER_LINES="staggerLines",HichartAxisLabels.PROP_STEP="step",HichartAxisLabels.PROPINFOS=[{name:HichartAxisLabels.PROP_ALIGN,category:PropCategory.LABELS,type:EnumProperty,multiple:!1,domain:Align,default:void 0},{name:HichartAxisLabels.PROP_FORMAT,category:PropCategory.LABELS,type:StringProperty,multiple:!1,default:void 0},{name:HichartAxisLabels.PROP_PADDING,category:PropCategory.LABELS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartAxisLabels.PROP_ROTATION,category:PropCategory.LABELS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartAxisLabels.PROP_STAGGER_LINES,category:PropCategory.LABELS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartAxisLabels.PROP_STEP,category:PropCategory.LABELS,type:NumberProperty,multiple:!1,default:void 0}];class HichartAxisPlotLabel extends ChartObject{constructor(e){super(e)}get align(){return this._align}set align(e){if(e!==this._align){const t=this._align;this._align=e,this._changed(HichartAxisPlotLabel.PROP_ALIGN,e,t)}}get verticalAlign(){return this._verticalAlign}set verticalAlign(e){if(e!==this._verticalAlign){const t=this._verticalAlign;this._verticalAlign=e,this._changed(HichartAxisPlotLabel.PROP_VERTICAL_ALIGN,e,t)}}get text(){return this._text}set text(e){if(e!==this._text){const t=this._text;this._text=e,this._changed(HichartAxisPlotLabel.PROP_TEXT,e,t)}}get textAlign(){return this._textAlign}set textAlign(e){if(e!==this._textAlign){const t=this._textAlign;this._textAlign=e,this._changed(HichartAxisPlotLabel.PROP_TEXT_ALIGN,e,t)}}get x(){return this._x}set x(e){if(e!==this._x){const t=this._x;this._x=e,this._changed(HichartAxisPlotLabel.PROP_X,e,t)}}get y(){return this._y}set y(e){if(e!==this._y){const t=this._y;this._y=e,this._changed(HichartAxisPlotLabel.PROP_Y,e,t)}}getSaveLabel(){return"labels"}canRotate(){return!0}_getEditProps(){return super._getEditProps().concat(HichartAxisPlotLabel.PROPINFOS)}_getStyleProps(){return HichartAxisPlotLabel.styleProps}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartAxisPlotLabel.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartAxisPlotLabel.PROPINFOS)}getWrapper(){const e=this.assignProps({},[HichartAxisPlotLabel.PROP_ALIGN,HichartAxisPlotLabel.PROP_VERTICAL_ALIGN,HichartAxisPlotLabel.PROP_TEXT,HichartAxisPlotLabel.PROP_TEXT_ALIGN,HichartAxisPlotLabel.PROP_X,HichartAxisPlotLabel.PROP_Y]);return e.style=Utils.extend({},this.styles),e}}HichartAxisPlotLabel.PROP_ALIGN="align",HichartAxisPlotLabel.PROP_VERTICAL_ALIGN="verticalAlign",HichartAxisPlotLabel.PROP_TEXT="text",HichartAxisPlotLabel.PROP_TEXT_ALIGN="textAlign",HichartAxisPlotLabel.PROP_X="x",HichartAxisPlotLabel.PROP_Y="y",HichartAxisPlotLabel.PROPINFOS=[{name:HichartAxisPlotLabel.PROP_ALIGN,category:PropCategory.LABELS,type:EnumProperty,multiple:!1,domain:Align,default:void 0},{name:HichartAxisPlotLabel.PROP_VERTICAL_ALIGN,category:PropCategory.LABELS,type:EnumProperty,multiple:!1,default:void 0,domain:VerticalAlign},{name:HichartAxisPlotLabel.PROP_ROTATION,category:PropCategory.LABELS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartAxisPlotLabel.PROP_TEXT,category:PropCategory.LABELS,type:StringProperty,multiple:!1,default:void 0},{name:HichartAxisPlotLabel.PROP_TEXT_ALIGN,category:PropCategory.LABELS,type:EnumProperty,multiple:!1,default:void 0,domain:Align},{name:HichartAxisPlotLabel.PROP_X,category:PropCategory.LABELS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartAxisPlotLabel.PROP_Y,category:PropCategory.LABELS,type:NumberProperty,multiple:!1,default:void 0}],HichartAxisPlotLabel.styleProps=["color","fontSize","fontWeight","fontFamily"];class HichartAxisPlotLine extends ReportItemCollectionItem{constructor(e,t){super(e),this._index=-1,this._label=new HichartAxisPlotLabel(e.axis.chart),t&&this.load(t)}get value(){return this._value}set value(e){if(e!==this._value){const t=this._value;this._value=e,this._changed(HichartAxisPlotLine.PROP_VALUE,e,t)}}get color(){return this._color}set color(e){if(e!==this._color){const t=this._color;this._color=e,this._changed(HichartAxisPlotLine.PROP_COLOR,e,t)}}get width(){return this._width}set width(e){if(e!==this._width){const t=this._width;this._width=e,this._changed(HichartAxisPlotLine.PROP_WIDTH,e,t)}}get dashStyle(){return this._dashStyle}set dashStyle(e){if(e!==this._dashStyle){const t=e;this._dashStyle=e,this._changed(HichartAxisPlotLine.PROP_DASH_STYLE,e,t)}}get zIndex(){return this._zIndex}set zIndex(e){if(e!==this._zIndex){const t=this._zIndex;this._zIndex=e,this._changed(HichartAxisPlotLine.PROP_Z_INDEX,e,t)}}get label(){return this._label}get itemType(){return"PlotLine"}get index(){return this._index}get page(){var e;return null===(e=this.collection)||void 0===e?void 0:e.page}get collection(){return super.collection}get displayPath(){return this.collection?this.collection.axis.displayPath+".plotLines["+this.index+"]":"plotLine"}get marqueeParent(){var e;return null===(e=this.collection)||void 0===e?void 0:e.owner}_getStyleProps(){return[]}getEditProps(){return HichartAxisPlotLine.PROPINFOS}_doLoad(e){this._loadPropsOf(e,HichartAxisPlotLine.PROPINFOS),this._label.load(null,e.label)}_doSave(e){this._savePropsOf(e,HichartAxisPlotLine.PROPINFOS),this._label.save(e.label={})}getWrapper(){const e={};return e.label=this._label.getWrapper(),this.assignProps(e,[HichartAxisPlotLine.PROP_VALUE,HichartAxisPlotLine.PROP_COLOR,HichartAxisPlotLine.PROP_WIDTH,HichartAxisPlotLine.PROP_DASH_STYLE,HichartAxisPlotLine.PROP_Z_INDEX]),e.label=this._label.getWrapper(),e}getCollectionLabel(){return"plotLine"}}HichartAxisPlotLine.PROP_VALUE="value",HichartAxisPlotLine.PROP_COLOR="color",HichartAxisPlotLine.PROP_WIDTH="width",HichartAxisPlotLine.PROP_DASH_STYLE="dashStyle",HichartAxisPlotLine.PROP_LABEL="label",HichartAxisPlotLine.PROP_Z_INDEX="zIndex",HichartAxisPlotLine.PROPINFOS=[{name:HichartAxisPlotLine.PROP_VALUE,category:"plotLine",type:NumberProperty},{name:HichartAxisPlotLine.PROP_COLOR,category:"plotLine",type:ColorProperty},{name:HichartAxisPlotLine.PROP_WIDTH,category:"plotLine",type:NumberProperty},{name:HichartAxisPlotLine.PROP_DASH_STYLE,category:"plotLine",type:EnumProperty,domain:HichartDash},{name:HichartAxisPlotLine.PROP_Z_INDEX,category:"plotLine",type:NumberProperty},{name:HichartAxisPlotLine.PROP_LABEL,category:PropCategory.LABEL,type:ModelProperty,indented:!0}];class HichartAxisPlotLineCollection extends ReportItemCollection{constructor(e){super(),this._lines=[],this._owner=e}get owner(){return this._owner}get axis(){return this._owner}load(e){const t=this._lines=[];if(e&&e.length>0){for(let i of e){const e=new HichartAxisPlotLine(this,i);t.push(e)}this.$_resetLines()}}save(e){this._lines.forEach((t=>e.push(t.save({}))))}indexOf(e){return this._lines.indexOf(e)}add(e,t=-1){if((e=e instanceof HichartAxisPlotLine?e:new HichartAxisPlotLine(this,e))instanceof HichartAxisPlotLine&&this._lines.indexOf(e)<0)return t=t<0?this._lines.length:t,this._lines.splice(Math.min(t,this._lines.length),0,e),this._itemAdded(e),this.$_resetLines(),e}remove(e){const t=this._lines.indexOf(e);if(t>=0){const e=this._lines.splice(t,1)[0];this._itemRemoved(e,this._owner.chart),this.$_resetLines()}}getWrapper(){const e=[];return this._lines.forEach((t=>{e.push(t.getWrapper())})),e}get count(){return this._lines.length}get items(){return this._lines.slice(0)}get outlineParent(){return this._owner}get outlineExpandable(){return!0}get outlineLabel(){return"[PlotLines]"}get outlineItems(){return this._lines}isEditableCollection(){return!0}getCollectionLabel(){return"plotLines"}get page(){return this._owner.page}get displayPath(){return this._owner?this._owner.displayPath+".plotLines":"plotLines"}get level(){return this._owner?this._owner.level+1:0}get marqueeParent(){return this._owner}get(e){return this._lines[e]}getSaveType(){return"plotLines"}_doMoveItem(e,t){return!1}$_resetLines(){this._lines.forEach(((e,t)=>{e._parent=this,e._index=t}))}}class HichartAxisPlotBand extends ReportItemCollectionItem{constructor(e,t){super(e),this._index=-1,this._label=new HichartAxisPlotLabel(e.axis.chart),t&&this.load(t)}get color(){return this._color}set color(e){if(e!==this._color){const t=this._color;this._color=e,this._changed(HichartAxisPlotBand.PROP_COLOR,e,t)}}get from(){return this._from}set from(e){if(e!==this._from){const t=this._from;this._from=e,this._changed(HichartAxisPlotBand.PROP_FROM,e,t)}}get to(){return this._to}set to(e){if(e!==this._to){const t=this._to;this._to=e,this._changed(HichartAxisPlotBand.PROP_TO,e,t)}}get zIndex(){return this._zIndex}set zIndex(e){if(e!==this._zIndex){const t=this._zIndex;this._zIndex=e,this._changed(HichartAxisPlotBand.PROP_Z_INDEX,e,t)}}get label(){return this._label}get itemType(){return"PlotBand"}get index(){return this._index}get page(){var e;return null===(e=this.collection)||void 0===e?void 0:e.page}get collection(){return super.collection}get displayPath(){return this.collection?this.collection.axis.displayPath+".plotBands["+this.index+"]":"plotBand"}get marqueeParent(){var e;return null===(e=this.collection)||void 0===e?void 0:e.owner}_getStyleProps(){return[]}getEditProps(){return HichartAxisPlotBand.PROPINFOS}_doLoad(e){this._loadPropsOf(e,HichartAxisPlotBand.PROPINFOS),this._label.load(null,e.label)}_doSave(e){this._savePropsOf(e,HichartAxisPlotBand.PROPINFOS),this._label.save(e.label={})}getWrapper(){const e={};return e.label=this._label.getWrapper(),this.assignProps(e,[HichartAxisPlotBand.PROP_FROM,HichartAxisPlotBand.PROP_TO,HichartAxisPlotBand.PROP_COLOR,HichartAxisPlotBand.PROP_Z_INDEX]),e.label=this._label.getWrapper(),e}getCollectionLabel(){return"plotBand"}}HichartAxisPlotBand.PROP_FROM="from",HichartAxisPlotBand.PROP_TO="to",HichartAxisPlotBand.PROP_COLOR="color",HichartAxisPlotBand.PROP_LABEL="label",HichartAxisPlotBand.PROP_Z_INDEX="zIndex",HichartAxisPlotBand.PROPINFOS=[{name:HichartAxisPlotBand.PROP_FROM,category:"plotLine",type:NumberProperty},{name:HichartAxisPlotBand.PROP_TO,category:"plotLine",type:NumberProperty},{name:HichartAxisPlotBand.PROP_COLOR,category:"plotLine",type:ColorProperty,multiple:!1,default:void 0},{name:HichartAxisPlotBand.PROP_Z_INDEX,category:"plotBand",type:NumberProperty},{name:HichartAxisPlotBand.PROP_LABEL,category:PropCategory.LABEL,type:ModelProperty,indented:!0,multiple:!1,default:void 0}];class HichartAxisPlotBandCollection extends ReportItemCollection{constructor(e){super(),this._bands=[],this._owner=e}get owner(){return this._owner}get axis(){return this._owner}load(e){const t=this._bands=[];if(e&&e.length>0){for(let i of e){const e=new HichartAxisPlotBand(this,i);t.push(e)}this.$_resetBands()}}save(e){this._bands.forEach((t=>e.push(t.save({}))))}indexOf(e){return this._bands.indexOf(e)}add(e,t=-1){if((e=e instanceof HichartAxisPlotBand?e:new HichartAxisPlotBand(this,e))instanceof HichartAxisPlotBand&&this._bands.indexOf(e)<0)return t=t<0?this._bands.length:t,this._bands.splice(Math.min(t,this._bands.length),0,e),this._itemAdded(e),this.$_resetBands(),e}remove(e){const t=this._bands.indexOf(e);if(t>=0){const e=this._bands.splice(t,1)[0];this._itemRemoved(e,this._owner.chart),this.$_resetBands()}}getWrapper(){const e=[];return this._bands.forEach((t=>{e.push(t.getWrapper())})),e}get count(){return this._bands.length}get items(){return this._bands.slice(0)}get outlineParent(){return this._owner}get outlineExpandable(){return!0}get outlineLabel(){return"[PlotBands]"}get outlineItems(){return this._bands}isEditableCollection(){return!0}getCollectionLabel(){return"plotBands"}get page(){return this._owner.page}get displayPath(){return this._owner?this._owner.displayPath+".plotBands":"plotBands"}get level(){return this._owner?this._owner.level+1:0}get marqueeParent(){return this._owner}get(e){return this._bands[e]}getSaveType(){return"plotBands"}_doMoveItem(e,t){return!1}$_resetBands(){this._bands.forEach(((e,t)=>{e._parent=this,e._index=t}))}}class HichartAxis extends ChartObject{constructor(e){super(e),this._title=new HichartAxisTitle(e),this._labels=new HichartAxisLabels(e),this._plotLines=new HichartAxisPlotLineCollection(this),this._plotBands=new HichartAxisPlotBandCollection(this)}getPropDomain(e){if(this.report&&e.name===HichartXAxis.PROP_CATEGORY_FIELD)return this.getDataFieldNames()}getPopupPropLabel(e){return e===HichartAxis.PROP_PLOT_LINES?`(${this._plotLines.count} lines)`:e===HichartAxis.PROP_PLOT_BANDS?`(${this._plotBands.count} bands)`:void 0}get outlineItems(){return[this._plotLines,this._plotBands].concat(super.outlineItems)}get outlineExpandable(){return!0}get title(){return this._title}get labels(){return this._labels}get categories(){return this._categories}set categories(e){if(e!==this._categories){const t=this._categories;this._categories=null==e?void 0:e.slice(),this._changed(HichartAxis.PROP_CATEGORIES,e,t)}}get categoryField(){return this._categoryField}set categoryField(e){if(e!==this._categoryField){const t=this._categoryField;this._categoryField=e,this._changed(HichartAxis.PROP_CATEGORY_FIELD,e,t)}}get minPadding(){return this._minPadding}set minPadding(e){if(e!==this._minPadding){const t=this._minPadding;this._minPadding=e,this._changed(HichartAxis.PROP_MIN_PADDING,e,t)}}get maxPadding(){return this._maxPadding}set maxPadding(e){if(e!==this._maxPadding){const t=this._maxPadding;this._maxPadding=e,this._changed(HichartAxis.PROP_MAX_PADDING,e,t)}}get plotLines(){return this._plotLines}get plotBands(){return this._plotBands}getCategories(e,t){if(!(e&&e.printing)||!this._categoryField)return this._categories;const i=this._getParentData();if(!i)return;const r=this.chart.getParentBand();return r&&r.data===i&&r.containsInSection(this.chart)&&r.isDetail?t.getFieldValues(i,this.categoryField,e.detailRows):t.getFieldValues(i,this.categoryField)}get outlineParent(){return this.chart}_getEditProps(){return super._getEditProps().concat(HichartAxis.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartAxis.PROPINFOS),this._loadObject(this._title,e,t),this._loadObject(this._labels,e,t),this._plotLines.load(t.plotLines),this._plotBands.load(t.plotBands)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartAxis.PROPINFOS),this._saveObject(this._title,e),this._saveObject(this._labels,e),this._plotLines.count>0&&this._plotLines.save(e.plotLines=[]),this._plotBands.count>0&&this._plotBands.save(e.plotBands=[])}getWrapper(){const e=super.getWrapper();return e.visible=this.visible,e.title=this._title.getWrapper(),e.labels=this._labels.getWrapper(),this._plotLines.count>0&&(e.plotLines=this._plotLines.getWrapper()),this._plotBands.count>0&&(e.plotBands=this._plotBands.getWrapper()),this.assignProps(e,[HichartAxis.PROP_MIN_PADDING,HichartAxis.PROP_MAX_PADDING]),e}}HichartAxis.PROP_TITLE="title",HichartAxis.PROP_CATEGORIES="categories",HichartAxis.PROP_CATEGORY_FIELD="categoryField",HichartAxis.PROP_LABELS="labels",HichartAxis.PROP_MIN_PADDING="minPadding",HichartAxis.PROP_MAX_PADDING="maxPadding",HichartAxis.PROP_PLOT_LINES="plotLines",HichartAxis.PROP_PLOT_BANDS="plotBands",HichartAxis.PROPINFOS=[{name:HichartAxis.PROP_TITLE,category:PropCategory.TITLE,type:ModelProperty,indented:!0,multiple:!1,default:void 0},{name:HichartAxis.PROP_CATEGORIES,category:PropCategory.AXIS,type:StringArrayProperty},{name:HichartAxis.PROP_CATEGORY_FIELD,category:PropCategory.AXIS,type:ListableProperty},{name:HichartAxis.PROP_LABELS,category:PropCategory.LABELS,type:ModelProperty,indented:!0},{name:HichartAxis.PROP_MIN_PADDING,category:PropCategory.AXIS,type:NumberProperty},{name:HichartAxis.PROP_MAX_PADDING,category:PropCategory.AXIS,type:NumberProperty},{name:HichartAxis.PROP_PLOT_LINES,category:PropCategory.AXIS,type:PopupProperty,collection:!0},{name:HichartAxis.PROP_PLOT_BANDS,category:PropCategory.AXIS,type:PopupProperty,collection:!0}];class HichartXAxis extends HichartAxis{constructor(e){super(e)}getPropDomain(e){if(this.report&&e.name===HichartXAxis.PROP_CATEGORY_FIELD)return this.getDataFieldNames()}getSaveLabel(){return"xAxis"}get displayPath(){return this.chart.displayPath+".xAxis"}get outlineLabel(){return"[X Axis]"}_getEditProps(){return super._getEditProps().concat(HichartXAxis.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartXAxis.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartXAxis.PROPINFOS)}getWrapper(){return super.getWrapper()}getPlotLineConfig(){}getPlotBandConfig(){}}HichartXAxis.PROPINFOS=[];class HichartYAxis extends HichartAxis{constructor(e){super(e)}get min(){return this._min}set min(e){if(e!==this._min){const t=this._min;this._min=e,this._changed(HichartYAxis.PROP_MIN,e,t)}}get max(){return this._max}set max(e){if(e!==this._max){const t=this._max;this._max=e,this._changed(HichartYAxis.PROP_MAX,e,t)}}getSaveLabel(){return"yAxis"}get displayPath(){return this.chart.displayPath+".yAxis"}get outlineLabel(){return"[Y Axis]"}_getEditProps(){return super._getEditProps().concat(HichartYAxis.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartYAxis.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartYAxis.PROPINFOS)}getWrapper(){const e=super.getWrapper();return this.assignProps(e,["min","max"]),e}getPlotLineConfig(){return{}}getPlotBandConfig(){}}HichartYAxis.PROP_MIN="min",HichartYAxis.PROP_MAX="max",HichartYAxis.PROPINFOS=[{name:HichartYAxis.PROP_MIN,category:PropCategory.AXIS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartYAxis.PROP_MAX,category:PropCategory.AXIS,type:NumberProperty,multiple:!1,default:void 0}],function(e){e.ARC="arc",e.CALLOUT="callout",e.CIRCLE="circle",e.DIAMOND="diamond",e.SQUARE="square",e.TRIANGLE="triangle"}(HichartSymbol||(HichartSymbol={}));class HichartDataLabels extends ChartObject{constructor(){super(...arguments),this._borderRadius=0,this._borderWidth=0,this._padding=5,this._x=0,this._y=0,this._z=6}get align(){return this._align}set align(e){if(e!==this._align){const t=this._align;this._align=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_ALIGN,e,t)}}get verticalAlign(){return this._verticalAlign}set verticalAlign(e){if(e!==this._verticalAlign){const t=this._verticalAlign;this._verticalAlign=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_VERTICAL_ALIGN,e,t)}}get shape(){return this._shape}set shape(e){if(e!==this._shape){const t=this._shape;this._shape=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_SHAPE,e,t)}}get format(){return this._format}set format(e){if(e!==this._format){const t=this._format;this._format=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_FORMAT,e,t)}}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){if(e!==this._backgroundColor){const t=this._backgroundColor;this._backgroundColor=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_BACKGROUND_COLOR,e,t)}}get shadow(){return this._shadow}set shadow(e){e!==this._shadow&&(this._shadow=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_SHADOW,e,!e))}get textOutline(){return this._textOutline}set textOutline(e){if(e!==this._textOutline){const t=this._textOutline;this._textOutline=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_TEXT_OUTLINE,e,t)}}get borderColor(){return this._borderColor}set borderColor(e){if(e!==this._borderColor){const t=this._borderColor;this._borderColor=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_BORDER_COLOR,e,t)}}get borderRadius(){return this._borderRadius}set borderRadius(e){if(e!==this._borderRadius){const t=this._borderRadius;this._borderRadius=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_BORDER_RADIUS,e,t)}}get borderWidth(){return this._borderWidth}set borderWidth(e){if(e!==this._borderWidth){const t=this._borderWidth;this._borderWidth=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_BORDER_WIDTH,e,t)}}get padding(){return this._padding}set padding(e){if(e!==this._padding){const t=this._padding;this._padding=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_PADDING,e,t)}}get x(){return this._x}set x(e){if(e!==this._x){const t=this._x;this._x=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_X,e,t)}}get y(){return this._y}set y(e){if(e!==this._y){const t=this._y;this._y=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_Y,e,t)}}get z(){return this._z}set z(e){if(e!==this._z){const t=this._z;this._z=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_Z,e,t)}}get inside(){return this._inside}set inside(e){e!==this._inside&&(this._inside=e,this._changed(HichartDataLabels.PROP_DATA_LABELS_INSIDE,e,!e))}_getEditProps(){return super._getEditProps().concat(HichartDataLabels.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartDataLabels.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartDataLabels.PROPINFOS)}canRotate(){return!0}getSaveLabel(){return"dataLabels"}getWrappaer(){const e=super.getWrapper();return this.assignProps(e,[HichartDataLabels.PROP_DATA_LABELS_ALIGN,HichartDataLabels.PROP_DATA_LABELS_VERTICAL_ALIGN,HichartDataLabels.PROP_DATA_LABELS_SHAPE,HichartDataLabels.PROP_DATA_LABELS_FORMAT,HichartDataLabels.PROP_DATA_LABELS_BACKGROUND_COLOR,HichartDataLabels.PROP_DATA_LABELS_SHADOW,HichartDataLabels.PROP_DATA_LABELS_TEXT_OUTLINE,HichartDataLabels.PROP_DATA_LABELS_BORDER_COLOR,HichartDataLabels.PROP_DATA_LABELS_BORDER_RADIUS,HichartDataLabels.PROP_DATA_LABELS_BORDER_WIDTH,HichartDataLabels.PROP_DATA_LABELS_PADDING,HichartDataLabels.PROP_DATA_LABELS_X,HichartDataLabels.PROP_DATA_LABELS_Y,HichartDataLabels.PROP_DATA_LABELS_Z,HichartDataLabels.PROP_DATA_LABELS_INSIDE]),e.style=Utils.extend({},this.styles),this.assignProps(e.style,["textOutline"]),e}_getStyleProps(){return["color","fontSize","fontWeight"]}}HichartDataLabels.PROP_DATA_LABELS_ALIGN="align",HichartDataLabels.PROP_DATA_LABELS_VERTICAL_ALIGN="verticalAlign",HichartDataLabels.PROP_DATA_LABELS_SHAPE="shape",HichartDataLabels.PROP_DATA_LABELS_FORMAT="format",HichartDataLabels.PROP_DATA_LABELS_BACKGROUND_COLOR="backgroundColor",HichartDataLabels.PROP_DATA_LABELS_SHADOW="shadow",HichartDataLabels.PROP_DATA_LABELS_TEXT_OUTLINE="textOutline",HichartDataLabels.PROP_DATA_LABELS_BORDER_COLOR="borderColor",HichartDataLabels.PROP_DATA_LABELS_BORDER_RADIUS="borderRadius",HichartDataLabels.PROP_DATA_LABELS_BORDER_WIDTH="borderWidth",HichartDataLabels.PROP_DATA_LABELS_PADDING="padding",HichartDataLabels.PROP_DATA_LABELS_X="x",HichartDataLabels.PROP_DATA_LABELS_Y="y",HichartDataLabels.PROP_DATA_LABELS_Z="z",HichartDataLabels.PROP_DATA_LABELS_INSIDE="inside",HichartDataLabels.PROPINFOS=[{name:HichartDataLabels.PROP_DATA_LABELS_ALIGN,category:PropCategory.DATA_LABELS,type:EnumProperty,multiple:!1,default:void 0,domain:Align},{name:HichartDataLabels.PROP_DATA_LABELS_VERTICAL_ALIGN,category:PropCategory.DATA_LABELS,type:EnumProperty,multiple:!1,default:void 0,domain:VerticalAlign},{name:HichartDataLabels.PROP_ROTATION,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartDataLabels.PROP_DATA_LABELS_SHAPE,category:PropCategory.DATA_LABELS,type:EnumProperty,multiple:!1,default:void 0,domain:HichartSymbol},{name:HichartDataLabels.PROP_DATA_LABELS_FORMAT,category:PropCategory.DATA_LABELS,type:StringProperty,multiple:!1,default:void 0},{name:HichartDataLabels.PROP_DATA_LABELS_BACKGROUND_COLOR,category:PropCategory.DATA_LABELS,type:ColorProperty,multiple:!1,default:void 0},{name:HichartDataLabels.PROP_DATA_LABELS_SHADOW,category:PropCategory.DATA_LABELS,type:BooleanProperty,multiple:!1,default:void 0},{name:HichartDataLabels.PROP_DATA_LABELS_TEXT_OUTLINE,category:PropCategory.DATA_LABELS,type:StringProperty,multiple:!1,default:void 0},{name:HichartDataLabels.PROP_DATA_LABELS_BORDER_COLOR,category:PropCategory.DATA_LABELS,type:ColorProperty,multiple:!1,default:void 0},{name:HichartDataLabels.PROP_DATA_LABELS_BORDER_RADIUS,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartDataLabels.PROP_DATA_LABELS_BORDER_WIDTH,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartDataLabels.PROP_DATA_LABELS_PADDING,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!1,default:void 0},{name:HichartDataLabels.PROP_DATA_LABELS_X,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!1,default:0},{name:HichartDataLabels.PROP_DATA_LABELS_Y,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!1,default:0},{name:HichartDataLabels.PROP_DATA_LABELS_Z,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!1,default:6},{name:HichartDataLabels.PROP_DATA_LABELS_INSIDE,category:PropCategory.DATA_LABELS,type:BooleanProperty,multiple:!1,default:void 0}];class HichartCartesianDataLabels extends HichartDataLabels{}HichartCartesianDataLabels.PROP_DATA_LABELS_ALIGN="align",function(e){e.CONNECTORS="connectors",e.PLOT_EDGES="plotEdges"}(HichartRadialDataLabelsAlignTo||(HichartRadialDataLabelsAlignTo={})),function(e){e.FIXED_OFFSET="fixedOffset",e.STRAIGHT="straight",e.CROOKED_LINE="crookedLine"}(HichartRadialDataLabelsConnectorShape||(HichartRadialDataLabelsConnectorShape={}));class HichartRadialDataLabels extends HichartDataLabels{get alignTo(){return this._alignTo}set alignTo(e){if(e!==this._alignTo){const t=this._alignTo;this._alignTo=e,this._changed(HichartRadialDataLabels.PROP_ALIGN_TO,t,e)}}get distance(){return this._distance}set distance(e){if(e!==this._distance){const t=this._distance;this._distance=e,this._changed(HichartRadialDataLabels.PROP_DISTANCE,e,t)}}get connectorColor(){return this._connectorColor}set connectorColor(e){if(e!==this._connectorColor){const t=this._connectorColor;this._connectorColor=e,this._changed(HichartRadialDataLabels.PROP_CONNECTOR_COLOR,e,t)}}get connectorPadding(){return this._connectorPadding}set connectorPadding(e){if(e!==this._connectorPadding){const t=this._connectorPadding;this._connectorPadding=e,this._changed(HichartRadialDataLabels.PROP_CONNECTOR_PADDING,e,t)}}get connectorShape(){return this._connectorShape}set connectorShape(e){if(e!==this._connectorShape){const t=this._connectorShape;this._connectorShape=e,this._changed(HichartRadialDataLabels.PROP_CONNECTOR_SHAPE,e,t)}}get connectorWidth(){return this._connectorWidth}set connectorWidth(e){if(e!==this._connectorWidth){const t=this._connectorWidth;this._connectorWidth=e,this._changed(HichartRadialDataLabels.PROP_CONNECTOR_WIDTH,e,t)}}get crookDistance(){return this._crookDistance}set crookDistance(e){if(e!==this._crookDistance){const t=this._crookDistance;this._crookDistance=e,this._changed(HichartRadialDataLabels.PROP_CROOK_DISTANCE,e,t)}}_getEditProps(){return super._getEditProps().concat(HichartRadialDataLabels.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartRadialDataLabels.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartRadialDataLabels.PROPINFOS)}getWrappaer(){const e=super.getWrappaer();return this.assignProps(e,[HichartRadialDataLabels.PROP_ALIGN_TO,HichartRadialDataLabels.PROP_DISTANCE,HichartRadialDataLabels.PROP_CONNECTOR_COLOR,HichartRadialDataLabels.PROP_CONNECTOR_PADDING,HichartRadialDataLabels.PROP_CONNECTOR_SHAPE,HichartRadialDataLabels.PROP_CONNECTOR_WIDTH,HichartRadialDataLabels.PROP_CROOK_DISTANCE]),e}}HichartRadialDataLabels.PROP_ALIGN_TO="alignTo",HichartRadialDataLabels.PROP_DISTANCE="distance",HichartRadialDataLabels.PROP_CONNECTOR_COLOR="connectorColor",HichartRadialDataLabels.PROP_CONNECTOR_PADDING="connectorPadding",HichartRadialDataLabels.PROP_CONNECTOR_SHAPE="connectorShape",HichartRadialDataLabels.PROP_CONNECTOR_WIDTH="connectorWidth",HichartRadialDataLabels.PROP_CROOK_DISTANCE="crookDistance",HichartRadialDataLabels.PROPINFOS=[{name:HichartRadialDataLabels.PROP_ALIGN_TO,category:PropCategory.DATA_LABELS,type:EnumProperty,multiple:!1,domain:HichartRadialDataLabelsAlignTo,default:void 0},{name:HichartRadialDataLabels.PROP_DISTANCE,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!0,default:void 0},{name:HichartRadialDataLabels.PROP_CONNECTOR_COLOR,category:PropCategory.DATA_LABELS,type:ColorProperty,multiple:!0,default:void 0},{name:HichartRadialDataLabels.PROP_CONNECTOR_PADDING,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!0,default:void 0},{name:HichartRadialDataLabels.PROP_CONNECTOR_SHAPE,category:PropCategory.DATA_LABELS,type:EnumProperty,multiple:!0,default:void 0,domain:HichartRadialDataLabelsConnectorShape},{name:HichartRadialDataLabels.PROP_CONNECTOR_WIDTH,category:PropCategory.DATA_LABELS,type:NumberProperty,multiple:!0,default:void 0},{name:HichartRadialDataLabels.PROP_CROOK_DISTANCE,category:PropCategory.DATA_LABELS,type:StringProperty,multiple:!0,default:void 0}];class HichartSeries extends ChartSeries{constructor(e){super(e),this._showInLegend=!0}get color(){return this._color}set color(e){if(e!==this._color){const t=this._color;this._color=e,this._changed(HichartSeries.PROP_SERIES_COLOR,e,t)}}get colors(){return this._colors&&this._colors.slice(0)}set colors(e){if(e!==this._colors){const t=this._colors;this._colors=e&&e.slice(0),this._changed(HichartSeries.PROP_SERIES_COLORS,e,t)}}get colorByPoint(){return this._colorByPoint}set colorByPoint(e){e!==this._colorByPoint&&(this._colorByPoint=e,this._changed(HichartSeries.PROP_SERIES_COLOR_BY_POINT,e,!e))}get showInLegend(){return this._showInLegend}set showInLegend(e){e!==this._showInLegend&&(this._showInLegend=e,this._changed(HichartSeries.PROP_SERIES_SHOW_IN_LEGEND,e,!e))}canHideMarker(){return!1}wrap(e){return Utils.extend(e,{type:this.seriesType,name:this.name}),this.assignProps(e,[HichartSeries.PROP_SERIES_COLOR,HichartSeries.PROP_SERIES_COLORS,HichartSeries.PROP_SERIES_COLOR_BY_POINT,HichartSeries.PROP_SERIES_SHOW_IN_LEGEND]),e}get outlineParent(){return this.chart.series}_getEditProps(){return super._getEditProps().concat(HichartSeries.PROPINFOS)}getPropDomain(e){if(this.page){const t=this._getFieldProps();if(t&&t.length>0&&t.indexOf(e.name)>=0)return this.getDataFieldNames()}return super.getPropDomain(e)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartSeries.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartSeries.PROPINFOS)}getCollectionLabel(){return"hichartSeries"}canRemoveFrom(){return!0}getValues(e,t){const i=this.valueField;if(e.printing&&i){const r=this.data||this._getParentData();if(r){const s=this.chart.getParentBand();return s&&s.data===r&&s.containsInSection(this.chart)&&s.isDetail?t.getFieldValues(r,i,e.detailRows):t.getFieldValues(r,i)}}return this.values}_getFieldProps(){}_getValues(e,t,i){const r=this["_"+t+"Field"];if(e.printing&&r){const t=this.data||this._getParentData();if(t){const s=this.chart.getParentBand();return s&&s.containsInSection(this.chart)&&s.isDetail?i.getFieldValues(t,r,e.detailRows):i.getFieldValues(t,r)}}return this["_"+t+"Values"]}}HichartSeries.PROP_SERIES_COLOR="color",HichartSeries.PROP_SERIES_COLORS="colors",HichartSeries.PROP_SERIES_COLOR_BY_POINT="colorByPoint",HichartSeries.PROP_SERIES_SHOW_IN_LEGEND="showInLegend",HichartSeries.PROPINFOS=[{name:HichartSeries.PROP_SERIES_COLOR,category:PropCategory.SERIES,type:ColorProperty},{name:HichartSeries.PROP_SERIES_COLORS,category:PropCategory.SERIES,type:StringArrayProperty},{name:HichartSeries.PROP_SERIES_COLOR_BY_POINT,category:PropCategory.SERIES,type:BooleanProperty},{name:HichartSeries.PROP_SERIES_SHOW_IN_LEGEND,category:PropCategory.SERIES,type:BooleanProperty}];class HichartCartesianSeries extends HichartSeries{constructor(e){super(e),this._dataLabels=new HichartCartesianDataLabels(e)}get dataLabels(){return this._dataLabels}_getEditProps(){return super._getEditProps().concat(HichartCartesianSeries.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartCartesianSeries.PROPINFOS),this._loadObjects([this._dataLabels],e,t)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartCartesianSeries.PROPINFOS),this._saveObjects([this._dataLabels],e)}wrap(e){return super.wrap(e),Utils.extend(e,{dataLabels:this._dataLabels.getWrappaer()})}}HichartCartesianSeries.PROP_SERIES_DATA_LABELS="dataLabels",HichartCartesianSeries.PROPINFOS=[{name:HichartCartesianSeries.PROP_SERIES_DATA_LABELS,category:PropCategory.DATA_LABELS,type:ModelProperty,indented:!0,multiple:!1,default:void 0}];class HichartSeriesCollection extends ChartSeriesCollection{constructor(e){super(e)}getIds(e){const t=[];return this._series.forEach((i=>{i.id&&i.id!==e&&t.push(i.id)})),t}getCollectionLabel(){return"hichartSeries"}isCollectionProp(){return!1}_createSeries(e,t){return e.createHichartSeries(this.chart,t)}_seriesChanged(e){var t;null===(t=this.chart)||void 0===t||t.$_seriesChanged(e)}}!function(e){e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e.PROXIMATE="proximate"}(HichartLegendLayout||(HichartLegendLayout={}));class HichartLegend extends ChartObject{constructor(e){super(e),this._layout=HichartLegendLayout.HORIZONTAL,this._align=Align.CENTER,this._verticalAlign=VerticalAlign.BOTTOM}get align(){return this._align}set align(e){if(e!==this._align){const t=this._align;this._align=e,this._changed(HichartLegend.PROP_HICHART_ALIGN,e,t)}}get verticalAlign(){return this._verticalAlign}set verticalAlign(e){if(e!==this._verticalAlign){const t=this._verticalAlign;this._verticalAlign=e,this._changed(HichartLegend.PROP_HICHART_VERTICAL_ALIGN,e,t)}}get layout(){return this._layout}set layout(e){if(e!==this._layout){const t=this._layout;this._layout=e,this._changed(HichartLegend.PROP_HICHART_LAYOUT,e,t)}}get floating(){return this._floating}set floating(e){e!==this._floating&&(this._floating=e,this._changed(HichartLegend.PROP_HICHART_FLOATING,e,!e))}get x(){return this._x}set x(e){if(e!==this._x){const t=this._x;this._x=e,this._changed(HichartLegend.PROP_HICHART_X,e,t)}}get y(){return this._y}set y(e){if(e!==this._y){const t=this._y;this._y=e,this._changed(HichartLegend.PROP_HICHART_Y,e,t)}}get borderWidth(){return this._borderWidth}set borderWidth(e){if(e!==this._borderWidth){const t=this._borderWidth;this._borderWidth=e,this._changed(HichartLegend.PROP_HICHART_BORDER_WIDTH,e,t)}}get shadow(){return this._shadow}set shadow(e){e!==this._shadow&&(this._shadow=e,this._changed(HichartLegend.PROP_HICHART_SHADOW,e,!e))}getSaveLabel(){return"legend"}_isDefaultVisible(){return!1}_getEditProps(){return super._getEditProps().concat(HichartLegend.PROPINFOS)}_getStyleProps(){return["backgroundColor"]}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartLegend.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartLegend.PROPINFOS)}getWrapper(){const e=super.getWrapper();return this.assignProps(e,[HichartLegend.PROP_HICHART_ALIGN,HichartLegend.PROP_HICHART_VERTICAL_ALIGN,HichartLegend.PROP_HICHART_LAYOUT,HichartLegend.PROP_HICHART_FLOATING,HichartLegend.PROP_HICHART_X,HichartLegend.PROP_HICHART_Y,HichartLegend.PROP_HICHART_BORDER_WIDTH,HichartLegend.PROP_HICHART_SHADOW]),e.backgroundColor=this.getStyle("backgroundColor"),e}}HichartLegend.PROP_HICHART_ALIGN="align",HichartLegend.PROP_HICHART_VERTICAL_ALIGN="verticalAlign",HichartLegend.PROP_HICHART_LAYOUT="layout",HichartLegend.PROP_HICHART_FLOATING="floating",HichartLegend.PROP_HICHART_X="x",HichartLegend.PROP_HICHART_Y="y",HichartLegend.PROP_HICHART_BORDER_WIDTH="borderWidth",HichartLegend.PROP_HICHART_SHADOW="shadow",HichartLegend.PROPINFOS=[{name:HichartLegend.PROP_HICHART_ALIGN,category:PropCategory.LEGEND,type:EnumProperty,multiple:!1,default:void 0,domain:Align},{name:HichartLegend.PROP_HICHART_VERTICAL_ALIGN,category:PropCategory.LEGEND,type:EnumProperty,multiple:!1,default:void 0,domain:VerticalAlign},{name:HichartLegend.PROP_HICHART_LAYOUT,category:PropCategory.LEGEND,type:EnumProperty,multiple:!1,default:void 0,domain:HichartLegendLayout},{name:HichartLegend.PROP_HICHART_FLOATING,category:PropCategory.LEGEND,type:BooleanProperty,multiple:!1,default:void 0},{name:HichartLegend.PROP_HICHART_X,category:PropCategory.LEGEND,type:NumberProperty,multiple:!1,default:void 0},{name:HichartLegend.PROP_HICHART_Y,category:PropCategory.LEGEND,type:NumberProperty,multiple:!1,default:void 0},{name:HichartLegend.PROP_HICHART_BORDER_WIDTH,category:PropCategory.LEGEND,type:NumberProperty,multiple:!1,default:void 0},{name:HichartLegend.PROP_HICHART_SHADOW,category:PropCategory.LEGEND,type:BooleanProperty,multiple:!1,default:void 0}];class HichartSeriesMarker extends ChartObject{constructor(e){super(e.chart),this._series=e}get symbol(){return this._symbol}set symbol(e){if(e!==this._symbol){const t=this._symbol;this._symbol=e,this._changed(HichartSeriesMarker.PROP_SYMBOL,e,t)}}get fillColor(){return this._fillColor}set fillColor(e){if(e!==this._fillColor){const t=this._fillColor;this._fillColor=e,this._changed(HichartSeriesMarker.PROP_FILL_COLOR,e,t)}}canHide(){return this._series.canHideMarker()}getWrapper(){return this._getPropsWrapper({},null,{visible:"enabled"})}_getEditProps(){return super._getEditProps().concat(HichartSeriesMarker.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartSeriesMarker.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartSeriesMarker.PROPINFOS)}}HichartSeriesMarker.PROP_SYMBOL="symbol",HichartSeriesMarker.PROP_FILL_COLOR="fillColor",HichartSeriesMarker.PROPINFOS=[{name:HichartSeriesMarker.PROP_SYMBOL,category:"marker",type:EnumProperty,indented:!0,multiple:!1,default:void 0,domain:HichartMarkerSymbol},{name:HichartSeriesMarker.PROP_FILL_COLOR,category:"marker",type:ColorProperty,multiple:!0,default:void 0}];class RemoveHichartSeriesCommand extends EditCommand{constructor(e){super("Remove HichartSeries"),assert(!!e),this._series=e,this._chart=e.chart,assert(!!e),this._index=this._chart.series.indexOf(e)}_doDispose(){this._chart=this._series=null}get chart(){return this._chart}get series(){return this._series}get index(){return this._index}redo(e){this._chart.removeSeries(this._series)}undo(){this._chart.addSeries(this._series,this._index)}get source(){return this._series}}class AddHichartSeriesCommand extends EditCommand{constructor(e,t){super("Remove HichartSeries"),assert(!!e),this._chart=e,this._seriesType=t}_doDispose(){this._chart=this._series=null}get chart(){return this._chart}get series(){return this._series}redo(e){this._series=this._chart.addSeries(this._seriesType)}undo(){this._chart.removeSeries(this._series)}get source(){return this._series||this._chart}}class RemoveHichartPlotLineCommand extends EditCommand{constructor(e){super("Remove HichartAxis PlotLine"),assert(!!e),this._axis=e.collection.axis,this._line=e,this._index=this._axis.plotLines.indexOf(e)}_doDispose(){this._axis=this._line=null}get axis(){return this._axis}get line(){return this._line}redo(e){this._axis.plotLines.remove(this._line)}undo(){this._axis.plotLines.add(this._line,this._index)}get source(){return this._axis.plotLines}}class AddHichartPlotLineCommand extends EditCommand{constructor(e,t){super("Add HichartAxis Plot Line"),assert(!!e),this._axis=e,this._config=t}_doDispose(){this._axis=this._config=null}get axis(){return this._axis}get line(){return this._line}redo(e){this._line=this._axis.plotLines.add(this._config)}undo(){this._axis.plotLines.remove(this._line)}get source(){return this._axis.plotLines}}class RemoveHichartPlotBandCommand extends EditCommand{constructor(e){super("Remove HichartAxis PlotBand"),assert(!!e),this._axis=e.collection.axis,this._band=e,this._index=this._axis.plotBands.indexOf(e)}_doDispose(){this._axis=this._band=null}get axis(){return this._axis}get band(){return this._band}redo(e){this._axis.plotBands.remove(this._band)}undo(){this._axis.plotBands.add(this._band,this._index)}get source(){return this._axis.plotBands}}class AddHichartPlotBandCommand extends EditCommand{constructor(e,t){super("Add HichartAxis Plot Band"),assert(!!e),this._axis=e,this._config=t}_doDispose(){this._axis=this._config=null}get axis(){return this._axis}get band(){return this._band}redo(e){this._band=this._axis.plotBands.add(this._config)}undo(){this._axis.plotBands.remove(this._band)}get source(){return this._axis.plotBands}}!function(e){e.SUM="sum",e.AVG="avg",e.MIN="min",e.MAX="max",e.COUNT="count",e.DISTINCT="distinct"}(CrosstabSummary||(CrosstabSummary={}));const comparers={text:(e,t,i,r)=>Utils.compareText(e.getRowValue(i,t),e.getRowValue(r,t)),number:(e,t,i,r)=>Utils.toNumber(e.getRowValue(i,t),Number.MIN_VALUE)-Utils.toNumber(e.getRowValue(r,t),Number.MIN_VALUE),bool:(e,t,i,r)=>(e.getRowValue(i,t)?1:0)-(e.getRowValue(i,t)?1:0)};class CrosstabFieldHeader extends ReportItem{constructor(e,t){super(""),this._field=e,t&&this.load(null,t)}get field(){return this._field}get suffix(){return this._suffix}set suffix(e){if(e!==this._suffix){const t=this._suffix;this._suffix=e,this._changed(CrosstabFieldHeader.PROP_SUFFIX,e,t)}}get page(){return this._field.page}get outlineSource(){return this._field}_getEditProps(){return CrosstabFieldHeader.PROPINFOS}_getStyleProps(){return["background","backgroundColor","color","fontSize","fontWeight"]}getSaveLabel(){return"header"}_doLoad(e,t){this._loadPropsOf(t,CrosstabFieldHeader.PROPINFOS),this._loadProps(t,"styles")}_doSave(e){this._savePropsOf(e,CrosstabFieldHeader.PROPINFOS),this._saveProp(e,"styles")}}CrosstabFieldHeader.PROP_SUFFIX="suffix",CrosstabFieldHeader.PROPINFOS=[{name:CrosstabFieldHeader.PROP_SUFFIX,category:"fieldHeader",type:StringProperty}];class CrosstabFieldSummaryHeader extends ReportItem{constructor(e,t){super(""),this._summary=e,t&&this.load(null,t)}get summary(){return this._summary}get field(){return this._summary.field}get text(){return this._text}set text(e){if(e!==this._text){const t=this._text;this._text=e,this._changed(CrosstabFieldSummaryHeader.PROP_TEXT,e,t)}}get page(){return this._summary.page}get outlineSource(){return this._summary.field}_getEditProps(){return CrosstabFieldSummaryHeader.PROPINFOS}_getStyleProps(){return["background","backgroundColor","color","fontSize","fontWeight"]}getSaveLabel(){return"header"}_doLoad(e,t){this._loadPropsOf(t,CrosstabFieldSummaryHeader.PROPINFOS),this._loadProps(t,"styles")}_doSave(e){this._savePropsOf(e,CrosstabFieldSummaryHeader.PROPINFOS),this._saveProp(e,"styles")}}CrosstabFieldSummaryHeader.PROP_TEXT="text",CrosstabFieldSummaryHeader.PROPINFOS=[{name:CrosstabFieldSummaryHeader.PROP_TEXT,category:"fieldSummryHeader",type:StringProperty}];class CrosstabFieldSummary extends ReportItem{constructor(e,t){super(""),this._field=e,this._header=new CrosstabFieldSummaryHeader(this,t&&t.header),t&&this.load(null,t)}get field(){return this._field}get header(){return this._header}get page(){return this._field.page}get outlineSource(){return this._field}_getEditProps(){return CrosstabFieldSummary.PROPINFOS}_getStyleProps(){return["background","backgroundColor","color","fontSize","fontWeight"]}getSaveLabel(){return"summary"}_doLoad(e,t){this._loadPropsOf(t,CrosstabFieldSummary.PROPINFOS),this._loadProps(t,"styles")}_doSave(e){this._savePropsOf(e,CrosstabFieldSummary.PROPINFOS),this._saveObject(this._header,e),this._saveProp(e,"styles")}}CrosstabFieldSummary.PROPINFOS=[{name:ReportItem.PROP_VISIBLE,category:"fieldSummary",type:BooleanProperty,default:!0}];class CrosstabField extends ReportItemCollectionItem{constructor(e,t){super(e,t),this._index=-1,this.fieldIndex=-1,this._header=new CrosstabFieldHeader(this,t.header),this._summary=new CrosstabFieldSummary(this,t.summary)}get band(){return this.collection.band}get index(){return this._index}get field(){return this._field}set field(e){if(e!==this._field){const t=this._field;this._field=e,this._changed(CrosstabField.PROP_FIELD,e,t)}}get header(){return this._header}get summary(){return this._summary}get itemType(){return"CrosstabField"}get page(){var e;return null===(e=this.collection)||void 0===e?void 0:e.page}get displayPath(){return this.collection?this.collection.displayPath+"["+this.index+"]":Utils.uncapitalize(this.itemType)}get collection(){return super.collection}get marqueeParent(){var e;return null===(e=this.collection)||void 0===e?void 0:e.band}isAncestor(e){return e===this.collection.band}getEditProps(){return CrosstabField.PROPINFOS}_getStyleProps(){return CrosstabField.styleProps}_changed(e,t,i){this.collection&&this.collection._fieldChanged(this)}_doLoad(e){this._loadPropsOf(e,CrosstabField.PROPINFOS),super._doLoad(e)}_doSave(e){return this._savePropsOf(e,CrosstabField.PROPINFOS),super._doSave(e),this._saveObject(this._header,e),this._saveObject(this._summary,e),e}}CrosstabField.PROP_FIELD="field",CrosstabField.PROPINFOS=[{name:CrosstabField.PROP_FIELD,category:PropCategory.FIELD,type:StringProperty}],CrosstabField.styleProps=[];class CrosstabFieldCollection extends ReportItemCollection{constructor(e,t){super(),this._fields=[],this._band=e,this._type=t}get band(){return this._band}load(e){if(this._fields=[],e&&e.length>0)for(let t of e)this.$_add(t,Number.MAX_SAFE_INTEGER);this._resetFields()}save(e){this._fields.forEach((t=>e.push(t.save({}))))}contains(e){return!!this.getField(e)}getField(e){return this._fields.find((t=>t.field===e))}slice(e){return this._fields.slice(0,e)}indexOf(e){return this._fields.indexOf(e)}add(e,t=-1){t=t<0?this._fields.length:t;const i=this.$_add(e,t);return i&&(this._resetFields(),this._itemAdded(i)),i}removeAt(e){if(e>=0&&e<this._fields.length){const t=this._fields.splice(e,1)[0];return this._resetFields(),this._itemRemoved(t,this._band),!0}}remove(e){this.removeAt(this.indexOf(e))}get owner(){return this._band}get count(){return this._fields.length}get items(){return this._fields}get outlineLabel(){return`[${Utils.capitalize(this._type)}]`}get outlineParent(){return this._band}get outlineExpandable(){return!0}get outlineItems(){return this._fields.forEach(((e,t)=>e.outlineOrder=t)),this._fields}get page(){var e;return null===(e=this._band)||void 0===e?void 0:e.page}get displayPath(){return this._band?this._band.displayPath+"."+this._type:this._type}get level(){return this._band?this._band.level+1:0}get(e){return this._fields[e]}getSaveType(){return this._type}$_add(e,t){const i=e instanceof CrosstabField?e:this._createField(e);return this._fields.splice(Math.min(t,this._fields.length),0,i),i}_doMoveItem(e,t){return!1}_resetFields(){this._fields.forEach(((e,t)=>{e._parent=this,e._index=t})),this._fieldChanged(null)}_fieldChanged(e){this._band._fieldsChanged(e)}}class CrosstabRowField extends CrosstabField{get itemType(){return"RowField"}getCollectionLabel(){return"rowField"}}class CrosstabRowFieldCollection extends CrosstabFieldCollection{constructor(e){super(e,"rowFields")}_createField(e){return new CrosstabRowField(this,e)}}class CrosstabColumnField extends CrosstabField{constructor(e,t){super(e,t)}get itemType(){return"ColumnField"}getCollectionLabel(){return"columnField"}_doLoad(e){super._doLoad(e)}_doSave(e){return super._doSave(e),e}}class CrosstabColumnFieldCollection extends CrosstabFieldCollection{constructor(e){super(e,"columnFields")}_createField(e){return new CrosstabColumnField(this,e)}}class CrosstabValueField extends CrosstabField{constructor(e,t){super(e,t),this._value=this._value||CrosstabSummary.SUM}get value(){return this._value}set value(e){if(e!==this._value){const t=this._value;this._value=e,this._changed(CrosstabValueField.PROP_VALUE,e,t)}}get itemType(){return"ValueField"}getCollectionLabel(){return"valueField"}getEditProps(){return super.getEditProps().concat(CrosstabValueField.PROPINFOS)}_doLoad(e){super._doLoad(e),this._loadPropsOf(e,CrosstabValueField.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,CrosstabValueField.PROPINFOS)}}CrosstabValueField.PROP_VALUE="value",CrosstabValueField.PROPINFOS=[{name:CrosstabValueField.PROP_VALUE,category:PropCategory.FIELD,type:EnumProperty,domain:CrosstabSummary,default:CrosstabSummary.SUM}];class CrosstabValueFieldCollection extends CrosstabFieldCollection{constructor(e){super(e,"valueFields")}_createField(e){return new CrosstabValueField(this,e)}}class CrosstabRec{constructor(e,t){this.sum=(e,t)=>{let i=0;for(let r of this._rows)i+=e.getRowValue(r,t);return i},this.count=(e,t)=>this._rows.length,this.min=(e,t)=>{const i=this._rows;let r=e.getRowValue(i[0],t);for(let s=i.length-1;s>0;s--)r=Math.min(r,e.getRowValue(i[s],t));return r},this.max=(e,t)=>{const i=this._rows;let r=e.getRowValue(i[0],t);for(let s=i.length-1;s>0;s--)r=Math.max(r,e.getRowValue(i[s],t));return r},this.avg=(e,t)=>{let i=0;for(let r of this._rows)i+=e.getRowValue(r,t);return i/this._rows.length},this._keys=e.slice(0),this._rows=t.slice(0)}get rowCount(){return this._rows.length}getKey(e){return this._keys[e]}getSummary(e,t,i){return this[i](e,t)}}class RecCollection{constructor(e){this._recs=[],this._band=e}get count(){return this._recs.length}getKey(e,t){return this._recs[e].getKey(t)}getRec(e){return this._recs[e]}getRecs(e=0,t=Number.MAX_SAFE_INTEGER){return this._recs.slice(Math.max(0,e),t)}setFilters(e){this._filters=e&&e.length>0?e.slice(0):null}build(e){const t=this._band.getGroupFields();t.forEach((t=>{t.fieldIndex=e.getFieldIndex(t.field),t.dataType=e.getField(t.fieldIndex).dataType})),this._recs=[];const i=this.$_collectRows(e);this.$_sortRows(e,i,t),this.$_buildRecs(e,i,t)}$_collectRows(e){const t=t=>{for(let i of this._filters)if(!i.select(e,t))return!1;return!0},i=[];if(this._filters)for(let r=0;r<e.rowCount;r++)t(r)&&i.push(r);else for(let t=0;t<e.rowCount;t++)i.push(t);return i}$_sortRows(e,t,i){t.sort(((t,r)=>{let s=!1,n=0;for(let o=0,a=i.length;o<a;o++){const A=i[o].fieldIndex;if(n=comparers[e.getField(A).dataType](e,A,t,r),0!==n){s=a===o+1;break}}return n=0===n&&s?t-r:n,n}))}$_buildRecs(e,t,i){const r=[];let s=0,n=t[s++];const o=[n];for(let t=0;t<i.length;t++)r[t]=e.getRowValue(n,i[t].fieldIndex);for(;s<t.length;){let a=!1;n=t[s];for(let t=0;t<i.length;t++)if(r[t]!=e.getRowValue(n,i[t].fieldIndex)){a=!0;break}if(a){this._recs.push(new CrosstabRec(r,o)),o.length=0;for(let t=0;t<i.length;t++)r[t]=e.getRowValue(n,i[t].fieldIndex)}o.push(n),s++}o.length>0&&this._recs.push(new CrosstabRec(r,o))}}let _hash_=0;class CrosstabColumn{constructor(e,t){this.hash=_hash_++,this._children=[],this._field=e,this._value=t}get field(){return this._field}get value(){return this._value}get count(){return this._children.length}get children(){return this._children.slice(0)}get level(){return this.parent?this.parent.level+1:-1}get isLeaf(){return 0===this._children.length}get leafCount(){return this._children.length*this._children[0].leafCount}getChild(e){return this._children[e]}clear(){this._children=[]}add(e,t=!1){e&&(t||this._children.indexOf(e)<0)&&(this._children.push(e),e.parent=this)}addSummary(e){this._children.unshift(e),e.parent=this}sort(){if(this._children.length>1){const e="bool"===this._children[0].field.dataType;this._children=this._children.sort(((t,i)=>e?(t.value?1:0)-(i.value?1:0):t.value-i.value))}}getHeader(){const e=this._field.header;let t=this._value;return e.suffix&&(t+=e.suffix),t}}class CrosstabRootColumn extends CrosstabColumn{constructor(){super(null,null)}}class CrosstabLeafColumn extends CrosstabColumn{constructor(e,t,i){super(e,i),this._valueField=t}get valueField(){return this._valueField}get leafCount(){return 1}getHeader(){const e=this._valueField.header;let t=this._valueField.field;return e.suffix&&(t+=e.suffix),t}}class CrosstabSummaryColumn extends CrosstabColumn{constructor(e){super(e.field,void 0)}get summary(){return this._summary}getHeader(){return this._field.summary.header.text||"요약"}}class CrosstabSummaryLeafColumn extends CrosstabLeafColumn{constructor(e,t,i){super(e.field,t,i)}getHeader(){return this._valueField.summary.header.text||this._valueField.field}}class ColumnCollection{constructor(e){this._root=new CrosstabRootColumn,this._leafs=[],this._band=e}get root(){return this._root}get count(){return this._root.count}get leafCount(){return this._leafs.length}get levels(){return this._leafs.length>0?this._leafs[0].level+1:0}build(e){this._root.clear(),this._leafs=[],this._band.columnFields.count>0&&this.$_collectColumns(e,this._root,0)}get(e){return this._root.getChild(e)}getLeaf(e){return this._leafs[e]}getColumns(e,t){t.push([])}$_collectColumns(e,t,i){const r=this._band,s=r.rowFields,n=r.columnFields,o=r.valueFields,a=r.getColumnField(i),A=s.count+i,l=i==n.count-1,h=e.count,d={};if(!(t instanceof CrosstabSummaryColumn))for(let i=0;i<h;i++){const r=e.getKey(i,A);let s=d[r];s||(s=new CrosstabColumn(a,r),t.add(s,!0),d[r]=s),t.add(s)}t.sort();const c=n.get(i);if(c.summary.visible){const e=new CrosstabSummaryColumn(c.summary);t.addSummary(e)}for(let r of t.children)if(l)for(let e=0;e<o.count;e++){const t=o.get(e),i=r.value,s=r instanceof CrosstabSummaryColumn?new CrosstabSummaryLeafColumn(r.field.summary,t,i):new CrosstabLeafColumn(r.field,t,i);r.add(s,!0),this._leafs.push(s)}else this.$_collectColumns(e,r,i+1)}}class CrosstabRowBase{}class CrosstabRow extends CrosstabRowBase{constructor(e,t,i){if(super(),this._map={},this._values=t.slice(0),this._recs=i.slice(0),i){const t=e.rowFields.count,r=e._columns._leafs;for(let e of r){const r=i[e.hash-t],s=t+e.field.index;if(r&&r.getKey(s)===e.value)this._map[e.hash]=r;else for(let t of i)if(t.getKey(s)===e.value){this._map[e.hash]=t;break}}}}slice(e){return this._values.slice(0,e)}getRec(e){return this._recs[e]}getValue(e){return this._values[e]}getColumnRec(e){return this._map[e.hash]}getSummary(e,t,i,r){}}class CrosstabSummaryRow extends CrosstabRowBase{constructor(e,t){super(),this._fields=e,this._rows=t.slice(0)}get fields(){return this._fields}slice(e){return this._rows[0].slice(e)}getValue(e){return e>=this._fields.length-1?this._rows[0].getValue(this._fields.length-1):this._rows[0].getValue(e)}getColumnRec(e){return this._rows[0].getColumnRec(e)}}class CrosstabTotalRow extends CrosstabRowBase{constructor(e){super(),this._rows=e}slice(e){return[]}getValue(e){return"전체 요약"}getColumnRec(e){}}class RowCollection{constructor(e){this._rows=[],this._band=e}get rowCount(){return this._rows.length}getRow(e){return this._rows[e]}build(e,t){this._rows=[],this._band.columnFields.count>0&&t.count>0&&(this.$_collectRows(e,t),this._rows.unshift(new CrosstabTotalRow(this._rows)))}$_collectRows(e,t){const i=this._band,r=i.rowFields,s=t.count,n=[],o=[];let a=[],A=[],l=[],h=0;for(r.forEach(((i,r)=>{n.push(e.getFieldByName(i.field)),A.push(t.getKey(h,r))})),o.push(t.getRec(h++));h<s;){const e=t.getRec(h);let s=!1;for(let t=0;t<r.count;t++)l[t]=e.getKey(t);for(let e=0;e<r.count;e++)if(l[e]!==A[e]){s=!0;break}s&&(a.push(new CrosstabRow(i,A,o)),o.length=0,A=l.slice(0)),o.push(e),h++}a.push(new CrosstabRow(i,A,o));for(let e=r.count-2;e>=0;e--)a=this.$_collectSummaryRows(a,r.slice(e+1));this._rows=a}$_collectSummaryRows(e,t){const i=e.length,r=t.length,s=[];let n,o,a,A=0,l=0,h=e[l],d=[];for(n=e[l].slice(r);l<i;){let i=!1;h=e[l],o=h.slice(r);for(let e=0;e<r;e++)if(o[e]!==n[e]){i=!0;break}i&&(a=new CrosstabSummaryRow(t,d),s.push({row:a,start:A,end:l}),d.length=0,n=o,A=l),h instanceof CrosstabRow&&d.push(h),l++}a=new CrosstabSummaryRow(t,d),s.push({row:a,start:A,end:l});const c=[];for(let t of s){c.push(t.row);for(let i=t.start;i<t.end;i++)c.push(e[i])}return c}}class CrosstabBandTitle extends ReportItem{constructor(e){super(null),this._band=e}get text(){return this._text}set text(e){if(e!==this._text){const t=this._text;this._text=e,this._changed(CrosstabBandTitle.PROP_TEXT,e,t)}}_getEditProps(){return[].concat(CrosstabBandTitle.PROPINFOS)}_getStyleProps(){return CrosstabBandTitle.styleProps}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,CrosstabBandTitle.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,CrosstabBandTitle.PROPINFOS)}}CrosstabBandTitle.PROP_TEXT="text",CrosstabBandTitle.PROPINFOS=[{name:CrosstabBandTitle.PROP_TEXT,category:PropCategory.TITLE,type:StringProperty}],CrosstabBandTitle.styleProps=["background","backgroundColor","color","fontSize","fontWeight","fontFamily"];class CrosstabNullValue extends ReportItem{constructor(e){super(null),this._text="0",this._band=e}get text(){return this._text}set text(e){if(e!==this._text){const t=this._text;this._text=e,this._changed(CrosstabNullValue.PROP_TEXT,e,t)}}_getEditProps(){return[].concat(CrosstabNullValue.PROPINFOS)}_getStyleProps(){return CrosstabNullValue.styleProps}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,CrosstabNullValue.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,CrosstabNullValue.PROPINFOS)}}CrosstabNullValue.PROP_TEXT="text",CrosstabNullValue.PROPINFOS=[{name:CrosstabNullValue.PROP_TEXT,category:"nullValue",type:StringProperty}],CrosstabNullValue.styleProps=["background","backgroundColor","color","fontSize","fontWeight","fontFamily"];class CrosstabBand extends ReportGroupItem{constructor(e){super(e),this._recs=new RecCollection(this),this._columns=new ColumnCollection(this),this._rows=new RowCollection(this),this.pageNo=0,this.rowIndex=NaN,this._calcSummary={sum:e=>{let t=0;for(let i of e)t+=i;return t},count:e=>{let t=0;for(let i of e)t+=i;return t},avg:e=>{let t=0;for(let i of e)t+=i;return t/e.length},min:e=>{let t=e[0];for(let i=1;i<e.length;i++)t=Math.min(t,e[i]);return t},max:e=>{let t=e[0];for(let i=1;i<e.length;i++)t=Math.max(t,e[i]);return t}},this._title=new CrosstabBandTitle(this),this._nullValue=new CrosstabNullValue(this),this._rowFields=new CrosstabRowFieldCollection(this),this._columnFields=new CrosstabColumnFieldCollection(this),this._valueFields=new CrosstabValueFieldCollection(this),this.width="100%"}static isFieldCell(e){return e instanceof CrosstabField||e instanceof CrosstabFieldHeader||e instanceof CrosstabFieldSummary||e instanceof CrosstabFieldSummaryHeader}static getFieldOf(e){return e instanceof CrosstabField?e:e.field}static getBandOf(e){return this.getFieldOf(e).band}get maxRowCount(){return this._maxRowCount}set maxRowCount(e){if(isNaN(e)?e=void 0:e>>=0,e!==this._maxRowCount){const t=this._maxRowCount;this._maxRowCount=e,this._changed(CrosstabBand.PROP_MAX_ROW_COUNT,e,t)}}get title(){return this._title}get nullValue(){return this._nullValue}get rowFields(){return this._rowFields}get columnFields(){return this._columnFields}get valueFields(){return this._valueFields}get rows(){return this._rows}get bandData(){return this.page.report.data.get(this.data)}get columnLevels(){return this._columns.levels}containsField(e){return this._rowFields.contains(e)||this._columnFields.contains(e)||this._valueFields.contains(e)}getRowField(e){return this._rowFields.get(e)}getColumnField(e){return this._columnFields.get(e)}getGroupFields(){return[].concat(this._rowFields.items,this._columnFields.items)}build(){var e;const t=null===(e=this.page)||void 0===e?void 0:e.report.data;if(t){const e=t.get(this.data);if(!e)return;for(let e of this._rowFields.items);for(let e of this._columnFields.items);for(let t of this._valueFields.items)t.fieldIndex=e.getFieldIndex(t.field);this._recs.build(e),this._columns.build(this._recs),this._rows.build(e,this._recs)}}getCellValue(e,t,i){if(e){const r=this._rows.getRow(t),s=this._columns.getLeaf(i),n=s.valueField.fieldIndex,o=s.valueField.value;if(r instanceof CrosstabTotalRow||r instanceof CrosstabSummaryRow){const t=r._rows;if(s instanceof CrosstabSummaryLeafColumn){let i=[];return t.forEach((t=>{if(t instanceof CrosstabRow){t._recs.forEach((t=>{i.push(t.getSummary(e,n,o))}))}})),this._calcSummary[o](i)}{let i=[];return t.forEach((t=>{if(t instanceof CrosstabRow){const r=t.getColumnRec(s),o=s.valueField.value;i.push(r?r.getSummary(e,n,o):0)}})),this._calcSummary[o](i)}}if(r instanceof CrosstabRow){if(s instanceof CrosstabSummaryLeafColumn){const t=r._recs;let i=[];return t.forEach((t=>{i.push(t.getSummary(e,n,o))})),this._calcSummary[o](i)}{const t=r.getColumnRec(s);return t?t.getSummary(e,n,o):NaN}}}}getSaveType(){return"crosstab"}get outlineLabel(){return"[Crosstab Band]"}get outlineItems(){return[this._rowFields,this._columnFields,this._valueFields].concat(super.outlineItems)}get isBand(){return!0}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(CrosstabBand.PROPINFOS)}isAncestorOf(e){return super.isAncestorOf(e)||e===this._rowFields||e===this._columnFields||e===this._valueFields}_doLoad(e,t){super._doLoad(e,t),t&&(["row","column","value"].forEach((e=>{const i=`${e}Fields`;t.hasOwnProperty(i)&&this[`_${i}`].load(t[i])})),this._title.load(null,t.title),this._nullValue.load(null,t.nullValue))}_doSave(e){super._doSave(e),this._title.save(e.title={}),this._nullValue.save(e.nullValue={}),["row","column","value"].forEach((t=>{const i=`${t}Fields`;this[`_${i}`].save(e[i]=[])}))}_fieldsChanged(e){var t;null===(t=this.page)||void 0===t||t.$_itemChanged(this,"field",e,e)}}CrosstabBand.PROP_TITLE="title",CrosstabBand.PROP_NULL_VALUE="nullValue",CrosstabBand.PROP_MAX_ROW_COUNT="maxRowCount",CrosstabBand.PROPINFOS=[{name:CrosstabBand.PROP_TITLE,category:PropCategory.TITLE,type:ModelProperty,indented:!0},{name:CrosstabBand.PROP_NULL_VALUE,category:"nullValue",type:ModelProperty,indented:!0},{name:CrosstabBand.PROP_MAX_ROW_COUNT,category:PropCategory.DATA,type:NumberProperty}],CrosstabBand.$_ctor="CrosstabBand";class AddCrosstabFieldCommand extends EditCommand{constructor(e,t,i){super("Add Crosstab Field"),assert(!!e),this._collection=e,this._index=t,this._config=i}_doDispose(){this._collection=this._field=null}get band(){return this._collection.band}get collection(){return this._collection}get index(){return this._index}redo(e){this._field=this._collection.add(this._config,this._index)}undo(){this._collection.remove(this._field)}get source(){return this._field}}class RemoveCrosstabFieldCommand extends EditCommand{constructor(e){super("Remove Crosstab Field"),assert(!!e),this._field=e,this._collection=e.collection,this._index=e.index}_doDispose(){this._field=null}get band(){return this._field.band}get collection(){return this._collection}get field(){return this._field}get index(){return this._index}redo(e){this._collection.removeAt(this._index)}undo(){this._collection.add(this._field,this._index)}get source(){return this._field}}class RemoveItemCommand extends EditCommand{constructor(e){super("Remove Item"),assert(!!e),this._parent=e.outlineParent instanceof CellGroup?e.outlineParent.outlineParent:e.outlineParent,assert(!!this._parent),this._item=e,this._index=this._parent.indexOf(e)}static createCommands(e){if(e&&e.length>0){const t=[];for(let i of e)if(i&&i.canRemoveFrom()){let e;i instanceof TableRow?e=new RemoveTableRowCommand(i):i instanceof TableBandColumn?e=new RemoveTableBandColumnCommand(i):i instanceof TableColumn?e=new RemoveTableColumnCommand(i):i instanceof HichartSeries?e=new RemoveHichartSeriesCommand(i):i instanceof HichartAxisPlotLine?e=new RemoveHichartPlotLineCommand(i):i instanceof HichartAxisPlotBand?e=new RemoveHichartPlotBandCommand(i):i instanceof ReportItem?e=new RemoveItemCommand(i):i instanceof CrosstabField&&(e=new RemoveCrosstabFieldCommand(i)),e&&t.push(e)}return t.length>0?t:null}}_doDispose(){this._parent=this._item=null}get parent(){return this._parent}get item(){return this._item}get index(){return this._index}undo(){this._parent.add(this._item,this._index)}redo(e){this._parent.remove(this._item)}get source(){return this._item}}class RemoveItemsCommand extends EditCommandGroup{constructor(e){super("Remove Items",RemoveItemCommand.createCommands(e))}}class ReportPage extends ReportGroupItem{constructor(e){super("reportPage"),this._events=new EventAware,this._nameMap={},this._loading=!1,this._removing=!1,this._report=e,this.add(this._reportHeader=new ReportHeader),this.add(this._reportFooter=new ReportFooter),this.add(this._pageHeader=new PageHeader),this.add(this._pageFooter=new PageFooter),this.add(this._body=new PageBody),this.add(this._backItems=new PageItemContainer("pageBackItems","Back Items")),this.add(this._frontItems=new PageItemContainer("pageFrontItems","Front Items")),this._sections=[this._pageHeader,this._reportHeader,this._body,this._backItems,this._frontItems,this._reportFooter,this._pageFooter]}addListener(e){return this._events.addListener(e)}removeListener(e){return this._events.removeListener(e)}get report(){return this._report}get reportHeader(){return this._reportHeader}get reportFooter(){return this._reportFooter}get pageHeader(){return this._pageHeader}get pageFooter(){return this._pageFooter}get body(){return this._body}get backContainer(){return this._backItems}get backItems(){return this._backItems.items}get frontContainer(){return this._frontItems}get frontItems(){return this._frontItems.items}get loading(){return this._loading}getItem(e){return this._nameMap[e]}removeItems(e,t){if(!(t=t&&t.filter((e=>e.canRemoveFrom())))||0==t.length)return 0;const i=t.sort(((e,t)=>e.level-t.level));for(let e=i.length-1;e>0;e--){const t=i[e];for(let r=e+1;r>=0;r--){const s=i[r];if(s instanceof ReportGroupItem&&t instanceof ReportItem&&t.isAncestor(s)){i.splice(e,1);break}}}try{e?e.execute(new RemoveItemsCommand(i)):new RemoveItemsCommand(i).run()}finally{}}search(e,t,i){t.caseSensitive||(e=e.toLowerCase()),this._sections.forEach((r=>r.search(e,t,i)))}get outlineLabel(){return"Page"}get pathLabel(){return"page"}get page(){return this}canMove(){return!1}getEditProps(){return[]}_getStyleProps(){return["fontFamily","fontSize","fontWeight","color","backgroundColor"]}canDelete(){return!1}_doLoad(e,t){this._loading=!0;try{this._loadProps(t,"styles"),t.hasOwnProperty("reportHeader")&&this._reportHeader.load(e,t.reportHeader),t.hasOwnProperty("reportFooter")&&this._reportFooter.load(e,t.reportFooter),t.hasOwnProperty("pageHeader")&&this._pageHeader.load(e,t.pageHeader),t.hasOwnProperty("pageFooter")&&this._pageFooter.load(e,t.pageFooter),t.hasOwnProperty("body")&&this._body.load(e,t.body),t.hasOwnProperty("backItems")&&this._backItems.load(e,t.backItems),t.hasOwnProperty("frontItems")&&this._frontItems.load(e,t.frontItems)}finally{this._loading=!1}}_ignoreItems(){return!0}_doSave(e){let t;this._pageHeader.save(t={})&&(e.pageHeader=t),this._reportHeader.save(t={})&&(e.reportHeader=t),this._reportFooter.save(t={})&&(e.reportFooter=t),this._pageFooter.save(t={})&&(e.pageFooter=t),this._body.save(t={})&&(e.body=t),this._backItems.count>0&&this._backItems.save(e.backItems=[]),this._frontItems.count>0&&this._frontItems.save(e.frontItems=[])}canResize(e){return!1}getAllItems(e,t=!1){if(e)return e.getDescendants(t);{let e=[];return this._sections.forEach((i=>e=e.concat(i.getDescendants(t)))),e}}collectInvalids(e,t){this._sections.forEach((i=>i.collectInvalids(e,t)))}$_itemAdded(e,t,i){this.$_addItem(e),this._fireItemAdded(e,t,i)}$_addItem(e){if(e instanceof ReportItem&&e.name&&(this._nameMap[e.name]=e),e instanceof ReportGroupItem)for(let t of e._items)this.$_addItem(t)}$_itemsAdded(e,t){e.forEach((e=>this.$_addItem(e))),this._fireItemsAdded(e,t)}$_itemRemoved(e,t){this.$_removeItem(e),this._removing||this._fireItemRemoved(e,t)}$_removeItem(e){if(e instanceof ReportItem&&e.name&&delete this._nameMap[e.name],e instanceof ReportGroupItem)for(let t of e._items)this.$_removeItem(t)}$_itemsRemoved(e){for(let t of e)this.$_removeItem(t);this._removing||this._fireItemsRemoved(e)}$_itemChanged(e,t,i,r){this._fireItemChanged(e,t,i,r)}$_collectionChanged(e){this._fireCollectionChanged(e)}$_nameChanged(e,t){t&&delete this._nameMap[t],e.name&&(this._nameMap[e.name]=e)}$_dataNameChanged(e,t){this._sections.forEach((i=>i.dataNameChanged(e,t)))}$_dataFieldNameChanged(e,t,i){this._sections.forEach((r=>r.dataFieldNameChanged(e,t,i)))}_fireItemAdded(e,t,i){this._events.fireEvent(ReportPage.ITEM_ADDED,e,t,i)}_fireItemsAdded(e,t){this._events.fireEvent(ReportPage.ITEMS_ADDED,e,t)}_fireItemRemoved(e,t){this._events.fireEvent(ReportPage.ITEM_REMOVED,e,t)}_fireItemsRemoved(e){this._events.fireEvent(ReportPage.ITEMS_REMOVED,e)}_fireItemChanged(e,t,i,r){this._events.fireEvent(ReportPage.ITEM_CHANGED,e,t,i,r)}_fireCollectionChanged(e){this._events.fireEvent(ReportPage.COLLECTION_CHANGED,e)}}ReportPage.ITEM_ADDED="onPageItemAdded",ReportPage.ITEMS_ADDED="onPageItemsAdded",ReportPage.ITEM_REMOVED="onPageItemRemoved",ReportPage.ITEMS_REMOVED="onPageItemsRemoved",ReportPage.ITEM_CHANGED="onPageItemChanged",ReportPage.COLLECTION_CHANGED="onPageCollectionChanged",ReportPage.$_ctor="ReportPage";class PageBodyItems extends ColumnBoxContainer{get outlineLabel(){return"Items"}canContainsBand(){return!0}canContainsBandGroup(){return!0}canResize(e){return!1}canMove(){return!1}needDesignWidth(){return!1}needDesignHeight(){return!1}_boundable(){return!1}_getStyleProps(){return PageBodyItems.STYLE_PROPS}}PageBodyItems.STYLE_PROPS=["backgroundColor"];class PageBody extends PageSection{constructor(){super("pageBody"),this.add(this._bodyItems=new PageBodyItems("bodyItems")),this.add(this._backItems=new PageItemContainer("pageBackItems","Back Items")),this.add(this._frontItems=new PageItemContainer("pageFrontItems","Front Items"))}get backItems(){return this._backItems.items}get backItemsContainer(){return this._backItems}get frontItems(){return this._frontItems.items}get frontItemsContainer(){return this._frontItems}get bodyItems(){return this._bodyItems.items}get itemsContainer(){return this._bodyItems}get outlineLabel(){return"Body"}canParentOf(e){return!1}canResize(e){return!1}_doLoad(e,t){t.hasOwnProperty("items")&&(this._bodyItems.load(e,{items:t.items}),this._bodyItems.loadProps(t)),t.hasOwnProperty("backItems")&&this._backItems.load(e,t.backItems),t.hasOwnProperty("frontItems")&&this._frontItems.load(e,t.frontItems)}_loadItems(e,t){}_ignoreItems(){return!0}_doSave(e){this._bodyItems.count>0&&(this._bodyItems.save(e),delete e.type,delete e.name),this._backItems.count>0&&this._backItems.save(e.backItems=[]),this._frontItems.count>0&&this._frontItems.save(e.frontItems=[])}canRemove(e){return!1}}var ImageFit,ImagePosition,ListContainerMarker,BarcodeFormat,QrcodeErrorCorrectionLevel;PageBody.$_ctor="PageBody",function(e){e.CONTAINT="contain",e.COVER="cover"}(ImageFit||(ImageFit={})),function(e){e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.CENTER="center"}(ImagePosition||(ImagePosition={}));class ImageItem extends ReportItem{constructor(e){super(e),this._imageFit=ImageFit.COVER,this._imagePosition=ImagePosition.CENTER}get url(){return this._url}set url(e){if(e!=this._url){const t=this._url;this._url=e,this._changed(ImageItem.PROP_URL,e,t)}}get image(){return this._image}set image(e){if(e!=this._image){const t=this._image;this._image=e,this._changed(ImageItem.PROP_IMAGE,e,t)}}get imageFit(){return this._imageFit}set imageFit(e){if(e!=this._imageFit){const t=this._imageFit;this._imageFit=e,this._changed(ImageItem.PROP_IMAGE_FIT,e,t)}}get imagePosition(){return this._imagePosition}set imagePosition(e){if(e!=this._imagePosition){const t=this._imagePosition;this._imagePosition=e,this._changed(ImageItem.PROP_IMAGE_POSITION,e,t)}}getSaveType(){return"image"}get outlineLabel(){return"[Image]"}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=52,this.height=52}_getEditProps(){return super._getEditProps().concat(ImageItem.PROPINFOS)}_getStyleProps(){return ImageItem.STYLE_PROPS}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,ImageItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,ImageItem.PROPINFOS)}canRotate(){return!0}canAdoptDragSource(e){return e instanceof ImageAsset}adoptDragSource(e){if(e instanceof ImageAsset)return{type:DropResultType.PROP,prop:"image",value:e.name}}canPropAdoptDragSource(e,t){return"image"===e.name&&t instanceof ImageAsset}adoptPropDragSource(e,t){if("image"===e.name&&t instanceof ImageAsset)return{type:DropResultType.PROP,prop:"image",value:t.name}}}ImageItem.PROP_URL="url",ImageItem.PROP_IMAGE="image",ImageItem.PROP_IMAGE_FIT="imageFit",ImageItem.PROP_IMAGE_POSITION="imagePosition",ImageItem.PROPINFOS=[{name:ImageItem.PROP_URL,category:"Image",type:StringProperty,multiple:!1,default:void 0},{name:ImageItem.PROP_IMAGE,category:"Image",type:StringProperty,multiple:!1,default:void 0},{name:ImageItem.PROP_IMAGE_FIT,category:"Image",type:EnumProperty,domain:ImageFit,default:ImageFit.COVER},{name:ImageItem.PROP_IMAGE_POSITION,category:"Image",type:EnumProperty,domain:ImagePosition,default:ImagePosition.CENTER}],ImageItem.STYLE_PROPS=["opacity","border","borderLeft","borderRight","borderTop","borderBottom"],ImageItem.$_ctor="ImageItem",ImageItem.ITEM_TYPE="Image";class CheckItem extends ReportItem{constructor(e){super(e),this._threeStates=!1,this._checked=!1,this._text="Check",this._falseText="Uncheck"}get threeStates(){return this._threeStates}set threeStates(e){e!=this._threeStates&&(this._threeStates=e,this._changed(CheckItem.PROP_THREE_STATES,e,!e))}get checked(){return this._checked}set checked(e){if(e!=this._checked){const t=this._checked;this._checked=e,this._changed(CheckItem.PROP_CHECKED,e,t)}}get text(){return this._text}set text(e){if(e!=this._text){const t=this._text;this._text=e,this._changed(CheckItem.PROP_TEXT,e,t)}}get falseText(){return this._falseText}set falseText(e){if(e!=this._falseText){const t=this._falseText;this._falseText=e,this._changed(CheckItem.PROP_FALSE_TEXT,e,t)}}get emptyText(){return this._emptyText}set emptyText(e){if(e!=this._emptyText){const t=this._emptyText;this._emptyText=e,this._changed(CheckItem.PROP_EMPTY_TEXT,e,t)}}getChecked(e){return e?"1":!1!==e||this._threeStates?"-1":"0"}getText(e){return e?this._text:!1!==e||this._threeStates?this._emptyText:this._falseText}get outlineLabel(){return"[Check]"}getSaveType(){return"check"}_getEditProps(){return super._getEditProps().concat(CheckItem.PROPINFOS)}_getStyleProps(){return CheckItem.STYLE_PROPS}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.text="Check"}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,CheckItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,CheckItem.PROPINFOS)}}CheckItem.PROP_THREE_STATES="threeStates",CheckItem.PROP_CHECKED="checked",CheckItem.PROP_TEXT="text",CheckItem.PROP_FALSE_TEXT="falseText",CheckItem.PROP_EMPTY_TEXT="emptyText",CheckItem.PROPINFOS=[{name:CheckItem.PROP_THREE_STATES,category:"Check",type:BooleanProperty,multiple:!1,default:!1},{name:CheckItem.PROP_CHECKED,category:"Check",type:BooleanProperty,multiple:!1,default:!1},{name:CheckItem.PROP_TEXT,category:PropCategory.TEXT,type:StringProperty,multiple:!1,default:void 0},{name:CheckItem.PROP_FALSE_TEXT,category:PropCategory.TEXT,type:StringProperty,multiple:!1,default:void 0},{name:CheckItem.PROP_EMPTY_TEXT,category:PropCategory.TEXT,type:StringProperty,multiple:!1,default:void 0}],CheckItem.STYLE_PROPS=["fontFamily","fontSize","fontStyle","textDecoration","fontWeight","color","backgroundColor","border"],CheckItem.$_ctor="CheckItem",CheckItem.ITEM_TYPE="Check";class ListCellItem extends CellGroup{constructor(e){super(e,"tableCell")}}ListCellItem.$_ctor="ListCellItem",function(e){e.CIRCLE="circle",e.DISC="disc",e.SQUARE="square",e.DECIMAL="decimal",e.LOWER_ROMAN="lower-roman",e.UPPER_ROMAN="upper-roman",e.LOWER_ALPHA="lower-alpha",e.UPPER_ALPHA="upper-alpha",e.NONE="none"}(ListContainerMarker||(ListContainerMarker={}));class ListContainer extends CellContainer{constructor(e){super(e),this._ordered=!1,this._start=1,this._indent=void 0,this.designHeight=50,this.designWidth=160}get ordered(){return this._ordered}set ordered(e){e!=this._ordered&&(this._ordered=e,this._changed(ListContainer.PROP_ORDERED,e,!e))}get start(){return this._start}set start(e){if(e!==this._start){const t=this._start;this._start=e,this._changed(ListContainer.PROP_START,e,t)}}get marker(){return this._marker}set marker(e){if(e!==this._marker){const t=this._marker;this._marker=e,this._changed(ListContainer.PROP_MARKER,e,t)}}get indent(){return this._indent}set indent(e){if(e!==this._indent){const t=this._indent;this._indent=e,this._changed(ListContainer.PROP_INDENT,e,t)}}getSaveType(){return"list"}get outlineLabel(){return"[List]"}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(ListContainer.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,ListContainer.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,ListContainer.PROPINFOS)}_doSaveItems(e,t){for(let i of t){const t={};i.item.save(t),e.push(t)}}_prepareCellGroup(e){return new ListCellItem(e)}}ListContainer.PROP_ORDERED="ordered",ListContainer.PROP_START="start",ListContainer.PROP_MARKER="marker",ListContainer.PROP_INDENT="indent",ListContainer.PROPINFOS=[{name:ListContainer.PROP_ORDERED,category:PropCategory.MARKER,type:BooleanProperty,multiple:!1,default:0},{name:ListContainer.PROP_START,category:PropCategory.MARKER,type:NumberProperty,multiple:!1,default:1},{name:ListContainer.PROP_MARKER,category:PropCategory.MARKER,type:EnumProperty,multiple:!1,default:void 0,domain:ListContainerMarker},{name:ListContainer.PROP_INDENT,category:PropCategory.MARKER,type:NumberProperty,multiple:!1,default:void 0}],ListContainer.$_ctor="ListContainer",ListContainer.ITEM_TYPE="List";class SimpleBandSection extends StackContainer{constructor(e){super(null),this._repeat=!0,this._child_field=null,assert(!!e),this._band=e,this.width="100%",this.designHeight=24}get band(){return this._band}get repeat(){return this._repeat}set repeat(e){e!=this._repeat&&(this._repeat=e,this._changed(SimpleBandSection.PROP_SIMPLE_BAND_SECTION_REPEAT,e,!e))}getFieldOf(e){return e.getChildProp(SimpleBandSection.PROP_FIELD,this._child_field)}setFieldOf(e,t){e.setChildProp(SimpleBandSection.PROP_FIELD,t)}get designLevel(){return this._band.designLevel}get marqueeParent(){return this._band}canResize(e){return e===ResizeDirection.BOTTOM}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,SimpleBand.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,SimpleBand.PROPINFOS)}_doLoadChild(e,t){super._doLoadChild(e,t),t.hasOwnProperty(SimpleBandSection.PROP_FIELD)&&this.setFieldOf(e,t.field)}}SimpleBandSection.PROP_SIMPLE_BAND_SECTION_REPEAT="repeat",SimpleBandSection.PROPINFOS=[{name:SimpleBandSection.PROP_SIMPLE_BAND_SECTION_REPEAT,category:"Band",type:BooleanProperty,multiple:!1,default:!0}],SimpleBandSection.PROP_FIELD="field";class SimpleBandHeader extends SimpleBandSection{constructor(e){super(e)}get outlineLabel(){return"[Band Header]"}}SimpleBandHeader.$_ctor="SimpleBandHeader";class SimpleBandFooter extends SimpleBandSection{constructor(){super(...arguments),this._attachToBody=!1}get attachToBody(){return this._attachToBody}set attachToBody(e){e!==this._attachToBody&&(this._attachToBody=e,this._changed(SimpleBandFooter.PROP_ATTACH_TO_BODY,e,!e))}get outlineLabel(){return"[Band Footer]"}_getEditProps(){return super._getEditProps().concat(SimpleBandFooter.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,SimpleBandFooter.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,SimpleBandFooter.PROPINFOS)}}SimpleBandFooter.PROP_ATTACH_TO_BODY="attachToBody",SimpleBandFooter.PROPINFOS=[{name:SimpleBandFooter.PROP_ATTACH_TO_BODY,category:PropCategory.BAND,type:BooleanProperty,multiple:!1,default:!1}],SimpleBandFooter.$_ctor="SimpleBandFooter";class SimpleBandRow extends SimpleBandSection{constructor(){super(...arguments),this.masterRow=NaN}get blankItems(){return this._blankItems}canBlank(e,t){if(this.band.dataObj.equalRows(t,t-1,e.$_blankFlds))return!0}get outlineLabel(){return"[Data Row]"}get dataDominant(){return!0}get isDataRowContainer(){return!0}_getChildPropInfos(e){return SimpleBandRow.CHILD_PROPS.concat(super._getChildPropInfos(e))}_doLoadChild(e,t){super._doLoadChild(e,t),this._loadChildPropsOf(e,t,SimpleBandRow.CHILD_PROPS)}_doPreparePrint(e){super._doPreparePrint(e),this._blankItems=this.collectBlankItems()}}SimpleBandRow.PROP_EQUAL_BLANK="equalBlank",SimpleBandRow.PROP_BLANK_FIELDS="blankFields",SimpleBandRow.CHILD_PROPS=[{name:SimpleBandRow.PROP_EQUAL_BLANK,category:PropCategory.BAND,type:BooleanProperty,multiple:!1,default:!1},{name:SimpleBandRow.PROP_BLANK_FIELDS,category:PropCategory.BAND,type:StringProperty,multiple:!1,default:void 0}],SimpleBandRow.$_ctor="SimpleBandRow";class SimpleBandRowGroupSection extends StackContainer{constructor(e,t){super(t),this._group=e}get group(){return this._group}get band(){var e;return null===(e=this._group)||void 0===e?void 0:e.band}}SimpleBandRowGroupSection.STYLE_PROPS=["backgroundColor"];class SimpleBandRowGroupHeader extends SimpleBandRowGroupSection{constructor(e){super(e,"groupHeader")}get outlineLabel(){return"Group Header"}}SimpleBandRowGroupHeader.$_ctor="SimpleBandRowGroupHeader";class SimpleBandRowGroupFooter extends SimpleBandRowGroupSection{constructor(e){super(e,"groupFooter")}get outlineLabel(){return"Group Footer"}}SimpleBandRowGroupFooter.$_ctor="SimpleBandRowGroupFooter";class SimpleBandRowGroup extends DataBandRowGroup{constructor(e){super("simpleBandRowGroup"),this.add(this._header=new SimpleBandRowGroupHeader(this)),this.add(this._footer=new SimpleBandRowGroupFooter(this)),this._collection=e}get outlineParent(){return this._collection}get marqueeParent(){return this.band}getEditProps(){return SimpleBandRowGroup.PROPINFOS.concat(super.getEditProps())}get header(){return this._header}get footer(){return this._footer}get band(){var e;return null===(e=this._collection)||void 0===e?void 0:e.band}get page(){var e;return null===(e=this.band)||void 0===e?void 0:e.page}get report(){var e;return null===(e=this.band)||void 0===e?void 0:e.report}get collection(){return this._collection}get dataParent(){return this.band}_ignoreItems(){return!0}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,SimpleBandRowGroup.PROPINFOS),t.hasOwnProperty("header")&&this._header.load(e,t.header),t.hasOwnProperty("footer")&&this._footer.load(e,t.footer)}_doSave(e){super._doSave(e),this._savePropsOf(e,SimpleBandRowGroup.PROPINFOS),this._header.save(e.header={}),this._footer.save(e.footer={})}_changed(e,t,i){super._changed(e,t,i),this._collection&&this._collection.$_groupChanged(this)}}SimpleBandRowGroup.PROPINFOS=[];class SimpleBandRowGroupCollection extends ReportItemCollection{constructor(e){super(),this._groups=[],this._band=e}get outlineParent(){return this._band}get outlineLabel(){return"[Groups]"}get outlineExpandable(){return!0}get outlineItems(){return this._groups}getSaveType(){return"groups"}canRemoveFrom(){return!1}canParentOf(e){return!1}get owner(){return this._band}get band(){return this._band}get count(){return this._groups.length}get items(){return this._groups.slice()}get visibleCount(){let e=0;for(let t of this._groups)t.visible&&e++;return e}get groups(){return this._groups.slice()}load(e,t){if(this._groups=[],t&&t.length>0){for(let i of t)if(i){const t=new SimpleBandRowGroup(this);t.load(e,i),this._groups.push(t)}this.$_invalidateGroups()}}save(e){for(let t of this._groups){const i={};t.save(i),e.push(i)}}get(e){return this._groups[e]}indexOf(e){return this._groups.indexOf(e)}add(e,t=-1){const i=this.$_add(e,t);if(i)return this.$_invalidateGroups(),this._itemAdded(i),i}addAll(e,t=-1){if(!e||e.length<1)return;const i=this._groups.length;t=t<0?this._groups.length:Math.max(0,this._groups.length);for(let i of e)this.$_add(i,t)&&t++;return this._groups.length!=i?(this.$_invalidateGroups(),!0):void 0}removeAt(e){if(e>=0&&e<this._groups.length){const t=this._groups.splice(e,1)[0];return this.$_invalidateGroups(),this._itemRemoved(t,this._band),!0}}remove(e){return this.removeAt(this.indexOf(e))}clear(){if(this._groups.length>0)return this._groups=[],this.$_invalidateGroups(),!0}getValidGroups(e){if(e){const t=[];for(let i of this._groups){const r=i.field;Utils.isNumber(r)?r>=0&&r<e.fieldCount&&t.push(i):e.containsField(r)&&t.push(i)}return t.length?t:null}return null}get page(){var e;return null===(e=this._band)||void 0===e?void 0:e.page}get displayPath(){return this._band?this._band.displayPath+".groups":"groups"}get level(){return this._band?this._band.level+1:0}isAncestorOf(e){if(super.isAncestorOf(e))return!0;if(this._groups.indexOf(e)>=0)return!0;for(let t of this._groups)if(t.indexOf(e))return!0}_doMoveItem(e,t){return!1}$_add(e,t=-1){if(!(e instanceof SimpleBandRowGroup)){const t=e;e=new SimpleBandRowGroup(this),t&&e.extend(t)}if(e instanceof SimpleBandRowGroup&&this._groups.indexOf(e)<0)return t<0?this._groups.push(e):this._groups.splice(Math.min(t,this._groups.length),0,e),e}$_invalidateGroups(){for(let e=this._groups.length-1;e>=0;e--)this._groups[e]._index=e;this._band&&this._band.$_groupChanged(null)}$_groupChanged(e){this._band&&this._band.$_groupChanged(e)}}class SimpleBand extends DataBand{constructor(e){super(e),this._groups=new SimpleBandRowGroupCollection(this),this.add(this._header=new SimpleBandHeader(this)),this.add(this._footer=new SimpleBandFooter(this)),this.add(this._dataRow=new SimpleBandRow(this)),this._setOutlineOrders(1,this._dataRow,this._footer,this.detail),this.width="100%"}get outlineItems(){return[this._groups].concat(super.outlineItems)}get groups(){return this._groups}get header(){return this._header}get footer(){return this._footer}get dataRow(){return this._dataRow}get pr(){return this._pr}setPrinting(e,t){e.row=this._pr=t}getSaveType(){return"simpleband"}get outlineLabel(){return"[Simple Band]"}get isBand(){return!0}_ignoreItems(){return!0}_getEditProps(){return super._getEditProps().concat(SimpleBand.PROPINFOS)}isAncestorOf(e){return!!super.isAncestorOf(e)||(e===this._groups||(!!this._groups.isAncestorOf(e)||void 0))}_doLoad(e,t){super._doLoad(e,t),t.hasOwnProperty("groups")&&this._groups.load(e,t.groups),t.hasOwnProperty("header")&&this.header.load(e,t.header),t.hasOwnProperty("footer")&&this.footer.load(e,t.footer),t.hasOwnProperty("row")&&this.dataRow.load(e,t.row),t.hasOwnProperty("dataRow")&&this.dataRow.load(e,t.dataRow)}_doSave(e){super._doSave(e),this._groups.save(e.groups=[]),this._header.save(e.header={}),this._footer.save(e.footer={}),this._dataRow.save(e.dataRow={})}$_groupChanged(e){this._changed(SimpleBand.PROP_SIMPLE_BAND_GROUPS,this._groups,this._groups)}_doPreparePrint(e){super._doPreparePrint(e),this._groups.preparePrint(e)}_doPrepareIndices(e){e.row=e.index=this._pr=0}canRemove(e){return!1}getNextDetailRows(e){return this._getNextDetailRows(e,this._pr)}skipDetailRows(e){const t=this._skipDetailRows(e,this._pr);this._pr+=t}containsInSection(e){return this._header.contains(e,!0)||this._footer.contains(e,!0)}}SimpleBand.PROP_SIMPLE_BAND_GROUPS="groups",SimpleBand.PROPINFOS=[],SimpleBand.$_ctor="SimpleBand",SimpleBand.ITEM_TYPE="Simple Band",function(e){e.CODE39="code39",e.CODE128="code128",e.CODE128A="code128a",e.CODE128B="code128b",e.CODE128C="code128c",e.EAN13="ean13",e.EAN8="ean8",e.EAN5="ean5",e.EAN2="ean2",e.UPC="upc",e.UPCE="upce",e.ITF="itf",e.ITF14="itf14",e.MSI10="msi10",e.MSI11="msi11",e.MSI1010="msi1010",e.MSI1110="msi1110",e.PHARMACODE="pharmacode",e.CODABAR="codabar"}(BarcodeFormat||(BarcodeFormat={}));class BarcodeItem extends ReportItem{constructor(e){super(e),this._format=BarcodeFormat.CODE128,this._text="",this._barWidth=1,this._showText=!1,this._textAlign=Align.CENTER,this._textPosition="bottom",this._textMargin=2,this._flat=!1}get format(){return this._format}set format(e){if(e!=this._format){const t=this._format;this._format=e,this._changed(BarcodeItem.PROP_FORMAT,e,t)}}get text(){return this._text}set text(e){if(e!=this._text){const t=this._text;this._text=e,this._changed(BarcodeItem.PROP_TEXT,e,t)}}get barWidth(){return this._barWidth}set barWidth(e){if((e=Utils.toNumber(e,1))!==this._barWidth){const t=this._barWidth;this._barWidth=e,this._changed(BarcodeItem.PROP_BAR_WIDTH,e,t)}}get showText(){return this._showText}set showText(e){e!==this._showText&&(this._showText=e,this._changed(BarcodeItem.PROP_SHOW_TEXT,e,!e))}get textAlign(){return this._textAlign}set textAlign(e){if(e!==this._textAlign){const t=this._textAlign;this._textAlign=e,this._changed(BarcodeItem.PROP_TEXT_ALIGN,e,t)}}get textPosition(){return this._textPosition}set textPosition(e){if(e!==this._textPosition){const t=this._textPosition;this._textPosition=e,this._changed(BarcodeItem.PROP_TEXT_POSITION,e,t)}}get textMargin(){return this._textMargin}set textMargin(e){if(e!==this._textMargin){const t=this._textMargin;this._textMargin=e,this._changed(BarcodeItem.PROP_TEXT_MARGIN,e,t)}}get flat(){return this._flat}set flat(e){e!==this._flat&&(this._flat=e,this._changed(BarcodeItem.PROP_FLAT,e,!e))}get lastChar(){return this._lastChar}set lastChar(e){if(e!==this._lastChar){const t=this._lastChar;this._lastChar=e,this._changed(BarcodeItem.PROP_LAST_CHAR,e,t)}}convertText(e){return this._format?e.toUpperCase():e}getSaveType(){return"barcode"}get outlineLabel(){return"Barcode"}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.text="12345",this.width=120,this.height=60}_getEditProps(){return super._getEditProps().concat(BarcodeItem.PROPINFOS)}_getStyleProps(){return BarcodeItem.STYLE_PROPS}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,BarcodeItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,BarcodeItem.PROPINFOS)}}BarcodeItem.PROP_FORMAT="format",BarcodeItem.PROP_TEXT="text",BarcodeItem.PROP_BAR_WIDTH="barWidth",BarcodeItem.PROP_SHOW_TEXT="showText",BarcodeItem.PROP_TEXT_POSITION="textPosition",BarcodeItem.PROP_TEXT_MARGIN="textMargin",BarcodeItem.PROP_TEXT_ALIGN="textAlign",BarcodeItem.PROP_FLAT="flat",BarcodeItem.PROP_LAST_CHAR="lastChar",BarcodeItem.PROPINFOS=[{name:BarcodeItem.PROP_FORMAT,category:PropCategory.BARCODE,type:EnumProperty,default:BarcodeFormat.CODE128,domain:BarcodeFormat,refresh:!0},{name:BarcodeItem.PROP_TEXT,category:PropCategory.BARCODE,type:StringProperty,default:""},{name:BarcodeItem.PROP_BAR_WIDTH,category:PropCategory.BARCODE,type:NumberProperty,default:1},{name:BarcodeItem.PROP_SHOW_TEXT,category:PropCategory.BARCODE,type:BooleanProperty,default:!1},{name:BarcodeItem.PROP_TEXT_ALIGN,category:PropCategory.BARCODE,type:EnumProperty,domain:Align},{name:BarcodeItem.PROP_TEXT_POSITION,category:PropCategory.BARCODE,type:EnumProperty,domain:["top","bottom"]},{name:BarcodeItem.PROP_TEXT_MARGIN,category:PropCategory.BARCODE,type:NumberProperty,default:2},{name:BarcodeItem.PROP_FLAT,category:PropCategory.BARCODE,type:BooleanProperty,default:!1,visible:e=>"ean8"===e.format||"ean13"===e.format},{name:BarcodeItem.PROP_LAST_CHAR,category:PropCategory.BARCODE,type:StringProperty,visible:e=>"ean13"===e.format}],BarcodeItem.STYLE_PROPS=["fontFamily","fontSize","fontStyle","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border"],BarcodeItem.$_ctor="BarcodeItem",BarcodeItem.ITEM_TYPE="Barcode",function(e){e.L="L",e.M="M",e.Q="Q",e.H="H"}(QrcodeErrorCorrectionLevel||(QrcodeErrorCorrectionLevel={}));class QrcodeItem extends ReportItem{constructor(e){super(e),this._text="",this._errorCorrectionLevel=QrcodeErrorCorrectionLevel.Q}get text(){return this._text}set text(e){if(e!==this._text){const t=this._text;this._text=e,this._changed(QrcodeItem.PROP_QRCODE_TEXT,e,t)}}get errorCorrectionLevel(){return this._errorCorrectionLevel}set errorCorrectionLevel(e){if(e!==this._errorCorrectionLevel){const t=this._errorCorrectionLevel;this._errorCorrectionLevel=e,this._changed(QrcodeItem.PROP_QRCODE_ERROR_CORRECTION_LEVEL,e,t)}}getSaveType(){return"qrcode"}get outlineLabel(){return"Qrcode"}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.text="https://www.real-report.com/",this.width=100,this.height=100}_getEditProps(){return super._getEditProps().concat(QrcodeItem.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,QrcodeItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,QrcodeItem.PROPINFOS)}canRotate(){return!0}}QrcodeItem.QRCODE_MIN_SIZE=50,QrcodeItem.PROP_QRCODE_TEXT="text",QrcodeItem.PROP_QRCODE_ERROR_CORRECTION_LEVEL="errorCorrectionLevel",QrcodeItem.PROPINFOS=[{name:QrcodeItem.PROP_QRCODE_ERROR_CORRECTION_LEVEL,category:"qrcode",type:StringProperty,multiple:!1,default:QrcodeErrorCorrectionLevel.Q,domain:[QrcodeErrorCorrectionLevel.L,QrcodeErrorCorrectionLevel.M,QrcodeErrorCorrectionLevel.Q,QrcodeErrorCorrectionLevel.H]},{name:QrcodeItem.PROP_QRCODE_TEXT,category:PropCategory.TEXT,type:StringProperty,multiple:!1,default:""}],QrcodeItem.$_ctor="QrcodeItem",QrcodeItem.ITEM_TYPE="Qrcode";class ShapeDrawing{constructor(e){this.className=e}draw(e,t,i,r=0,s){return this._doDraw(e,t,i,r,s||"")}drawAt(e,t,i,r,s,n=0,o){const a=this._doDraw(i,r,s,n,o||"");return a.setAttribute("transform","translate("+e+","+t+")"),this.className&&a.classList.add(this.className),a}}const $$_polygonShapes={rectangle:[0,0,1,0,1,1,0,1],triangle:[.5,0,0,1,1,1],itriangle:[0,0,.5,1,1,0],diamond:[.5,0,0,.5,.5,1,1,.5],uparrow:[.5,0,0,.5,.3,.5,.3,1,.7,1,.7,.5,1,.5],downarrow:[.3,0,.3,.5,0,.5,.5,1,1,.5,.7,.5,.7,0],leftarrow:[0,.5,.5,1,.5,.7,1,.7,1,.3,.5,.3,.5,0],rightarrow:[0,.3,0,.7,.5,.7,.5,1,1,.5,.5,0,.5,.3],plus:[.3,0,.3,.3,0,.3,0,.7,.3,.7,.3,1,.7,1,.7,.7,1,.7,1,.3,.7,.3,.7,0],minus:[0,.3,0,.7,1,.7,1,.3],star:[.5,0,.6122,.3454,.9755,.3454,.6816,.559,.7938,.9045,.5,.691,.2061,.9045,.3183,.559,.02447,.3454,.3877,.3454]},$$_pairShapes={equal:[[0,.2,0,.4,1,.4,1,.2],[0,.6,0,.8,1,.8,1,.6]]};class PolygonShape extends ShapeDrawing{constructor(e,t){super(t),this._shape=e}get shape(){return this._shape}set shape(e){this._shape=e?"inverted_triangle"===e?PolygonShape.INVERTED_TRIANLGE:e.toLowerCase():null}_doDraw(e,t,i,r,s){const n=this._shape;if(t-=r,i-=r,$$_polygonShapes.hasOwnProperty(n)){let o=$$_polygonShapes[n];if(o){let n=r/2,a=r/2;o=o.slice();for(let e=0,r=o.length/2;e<r;e++)o[2*e]=n+o[2*e]*t,o[2*e+1]=a+o[2*e+1]*i;return o.push(o[0],o[1]),e.polygon(s,o)}}else if($$_pairShapes.hasOwnProperty(n)){const o=$$_pairShapes[n];if(o){let n=r/2,a=r/2,A=o[0].slice();for(let e=0,r=A.length/2;e<r;e++)A[2*e]=n+A[2*e]*t,A[2*e+1]=a+A[2*e+1]*i;A.push(A[0],A[1]),e.polygon(null,A),A=o[1],A=A.slice();for(let e=0,r=A.length/2;e<r;e++)A[2*e]=n+A[2*e]*t,A[2*e+1]=a+A[2*e+1]*i;return A.push(A[0],A[1]),e.polygon(s,A)}}}}PolygonShape.RECTANGLE="rectangle",PolygonShape.TRIANLGE="triangle",PolygonShape.INVERTED_TRIANLGE="itriangle",PolygonShape.DIAMOND="diamond",PolygonShape.UP_ARROW="uparrow",PolygonShape.DOWN_ARROW="downarrow",PolygonShape.LEFT_ARROW="leftarrow",PolygonShape.RIGHT_ARROW="rightarrow",PolygonShape.PLUS="plus",PolygonShape.MINUS="minus",PolygonShape.EQUAL="equal",PolygonShape.STAR="star";class EllipseShape extends ShapeDrawing{constructor(){super(...arguments),this.circled=!0}static isEllipse(e){return e in this.ELLIPSES}_doDraw(e,t,i,r,s){const n=r/2;if(this.circled){const r=Math.min(t,i)/2;return e.ellipse(s,t/2,i/2,r-n,r-n)}return e.ellipse(s,t/2,i/2,t/2-n,i/2-n)}}EllipseShape.CIRCLE="circle",EllipseShape.ELLIPSE="ellipse",EllipseShape.ELLIPSES={circle:"",ellipse:""};class LineShape extends ShapeDrawing{static isLine(e){return e in this.LINES}_doDraw(e,t,i,r){let s,n;switch(this.shape){case LineShape.HLINE:return n=i/2,e.line(null,0,n,t,n);case LineShape.VLINE:return s=t/2,e.line(null,s,0,s,i);case LineShape.DIAGONAL:return e.line(null,0,0,t,i);case LineShape.RDIAGONAL:return e.line(null,0,i,t,0)}}}LineShape.HLINE="hline",LineShape.VLINE="vline",LineShape.DIAGONAL="diagonal",LineShape.RDIAGONAL="rdiagonal",LineShape.LINES={hline:"",vline:"",diagonal:"",rdiagonal:""};const ShapeNames=[PolygonShape.RECTANGLE,PolygonShape.TRIANLGE,PolygonShape.INVERTED_TRIANLGE,PolygonShape.DIAMOND,PolygonShape.UP_ARROW,PolygonShape.DOWN_ARROW,PolygonShape.LEFT_ARROW,PolygonShape.RIGHT_ARROW,PolygonShape.PLUS,PolygonShape.MINUS,PolygonShape.EQUAL,PolygonShape.STAR,EllipseShape.CIRCLE,EllipseShape.ELLIPSE],ShapeNamesEx=ShapeNames.concat([LineShape.HLINE,LineShape.VLINE,LineShape.DIAGONAL,LineShape.RDIAGONAL]);class ShapeItemBase extends ReportItem{constructor(e){super(e),this._shape=PolygonShape.STAR}get shape(){return this._shape}set shape(e){if(e!==this._shape){const t=this._shape;this._shape=e,this._changed(ShapeItemBase.PROP_SHAPE,e,t)}}get shapeCallback(){return this._shapeCallback}set shapeCallback(e){if(e!==this._shapeCallback){const t=this._shapeCallback;this._shapeCallback=e,this._changed(ShapeItemBase.PROP_SHAPE_CALLBACK,e,t)}}_getEditProps(){return super._getEditProps().concat(ShapeItemBase.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,ShapeItemBase.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,ShapeItemBase.PROPINFOS)}setProperty(e,t){if(super.setProperty(e,t),"shape"===e&&LineShape.isLine(t)&&!this._isLoading()){let e=this.getStyle("stroke");e||(this.setStyleProperty("stroke","green"),e=this.getStyle("strokeWidth"),e||this.setStyleProperty("strokeWidth","2"))}}canRotate(){return!0}}ShapeItemBase.PROP_SHAPE="shape",ShapeItemBase.PROP_SHAPE_CALLBACK="shapeCallback",ShapeItemBase.PROPINFOS=[];class ShapeItem extends ShapeItemBase{constructor(e){super(e)}getSaveType(){return"shape"}get outlineLabel(){return"Shape"}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.shape="star",this.width=24,this.height=24}_getEditProps(){return super._getEditProps().concat(ShapeItem.PROPINFOS)}_getStyleProps(){return ShapeItem.STYLE_PROPS}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,ShapeItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,ShapeItem.PROPINFOS)}}ShapeItem.PROPINFOS=[{name:ShapeItemBase.PROP_SHAPE,category:"Shape",type:StringProperty,multiple:!1,default:void 0,domain:ShapeNamesEx}],ShapeItem.STYLE_PROPS=["backgroundColor","fill","stroke","strokeWidth","strokeDasharray"],ShapeItem.$_ctor="ShapeItem",ShapeItem.ITEM_TYPE="Shape";class SvgItem extends ReportItem{constructor(e){super(e)}get svg(){return this._svg}set svg(e){if(e!=this._svg){const t=this._svg;this._svg=e,this._changed(SvgItem.PROP_SVG,e,t)}}getSaveType(){return"svg"}get outlineLabel(){return"Svg"}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=52,this.height=52}_getEditProps(){return super._getEditProps().concat(SvgItem.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,SvgItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,SvgItem.PROPINFOS)}canAdoptDragSource(e){return e instanceof SvgAsset}adoptDragSource(e){if(e instanceof SvgAsset)return{type:DropResultType.PROP,prop:"svg",value:e.name}}canPropAdoptDragSource(e,t){return"svg"===e.name&&t instanceof SvgAsset}adoptPropDragSource(e,t){if("svg"===e.name&&t instanceof SvgAsset)return{type:DropResultType.PROP,prop:"svg",value:t.name}}canRotate(){return!0}}SvgItem.PROP_SVG="svg",SvgItem.PROPINFOS=[{name:SvgItem.PROP_SVG,category:"Svg",type:StringProperty,multiple:!1,default:void 0}],SvgItem.$_ctor="SvgItem",SvgItem.ITEM_TYPE="Svg";class RatingItem extends ShapeItemBase{constructor(e){super(e),this._shapeCount=5,this._countinuous=!1,this._designValue=2}get shapeCount(){return this._shapeCount}set shapeCount(e){if((e=Math.max(1,Utils.toNumber(e)))!==this._shapeCount){const t=this._shapeCount;this._shapeCount=e,this._changed(RatingItem.PROP_RATING_SHAPE_COUNT,e,t)}}get countinuous(){return this._countinuous}set countinuous(e){e!==this._countinuous&&(this._countinuous=e,this._changed(RatingItem.PROP_SHAPE,e,!this._countinuous))}get minimum(){return this._minimum}set minimum(e){if((e=Utils.toNumber(e,NaN))!=this._minimum){const t=this._minimum;this._minimum=e,this._changed(RatingItem.PROP_RATING_MINIMUM,e,t)}}get maximum(){return this._maximum}set maximum(e){if((e=Utils.toNumber(e,NaN))!=this._maximum){const t=this._maximum;this._maximum=e,this._changed(RatingItem.PROP_RATING_MAXIMUM,e,t)}}get designValue(){return this._designValue}set designValue(e){if((e=Utils.toNumber(e,0))!=this._designValue){const t=this._designValue;this._designValue=e,this._changed(RatingItem.PROP_RATING_DESIGN_VALUE,e,t)}}get outlineLabel(){return"[Rating]"}getSaveType(){return"rating"}_getEditProps(){return super._getEditProps().concat(RatingItem.PROPINFOS)}_getStyleProps(){return RatingItem.STYLE_PROPS}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=Math.min(100,i||100),this.height=Math.min(20,r||20)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,RatingItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,RatingItem.PROPINFOS)}}RatingItem.PROP_RATING_SHAPE_COUNT="shapeCount",RatingItem.PROP_RATING_CONTINUOUS="continuous",RatingItem.PROP_RATING_MINIMUM="minimum",RatingItem.PROP_RATING_MAXIMUM="maximum",RatingItem.PROP_RATING_DESIGN_VALUE="designValue",RatingItem.PROPINFOS=[{name:ShapeItemBase.PROP_SHAPE,category:"Shape",type:StringProperty,multiple:!1,default:void 0,domain:ShapeNames},{name:RatingItem.PROP_RATING_SHAPE_COUNT,category:"Rating",type:NumberProperty,multiple:!1,default:5},{name:RatingItem.PROP_RATING_MINIMUM,category:"Rating",type:NumberProperty,multiple:!1,default:0},{name:RatingItem.PROP_RATING_MAXIMUM,category:"Rating",type:NumberProperty,multiple:!1,default:100},{name:RatingItem.PROP_RATING_DESIGN_VALUE,category:"Rating",type:NumberProperty,multiple:!1,default:50}],RatingItem.STYLE_PROPS=["backgroundColor","fill","stroke","backFill","backStroke"],RatingItem.$_ctor="RatingItem",RatingItem.ITEM_TYPE="Rating";class SummaryItem extends TextItemBase{constructor(e){super(e)}get expression(){return this._expression}set expression(e){if(e!=this._expression){const t=this._expression;this._expression=e,this._exprNode=e?ExpressionParser.Default.parse(e):null,this._changed(SummaryItem.PROP_EXPRESSION,e,t)}}getSummary(e){return this._exprNode?this._exprNode.evaluate(e):NaN}getSaveType(){return"summary"}get designText(){return this.value}get outlineLabel(){let e=this.expression;return"[Summary]"+(e?" "+e:"")}get pathLabel(){return"summary"}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r)}_getEditProps(){return super._getEditProps().concat(SummaryItem.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,SummaryItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,SummaryItem.PROPINFOS)}}SummaryItem.PROP_EXPRESSION="expression",SummaryItem.PROPINFOS=[{name:SummaryItem.PROP_EXPRESSION,category:PropCategory.DATA,type:StringProperty,multiple:!1,default:void 0}],SummaryItem.$_ctor="SummaryItem",SummaryItem.ITEM_TYPE="Summary";class BarItem extends ReportItem{constructor(e){super(e),this._minimum=0,this._maximum=100,this._position=35}get minimum(){return this._minimum}set minimum(e){if(e!=this._minimum){const t=this._minimum;this._minimum=e,this._changed(BarItem.PROP_BAR_MINIMUM,e,t)}}get maximum(){return this._maximum}set maximum(e){if(e!=this._maximum){const t=this._maximum;this._maximum=e,this._changed(BarItem.PROP_BAR_MAXIMUM,e,t)}}get position(){return this._position}set position(e){if((e=Utils.toNumber(e,0))!=this._position){const t=this._position;this._position=e,this._changed(BarItem.PROP_POSITION,e,t)}}get outlineLabel(){return"[Bar]"}getSaveType(){return"bar"}_getEditProps(){return super._getEditProps().concat(BarItem.PROPINFOS)}_getStyleProps(){return BarItem.STYLE_PROPS}canRotate(){return!0}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.width=Math.min(60,i||60),this.height=Math.min(25,r||25)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,BarItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,BarItem.PROPINFOS)}}BarItem.PROP_BAR_MINIMUM="minimum",BarItem.PROP_BAR_MAXIMUM="maximum",BarItem.PROP_POSITION="position",BarItem.PROPINFOS=[{name:BarItem.PROP_BAR_MINIMUM,category:"Bar",type:NumberProperty,multiple:!1,default:0},{name:BarItem.PROP_BAR_MAXIMUM,category:"Bar",type:NumberProperty,multiple:!1,default:100},{name:BarItem.PROP_POSITION,category:"Bar",type:NumberProperty,multiple:!1,default:50}],BarItem.STYLE_PROPS=["border","backgroundColor","barColor"],BarItem.$_ctor="BarItem",BarItem.ITEM_TYPE="Bar";class HichartColumnSeries extends HichartCartesianSeries{constructor(e){super(e),this._grouping=!0,this.dataLabels.visible=!1}get grouping(){return this._grouping}set grouping(e){e!==this._grouping&&(this._grouping=e,this._changed(HichartColumnSeries.PROP_GROUPING,e,!e))}get stack(){return this._stack}set stack(e){if(e!==this._stack){const t=this._stack;this._stack=e,this._changed(HichartColumnSeries.PROP_STACK,e,t)}}get pointPadding(){return this._pointPadding}set pointPadding(e){if(e!==this._pointPadding){const t=this._pointPadding;this._pointPadding=e,this._changed(HichartColumnSeries.PROP_POINT_PADDING,e,t)}}get pointPlacement(){return this._pointPlacement}set pointPlacement(e){const t=this._pointPlacement;this._pointPlacement=e,this._changed(HichartColumnSeries.PROP_POINT_PLACEMENT,e,t)}get seriesType(){return"column"}_getEditProps(){return super._getEditProps().concat(HichartColumnSeries.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartColumnSeries.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartColumnSeries.PROPINFOS)}wrap(e){return super.wrap(e),!0!==this._grouping&&(e[HichartColumnSeries.PROP_GROUPING]=this._grouping),e[HichartColumnSeries.PROP_POINT_PLACEMENT]=Utils.toStrOrNum(this._pointPlacement),this.assignProps(e,[HichartColumnSeries.PROP_STACK,HichartColumnSeries.PROP_POINT_PADDING])}}HichartColumnSeries.PROP_GROUPING="grouping",HichartColumnSeries.PROP_STACK="stack",HichartColumnSeries.PROP_POINT_PADDING="pointPadding",HichartColumnSeries.PROP_POINT_PLACEMENT="pointPlacement",HichartColumnSeries.PROPINFOS=[{name:HichartColumnSeries.PROP_GROUPING,category:PropCategory.SERIES,type:BooleanProperty,multiple:!1,default:!0},{name:HichartColumnSeries.PROP_STACK,category:PropCategory.SERIES,type:StringProperty,multiple:!1,default:void 0},{name:HichartColumnSeries.PROP_POINT_PADDING,category:PropCategory.SERIES,type:NumberProperty,multiple:!1,default:void 0},{name:HichartColumnSeries.PROP_POINT_PLACEMENT,category:PropCategory.SERIES,type:StringProperty,multiple:!1,default:void 0}],HichartColumnSeries.$_ctor="HichartColumnSeries";class HichartColumnRangeSeries extends HichartColumnSeries{constructor(e){super(e)}get seriesType(){return"columnrange"}_doLoad(e,t){super._doLoad(e,t)}_doSave(e){super._doSave(e)}}HichartColumnRangeSeries.$_ctor="HichartColumnRangeSeries";class HichartBarSeries extends HichartCartesianSeries{constructor(e){super(e),this._grouping=!0,this.dataLabels.visible=!1}get grouping(){return this._grouping}set grouping(e){e!==this._grouping&&(this._grouping=e,this._changed(HichartBarSeries.PROP_GROUPING,e,!e))}get stack(){return this._stack}set stack(e){if(e!==this._stack){const t=this._stack;this._stack=e,this._changed(HichartBarSeries.PROP_STACK,e,t)}}get pointPadding(){return this._pointPadding}set pointPadding(e){if(e!==this._pointPadding){const t=this._pointPadding;this._pointPadding=e,this._changed(HichartBarSeries.PROP_POINT_PADDING,e,t)}}get pointPlacement(){return this._pointPlacement}set pointPlacement(e){const t=this._pointPlacement;this._pointPlacement=e,this._changed(HichartBarSeries.PROP_POINT_PLACEMENT,e,t)}get seriesType(){return"bar"}_getEditProps(){return super._getEditProps().concat(HichartBarSeries.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartBarSeries.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartBarSeries.PROPINFOS)}wrap(e){return super.wrap(e),!0!==this._grouping&&(e[HichartBarSeries.PROP_GROUPING]=this._grouping),e[HichartBarSeries.PROP_POINT_PLACEMENT]=Utils.toStrOrNum(this._pointPlacement),this.assignProps(e,[HichartBarSeries.PROP_STACK,HichartBarSeries.PROP_POINT_PADDING])}}HichartBarSeries.PROP_GROUPING="grouping",HichartBarSeries.PROP_STACK="stack",HichartBarSeries.PROP_POINT_PADDING="pointPadding",HichartBarSeries.PROP_POINT_PLACEMENT="pointPlacement",HichartBarSeries.PROPINFOS=[{name:HichartBarSeries.PROP_GROUPING,category:PropCategory.SERIES,type:BooleanProperty,multiple:!1,default:!0},{name:HichartBarSeries.PROP_STACK,category:PropCategory.SERIES,type:StringProperty,multiple:!1,default:void 0},{name:HichartBarSeries.PROP_POINT_PADDING,category:PropCategory.SERIES,type:NumberProperty,multiple:!1,default:void 0},{name:HichartBarSeries.PROP_POINT_PLACEMENT,category:PropCategory.SERIES,type:StringProperty,multiple:!1,default:void 0}],HichartBarSeries.$_ctor="HichartBarSeries";class HichartLineSeriesMarker extends HichartSeriesMarker{constructor(e){super(e)}get radius(){return this._radius}set radius(e){if(e!==this._radius){const t=this._radius;this._radius=e,this._changed(HichartLineSeriesMarker.PROP_RADIUS,e,t)}}_getEditProps(){return super._getEditProps().concat(HichartLineSeriesMarker.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartLineSeriesMarker.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartLineSeriesMarker.PROPINFOS)}}HichartLineSeriesMarker.PROP_RADIUS="radius",HichartLineSeriesMarker.PROPINFOS=[{name:HichartLineSeriesMarker.PROP_RADIUS,category:PropCategory.MARKER,type:NumberProperty,multiple:!0,default:void 0}];class HichartLineSeries extends HichartCartesianSeries{constructor(e){super(e),this._marker=new HichartLineSeriesMarker(this)}get lineWidth(){return this._lineWidth}set lineWidth(e){if(e!==this._lineWidth){const t=this._lineWidth;this._lineWidth=e,this._changed(HichartLineSeries.PROP_LINE_WIDTH,e,t)}}get lineColor(){return this._lineColor}set lineColor(e){if(e!==this._lineColor){const t=this._lineColor;this._lineColor=e,this._changed(HichartLineSeries.PROP_LINE_COLOR,e,t)}}get marker(){return this._marker}get seriesType(){return"line"}canHideMarker(){return!0}_getEditProps(){return super._getEditProps().concat(HichartLineSeries.PROPINFOS)}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this._marker.defaultInit(e,t,i,r)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartLineSeries.PROPINFOS),this._loadObjects([this._marker],e,t)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartLineSeries.PROPINFOS),this._saveObjects([this._marker],e)}wrap(e){super.wrap(e);const t=this._getPropsWrapper({});return t.marker=this._marker.getWrapper(),Utils.extend(e,t)}}HichartLineSeries.PROP_LINE_WIDTH="lineWidth",HichartLineSeries.PROP_LINE_COLOR="lineColor",HichartLineSeries.PROP_MARKER="marker",HichartLineSeries.PROPINFOS=[{name:HichartLineSeries.PROP_LINE_WIDTH,category:PropCategory.SERIES,type:NumberProperty,multiple:!0,default:void 0},{name:HichartLineSeries.PROP_LINE_COLOR,category:PropCategory.SERIES,type:ColorProperty,multiple:!0,default:void 0},{name:HichartLineSeries.PROP_MARKER,category:PropCategory.MARKER,indented:!0,type:ModelProperty,multiple:!1,default:void 0}],HichartLineSeries.$_ctor="HichartLineSeries";class HichartSplineSeries extends HichartLineSeries{get seriesType(){return"spline"}}HichartSplineSeries.$_ctor="HichartSplineSeries";class HichartAreaSeries extends HichartLineSeries{constructor(e){super(e)}get fillColor(){return this._fillColor}set fillColor(e){if(e!==this._fillColor){const t=this._fillColor;this._fillColor=e,this._changed(HichartAreaSeries.PROP_FILL_COLOR,e,t)}}get seriesType(){return"area"}_getEditProps(){return super._getEditProps().concat(HichartAreaSeries.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartAreaSeries.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartAreaSeries.PROPINFOS)}wrap(e){return super.wrap(e),Utils.extend(e,this._getPropsWrapper({}))}}HichartAreaSeries.PROP_FILL_COLOR="fillColor",HichartAreaSeries.PROPINFOS=[{name:HichartAreaSeries.PROP_FILL_COLOR,category:PropCategory.SERIES,type:ColorProperty,multiple:!0,default:void 0}],HichartAreaSeries.$_ctor="HichartAreaSeries";class HichartAreaSplineSeries extends HichartAreaSeries{get seriesType(){return"areaspline"}}HichartAreaSplineSeries.$_ctor="HichartAreaSplineSeries";class HichartAreaRangeSeries extends HichartAreaSeries{constructor(){super(...arguments),this._xValues=[1,2,3,4,5],this._lowValues=[7,5,3,8,6],this._highValues=[12,9,7,11,9]}get xField(){return this._xField}set xField(e){if(e!==this._xField){const t=this._xField;this._xField=e,this._changed(HichartAreaRangeSeries.PROP_X_FIELD,e,t)}}get xValues(){return this._xValues}set xValues(e){if(e!==this._xValues){const t=this._xValues;this._xValues=null==e?void 0:e.slice(),this._changed(HichartAreaRangeSeries.PROP_X_VALUES,e,t)}}get lowField(){return this._lowField}set lowField(e){if(e!==this._lowField){const t=this._lowField;this._lowField=e,this._changed(HichartAreaRangeSeries.PROP_LOW_FIELD,e,t)}}get lowValues(){return this._lowValues}set lowValues(e){if(e!==this._lowValues){const t=this._lowValues;this._lowValues=null==e?void 0:e.slice(),this._changed(HichartAreaRangeSeries.PROP_LOW_VALUES,e,t)}}get highField(){return this._highField}set highField(e){if(e!==this._highField){const t=this._highField;this._highField=e,this._changed(HichartAreaRangeSeries.PROP_HIGH_FIELD,e,t)}}get highValues(){return this._highValues}set highValues(e){if(e!==this._highValues){const t=this._highValues;this._highValues=null==e?void 0:e.slice(),this._changed(HichartAreaRangeSeries.PROP_HIGH_VALUES,e,t)}}get seriesType(){return"arearange"}hasValuesProp(){return!1}_getEditProps(){return super._getEditProps().concat(HichartAreaRangeSeries.PROPINFOS)}_doDefaultInit(e,t,i,r){this._doDefaultInit(e,t,i,r)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartAreaRangeSeries.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartAreaRangeSeries.PROPINFOS)}getValues(e,t){const i=super.getValues(e,t),r=this._getValues(e,"x",t),s=this._getValues(e,"low",t),n=this._getValues(e,"high",t),o=[];if(i&&r&&s&&n){let e=0;for(let t of i)o.push({x:r[e],low:s[e],high:n[e]}),e++}return o}wrap(e){super.wrap(e);const t=this._getPropsWrapper({});return Utils.extend(e,t)}}HichartAreaRangeSeries.PROP_X_FIELD="xField",HichartAreaRangeSeries.PROP_X_VALUES="xValues",HichartAreaRangeSeries.PROP_LOW_FIELD="lowField",HichartAreaRangeSeries.PROP_LOW_VALUES="lowValues",HichartAreaRangeSeries.PROP_HIGH_FIELD="highField",HichartAreaRangeSeries.PROP_HIGH_VALUES="highValues",HichartAreaRangeSeries.PROPINFOS=[{name:HichartAreaRangeSeries.PROP_X_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartAreaRangeSeries.PROP_X_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartAreaRangeSeries.PROP_LOW_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartAreaRangeSeries.PROP_LOW_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartAreaRangeSeries.PROP_HIGH_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartAreaRangeSeries.PROP_HIGH_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0}],HichartAreaRangeSeries.$_ctor="HichartAreaRangeSeries";class HichartPieSeries extends HichartSeries{constructor(e){super(e),this._names=["사과","배","감","귤","수박"],this._startAngle=0,this._dataLabels=new HichartRadialDataLabels(e),this.size="75%",this.innerSize="0%",this.colorByPoint=!0,this.showInLegend=!1}getPropDomain(e){return this.report&&e.name===HichartPieSeries.PROP_PIE_SERIES_NAME_FIELD?this.getDataFieldNames():super.getPropDomain(e)}get dataLabels(){return this._dataLabels}get nameField(){return this._nameField}set nameField(e){if(e!==this._nameField){const t=this._nameField;this._nameField=e,this._changed(HichartPieSeries.PROP_PIE_SERIES_NAME_FIELD,e,t)}}get names(){return this._names}set names(e){if(e!==this._names){const t=this._names;this._names=null==e?void 0:e.slice(),this._changed(HichartPieSeries.PROP_PIE_SERIES_NAMES,e,t)}}get size(){return this._size}set size(e){if((e=this._validateSize(e))!==this._size){const t=this._size;this._size=e,this._sizeDim=new Dimension(e),this._changed(HichartPieSeries.PROP_PIE_SERIES_SIZE,e,t)}}get innerSize(){return this._innerSize}set innerSize(e){if((e=this._validateSize(e))!==this._innerSize){const t=this._innerSize;this._innerSize=e,this._innerSizeDim=new Dimension(e),this._changed(HichartPieSeries.PROP_PIE_SERIES_SIZE,e,t)}}get startAngle(){return this._startAngle}set startAngle(e){if(e!==this._startAngle){const t=this._startAngle;this._startAngle=e,this._changed(HichartPieSeries.PROP_PIE_SERIES_START_ANGLE,e,t)}}get endAngle(){return this._endAngle}set endAngle(e){if(e!==this._endAngle){const t=this._endAngle;this._endAngle=e,this._changed(HichartPieSeries.PROP_PIE_SERIES_END_ANGLE,e,t)}}get centerX(){return this._centerX}set centerX(e){if((e=this._validateSize(e))!==this._centerX){const t=this._centerX;this._centerX=e,this._centerXDim=new Dimension(e),this._changed(HichartPieSeries.PROP_PIE_SERIES_CENTER_X,e,t)}}get centerY(){return this._centerY}set centerY(e){if((e=this._validateSize(e))!==this._centerY){const t=this._centerY;this._centerY=e,this._centerYDim=new Dimension(e),this._changed(HichartPieSeries.PROP_PIE_SERIES_CENTER_Y,e,t)}}get seriesType(){return"pie"}_getEditProps(){return super._getEditProps().concat(HichartPieSeries.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartPieSeries.PROPINFOS),this._loadObjects([this._dataLabels],e,t)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartPieSeries.PROPINFOS),this._saveObjects([this._dataLabels],e)}wrap(e){var t,i,r,s;return super.wrap(e),Utils.extend(e,{size:null===(t=this._sizeDim)||void 0===t?void 0:t.getValue(),innerSize:null===(i=this._innerSizeDim)||void 0===i?void 0:i.getValue(),startAngle:this._startAngle,endAngle:this._endAngle,center:[null===(r=this._centerXDim)||void 0===r?void 0:r.getValue(),null===(s=this._centerYDim)||void 0===s?void 0:s.getValue()],dataLabels:this._dataLabels.getWrappaer()})}getValues(e,t){const i=this._getNames(e.printing,t),r=super.getValues(e,t),s=[];if(r){let e=0;for(let t of r)s.push({y:t,name:i&&i.length>e?i[e]:e}),e++}return s}_getNames(e,t){if(e&&this._nameField){const e=this.data||this._getParentData();if(e)return t.getFieldValues(e,this._nameField)}return this._names}}HichartPieSeries.PROP_PIE_SERIES_DATA_LABELS="dataLabels",HichartPieSeries.PROP_PIE_SERIES_NAME_FIELD="nameField",HichartPieSeries.PROP_PIE_SERIES_NAMES="names",HichartPieSeries.PROP_PIE_SERIES_SIZE="size",HichartPieSeries.PROP_PIE_SERIES_INNER_SIZE="innerSize",HichartPieSeries.PROP_PIE_SERIES_START_ANGLE="startAngle",HichartPieSeries.PROP_PIE_SERIES_END_ANGLE="endAngle",HichartPieSeries.PROP_PIE_SERIES_CENTER_X="centerX",HichartPieSeries.PROP_PIE_SERIES_CENTER_Y="centerY",HichartPieSeries.PROPINFOS=[{name:HichartPieSeries.PROP_PIE_SERIES_DATA_LABELS,category:"data labels",type:ModelProperty,indented:!0,multiple:!1,default:void 0},{name:HichartPieSeries.PROP_PIE_SERIES_NAME_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartPieSeries.PROP_PIE_SERIES_NAMES,category:PropCategory.SERIES,type:StringArrayProperty,multiple:!1,default:void 0},{name:HichartPieSeries.PROP_PIE_SERIES_SIZE,category:PropCategory.SERIES,type:DimensionProperty,multiple:!0,default:void 0},{name:HichartPieSeries.PROP_PIE_SERIES_INNER_SIZE,category:PropCategory.SERIES,type:DimensionProperty,multiple:!0,default:void 0},{name:HichartPieSeries.PROP_PIE_SERIES_START_ANGLE,category:PropCategory.SERIES,type:NumberProperty,multiple:!0,default:0},{name:HichartPieSeries.PROP_PIE_SERIES_END_ANGLE,category:PropCategory.SERIES,type:NumberProperty,multiple:!0,default:void 0},{name:HichartPieSeries.PROP_PIE_SERIES_CENTER_X,category:PropCategory.SERIES,type:DimensionProperty,multiple:!0,default:void 0},{name:HichartPieSeries.PROP_PIE_SERIES_CENTER_Y,category:PropCategory.SERIES,type:DimensionProperty,multiple:!0,default:void 0}],HichartPieSeries.$_ctor="HichartPieSeries";class HichartBubbleSeriesMarker extends HichartSeriesMarker{constructor(e){super(e),this._fillOpacity=.5,this._lineWidth=1}get fillOpacity(){return this._fillOpacity}set fillOpacity(e){if(e!==this._fillOpacity){const t=this._fillOpacity;this._fillOpacity=e,this._changed(HichartBubbleSeriesMarker.PROP_FILL_OPACITY,e,t)}}get lineColor(){return this._lineColor}set lineColor(e){if(e!==this._lineColor){const t=this._lineColor;this._lineColor=e,this._changed(HichartBubbleSeriesMarker.PROP_LINE_COLOR,e,t)}}get lineWidth(){return this._lineWidth}set lineWidth(e){if(e!==this._lineWidth){const t=this._lineWidth;this._lineWidth=e,this._changed(HichartBubbleSeriesMarker.PROP_LINE_WIDTH,e,t)}}_getEditProps(){return super._getEditProps().concat(HichartBubbleSeriesMarker.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartBubbleSeriesMarker.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartBubbleSeriesMarker.PROPINFOS)}}HichartBubbleSeriesMarker.PROP_FILL_OPACITY="fillOpacity",HichartBubbleSeriesMarker.PROP_LINE_COLOR="lineColor",HichartBubbleSeriesMarker.PROP_LINE_WIDTH="lineWidth",HichartBubbleSeriesMarker.PROPINFOS=[{name:HichartBubbleSeriesMarker.PROP_FILL_OPACITY,category:PropCategory.MARKER,type:NumberProperty,multiple:!0,default:.5},{name:HichartBubbleSeriesMarker.PROP_LINE_COLOR,category:PropCategory.MARKER,type:ColorProperty,multiple:!0,default:void 0},{name:HichartBubbleSeriesMarker.PROP_LINE_WIDTH,category:PropCategory.MARKER,type:NumberProperty,multiple:!0,default:1}];class HichartBubbleSeries extends HichartCartesianSeries{constructor(e){super(e),this._xValues=[1,2,3,4,5],this._yValues=[1,2,3,4,5],this._marker=new HichartBubbleSeriesMarker(this),this.dataLabels.visible=!1}get xField(){return this._xField}set xField(e){if(e!==this._xField){const t=this._xField;this._xField=e,this._changed(HichartBubbleSeries.PROP_X_FIELD,e,t)}}get xValues(){return this._xValues}set xValues(e){if(e!==this._xValues){const t=this._xValues;this._xValues=null==e?void 0:e.slice(),this._changed(HichartBubbleSeries.PROP_X_VALUES,e,t)}}get yField(){return this._yField}set yField(e){if(e!==this._yField){const t=this._yField;this._yField=e,this._changed(HichartBubbleSeries.PROP_Y_FIELD,e,t)}}get yValues(){return this._yValues}set yValues(e){if(e!==this._yValues){const t=this._yValues;this._yValues=null==e?void 0:e.slice(),this._changed(HichartBubbleSeries.PROP_Y_VALUES,e,t)}}get nameField(){return this._nameField}set nameField(e){if(e!==this._nameField){const t=this._nameField;this._nameField=e,this._changed(HichartBubbleSeries.PROP_NAME_FIELD,e,t)}}get names(){return this._names&&this._names.slice(0)}set names(e){if(e!==this._names){const t=this._names;this._names=e&&e.slice(0),this._changed(HichartBubbleSeries.PROP_NAMES,e,t)}}get marker(){return this._marker}get seriesType(){return"bubble"}_getEditProps(){return super._getEditProps().concat(HichartBubbleSeries.PROPINFOS)}_getFieldProps(){return[HichartBubbleSeries.PROP_X_FIELD,HichartBubbleSeries.PROP_Y_FIELD]}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartBubbleSeries.PROPINFOS),this._loadObjects([this._marker],e,t)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartBubbleSeries.PROPINFOS),this._saveObjects([this._marker],e)}getValues(e,t){const i=super.getValues(e,t),r=this._getValues(e,"x",t),s=this._getValues(e,"y",t),n=this._getValues(e,"name",t),o=[];return i&&r&&s&&i.forEach(((e,t)=>{const i={x:r[t],y:s[t],z:e};n&&(i.name=n[t]),o.push(i)})),o}wrap(e){const t=super.wrap(e);return this._getPropsWrapper(t),t.marker=this._marker.getWrapper(),Utils.extend(e,t)}}HichartBubbleSeries.PROP_X_FIELD="xField",HichartBubbleSeries.PROP_X_VALUES="xValues",HichartBubbleSeries.PROP_Y_FIELD="yField",HichartBubbleSeries.PROP_Y_VALUES="yValues",HichartBubbleSeries.PROP_NAME_FIELD="nameField",HichartBubbleSeries.PROP_NAMES="names",HichartBubbleSeries.PROP_MARKER="marker",HichartBubbleSeries.PROPINFOS=[{name:HichartBubbleSeries.PROP_X_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartBubbleSeries.PROP_X_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartBubbleSeries.PROP_Y_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartBubbleSeries.PROP_Y_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartBubbleSeries.PROP_NAME_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartBubbleSeries.PROP_NAMES,category:PropCategory.SERIES,type:StringArrayProperty,multiple:!1,default:void 0},{name:HichartBubbleSeries.PROP_MARKER,category:PropCategory.MARKER,indented:!0,type:ModelProperty,multiple:!1,default:void 0}],HichartBubbleSeries.$_ctor="HichartBubbleSeries";class DataListContainer extends ReportGroupItem{constructor(e){super(e),this._rowGap=DataListContainer.DEF_ROW_GAP,this._rowAlign=DataListContainer.DEF_ROW_ALIGN,this._itemAlign=DataListContainer.DEF_ITEM_ALIGN,this.designWidth=100,this.designHeight=160}get maxRows(){return this._maxRows}set maxRows(e){if(e!=this._maxRows){const t=this._maxRows;this._maxRows=e,this._changed(DataListContainer.PROP_MAX_ROWS,e,t)}}get rowGap(){return this._rowGap}set rowGap(e){if(e!=this._rowGap){const t=this._rowGap;this._rowGap=e,this._changed(DataListContainer.PROP_ROW_GAP,e,t)}}get rowAlign(){return this._rowAlign}set rowAlign(e){if(e!=this._rowAlign){const t=this._rowAlign;this._rowAlign=e,this._changed(DataListContainer.PROP_ROW_ALIGN,e,t)}}get itemAlign(){return this._itemAlign}set itemAlign(e){if(e!=this._itemAlign){const t=this._itemAlign;this._itemAlign=e,this._changed(DataListContainer.PROP_ITEM_ALIGN,e,t)}}getSaveType(){return"datalist"}get outlineLabel(){return"[DataList]"}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(DataListContainer.PROPINFOS)}_getStyleProps(){return DataListContainer.STYLE_PROPS}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,DataListContainer.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,DataListContainer.PROPINFOS)}}DataListContainer.DEF_ROW_GAP=4,DataListContainer.DEF_ROW_ALIGN=Align.LEFT,DataListContainer.DEF_ITEM_ALIGN=VerticalAlign.TOP,DataListContainer.PROP_MAX_ROWS="maxRows",DataListContainer.PROP_ROW_GAP="rowGap",DataListContainer.PROP_ROW_ALIGN="rowAlign",DataListContainer.PROP_ITEM_ALIGN="itemAlign",DataListContainer.PROPINFOS=[{name:DataListContainer.PROP_MAX_ROWS,category:"Data List",type:NumberProperty,multiple:!1,default:void 0},{name:DataListContainer.PROP_ROW_GAP,category:"Data List",type:NumberProperty,multiple:!1,default:DataListContainer.DEF_ROW_GAP},{name:DataListContainer.PROP_ROW_ALIGN,category:"Data List",type:EnumProperty,domain:Align,multiple:!1,default:DataListContainer.DEF_ROW_ALIGN},{name:DataListContainer.PROP_ITEM_ALIGN,category:"Data List",type:EnumProperty,domain:VerticalAlign,multiple:!1,default:DataListContainer.DEF_ITEM_ALIGN},ReportItem.VALUE_PROP],DataListContainer.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"],DataListContainer.$_ctor="DataListContainer",DataListContainer.ITEM_TYPE="DataList";class BandCell extends ReportGroupItem{constructor(e){super(e),this._weight=1}get weight(){return this._weight}set weight(e){if((e=Math.max(0,Utils.toNumber(e,1)))!==this._weight){const t=this._weight;this._weight=e,this._changed(BandCell.PROP_WEIGHT,e,t)}}loadProps(e){this._loadPropsOf(e,BandCell.PROPINFOS)}getSaveType(){return"bandcell"}get displayPath(){return this.parent?this.parent.displayPath+".cells["+this.index+"]":""}get outlineLabel(){return"[Band Cell]"}get marqueeParent(){return this.parent}_getEditProps(){return super._getEditProps().concat(BandCell.PROPINFOS)}_getStyleProps(){return BandCell.STYLE_PROPS}canResize(e){return!1}_sizable(){return!1}_maxChildCount(){return 1}canSized(){return!1}needDesignWidth(){return!1}needDesignHeight(){return!1}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,BandCell.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,BandCell.PROPINFOS)}canAdd(e){return e instanceof DataBand}canContainsBand(){return!0}}BandCell.PROP_WEIGHT="weight",BandCell.PROPINFOS=[{name:BandCell.PROP_WEIGHT,category:PropCategory.BAND_CELL,type:NumberProperty,multiple:!1,default:void 0}],BandCell.STYLE_PROPS=["backgroundColor"],BandCell.$_ctor="BandCell",BandCell.ITEM_TYPE="Band Cell";class BandGroup extends ReportGroupItem{constructor(e){super(e),this._bandGap=4,this.bandCount=2,this.width="100%",this.designHeight=160}get bandCount(){return this.count}set bandCount(e){if((e=Utils.toNumber(e,0))!==this.bandCount){const t=this.bandCount;this.$_resetCells(e),this._changed(BandGroup.PROP_BAND_COUNT,e,t)}}get bandGap(){return this._bandGap}set bandGap(e){if(Utils.isNotDefined(e)&&(e=0),e!=this._bandGap){const t=this._bandGap;this._bandGap=e,this._changed(BandGroup.PROP_BAND_GAP,e,t)}}loadProps(e){this._loadPropsOf(e,BandGroup.PROPINFOS)}getSaveType(){return"bandgroup"}get outlineLabel(){return"[Band Group]"}_getEditProps(){return super._getEditProps().concat(BandGroup.PROPINFOS)}_getStyleProps(){return BandGroup.STYLE_PROPS}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,BandGroup.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,BandGroup.PROPINFOS)}canAdd(e){return e instanceof BandCell}$_resetCells(e){for(;this.count<e;){const e=new BandCell;this.add(e)}for(;this.count>e;)this.removeLast()}}BandGroup.PROP_BAND_COUNT="bandCount",BandGroup.PROP_BAND_GAP="bandGap",BandGroup.PROPINFOS=[{name:BandGroup.PROP_BAND_COUNT,category:PropCategory.BAND_GROUP,type:NumberProperty,multiple:!1,default:void 0,calculated:!0},{name:BandGroup.PROP_BAND_GAP,category:PropCategory.BAND_GROUP,type:NumberProperty,multiple:!1,default:void 0}],BandGroup.STYLE_PROPS=[],BandGroup.$_ctor="BandGroup",BandGroup.ITEM_TYPE="Band Group";class PageItem extends ReportItem{constructor(e){super(e)}get pageName(){return this._pageName}set pageName(e){if(e!==this._pageName){const t=this._pageName;this._pageName=t,this._changed(PageItem.PROP_PAGE_NAME,e,t)}}get outlineLabel(){return"[Page]"}getSaveType(){return"page"}_datable(){return!0}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r)}_getStyleProps(){return PageItem.STYLE_PROPS}}PageItem.PROP_PAGE_NAME="pageName",PageItem.PROPINFOS=[{name:PageItem.PROP_PAGE_NAME,category:"page",type:StringProperty,multiple:!0,default:void 0}],PageItem.$_ctor="PageItem",PageItem.ITEM_TYPE="Page",PageItem.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"];class HichartScatterSeriesMarker extends HichartSeriesMarker{constructor(e){super(e),this._lineWidth=1,this._radius=4}get lineColor(){return this._lineColor}set lineColor(e){if(e!==this._lineColor){const t=this._lineColor;this._lineColor=e,this._changed(HichartScatterSeriesMarker.PROP_LINE_COLOR,e,t)}}get lineWidth(){return this._lineWidth}set lineWidth(e){if(e!==this._lineWidth){const t=this._lineWidth;this._lineWidth=e,this._changed(HichartScatterSeriesMarker.PROP_LINE_WIDTH,e,t)}}get radius(){return this._radius}set radius(e){if(e!==this._radius){const t=this._radius;this._radius=e,this._changed(HichartScatterSeriesMarker.PROP_RADIUS,e,t)}}_getEditProps(){return super._getEditProps().concat(HichartScatterSeriesMarker.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartScatterSeriesMarker.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartScatterSeriesMarker.PROPINFOS)}}HichartScatterSeriesMarker.PROP_LINE_COLOR="lineColor",HichartScatterSeriesMarker.PROP_LINE_WIDTH="lineWidth",HichartScatterSeriesMarker.PROP_RADIUS="radius",HichartScatterSeriesMarker.PROPINFOS=[{name:HichartScatterSeriesMarker.PROP_LINE_COLOR,category:PropCategory.MARKER,type:ColorProperty,multiple:!0,default:void 0},{name:HichartScatterSeriesMarker.PROP_LINE_WIDTH,category:PropCategory.MARKER,type:NumberProperty,multiple:!0,default:1},{name:HichartScatterSeriesMarker.PROP_RADIUS,category:PropCategory.MARKER,type:NumberProperty,multiple:!0,default:void 0}];class HichartScatterSeries extends HichartCartesianSeries{constructor(e){super(e),this._xValues=[161,170,172,147,159,174,154,162,168,167],this._yValues=[51,59,55,49,50,54,46,53,62,58],this._marker=new HichartScatterSeriesMarker(this),this.values=[3,4,7,9,4],this.dataLabels.visible=!1}get xField(){return this._xField}set xField(e){if(e!==this._xField){const t=this._xField;this._xField=e,this._changed(HichartScatterSeries.PROP_X_FIELD,e,t)}}get xValues(){return this._xValues}set xValues(e){if(e!==this._xValues){const t=this._xValues;this._xValues=null==e?void 0:e.slice(),this._changed(HichartScatterSeries.PROP_X_VALUES,e,t)}}get yField(){return this._yField}set yField(e){if(e!==this._yField){const t=this._yField;this._yField=e,this._changed(HichartScatterSeries.PROP_Y_FIELD,e,t)}}get yValues(){return this._yValues}set yValues(e){if(e!==this._yValues){const t=this._yValues;this._yValues=null==e?void 0:e.slice(),this._changed(HichartScatterSeries.PROP_Y_VALUES,e,t)}}get nameField(){return this._nameField}set nameField(e){if(e!==this._nameField){const t=this._nameField;this._nameField=e,this._changed(HichartScatterSeries.PROP_NAME_FIELD,e,t)}}get names(){return this._names&&this._names.slice(0)}set names(e){if(e!==this._names){const t=this._names;this._names=e&&e.slice(0),this._changed(HichartScatterSeries.PROP_NAMES,e,t)}}get marker(){return this._marker}get seriesType(){return"scatter"}hasValuesProp(){return!1}_getEditProps(){return super._getEditProps().concat(HichartScatterSeries.PROPINFOS)}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this._marker.defaultInit(e,t,i,r)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartScatterSeries.PROPINFOS),this._loadObjects([this._marker],e,t)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartScatterSeries.PROPINFOS),this._saveObjects([this._marker],e)}getValues(e,t){const i=this._getValues(e,"x",t),r=this._getValues(e,"y",t),s=this._getValues(e,"name",t),n=[];return i&&r&&i.forEach(((e,t)=>{const o={x:i[t],y:r[t]};s&&(o.name=s[t]),n.push(o)})),n}wrap(e){const t=super.wrap(e);return this._getPropsWrapper(t),t.marker=this._marker.getWrapper(),Utils.extend(e,t)}}HichartScatterSeries.PROP_X_FIELD="xField",HichartScatterSeries.PROP_X_VALUES="xValues",HichartScatterSeries.PROP_Y_FIELD="yField",HichartScatterSeries.PROP_Y_VALUES="yValues",HichartScatterSeries.PROP_NAME_FIELD="nameField",HichartScatterSeries.PROP_NAMES="names",HichartScatterSeries.PROP_MARKER="marker",HichartScatterSeries.PROPINFOS=[{name:HichartScatterSeries.PROP_X_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartScatterSeries.PROP_X_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartScatterSeries.PROP_Y_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartScatterSeries.PROP_Y_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartScatterSeries.PROP_NAME_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartScatterSeries.PROP_NAMES,category:PropCategory.SERIES,type:StringArrayProperty,multiple:!1,default:void 0},{name:HichartScatterSeries.PROP_MARKER,category:PropCategory.MARKER,indented:!0,type:ModelProperty,multiple:!1,default:void 0}],HichartScatterSeries.$_ctor="HichartScatterSeries";class DataMatrixItem extends ReportItem{constructor(e){super(e),this._text=""}get text(){return this._text}set text(e){if(e!==this._text){const t=this._text;this._text=e,this._changed(DataMatrixItem.PROP_TEXT,e,t)}}get pad(){return this._pad}set pad(e){if(e!==this._pad){const t=this._pad;this._pad=e,this._changed(DataMatrixItem.PROP_PAD,e,t)}}getSaveType(){return"datamatrix"}get outlineLabel(){return"DataMatrix"}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.text="https://www.real-report.com/",this.width=100,this.height=100}_getEditProps(){return super._getEditProps().concat(DataMatrixItem.PROPINFOS)}_getStyleProps(){return DataMatrixItem.STYLE_PROPS}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,DataMatrixItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,DataMatrixItem.PROPINFOS)}}DataMatrixItem.MIN_SIZE=10,DataMatrixItem.PROP_TEXT="text",DataMatrixItem.PROP_PAD="pad",DataMatrixItem.PROPINFOS=[{name:DataMatrixItem.PROP_TEXT,category:PropCategory.BARCODE,type:StringProperty},{name:DataMatrixItem.PROP_PAD,category:PropCategory.BARCODE,type:NumberProperty}],DataMatrixItem.STYLE_PROPS=["color","backgroundColor","border"],DataMatrixItem.$_ctor="DataMatrixItem",DataMatrixItem.ITEM_TYPE="DataMatrix";class HichartBoxplotSeries extends HichartCartesianSeries{constructor(e){super(e),this._lowValues=[760,733,714,724,834],this._q1Values=[801,853,762,802,836],this._medianValues=[848,939,817,806,864],this._q3Values=[895,980,870,871,882],this._highValues=[965,1080,918,950,910],this.dataLabels.visible=!1}get lowField(){return this._lowField}set lowField(e){if(e!==this._lowField){const t=this._lowField;this._lowField=e,this._changed(HichartBoxplotSeries.PROP_LOW_FIELD,e,t)}}get lowValues(){return this._lowValues}set lowValues(e){if(e!==this._lowValues){const t=this._lowValues;this._lowValues=null==e?void 0:e.slice(),this._changed(HichartBoxplotSeries.PROP_LOW_VALUES,e,t)}}get q1Field(){return this._q1Field}set q1Field(e){if(e!==this._q1Field){const t=this._q1Field;this._q1Field=e,this._changed(HichartBoxplotSeries.PROP_Q1_FIELD,e,t)}}get q1Values(){return this._q1Values}set q1Values(e){if(e!==this._q1Values){const t=this._q1Values;this._q1Values=null==e?void 0:e.slice(),this._changed(HichartBoxplotSeries.PROP_Q1_VALUES,e,t)}}get medianField(){return this._medianField}set medianField(e){if(e!==this._medianField){const t=this._medianField;this._medianField=e,this._changed(HichartBoxplotSeries.PROP_MEDIAN_FIELD,e,t)}}get medianValues(){return this._medianValues}set medianValues(e){if(e!==this._medianValues){const t=this._medianValues;this._medianValues=null==e?void 0:e.slice(),this._changed(HichartBoxplotSeries.PROP_MEDIAN_VALUES,e,t)}}get q3Field(){return this._q3Field}set q3Field(e){if(e!==this._q3Field){const t=this._q3Field;this._q3Field=e,this._changed(HichartBoxplotSeries.PROP_Q3_FIELD,e,t)}}get q3Values(){return this._q3Values}set q3Values(e){if(e!==this._q3Values){const t=this._q3Values;this._q3Values=null==e?void 0:e.slice(),this._changed(HichartBoxplotSeries.PROP_Q3_VALUES,e,t)}}get highField(){return this._highField}set highField(e){if(e!==this._highField){const t=this._highField;this._highField=e,this._changed(HichartBoxplotSeries.PROP_HIGH_FIELD,e,t)}}get highValues(){return this._highValues}set highValues(e){if(e!==this._highValues){const t=this._highValues;this._highValues=null==e?void 0:e.slice(),this._changed(HichartBoxplotSeries.PROP_HIGH_VALUES,e,t)}}get seriesType(){return"boxplot"}hasValuesProp(){return!1}_getEditProps(){return super._getEditProps().concat(HichartBoxplotSeries.PROPINFOS)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartBoxplotSeries.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartBoxplotSeries.PROPINFOS)}getValues(e,t){const i=this._getValues(e,"low",t),r=this._getValues(e,"q1",t),s=this._getValues(e,"median",t),n=this._getValues(e,"q3",t),o=this._getValues(e,"high",t),a=[];return i&&r&&s&&n&&o&&i.forEach(((e,t)=>{const A={low:i[t],q1:r[t],median:s[t],q3:n[t],high:o[t]};a.push(A)})),a}wrap(e){const t=super.wrap(e);return this._getPropsWrapper(t),Utils.extend(e,t)}}HichartBoxplotSeries.PROP_LOW_FIELD="lowField",HichartBoxplotSeries.PROP_LOW_VALUES="lowValues",HichartBoxplotSeries.PROP_Q1_FIELD="q1Field",HichartBoxplotSeries.PROP_Q1_VALUES="q1Values",HichartBoxplotSeries.PROP_MEDIAN_FIELD="medianField",HichartBoxplotSeries.PROP_MEDIAN_VALUES="medianValues",HichartBoxplotSeries.PROP_Q3_FIELD="q3Field",HichartBoxplotSeries.PROP_Q3_VALUES="q3Values",HichartBoxplotSeries.PROP_HIGH_FIELD="highField",HichartBoxplotSeries.PROP_HIGH_VALUES="highValues",HichartBoxplotSeries.PROPINFOS=[{name:HichartBoxplotSeries.PROP_LOW_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartBoxplotSeries.PROP_LOW_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartBoxplotSeries.PROP_Q1_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartBoxplotSeries.PROP_Q1_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartBoxplotSeries.PROP_MEDIAN_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartBoxplotSeries.PROP_MEDIAN_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartBoxplotSeries.PROP_Q3_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartBoxplotSeries.PROP_Q3_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0},{name:HichartBoxplotSeries.PROP_HIGH_FIELD,category:PropCategory.SERIES,type:ListableProperty,multiple:!1,default:void 0},{name:HichartBoxplotSeries.PROP_HIGH_VALUES,category:PropCategory.SERIES,type:NumberArrayProperty,multiple:!1,default:void 0}],HichartBoxplotSeries.$_ctor="HichartBoxplotSeries";class HichartHistogramSeries extends HichartCartesianSeries{constructor(e){super(e),this.dataLabels.visible=!1}get baseSeries(){return this._baseSeries}set baseSeries(e){if(e!==this._baseSeries){const t=this._baseSeries;this._baseSeries=e,this._changed(HichartHistogramSeries.PROP_BASE_SERIES,e,t)}}get binsNumber(){const e=+this._binsNumber;return isNaN(e)?this._binsNumber:e}set binsNumber(e){if(e!==this._binsNumber){const t=this._binsNumber;this._binsNumber=e,this._changed(HichartHistogramSeries.PROP_BINS_NUMBER,e,t)}}get binWidth(){return this._binWidth}set binWidth(e){if(e!==this._binWidth){const t=this._binWidth;this._binWidth=e,this._changed(HichartHistogramSeries.PROP_BIN_WIDTH,e,t)}}get seriesType(){return"histogram"}_getEditProps(){return super._getEditProps().concat(HichartHistogramSeries.PROPINFOS)}getPropDomain(e){if(e.name===HichartHistogramSeries.PROP_BASE_SERIES)return this.chart.series.getIds(this.id)}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HichartHistogramSeries.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HichartHistogramSeries.PROPINFOS)}wrap(e){return super.wrap(e),this.assignProps(e,[HichartHistogramSeries.PROP_BASE_SERIES,HichartHistogramSeries.PROP_BINS_NUMBER,HichartHistogramSeries.PROP_BIN_WIDTH])}}HichartHistogramSeries.PROP_BASE_SERIES="baseSeries",HichartHistogramSeries.PROP_BINS_NUMBER="binsNumber",HichartHistogramSeries.PROP_BIN_WIDTH="binWidth",HichartHistogramSeries.PROPINFOS=[{name:HichartHistogramSeries.PROP_BASE_SERIES,category:PropCategory.SERIES,type:ListableProperty},{name:HichartHistogramSeries.PROP_BINS_NUMBER,category:PropCategory.SERIES,type:EditListableProperty,domain:[void 0,"square-root","sturges","rice"]},{name:HichartHistogramSeries.PROP_BIN_WIDTH,category:PropCategory.SERIES,type:NumberProperty}],HichartHistogramSeries.$_ctor="HichartHistogramSeries";const TAGS=["/","br","b","i","strong","em","mark","site","dfn","span","img"];class HtmlItem extends ReportItem{constructor(e){super(e)}get html(){return this._html}set html(e){if(e){let t=0;for(;;){const i=e.indexOf("<",t);if(!(i>=0))break;{let r=!1;for(const s of TAGS)if(e.startsWith(s,i+1)){r=!0,t=i+s.length;break}if(!r){console.error("사용할 수 없는 tag입니다: "+e.substring(i));break}}}}if(e!=this._html){const t=this._html;this._html=e,this.$_parseValues(e),this._changed(HtmlItem.PROP_HTML,e,t)}}getHtml(e){const t=this._tokens;let i=this._html;if(e.printing&&t&&t.length>0){const r=this.data;let s="",n=0;t.forEach((t=>{s+=i.substring(n,t.from);let o=i.substring(t.from+2,t.to-1);"value"===o&&(o=this.value);const a=e.dp.getValueAt(r,o,e.row);s+=void 0===a?"":a,n=t.to})),i=s+i.substring(n,i.length)}return i||""}getSaveType(){return"html"}get outlineLabel(){return"[Html]"}_doDefaultInit(e,t,i,r){super._doDefaultInit(e,t,i,r),this.html="${value}"}_getEditProps(){return super._getEditProps().concat(HtmlItem.PROPINFOS)}_getStyleProps(){return HtmlItem.STYLE_PROPS}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,HtmlItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,HtmlItem.PROPINFOS)}canRotate(){return!0}canAdoptDragSource(e){return e instanceof ReportDataPath}adoptDragSource(e){if(e instanceof ReportDataPath)return{type:DropResultType.PROP,prop:"value",value:e.data+"::"+e.path}}canPropAdoptDragSource(e,t){return"value"===e.name&&t instanceof ReportDataPath}adoptPropDragSource(e,t){if("value"===e.name&&t instanceof ReportDataPath)return{type:DropResultType.PROP,prop:"value",value:t.data+"::"+t.path}}$_parse(e,t,i){const r=e.indexOf(i,t);if(r>=0){const t=e.indexOf("}",r+i.length);if(t>=0)return{from:r,to:t+1}}}$_parseValues(e){let t=this._tokens=void 0;if(e){let i=0;for(;;){const r=this.$_parse(e,i,"${")||this.$_parse(e,i,"%{");if(!r)break;t||(t=this._tokens=[]),t.push(r),i=r.to}}}}HtmlItem.PROP_HTML="html",HtmlItem.PROPINFOS=[{name:HtmlItem.PROP_HTML,category:PropCategory.TEXT,type:StringProperty,multiple:!0,default:void 0}],HtmlItem.STYLE_PROPS=["fontFamily","fontSize","fontStyle","textDecoration","fontWeight","lineHeight","color","backgroundColor","textAlign","writingMode","scale","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"],HtmlItem.$_ctor="HtmlItem",HtmlItem.ITEM_TYPE="Html";class ReportLoaderImpl extends Base{constructor(){super(),this._itemCreators={text:e=>new TextItem(e),summary:e=>new SummaryItem(e),image:e=>new ImageItem(e),check:e=>new CheckItem(e),stack:e=>new StackContainer(e),cbox:e=>new ColumnBoxContainer(e),rbox:e=>new RowBoxContainer(e),dbox:e=>new DiagonalBoxContainer(e),list:e=>new ListContainer(e),table:e=>new TableContainer(e),space:e=>new SpaceItem(e),simpleband:e=>new SimpleBand(e),tableband:e=>new TableBand(e),bandgroup:e=>new BandGroup(e),bandcell:e=>new BandCell(e),crosstab:e=>new CrosstabBand(e),datalist:e=>new DataListContainer(e),floating:e=>new FloatingContainer(e),shape:e=>new ShapeItem(e),barcode:e=>new BarcodeItem(e),qrcode:e=>new QrcodeItem(e),datamatrix:e=>new DataMatrixItem(e),bar:e=>new BarItem(e),rating:e=>new RatingItem(e),html:e=>new HtmlItem(e),svg:e=>new SvgItem(e),chart:e=>new HichartItem(e),hichart:e=>new HichartItem(e),highchart:e=>new HichartItem(e),page:e=>new PageItem(e)},this._hichartSeriesCreators={column:e=>new HichartColumnSeries(e),bar:e=>new HichartBarSeries(e),line:e=>new HichartLineSeries(e),spline:e=>new HichartSplineSeries(e),area:e=>new HichartAreaSeries(e),areaspline:e=>new HichartAreaSplineSeries(e),arearange:e=>new HichartAreaRangeSeries(e),pie:e=>new HichartPieSeries(e),bubble:e=>new HichartBubbleSeries(e),scatter:e=>new HichartScatterSeries(e),boxplot:e=>new HichartBoxplotSeries(e),histogram:e=>new HichartHistogramSeries(e)}}_doDispose(){super._doDispose()}createItem(e){const t="string"==typeof e?e:e.type,i=e.name,r=this._itemCreators[t];let s=r&&r(i);return!s&&(e.hasOwnProperty("text")||e.hasOwnProperty("value")||e.hasOwnProperty("title"))&&(s=new TextItem(i)),s}createHichartSeries(e,t){let i="string"==typeof t?t:t.type;const r=this._hichartSeriesCreators[i]||this._hichartSeriesCreators.column;return r&&r(e)}}class AddItemCommand extends EditCommand{constructor(e,t){super("Add Item"),assert(!!e),assert(!!t),assert(e!==t),this._parent=e,this._item=t}_doDispose(){this._parent=this._item=null}get parent(){return this._parent}get item(){return this._item}undo(){this._parent.remove(this._item)}redo(e){if(!this._parent.add(this._item))throw new EditCommandFailed("Item is not added.")}get source(){return this._item}}class SetPropCommand extends EditCommand{constructor(e,t,i){super("Set Property"),assert(!!e),assert(!!t),this._item=e,this._prop=t,this._childProp=e instanceof ReportItem&&e.isChildProp(t),this._newValue=i,this._oldValue=this._childProp?e.getChildProp(t):e[t]}_doDispose(){this._item=null}get item(){return this._item}get prop(){return this._prop}get childProp(){return this._childProp}get oldValue(){return this._oldValue}get newValue(){return this._newValue}undo(){this._childProp?this._item.setChildProp(this._prop,this._oldValue):this._item[this._prop]=this._oldValue}redo(e){this._childProp?this._item.setChildProp(this._prop,this._newValue):this._item[this._prop]=this._newValue}get description(){return"prop."+this._prop+": "+this._oldValue+" -> "+this._newValue}get source(){return this._item}}class UpdateDataBandFieldCommand extends EditCommand{constructor(e,t,i){super("Update Band Field"),assert(!!e),assert(!!i),this._data=e,this._index=t,this._field=i,this._oldField={...e.getField(t)}}_doDispose(){this._data=this._field=this._oldField=null}get data(){return this._data}get index(){return this._index}get field(){return this._field}get oldField(){return this._oldField}undo(){this._data.setField(this._index,this._oldField)}redo(e){this._data.setField(this._index,this._field)}get source(){return this._data}}class AddDataBandFieldCommand extends EditCommand{constructor(e,t,i){super("Add Band Field"),assert(!!e),assert(!!i),this._data=e,this._index=t,this._field=i}_doDispose(){this._data=this._field=null}get data(){return this._data}get index(){return this._index}get field(){return this._field}redo(e){this._data.addField(this._index,this._field)}undo(){this._data.removeField(this._field)}get source(){return this._data}}class RemoveBandDataFieldCommand extends EditCommand{constructor(e,t,i){super("Remove Band Field"),assert(!!e),assert(!!i),this._data=e,this._index=t,this._field=i}_doDispose(){this._data=this._field=null}get data(){return this._data}get index(){return this._index}get field(){return this._field}redo(e){this._data.removeField(this._field)}undo(){this._data.addField(this._index,this._field)}get source(){return this._data}}class ReportDataProvider extends Base{constructor(){super(),this._dataMap={}}_doDispose(){this._dataMap=null,this._contextData=null,super._doDispose()}preparePrint(e){this._contextData=new ContextData(e);for(let t in this._dataMap){const i=this._dataMap[t];i instanceof ReportData&&i.preparePrint(e,!1)}}getAll(){const e=[];for(let t in this._dataMap)e.push(this._dataMap[t]);return e}get(e){return this._dataMap[e]}getContextValue(e){return this._contextData.getValue(e)}getValue(e,t){if(e){const i=e.indexOf("::"),r=i>=0?e.substring(0,i):e,s=this._dataMap[r];if(s){if(e=i>=0?e.substr(i+2):null,!(s instanceof BandData))return s.getValue(e);if(t>=0)return s.getRowValue(t,e)}}}getValueAt(e,t,i){const r=this._dataMap[e];if(r)return r instanceof BandData?r.getRowValue(i,t):r.getValue(t)}getFieldValues(e,t,i){const r=this._dataMap[e];if(r)return r instanceof BandData?r.getFieldValues(t,i):[r.getValue(t)]}clear(){return this._dataMap={},this._contextData=null,this}register(e,t){return e||(e=t.name),validateRegisterReportData(e,this._dataMap,t)&&(this._dataMap[e]=t),this}load(e){validateLoadReportData(e,this);for(let t in e){const i=e[t],r=i.values;let s=i.type;switch(s||(s=validateReportDataType(t,r)),s){case"band":this.register(t,new BandArrayData(t,null,r));break;case"simple":this.register(t,new SimpleData(t,r));break;default:throw new Error("데이터의 형식이 잘못되었습니다.")}}return this}}function checkDataTypeValues(e,t){t.type===ReportDataType.SIMPLE&&Utils.isArray(t.values)&&console.warn(`[${e}] 데이터의 type은 ${ReportDataType.SIMPLE}로 선언됐으나 ${ReportDataType.BAND} 데이터로 로드됩니다.`),t.type===ReportDataType.BAND&&Utils.isObject(t.values)&&console.warn(`[${e}] 데이터의 type은 ${ReportDataType.BAND}로 선언됐으나 ${ReportDataType.SIMPLE} 데이터로 로드됩니다.`)}function validateDesignManagerData(e,t){if(!t.hasOwnProperty("sample")&&!t.hasOwnProperty("fields"))throw new Error(`${e} ${ReportDataErrorMessage.DATA_FORMAT_IS_INCORRECT}`)}function validateReportDataProvider(e,t){if(!t.hasOwnProperty("values"))throw new Error(`${e} 데이터의 values 데이터가 존재하지 않습니다.`);checkDataTypeValues(e,t)}function validateRegisterReportData(e,t,i){if(!i||!i.name)return!1;if(t[e])throw new Error(`Data is already exists: ${e}`);return!0}function validateLoadReportData(e,t){if(!e)throw new Error(ReportDataErrorMessage.DATA_FORMAT_IS_INCORRECT);for(let i in e){if(!e[i]||!Utils.isObjectNotEmpty(e[i]))throw new Error(`${i} ${ReportDataErrorMessage.DATA_FORMAT_IS_INCORRECT}`);t instanceof DesignDataManager&&validateDesignManagerData(i,e[i]),t instanceof ReportDataProvider&&validateReportDataProvider(i,e[i])}}function validateReportDataType(e,t){if(Utils.isArray(t))return"band";if(Utils.isObject(t))return"simple";throw new Error(`${e} ${ReportDataErrorMessage.DATA_FORMAT_IS_INCORRECT}`)}class DesignDataManager extends EventAware{constructor(e){super(),this._dataMap={},this._commands=e}_doDispose(){this._dataMap=null,this._contextData=null,super._doDispose()}get designTime(){return!0}preparePrint(e){this._contextData=new ContextData(e),this._contextData.preparePrint(e,!0);for(let t in this._dataMap){const i=this._dataMap[t];i instanceof ReportData&&i.preparePrint(e,!0)}}getAll(){const e=[];for(let t in this._dataMap)e.push(this._dataMap[t]);return e}getNames(){const e=[];for(let t in this._dataMap)e.push(t);return e}get(e){return this._dataMap[e]}getContextValue(e){return this._contextData.getValue(e)}getValue(e,t){if(e){const i=e.indexOf("::"),r=i>=0?e.substring(0,i):e,s=this._dataMap[r];if(s)return e=i>=0?e.substr(i+2):null,s instanceof BandData?s.getRowValue(t,e):s.getValue(e)}}getValueAt(e,t,i){const r=this._dataMap[e];if(r)return r instanceof BandData?r.getRowValue(i,t):r.getValue(t)}getFieldValues(e,t,i){const r=this._dataMap[e];if(r)return r instanceof BandData?r.getFieldValues(t,i):[r.getValue(t)]}addData(e){if(e)return this.$_register(null,e),this.$_fireDataAdded(e),!0}removeData(e){const t="string"==typeof e?e:e.name,i=this.get(t);if(i)return this.$_unregister(i),this.$_fireDataRemoved(i),i}dataNameChanged(e,t){this.fireEvent(DesignDataManager.NAME_CHANGED,e,t)}fieldNameChanged(e,t,i){this.fireEvent(DesignDataManager.FIELD_NAME_CHANGED,e,t,i)}load(e){validateLoadReportData(e,this);for(let t in e){const i=e[t],r=i.sample,s=i.fields;let n=i.type;switch(n||(n=validateReportDataType(t,r)),n){case"band":this.$_register(t,new BandArrayData(t,s,r,i.sampleCount,this));break;case"simple":this.$_register(t,new SimpleData(t,r));break;default:throw new Error("데이터의 형식이 잘못되었습니다.")}}return this}save(e){for(let t in this._dataMap){const i=this._dataMap[t],r=i.getSaveValues(),s=e[t]={type:i.getSaveType()};r&&(s.sample=r),i instanceof BandData&&(s.fields=i.getSaveFields())}}getFieldIndex(e,t){const i=this._dataMap[e];return i instanceof BandData?i.getFieldIndex(t):-1}updateField(e,t,i){var r;null===(r=this._commands)||void 0===r||r.execute(new UpdateDataBandFieldCommand(e,t,i)),this.$_fireDataUpdated(e)}addField(e,t,i){var r;i&&e.indexOfField(i)<0&&(null===(r=this._commands)||void 0===r||r.execute(new AddDataBandFieldCommand(e,t,i)),this.$_fireDataUpdated(e))}removeField(e,t){var i;const r=e.indexOfField(t);r>=0&&(null===(i=this._commands)||void 0===i||i.execute(new RemoveBandDataFieldCommand(e,r,t)),this.$_fireDataUpdated(e))}renameData(e,t){delete this._dataMap[e.name],e.name=t,this._dataMap[t]=e}$_register(e,t){if(e||(e=t.name),validateRegisterReportData(e,this._dataMap,t))return t._dp=this,this._dataMap[e]=t,t}$_unregister(e){e&&e._dp===this&&(delete this._dataMap[e.name],e._dp=null)}$_fireDataAdded(e){this.fireEvent(DesignDataManager.DATA_ADDED,e)}$_fireDataRemoved(e){this.fireEvent(DesignDataManager.DATA_REMOVED,e)}$_fireDataUpdated(e){this.fireEvent(DesignDataManager.DATA_UPDATED,e)}}DesignDataManager.DATA_ADDED="onDesignDataManagerDataAdded",DesignDataManager.DATA_REMOVED="onDesignDataManagerDataRemoved",DesignDataManager.DATA_UPDATED="onDesignDataManagerDataUpdated",DesignDataManager.NAME_CHANGED="onDesignDataManagerNameChanged",DesignDataManager.FIELD_NAME_CHANGED="onDesignDataManagerFieldNameChanged";class AddAssetCommand extends EditCommand{constructor(e,t,i){super("Add Asset"),assert(!!e),assert(!!i),this._manager=e,this._group=t||e.root,this._item=i}_doDispose(){this._group=this._item=null}get manager(){return this._manager}get group(){return this._group}get item(){return this._item}undo(){this._manager.remove(this._item)}redo(e){this._manager.add(this._group,this._item)}get source(){return this._item}}class RemoveAssetCommand extends EditCommand{constructor(e,t){super("Remove Asset"),assert(!!e),assert(!!t),this._manager=e,this._group=t.parent,this._item=t}_doDispose(){this._group=this._item=null}get manager(){return this._manager}get group(){return this._group}get item(){return this._item}undo(){this._manager.add(this._group,this._item)}redo(e){this._manager.remove(this._item)}get source(){return this._group}}class RenameDataCommand extends EditCommand{constructor(e,t,i){super("Set Property"),assert(!!e),assert(!!t),assert(!!i),this._dm=e,this._data=t,this._oldName=t.name,this._newName=i}_doDispose(){this._dm=null,this._data=null}get data(){return this._data}get oldName(){return this._oldName}get newName(){return this._newName}undo(){this._dm.renameData(this._data,this._oldName)}redo(e){this._dm.renameData(this._data,this._newName)}get description(){return"rename data: "+this._oldName+" -> "+this._newName}get source(){return this._data}}class AddDataCommand extends EditCommand{constructor(e,t){super("Add Data"),assert(!!e),assert(!!t),this._dm=e,this._data=t}_doDispose(){this._dm=null,this._data=null}get data(){return this._data}undo(){this._dm.removeData(this._data)}redo(e){this._dm.addData(this._data)}get description(){return"Add data: "+this._data.name}get source(){return this._data}}class RemoveDataCommand extends EditCommand{constructor(e,t){super("Remove Data"),assert(!!e),assert(!!t),this._dm=e,this._data=t}_doDispose(){this._dm=null,this._data=null}get data(){return this._data}undo(){this._dm.addData(this._data)}redo(e){this._dm.removeData(this._data)}get description(){return"Remove data: "+this._data.name}get source(){return this._data}}class SaveSimpleDataCommand extends EditCommand{constructor(e,t){super("Save Simple Data"),assert(!!e),assert(!!t),this._data=e,this._values=t}_doDispose(){this._data=null,this._values=null}get data(){return this._data}undo(){this._data.setSample(this._oldValues)}redo(e){this._data.setSample(this._values)}get description(){return"Save simple data: "+this._data.name}get source(){return this._data}}class SetStyleCommand extends EditCommand{constructor(e,t,i){super("Set Style"),assert(!!e),assert(!!t),this._item=e,this._style=t,this._newValue=i,this._oldValue=this._item.getStyle(t)}_doDispose(){this._item=null}get item(){return this._item}get style(){return this._style}get oldValue(){return this._oldValue}get newValue(){return this._newValue}undo(){this._item.setStyle(this._style,this._oldValue)}redo(e){this._item.setStyle(this._style,this._newValue)}get description(){return"style."+this._style+": "+this._oldValue+" -> "+this._newValue}get source(){return this._item}}class MoveItemCommand extends EditCommand{constructor(e,t,i,r=!1){super("Move Item"),assert(!!e),this._item=e,this._oldLeft=e.left,this._oldRight=e.right,this._oldTop=e.top,this._oldBottom=e.bottom,this._newLeft=t,this._newTop=i,this._persistant=r}static createCommands(e,t){if(e&&e.length>0){const i=[];return e.forEach(((e,r)=>{i.push(new MoveItemCommand(e,t[r].x,t[r].y))})),i.length>0?i:null}}_doDispose(){this._item=null}redo(e){this._item.setChildProp("left",this._newLeft),!this._persistant&&this._item.setChildProp("right",void 0),this._item.setChildProp("top",this._newTop),!this._persistant&&this._item.setChildProp("bottom",void 0)}undo(){this._item.setChildProp("left",this._oldLeft),!this._persistant&&this._item.setChildProp("right",this._oldRight),this._item.setChildProp("top",this._oldTop),!this._persistant&&this._item.setChildProp("bottom",this._oldBottom)}get description(){return"Move item: "+this._item.designText}get source(){return this._item}}class MoveItemsCommand extends EditCommandGroup{constructor(e,t){super("Move Items",MoveItemCommand.createCommands(e,t))}}class MoveItemDirCommand extends EditCommand{constructor(e,t,i){super("Move Item One Way"),assert(!!e),this._item=e,this._dir=t,this._old=e[t],this._new=i}static createCommands(e,t,i){if(e&&e.length>0){const r=[];return e.forEach(((e,s)=>{r.push(new MoveItemDirCommand(e,t,i[s]))})),r.length>0?r:null}}_doDispose(){this._item=null}redo(e){this._item.setChildProp(this._dir,this._new)}undo(){this._item.setChildProp(this._dir,this._old)}get description(){return"Move item One Way: "+this._item.designText}get source(){return this._item}}class MoveItemsDirCommand extends EditCommandGroup{constructor(e,t,i){super("Move Items One Way",MoveItemDirCommand.createCommands(e,t,i))}}class MoveCollectionItemCommand extends EditCommand{constructor(e,t,i){super("Move Collection Item"),assert(!!e),this._collection=e,this._from=t,this._to=i}_doDispose(){this._collection=null}redo(e){this._collection.moveItem(this._from,this._to)}undo(){this._collection.moveItem(this._to,this._from)}get description(){return"Move collection item: "+this._from+" -> "+this._to}get source(){return this._collection.get(this._to)}}class ResizeItemCommand extends EditCommand{constructor(e,t,i,r,s,n,o){super("Resize Item"),assert(!!e),this._item=e,this._saveWidth=t,this._saveHeight=i,this._oldWidth=r,this._oldHeight=s,this._dx=n,this._dy=o}_doDispose(){this._item=null}redo(e){this._dx&&(this._item.width=this._oldWidth+this._dx),this._dy&&(this._item.height=this._oldHeight+this._dy)}undo(){this._dx&&(this._item.width=this._saveWidth),this._dy&&(this._item.height=this._saveHeight)}get description(){return"Resize item: "+this._item.designText}get source(){return this._item}}class ResizeAndMoveCommand extends EditCommandGroup{static createCommand(e,t,i,r,s,n,o,a,A){return[new ResizeItemCommand(e,t,i,r,s,n,o),new MoveItemCommand(e,a,A,!0)]}constructor(e,t,i,r,s,n,o,a,A){super("Resize and Move Item",ResizeAndMoveCommand.createCommand(e,t,i,r,s,n,o,a,A))}}class SetPropsCommand extends EditCommand{constructor(e,t){super("Set Properties"),assert(!!e),assert(!!t),this._item=e,this._props={...t},this._oldProps=e.getProperties(t)}_doDispose(){this._item=null,this._props=null}get item(){return this._item}get props(){return this._props}redo(e){this._item.setProperties(this._props)}undo(){this._item.setProperties(this._oldProps)}get source(){return this._item}}class SetChildStyleCommand extends EditCommand{constructor(e,t,i,r){super("Set Child Style"),assert(!!e),assert(!!t),assert(!!i),this._item=e,this._prop=t,this._style=i,this._newValue=r,this._oldValue=this._item._getSubStyle(t,i)}_doDispose(){this._item=null}get item(){return this._item}get prop(){return this._prop}get style(){return this._style}get oldValue(){return this._oldValue}get newValue(){return this._newValue}undo(){this._item._setSubStyle(this._prop,this._style,this._oldValue)}redo(e){this._item._setSubStyle(this._prop,this._style,this._newValue)}get description(){return this._prop+".style."+this._style+": "+this._oldValue+" -> "+this._newValue}get source(){return this._item}}class AddTableBandGroupCommand extends EditCommand{constructor(e,t,i){super("Add Table Band Group"),assert(!!e),this._band=e,this._index=Math.max(0,e.groups.count),this._config=i}_doDispose(){this._band=null}get band(){return this._band}get index(){return this._index}redo(e){this._group=this._band.groups.add(this._config,this._index)}undo(){this._band.groups.remove(this._group)}get source(){return this._band}}class ChangeChildIndexCommand extends EditCommand{constructor(e,t){super("Change child index"),assert(!!e),this._item=e,this._newIndex=t,this._oldIndex=e.index}_doDispose(){this._item=null}redo(e){this._item.parent.changeChildIndex(this._item,this._newIndex)}undo(){this._item.parent.changeChildIndex(this._item,this._oldIndex)}get description(){return"Change child index: "+this._item.designText}get source(){return this._item}}class SetItemsPropCommand extends EditCommand{constructor(e,t,i){super("Set Items Property"),assert(!!e&&e.length>0),assert(!!t),this._items=e.slice(),this._prop=t,this._childProps=[],this._oldValues=[],this._newValue=i,this._items.forEach((e=>{const i=e instanceof ReportItem&&e.isChildProp(t);this._childProps.push(i),this._oldValues.push(i?e.getChildProp(t):e[t])}))}_doDispose(){this._items=null}get items(){return this._items.slice()}get prop(){return this._prop}get newValue(){return this._newValue}undo(){this._items.forEach(((e,t)=>{this._childProps[t]?e.setChildProp(this._prop,this._oldValues[t]):Utils.hasSetter(e,this._prop)&&(e[this._prop]=this._oldValues[t])}))}redo(e){this._items.forEach(((e,t)=>{this._childProps[t]?e.setChildProp(this._prop,this._newValue):Utils.hasSetter(e,this._prop)&&(e[this._prop]=this._newValue)}))}get description(){return"prop."+this._prop+", "+this._newValue}get source(){return this._items.slice()}}class SetItemsStyleCommand extends EditCommand{constructor(e,t,i){super("Set Items Style"),assert(!!e&&e.length>0),assert(!!t),this._items=e.slice(),this._style=t,this._newValue=i,this._oldValues=[],this._items.forEach((e=>{this._oldValues.push(e.getStyle(t))}))}_doDispose(){this._items=null}get items(){return this._items.slice()}get style(){return this._style}get newValue(){return this._newValue}undo(){this._items.forEach(((e,t)=>{e.setStyle(this._style,this._oldValues[t])}))}redo(e){this._items.forEach(((e,t)=>{e.setStyle(this._style,this._newValue)}))}get description(){return"style."+this._style+": "+this._newValue}get source(){return this._items.slice()}}class SetItemsChildStyleCommand extends EditCommand{constructor(e,t,i,r){super("Set Child Style"),assert(!!e&&e.length>0),assert(!!t),assert(!!i),this._items=e.slice(),this._prop=t,this._style=i,this._newValue=r,this._oldValues=[],this._items.forEach((e=>{this._oldValues.push(e._getSubStyle(t,i))}))}_doDispose(){this._items=null}get items(){return this._items.slice()}get prop(){return this._prop}get style(){return this._style}get newValue(){return this._newValue}undo(){this._items.forEach(((e,t)=>{e._setSubStyle(this._prop,this._style,this._oldValues[t])}))}redo(e){this._items.forEach((e=>{e._setSubStyle(this._prop,this._style,this._newValue)}))}get description(){return this._prop+".style."+this._style+": "+this._newValue}get source(){return this._items.slice()}}class SetItemsPropsCommand extends EditCommand{constructor(e,t){super("Set Items Properties"),assert(!!e&&e.length),assert(!!t),this._items=e.slice(),this._props={...t},this._oldProps=[],this._items.forEach((e=>{this._oldProps.push(e.getProperties(t))}))}_doDispose(){this._items=null,this._props=null}get items(){return this._items.slice()}get props(){return this._props}redo(e){this._items.forEach(((e,t)=>{e.setProperties(this._props)}))}undo(){this._items.forEach(((e,t)=>{e.setProperties(this._oldProps[t])}))}get source(){return this._items.slice()}}class AddSimpleBandGroupCommand extends EditCommand{constructor(e,t,i){super("Add Simple Band Group"),assert(!!e),this._band=e,this._index=Math.max(0,e.groups.count),this._config=i}_doDispose(){this._band=null}get band(){return this._band}get index(){return this._index}redo(e){this._group=this._band.groups.add(this._config,this._index)}undo(){this._band.groups.remove(this._group)}get source(){return this._band}}class ResizeSpaceCommand extends EditCommand{constructor(e,t,i,r){super("Resize Space Item"),assert(!!e),this._item=e,this._orgSize=t,this._oldSize=i,this._delta=r}_doDispose(){this._item=null}redo(e){this._item.size=this._oldSize+this._delta}undo(){this._item.size=this._orgSize}get description(){return"Resize space item"}get source(){return this._item}}class ChangeBandCountCommand extends EditCommand{constructor(e,t){if(super("Change table cols"),assert(!!e),this._group=e,this._oldCount=e.bandCount,this._count=t,t<this._oldCount){this._deleted=[];for(let i=t;i<this._oldCount;i++){const t=e.get(i);this._deleted.push(t)}}}_doDispose(){this._group=null}get table(){return this._group}get cols(){return this._count}redo(e){this._group.bandCount=this._count}undo(){const e=this._group;this._oldCount>this._count?this._deleted.forEach(((t,i)=>{e.add(t)})):e.bandCount=this._oldCount}get source(){return this._group}}var PaperSize;!function(e){e.A0="A0",e.A1="A1",e.A2="A2",e.A3="A3",e.A4="A4",e.A5="A5",e.A6="A6",e.A7="A7",e.A8="A8"}(PaperSize||(PaperSize={}));const PaperSizeMap={A0:{w:841,h:1189},A1:{w:594,h:841},A2:{w:420,h:594},A3:{w:297,h:420},A4:{w:210,h:297},A5:{w:148,h:210},A6:{w:105,h:148},A7:{w:74,h:105},A8:{w:52,h:74}};var PaperOrientation;!function(e){e.PORTRAIT="portrait",e.LANDSCAPE="landscape"}(PaperOrientation||(PaperOrientation={}));class PaperOptions extends Base{constructor(e){super(),this._orientation=PaperOrientation.PORTRAIT,this._size=PaperSize.A4,this._width="210mm",this._height="297mm",this._marginLeft="12mm",this._marginRight="12mm",this._marginTop="15mm",this._marginBottom="15mm",this._widthDim=new Dimension(this._width),this._heightDim=new Dimension(this._height),this._marginLeftDim=new Dimension(this._marginLeft),this._marginRightDim=new Dimension(this._marginRight),this._marginTopDim=new Dimension(this._marginTop),this._marginBottomDim=new Dimension(this._marginBottom),this._report=e}_doDispose(){super._doDispose()}get orientation(){return this._orientation}set orientation(e){e!==this._orientation&&(this._orientation=e,this._changed())}get size(){return this._size}set size(e){if(e!=this._size){this._size=e;const t=PaperSizeMap[this._size];t&&(this.width=t.w+"mm",this.height=t.h+"mm")}}get width(){return this._width}set width(e){e!=this._width&&(this._width=e,this._widthDim=new Dimension(e),this._changed())}get height(){return this._height}set height(e){e!=this._height&&(this._height=e,this._heightDim=new Dimension(e),this._changed())}get marginLeft(){return this._marginLeft}set marginLeft(e){e!=this._marginLeft&&(this._marginLeft=e,this._marginLeftDim=new Dimension(e),this._changed())}get marginRight(){return this._marginRight}set marginRight(e){e!=this._marginRight&&(this._marginRight=e,this._marginRightDim=new Dimension(e),this._changed())}get marginTop(){return this._marginTop}set marginTop(e){e!=this._marginTop&&(this._marginTop=e,this._marginTopDim=new Dimension(e),this._changed())}get marginBottom(){return this._marginBottom}set marginBottom(e){e!=this._marginBottom&&(this._marginBottom=e,this._marginBottomDim=new Dimension(e),this._changed())}load(e){}getPageSize(){let e=this._widthDim.getFixedPixel(),t=this._heightDim.getFixedPixel();if(isNaN(e)||isNaN(t)){const i=PaperSizeMap[this._size]||PaperSizeMap.A4;e=getPixelsByUnits(PrintUnit.MILLI,i.w),t=getPixelsByUnits(PrintUnit.MILLI,i.h)}return this._orientation===PaperOrientation.LANDSCAPE?new Size(t,Math.floor(e)):new Size(e,Math.floor(t))}getContentRect(e){return e.topBy(this._marginTopDim.getFixedPixel()),e.bottomBy(-this._marginBottomDim.getFixedPixel()),e.leftBy(this._marginLeftDim.getFixedPixel()),e.rightBy(-this._marginRightDim.getFixedPixel()),e}getClientRect(){const e=this.getPageSize();return new Rectangle(0,0,e.width-this._marginLeftDim.getFixedPixel()-this._marginRightDim.getFixedPixel(),e.height-this._marginTopDim.getFixedPixel()-this._marginBottomDim.getFixedPixel()).round()}applyExtents(e){const t=this.getPageSize(),i=this._marginLeftDim.getFixedPixel(),r=this._marginRightDim.getFixedPixel(),s=this._marginTopDim.getFixedPixel(),n=this._marginBottomDim.getFixedPixel();e.width=t.width-i-r+"px",e.height=t.height-s-n+"px"}applyPreviewExtents(e){const t=this.getPageSize();e.width=t.width+"px",e.height=t.height+"px"}applyClient(e){const t=this.getPageSize(),i=this._marginLeftDim.getFixedPixel(),r=this._marginRightDim.getFixedPixel(),s=this._marginTopDim.getFixedPixel(),n=this._marginBottomDim.getFixedPixel();e.width=t.width-i-r+"px",e.height=t.height-s-n+"px",e.left="0",e.top="0"}applyPreviewClient(e){const t=this.getPageSize(),i=this._marginLeftDim.getFixedPixel(),r=this._marginRightDim.getFixedPixel(),s=this._marginTopDim.getFixedPixel(),n=this._marginBottomDim.getFixedPixel();e.width=t.width-i-r+"px",e.height=t.height-s-n+"px",e.left=i+"px",e.top=s+"px",Utils.extend(e,this._report.page.styles)}_changed(){this._report&&this._report._firePaperChanged()}}class ReportInfo extends Base{constructor(e){super(),this.paper=new PaperOptions(e)}}class ReportRootItem extends ReportGroupItem{constructor(e){super("reportRoot"),this._report=e}get report(){return this._report}get name(){return this._report.info.name}set name(e){const t=this.name;e!=t&&(this._report.info.name=e,this._changed(ReportRootItem.PROP_NAME,e,t))}get author(){return this._report.info.author}set author(e){this._report.info.author=e}get version(){return this._report.info.version}set version(e){this._report.info.version=e}get description(){return this._report.info.description}set description(e){this._report.info.description=e}get paperOrientation(){return this._report.info.paper.orientation}set paperOrientation(e){this._report.info.paper.orientation=e}get paperSize(){return this._report.info.paper.size}set paperSize(e){this._report.info.paper.size=e}get paperWidth(){return this._report.info.paper.width}set paperWidth(e){this._report.info.paper.width=e}get paperHeight(){return this._report.info.paper.height}set paperHeight(e){this._report.info.paper.height=e}get marginLeft(){return this._report.info.paper.marginLeft}set marginLeft(e){this._report.info.paper.marginLeft=e}get marginRight(){return this._report.info.paper.marginRight}set marginRight(e){this._report.info.paper.marginRight=e}get marginTop(){return this._report.info.paper.marginTop}set marginTop(e){this._report.info.paper.marginTop=e}get marginBottom(){return this._report.info.paper.marginBottom}set marginBottom(e){this._report.info.paper.marginBottom=e}get pathLabel(){return"report"}get displayPath(){return"report"}_ignoreItems(){return!0}getEditProps(){return ReportRootItem.PROPINFOS}getStyleProps(){return[]}canResize(e){return!1}_doLoad(e,t){super._doLoad(e,t),this._loadPropsOf(t,ReportRootItem.PROPINFOS)}_doSave(e){super._doSave(e),this._savePropsOf(e,ReportRootItem.PROPINFOS)}}ReportRootItem.PROP_REPORT_NAME="name",ReportRootItem.PROP_REPORT_AUTHOR="author",ReportRootItem.PROP_REPORT_VERSION="version",ReportRootItem.PROP_REPORT_DESCRIPTION="description",ReportRootItem.PROP_PAPER_ORIENTATION="paperOrientation",ReportRootItem.PROP_PAPER_SIZE="paperSize",ReportRootItem.PROP_PAPER_WIDTH="paperWidth",ReportRootItem.PROP_PAPER_HEIGHT="paperHeight",ReportRootItem.PROP_MARGIN_LEFT="marginLeft",ReportRootItem.PROP_MARGIN_RIGHT="marginRight",ReportRootItem.PROP_MARGIN_TOP="marginTop",ReportRootItem.PROP_MARGIN_BOTTOM="marginBottom",ReportRootItem.PROPINFOS=[{name:ReportRootItem.PROP_REPORT_NAME,category:PropCategory.REPORT,type:StringProperty,multiple:!1,default:void 0},{name:ReportRootItem.PROP_REPORT_AUTHOR,category:PropCategory.REPORT,type:StringProperty,multiple:!1,default:void 0},{name:ReportRootItem.PROP_REPORT_VERSION,category:PropCategory.REPORT,type:StringProperty,multiple:!1,default:void 0},{name:ReportRootItem.PROP_REPORT_DESCRIPTION,category:PropCategory.REPORT,type:StringProperty,multiple:!1,default:void 0},{name:ReportRootItem.PROP_PAPER_ORIENTATION,category:PropCategory.PAPER,type:EnumProperty,multiple:!1,default:PaperOrientation.PORTRAIT,domain:PaperOrientation},{name:ReportRootItem.PROP_PAPER_SIZE,category:PropCategory.PAPER,type:EnumProperty,multiple:!1,default:void 0,domain:PaperSize},{name:ReportRootItem.PROP_PAPER_WIDTH,category:PropCategory.PAPER,type:DimensionProperty,multiple:!1,default:void 0},{name:ReportRootItem.PROP_PAPER_HEIGHT,category:PropCategory.PAPER,type:DimensionProperty,multiple:!1,default:void 0},{name:ReportRootItem.PROP_MARGIN_LEFT,category:PropCategory.PAPER,type:DimensionProperty,multiple:!1,default:void 0},{name:ReportRootItem.PROP_MARGIN_RIGHT,category:PropCategory.PAPER,type:DimensionProperty,multiple:!1,default:void 0},{name:ReportRootItem.PROP_MARGIN_TOP,category:PropCategory.PAPER,type:DimensionProperty,multiple:!1,default:void 0},{name:ReportRootItem.PROP_MARGIN_BOTTOM,category:PropCategory.PAPER,type:DimensionProperty,multiple:!1,default:void 0}],ReportRootItem.$_ctor="ReportRootItem";class Report extends EventAware{constructor(e,t){super(),this._unit=PrintUnit.MILLI,this._assetRoot="",this._loader=new ReportLoaderImpl,this._loading=!1,this._invalids=[],this._designTime=e,this._commands=new EditCommandStack(this),this._info=new ReportInfo(this),this._page=new ReportPage(this),this._page.addListener(this),this._root=new ReportRootItem(this),this._root.add(this._page),this._assets=new AssetManager,this._designData=new DesignDataManager(this._commands),e&&(this._data=this._designData,this._designData.addListener(this)),t&&this.load(t)}static isReportSource(e){return e&&Utils.isObject(e.page)}_doDispose(){this._designData.removeListener(this),this._designData=this._designData.dispose(),super._doDispose()}onDesignDataManagerDataAdded(e,t){this.fireEvent(Report.DATA_ADDED,t),this.$_refreshInvalids()}onDesignDataManagerDataRemoved(e,t){this.fireEvent(Report.DATA_REMOVED,t),this.$_refreshInvalids()}onDesignDataManagerDataUpdated(e,t){this.fireEvent(Report.DATA_UPDATED,t),this.$_refreshInvalids()}onDesignDataManagerNameChanged(e,t,i){this._page.$_dataNameChanged(t,i),this.fireEvent(Report.DATA_NAME_CHANGED,t,i),this.$_refreshInvalids()}onDesignDataManagerFieldNameChanged(e,t,i,r){this._page.$_dataFieldNameChanged(t,i,r),this.fireEvent(Report.DATA_FIELD_NAME_CHANGED,t,i,r),this.$_refreshInvalids()}editCommandStackChanged(e,t,i,r){this.fireEvent(Report.COMMANDS_STACK_CHANGED,t,i,r),this.$_refreshInvalids()}editCommandStackDirtyChanged(e){this.fireEvent(Report.DIRTY_CHANGED)}addCollectionItem(e){e instanceof HichartAxisPlotLineCollection?this.addHichartPlotLine(e.axis):e instanceof HichartAxisPlotBandCollection&&this.addHichartPlotBand(e.axis)}get loader(){return this._loader}get info(){return this._info}get paper(){return this._info.paper}get unit(){return this._unit}set unit(e){e!=this._unit&&(this._unit=e)}get assetRoot(){return this._assetRoot}set assetRoot(e){this._assetRoot=e,this._assetRoot.endsWith("/")||(this._assetRoot+="/")}get root(){return this._root}get page(){return this._page}set page(e){this._page=e}get assets(){return this._assets}get data(){return this._data}get designData(){return this._designData}get canUndo(){return this._commands.canUndo}get canRedo(){return this._commands.canRedo}get dirty(){return this._commands.dirty}load(e){if(e){this._loading=!0;try{return this._root.load(this._loader,e),e.report&&this._root.load(this._loader,e.report),e.page&&this._page.load(this._loader,e.page),e.assets&&this._assets.load(e.assets),e.data&&this._designData.load(e.data),this._fireReset(),this}finally{this._loading=!1}}}setSaveTagging(e){return this._page.saveTag=e,this}save(e=!1){const t={report:{},page:{}};return this._root.save(t.report),this._page.save(t.page),e||(this._assets.save(t.assets={}),this._data instanceof DesignDataManager&&this._data.save(t.data={})),this._page.saveTag=null,t}prepareLayout(){this._page.prepareLayout(!1)}preparePrint(e){this._page.preparePrint(e),this.models={}}getImageUrl(e){if(e)return this._assetRoot.indexOf(":")>=0?this._assetRoot+e:e}clearHistory(){this._commands.flush()}closeHistory(){this._commands.close()}undo(){return this._commands.undo()}redo(){return this._commands.redo()}execute(e){return e&&this._commands.execute(e)}getEditHistory(e=!1){return this._commands.getHistory(e)}getCommand(e){return this._commands.get(e)}itemByName(e){return this._page.getItem(e)}defaultInit(e,t,i,r){e.defaultInit(this._loader,t,i,r)}addItem(e,t,i=-1){if(e&&t){if(!this._fireItemAdd(e,t,i))return!1;if(e.contains(t))throw new Error("Item is already contained in this group item.");if(t.outlineParent)throw new Error("Item is already contained in other group item.");if(t instanceof DataBand&&!e.canContainsBand())throw new Error("데이터밴드를 추가할 수 없는 영역입니다.");if(t instanceof BandGroup&&!e.canContainsBandGroup())throw new Error("밴드그룹을 추가할 수 없는 영역입니다.");if(!(i>=0&&i<e.count))return this.execute(new AddItemCommand(e,t)),t.parent instanceof CellGroup?t.parent.parent===e:t.parent===e}}moveCollectionItem(e,t,i){if(e&&t!==i){const r=new MoveCollectionItemCommand(e,t,i);this.execute(r)}}addChartSeries(e,t){if(e&&t){const i=new AddHichartSeriesCommand(e,t);return this.execute(i),i.series}}addHichartPlotLine(e,t){if(e){const i=new AddHichartPlotLineCommand(e,t);return this.execute(i),i.line}}addHichartPlotBand(e,t){if(e){const i=new AddHichartPlotBandCommand(e,t);return this.execute(i),i.band}}addTableRow(e,t){t<0&&(t=e.rowCount),this.execute(new AddTableRowCommand(e,t))}moveTableRows(e,t,i,r,s=!1){}moveTableRowsToNearest(e,t,i,r,s=!1){try{const n=e.getNearestMovableRow(t,i,r);n>=0&&e.canMoveRows(t,i,n,s)&&this.execute(new MoveTableRowsCommand(e,t,i,n,!0))}catch(t){if(!(t instanceof AlertError))throw t;this._fireAlert(e,t.message)}}addTableColumn(e,t){e instanceof TableBand?this.execute(new AddTableBandColumnCommand(e,t)):e instanceof TableContainer&&this.execute(new AddTableColumnCommand(e,t))}moveTableColumns(e,t,i,r){}moveTableColumnsToNearest(e,t,i,r){try{if(e instanceof TableBand){const s=e.getNearestMovableColumn(t,i,r);s>=0&&s!==t&&e.canMoveColumns(t,i,s,!0)&&this.execute(new MoveTableBandColumnsCommand(e,t,i,s,!0))}else if(e instanceof TableContainer){const s=e.getNearestMovableColumn(t,i,r);s>=0&&s!==t&&e.canMoveColumns(t,i,s,!0)&&this.execute(new MoveTableColumnsCommand(e,t,i,s,!0))}}catch(t){if(!(t instanceof AlertError))throw t;this._fireAlert(e,t.message)}}addCrosstabField(e,t){e.band.containsField(t)?alert("이미 포함된 필드입니다: "+t):this.execute(new AddCrosstabFieldCommand(e,e.count,{field:t}))}removeItem(e){e&&this.removeItems([e])}removeItems(e){e&&e.length>0&&this._page.removeItems(this._commands,e)}setItemProperty(e,t,i){if(e){if(e.isChildProp(t)&&!e.parent.canChangeChildProp(e,t,i))return;e instanceof BandGroup&&"bandCount"===t?this.execute(new ChangeBandCountCommand(e,i)):e instanceof TableBand&&"colCount"===t?this.execute(new ChangeTableBandColCountCommand(e,i)):e instanceof TableContainer&&"colCount"===t?this.execute(new ChangeTableColCountCommand(e,i)):e instanceof TableBase&&"rowCount"===t?this.execute(new ChangeTableRowCountCommand(e,i)):(e instanceof BandGroup&&"bandCount"===t||t)&&this.execute(new SetPropCommand(e,t,i))}}setItemProperties(e,t){e instanceof ReportItem&&t&&this.execute(new SetPropsCommand(e,t))}setItemsProperties(e,t){e&&e.length&&t&&this.execute(new SetItemsPropsCommand(e,t))}resetItemProperty(e,t){if(e instanceof ReportItem&&t){let i=!1;if(e.isChildProp(t.name)?e.getChildProp(t.name)!==t.default&&(i=!0):e[t.name]!==t.default&&(i=!0),i)return this.execute(new SetPropCommand(e,t.name,t.default)),!0}}setItemsProperty(e,t,i){e&&e.length&&t&&this.execute(new SetItemsPropCommand(e,t,i))}setItemStyle(e,t,i){e&&t&&this.execute(new SetStyleCommand(e,t,i))}setItemsStyle(e,t,i){e&&e.length&&t&&this.execute(new SetItemsStyleCommand(e,t,i))}setChildStyleProperty(e,t,i,r){e&&t&&this.execute(new SetChildStyleCommand(e,t,i,r))}setItemsChildStyleProperty(e,t,i,r){e&&e.length&&t&&this.execute(new SetItemsChildStyleCommand(e,t,i,r))}addTableBandColumn(e,t,i=-1){e&&this.execute(new AddTableBandColumnCommand(e,i,t))}addTableBandGroup(e,t,i=-1){e&&this.execute(new AddTableBandGroupCommand(e,i,t))}addSimpleBandGroup(e,t,i=-1){e&&this.execute(new AddSimpleBandGroupCommand(e,i,t))}canMergeSelection(e){return e instanceof TableSelection&&!e.isSingle(!0)}mergeSelection(e){if(this.canMergeSelection(e)){const t=new MergeTableSelectionCommand(e);this.execute(t),this._fireCellMerged(e.table.getCell(t.bounds.r1,t.bounds.c1))}}canUnmergeCell(e){return!e.isSingle}unmergeCell(e){this.canUnmergeCell(e)&&this.execute(new UnmergeTableCellsCommand(e))}search(e,t){const i=[];return this._page.search(e,t,i),i.length>0?i:null}applyDropResult(e,t){if(e&&t)return t.type===DropResultType.PROP?this.execute(new SetPropCommand(e,t.prop,t.value)):void 0}addAsset(e,t){if(t){const i="string"==typeof e?this._assets.findGroup(e):e;this.execute(new AddAssetCommand(this._assets,i,t))}}removeAsset(e){e&&this.execute(new RemoveAssetCommand(this._assets,e))}renameData(e,t){if(this._data instanceof DesignDataManager&&e&&t&&e.name!=t)return this.execute(new RenameDataCommand(this._data,e,t)),!0}addData(e){if(this._data instanceof DesignDataManager)return this.execute(new AddDataCommand(this._data,e)),!0}removeData(e){if(this._data instanceof DesignDataManager)return"string"==typeof e&&(e=this._data.get(e)),e&&this.execute(new RemoveDataCommand(this._data,e)),!0}saveSimpleData(e,t){e&&t&&this.execute(new SaveSimpleDataCommand(e,t))}saveItems(e){if(e&&e.length>0){if(e.length>1)for(let t=(e=e.sort(((e,t)=>e.level-t.level))).length-1;t>=0;t--){const i=e[t].parent;for(let r=t+1;r>=0;r--)if(e[r]===i){e.splice(r,1);break}}const t=[];for(let i of e){const e={};i.save(e)&&t.push(e)}return JSON.stringify(t)}}pasteItems(e,t){let i;t instanceof TableCell&&(i=t,t=t.table);let r=(t instanceof ReportGroupItem?t:null==t?void 0:t.parent)||this.page.body._bodyItems;if(r){const t=JSON.parse(e),s=[];for(let e of t){const t=this._loader.createItem(e);if(t){if(r instanceof TableBase){r.noPrepareCell=!0;try{r._loadChild(this._loader,t,e),t.setChildProp("row",i.row),t.setChildProp("col",i.col)}finally{r.noPrepareCell=!1}}else r._loadChild(this._loader,t,e);this.addItem(r,t)&&s.push(t)}}return s}}moveItem(e,t,i){e&&this.execute(new MoveItemCommand(e,t,i))}moveItemDir(e,t,i){e&&this.execute(new MoveItemDirCommand(e,t,i))}resizeItem(e,t,i,r,s,n,o){e&&this.execute(new ResizeItemCommand(e,t,i,r,s,n,o))}resizeSpace(e,t,i,r){e&&this.execute(new ResizeSpaceCommand(e,t,i,r))}resizeAndMove(e,t,i,r,s,n,o,a,A){e&&this.execute(new ResizeAndMoveCommand(e,t,i,r,s,n,o,a,A))}alignItem(e,t){if(e instanceof TableColumn||e instanceof TableCell)this.setItemStyle(e,"cellAlign",t);else if(e instanceof ReportItem)if(e.parent instanceof CellGroup){const i=e.parent.parent.getCell(e.row,e.col);this.execute(new SetStyleCommand(i,"cellAlign",t))}else if(e.parent.canAlign(e))switch(t){case"left":this.setItemProperties(e,{left:0,right:void 0});break;case"right":this.setItemProperties(e,{left:void 0,right:0});break;case"top":this.setItemProperties(e,{top:0,bottom:void 0});break;case"bottom":this.setItemProperties(e,{top:void 0,bottom:0});break;case"center":this.setItemProperties(e,{left:void 0,right:void 0,top:void 0,bottom:void 0})}}alignItems(e,t){const i=[];e.forEach((e=>{if(e instanceof TableCell||e instanceof TableColumn)i.push(new SetStyleCommand(e,"cellAlign",t));else if(e instanceof ReportItem)if(e.parent instanceof CellGroup){const r=e.parent.parent.getCell(e.row,e.col);i.push(new SetStyleCommand(r,"cellAlign",t))}else if(e.parent.canAlign(e))switch(t){case"left":i.push(new SetPropsCommand(e,{left:0,right:void 0}));break;case"right":i.push(new SetPropsCommand(e,{left:void 0,right:0}));break;case"top":i.push(new SetPropsCommand(e,{top:0,bottom:void 0}));break;case"bottom":i.push(new SetPropsCommand(e,{top:void 0,bottom:0}));break;case"center":i.push(new SetPropsCommand(e,{left:void 0,right:void 0,top:void 0,bottom:void 0}))}})),i.length>0&&this.execute(new EditCommandGroup("alignItems",i))}changeItemIndex(e,t){if(t=Math.max(0,Math.min(e.parent.count-1,t)),e&&e.index!==t)return this.execute(new ChangeChildIndexCommand(e,t)),!0}clearTexts(e){const t=[];e.forEach((e=>{(e instanceof TextItem&&e.text||e instanceof CheckItem&&e.text)&&t.push(new SetPropCommand(e,"text",void 0))})),t.length&&this.execute(new EditCommandGroup("",t))}adjustColumnWidths(e,t,i,r){this.execute(new AdjustColumnWidthsCommand(e,t,i,r))}adjustRowHeights(e,t,i,r){this.execute(new AdjustRowHeightsCommand(e,t,i,r))}getInvalids(){return this._invalids}$_refreshInvalids(){this._page.collectInvalids(this,this._invalids=[])}onPageItemAdded(e,t,i,r){this._loading||this.fireEvent(Report.ITEM_ADDED,t,i,r)}onPageItemsAdded(e,t,i){this._loading||this.fireEvent(Report.ITEMS_ADDED,t,i)}onPageItemRemoved(e,t,i){this.fireEvent(Report.ITEM_REMOVED,t,i)}onPageItemsRemoved(e,t){this.fireEvent(Report.ITEMS_REMOVED,t)}onPageItemChanged(e,t,i,r,s){this.fireEvent(Report.ITEM_CHANGED,t,i,r,s)}onPageCollectionChanged(e,t){this.fireEvent(Report.COLLECTION_CHANGED,t)}_fireReset(){this.fireEvent(Report.RESET)}_firePaperChanged(){this.fireEvent(Report.PAPER_CHANGED)}_fireItemAdd(e,t,i){return this.fireConfirmEvent(Report.ITEM_ADD,e,t,i)}_fireItemMoved(e,t){this.fireEvent(Report.ITEM_MOVED,e)}_fireCollectionChanged(e){this.fireEvent(Report.COLLECTION_CHANGED,e)}_fireCellMerged(e){this.fireEvent(Report.CELL_MERGED,e)}_fireAlert(e,t){this.fireEvent(Report.ALERT,e,t)}}Report.RESET="onReportReset",Report.PAPER_CHANGED="onReportPaperChanged",Report.ITEM_ADD="onReportItemAdd",Report.ITEM_ADDED="onReportItemAdded",Report.ITEMS_ADDED="onReportItemsAdded",Report.ITEM_REMOVED="onReportItemRemoved",Report.ITEMS_REMOVED="onReportItemsRemoved",Report.ITEM_CHANGED="onReportItemChanged",Report.ITEM_MOVED="onReportItemMoved",Report.COLLECTION_CHANGED="onReportCollectionChanged",Report.COMMANDS_STACK_CHANGED="onReportCommandStackChanged",Report.DIRTY_CHANGED="onReportDirtyChanged",Report.DATA_ADDED="onReportDataAdded",Report.DATA_REMOVED="onReportDataRemoved",Report.DATA_UPDATED="onReportDataUpdated",Report.DATA_NAME_CHANGED="onReportDataNameChanged",Report.DATA_FIELD_NAME_CHANGED="onReportDataFieldNameChanged",Report.CELL_MERGED="onReportCellMerged",Report.ALERT="onReportAlert";class BoundedContainerElement extends ReportGroupItemElement{constructor(e,t,i){super(e,t,i)}_prepareChild(e){}_doMeasure(e,t,i,r){this.measureFixed||this._setModelSize(this.model,t,i,r,!0);const s=super._doMeasure(e,t,i,r),n=this.childCount;let o=0,a=0;for(let e=0;e<n;e++){const t=this.getChild(e);if(t.visible){const e=t.model;o=Math.max(o,t.measuredWidth),a=Math.max(a,t.measuredHeight);let s=e.getTop(r);s>0&&(a+=s),s=e.getBottom(r),s>0&&(a+=s),s=e.getLeft(i),s>0&&(o+=s),s=e.getRight(i),s>0&&(o+=s)}}return s.set(o,a),this._applyPaddings(t,s),s}_layoutItem(e,t,i,r,s,n,o){const a=i.getLeft(n),A=i.getRight(n),l=i.getTop(o),h=i.getBottom(o);isNaN(a)||isNaN(A)?isNaN(a)?isNaN(A)?r+=(n-t.width)/2:r+=n-t.width-A:r+=a:(r+=a,t.width=Math.max(0,n-a-A)),isNaN(l)||isNaN(h)?isNaN(l)?isNaN(h)?s+=(o-t.height)/2:s+=o-t.height-h:s+=l:(s+=l,t.height=Math.max(0,o-l-h)),t.move(r,s),t.setPrintStyles()}_layoutChild(e,t,i,r,s,n){i+=(s-t.width)/2,r+=(n-t.height)/2,t.move(i,r),t.setPrintStyles()}}class StackContainerElement extends BoundedContainerElement{constructor(e,t,i){super(e,t,i)}get debugLabel(){return"stack"}_doSetStyles(e,t){super._doSetStyles(e,t),e&&e.overflow&&(t.style.overflow="visible")}_getPrev(e){const t=this.$_getSorted("x"),i=t.indexOf(e);return i>0?t[i-1]:null}_getNext(e){const t=this.$_getSorted("x"),i=t.indexOf(e);return i<t.length-1?t[i+1]:null}getUpper(e){const t=this.$_getSorted("y"),i=t.indexOf(e);return i>0?t[i-1]:null}getLower(e){const t=this.$_getSorted("y"),i=t.indexOf(e);return i<t.length-1?t[i+1]:null}$_getSorted(e){return this._getItemViews().sort(((t,i)=>t[e]-i[e]))}}class StackContainerElementImpl extends StackContainerElement{get debugLabel(){return"stack"}_getCssSelector(){return"rr-stack-container rr-group-element"}_needDesignBox(){return!0}}class SectionElement extends StackContainerElement{constructor(e,t,i){super(e,t,i)}_doDispose(){super._doDispose()}_needDesignBox(){return!0}_isContexable(){return!1}_doPrepareMeasure(e,t){e.contextable=this._isContexable(),super._doPrepareMeasure(e,t)}_doMeasure(e,t,i,r){const s=super._doMeasure(e,t,i,r);return s.height>0||e.printing||!(this.model.designHeight>0)||(s.height=this.model.designHeight),s}measure(e,t,i){const r=super.measure(e,t,i);return e.printing&&(isNaN(this._printWidth)?isNaN(this.measuredWidth)||(this.width=this.measuredWidth):this.width=this._printWidth,isNaN(this._printHeight)?isNaN(this.measuredHeight)||(this.height=this.measuredHeight):this.height=this._printHeight,r.width=this.width,r.height=this.height),r}}class ReportHeaderElement extends SectionElement{constructor(e,t){super(e,t,"reportHeaderView")}_doDispose(){super._doDispose()}get debugLabel(){return"report header"}_getCssSelector(){return"rr-report-header rr-group-element"}}class ReportFooterElement extends SectionElement{constructor(e,t){super(e,t,"reportFooterView")}_doDispose(){super._doDispose()}get debugLabel(){return"report footer"}_getCssSelector(){return ReportFooterElement.STYLE_NAME}}ReportFooterElement.STYLE_NAME="rr-page-header rr-group-element",ReportFooterElement.isFooter=function(e){return e&&e.className===ReportFooterElement.STYLE_NAME};class PageHeaderElement extends SectionElement{constructor(e,t){super(e,t,"pageHeaderView")}_doDispose(){super._doDispose()}get debugLabel(){return"page header"}_getCssSelector(){return"rr-page-header rr-group-element"}_isContexable(){return!0}}class PageFooterElement extends SectionElement{constructor(e,t){super(e,t,"pageFooterView")}_doDispose(){super._doDispose()}get debugLabel(){return"page footer"}_getCssSelector(){return"rr-page-footer rr-group-element"}_isContexable(){return!0}}class SpaceItemElement extends ReportItemElement{constructor(e,t){super(e,t,"spaceItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-space rr-item-element"}get guardLabel(){return"space"}get debugLabel(){return"space"}get isSpace(){return!0}_doMeasure(e,t,i,r){return Size.create(0,0)}}class BoxContainerElement extends ReportGroupItemElement{constructor(e,t,i){super(e,t,i),this._gap=0,this._container=this}get gap(){return this._gap}get debugLabel(){return""}_needDesignBox(){return!0}_initDom(e,t){super._initDom(e,t)}_doSetStyles(e,t){super._doSetStyles(e,t),e&&e.overflow&&(t.style.overflow="visible")}_doMeasure(e,t,i,r){this.measureFixed||this._setModelSize(this.model,t,i,r,!0);const s=this.measureFixed?this.width:Utils.pickNum(this._modelWidth,i);this._gap=this.model.getItemGap(s);return super._doMeasure(e,t,s,r)}_doAfterMeasure(e,t,i,r,s){const n=this.measureFixed?this.width:i;s.height>0||e.printing||!(this.model.designHeight>0)||(s.height=this.model.designHeight),s.width>0||e.printing||!(this.model.designWidth>0)||(s.width=this.model.designWidth),this.childCount>0&&this._applyPaddings(t,s),super._doAfterMeasure(e,t,n,r,s)}}class RowBoxContainerElement extends BoxContainerElement{constructor(e,t,i="rowBoxView"){super(e,t,i)}_doDispose(){super._doDispose()}getColPoints(){return this._points.slice()}get debugLabel(){return"rbox"}_getCssSelector(){return"rr-box-container rr-rbox rr-group-element"}_initDom(e,t){super._initDom(e,t)}_doMeasure(e,t,i,r){const s=this.model,n=this._paddings=e.reportView.getBoxPaddings(s);super._doMeasure(e,t,i,r);const o=this,a=o.childCount;let A=0,l=this._gap*(a-1);for(let e=0;e<a;e++){const t=o.getChild(e);t.visible&&(t instanceof SpaceItemElement?l+=t._measuredWidth=t.model.getSize(i):t.floating||(A=Math.max(A,t.measuredHeight),l+=t.measuredWidth))}return o.width=l,o.height=A,o.resetSizeStyle(),this.invalidate(!0,!0),new Size(l+n.left+n.right,A+n.top+n.bottom)}_doLayoutContent(e){const t=this;for(let e=0,i=t.childCount;e<i;e++){const i=t.getChild(e);i.visible&&i instanceof SpaceItemElement&&(i._measuredHeight=this.height)}super._doLayoutContent(e);const i=t.width;let r=0;const s=this._points=[];let n=0;for(let e=0,i=t.childCount;e<i;e++){const i=t.getChild(e);i.visible&&!i.floating&&(n+=i.width+this._gap)}switch(n>0&&(n-=this._gap),this.model.itemsAlign){case BoxItemsAlign.END:r=i-n;break;case BoxItemsAlign.MIDDLE:r=(i-n)/2;break;default:r=0}for(let e=0,i=t.childCount;e<i;e++){const i=t.getChild(e);i.visible&&!i.floating&&(i.x=r,s.push(r),r+=i.width,s.push(r),r+=this._gap,i.setPrintStyles())}}_layoutItem(e,t,i,r,s,n,o){const a=i.getTop(o),A=i.getBottom(o);isNaN(a)?isNaN(A)?s+=(o-t.height)/2:s+=o-t.height-A:s+=a,t.move(this.x,s),t.setPrintStyles()}getUpper(e){return e}getLower(e){return e}}class ColumnBoxContainerElement extends BoxContainerElement{constructor(e,t,i="columnBoxView"){super(e,t,i)}_doDispose(){super._doDispose()}getRowPoints(){return this._points.slice()}get debugLabel(){return"cbox"}_getCssSelector(){return"rr-box-container rr-cbox rr-group-element"}_initDom(e,t){super._initDom(e,t)}_doMeasure(e,t,i,r){const s=this.model,n=this._paddings=e.reportView.getBoxPaddings(s);super._doMeasure(e,t,i,r);const o=this,a=o.childCount;let A=this._gap*(a-1),l=0;for(let e=0;e<a;e++){const t=o.getChild(e);t.visible&&(t instanceof SpaceItemElement?A+=t._measuredHeight=t.model.getSize(r):t.floating||(l=Math.max(l,t.measuredWidth),A+=t.measuredHeight))}return o.width=l,o.height=A,o.resetSizeStyle(),this.invalidate(!0,!0),new Size(l+n.left+n.right,A+n.top+n.bottom)}_doLayoutContent(e){const t=this;for(let e=0,i=t.childCount;e<i;e++){const i=t.getChild(e);i.visible&&i instanceof SpaceItemElement&&(i._measuredWidth=this.width)}super._doLayoutContent(e);const i=t.height;let r=0;const s=this._points=[];let n=0;for(let e=0,i=t.childCount;e<i;e++){const i=t.getChild(e);i.visible&&!i.floating&&(n+=i.height+this._gap)}switch(n>0&&(n-=this._gap),this.model.itemsAlign){case BoxItemsAlign.END:r=i-n;break;case BoxItemsAlign.MIDDLE:r=(i-n)/2;break;default:r=0}for(let e=0,i=t.childCount;e<i;e++){const i=t.getChild(e);i.visible&&!i.floating&&(i.y=r,s.push(r),r+=i.height,s.push(r),r+=this._gap,i.setPrintStyles())}}_layoutItem(e,t,i,r,s,n,o){const a=i.getLeft(n),A=i.getRight(n);isNaN(a)?isNaN(A)?r+=(n-t.width)/2:r+=n-t.width-A:r+=a,t.move(r,t.y),t.setPrintStyles()}getLeft(e){return e}getRight(e){return e}}class DiagonalBoxContainerElement extends ReportGroupItemElement{constructor(e,t){super(e,t,"diagonalBoxView")}_doDispose(){super._doDispose()}get debugLabel(){return"dbox"}_getCssSelector(){return"rr-box-container rr-dbox rr-group-element"}_needDesignBox(){return!0}_initDom(e,t){super._initDom(e,t),t.appendChild(this._line=e.createElement("span")),Utils.extend(this._line.style,{position:"absolute",boxSizing:"borderBox"}),this._line.dataset.line="1"}_doMeasure(e,t,i,r){const s=this.model,n=this._paddings=e.reportView.getBoxPaddings(s);this.measureFixed||this._setModelSize(s,t,i,r,!0),Utils.extend(this._line.style,s.lineStyles),super._doMeasure(e,t,i,r);const o=this.getChild(0),a=this.getChild(1);let A=0,l=0;return o&&a?(A=o.measuredWidth+a.measuredWidth,l=o.measuredHeight+a.measuredHeight):o&&(A=o.measuredWidth,l=o.measuredHeight),e.printing&&(this._line.dataset._m_=t.dataset._m_),new Size(A+n.left+n.right,l+n.top+n.bottom)}_doAfterMeasure(e,t,i,r,s){s.height>0||e.printing||!(this.model.designHeight>0)||(s.height=this.model.designHeight),s.width>0||e.printing||!(this.model.designWidth>0)||(s.width=this.model.designWidth),this.childCount>0&&this._applyPaddings(t,s),super._doAfterMeasure(e,t,i,r,s),t.style.padding="0"}_doLayoutContent(e){const t=this._line,i=this.width,r=this.height,s=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));t.style.width=s+"px",this.model.reversed?(t.style.transform="translateY("+r+"px) rotate(-"+Math.atan(r/i)+"rad)",t.style.transformOrigin="0% 0%"):(t.style.transform="rotate("+Math.atan(r/i)+"rad)",t.style.transformOrigin="0% 0%"),super._doLayoutContent(e)}_layoutItem(e,t,i,r,s,n,o){const a=this.model;a.reversed?t.model===a.firstItem||(r=this.width-t.width-this._padRight,s=this.height-t.height-this._padBottom):t.model===a.firstItem?s=this.height-t.height-this._padBottom:r=this.width-t.width-this._padRight,t.move(r,s,!0)}}class PageItemContainerElement extends BoundedContainerElement{constructor(e,t,i,r=!0){super(e,t,i),this._findable=!0,this._emptySize=r}_doDispose(){super._doDispose()}get isLayer(){return!0}get findable(){return this._findable}set findable(e){this._findable=e}get debugLabel(){return""}get lazyLayout(){return!0}_getCssSelector(){return"rr-item-container "+this.name}_needDesignBox(){return!1}_isEmptySize(){return this._emptySize}_initDom(e,t){super._initDom(e,t)}_prepareChild(e){}_doMeasure(e,t,i,r){e.printing&&(t.style.pointerEvents="none");return super._doMeasure(e,t,i,r).set(i,r)}}class BandGroupCellElement extends ReportGroupItemElement{constructor(e,t){super(e,t,"bandGroupCellView")}get debugLabel(){return"band group section"}_needDesignBox(){return!0}_getCssSelector(){return"rr-bandgroupcell rr-group-element"}_doMeasure(e,t,i,r){this.width=this._getModelWidth(this.model,i),this.measureFixed=!0;const s=super._doMeasure(e,t,i,r);return this.childCount>0&&(s.height=Math.max(s.height,this.getChild(0).measuredHeight)),s}}class BandGroupPrintInfo extends BandPrintInfo{isEnded(){for(const e of this.bands)if(!e.isEnded())return!1;return!0}getRows(){}getNextPage(e,t,i,r){const s=e.createElement("div"),n=t.h;let o=0,a=0,A=0;return s.style.position="relative",r.appendChild(s),this.bands.forEach(((i,r)=>{const l=e.createElement("div"),h=i.wCell;Object.assign(l.style,{position:"absolute",left:A+"px",width:h+"px"}),s.appendChild(l),t.h=n;const d=i.getNextPage(e,t,h,l);d&&(a=Math.max(a,d.$_h),o++,A+=h+this.gap)})),s.style.left=this.left,s.$_h=a,o>0?s:null}}class BandGroupElement extends ReportGroupItemElement{constructor(e,t){super(e,t,"bandGroupView"),this._gap=0}printGroup(e,t,i){const r=this.model.bandGap,s=[],n=[];let o=0,a=0;if(this.elements.forEach((i=>{const A=i.getChild(0),l=i.width;if(A){const i=[];t.saveBand(),A.printBand(e,t,l,i),s.push({n:i.length,y:t.y,h:t.h}),t.restoreBand(),i.forEach((e=>{e.style.width=l+"px",e.style.left=o+"px"})),n.push(i),a=Math.max(a,i.length)}else s.push(null),n.push(null);o+=l+r})),a>0){for(let t=0;t<a;t++){const r=e.createElement("div");r.className="bg-page-container",r.style.position="relative",r.style.left=this.style.left;for(let e=0;e<n.length;e++)if(n[e]){const i=n[e][t];i&&r.appendChild(i)}i.push(r)}let r=0,o=Number.MAX_SAFE_INTEGER;s.forEach((e=>{e.n===a&&(r=Math.max(r,e.y),o=Math.min(o,e.y))})),t.y=r,t.h=o}}getCellPoints(){return this._cellPts}prepareAsync(e,t,i){const r=this.model,s=this.elements,n=[];s.forEach((i=>{const r=i.getChild(0),s=i.width;if(r){const i=r.prepareAsync(e,t,s,null,-1);i.wCell=s,n.push(i)}}));const o=new BandGroupPrintInfo;return o.bands=n,o.left=this.style.left,o.gap=r.bandGap,o}get debugLabel(){return"band group"}_needDesignBox(){return!0}_getCssSelector(){return"rr-bandgroup rr-group-element"}_doMeasure(e,t,i,r){const s=this.model;this._paddings=e.reportView.getBoxPaddings(s),this._setModelSize(s,t,i,r),this._gap=Utils.toNumber(s.bandGap,0);let n=Utils.pickNum(this._modelWidth,i);n-=this._paddings.left+this._paddings.right;const o=this.$_calcColWidths(n,this._gap);for(let e=0,t=s.count;e<t;e++){s.get(e).width=o[e]}const a=super._doMeasure(e,t,n,r);if(isNaN(this._modelHeight))for(let e=0;e<this.childCount;e++)a.height=Math.max(a.height,this.getChild(e).measuredHeight);return a}_doAfterMeasure(e,t,i,r,s){s.height>0||e.printing||!(this.model.designHeight>0)||(s.height=this.model.designHeight),s.width>0||e.printing||!(this.model.designWidth>0)||(s.width=this.model.designWidth),this.childCount>0&&this._applyPaddings(t,s),super._doAfterMeasure(e,t,i,r,s)}_doLayoutContent(e){const t=this;super._doLayoutContent(e);const i=this._cellPts=[];if(this.childCount>0){const e=this.height,r=this._gap;let s=this._paddings.left;i.push(s);for(let n=0,o=t.childCount;n<o;n++){const o=t.getChild(n);o.x=s,o.height=e,s+=o.width+r,o.setPrintStyles(),i.push(s)}}}_setDesignContent(e,t){super._setDesignContent(e,t),t.style.backgroundColor="#0088ff10"}$_calcColWidths(e,t){const i=this.model.items,r=i.length,s=[];if(e-=Math.max(0,t)*(i.length-1),r>1){let n=0;if(i.forEach((e=>n+=e.weight)),i.forEach((t=>{s.push(e*t.weight/n)})),t<0)for(let e=1;e<r;e++)s[e]-=t}else 1===r&&s.push(e);return s}}class TableCellElementBase extends ReportGroupItemElement{constructor(e,t,i,r){super(e,i,r),this._table=t}_doDispose(){super._doDispose()}get table(){return this._table}get container(){return this._table.container}get debugLabel(){return""}get designable(){return!1}get navigable(){return!1}get navigableParent(){return this._table}_getCssSelector(){return TableCellElementBase.STYLE}_needContentBox(){return!1}_initDom(e,t){super._initDom(e,t),t.className=TableCellElementBase.STYLE}_prepareChild(e){e.dom.style.position="relative"}_doLayoutContent(e){super._doLayoutContent(e);const t=this.model,i=this._table,r=i.model.getCell(t.row,t.col),s=this.getChild(0),n=i.model.getColumn(t.col).styles,o=r.styles,a=o&&o.cellAlign||n&&n.cellAlign;let A=0;switch(a){case"left":break;case"right":A=this.offsetWidth-s.offsetWidth;break;default:A=(this.offsetWidth-s.offsetWidth)/2}if(s.x=A,s.setPrintStyles(),s.dom.style.display="table",s.dom.style.top="",s.y=NaN,e.printing){i.$_td(this._row,this._col).dataset._align=a?a.charAt(0):"c"}}}TableCellElementBase.STYLE="rr-table-cell";class TableElement extends ReportGroupItemElement{constructor(e,t,i){super(e,t,i),this._tcells=[],this._ecells=[],this._spans=[]}static setTableStyle(e,t=!0){const i=e.style;i.setProperty("table-layout","fixed","important"),t&&i.setProperty("width","100%","important"),i.setProperty("border-collapse","collapse","important"),i.height="100%",e.className="rr-table"}static getTable(e){let t;if(e instanceof TableElement&&(t=e),!t&&e instanceof TableCellElementBase&&(t=e.table),!t&&e&&e.parent instanceof TableCellElementBase&&(t=e.parent.table),t instanceof TableElement)return t}_doDispose(){super._doDispose()}get rowCount(){return this._tbody.rows.length}get cellCount(){return this._tcells.length}get cellViews(){return this._tcells.slice(0)}get hasCells(){return this._tcells.length>0}getColPoints(){let e=0;const t=[e];if(this._cellWidths)for(let i of this._cellWidths)t.push(e+=parseFloat(i));return t}getColWidth(e){return this._colPts[e+1]-this._colPts[e]}getRowPoints(){const e=this.container.zoom,t=this._tbody.rows;let i=0;const r=[i];for(let s=0;s<t.length;s++)r.push(i+=100*t[s].getBoundingClientRect().height/e);return r}getRowRect(e,t=1){const i=this._tbody.rows,r=Rectangle.create(0,0,this.width,0);for(let t=0;t<e;t++)r.y+=i[t].getBoundingClientRect().height;for(let s=0,n=Math.min(t,this.rowCount-e);s<n;s++)r.height+=i[s+e].getBoundingClientRect().height;return r}getColRect(e,t=1){const i=Rectangle.create(0,0,0,this.height);return i.x=this._colPts[e],t=Math.min(t,this._colPts.length-e),i.width=this._colPts[e+t]-i.x,i}get blockable(){return!0}get debugLabel(){return"table"}_needContentBox(){return!1}getCellOf(e,t){if(!e)return null;let i;if(t){let t=e;for(;t;){if(t instanceof HTMLTableCellElement){i=t;break}t=t.parentElement}}else e.parentElement instanceof HTMLTableCellElement?i=e.parentElement:e instanceof HTMLTableCellElement&&(i=e);if(i){const e=i.parentElement.rowIndex;return this.model.getCell(e,i.cellIndex)}}findChildAt(e,t,i){const r=this.container.activeTool.mouseEventTarget;for(let e of this._tcells){if(e.isDom(r))return e;let t=e.getChild(0);if(t.isDom(r))return t;let i=t.findDescendantOf(r);if(i)return i;if(t.containsDom(r))return t}}findChildOf(e){for(let t of this._tcells){if(t.isDom(e))return t;const i=t.findChildOf(e);if(i)return i}}findElement(e){const t=super.findElement(e);if(!t)for(let t of this._tcells){const i=t.getChild(0);if(i instanceof ReportItemElement){const t=i.findElement(e);if(t)return t}}return t}findElementOf(e){const t=super.findElementOf(e);if(!t)for(let t of this._tcells){const i=t.getChild(0);if(i instanceof ReportItemElement){if(t.isDom(e))return i;const r=i.findElementOf(e);if(r)return r}}return!t&&(e instanceof HTMLTableCellElement||e.classList.contains(TableCellElementBase.STYLE))&&this.containsDom(e)?this:t}getElementOf(e){for(let t of this._tcells){const i=t.getChild(0);if(i instanceof ReportItemElement&&i.model==e)return i;if(i instanceof ReportGroupItemElement){const t=i.getElementOf(e);if(t)return t}}}setCellDoms(e,t){const i=e.cells,r=t.cells;for(let e=r.length-1;e>=0;e--){const t=r[e].firstElementChild;t&&i[e].appendChild(t)}for(let t of this._tcells)t._row===e.rowIndex&&(t._dom=i[t._col].lastElementChild)}unsetCellDoms(e,t){const i=e.cells,r=t.cells;for(let e=r.length-1;e>=0;e--){const t=r[e].lastElementChild;t&&i[e].appendChild(t)}for(let t of this._tcells)t._row===e.rowIndex&&(t._dom=i[t._col].firstElementChild)}replaceCellDoms(e,t){const i=e.cells,r=t.cells;for(let e=r.length-1;e>=0;e--){const t=r[e].firstElementChild,s=i[e].firstElementChild;t&&s&&(r[e].removeChild(t),r[e].appendChild(s),i[e].appendChild(t))}for(let t of this._tcells)t._row===e.rowIndex&&(t._dom=i[t._col].firstElementChild)}_setTableStyles(e){TableElement.setTableStyle(e)}_createDom(e){const t=super._createDom(e),i=this._table=e.createElement("table");return this._setTableStyles(i),this._colgroup=e.createElement("colgroup"),i.appendChild(this._colgroup),this._tbody=e.createElement("tbody"),i.appendChild(this._tbody),t.appendChild(i),t}_doModelChanged(e){e&&(e.onCellChanged=null),this.model&&(this.model.onCellChanged=this.$_cellChanged.bind(this))}$_refreshRowCells(e,t,i,r=!1){const s=this.container;for(let n of this._tcells){r&&(n._modelChanged=!0);const o=Utils.pickNum(n.dom.offsetWidth,t);n.measure(e,o,i);const a=n.getChild(0);n.layoutContent(e),s?s._drawElement(a):a.drawRecursive()}const n=this.model.getMinRowHeight();if(!isNaN(n)){const e=n+"px",t=this._tbody.rows;for(let i=0;i<t.length;i++){t[i].offsetHeight<n&&(t[i].style.height=e)}}}_isEmpty(){return 0==this.model.colCount}_doMeasure(e,t,i,r){const s=this.model;return this._table.style.height="",this.$_prepareTable(s,this._tbody),this._setModelSize(s,t,i,r,!0),this.$_measureCellWidths(s,this._modelWidth||i),this.$_measureRowHeights(s,this._modelHeight||NaN),super._doMeasure(e,t,i,r),this.$_refreshRowCells(e,i,r),e.printing?this._table.dataset._m_=t.dataset._m_:this._table.dataset._m_=s.shash,new Size(this._table.offsetWidth,this._table.offsetHeight)}_doLayoutContent(e){super._doLayoutContent(e),this._table.style.height=this.height+"px"}clear(){if(this._ecells&&this._ecells.length&&(this._ecells.forEach((e=>Utils.remove(e))),this._ecells=null),this._tcells&&this._tcells.length)return this._tcells.forEach((e=>Utils.remove(e._dom))),this._tcells=null,!0}_buildItems(e,t,i){function r(e,t){let i=parseInt(h[e]);for(let r=1;r<t;r++)i+=parseInt(h[e+1]);return i>0?i+"px":""}function s(e,t){return e&&0!==t?Math.max(0,parseInt(e)-t)+"px":e}const n=this.doc,o=i.rowCount,a=i.colCount,A=this._tbody.rows,l=this._spans,h=this._rowHeights;this._tcells=[],this._ecells=[];for(let t=0;t<o;t++){const o=A[t];for(let A=0;A<a;A++){const a=o.cells[A],d=i.getCellItemAt(t,A);if(e.printing||(a.dataset.design=""),0===l[t][A].r||0===l[t][A].c)a.removeAttribute("colspan"),a.removeAttribute("rowspan"),a.style.display="none";else{this._prepareCellStyles(e,i,t,A,a);const o=l[t][A].r,c=o>1?r(t,o):h[t],u=getComputedStyle(a),p=Utils.toInt(u.paddingTop)+Utils.toInt(u.paddingBottom);if(a.colSpan=l[t][A].c,a.rowSpan=o,d){const e=this._createCellElement(n,d);e._row=t,e._col=A,e._dom.style.maxHeight=s(c,p),this._prepareChild(e),a.appendChild(e._dom),this._tcells.push(e)}else{const e=n.createElement("div");e.className=TableCellElementBase.STYLE,e.innerHTML=ZWSP,e.style.maxHeight=s(c,0),a.appendChild(e),this._ecells.push(e)}}}}}_prepareCellStyles(e,t,i,r,s){const n=t.getCell(i,r),o=n.applyEndStyles;let a=t.cellStyles;this._setStyles(t,a,s.style),a=t.getColumn(r).styles,this._setStyles(t,a,s.style),o&&s.colSpan>1&&(a=t.getColumn(r+s.colSpan-1).styles,this._setStyles(t,a,s.style)),a=t.rows.get(i).styles,this._setStyles(t,a,s.style),o&&s.rowSpan>1&&(a=t.rows.get(i+s.rowSpan-1).styles,this._setStyles(t,a,s.style)),a=n.styles,a&&(CELL_ALIGN in a?(a={...a},delete a.cellAlign,this._setStyles(t,a,s.style)):this._setStyles(t,a,s.style));const A=n.styleCallback;if(A)try{const i=A(e,n,e.row);i&&this._setStyles(t,i,s.style)}catch(e){console.error("StyleCallback Error",e)}}_prepareChild(e){e._dom.style.position="relative",e.positionable=!1}getFirst(){const e=this._spans;for(let t=0;t<e.length;t++){const i=e[t];for(let e=0;e<i.length;e++)if(i[e].r){const t=i[e].m;if(t)return this._findCell(t).firstChild}}}getLast(){const e=this._spans;for(let t=e.length-1;t>=0;t--){const i=e[t];for(let e=i.length-1;e>=0;e--)if(i[e].r){const t=i[e].m;if(t)return this._findCell(t).firstChild}}}_getPrev(e){const t=e.model,i=this._spans;let r=t.col;if(r>0){const e=t.row,s=i[e][r].v.rowspan||1;for(;--r>=0;)for(let n=0;n<s;n++){const s=i[e+n][r].m;if(s&&s.item!==t)return this._findCell(s).firstChild}}}_getNext(e){const t=this._spans,i=e.model,r=i.row;let s=i.col;if(s<t[r].length-1){const e=t[r][s].v.rowspan||1;for(;++s<t[r].length;)for(let n=0;n<e;n++){const e=t[r+n][s].m;if(e&&e.item!==i)return this._findCell(e).firstChild}}}getUpper(e){const t=this._spans,i=e.model;let r=i.row;if(r>0){const e=i.col,s=t[r][e].v.colspan||1;for(;--r>=0;)for(let n=0;n<s;n++){const s=t[r][e+n].m;if(s&&s.item!==i)return this._findCell(s).firstChild}}}getLower(e){const t=this._spans,i=e.model;let r=i.row;if(r<t.length-1){const e=i.col,s=t[r][e].v.colspan||1;for(;++r<t.length;)for(let n=0;n<s;n++){const s=t[r][e+n].m;if(s&&s.item!==i)return this._findCell(s).firstChild}}}get $_trows(){return this._tbody.rows}get $_trowsCopy(){return Array.from(this._tbody.rows)}$_cloneRow(e){const t=e.cloneNode(!1),i=e.cells;for(let e=0,r=i.length;e<r;e++){const r=i[e].cloneNode(!1),s=i[e].firstElementChild;s&&r.appendChild(s.cloneNode(!1)),t.appendChild(r)}return t}$_td(e,t){return this._tbody.rows[e].cells[t]}$_cellChanged(e,t,i){}$_prepareTable(e,t){const i=getDoc(t),r=e.rowCount,s=e.colCount;for(this._spans=e.prepareLayout(),this.$_prepareColGroup(i,this._colgroup,s);t.childElementCount<r;){const e=i.createElement("tr");t.appendChild(e)}for(;t.childElementCount>r;)t.removeChild(t.lastChild);const n=t.children;for(let t=0;t<r;t++){const r=n[t];this.$_prepareTableRow(i,e,t,r,s)}}_setRowStyles(e,t){}$_prepareColGroup(e,t,i){let r=t.childElementCount;for(;r++<i;){const i=e.createElement("col");t.appendChild(i)}for(;t.childElementCount>i;)t.removeChild(t.lastElementChild)}$_prepareTableRow(e,t,i,r,s){this._setRowStyles(r,i),this.$_prepareTableRowCells(e,r,s)}$_prepareTableRowCells(e,t,i){let r=t.childElementCount;for(;r++<i;){const i=e.createElement("td");t.appendChild(i)}for(;t.childElementCount>i;)t.removeChild(t.lastChild);return t.childElementCount}$_calcCellWidths(e,t){const i=e.colCount,r=(e.getCellWidths()||DimensionCollection.Empty).getSizes(i,t,e._minCellWidthDim,!1),s=[],n=this._colPts=[0];let o=0;for(let e=0;e<r.length;e++)o+=r[e];const a=o<=t?"%":"px";for(let e=0;e<i;e++)s[e]=r[e]+a,n.push(n[e]+r[e]);return s}$_measureCellWidths(e,t){if(this._masterView)this._cellWidths=this._masterView._cellWidths,this._colPts=this._masterView._colPts;else{const i=e.colCount;this._tbody.rows.length>0&&i>0?this._cellWidths=this.$_calcCellWidths(e,t):this._cellWidths=[]}let i=0;if(this._cellWidths.length>0){const e=this._colgroup.children;for(let t=e.length-1;t>=0;t--){const r=e[t],s=r.style,n=parseFloat(this._cellWidths[t]);r.$_w=n,r.dataset.width=String(n),s.width=this._cellWidths[t],i+=n}}e.fixed?this._table.style.setProperty("width",Utils.pickNum(i,0)+"px","important"):this._table.style.setProperty("width","100%","important")}$_calcRowHeights(e,t){const i=(e.getRowHeights()||DimensionCollection.Empty).getSizes(e.rowCount,t,e._minRowHeightDim),r=[];for(let t=0,s=e.rowCount;t<s;t++)isNaN(i[t])?r[t]="":r[t]=i[t]+"px";return r}$_measureRowHeights(e,t){const i=this._tbody.rows,r=this._rowHeights=this.$_calcRowHeights(e,t);for(let e=0;e<i.length;e++){const t=r[e];i[e].style.height=t}}getCellBoundingRect(e,t,i,r){const s=this._tbody.rows,n=this._colPts[0]-s[0].cells[0].offsetLeft;let o=this._colPts[e]-n,a=s[t].offsetTop,A=this._colPts[e+i]-n-o-1,l=0;for(let e=0;e<r;e++)l+=s[t+e].offsetHeight;return{x:o,y:a,width:A,height:l}}$_layoutViewInCell(e,t){const i=this.model;let r=-1,s=-1;const n=t instanceof TableCell&&t.table instanceof TableContainer?1:0;if(t instanceof TableCell&&t.table===i&&(r=t.row,s=t.col),e.visible=s>=0&&r<i.rowCount){const t=this._tbody.rows[r].cells[s],i=t.colSpan||1,o=t.rowSpan||1,a=this._colPts[s],A=this._colPts[s+i]-a,l=this._tbody.rows;let h=l[r].offsetHeight,d=0;for(let e=0;e<r;e++)d+=l[e].offsetHeight;for(let e=0;e<o-1;e++)h+=l[r+e+1].offsetHeight;return e.dom.dataset.focused="",e.setBounds(a,d+1,A,h+n),e.draw(),!0}}_findCell(e){for(let t of this._tcells)if(t.model===e)return t}createColGroup(e,t){const i=this.model,r=i.colCount,s=e.createElement("colgroup"),n=this.$_calcCellWidths(i,t);for(let t=0;t<r;t++){const i=e.createElement("col");s.appendChild(i),i.style.width=n[t],i.$_w=parseFloat(n[t])}return s}}class TableLine{constructor(e){this._rows=e.tBodies[0].rows}get height(){const e=this._doms||this._rows;let t=0;for(let i=0;i<e.length;i++)t+=e[i].offsetHeight;return t}appendTo(e,t){if(!this._doms){this._doms=[];for(let e=0;e<this._rows.length;e++){const t=this._rows[e].cloneNode(!0);this._doms.push(t)}}for(let i of this._doms)i.classList.add(t),e.appendChild(i);for(let e of this._doms)e.style.height=e.offsetHeight+"px"}remove(){if(this._doms){for(let e=this._doms.length-1;e>=0;e--){const t=this._doms[e],i=t.parentElement;i&&i.removeChild(t)}this._doms=null}}}const DEC_SEP=".",GRP_SEP=",",decimalPlaces=function(e){var r=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},_isRoundChar=function(e){return Utils.included(e,"c","f","C","F","a","A")};class NumberFormatter{constructor(e){this._optDecimal=!1,this._groupPos=0,this._replacement="$&,",this._minDigits=0,this._maxDigits=0,this._minInts=0,this._maxInts=0,this.parse(this._format=e)}static getFormatter(e){let t=NumberFormatter.Formatters[e];return t||(NumberFormatter.Formatters[e]=t=new NumberFormatter(e)),t}static get Default(){return NumberFormatter.getFormatter(NumberFormatter.DEFAULT_FORMAT)}get format(){return this._format}get separator(){return this._seperator}get groupSep(){return this._groupSep}get minDigits(){return this._minDigits}get maxDigits(){return this._maxDigits}parse(e){this._minDigits=0,this._maxDigits=0,this._minInts=0,this._maxInts=0,this._parse(e)}getText(e,t=!0){let i=Number(e);if(isNaN(i))return"";{let e=this._minDigits,s=0;if(this._optDecimal){const t=(r=(""+i).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(r[1]?r[1].length:0)-(r[2]?+r[2]:0)):0;e=Math.min(Math.max(t,this._minDigits),this._maxDigits)}if(e>0&&this._round)switch(s=Math.pow(10,e),this._round){case"c":i=Math.ceil(s*i)/s;break;case"f":const t=i.toString().split(".");i=parseFloat(t.length>1?t[0]+"."+t[1].substr(0,e):t[0])}i="a"===this._round?Math.abs(i):i,i=Number(i.toPrecision(15));let n=i.toFixed(e);try{!t&&(s=parseFloat(n))===Math.abs(parseFloat(n))&&0===s&&(n=Math.abs(i).toFixed(e))}catch(e){}return this._seperator&&(n=n.replace(".",this._seperator)),this._reg?e?n.replace(this._regDecimal,this._replacement):n.replace(this._reg,this._replacement):n}var r}_parse(e){if(e&&(e=e.trim()),!e)return;var t=".",i=",";if(e.indexOf(";")>-1){const r=e.split(";");e=r[0],r.length>1&&r[1]&&!_isRoundChar(r[1])&&(t=r[1]),r.length>2&&r[2]&&!_isRoundChar(r[2])&&(i=r[2]),this._round=r[3]||r[2]||r[1],this._round=_isRoundChar(this._round)?this._round.toLowerCase():this._round}this._seperator="."==t?null:t,this._groupSep=","==i?null:i;const r=e.length,s=e.indexOf(".");if(this._optDecimal=e.indexOf("#",s)>0,s>=0){let t=s+1;for(;t<r&&"0"==e.charAt(t);t++)this._minDigits++,this._maxDigits++;for(;t<r&&"#"==e.charAt(t);t++)this._maxDigits++;e=e.substr(0,s)}if(e){const t=e.length;","==e.charAt(t-1)&&(this._groupPos=3,e=e.substr(0,t-1))}if(e){const t=e.length;let i=!0;for(let r=t-1;r>=0;r--){const s=e.charAt(r);if("0"==s&&i)this._minInts++,this._maxInts++;else if(0==this._groupPos&&","==s)this._groupPos=t-r-1;else{if("#"!=s)break;i=!1}}}this._groupPos>0&&(this._replacement="$&"+i,this._reg=new RegExp("\\d(?=(\\d{"+this._groupPos+"})+($|\\"+t+"))","g"),this._regDecimal=new RegExp("\\d(?=(\\d{"+this._groupPos+"})+\\"+t+")","g"))}}NumberFormatter.DEFAULT_FORMAT="#,##0.0",NumberFormatter.Formatters={};const LEV="_lev";class FieldContainer extends ReportElement{constructor(e){super(e,"fieldContainer"),this._divs=[]}setFields(e,t,i){const r=this.dom,s=this._divs,n=i?i.length:0;for(r.dataset.empty=n>0?"0":"1";s.length<n;){const t=e.createElement("div"),i=e.createElement("span"),n=e.createElement("span");i.style.flexGrow="1",i.style.whiteSpace="nowrap",t.appendChild(i),n.className=FieldContainer.ARROW_CLASS,n.textContent="‣",t.appendChild(n),t.className=FieldContainer.FIELD_CLASS,t.style.display="flex",t.style.alignItems="center",r.appendChild(t),s.push(t)}for(;s.length>n;){const e=this._divs.pop();r.removeChild(e)}s.forEach(((e,t)=>{const r=i[t].fieldName;e.firstElementChild.textContent=r,e.children[1].$_fld=r}))}_getCssSelector(){return FieldContainer.CLSS_NAME}_initDom(e,t){super._initDom(e,t),Object.assign(t.style,{display:"flex",flexDirection:"column",overflowY:"scroll",overflowX:"hidden",paddingRight:"4px",minWidth:"150px"})}_doMeasure(e,t,i,r){return Size.create(t.offsetWidth,t.offsetHeight)}_doLayoutContent(e){}}FieldContainer.CLSS_NAME="rr-crosstab-field-container",FieldContainer.FIELD_CLASS="rr-crosstab-field",FieldContainer.ARROW_CLASS="rr-crosstab-field-arrow";class CrosstabFieldsView extends ReportPageItemElement{constructor(e,t,i){super(e,t),this.$_createSectionTable(e,this.dom,i)}get fields(){return this._fields}setFields(e){this._fields=e}getFieldOf(e){if(e instanceof HTMLTableCellElement&&this._tbody.contains(e)&&e.cellIndex>0){const t=this._fields.get(e.cellIndex-1);return"summaryHeader"===e.dataset.type?t.summary.header:"summary"===e.dataset.type?t.summary:"header"===e.dataset.type?t.header:t}}getFieldCellRow(e){return{r:e instanceof CrosstabFieldSummaryHeader?3:e instanceof CrosstabFieldSummary?2:e instanceof CrosstabFieldHeader?1:0,n:1}}getFieldBoundingRect(e){const t=CrosstabBand.getFieldOf(e),i=this.getFieldCellRow(e),r=this._tbody.rows[i.r].cells[t.index+1];let s=r.offsetHeight;return i.n>1&&(s+=this._tbody.rows[i.r+1].cells[t.index+1].offsetHeight),{x:r.offsetLeft,y:r.offsetTop,width:r.offsetWidth,height:s}}isViewOf(e){return e===this._fields}_initDom(e,t){super._initDom(e,t),Object.assign(t.style,{backgroundColor:"#f8f8f8"})}_doMeasure(e,t,i,r){return this._doPrepareCells(this.doc,this._tbody),Size.create(t.offsetWidth,this._table.offsetHeight)}_doLayoutContent(e){}$_createSectionTable(e,t,i){this._table=e.createElement("table"),TableElement.setTableStyle(this._table,!1),this._table.style.position="absolute",this._table.style.backgroundColor="white",this._table.className=CrosstabFieldsView.TABLE_CLASS;const r=this._tbody=e.createElement("tbody");let s,n;for(let t=0;t<i;t++)r.appendChild(s=e.createElement("tr")),s.appendChild(n=e.createElement("td")),n.dataset.empty="1",n.style.backgroundColor="#f0f0f0";this._table.appendChild(r),t.appendChild(this._table)}_prepareRow(e,t){const i=this._fields.count+1;for(;t.cells.length<i;){const i=e.createElement("td");i.className="rr-crosstab-field-cell",t.appendChild(i)}for(;t.cells.length>i;)Utils.remove(t.lastElementChild)}}CrosstabFieldsView.TABLE_CLASS="rr-crosstab-section-table";class RowFieldsView extends CrosstabFieldsView{constructor(e){super(e,"rowFieldsView",4)}_doPrepareCells(e,t){const i=t.rows,r=this._fields.count;for(let t=0;t<4;t++)this._prepareRow(e,i[t]);if(["Field","Header","Summary","Summary Header"].forEach(((e,t)=>{i[t].cells[0].textContent=e})),r>0)for(let e=0;e<r;e++){const t=this._fields.get(e);i[0].cells[e+1].textContent=`[${t.field}]`,Object.assign(i[0].cells[e+1].style,t.styles),i[1].cells[e+1].textContent=`[${t.field}]`,i[1].cells[e+1].dataset.type="header",Object.assign(i[1].cells[e+1].style,t.header.styles),i[2].cells[e+1].textContent=`[${t.field}]`,i[2].cells[e+1].dataset.type="summary",Object.assign(i[2].cells[e+1].style,t.summary.styles);let r=t.summary.header.text;r||(r=0===e?"전체 요약":`[${this._fields.get(e-1).field}]`),i[3].cells[e+1].textContent=r,i[3].cells[e+1].dataset.type="summaryHeader",Object.assign(i[3].cells[e+1].style,t.summary.header.styles)}}}class ColumnFieldsView extends CrosstabFieldsView{constructor(e){super(e,"columnFieldsView",4)}_doPrepareCells(e,t){const i=t.rows,r=this._fields.count;for(let t=0;t<4;t++)this._prepareRow(e,i[t]);if(["Field","Header","Summary","Summary Header"].forEach(((e,t)=>{i[t].cells[0].textContent=e})),r>0)for(let e=0;e<r;e++){const t=this._fields.get(e);i[0].cells[e+1].textContent=`[${t.field}]`,Object.assign(i[0].cells[e+1].style,t.styles),i[1].cells[e+1].textContent=`[${t.field}]`,i[1].cells[e+1].dataset.type="header",Object.assign(i[1].cells[e+1].style,t.header.styles),i[2].cells[e+1].textContent=`[${t.field}]`,i[2].cells[e+1].dataset.type="summary",Object.assign(i[2].cells[e+1].style,t.summary.styles),i[3].cells[e+1].textContent=t.summary.header.text||`[${t.field}]`,i[3].cells[e+1].dataset.type="summaryHeader",Object.assign(i[3].cells[e+1].style,t.summary.header.styles)}}}class ValueFieldsView extends CrosstabFieldsView{constructor(e){super(e,"valueFieldsView",5)}_doPrepareCells(e,t){const i=t.rows,r=this._fields.count;for(let t=0;t<5;t++)this._prepareRow(e,i[t]);if(["Field","Value","Header","Summary","Summary Header"].forEach(((e,t)=>{i[t].cells[0].textContent=e})),r>0)for(let e=0;e<r;e++){const t=this._fields.get(e);i[0].cells[e+1].textContent=`[${t.field}]`,Object.assign(i[0].cells[e+1].style,t.styles),i[1].cells[e+1].style.color="#008",i[1].cells[e+1].textContent=`[ ${t.value} ]`,i[2].cells[e+1].textContent=`[${t.field}]`,i[2].cells[e+1].dataset.type="header",Object.assign(i[2].cells[e+1].style,t.header.styles),i[3].cells[e+1].textContent=`[${t.field}]`,i[3].cells[e+1].dataset.type="summary",Object.assign(i[3].cells[e+1].style,t.summary.styles),i[4].cells[e+1].textContent=t.summary.header.text||`[${t.field}]`,i[4].cells[e+1].dataset.type="summaryHeader",Object.assign(i[4].cells[e+1].style,t.summary.header.styles)}}getFieldCellRow(e){const t=e instanceof CrosstabFieldSummaryHeader?4:e instanceof CrosstabFieldSummary?3:e instanceof CrosstabFieldHeader?2:0;return{r:t,n:0===t?2:1}}}class CrosstabBandPrintInfo extends BandPrintInfo{isEnded(){return 0===this.trows.length}getRows(){}getNextPage(e,t,i,r){const s=t.h;let n=t.h;if(this.trows.length>0){const i=this.band,o=e.createElement("div"),a=e.createElement("table"),A=e.createElement("tbody"),l=this.headers,h=this.trows,d=[];let c=0;a.appendChild(A),o.appendChild(a),o.style.position="relative",r.appendChild(o),a.style.position="absolute",TableElement.setTableStyle(a);for(let e=0;e<l.length;e++)if(c+=l[e].offsetHeight,c>n)return void(t.h=0);for(let e=0;e<l.length;e++){const t=l[e].cloneNode(!0);A.appendChild(t)}for(n-=c;n>0&&h.length>0;){let e=h[0];if(A.appendChild(e),c=e.offsetHeight,c>n){e.remove(),t.h=0;break}n-=c,d.push(h.shift())}return function(e,t){for(let i=0;i<t;i++){let t,r,s=0;e.forEach((e=>{const n=e.cells[i],o=n.textContent;o!==r?(t&&(t.rowSpan=s),t=n,s=1,r=o):(n.style.display="none",s++)})),t&&(t.rowSpan=s)}e.forEach((e=>{const i=e.cells,r=e._lev;if(r>0){i[t-r].colSpan=r;for(let e=t-r+1;e<t;e++)i[e].style.display="none"}}))}(d,i.rowFields.count),o.$_h=s-n,o}}}class CrosstabBandElement extends ReportGroupItemElement{constructor(e,t){super(e,t,"crosstabBandView"),this._nullBand=!1,this._nHeader=0,this._nRowHead=0,this._nRow=0,this._rowContainer=e.createElement("div"),this._rowContainer.className="rr-crosstab-rows",this._dom.appendChild(this._rowContainer)}static isFieldArrow(e){return e.className===FieldContainer.ARROW_CLASS}_doDispose(){super._doDispose()}getFieldOf(e){return this._rowFieldsView.getFieldOf(e)||this._columnFieldsView.getFieldOf(e)||this._valueFieldsView.getFieldOf(e)}getFieldsOf(e){for(let t of[this._rowFieldsView,this._columnFieldsView,this._valueFieldsView])if(t.containsDom(e))return t.fields}getFieldBoundingRect(e){const t=this.model,i=CrosstabBand.getFieldOf(e);let r,s;if(t.rowFields.indexOf(i)>=0?r=this._rowFieldsView:t.columnFields.indexOf(i)>=0?r=this._columnFieldsView:t.valueFields.indexOf(i)>=0&&(r=this._valueFieldsView),r)return s=r.getFieldBoundingRect(e),s.x+=r.x,s.y+=r.y,s}$_createTableContainer(e,t,i){const r=e.createElement("div");return Utils.extend(r.style,{position:"absolute",left:t+"px",top:i+"px",width:"100%"}),r}$_createTable(e){const t=e.createElement("table"),i=e.createElement("tbody");return t.appendChild(i),t.style.position="absolute",TableElement.setTableStyle(t),t}$_addTable(e,t,i,r){const s=this.$_createTableContainer(e,i,r),n=this.$_createTable(e);return s.dataset._m_=this.model.shash,n.dataset._m_=this.model.shash,s.appendChild(n),t.appendChild(s),n}$_createPage(e){const t=e.createElement("div");return t.className="rr-crosstab-page",t.style.position="relative",this._rowContainer.appendChild(t),t}printBand(e,t,i,r){function s(i,s){const n=i.$_createPage(e);return t.yBand=_=0,s&&(c=t.y=t.bodyTop),l=[],function(t,i){h=t.$_addTable(e,i,p,_),d=h.tBodies[0]}(i,n),r.push(n),s&&a.pageNo++,n}function n(e){let t=0;for(let e=0;e<g;e++)t+=A[e].offsetHeight;c+t>u&&s(e,!0);for(let e=0;e<g;e++){const t=A[e].cloneNode(!0);d.appendChild(t)}c+=t}function o(){const e=a.rowFields.count;for(let t=0;t<e;t++){let e,i,r=0;l.forEach((s=>{const n=s.cells[t],o=n.textContent;o!==i?(e&&(e.rowSpan=r),e=n,r=1,i=o):(n.style.display="none",r++)})),e&&(e.rowSpan=r)}l.forEach((t=>{const i=t.cells,r=t._lev;if(r>0){i[e-r].colSpan=r;for(let t=e-r+1;t<e;t++)i[t].style.display="none"}}))}if(this._nullBand)return;const a=this.model,A=this._tbody.rows;let l,h,d,c=t.y,u=t.bodyBottom,p=0,_=t.yBand,g=this._nHeader,m=this._nRow,f=this._nRowHead,w=0;for(s(this,!1),n(this);w<m;){const e=A[g],i=e.offsetHeight;c+i>u&&(o(),s(this,!0),n(this));const r=e.cells;for(let e=0;e<f;e++)r[e].colSpan=1,r[e].rowSpan=1,r[e].style.display="";d.appendChild(e),l.push(e),c+=i,t.y=c,w++}o()}prepareAsync(e,t,i){const r=this.model,s=Array.from(this._tbody.rows),n=this._nHeader,o=new CrosstabBandPrintInfo;return o.band=r,o.headers=s.slice(0,n),o.trows=s.slice(n),o.nHeader=n,o.nRowHead=this._nRowHead,o}get debugLabel(){return"crosstab"}_getCssSelector(){return"rr-crosstab rr-group-element"}_needDesignBox(){return!0}findElementOf(e){return this.dom.contains(e)?this:super.findElementOf(e)}_doPrepareMeasure(e,t){if(super._doPrepareMeasure(e,t),e.printing){const i=this.model;if(i&&(t.dataset._m_=i.shash,e.report&&(e.report.models[i.shash]=i),i.build()),!this._table){const e=t.ownerDocument,i=this._table=e.createElement("table");TableElement.setTableStyle(i),this._colgroup=e.createElement("colgroup"),i.appendChild(this._colgroup),this._tbody=e.createElement("tbody"),i.appendChild(this._tbody),t.appendChild(i)}}}_doMeasure(e,t,i,r){var s;const n=this.doc,o=e.printing,a=this.model;if(o)return this._table.style.width=i+"px",this.$_prepareTable(n,a,this._tbody),new Size(this._table.offsetWidth,this._table.offsetHeight);{let t,o=0,A=0;this.$_prepareDesign(n,e,a),this.$_prepareHeads(n),t=this._fieldsView.measure(e,i,r),i-=t.width,this._rowFieldsView.setFields(a.rowFields),t=this._rowFieldsView.measure(e,i,r),A+=t.height,this._columnFieldsView.setFields(a.columnFields),t=this._columnFieldsView.measure(e,i,r),A+=t.height,this._valueFieldsView.setFields(a.valueFields),t=this._valueFieldsView.measure(e,i,r),A+=t.height;const l=null===(s=this.container)||void 0===s?void 0:s.focusedItem;for(let s in this._headViews){const n=this._headViews[s];t=n.measure(e,i,r),o=Math.max(o,t.width),A+=t.height+2,n.setSelected(l)}return A-=this._headViews[this.hash].measuredHeight+2,Size.create(o,A)}}_doLayoutContent(e){const t=this.model;let i=0,r=0;if(e.printing);else{let e,s,n=this.width;i=2;let o=this._headViews[this.hash].measuredHeight;e=this._headViews[this.hash],e.setBounds(i,r+2,e.measuredWidth,e.measuredHeight),this._fieldsView.setBounds(i,r+2+o,this._fieldsView.measuredWidth,this.height-o-2),n-=this._fieldsView.width+2+i-1,i+=this._fieldsView.width+2,e=this._headViews[t.rowFields.hash],e.setBounds(i,r+2,e.measuredWidth,e.measuredHeight),r+=e.height+2,s=this._rowFieldsView,o=s.measuredHeight,s.setBounds(i,r,n,o),r+=o,e=this._headViews[t.columnFields.hash],e.setBounds(i,r+2,e.measuredWidth,e.measuredHeight),r+=e.height+2,s=this._columnFieldsView,o=s.measuredHeight,s.setBounds(i,r,n,o),r+=o,e=this._headViews[t.valueFields.hash],e.setBounds(i,r+2,e.measuredWidth,e.measuredHeight),r+=e.height+2,s=this._valueFieldsView,o=s.measuredHeight,s.setBounds(i,r,n,o),r+=o}}$_prepareDesign(e,t,i){const r=i.getData();this._fieldsView||this.addChild(this._fieldsView=new FieldContainer(e)),this._fieldsView.setFields(e,i,r?r.fields:[]),this._rowFieldsView||this.addChild(this._rowFieldsView=new RowFieldsView(e)),this._columnFieldsView||this.addChild(this._columnFieldsView=new ColumnFieldsView(e)),this._valueFieldsView||this.addChild(this._valueFieldsView=new ValueFieldsView(e))}$_prepareHeads(e){if(!this._headViews){const t=this.model;this._headViews={},this.addChild(this._headViews[this.hash]=new SectionHeadView(e,t,"CROSSTAB BAND","CrosstabBand","rr-band-head")),this.addChild(this._headViews[t.rowFields.hash]=new SectionHeadView(e,t.rowFields,"ROW FIELDS","RowFields","rr-band-head")),this.addChild(this._headViews[t.columnFields.hash]=new SectionHeadView(e,t.columnFields,"COLUMN FIELDS","ColumnFields","rr-band-head")),this.addChild(this._headViews[t.valueFields.hash]=new SectionHeadView(e,t.valueFields,"VALUE FIELDS","ValueFields","rr-band-head"))}}$_prepareTable(e,t,i){const r=t._columns.levels,s=t.rowFields.count,n=t.valueFields.count,o=t._columns.leafCount,a=s+o;if(r<1||s<1||n<1)return void(this._nullBand=!0);this.$_prepareColGroup(e,this._colgroup,a);const A=[];for(let t=0;t<r;t++){const t=e.createElement("tr");for(let i=0;i<a;i++){const i=e.createElement("td");i.className="rr-crosstab-head",t.appendChild(i)}i.appendChild(t),A.push(t)}for(let e=0;e<r;e++)for(let t=0;t<s;t++)A[e].cells[t].style.display="none";const l=A[0].cells[0];l.rowSpan=r,l.colSpan=s,l.style.display="",l.textContent=t.title.text,Object.assign(l.style,t.title.styles);let h=A[r-1].cells;for(let e=s;e<h.length;e++){const i=h[e],r=t._columns.getLeaf(e-s);i.textContent=r.getHeader(),Object.assign(i.style,r.valueField.header.styles),r instanceof CrosstabSummaryLeafColumn&&Object.assign(i.style,r.valueField.summary.header.styles)}!function e(i,r){const s=i.level+1,o=A[s].cells,a=i.children;let l=t.rowFields.count+s*n+r,h=0;for(let i=0;i<a.length;i++){const r=a[i],n=l,d=o[l++];let c=r.leafCount;d.textContent=r.getHeader(),d.colSpan=c;for(let e=1;e<c;e++)o[l++].style.display="none";if(Object.assign(d.style,r.field.header.styles),r instanceof CrosstabSummaryColumn){const e=t.columnLevels-1;Object.assign(d.style,r.field.summary.header.styles);for(let t=s+1;t<e;t++)for(let e=0;e<c;e++)A[t].cells[n+e].style.display="none";d.rowSpan=e-s}else r.children[0].isLeaf||(e(r,h),h+=c)}}(t._columns.root,0),this._nHeader=i.rows.length;const d=t.bandData,c=t.rows,u=c.rowCount,p=t.nullValue.text,_=t.nullValue.styles;for(let r=0;r<u;r++){const n=e.createElement("tr"),a=c.getRow(r);for(let i=0;i<s;i++){const r=t.getRowField(i),s=e.createElement("td"),o=a.getValue(i)+(r.header.suffix||"");s.className="rr-crosstab-head",s.textContent=o,Object.assign(s.style,r.header.styles),n.appendChild(s)}if(0===r){const e=t.rowFields.get(0).summary.header,i=n.cells[0];e.text&&(i.textContent=e.text),Object.assign(i.style,e.styles),n._lev=s}else if(a instanceof CrosstabSummaryRow){const e=a.fields.length,i=t.rowFields.get(e).summary.header,r=n.cells[e];i.text&&(r.textContent=i.text),Object.assign(r.style,i.styles),n._lev=s-e}const A=new NumberFormatter("#,##0");for(let i=0;i<o;i++){const s=e.createElement("td"),o=t.getCellValue(d,r,i);s.className="rr-crosstab-value",isNaN(o)&&(s.classList.add("rr-crosstab-null"),Object.assign(s.style,_)),s.textContent=isNaN(o)?p:A.getText(o);const l=t._columns.getLeaf(i);if(l instanceof CrosstabSummaryLeafColumn&&Object.assign(s.style,l.valueField.summary.styles),0===r)Object.assign(s.style,t.rowFields.get(0).summary.styles);else if(a instanceof CrosstabSummaryRow){const e=a.fields.length;Object.assign(s.style,t.rowFields.get(e).summary.styles)}n.appendChild(s)}i.appendChild(n)}this._nRow=i.rows.length-this._nHeader,this._nRowHead=t.rowFields.count}$_prepareColGroup(e,t,i){let r=t.childElementCount;for(;r++<i;){const i=e.createElement("col");t.appendChild(i)}for(;t.childElementCount>i;)t.removeChild(t.lastElementChild)}}class BodyItemsElement extends ColumnBoxContainerElement{getLines(){const e=[];for(let t=0;t<this._container.childCount;t++){const i=this._container.getChild(t);i instanceof ReportItemElement&&!i.isSpace&&!i.floating&&e.push(i)}return e}getLine(e){const t=this._container.childCount;if(t>0)if(e>=0)for(let i=0,r=0;i<t;i++){const t=this._container.getChild(i);if(t instanceof ReportItemElement&&!t.isSpace&&!t.floating){if(r==e)return t;r++}}else for(let i=t-1,r=-1;i>=0;i--){const t=this._container.getChild(i);if(t instanceof ReportItemElement&&!t.isSpace&&!t.floating){if(r==e)return t;r--}}}isLine(e){return!e.isSpace&&!e.floating&&this._container.contains(e)}getLineOf(e){if(this.isLine(e))return e;let t=e;for(;t;){const e=t.navigableParent;if(e===this._container||e instanceof BandElement)return t;t=e}}getSiblingLine(e,t){let i=e.navigableParent;if(i instanceof BandElement){const r=i.getSibling(e,t);if(r)return r;e=i}i=this._container;let r=i.indexOf(e);if(r>=0)if(t>0)for(let e=r+1;e<i.childCount;e++){const t=i.getChild(e);if(t instanceof ReportItemElement&&!t.isSpace&&!t.floating)return t}else if(t<0)for(let e=r-1;e>=0;e--){const t=i.getChild(e);if(t instanceof ReportItemElement&&!t.isSpace&&!t.floating)return t}}get isLayer(){return!0}get debugLabel(){return""}get designable(){return!1}_debugBorder(){return"none"}_doMeasure(e,t,i,r){const s=e.printing?Math.ceil(e.bodyHeight)-Math.ceil(e.reportHeaderHeight)-Math.ceil(e.reportFooterHeight)-Math.ceil(e.headerHeight)-Math.ceil(e.footerHeight):r;return super._doMeasure(e,t,i,s)}}class PageBodyElement extends ReportElement{constructor(e,t){super(e,"pageBody"),this._findable=!0,this._modelChanged=!1,this._model=t,this.addChild(this._backContainerView=new PageItemContainerElement(e,null,"backView")),this.addChild(this._itemsView=new BodyItemsElement(e,null)),this.addChild(this._frontContainerView=new PageItemContainerElement(e,null,"frontView"))}_doDispose(){super._doDispose()}get model(){return this._model}set model(e){e!==this._model&&(this._model=e,this._modelChanged=!0,e&&(this._backContainerView.model=e.backItemsContainer,this._frontContainerView.model=e.frontItemsContainer,this._itemsView.model=e.itemsContainer))}get empty(){return 0==this._itemsView.childCount&&0==this._backContainerView.childCount&&0==this._frontContainerView.childCount}get itemsView(){return this._itemsView}isPageDom(e){return this.isDom(e)||this._itemsView.isDom(e)||this._itemsView.isContentDom(e)}findElement(e){return this._itemsView.findElement(e)||this._backContainerView.findElement(e)||this._frontContainerView.findElement(e)}findElementOf(e){return this._itemsView.findElementOf(e)||this._backContainerView.findElementOf(e)||this._frontContainerView.findElementOf(e)}getElementOf(e){return this._itemsView.getElementOf(e)||this._backContainerView.getElementOf(e)||this._frontContainerView.getElementOf(e)}isLine(e){return this._itemsView.isLine(e)}getLineOf(e){return this._itemsView.getLineOf(e)}getSiblingLine(e,t){return this._itemsView.getSiblingLine(e,t)}getLine(e){return this._itemsView.getLine(e)}getLines(){return this._itemsView.getLines()}printAll(e,t){const i={pages:new Array};return this.print(e,t),this.empty||(this.layoutFloating(t),this.$_buildPages(e,t,i)),i}prepareAsync(e,t){return this.print(e,t),this.empty?[]:(this.layoutFloating(t),this.$_prepareAsync(e,t))}itemOfDom(e){let t;return(t=this._frontContainerView.itemOfDom(e))||(t=this._itemsView.itemOfDom(e))||(t=this._backContainerView.itemOfDom(e))?t:void 0}_getCssSelector(){return"rr-page-body"}get debugLabel(){return"page body"}get findable(){return this._findable}set findable(e){this._findable=e}_debugBorder(){return"1px solid rgba(0, 0, 255, 0.3)"}_debugColor(){return"rgba(0, 0, 255, 0.4)"}_doMeasure(e,t,i,r){this._modelChanged&&(this._modelChanged=!1),this._backContainerView.setFixedSize(i).measure(e,i,r),this._itemsView.setFixedSize(i).measure(e,i,r),this._frontContainerView.setFixedSize(i).measure(e,i,r);const s=Math.max(this.itemsView.measuredHeight,r);return new Size(i,s)}_doLayoutContent(e){const t=this.width,i=this.height;let r;r=this._backContainerView,r.setBounds(0,0,t,i),r.layoutContent(e),r=this._itemsView,r.setBounds(0,0,t,i),r.layoutContent(e),r=this._frontContainerView,r.setBounds(0,0,t,i),r.layoutContent(e)}layoutFloating(e){this._backContainerView.layoutFloating(e),this._itemsView.layoutFloating(e),this._frontContainerView.layoutContent(e)}$_buildPages(e,t,i){function r(){const e=[];o.push(e);let i=t.bodyTop;return t.h=t.bodyHeight,0==d&&(t.h-=t.reportHeaderHeight,i+=t.reportHeaderHeight),t.y=i,l=!0,e}const s=this._itemsView,n=s.childCount;if(n<1)return;const o=i.pages,a=t.pageWidth,A=s.gap;let l,h,d=0;for(t.h=0;d<n;){l=!1,t.h<=0&&(h=r());const i=d<n-1;let c,u,p=s.getChild(d++);if(p.printable){if(p instanceof ReportItemElement&&p.model.isBreakBefore()&&(h=r()),p instanceof BandElement||p instanceof BandGroupElement){let r=t.y;const s=[];p instanceof BandElement?p.printBand(e,t,a,s):p.printGroup(e,t,s);for(let e=0;e<s.length;e++)e>0&&(o.push(h=[]),r=t.bodyTop),c=s[e],c.style.top=r+"px",c.$_h=t.y-r+(i&&e===s.length-1?A:0),h.push(c);t.h-=A}else if(p instanceof CrosstabBandElement){let r=t.y;const s=[];p.printBand(e,t,a,s);for(let e=0;e<s.length;e++)e>0&&(o.push(h=[]),r=t.bodyTop),c=s[e],c.style.top=r+"px",c.$_h=t.y-r+(i&&e===s.length-1?A:0),h.push(c);t.h-=A}else u=p.height,u>t.h&&p instanceof SpaceItemElement&&(u=t.h),c=p._dom,p instanceof ReportItemElement&&p.floating?(h.push(c),p=null):u<=t.h?(c.style.top=t.y+"px",c.$_h=u+=i?A:0,h.push(c),t.h-=u,t.y+=u):l?(c.style.top=t.y+"px",c.$_h=u+=i?A:0,h.push(c),t.h=0):(t.h=0,d--,p=null);p instanceof ReportItemElement&&p.model.isBreakAfter()&&d<n&&(h=r())}else p.visible=!1}t.h<t.reportFooterHeight&&r()}$_prepareAsync(e,t){const i=this._itemsView,r=i.childCount;if(r<1)return[];const s=[];let n=0;for(;n<r;){let o=i.getChild(n++);o.printable?(o instanceof ReportItemElement&&o.model.isBreakBefore()&&s.push(new PageBreaker),o instanceof BandElement||o instanceof BandGroupElement||o instanceof CrosstabBandElement?s.push(o.prepareAsync(e,t,t.pageWidth,null,-1)):(o.dom.$_h=o.height,s.push(o.dom)),o instanceof ReportItemElement&&o.model.isBreakAfter()&&n<r&&s.push(new PageBreaker)):o.visible=!1}return s}}class PageSectionGuard extends ReportItemElement{get guardLabel(){return"[page]"}}class PageView extends LayerElement{constructor(e){super(e,"pageView"),this.addChild(this._backView=new PageItemContainerElement(e,null,"rr-back-container",!1)),this.addChild(this._reportHeaderView=new ReportHeaderElement(e)),this.addChild(this._reportFooterView=new ReportFooterElement(e)),this.addChild(this._pageHeaderView=new PageHeaderElement(e)),this.addChild(this._pageFooterView=new PageFooterElement(e)),this.addChild(this._bodyView=new PageBodyElement(e)),this.addChild(this._frontView=new PageItemContainerElement(e,null,"rr-front-container",!1)),this._sections=[this._pageHeaderView,this._reportHeaderView,this._bodyView,this._reportFooterView,this._pageFooterView],this._sectionGuard=new PageSectionGuard(e)}_doDispose(){super._doDispose()}get model(){return this._model}get reportHeaderView(){return this._reportHeaderView}get reportFooterView(){return this._reportFooterView}get pageHeaderView(){return this._pageHeaderView}get pageFooterView(){return this._pageFooterView}get bodyView(){return this._bodyView}get backFloatingView(){return this._backView}get frontFloatingView(){return this._frontView}get sections(){return this._sections}isPageDom(e){return this.isDom(e)||this.bodyView.isPageDom(e)}measure(e,t){const i=t.width-2,r=t.height-2;let s=0;this._sectionGuard.model=this._model,this._model.clearStyles(this.dom.style),applyStyles(this._model,this._model.styles,this.dom.style);let n=this._backView;n.measureFixed=!0,n.measure(e,i,r),n.setBounds(0,0,i,r);const o=this._pageHeaderView.model;let a=this._pageHeaderView,A=a.setFixedSize(i).measure(e,i,r);s+=Utils.toNumber(o.spaceTop),a.setBounds(0,s,i,A.height),s+=A.height+Utils.toNumber(o.spaceBottom);const l=this._reportHeaderView.model;a=this._reportHeaderView,A=a.setFixedSize(i).measure(e,i,r),s+=Utils.toNumber(l.spaceTop),a.setBounds(0,s,i,A.height),s+=A.height+Utils.toNumber(l.spaceBottom);let h=r;const d=this._pageFooterView.model;a=this._pageFooterView,A=a.setFixedSize(i).measure(e,i,r),h-=A.height-Utils.toNumber(d.spaceBottom),a.setBounds(0,h,i,A.height),h-=Utils.toNumber(d.spaceTop);const c=this._reportFooterView.model;a=this._reportFooterView,A=a.setFixedSize(i).measure(e,i,r),h-=A.height-Utils.toNumber(c.spaceBottom),a.setBounds(0,h,i,A.height),h-=Utils.toNumber(c.spaceTop);const u=this._bodyView;A=u.measure(e,i,h-s),u.setBounds(0,s,i,A.height);const p=A.height-(h-s);p>0&&(this.pageFooterView.y+=p,this._reportFooterView.y+=p),n=this._frontView,n.setFixedSize(i).measure(e,i,r),n.setBounds(0,0,i,r);return{width:i,height:this._pageHeaderView.measuredHeight+this._reportHeaderView.measuredHeight+this._bodyView.measuredHeight+this._pageFooterView.measuredHeight+this._reportFooterView.measuredHeight}}layout(e,t){let i=this._pageHeaderView;i.layoutContent(e),i=this._reportHeaderView,i.layoutContent(e),i=this._reportFooterView,i.layoutContent(e),i=this._pageFooterView,i.layoutContent(e),this._bodyView.layoutContent(e),this._backView.layoutContent(e),this._frontView.layoutContent(e)}layoutFloating(e){this._pageHeaderView.layoutFloating(e),this._reportHeaderView.layoutFloating(e),this._reportFooterView.layoutFloating(e),this._pageFooterView.layoutFloating(e),this._bodyView.layoutFloating(e),this._backView.layoutFloating(e),this._frontView.layoutFloating(e)}afterRender(e){const t=this._backView.width,i=this._backView.height;this._backView.measure(e,t,i),this._backView.layoutContent(e),this._frontView.measure(e,t,i),this._frontView.layoutContent(e)}findElement(e){return this._bodyView.findElement(e)||this._backView.findElement(e)||this._frontView.findElement(e)||this._pageHeaderView.findElement(e)||this._pageFooterView.findElement(e)||this._reportHeaderView.findElement(e)||this._reportFooterView.findElement(e)}findElementOf(e){return this._pageHeaderView.findElementOf(e)||this._pageFooterView.findElementOf(e)||this._reportHeaderView.findElementOf(e)||this._reportFooterView.findElementOf(e)||this._bodyView.findElementOf(e)||this._backView.findElementOf(e)||this._frontView.findElementOf(e)}getElementOf(e){if(e===this._bodyView.model)return this._bodyView;for(let t of this._sections)if(t instanceof ReportItemElement&&t.model===e)return t;return this._bodyView.getElementOf(e)||this._backView.getElementOf(e)||this._frontView.getElementOf(e)||this._pageHeaderView.getElementOf(e)||this._pageFooterView.getElementOf(e)||this._reportHeaderView.getElementOf(e)||this._reportFooterView.getElementOf(e)}getAllElements(e,t){function i(e,t){(e instanceof TableElement?e.cellViews:e.elements).forEach((e=>{e instanceof TableCellElementBase?e.getChild(0)instanceof ReportItemElement&&t.push(e.getChild(0)):e instanceof ReportGroupItemElement?i(e,t):e instanceof ReportItemElement&&t.push(e)}))}const r=[];e?(t.translate(-e.dom.offsetLeft,-e.dom.offsetTop),i(e,r),t.translate(e.dom.offsetLeft,e.dom.offsetTop)):this.sections.forEach((e=>{t.translate(-e.dom.offsetLeft,-e.dom.offsetTop),i(e,r),t.translate(e.dom.offsetLeft,e.dom.offsetTop)}));const s=this.getBoundingRect();return t.translate(s.x,s.y),r.filter((e=>{const i=e.getBoundingRect();return t.intersects(i)}))}prepareAsync(e,t){const i=this.dom,r=this.width;this._model.clearStyles(i.style),applyStyles(this._model,this._model.styles,i.style),this.setPrintStyles(),this._backView.setBounds(0,0,r,this.height),this._backView.print(e,t,r),this._frontView.setBounds(0,0,r,this.height),this._frontView.print(e,t,r),[[this._pageHeaderView,"header"],[this._pageFooterView,"footer"],[this._reportHeaderView,"reportHeader"],[this._reportFooterView,"reportFooter"]].forEach((i=>{!function(i,s){const n=i.model;n.visible?t[s+"Height"]=i.$_h=i.print(e,t,r)+Utils.toNumber(n.spaceTop)+Utils.toNumber(n.spaceBottom):t[s+"Height"]=i.$_h=0}(i[0],i[1])})),t.bodyTop=t.headerHeight,t.bodyBottom=t.pageHeight-t.footerHeight,t.bodyHeight=t.bodyBottom-t.bodyTop,t.pages=[];return this._bodyView.prepareAsync(e,t)}refreshPageHeader(e,t){this.pageHeaderView.print(e,t,this.width);return this._pageHeaderView.cloneNode()}getSections(){let e=[this._sectionGuard];return this._pageHeaderView.visible&&e.push(this._pageHeaderView),this._reportHeaderView.visible&&e.push(this._reportHeaderView),e=e.concat(this._bodyView.getLines()),this._reportFooterView.visible&&e.push(this._reportFooterView),this._pageFooterView.visible&&e.push(this._pageFooterView),e}isLine(e){return e instanceof SectionElement||this._bodyView.isLine(e)}getFirst(){if(this._pageHeaderView.visible)return this._pageHeaderView.getFirst()}getLast(){if(this._pageFooterView.visible)return this._pageFooterView.getLast()}getFirstInGroup(e){return null==e?void 0:e.getFirst()}getLastInGroup(e){return null==e?void 0:e.getLast()}getPrev(e){var t;if(e instanceof SectionElement);else if(e){let i=null===(t=e.navigableParent)||void 0===t?void 0:t.getPrev(e);if(i&&i!==e)return i}}getNext(e){if(e instanceof SectionElement);else if(e){let t=e.navigableParent;if(t){let i=t.getNext(e);if(i&&i!==e)return i;for(t=t.navigableParent;t;)t.getLeaves(),t=t.navigableParent}}}getLeft(e){var t;if(e instanceof SectionElement);else if(e){let i=null===(t=e.navigableParent)||void 0===t?void 0:t.getLeft(e);if(i&&i!==e)return i;if(this._bodyView.isLine(e))return}}getRight(e){var t;if(e instanceof SectionElement);else if(e){let i=null===(t=e.navigableParent)||void 0===t?void 0:t.getRight(e);if(i&&i!==e)return i;if(this._bodyView.isLine(e))return}}getUpper(e){var t;if(e instanceof SectionElement){const t=this._sections.indexOf(e);if(t>0){const e=this._sections[t-1];return e instanceof ReportItemElement?e:this._bodyView.getLine(-1)}}else if(e){let i=null===(t=e.navigableParent)||void 0===t?void 0:t.getUpper(e);if(i&&i!==e)return i;if(e.navigableParent===this._reportHeaderView)return this._pageHeaderView;if(i=this._bodyView.getLineOf(e),i&&(i=this._bodyView.getSiblingLine(i,-1),i))return i}return this.getFirst()}getLower(e){var t;if(e instanceof SectionElement){const t=this._sections.indexOf(e);if(t<this._sections.length-1){const e=this._sections[t+1];return e instanceof ReportItemElement?e:this._bodyView.getLine(0)}}else if(e){let i=null===(t=e.navigableParent)||void 0===t?void 0:t.getLower(e);if(i&&i!==e)return i;if(e.navigableParent===this._pageHeaderView)return this._reportHeaderView;if(e.navigableParent===this._reportHeaderView)return this._bodyView.getLine(0);if(i=this._bodyView.getLineOf(e),i)return i=this._bodyView.getSiblingLine(i,1),i||(i=this._reportFooterView,i.visible?i:(i=this._pageFooterView,i.visible?i:void 0))}return this.getFirst()}itemOfDom(e){let t;if(t=this._frontView.itemOfDom(e))return t;for(let i of this._sections)if(i instanceof ReportGroupItemElement&&(t=i.itemOfDom(e)))return t;return(t=this._bodyView.itemOfDom(e))||(t=this._backView.itemOfDom(e))?t:void 0}_getCssSelector(){return this.container.printing?"":"rr-page"}$_setModel(e){this._model=e,e?(this._reportHeaderView.model=e.reportHeader,this._reportFooterView.model=e.reportFooter,this._pageHeaderView.model=e.pageHeader,this._pageFooterView.model=e.pageFooter,this._bodyView.model=e.body,this._backView.model=e._backItems,this._frontView.model=e._frontItems):(this._reportHeaderView.model=null,this._reportFooterView.model=null,this._pageHeaderView.model=null,this._pageFooterView.model=null,this._bodyView.model=null,this._backView.model=null,this._frontView.model=null)}}class PrintPage{constructor(){this.contents=[]}}class BooleanFormatter{constructor(e){this.$_parse(this._format=e)}static getFormatter(e){let t=BooleanFormatter.Formatters[e];return t||(BooleanFormatter.Formatters[e]=t=new BooleanFormatter(e)),t}get format(){return this._format}getText(e){return void 0===e?this._nullText:e?this._trueText:this._falseText}$_parse(e){if(this._falseText=this._trueText=null,e){var t=e.split(/[;\:]/);this._falseText=t[0],t.length>0&&(this._trueText=t[1]),t.length>1&&(this._nullText=t[2])}}}BooleanFormatter.Formatters={};const DUMMY_PATTERN=/(.*)/,DUMMY_REPLACE="$1";class TextFormatter{constructor(e){this._pattern=DUMMY_PATTERN,this._replace="$1",this.$_parse(this._format=e)}static getFormatter(e){let t=TextFormatter.Formatters[e];return t||(TextFormatter.Formatters[e]=t=new TextFormatter(e)),t}get format(){return this._format}getText(e){return e&&e.replace(this._pattern,this._replace)}$_parse(e){if(e){const t=e.trim().split(Utils.colonreg);if(t.length>1){let e=t[0].trim(),i=t[1].trim();e&&i&&('"'==e.charAt(0)&&(e=e.substr(1,e.length-2)),e&&('"'==i.charAt(0)&&(i=e.substr(1,i.length-2)),i&&(this._pattern=new RegExp(e,t[2]||""),this._replace=i)))}}}}TextFormatter.Formatters={};class TextItemElementBase extends ReportItemElement{constructor(e,t,i){super(e,t,i)}_doDispose(){super._doDispose()}get debugLabel(){return""}_initDom(e,t){super._initDom(e,t),t.style.overflow="hidden",this._span=e.createElement("span"),this._span.style.display="table-cell",t.appendChild(this._span)}_doPrepareMeasure(e,t){super._doPrepareMeasure(e,t),e.contextable&&this.model.isContextValue()&&(e.contextValues.push(this),this._span.dataset.rr_ctx_val=this.model.value),e.printing&&(this._span.dataset._m_=t.dataset._m_||String(this.model.hash),this._span.classList.add(TextItemElement.SPAN))}_doMeasure(e,t,i,r){const s=this.model,n=this._span,o=t.style;let a;if(t.style.display="inline-table",a=s.getStyle("verticalAlign"),!a){const e=s.getStyle("writingMode");e&&e.startsWith("vertical")||(a="middle")}if(this._span.style.verticalAlign=a,this._span.style.textDecoration=s.getStyle("textDecoration"),t.style.width="",t.style.height="",this._setModelSize(s,t,i,r),o.whiteSpace=s.wrap&&s.width?"pre-wrap":"pre",o.wordBreak=s.wrap&&s.width?"break-all":"keep-all",e.printing)a=this._getPrintText(e,s),this._setBindMarker(!1);else{const e=s.value,t=e&&e.startsWith("${");a=this._getDesignText(s,t),e?this._setBindMarker(!0,t):this._setBindMarker(!1)}if(this._text=a=a||"",s.multiLine){const e=/(\r|\n|\r\n|\<br\>|\<br\/\>)/gm;n.innerHTML=a.replace(e,"<br/>")}else n.textContent=a;e.printing&&!a&&(n.innerHTML=ZWSP),!e.printing&&a&&(t.title=a);let A=this._modelWidth,l=this._modelHeight;return isNaN(A)?(n.style.maxWidth="",A=t.offsetWidth,"italic"===s.getStyle("fontStyle")&&(A+=Math.max(1,.04*n.offsetWidth)),A=Math.ceil(A)+1):n.style.maxWidth=A+"px",isNaN(l)&&(n.style.maxHeight="",l=Math.round(t.offsetHeight)),new Size(A,l)}_doLayoutContent(e){}refreshPrintValues(e){this._span.textContent=this._getPrintText(e,this.model)}isDom(e){return e===this._span||super.isDom(e)}_getText(e,t){const i=typeof t;let r=t;if("string"===i){if(t){const i=e.textFormat;if(i){const e=TextFormatter.getFormatter(i);e&&(r=e.getText(t))}}}else if("number"===i){const i=e.numberFormat;if(i){const e=NumberFormatter.getFormatter(i);e&&(r=e.getText(t))}}else if(t instanceof Date){const i=e.dateFormat;if(i){const e=DatetimeFormatter.getFormatter(i);e&&(r=e.getText(t))}}else if("boolean"===i){const i=e.booleanFormat;if(i){const e=BooleanFormatter.getFormatter(i);e&&(r=e.getText(t))}}return Utils.isDefined(r)&&""!==r?e.prefix||e.suffix?(e.prefix||"")+r+(e.suffix||""):String(r):r}}TextItemElementBase.CLASS_NAME="rr-text",TextItemElementBase.CLASS_LIST=TextItemElementBase.CLASS_NAME+" rr-item-element",TextItemElementBase.SPAN="_rr_span_";class TextItemElement extends TextItemElementBase{constructor(e,t){super(e,t,"textItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return TextItemElementBase.CLASS_LIST}get guardLabel(){return"text"}get editable(){return!0}getEditText(){return this.model.text}setEditText(e,t){e.setItemProperty(this.model,"text",t)}_getPrintText(e,t){const i=t.contextValueCallback;if(i){e.contextElements&&(this._span.dataset.rr_ctx_call=e.page+"",this._span.dataset.rr_ctx_all_call=e.compositePage+"",this._span.dataset.rr_ctx_view=this.shash,e.contextElements[this.shash]=this);const r=i(e);return this._getText(t,r)}if(t.value){const i=this.getPrintValue(e,t);return this._getText(t,i)}{const i=this._runValueCallback(e,t,void 0);return void 0!==i?this._getText(t,i):t.text}}_getDesignText(e,t){return e.value?t?e.value:"["+e.value+"]":e.text||"[text]"}_doMeasure(e,t,i,r){const s=this.model;if(!e.printing){s.value||s.text?delete t.dataset.empty:t.dataset.empty=""}return super._doMeasure(e,t,i,r)}isDom(e){return!!super.isDom(e)||this._spans&&this._spans.indexOf(e)>=0}}class ImageItemElement extends ReportItemElement{constructor(e,t){super(e,t,"imageItemView")}get debugLabel(){return"image"}_getCssSelector(){return"rr-image rr-item-element"}_doMeasure(e,t,i,r){const s=this.model,n=s.image&&e.assets.getImage(s.image),o=t.style;let a=n||s.url;return e.printing&&!this._image&&(this._image=new Image),e.printing&&!a&&(a=this.getPrintValue(e,s)),this._setModelSize(s,t,i,r),a?(o.overflow=o.overflow||"hidden",o.backgroundImage="url("+a+")",o.backgroundRepeat="no-repeat",o.backgroundSize=s.imageFit,o.backgroundPosition=s.imagePosition,o["-webkit-print-color-adjust"]="exact",delete t.dataset.empty,t.innerHTML="",this._image&&(this._image.src=a)):(t.dataset.empty="true",t.innerHTML="<span></span>"),new Size(t.offsetWidth,t.offsetHeight)}}class CheckItemElement extends ReportItemElement{constructor(e,t){super(e,t,"checkItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-check rr-item-element"}get debugLabel(){return""}isDom(e){return e===this._check||e===this._text||e===this._text.parentElement||super.isDom(e)}_initDom(e,t){super._initDom(e,t),t.style.overflow="hidden",t.style.whiteSpace="nowrap";const i=e.createElement("div");i.style.display="table-cell",i.style.verticalAlign="middle",t.appendChild(i),this._check=e.createElement("span"),this._check.className=CheckItemElement.CHECK_CLASS,this._check.style.display="inline-block",this._check.style.verticalAlign="middle",i.appendChild(this._check),this._text=e.createElement("span"),this._text.className=CheckItemElement.TEXT_CLASS,i.appendChild(this._text)}_doMeasure(e,t,i,r){const s=this.model,n=e.printing?Utils.pick(this.getPrintValue(e,s),s.checked):s.checked,o=this._check,a=this._text;this._setModelSize(s,t,i,r,!0),o.dataset.checked=s.getChecked(n),a.textContent=s.getText(n);let A=Math.ceil(Math.max(o.offsetHeight,a.offsetHeight)),l=Math.ceil(o.offsetWidth)+Math.ceil(a.offsetWidth)+1;return"italic"===s.getStyle("fontStyle")&&(l+=Math.max(1,.04*a.offsetWidth)),l=Math.ceil(l),e.printing&&(this._check.dataset._m_=t.dataset._m_),Size.create(l,A)}}CheckItemElement.CHECK_CLASS="rr-check-check",CheckItemElement.TEXT_CLASS="rr-check-text";class ListCellElement extends ReportGroupItemElement{constructor(e,t,i){super(e,i,"listCellView"),this._list=t}_doDispose(){super._doDispose()}get debugLabel(){return""}get navigable(){return!1}get navigableParent(){return this._list}_needContentBox(){return!1}_isEmptySize(){return!0}_getParentDom(){return this._div}_createDom(e){const t=e.createElement("li"),i=this._div=e.createElement("div");return t.appendChild(i),i.className="rr-list-cell",i.style.position="relative",i.style.display="inline-flex",i.style.verticalAlign="text-top",t}_prepareChild(e){e._dom.style.position="relative",e.positionable=!1}_doMeasure(e,t,i,r){return super._doMeasure(e,t,i,r)}}class ListContainerElement extends ReportGroupItemElement{constructor(e,t){super(e,t,(t&&t.ordered?"o":"u")+"listContainerView")}_doDispose(){super._doDispose()}get debugLabel(){return"list"}_getCssSelector(){return"rr-list-container rr-group-element"}_needDesignBox(){return!0}_needContentBox(){return!1}_getParentDom(){return this._list}_createDom(e){const t=super._createDom(e);t.style.overflow="hidden";const i=this._list=e.createElement(this.name.startsWith("o")?"ol":"ul");return t.appendChild(i),t}_initDom(e,t){super._initDom(e,t);const i=this._list.style;i.marginBlockStart="0",i.marginBlockEnd="0"}_createElement(e,t,i){const r=new ListCellElement(this.doc,this,i);if(i.item instanceof ListContainer){r.dom.style.listStyleType="none"}return this._prepareChild(r),t.addChild(r),r}_prepareChild(e){e._dom.style.position="relative",e.positionable=!1}_doMeasure(e,t,i,r){const s=this.model;this.measureFixed?(t.style.width="",t.style.height=""):this._setModelSize(s,t,i,r,!0);const n=this._list;switch(s.marker){case ListContainerMarker.CIRCLE:case ListContainerMarker.DISC:case ListContainerMarker.SQUARE:n instanceof HTMLUListElement&&(n.style.listStyleType=s.marker);break;case ListContainerMarker.DECIMAL:case ListContainerMarker.LOWER_ROMAN:case ListContainerMarker.UPPER_ROMAN:case ListContainerMarker.LOWER_ALPHA:case ListContainerMarker.UPPER_ALPHA:n instanceof HTMLOListElement&&(n.style.listStyleType=s.marker);break;case ListContainerMarker.NONE:n.style.listStyleType=s.marker}return n instanceof HTMLOListElement&&s.start&&(n.start=s.start),void 0!==s.indent&&(n.style.paddingInlineStart=s.indent+"px"),super._doMeasure(e,t,i,r)}_doAfterMeasure(e,t,i,r,s){this.childCount>0?this._applyBorders(t,s):e.printing||(!this.model.height&&this.model.designHeight>0&&(s.height=this.model.designHeight),!this.model.width&&this.model.designWidth>0&&(s.width=this.model.designWidth)),super._doAfterMeasure(e,t,i,r,s)}_doLayout(e){}getLower(e){for(let t=0,i=this.childCount;t<i;t++)if(this.getChild(t).firstChild===e&&t<i-1)return this.getChild(t+1).firstChild}getUpper(e){for(let t=0,i=this.childCount;t<i;t++)if(this.getChild(t).firstChild===e&&t>0)return this.getChild(t-1).firstChild}}class TableCellElement extends TableCellElementBase{constructor(e,t,i){super(e,t,i,"tableCellView")}_getCssSelector(){return"rr-table-cell"}}class TableContainerElement extends TableElement{constructor(e,t){super(e,t,"tableContainerView")}get columns(){return this.model.columns}get colCount(){return this.model.colCount}getColumn(e){return this.model.getColumn(e)}_getCssSelector(){return"rr-table-container rr-group-element"}_createCellElement(e,t){return new TableCellElement(e,this,t)}_prepareCellStyles(e,t,i,r,s){if(super._prepareCellStyles(e,t,i,r,s),e.printing){const n=t.getCell(i,r),o=n.styleCallback;if(o)try{const t=o(e,n,e.row);t&&Utils.extend(s.style,t)}catch(e){console.error("CellStyleCallback Error",e)}}}}class BandCollectionElement extends ReportGroupItemElement{constructor(e,t){super(e,t,"bandCollectionView")}_doDispose(){super._doDispose()}get debugLabel(){return""}_getCssSelector(){return"rr-band-collection rr-group-element"}_needDesignBox(){return!0}_initDom(e,t){super._initDom(e,t)}_doMeasure(e,t,i,r){const s=super._doMeasure(e,t,i,r);s.height=0;for(let e=0;e<this.childCount;e++)s.height+=this.getChild(e).measuredHeight;return s}_doAfterMeasure(e,t,i,r,s){this.childCount>0?this._applyBorders(t,s):e.printing||(!this.model.height&&this.model.designHeight>0&&(s.height=this.model.designHeight),!this.model.width&&this.model.designWidth>0&&(s.width=this.model.designWidth)),super._doAfterMeasure(e,t,i,r,s)}_doLayoutContent(e){super._doLayoutContent(e);const t=this,i=t.width;let r=0;for(let e=0,s=t.childCount;e<s;e++){const s=t.getChild(e);s.floating||(s.y=r,s.x=0+(i-s.width)/2,r+=s.height,r+=0,s.setPrintStyles())}}}class SimpleBandSectionElement extends StackContainerElement{constructor(e,t,i,r){super(e,t,i),this.styleName=r}_doDispose(){super._doDispose()}get debugLabel(){return""}_getCssSelector(){return this.styleName+" rr-group-element"}_needDesignBox(){return!0}_doAfterMeasure(e,t,i,r,s){this.childCount>0||e.printing||(!this.model.height&&this.model.designHeight>0&&(s.height=this.model.designHeight),!this.model.width&&this.model.designWidth>0&&(s.width=this.model.designWidth)),super._doAfterMeasure(e,t,i,r,s)}}class SimpleBandGroupSectionElement extends StackContainerElement{constructor(e,t,i){super(e,t,i)}applyGroupStyles(e){Utils.extend(e.style,this.model.styles)}_needDesignBox(){return!0}_doMeasure(e,t,i,r){const s=super._doMeasure(e,t,i,r);return s.width=i,s.height=Math.max(24,s.height),s}_doAfterMeasure(e,t,i,r,s){this.childCount>0?this._applyBorders(t,s):e.printing||(!this.model.height&&this.model.designHeight>0&&(s.height=Math.max(s.height,this.model.designHeight)),!this.model.width&&this.model.designWidth>0&&(s.width=Math.max(s.width,this.model.designWidth))),super._doAfterMeasure(e,t,i,r,s)}}class SimpleBandGroupHeaderElement extends SimpleBandGroupSectionElement{constructor(e,t){super(e,t,"simpleBandGroupHeader")}_getCssSelector(){return"rr-simpleband-group-header  rr-group-element"}measure(e,t,i){return super.measure(e,t,i)}}class SimpleBandGroupFooterElement extends SimpleBandGroupSectionElement{constructor(e,t){super(e,t,"simpleBandGroupFooter")}_getCssSelector(){return"rr-simpleband-group-footer  rr-group-element"}}class SimpleBandGroupElement extends ReportGroupItemElement{constructor(e,t){super(e,t,"simpleBandGroupView")}_doDispose(){super._doDispose()}get header(){return this._header}get footer(){return this._footer}_getCssSelector(){return"rr-simpleband-group rr-group-element"}_needDesignBox(){return!0}_doMeasure(e,t,i,r){super._doMeasure(e,t,i,r);const s=this.container.focusedItem;this._header=this.getChild(0),this._footer=this.getChild(1),e.printing||this._headerHead||(this._headerHead=new SectionHeadView(this.doc,this.model.header,"GROUP HEADER","SimpleBand Group Header"),this._footerHead=new SectionHeadView(this.doc,this.model.footer,"GROUP FOOTER","SimpleBand Group FOOTER"),this.addChild(this._headerHead),this.addChild(this._footerHead));let n=this._header.measuredHeight+this._footer.measuredHeight;if(!e.printing){let t=this._headerHead,o=t.measure(e,i,r);t.setSelected(s),n+=o.height+2,t=this._footerHead,o=t.measure(e,i,r),t.setSelected(s),n+=o.height+2}return Size.create(Math.max(this._header.measuredWidth,this._footer.measuredWidth),n)}_doLayoutContent(e){if(super._doLayoutContent(e),!e.printing){let e=0,t=this._headerHead;t.applyMeasure(),t.x=0,t.y=e+2,e+=t.height+2,this._header.y=e,e+=this._header.height,t=this._footerHead,t.applyMeasure(),t.x=0,t.y=e+2,e+=t.height+2,this._footer.y=e}}}class SimpleBandPrintInfo extends BandPrintInfo{isEnded(){return 0===this.rows.length}getRows(){return this.rows}getNextPage(e,t,i,r){function s(){n.rpp=p,n.erc=g>0?g:NaN}const n=this,o=this.bandView.model,a=o.bandLevel,A=this.rows,l=this.footerView,h=t.h,{endRowCount:d,stopEndRow:c}=o.getEndRowCount(0),u=!o.prevHead&&(isNaN(o.rowIndex)||0===a&&!(A[0]instanceof BandPrintInfo)||a>0&&o.repeatDetailHeader);let p,_=t.h,g=this.erc;if(isNaN(g)&&(g=d||0),o.maxRowCount>0&&this.setMaxCount(A,o.maxRowCount),u||A.length>0||g>0){const n=o.sectionCount;if(n>1){const s=this.ptsBand,a=this._createPage(e,r);let A;if(i=s[1]-s[0],A=o.sectionLayout==BandSectionLayout.ACROSS_DOWN?this.$_getAcrossPages(e,t,n,i,a):this.$_getDownPages(e,t,n,i,a),A.length>=n)for(let e=0;e<n;e++)this._setX(A[e],s[2*e]);return a.$_h=A.$_h,a}const{rowsPerPage:d,breakRowsPerPage:m}=o.getRowsPerPage();let f,w,C,y=0,E=0;const b=this._createPage(e,r);if(p=this.rpp,(isNaN(p)||!m||p<=0)&&(p=d),u&&(isNaN(o.rowIndex)||0===a&&!(A[0]instanceof BandPrintInfo)||a>0&&o.repeatDetailHeader)&&(C=this.$_addHeader(b),_-=C,y+=C,o.prevHead=!0),_>0&&this.prevGroup&&A.length>0&&(this.isRow(A[0])||!this.isGroupHeader(A[0]))){const e=this.prevGroup.cloneNode(!0);b.appendChild(e),e.style.top=y+"px",C=e.offsetHeight,C<=_?(_-=C,y+=C,o.prevHead=!1):(b.removeChild(e),_=0)}for(isNaN(o.rowIndex)&&(o.rowIndex=0);_>0&&A.length>0;){const s=A.shift();if(p<=0&&!(s instanceof BandPrintInfo)){A.unshift(s),t.h=0;break}let n;if("number"==typeof s)n=this.bandView.printRow(t,s),n&&(C=n.$_h,w=s,isNaN(f)?f=s:s>f&&SimpleBandElement.checkBlanks(o,s,n));else if(s instanceof BandPrintInfo){const o=t.index;t.h=_,n=s.getNextPage(e,t,i,r),t.index=o,t.h=h,C=n.$_h}else{if(this.isGroupFooter(s)&&this.prevRow)n=this.prevRow;else{const e=this.$_addGroup(t,o,s,i);n=e.div,n.$_h=e.height}C=n.$_h}if(!(_>=C)){A.unshift(s),n&&this.isGroupFooter(s)&&(this.prevRow=n);break}if(n&&(b.appendChild(n),n.style.top=y+"px"),_-=C,y+=C,"number"==typeof s)o.rowIndex++,t.index++,p--,E++;else if(s instanceof BandPrintInfo){if(0!==s.getRows().length||!isNaN(s.erc)){s.band.prevIndex=t.index,A.unshift(s),o.repeatMasterRow&&(A.unshift(w),this.rpp=NaN,o.rowIndex--),t.h=0;break}s.band.rowIndex=NaN,s.band.prevIndex=0}o.prevHead=!1}if(0===A.length){for(g-=E;_>0&&g>0;){let e=this.endMessageView;e&&(b.appendChild(e),e.$_h=e.offsetHeight);const t=(this.endMessageView||this.endRowView).$_h;if(!(_>t)){this.endMessageView&&this.endMessageView.remove();break}e=e||this.endRowView.cloneNode(!0),e.style.top=y+"px",e.$_brt="d",!this.endMessageView&&b.append(e),_-=t,y+=t,g--,this.endMessageView=null}c&&(g=0),0==g?l&&(C=l.height,_>=C&&(this.$_addFooter(t,b,this.wBand,y),_-=C)):t.h=0}else if(a>0&&o.repeatDetailFooter){if(l){const e=_,i=[];for(C=l.height;_<C;){const e=b.lastElementChild;if(!e||!e.classList.contains(SimpleBandElement.ROW_CLASS))break;_+=e.offsetHeight,e.remove(),A.unshift(--w),i.push({div:e,row:w}),t.index--,o.rowIndex--}if(_>=C)y-=_-e,this.$_addFooter(t,b,this.wBand,y),this.footerView=l,_-=C;else for(;i.length>0;){const{div:e,row:r}=i.pop();A.push(r),b.appendChild(e),_-=e.offsetHeight,t.index++}}}else t.h=0;return b.$_h=h-_,s(),b}if(l){const i=e.createElement("div");return _-=this.$_addFooter(t,i,this.wBand,0),i.$_h=h-_,s(),i}return null}$_addHeader(e){if(this.headerView){const t=this.headerView.height,i=this.headerView.dom.cloneNode(!0);return e.appendChild(i),t}return 0}$_addFooter(e,t,i,r){const s=this.band,n=this.footerView;s.bandLevel>0&&(s.clearSummary(),e.bandSummaryRuntime=s.summaryRuntime.setRows(this.detailRows,this.masterRow).setRowCount(this.detailRows.length),n.measure(e,i,e.pageHeight),n.resize(n.measuredWidth,n.measuredHeight),n.setPrintStyles(),n.layoutContent(e));const o=n.dom.cloneNode(!0);return o.style.top=r+"px",t.appendChild(o),this.footerView=void 0,n.height}$_addGroup(e,t,i,r){const s=i.view,n=s.dom,o=n.cloneNode(!1);t.summaryRuntime.setRows(null,-1),o.$_brt=i.rowType,e.bandSummaryRuntime=t.summaryRuntime,e.bandSummaryRuntime.setGroup(i.group),t.setPrinting(e,i.row),s.replaceDom(o),s._modelChanged=!0,s.measure(e,r,e.pageHeight),s.resize(s.measuredWidth,s.measuredHeight),s.setPrintStyles(),s.layoutContent(e);const a=s.height;return s.replaceDom(n),"gh"===i.rowType&&(this.prevGroup=o),{div:o,height:a}}$_getAcrossPages(e,t,i,r,s){const n=this.rows,o=[];if(n.length>0){const r=this.bandView.model,a=this.footerView,A=t.h;let l=t.h;const h=[];let d=0,c=0;for(let t=0;t<i;t++)o.push(this._createPage(e,s)),c=Math.max(c,this.$_addHeader(o[t])),h.push(c);for(l-=c,d+=c;l>0&&n.length>0;){let e=[],r=0;for(let s=0;s<i&&n.length>s;s++){const i=n[s],o=this.bandView.printRow(t,i);o&&(e.push(o),r=Math.max(r,o.$_h),h[s]+=r)}if(!(l>=r)){t.h=0;break}for(let t=0;t<e.length;t++)o[t].appendChild(e[t]),e[t].style.top=d+"px";l-=r,d+=r,t.index+=e.length,n.splice(0,e.length)}if(0===n.length){if(a){const e=a.height;if(l>=e){const i=o.length-1,s=r.footer.attachToBody;d=s?h[i]:d,this.$_addFooter(t,o[i],this.wBand,d),s?l=A-(d+e):l-=e}}}else t.h=0;o.$_h=A-l}return o}$_getDownPages(e,t,i,r,s){function n(e){let t=A;return e.forEach((e=>{e.style.top=t+"px",t+=e.$_h})),t-A}const o=this.rows,a=[];let A=0;if(o.length>0){const r=this.bandView.model,l=this.footerView,h=t.h;let d=t.h;const c=[],u=[];let p=0,_=0;for(let t=0;t<i;t++)a.push(this._createPage(e,s)),_=A=Math.max(_,this.$_addHeader(a[t])),c.push(0),u.push([]);d-=_,p+=_;const g=p,m=d;for(let e=0;e<i&&o.length>0;e++){const r=a[e];for(;d>0&&o.length>0;){const i=o.shift(),s=this.bandView.printRow(t,i);if(s){if(_=s.$_h,!(d>=_)){o.unshift(i);break}r.appendChild(s),u[e].push(s),d-=_,c[e]+=_,s.style.top=p+"px",p+=_,t.index++}}e<i-1&&(p=g,d=m)}if(0===o.length){const e=c.reduce(((e,t)=>e+t)),t=Math.round(e/i);for(let e=0;e<i-1;e++){const i=u[e];let r,s=0,o=0;for(;o<i.length;){if(s+=r=i[o].$_h,s>t){o--,s-=r;break}o++}c[e]=s;const A=a[e+1],l=u[e+1];for(;i.length>o;){const e=i.pop();A.insertBefore(e,l[0]),l.unshift(e)}c[e+1]=n(l)}for(let e=0;e<2;e++)(()=>{for(let e=i-1;e>0;e--)for(;c[e]>c[e-1];){const t=a[e-1],i=u[e-1],r=u[e],s=r.shift();i.push(s),t.appendChild(s),c[e-1]=n(i),c[e]=n(r)}})()}if(0===o.length){let e=0;if(l&&(e=l.height,d>=e)){const i=a.length-1,s=r.footer.attachToBody;p=s?c[i]+A:p,this.$_addFooter(t,a[i],this.wBand,p),s&&(c[i]+=e,e=0)}const i=c.reduce(((e,t)=>Math.max(e,t)));a.$_h=A+i+e}else a.$_h=h-d,t.h=0}return a}}class SimpleBandElement extends BandElement{constructor(e,t){super(e,t,"simpleBandView"),this._groupViews=[],this._colSpans=[],this._grouped=!1,this._masterRow=-1,this._printedRows=NaN,this.addChild(this._headerView=new SimpleBandSectionElement(e,t&&t.header,"bandHeaderView",SimpleBandElement.HEADER_CLASS)),this.addChild(this._footerView=new SimpleBandSectionElement(e,t&&t.footer,"bandFooterView",SimpleBandElement.FOOTER_CLASS)),this.addChild(this._rowView=new SimpleBandSectionElement(e,t&&t.dataRow,"bandRowTemplateView",SimpleBandElement.ROW_CLASS)),this.addChild(this._detailView=new BandCollectionElement(e,t&&t.detail)),this._rowContainer=e.createElement("div"),this._dom.appendChild(this._rowContainer)}static isRow(e){return e.classList.contains(SimpleBandElement.ROW_CLASS)&&"r"===e.$_brt}static checkBlanks(e,t,i){const r=e.dataRow.blankItems;r&&r.forEach((r=>{if(e.dataRow.canBlank(r,t)){const e=i.children;for(let t=e.length-1;t>=0;t--){const s=e[t];if(s.dataset._m_===r.shash){i.removeChild(s);break}}}}))}_doDispose(){super._doDispose()}printBand(e,t,i,r,s,n=-1){const o=this.model,a=o.dataObj,A=o.getWidth(i),l=o.getLeft(i);let h=l||0;isNaN(A)||(isNaN(l)&&(h=Math.floor((i-A)/2)),i=A);const d=o.sectionCount,c=d<2;let u=this._rowDivs;const p=c?null:o.getColPoints(i,h),_=t.pageHeight;if(s||o.prepareIndices(t),this._masterRow=n,o.dataRow.masterRow=n>=0?n:NaN,o.summaryRuntime.setRows(s,n),p&&(i=p[1]-p[0]),t.band=o,isNaN(this._rowView.measuredHeight)){let e=this._headerView;if((e.visible=e.model.visible)&&(e.measure(t,i,_),e.resize(e.measuredWidth,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t)),e=this._rowView,!u&&((e.visible=e.model.visible)&&(e.measure(t,i,_),e.resize(e.measuredWidth,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t)),c)){t.bandSummaryRuntime=o.summaryRuntime;const r=o.designData,n=this.$_getGroupViews(t,o.groups.getValidGroups(r),i,_);u=this._rowDivs=this.$_printRows(t,a,n,e,i,s)}e=this._footerView,(e.visible=e.model.visible)&&(t.bandSummaryRuntime=o.summaryRuntime,e.measure(t,i,_),e.resize(e.measuredWidth,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t))}else if(!u){let e=this._headerView;if((e.visible=e.model.visible)&&(e.measure(t,i,_),e.resize(e.measuredWidth,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t)),c){t.bandSummaryRuntime=o.summaryRuntime;const e=o.designData,r=this.$_getGroupViews(t,o.groups.getValidGroups(e),i,_);u=this._rowDivs=this.$_printRows(t,a,r,this._rowView,i,s)}e=this._footerView,(e.visible=e.model.visible)&&(t.bandSummaryRuntime=o.summaryRuntime,e.measure(t,i,_),e.resize(e.measuredWidth,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t))}c?this.$_printLinear(e,t,o,a,i,u,r):o.sectionLayout==BandSectionLayout.ACROSS_DOWN?this.$_printAcross(e,t,p,o,d,a,r):this.$_printDown(e,t,p,o,d,a,r),s&&(this._rowDivs=null)}prepareAsync(e,t,i,r,s){function n(r,s){for(let n=0;n<A.count;n++){const a=A.get(n),h=l.getChild(n);a.masterValues=o.getValues(t,r,a._masterFlds),a.detailRows=a.rowsPerMaster;const d=a.getNextDetailRows(t);if(d.length>0){const n=h.prepareAsync(e,t,i,d,r);a._pr+=d.length,n.masterValues=o.getValues(t,r,a._masterFlds),s.push(n)}}}const o=this.model,a=o.bandLevel,A=o.detail&&o.detail.count>0?o.detail:null,l=this._detailView,h=o.dataObj;let d;const c=o.getWidth(i),u=o.getLeft(i);let p=u||0;if(A)for(let e=0;e<A.count;e++){A.get(e)._pr=0}isNaN(c)||(isNaN(u)&&(p=Math.floor((i-c)/2)),i=c);const _=o.sectionCount<2;let g=this._rowDivs;const m=_?null:o.getColPoints(i,p);if(this._masterRow=s,o.dataRow.masterRow=s>=0?s:NaN,o.summaryRuntime.setRows(r,s),m&&(i=m[1]-m[0]),t.band=o,0===a&&o.prepareIndices(t),isNaN(this._rowView.measuredHeight)){const e=t.pageHeight;t.detailRows=r?r.slice(0):void 0;let s=this._headerView;(s.visible=s.model.visible)&&(s.measure(t,i,e),s.resize(s.measuredWidth,s.measuredHeight),s.x=p,s.setPrintStyles(),s.layoutContent(t)),s=this._rowView,g||((s.visible=s.model.visible)&&(s.measure(t,i,e),s.resize(s.measuredWidth,s.measuredHeight),s.x=p,s.setPrintStyles(),s.layoutContent(t)),_&&(d=this.$_getGroupViews(t,o.groups.getValidGroups(o.designData),i,e))),s=this._footerView,(s.visible=s.model.visible)&&(t.bandSummaryRuntime=o.summaryRuntime,s.measure(t,i,e),s.resize(s.measuredWidth,s.measuredHeight),s.x=p,s.setPrintStyles(),s.layoutContent(t))}const f=new SimpleBandPrintInfo;if(f.band=o,f.bandView=this,f.headerView=this._headerView.visible?this._headerView:null,f.footerView=this._footerView.visible?this._footerView:null,f.rowView=this._rowView,f.groupViews=d,f.rows=function(){const e=r?r.length:h?h.rowCount:0,t=[];if(d){const e=d.map((e=>e.visible&&e.model.field)).filter((e=>!!e));h.groupBy(e,r).forEach((e=>{if(Utils.isNumber(e))t.push(e),A&&n(e,t);else if(e.parent){const i=d[e.level-1];i.header&&i.header.visible&&t.push({view:i.header,row:e.row,rowType:"gh",group:e})}else{const i=d[e.group.level-1];i.footer&&i.footer.visible&&t.push({view:i.footer,row:e.row,rowType:"gf",group:e.group})}}))}else if(r)for(const e of r)t.push(e),A&&n(e,t);else for(let i=0;i<e;i++)t.push(i),A&&n(i,t);return t}()||[],f.xBand=p,f.wBand=i,f.ptsBand=m,f.masterRow=s,f.detailRows=r?r.slice(0):null,!d&&o.getEndRowCount().endRowCount>0){const e=o._pr,i=this.printRow(t,0);i&&(f.endRowView=i,i.classList.add("rr-simpleband-end-row"),Utils.clearChildren(i),o.endRowMessage&&(f.endMessageView=this.$_addEndRowMessage())),o._pr=e}return f}addMasterRow(e,t,i,r,s){const n=t.cloneNode(!0),o=i.cloneNode(!0);e.appendChild(n),n.style.top=s+"px";const a=n.offsetHeight;return s+=a,e.appendChild(o),o.style.top=s+"px",a+o.offsetHeight}printRow(e,t){const i=this._rowView;if(!i.visible)return;const r=this.model,s=r.dataRow.styleCallback,n=i.dom,o=i,a=t,A=o.dom.cloneNode(!1);if(o.replaceDom(A),A.$_brt="r",r.setPrinting(e,a),s){const t=s(e,r.dataRow,a,void 0);t&&Utils.extend(A.style,t)}return e.bandSummaryRuntime=r.summaryRuntime,e.bandSummaryRuntime.setGroup(null),o._modelChanged=!0,o.measure(e,o.measuredWidth,o.measuredHeight),o.resize(o.measuredWidth,o.measuredHeight),o.setPrintStyles(),o.layoutContent(e),o.replaceDom(n),A.$_h=o.height,A}get headerView(){return this._headerView}get footerView(){return this._footerView}get rowTemplateView(){return this._rowView}get groupCount(){return this._groupViews.length}get detailView(){return this._detailView}getGroupView(e){return this._groupViews[e]}indexOfGroup(e){let t=-1;for(let i of this._groupViews)if(i.visible&&(t++,i.model===e))return t;return t}getRowPoints(){const e=[];this.headerView.visible&&e.push(this._headerView.y,this.headerView.height),e.push(this._rowView.y,this._rowView.height),this._footerView.visible&&e.push(this._footerView.y,this._footerView.height);for(let t of this._groupViews)t.visible&&e.push(t.y,t.height);return this.detailView.visible&&e.push(this._detailView.y,this._detailView.height),e}get debugLabel(){return"simple band"}_getCssSelector(){return"rr-band rr-group-element"}_needDesignBox(){return!0}get rowView(){return this._rowView}_isEmpty(){return this.model.sectionCount<2&&super._isEmpty()}$_prepareHeads(e){if(!this._headViews){const t=this.model;this._headViews={},this.addChild(this._headViews[this.shash]=new SectionHeadView(e,t,"SIMPLE BAND","SimpleBand","rr-band-head")),this.addChild(this._headViews[this._headerView.shash]=new SectionHeadView(e,t.header,"HEADER","SimpleBand Header")),this.addChild(this._headViews[this._footerView.shash]=new SectionHeadView(e,t.footer,"FOOTER","SimpleBand Footer")),this.addChild(this._headViews[this._rowView.shash]=new SectionHeadView(e,t.dataRow,"DATA ROW","SimpleBand Row Template"));for(let t of this._groupViews)this.addChild(this._headViews[t.shash]=new SectionHeadView(e,t.model,"GROUP-"+(t.model.index+1),"SimpleBand Group"));this.addChild(this._headViews[this._detailView.shash]=new SectionHeadView(e,t.detail,"DETAILS","SimpleBand Details"))}}_doMeasure(e,t,i,r){const s=e.printing,n=this.model;let o,a=0,A=0;const l=n.getWidth(i);isNaN(l)||(i=l),i=n.getColWidth(i);let h=this._headerView;if(!s&&(h.visible=h.model.visible)&&(o=h.measure(e,i,r),a=Math.max(a,o.width),A+=o.height),h=this._rowView,!s&&(h.visible=h.model.visible)&&(o=h.measure(e,i,r),a=Math.max(a,o.width),A+=o.height),h=this._footerView,!s&&(h.visible=h.model.visible)&&(e.bandSummaryRuntime=n.summaryRuntime,o=h.measure(e,i,r),a=Math.max(a,o.width),A+=o.height),this.$_prepareGroupViews(n,this.doc)>0&&(e.printing||(A+=this.$_measureGroupViews(n,e,i,r))),h=this._detailView,(h.visible=h.model.visible)&&(o=h.measure(e,i,r),a=Math.max(a,o.width),A+=o.height),!s&&(this.$_prepareHeads(this.doc),this._headViews)){const t=this.container,s=null==t?void 0:t.focusedItem;for(let t in this._headViews){const n=this._headViews[t],l=n.model;o=n.measure(e,i,r),a=Math.max(a,o.width),A+=o.height+2,l.isAncestorOf(s)?n.dom.dataset.selected="":delete n.dom.dataset.selected}}return new Size(a,A)}_doLayoutContent(e){const t=this.model,i=!!this._headViews,r=t.sectionCount,s=t.getColWidth(this.width),n=2+8*t.bandLevel;let o,a,A=0;const l=e.printing?null:this._lines=[];i&&(a=this._headViews[this.shash],a.setBounds(n,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o=this._headerView,i&&(a=this._headViews[o.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((s-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),A+=o.height,o.setPrintStyles(),o.layoutContent(e)),null==l||l.push(o),o=this._rowView,i&&(a=this._headViews[o.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((s-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),A+=o.height,o.setPrintStyles(),o.layoutContent(e)),null==l||l.push(o),o=this._footerView,i&&(a=this._headViews[o.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((s-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),o.setPrintStyles(),o.layoutContent(e),A+=o.height),null==l||l.push(o);for(let t of this._groupViews)i&&(a=this._headViews[t.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),t.setBounds((s-t.measuredWidth)/2,A,s,t.measuredHeight),t.setPrintStyles(),t.layoutContent(e),A+=t.height,null==l||l.push(t);o=this._detailView,i&&(a=this._headViews[o.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((s-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),A+=o.height,o.setPrintStyles(),o.layoutContent(e)),null==l||l.push(o),this._designView&&this.$_layoutCols(this.doc,r)}$_getHeadHeight(){return this._headViews[this.shash].height+1}_setDesignContent(e,t){const i=this.$_getHeadHeight();this._designView.style.top=i+"px",this._designView.style.height=this.height-i+"px",e&&super._setDesignContent(e,t),t.style.backgroundColor="white"}getLines(){return this._lines}$_addEndRowMessage(){const e=this.model,t=this._rowView,i=t.cloneNode(),r=t.doc.createElement("span");return i.classList.add("rr-simpleband-end-row"),i.$_brt="d",i.$_h=i.offsetHeight,Utils.clearChildren(i),r.textContent=e.endRowMessage,r.className=BandElement.END_ROW_MESSAGE_CLASS,i.append(r),Object.assign(i.style,{display:"flex",alignItems:"center",justifyContent:"center",width:t.measuredWidth+"px",height:t.measuredHeight+"px"}),i}$_printRows(e,t,i,r,s,n){function o(t,i,n,o=!1,a=0){const l=r.dom,h=l.cloneNode(!1);if(r.replaceDom(h),h.$_brb=a,h.$_brt="r",A.setPrinting(e,t),n){const r=n(e,i,t,void 0);r&&Utils.extend(h.style,r)}return e.bandSummaryRuntime=A.summaryRuntime,e.bandSummaryRuntime.setGroup(null),r._modelChanged=!0,r.measure(e,s,e.pageHeight),r.resize(r.measuredWidth,r.measuredHeight),r.setPrintStyles(),r.layoutContent(e),r.replaceDom(l),isNaN(i.masterRow)||(h.dataset.master=String(i.masterRow)),a&&h.classList.add("rr-simpleband-end-row"),e.index++,h}function a(t,i,r,n){const o=i.dom,a=o.cloneNode(!1);return a.$_brt=n,e.bandSummaryRuntime=A.summaryRuntime,e.bandSummaryRuntime.setGroup(r),A.setPrinting(e,t),i.replaceDom(a),i._modelChanged=!0,i.measure(e,s,e.pageHeight),i.resize(i.measuredWidth,i.measuredHeight),i.setPrintStyles(),i.layoutContent(e),i.replaceDom(o),a}const A=this.model,l=A.dataRow,h=l.styleCallback,d=[];let c=n?n.length:t?t.rowCount:0;const u=c;A.maxRowCount>0&&(c=Math.min(c,A.maxRowCount));const p=A.getEndRowCount();if(!i&&p.endRowCount>0&&(this._endRowView||(this._endRowView=o(0,l,h,!1,1),Utils.clearChildren(this._endRowView)),A.endRowMessage&&(this._endMessageView=function(){const e=r.cloneNode(),t=r.doc.createElement("span");return e.classList.add("rr-simpleband-end-row"),e.$_brt="d",Utils.clearChildren(e),t.textContent=A.endRowMessage,t.className=BandElement.END_ROW_MESSAGE_CLASS,e.append(t),Object.assign(e.style,{display:"flex",alignItems:"center",justifyContent:"center",width:r.measuredWidth+"px",height:r.measuredHeight+"px"}),e}())),0===c&&!this._endRowView)return d;this._printedRows=c!==u?c:NaN;const _=A.pr;if(e.index=0,i&&c>0){const e=i.map((e=>e.visible&&e.model.field)).filter((e=>!!e)),r=t.groupBy(e,n);for(let e=0;e<r.length;e++){const t=r[e];if(Utils.isNumber(t))d.push(o(t,l,h));else if(t.parent){const e=i[t.level-1];e.header&&e.header.visible&&d.push(a(t.row,e.header,t,"gh"))}else{const e=i[t.group.level-1];e.footer&&e.footer.visible&&d.push(a(e.row,e.footer,t.group,"gf"))}}this._grouped=!0}else if(n)for(let e=0;e<c;e++)d.push(o(n[e],l,h,!0));else for(let e=0;e<c;e++)d.push(o(e,l,h));return A.setPrinting(e,_),d}$_prepareGroupViews(e,t){const i=e.groups.count,r=this._groupViews;for(;r.length>i;){const e=r.pop();e.dispose(),this.removeChild(e)}for(;r.length<i;){const e=new SimpleBandGroupElement(t,null);this.addChild(e),r.push(e)}return r.length}$_measureGroupViews(e,t,i,r){const s=e.groups,n=this._groupViews;let o=0;for(let e=0;e<s.count;e++)n[e].model=s.get(e),o+=n[e].measure(t,i,r).height;return o}$_getGroupViews(e,t,i,r){if(t){const s=[];for(let n of t){const t=this._groupViews[n.index];t.model=n,e.noValueCallback=!0;try{t.measure(e,i,r)}finally{e.noValueCallback=!1}s.push(t)}return s.length?s:null}}$_layoutCols(e,t){const i=this._colSpans;for(;i.length<t-1;){const t=e.createElement("span");t.className="rr-band-col",i.push(t),this._designView.appendChild(t)}const r=this.model.sectionGap,s=this.model.getColWidth(this.width),n=this.height-this.$_getHeadHeight();let o=s+r;for(let e=0;e<t-1;e++){const t=i[e];delete t.dataset.hidden,t.textContent=e+2+"",Utils.setBounds(t,o,0,s,n),o+=s+r}for(let e=t-1;e<i.length;e++)i[e].dataset.hidden="1"}$_createPage(e){const t=e.createElement("div");return t.dataset._m_=this.model.shash,t.dataset._page_="1",t.style.position="relative",this._rowContainer.appendChild(t),t}$_cloneRow(e,t,i,r){const s=this._rowView,n=s.dom,o=s.cloneNode();return e.bandSummaryRuntime=t.summaryRuntime,s.replaceDom(o),s.measure(e,r,e.pageHeight),s.resize(s.measuredWidth,s.measuredHeight),s.setPrintStyles(),s.layoutContent(e),s.replaceDom(n),o}$_printLinear(e,t,i,r,s,n,o){function a(r,s){const n=r.$_createPage(e);return t.yBand=D=0,s&&(x=t.y=t.bodyTop,assert(i.pr>=0)),(isNaN(S)||!_||S<=0)&&(S=p),E.length||(T=0),d>0&&i.pageNo>0&&(i.master.repeatMasterRow&&!T&&function(e,t){const i=e.rowView.masterBandView,r=e.rowView.masterHeaderView,s=e.rowView.masterRowView,n=i.addMasterRow(t,r,s,s.x,D);D+=n,x+=n}(r,n),i.repeatDetailHeader&&A(r,n)),o.push(n),s&&i.pageNo++,n}function A(e,t){if(e._headerView.visible){P=e._headerView.dom.cloneNode(!0),t.appendChild(P);const r=P.offsetHeight;r>0&&(e._setY(P,D),D+=r,x+=r,i.prevHead=!0)}}function l(e){const r=e._footerView;!m&&isNaN(e._printedRows)||(i.clearSummary(),t.bandSummaryRuntime=i.summaryRuntime.setRows(m,e._masterRow).setRowCount(e._printedRows),r.measure(t,s,t.pageHeight),r.resize(r.measuredWidth,r.measuredHeight),r.setPrintStyles(),r.layoutContent(t));let n=r.cloneNode();if(e._setY(n,D),B.appendChild(n),D+=L=n.offsetHeight,x+=L,x>O&&E.length&&y){let t=x,i=E.length-1;for(;i>=0&&t>O;)t-=E[i--].offsetHeight;if(t<=O){D-=x-t,e._setY(n,D-L),x=t;for(let e=E.length-1;e>i;e--)B.removeChild(E[e])}}x>O&&(B.removeChild(n),B=a(e,!0),x+=L,e._setY(n,D),B.appendChild(n)),t.yBand=D,t.y=x,t.h=t.bodyHeight-(x-t.bodyTop)}const h=r?r.rowCount:0,d=i.bandLevel,c=i.detail,u=this._grouped,{rowsPerPage:p,breakRowsPerPage:_}=i.getRowsPerPage(),g=i.pr,m=d>0?[]:null,f=this._endRowView;let w=this._endMessageView;const{endRowCount:C,stopEndRow:y}=i.getEndRowCount(w?1:0),E=[];let b,B,P,S,v,R,I,T=0,x=t.y,O=t.bodyBottom,D=t.yBand,L=0,F=!1;for(0==d?B=a(this,!1):(B=o[o.length-1],i.pageNo++,S=p),A(this,B);n.length>0||C>0&&T<C;){const r=i.pr,p=!i.prevHead&&D===t.yBand&&(0===d||0===i.pageNo);if(p&&(x+L>O&&D>0&&(B=a(this,!0)),x!==t.bodyTop||0!==d&&0!==T||A(this,B)),v=R,v||(n.length>0?v=n[0]:w?(v=w,E.push(v)):(v=b=f.cloneNode(!0),v.$_brt="d",E.push(v))),p&&I&&"gh"!==v.$_brt)v=I.cloneNode(!0),this._setY(v,D),B.appendChild(v),v.$_h=v.offsetHeight,D+=L=v.$_h,x+=L,I=v,i.prevHead=!1;else if(this._setY(v,D),B.appendChild(v),v.$_h=L=v.offsetHeight,D+=L,x+=L,R=null,x>O&&(i.prevHead||d>0||r>0))B.removeChild(v),E.pop(),R=v,T>0&&(i.prevHead=!1),E.length&&y?T=C:B=a(this,!0);else{const A=n.shift()||w||b,p="r"===A.$_brt;m&&p&&m.push(r),r>0&&!u&&p&&SimpleBandElement.checkBlanks(i,r,A),!A.$_brb&&p&&i.setPrinting(t,r+1),u&&"gh"===A.$_brt&&(I=A),(p||A===w||A===b)&&(S--,T++,A===w&&(w=null));const _=o.length;if(p&&c.count>0){t.row=0,t.y=x,t.h=t.bodyHeight-(x-t.bodyTop),t.yBand=D;for(let n=0;n<c.count;n++){const a=this._detailView.getChild(n),A=a.model;a.rowView.masterBandView=this,a.rowView.masterHeaderView=this._headerView.dom,a.rowView.masterRowView=v,A.pageNo=0,A.masterValues=i.getValues(t,r,A._masterFlds),A.detailRows=A.rowsPerMaster;const l=t.detailRows=A.getNextDetailRows(t)||[];a.printBand(e,t,s,o,l,r)}B=o[o.length-1],x=t.y,D=t.yBand}F=!1,S<=0&&(n.length>0||C<=0||T===C)&&i.pr<h&&(d>0&&i.repeatDetailFooter&&(l(this),F=!0),(n.length>0||F)&&r<h&&(o.length===_||F)&&(B=a(this,!0)))}}if(0==d||i.pr>g){if(!F&&(l(this),F=!1,d>0&&p<Number.MAX_SAFE_INTEGER&&i.pr<h)){const i=this.$_createPage(e);t.yBand=D=0,t.y=t.bodyTop,x=t.bodyTop,o.push(i)}}else if(P){const e=P.offsetHeight;Utils.remove(P),D-=e,x-=e}F||(t.yBand=D,t.y=x,t.h=t.bodyHeight-(x-t.bodyTop))}$_printAcross(e,t,i,r,s,n,o){function a(e){if(e._headerView.visible){let t=0;for(let r=0;r<s;r++){const s=e._headerView.cloneNode();e._setPos(s,i[2*r],p),w.appendChild(s),t=Math.max(t,s.offsetHeight)}p+=t,c=h+=t}}const A=Math.min(r.endRowCount>=0?r.endRowCount:Number.MAX_SAFE_INTEGER,n?n.rowCount:0),l=this._headerView.offsetHeight;let h=t.y,d=t.bodyBottom,c=h,u=h,p=0,_=Math.min(s,A);const g=new Array(s),m=new Array,f=new Array;let w;w=this.$_createPage(e),o.push(w),l&&a(this);for(let e=0;e<_;e++)g[e]=[];for(;r.pr<A;){0===p&&l&&a(this);let n=-1,C=0;m.length=0;for(let e=0;e<_&&r.pr<A;e++){const o=i[2*e],a=i[2*e+1]-o,A=f.pop()||this.$_cloneRow(t,r,r.pr,a);m.push(A),this._setPos(A,o,p),w.appendChild(A);const l=A.$_h=A.offsetHeight;if(h+l>d){n=e;break}g[e].push(A),r.setPrinting(t,r.pr+1),e===s-1&&(c+=l),C=Math.max(C,l)}if(n>=0){for(let e of m)w.removeChild(e),f.push(e);c=h=t.bodyTop,p=0,n=-1,u=t.bodyTop,w=this.$_createPage(e),o.push(w)}else h+=C,p+=C,f.length=0}let C=0;if(A>0)for(let e=0;e<_;e++)g[e].length&&C++;const y=this._footerView.cloneNode(),E=r.footer.attachToBody,b=E?Math.min(C,s-1):s-1;this._setPos(y,i[2*b],(E?c:h)-u),w.appendChild(y);const B=y.offsetHeight;E?h=Math.max(h,c+B):h+=B,h>d&&(w.removeChild(y),w=this.$_createPage(e),o.push(w),this._setY(y,0),w.appendChild(y),h=t.bodyTop+B),t.y=h,t.h=t.bodyHeight-(h-t.bodyTop)}$_printDown(e,t,i,r,s,n,o){function a(e){for(let e=0;e<s;e++)p[e]=A,_[e]=[];if(f=0,e._headerView.visible){for(let t=0;t<s;t++){const r=e._headerView.cloneNode();e._setPos(r,i[2*t],d),m.appendChild(r),f=Math.max(f,r.offsetHeight)}d+=f,A+=f}}let A=t.y,l=t.bodyBottom,h=A,d=0;const c=Math.min(r.endRowCount>=0?r.endRowCount:Number.MAX_SAFE_INTEGER,n?n.rowCount:0);let u=Math.min(s,c);const p=new Array(s),_=new Array(s);let g,m,f=0;m=this.$_createPage(e),o.push(m),a(this);do{for(let n=0;n<s;n++){const u=i[2*n],w=i[2*n+1]-u;for(0===d&&(0===n?a(this):(d+=f,A+=f));r.pr<c;){const i=g||this.$_cloneRow(t,r,r.pr,w);g=null,this._setPos(i,u,d),m.appendChild(i),i.$_h=i.offsetHeight;const a=i.$_h;if(d+=a,A+=a,p[n]=A,_[n].push(i),A>l){m.removeChild(i),g=i,_[n].pop(),d=0,n==s-1?(m=this.$_createPage(e),o.push(m),h=t.bodyTop):h=o.length>1?t.bodyTop:t.y,A=h;break}r.setPrinting(t,r.pr+1)}}}while(r.pr<c);let w=0;if(c>1){let e=0;for(let t=0;t<_.length;t++)for(let i=0;i<_[t].length;i++)e+=_[t][i].$_h;const t=new Array(u);let r=Math.round(e/u);for(let e=0;e<u-1;e++){let s,n=_[e],o=0,a=0;for(;o<n.length;){if(a+=s=n[o].$_h,a>r){a-=s;break}o++}t[e]=a;const A=_[e+1];let l=0;for(;o<n.length;){const e=n.splice(o,1)[0];A.splice(l++,0,e)}let h=f;for(let t=0;t<A.length;t++)this._setPos(A[t],i[2*(e+1)],h),h+=A[t].$_h}t[s-1]=0;for(let e=0;e<_[s-1].length;e++)t[s-1]+=_[s-1][e].$_h;for(let e=0;e<2;e++)(()=>{for(let e=u-1;e>0;e--)for(;t[e]>t[e-1];){const r=_[e],s=_[e-1],n=r.shift(),o=n.$_h;let a=f;for(let e=0;e<r.length;e++)this._setY(r[e],a),a+=r[e].$_h;t[e]-=o,s.push(n),this._setX(n,i[2*(e-1)]),this._setY(n,t[e-1]+f),t[e-1]+=o}})();for(let e=0;e<u;e++){let t=_[e];if(p[e]=h+f,t.length>0){w=e+1;for(let i=0;i<t.length;i++)p[e]+=t[i].$_h}}}else{for(let e=0;e<s;e++)p[e]=h+f;w=c,w&&(p[0]+=_[0][0].$_h)}const C=this._footerView.cloneNode(),y=r.footer.attachToBody,E=y?Math.min(w,s-1):s-1,b=y?p[E]:0;A=p[0];for(let e=1;e<u;e++)A=Math.max(A,p[e]);this._setPos(C,i[2*E],(y?b:A)-h),m.appendChild(C);const B=C.offsetHeight;y?A=Math.max(A,b+B):A+=B,A>l&&(m.removeChild(C),m=this.$_createPage(e),o.push(m),this._setY(C,d=0),m.appendChild(C),A=t.bodyTop+B),t.y=A,t.h=t.bodyHeight-(A-t.bodyTop)}}SimpleBandElement.HEADER_CLASS="rr-band-header",SimpleBandElement.FOOTER_CLASS="rr-band-footer",SimpleBandElement.ROW_CLASS="rr-band-rowtemplate";class TableBodyLine{constructor(e,t,i){this._rows=[];for(let r=0;r<i;r++)this._rows.push(e[t+r])}get count(){return this._rows.length}get height(){if(isNaN(this._height)){this._height=0;for(let e of this._rows)this._height+=e.offsetHeight}return this._height}get group(){return this._rows[0].$_grp}get isGroup(){return!!this._rows[0].$_grp}get row(){return this._rows[0].$_bri}get isRow(){return"r"===this._rows[0].$_brt}get isGroupHeader(){return"gh"===this._rows[0].$_brt}get isGroupFooter(){return"gf"===this._rows[0].$_brt}get first(){return this._rows[0]}get(e){return this._rows[e]}getCell(e,t){return this._rows[e].cells[t]}appendTo(e){for(let t of this._rows){const i=parseFloat(t.style.height);e.appendChild(t),isNaN(i)?t.style.height=t.offsetHeight+"px":t.style.height=i+"px"}}insertTo(e){const t=this._rows;let i=e.children[0];for(let r=t.length-1;r>=0;r--){const s=t[r],n=parseFloat(s.style.height);isNaN(n)?s.style.height=s.offsetHeight+"px":s.style.height=n+"px",e.insertBefore(s,i),i=s}}detach(){for(let e=this._rows.length-1;e>=0;e--)Utils.detach(this._rows[e])}makeBlank(e,t){const i=this._rows[e].cells[t];Utils.remove(i.firstChild.firstChild)}hide(e,t){this._rows[e].cells[t].style.display="none"}clone(){const e=this._rows.map((e=>e.cloneNode(!0)));return new TableBodyLine(e,0,e.length)}}class TableDummyLine extends TableBodyLine{constructor(e,t,i){super(e,t,i),this._rows.forEach((e=>{e.$_brt="d";const t=e.cells,i=t.length;if(i>0){for(let e=0;e<i;e++)Utils.clearChildren(t[e]);t[0].innerHTML="&#160;"}}))}}class TableBandCellElement extends TableCellElementBase{constructor(e,t,i){super(e,t,i,"tableBandCellView")}}class TableBandSectionElement extends TableElement{constructor(e,t,i,r){super(e,t,i),this.styleName=r}get debugLabel(){return""}_getCssSelector(){return this.styleName+" rr-group-element"}_needDesignBox(){return!0}_createCellElement(e,t){return new TableBandCellElement(e,this,t)}_doMeasure(e,t,i,r){return super._doMeasure(e,t,i,r)}_doAfterMeasure(e,t,i,r,s){this.childCount>0?this._applyBorders(t,s):e.printing||(!this.model.height&&this.model.designHeight>0&&(s.height=Math.max(s.height,this.model.designHeight)),!this.model.width&&this.model.designWidth>0&&(s.width=Math.max(s.width,this.model.designWidth))),super._doAfterMeasure(e,t,i,r,s)}}class TableBandHeaderElement extends TableBandSectionElement{_setTableStyles(e){super._setTableStyles(e),e.style.setProperty("height","100%","important")}_setRowStyles(e,t){super._setRowStyles(e,t),Utils.extend(e.style,this.model.styles)}}class TableBandFooterElement extends TableBandSectionElement{_setTableStyles(e){super._setTableStyles(e),e.style.setProperty("height","100%","important")}_setRowStyles(e,t){super._setRowStyles(e,t),Utils.extend(e.style,this.model.styles)}}class TableBandDataRowElement extends TableBandSectionElement{applyCellStyles(e,t,i,r,s){function n(e,t,i){Object.assign(e,t);for(const e in t)i.push(e)}const o=this.model,a=i.cells;for(let t=0;t<a.length;t++){const i=a[t],A=o.getCell(r,i.cellIndex),l=i.style;let h=A.$_prevStyles;if(h)for(let e of h)l[e]="";else h=A.$_prevStyles=[];this._styles&&n(l,this._styles,h),s&&n(l,s,h);const d=A.styleCallback;let c=A.styles;if(c&&n(l,c,h),d)try{const t=d(e,A,e.row);t&&n(l,t,h)}catch(e){console.error("CellStyleCallback Error",e)}}}_setTableStyles(e){super._setTableStyles(e),e.style.setProperty("height","100%","important")}_setRowStyles(e,t){super._setRowStyles(e,t),this._styles={...this.model.styles}}}class TableBandBodyElement extends TableBandSectionElement{constructor(e,t){super(e,t,"tableBandBodyView","rr-tableband-body"),this._bandRowCount=0}get bandRowCount(){return this._bandRowCount}get endMessageView(){return this._endMessageView}get endRowView(){return this._endRowView}addEndRowMessage(e,t){const i=t.$_trows[0].cloneNode(!0),r=new TableDummyLine([i],0,1),s=i.cells[0];return s.colSpan=i.cells.length,s.textContent=e.endRowMessage,s.className=BandElement.END_ROW_MESSAGE_CLASS,s.style.textAlign="center",i.classList.add(TableBandElement.ROW_CLASS),r}printRows(e,t,i,r,s,n){function o(t,i=!1,n=0){const o=i||t>0,a=r.$_trows,h=a.length,p=[];l.setPrinting(e,t);for(let i=0;i<h;i++){const s=a[i],h=o?r.$_cloneRow(s):s.cloneNode(!0);let d;c&&(d=c(e,A,t,void 0)),h.$_brt="r",h.$_bri=t,h.$_brb=n,r.setCellDoms(s,h),r.applyCellStyles(e,l,h,i,d),p.push(h)}e.bandSummaryRuntime=l.summaryRuntime,e.bandSummaryRuntime.setGroup(null),r.$_refreshRowCells(e,s,u,!0);for(let e=0;e<h;e++){const t=p[e];r.unsetCellDoms(t,a[e]),t.classList.add(TableBandElement.ROW_CLASS),isNaN(A.masterRow)||(t.dataset.master=String(A.masterRow)),0==n&&d.appendChild(t)}return e.index++,p}function a(t,i,r,n){const o=i.$_trows,a=o.length,A=[];for(let e=0;e<a;e++){const t=o[e],r=i.$_cloneRow(t);r.$_brt=n,i.replaceCellDoms(t,r),i.applyGroupStyles(r),A.push(r)}e.bandSummaryRuntime=l.summaryRuntime,e.bandSummaryRuntime.setGroup(r),l.setPrinting(e,t),i.$_refreshRowCells(e,s,u,!0),r.trows=a;for(let e=0;e<a;e++)A[e].$_grp=r,i.replaceCellDoms(A[e],o[e]),d.appendChild(A[e])}if(n)this._bandRowCount=0;else if(this._bandRowCount>0)return;const A=this.model,l=A.band,h=!!n,d=this._tbody,c=A.styleCallback,u=e.pageHeight;let p=h?n.length:t?t.rowCount:0;const _=p;l.maxRowCount>0&&(p=Math.min(p,l.maxRowCount));const g=l.getEndRowCount();if(!i&&g.endRowCount>0){if(!this._endRowView){const e=o(0,!1,1);this._endRowView=new TableDummyLine(e,0,e.length)}l.endRowMessage&&(this._endMessageView=this.addEndRowMessage(l,r))}if(0===p&&!this._endRowView)return;const m=p!==_?p:NaN,f=l.pr;if(e.index=0,i){const e=i.map((e=>e.visible&&e.model.field)).filter((e=>!!e)),r=t.groupBy(e,n);for(let e=0;e<r.length;e++){const t=r[e];if(Utils.isNumber(t))o(t),this._bandRowCount++;else if(t.parent){const e=i[t.level-1];e.header&&e.header.visible&&(a(t.row,e.header,t,"gh"),this._bandRowCount++)}else{const e=i[t.group.level-1];if(e.footer)if(e.footer.visible)a(e.row,e.footer,t.group,"gf"),this._bandRowCount++;else if(!e.header.visible){const e=this.doc.createElement("tr");e.className=TableBandElement.DUMMY_GROUP_FOOTER,d.appendChild(e)}}}}else if(n)for(let e=0;e<p;e++)o(n[e],!0),this._bandRowCount++;else for(let e=0;e<p;e++)o(e),this._bandRowCount++;return l.setPrinting(e,f),m}}class TableBandGroupSectionElement extends TableElement{constructor(e,t,i){super(e,t,i)}applyGroupStyles(e){Utils.extend(e.style,this.model.styles)}_needDesignBox(){return!0}_createCellElement(e,t){return new TableBandCellElement(e,this,t)}_doMeasure(e,t,i,r){const s=super._doMeasure(e,t,i,r);return s.height=Math.max(10,s.height),s}_doAfterMeasure(e,t,i,r,s){this.childCount>0?this._applyBorders(t,s):e.printing||(!this.model.height&&this.model.designHeight>0&&(s.height=Math.max(s.height,this.model.designHeight)),!this.model.width&&this.model.designWidth>0&&(s.width=Math.max(s.width,this.model.designWidth))),super._doAfterMeasure(e,t,i,r,s)}}class TableBandGroupHeaderElement extends TableBandGroupSectionElement{constructor(e,t){super(e,t,"tableBandGroupHeader")}_getCssSelector(){return"rr-tableband-group-header  rr-group-element"}_setTableStyles(e){super._setTableStyles(e),e.style.setProperty("height","100%","important")}}class TableBandGroupFooterElement extends TableBandGroupSectionElement{constructor(e,t){super(e,t,"tableBandGroupFooter")}_getCssSelector(){return"rr-tableband-group-footer  rr-group-element"}_setTableStyles(e){super._setTableStyles(e),e.style.setProperty("height","100%","important")}}class TableBandGroupElement extends ReportGroupItemElement{constructor(e,t){super(e,t,"tableBandGroupView"),this.headIndent=0}_doDispose(){super._doDispose()}get header(){return this._header}get footer(){return this._footer}_getCssSelector(){return"rr-tableband-group rr-group-element"}_needDesignBox(){return!0}_doMeasure(e,t,i,r){super._doMeasure(e,t,i,r);const s=this.container.focusedItem;this._header=this.getChild(0),!e.printing&&(this._header._masterView=this._masterView),this._footer=this.getChild(1),!e.printing&&(this._footer._masterView=this._masterView),e.printing||this._headerHead||(this.addChild(this._headerHead=new SectionHeadView(this.doc,this.model.header,"GROUP HEADER","TableBand RowGroup Header")),this.addChild(this._footerHead=new SectionHeadView(this.doc,this.model.footer,"GROUP FOOTER","TableBand RowGroup Footer")));let n=this._header.measuredHeight+this._footer.measuredHeight;if(!e.printing){let t=this._headerHead,o=t.measure(e,i,r);t.setSelected(s),n+=o.height+2,t=this._footerHead,o=t.measure(e,i,r),t.setSelected(s),n+=o.height+2}return Size.create(Math.max(this._header.measuredWidth,this._footer.measuredWidth),n)}_doLayoutContent(e){if(super._doLayoutContent(e),!e.printing){let e=0,t=this._headerHead;t.applyMeasure(),t.x=this.headIndent,t.y=e+2,e+=t.height+2,this._header.y=e,e+=this._header.height,t=this._footerHead,t.applyMeasure(),t.x=this.headIndent,t.y=e+2,e+=t.height+2,this._footer.y=e}}$_setMasterView(e){this._masterView=e}}class AutoMerger{constructor(e,t){this._lines=[],this._band=e,this._cells=t}static create(e,t){if(t&&t.length>0)return new AutoMerger(e,t)}pushLine(e){e instanceof TableBodyLine?this._lines.push(e):this.merge()}popLine(){this._lines.pop()}merge(){function e(e,t,r){const s=r-t;if(s>1){const n=i[t].getCell(0,e);n.rowSpan=s;const o=n.firstChild,a=o.style.maxHeight.replace("px","");o.style.maxHeight=Number(a)*s+"px";for(let s=t+1;s<r;s++)i[s].getCell(0,e).style.display="none"}}const t=this._cells,i=this._lines.length>1?this._lines:null;if(i){let r=this._band.dataObj,s=this._band.dataRow;t.forEach((t=>{var n;const o=s.getCellItem(t),a=o&&o.item,A=a&&a.value;if(A){const s=t.col,o="datetime"===(null===(n=r.getFieldByName(A))||void 0===n?void 0:n.dataType);let a=0,l=i[0],h=l.row,d=r.getRowValue(h,A),c=1;o&&(d=+d);for(const t=i.length;c<t;c++){l=i[c],h=l.row;let t=r.getRowValue(h,A);o&&(t=+t),t!==d&&(e(s,a,c),a=c),d=t}e(s,a,c)}})),this._lines=[]}}}class TableBandPrintInfo extends BandPrintInfo{isEnded(){return 0===this.rows.length}getRows(){return this.rows}getNextPage(e,t,i,r){function s(t,r){if(d){const s=o.$_createContainer(e,t,r);l=e.createElement("table"),h=e.createElement("tbody"),l.style.position="absolute",TableElement.setTableStyle(l),l.appendChild(a._bodyView.createColGroup(e,i)),l.appendChild(h),s.appendChild(l),A.appendChild(s),d=!1}}function n(){b&&(f.forEach((e=>{const t=[];b.forEach((i=>{for(let r=0;r<i.count;r++)t.push(i.getCell(r,e))})),t[0].rowSpan=t.length;for(let e=1;e<t.length;e++)t[e].style.display="none"})),b=null)}const o=this,a=this.bandView;let A,l,h,d=!0;const c=a.model,u=c.bandLevel,p=this.rows,_=t.h;let g=t.h;const m=c.dataRow.rowCount,f=this.groupViews&&c.dataRow.getMergedColumns(),{endRowCount:w,stopEndRow:C}=c.getEndRowCount(0),y=!c.prevHead&&(isNaN(c.rowIndex)||0===u&&!this.isBand(p[0])||u>0&&c.repeatDetailHeader);let E,b,B=this.erc;if(isNaN(B)&&(B=w||0),c.maxRowCount>0&&this.setMaxCount(p,c.maxRowCount),y||p.length>0||B>0){const a=c.sectionCount;if(a>1){const s=this.ptsBand,n=this._createPage(e,r);let o;i=s[1]-s[0],o=c.sectionLayout==BandSectionLayout.ACROSS_DOWN?this.$_getAcrossPages(e,t,a,i,n):this.$_getDownPages(e,t,a,i,n);for(let e=0;e<a;e++)this._setX(o[e],s[2*e]);return n.$_h=o.$_h,n}const w=!this.groupViews&&AutoMerger.create(c,c.dataRow.getMergedCells()),P=this.rowView,S=this.footerView,{rowsPerPage:v,breakRowsPerPage:R}=c.getRowsPerPage();let I,T=!1;const x=P.measuredWidth;let O,D,L,F=0,H=0;if(A=this._createPage(e,r),A.style.left=Math.floor((i-x)/2)+"px",A.style.width=x+"px",i=x,E=this.rpp,(isNaN(E)||!R||E<=0)&&(E=v),s(F,x),y&&(isNaN(c.rowIndex)||0===u&&!this.isBand(p[0])||u>0&&c.repeatDetailHeader)){if(L=this.$_addHeader(h,g),isNaN(L))return t.h=0,null;g-=L,F+=L,c.prevHead=!0}for(g>0&&this.prevGroup&&p.length>0&&(this.isRow(p[0])||!this.isGroupHeader(p[0]))&&(I=this.prevGroup.clone(),I.appendTo(h),g>=I.height?(g-=I.height,c.prevHead=!1):(I.detach(),g=0)),isNaN(c.rowIndex)&&(c.rowIndex=0);g>0&&p.length>0;){const r=p.shift();if(r===DUMMY_FOOTER){n();continue}if(E<=0&&!this.isBand(r)){p.unshift(r),t.h=0;break}const o=P.$_trows.length;let a;if(I=null,s(F,x),this.isRow(r))isNaN(O)&&(O=r),I=this.bandView.printRow(t,r),I&&(a=I._rows,D=r,r>O&&TableBandElement.checkBlanks(c,r,I),f&&(b||(b=[]),b.push(I)),w&&w.pushLine(I));else if(this.isBand(r)){const s=e.createElement("div");Utils.extend(s.style,{position:"absolute",top:F+"px",width:x+"px"}),A.appendChild(s);const n=t.index;if(t.h=g,r.getNextPage(e,t,i,s),t.index=n,t.h=_,L=0,r instanceof TableBandPrintInfo){const e=s.getElementsByClassName("rr-table")[0];e&&(L=e.offsetHeight)}else{const e=s.firstElementChild.children;for(let t=0;t<e.length;t++)L+=e[t].offsetHeight}d=!0,l=null}else{const e=r,s=e.group,o=e.view,A=o.$_trows,l=A.length;if(o.parent||this.groupViews[0].addChild(o),this.isGroupFooter(e)&&this.prevLine)a=this.prevLine,this.prevLine=null;else{a=[],n();for(let t=0;t<l;t++){const i=A[t],r=o.$_cloneRow(i);r.$_brt=e.rowType,o.replaceCellDoms(i,r),o.applyGroupStyles(r),a.push(r)}c.summaryRuntime.setRows(null,-1),t.bandSummaryRuntime=c.summaryRuntime,t.bandSummaryRuntime.setGroup(s),c.setPrinting(t,e.row),o.$_refreshRowCells(t,i,L,!0),s.trows=l;for(let e=0;e<l;e++)a[e].$_grp=s,o.replaceCellDoms(a[e],A[e])}I=new TableBodyLine(a,0,l),"gh"===e.rowType&&(this.prevGroup=I)}if(r instanceof BandPrintInfo||(I?(I.appendTo(h),L=I.height):L=0),g>=L){if(T=!0,g-=L,F+=L,"number"==typeof r)c.rowIndex++,t.index++,E--,H++;else if(r instanceof BandPrintInfo){if(0!==r.getRows().length||!isNaN(r.erc)){r.band.prevIndex=t.index,p.unshift(r),c.repeatMasterRow&&(p.unshift(D),this.rpp=NaN,c.rowIndex--),t.h=0;break}r.band.prevIndex=0,r.band.rowIndex=NaN}c.prevHead=!1}else if(a){for(let e=0;e<o;e++)h.removeChild(a[e]);p.unshift(r),this.isGroupFooter(r)&&(this.prevLine=a);break}}if(!l||T||0!==B||y&&(c.alwaysHeader&&S&&S.height>0)){if(H>0&&(n(),w&&w.merge()),0===p.length){for(B-=H;g>0&&B>0;){let e,t=this.endMessageView;if(t){if(t.appendTo(h),e=t.height,!(g>e)){t.detach();break}g-=e,B--,this.endMessageView=null}else{if(t=this.endRowView.clone(),t.appendTo(h),e=t.height,!(g>e)){t.detach();break}g-=e,B--}}C&&(B=0),0===B&&S&&g>=S.height&&(s(F,x),g-=this.$_addFooter(t,h,x))}else if(u>0&&c.repeatDetailFooter&&S){const e=h.rows,i=[];for(L=S.height;g<L&&e.length>0&&e[e.length-1].classList.contains(TableBandElement.ROW_CLASS);){const r=[];for(let t=0;t<m;t++){const t=e[e.length-1];g+=t.offsetHeight,t.remove(),r.push(t)}p.unshift(--D),i.push({trs:r,row:D}),t.index--,c.rowIndex--}if(g>=L)g-=this.$_addFooter(t,h,x),this.footerView=S;else for(;i.length>0;){const{trs:e,row:r}=i.pop();p.push(r),e.forEach((e=>{h.appendChild(e),g-=e.offsetHeight})),t.index++}}}else A.firstElementChild.removeChild(l),g=_;return(p.length>0||B>0)&&(t.h=0),A.$_h=_-g,o.rpp=E,o.erc=B>0?B:NaN,A}return null}$_createContainer(e,t,i){const r=e.createElement("div");return Utils.extend(r.style,{position:"absolute",top:t+"px",width:i+"px"}),r}$_createTable(e,t,i,r){const s=this.$_createContainer(e,i,r),n=e.createElement("table"),o=e.createElement("tbody");return n.style.position="absolute",TableElement.setTableStyle(n),n.appendChild(this.bandView._bodyView.createColGroup(e,r)),n.appendChild(o),s.appendChild(n),t.appendChild(s),n}$_addFooter(e,t,i){const r=this.band,s=this.footerView;r.bandLevel>0&&(s.visible=s.model.visible)&&(s.resetStyleName(),this.band.clearSummary(),e.bandSummaryRuntime=this.band.summaryRuntime.setGroup(null).setRows(this.detailRows,this.masterRow).setRowCount(this.detailRows.length),s.measure(e,i,e.pageHeight),s.resize(s.measuredWidth,s.measuredHeight),s.setPrintStyles(),s.layoutContent(e));const n=new TableLine(s.dom.firstChild);return n.appendTo(t,TableBandElement.HEADER_CLASS),n.height}$_addHeader(e,t){if(this.headerView){const i=new TableLine(this.headerView.dom.firstChild);i.appendTo(e,TableBandElement.HEADER_CLASS);const r=i.height;return t>=r?r:(i.remove(),NaN)}return 0}$_getAcrossPages(e,t,i,r,s){const n=this.rows,o=[],a=[];if(n.length>0){const A=t.h;let l=t.h,h=0,d=0;for(let n=0;n<i;n++){const i=this._createPage(e,s),n=this.$_createTable(e,i,h,r).tBodies[0];o.push(i),a.push(n);const A=this.$_addHeader(n,l);if(isNaN(A))return t.h=0,null;d=Math.max(d,A)}for(l-=d,h+=d;l>0&&n.length>0;){const e=[],r=[];let s,o=0;for(let A=0;A<i&&n.length>0;A++){const i=n.shift();if(r.push(i),s=this.bandView.printRow(t,i),s){s.appendTo(a[A]),e.push(s);const t=s.height;o=Math.max(o,t)}}if(!(l>=o)){for(let t=0;t<i&&n.length>0;t++)n.unshift(r.pop()),e.pop().detach();break}l-=o,h+=o}0===n.length?this.footerView&&l>=this.footerView.height&&(l-=this.$_addFooter(t,a[i-1],0)):t.h=0,o.$_h=A-l}return o}$_getDownPages(e,t,i,r,s){const n=this.rows,o=[],a=[];if(n.length>0){const A=t.h;let l=t.h;const h=[],d=[];let c=0,u=0;for(let n=0;n<i;n++){const i=this._createPage(e,s),n=this.$_createTable(e,i,c,r).tBodies[0];o.push(i),a.push(n);const A=this.$_addHeader(n,l);if(isNaN(A))return t.h=0,null;u=Math.max(u,A)}l-=u,c+=u;const p=c,_=l;for(let e=0;e<i;e++){const i=[];let r,s=0;for(;l>0&&n.length>0;){const o=n.shift();if(r=this.bandView.printRow(t,o),r){if(r.appendTo(a[e]),i.push(r),s=r.height,!(l>=s)){r.detach(),n.unshift(o);break}l-=s,c+=s}}h.push(_-l),d.push(i),c=p,l=_}if(0==n.length){const e=h.reduce(((e,t)=>e+t)),t=Math.round(e/i);for(let e=0;e<i-1;e++){const i=d[e];let r,s=0,n=0;for(;s<i.length;){if(n+=r=i[s].height,n>t){n-=r;break}s++}h[e]=n;const o=d[e+1];for(;s<i.length;){const t=i.splice(s,1)[0];t.insertTo(a[e+1]),o.unshift(t),h[e+1]+=t.height}}}l=_-h[i-1],0===n.length?this.footerView&&l>=this.footerView.height&&(l-=this.$_addFooter(t,a[i-1],0)):t.h=0,o.$_h=A-l}return o}}const DUMMY_FOOTER=-999;class TableBandElement extends BandElement{constructor(e,t){super(e,t,"TableBandView"),this._groupViews=[],this._rowGap=2,this._colSpans=[],this._colWidth=0,this._grouped=!1,this._masterRow=-1,this._printedRowCount=NaN,this._headers=0,this.addChild(this._headerView=new TableBandHeaderElement(e,t&&t.header,"bandHeaderView","rr-tableband-header")),this.addChild(this._rowView=new TableBandDataRowElement(e,t&&t.dataRow,"bandRowTemplateView","rr-tableband-row-template")),this.addChild(this._bodyView=new TableBandBodyElement(e,t&&t.dataRow)),this._bodyView.visible=!1,this.addChild(this._footerView=new TableBandFooterElement(e,t&&t.footer,"bandFooterView","rr-tableband-footer")),this.addChild(this._detailView=new BandCollectionElement(e,t&&t.detail)),this._lines=[this._headerView,this._rowView,this._footerView,this._detailView],this._rowContainer=e.createElement("div"),this._dom.appendChild(this._rowContainer)}static checkBlanks(e,t,i){const r=e.dataRow.blankItems;r&&r.forEach((r=>{e.dataRow.canBlank(r,t)&&i.makeBlank(r.row,r.col)}))}_doDispose(){super._doDispose()}get columns(){return this.model.columns}get colCount(){return this.model.colCount}getColumn(e){return this.model.getColumn(e)}printBand(e,t,i,r,s,n=-1){const o=this.model,a=o.dataObj,A=o.getWidth(i),l=o.getLeft(i);let h=l||0;isNaN(A)||(isNaN(l)&&(h=Math.floor((i-A)/2)),i=A);const d=o.sectionCount,c=d<2,u=c?null:o.getColPoints(i,h);if(s||o.prepareIndices(t),this._masterRow=n,o.dataRow.masterRow=n>=0?n:NaN,o.summaryRuntime.setRows(s,n),this._colWidth=o.getColWidth(i),u&&(i=this._colWidth),t.band=o,isNaN(this._rowView.measuredHeight)){let e=this._headerView;if((e.visible=e.model.visible)&&(e.resetStyleName(),e.measure(t,i,t.pageHeight),e.resize(i,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t)),e=this._rowView,e.visible=e.model.visible,!this._printingRows){e.resetStyleName(),e.measure(t,i,t.pageHeight),e.resize(i,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t),this._bodyView.visible=!0,t.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(null,this._masterRow);const r=o.designData,n=this.$_getGroupViews(t,o.groups.getValidGroups(r),i,t.pageHeight);this._printedRowCount=this._bodyView.printRows(t,a,n,this._rowView,i,s),this._printingRows=this._bodyView.$_trowsCopy,this._grouped=!!n}e=this._footerView,(e.visible=e.model.visible)&&(e.resetStyleName(),t.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(null,this._masterRow),e.measure(t,i,t.pageHeight),e.resize(e.measuredWidth,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t))}else if(!this._printingRows){let e=this._headerView;(e.visible=e.model.visible)&&(e.resetStyleName(),e.measure(t,i,t.pageHeight),e.resize(i,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t)),t.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(null,this._masterRow);const r=o.designData,n=this.$_getGroupViews(t,o.groups.getValidGroups(r),i,t.pageHeight);this._printedRowCount=this._bodyView.printRows(t,a,n,this._rowView,i,s),this._printingRows=this._bodyView.$_trowsCopy,e=this._footerView,(e.visible=e.model.visible)&&(e.resetStyleName(),t.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(null,this._masterRow),e.measure(t,i,t.pageHeight),e.resize(e.measuredWidth,e.measuredHeight),e.x=h,e.setPrintStyles(),e.layoutContent(t))}const p=this._printingRows,_=this._bodyView.bandRowCount;return this._tempRow||(this._tempRow=p[0]),c?this.$_printLinear(e,t,o,a,h,i,p,r):o.sectionLayout==BandSectionLayout.ACROSS_DOWN?this.$_printAcross(e,t,o,u,d,i,p,_,r):this.$_printDown(e,t,o,u,d,i,p,_,r),s&&(this._printingRows=null),_}prepareAsync(e,t,i,r,s){function n(r,s){for(let n=0;n<A.count;n++){const a=A.get(n),h=l.getChild(n);a.masterValues=o.getValues(t,r,a._masterFlds),a.detailRows=a.rowsPerMaster;const d=a.getNextDetailRows(t)||[];if(d.length>0){const n=h.prepareAsync(e,t,i,d,r);a._pr+=d.length,n.masterValues=o.getValues(t,r,a._masterFlds),s.push(n)}}}const o=this.model,a=o.bandLevel,A=o.detail&&o.detail.count>0?o.detail:null,l=this._detailView,h=o.dataObj,d=o.designData,c=this.$_getGroupViews(t,o.groups.getValidGroups(d),i,t.pageHeight),u=o.getWidth(i),p=o.getLeft(i);let _,g=p||0;if(A)for(let e=0;e<A.count;e++){A.get(e)._pr=0}isNaN(u)||(isNaN(p)&&(g=Math.floor((i-u)/2)),i=u);const m=o.sectionCount<2?null:o.getColPoints(i,g);this._colWidth=o.getColWidth(i),m&&(i=this._colWidth),t.band=o,0===a&&o.prepareIndices(t),isNaN(this._rowView.measuredHeight)&&(t.detailRows=r?r.slice(0):void 0,_=this._headerView,(_.visible=_.model.visible)&&(_.resetStyleName(),_.measure(t,i,t.pageHeight),_.resize(i,_.measuredHeight),_.x=g,_.setPrintStyles(),_.layoutContent(t)),_=this._rowView,_.visible=_.model.visible,this._printingRows||(_.resetStyleName(),_.measure(t,i,t.pageHeight),_.resize(i,_.measuredHeight),_.x=g,_.setPrintStyles(),_.layoutContent(t)),_=this._footerView,(_.visible=_.model.visible)&&(_.resetStyleName(),t.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(r,this._masterRow),_.measure(t,i,t.pageHeight),_.resize(_.measuredWidth,_.measuredHeight),_.x=g,_.setPrintStyles(),_.layoutContent(t)));const f=new TableBandPrintInfo;if(f.band=o,f.bandView=this,f.headerView=this._headerView.visible?this._headerView:null,f.footerView=this._footerView.visible?this._footerView:null,f.rowView=this._rowView,f.groupViews=c,f.rows=function(){const e=h?h.rowCount:0,t=[];if(c){const e=c.map((e=>e.visible&&e.model.field)).filter((e=>!!e));h.groupBy(e,r).forEach((e=>{if(Utils.isNumber(e))t.push(e),A&&n(e,t);else if(e.parent){const i=c[e.level-1];i.header&&i.header.visible&&t.push({view:i.header,row:e.row,rowType:"gh",group:e})}else{const i=c[e.group.level-1];i.footer&&(i.footer.visible?t.push({view:i.footer,row:e.row,rowType:"gf",group:e.group}):i.header.visible||t.push(DUMMY_FOOTER))}}))}else if(r)for(const e of r)t.push(e),A&&n(e,t);else for(let i=0;i<e;i++)t.push(i),A&&n(i,t);return t}()||[],f.xBand=g,f.wBand=i,f.ptsBand=m,f.masterRow=s,f.detailRows=r?r.slice(0):null,!c&&o.getEndRowCount().endRowCount>0){const e=o._pr,i=this.printRow(t,0);if(i){const e=i._rows;f.endRowView=new TableDummyLine(e,0,e.length),o.endRowMessage&&(f.endMessageView=this._bodyView.addEndRowMessage(o,this._rowView))}o._pr=e}return f}addMasterRow(e,t,i,r,s){const n=this.$_addTable(this.doc,e,r,s),o=new TableLine(t);o.appendTo(n.tBodies[0],TableBandElement.HEADER_CLASS);const a=o.height,A=i.clone();return A.appendTo(n.tBodies[0]),a+A.height}printRow(e,t){const i=this._rowView;if(!i.visible)return;const r=this.model,s=r.dataRow.styleCallback,n=r.dataRow.rowCount,o=i.measuredWidth,a=i.$_trows,A=a.length,l=[];r.setPrinting(e,t);for(let n=0;n<A;n++){const o=a[n],A=i.$_cloneRow(o);let h;s&&(h=s(e,r.dataRow,t,void 0)),A.$_brt="r",A.$_bri=e.row,i.setCellDoms(o,A),i.applyCellStyles(e,r,A,n,h),l.push(A)}e.bandSummaryRuntime=r.summaryRuntime,e.bandSummaryRuntime.setGroup(null),i.$_refreshRowCells(e,o,1e5,!0);for(let e=0;e<A;e++){const t=l[e];i.unsetCellDoms(t,a[e]),t.classList.add(TableBandElement.ROW_CLASS)}let h;return l.length>0&&(h=new TableBodyLine(l,0,n)),h}get headerView(){return this._headerView}get footerView(){return this._footerView}get dataRowView(){return this._rowView}get groupCount(){return this._groupViews.length}getGroupView(e){return this._groupViews[e]}indexOfGroup(e){let t=-1;for(let i of this._groupViews)if(i.visible&&(t++,i.model===e))return t;return t}getRowPoints(){const e=[];e.push(this._headerView.y,this.headerView.height),e.push(this._rowView.y,this._rowView.height),e.push(this._footerView.y,this._footerView.height);for(let t of this._groupViews)t.visible&&e.push(t.y,t.height);return e}getColPoints(){return this._rowView.getColPoints()}getColRect(e,t=1){const i=this._rowView.getColRect(e,t);return i.height=this.height,i}getTableView(e){for(let t of[this._headerView,this._footerView,this._rowView])if(t.model===e)return t;for(let t of this._groupViews){if(t.header.model===e)return t.header;if(t.footer.model===e)return t.footer}}getTableViews(){const e=[this._headerView,this._footerView,this._rowView];for(let t of this._groupViews)e.push(t.header,t.footer);return e}get debugLabel(){return"table band"}_getCssSelector(){return"rr-table-band rr-group-element"}_needDesignBox(){return!0}get rowView(){return this._rowView}$_prepareHeads(e){if(!this._headViews){const t=this.model;this._headViews={},this.addChild(this._headViews[this.hash]=new SectionHeadView(e,t,"TABLE BAND","TableBand","rr-band-head")),this.addChild(this._headViews[this._headerView.hash]=new SectionHeadView(e,t.header,"HEADER","SimpleBand Header")),this.addChild(this._headViews[this._footerView.hash]=new SectionHeadView(e,t.footer,"FOOTER","TableBand Footer")),this.addChild(this._headViews[this._rowView.hash]=new SectionHeadView(e,t.dataRow,"DATA ROW","TableBand Data Row"));for(let t of this._groupViews)this.addChild(this._headViews[t.hash]=new SectionHeadView(e,t.model,"GROUP-"+(t.model.index+1),"TableBand RowGroup"));this.addChild(this._headViews[this._detailView.hash]=new SectionHeadView(e,t.detail,"DETAILS","TableBand Details"))}}_doMeasure(e,t,i,r){var s;const n=e.printing,o=this.model;let a,A=0,l=0;n||(this._headerView._masterView=this._bodyView._masterView=this._footerView._masterView=this._rowView);const h=o.getWidth(i);isNaN(h)||(i=h),i=o.getColWidth(i);let d=this._rowView;if(n||(a=d.measure(e,i,r),d.visible=d.model.visible,d.visible&&(A=Math.max(A,a.width),l+=a.height+this._rowGap)),d=this._headerView,!n&&(d.visible=d.model.visible)&&(a=d.measure(e,i,r),A=Math.max(A,a.width),l+=a.height+this._rowGap),d=this._footerView,!n&&(d.visible=d.model.visible)&&(e.bandSummaryRuntime=o.summaryRuntime,a=d.measure(e,i,r),A=Math.max(A,a.width),l+=a.height),this.$_prepareGroupViews(o,this.doc),n||(l+=this.$_measureGroupViews(o,e,i,r)),d=this._detailView,(d.visible=d.model.visible)&&(a=d.measure(e,i,r),A=Math.max(A,a.width),l+=a.height),!n&&(this.$_prepareHeads(this.doc),this._headViews)){const t=null===(s=this.container)||void 0===s?void 0:s.focusedItem;for(let s in this._headViews){const n=this._headViews[s];a=n.measure(e,i,r),A=Math.max(A,a.width),l+=a.height+2,n.setSelected(t)}}return new Size(A,l)}_doLayoutContent(e){const t=this.model,i=!!this._headViews,r=t.sectionCount,s=t.getColWidth(this.width),n=2+8*t.bandLevel;let o,a,A=0,l=e.printing?null:this._lines=[];i&&(a=this._headViews[this.hash],a.setBounds(n,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o=this._headerView,i&&(a=this._headViews[o.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((s-o.measuredWidth)/2,A,s,o.measuredHeight),o.setPrintStyles(),A+=o.height+this._rowGap,o.layoutContent(e)),null==l||l.push(o),o=this._rowView,i&&(a=this._headViews[o.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((s-o.measuredWidth)/2,A,s,o.measuredHeight),o.setPrintStyles(),A+=o.height+this._rowGap,o.layoutContent(e)),null==l||l.push(o),o=this._footerView,i&&(a=this._headViews[o.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((s-o.measuredWidth)/2,A,s,o.measuredHeight),o.setPrintStyles(),o.layoutContent(e),A+=o.height),null==l||l.push(o);for(let t of this._groupViews)i&&(a=this._headViews[t.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),t.setBounds((s-t.measuredWidth)/2,A,s,t.measuredHeight),t.setPrintStyles(),t.headIndent=n+16,t.layoutContent(e),A+=t.height,null==l||l.push(t);o=this._detailView,i&&(a=this._headViews[o.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((s-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),A+=o.height,o.setPrintStyles(),o.layoutContent(e)),null==l||l.push(o),this._designView&&this.$_layoutCols(this.doc,r)}$_getHeadHeight(){return this._headViews[this.hash].height+1}_setDesignContent(e,t){const i=this.$_getHeadHeight();t.style.top=i+"px",t.style.height=this.height-i+"px",e&&super._setDesignContent(e,t),t.style.backgroundColor="white"}getLines(){return this._lines}_isPrintDataRow(){return this.model.pr<this._bodyView.bandRowCount}_isPrintEndRow(){return this.model.endRowCount>0}$_prepareGroupViews(e,t){const i=e.groups.count,r=this._groupViews;for(;r.length>i;){const e=r.pop();e.dispose(),this.removeChild(e)}for(;r.length<i;){const e=new TableBandGroupElement(t,null);this.addChild(e),r.push(e),e.$_setMasterView(this._rowView)}}$_measureGroupViews(e,t,i,r){const s=e.groups,n=this._groupViews;let o=0;for(let e=0;e<s.count;e++)n[e].model=s.get(e),o+=n[e].measure(t,i,r).height;return o}$_getGroupViews(e,t,i,r){if(t){const s=[];for(let n of t){const t=this._groupViews[n.index];t.model=n,e.noValueCallback=!0;try{t.measure(e,i,r)}finally{e.noValueCallback=!1}s.push(t)}return s.length?s:[]}}$_layoutCols(e,t){const i=this._colSpans;for(;i.length<t-1;){const t=e.createElement("span");t.className="rr-band-col",i.push(t),this._designView.appendChild(t)}const r=this.model.sectionGap,s=this.model.getColWidth(this.width),n=this.height-this.$_getHeadHeight();let o=s+r;for(let e=0;e<t-1;e++){const t=i[e];delete t.dataset.hidden,t.textContent=e+2+"",Utils.setBounds(t,o,0,s,n),o+=s+r}for(let e=t-1;e<i.length;e++)i[e].dataset.hidden="1"}$_createPage(e){const t=e.createElement("div");return t.style.position="relative",this._rowContainer.appendChild(t),t}$_createTableContainer(e,t,i){const r=e.createElement("div");return Utils.extend(r.style,{position:"absolute",left:t+"px",top:i+"px",width:this._colWidth+"px"}),r}$_createTable(e){const t=e.createElement("table"),i=e.createElement("tbody");return t.appendChild(this._bodyView.createColGroup(e,this._colWidth)),t.appendChild(i),t.style.position="absolute",TableElement.setTableStyle(t),t}$_cloneEmptyRow(e){const t=e.cloneNode(!0),i=t.cells;t.style.height="0px";for(let e=0;e<i.length;e++){const t=i[e],r=t.style;t.colSpan=1,t.rowSpan=1,t.innerHTML="",r.height="0",r.border="none",r.borderRight="1px solid black",r.margin="0",r.padding="0"}return t}$_addTable(e,t,i,r){const s=this.$_createTableContainer(e,i,r),n=this.$_createTable(e);return s.dataset._m_=this.model.shash,s.appendChild(n),t.appendChild(s),n}$_printLinear(e,t,i,r,s,n,o,a){function A(){U&&(m.forEach((e=>{const t=[];U.forEach((i=>{for(let r=0;r<i.count;r++)t.push(i.getCell(r,e))})),t[0].rowSpan=t.length;for(let e=1;e<t.length;e++)t[e].style.display="none"})),U=null)}function l(t,i){O=t.$_addTable(e,i,s,V),D=O.tBodies[0],G=!1}function h(r,s,n=!1){f&&f.merge(),A();const o=r.$_createPage(e);return t.yBand=V=0,s&&(k=t.y=t.bodyTop),(isNaN(L)||!C||L<=0)&&(L=w),R.length||(M=0),p>0&&i.pageNo>0&&i.master.repeatMasterRow&&!M&&function(e,t){const i=e.rowView.masterBandView,r=e.rowView.masterHeaderView,s=e.rowView.masterRowView,n=i.addMasterRow(t,r,s,s.x,V);V+=n,k+=n}(r,o),l(r,o),p>0&&i.pageNo>0&&!n&&i.repeatDetailHeader&&d(r),a.push(o),s&&i.pageNo++,o}function d(e){if(p>0&&e._headers++,e._headerView.visible){x=new TableLine(e._headerView._dom.firstChild);const t=x.height;t>0&&(x.appendTo(D,TableBandElement.HEADER_CLASS),V+=t,k+=t,i.prevHead=!0)}}function c(r){if(f&&f.merge(),b||!isNaN(r._printedRowCount)){const e=r._footerView;e.resetStyleName(),i.clearSummary(),t.bandSummaryRuntime=i.summaryRuntime.setRows(b,r._masterRow).setRowCount(r._printedRowCount),e.measure(t,n,t.pageHeight),e.resize(e.measuredWidth,e.measuredHeight),e.setPrintStyles(),e.layoutContent(t)}const s=new TableLine(r._footerView._dom.firstChild),o=s.height;o&&(k+o>Q?(T=h(r,!0,!i.alwaysHeader),D.appendChild(r.$_cloneEmptyRow(r._tempRow))):G&&(O=r.$_addTable(e,T,0,V),D=O.tBodies[0],G=!1),s.appendTo(D,TableBandElement.FOOTER_CLASS),V+=o,k+=o,k>Q&&R.length,k>Q&&(s.remove(),0===D.rows.length&&T.removeChild(O),T=h(r,!0),D.appendChild(r.$_cloneEmptyRow(r._tempRow)),s.appendTo(D,TableBandElement.FOOTER_CLASS),V+=o,k+=o)),t.yBand=V,t.y=k,t.h=t.bodyHeight-(k-t.bodyTop)}const u=r?r.rowCount:0,p=i.bandLevel,_=i.detail,g=this._grouped,m=g&&i.dataRow.getMergedColumns(),f=!g&&AutoMerger.create(i,i.dataRow.getMergedCells()),{rowsPerPage:w,breakRowsPerPage:C}=i.getRowsPerPage(),y=i.dataRow.rowCount,E=i.pr,b=p>0?[]:null,B=this._bodyView.endRowView;let P=this._bodyView.endMessageView;const{endRowCount:S,stopEndRow:v}=i.getEndRowCount(P?1:0),R=[];let I,T,x,O,D,L,F,H,N,U,M=0,k=t.y,Q=t.bodyBottom,V=t.yBand,G=!1,$=0,W=!1;for(0===p?T=h(this,!1):(T=a[a.length-1],i.pageNo++,L=w,l(this,T)),d(this);o.length>0||S>0&&M<S;){const r=o[0]&&o[0].$_grp,s=i.pr,w=!i.prevHead&&V===t.yBand&&(0===p||0===i.pageNo);if(w?(k+$>Q&&V>0?T=h(this,!0):G&&l(this,T),k!==t.bodyTop||0!==p&&0!==M||d(this)):G&&l(this,T),o.length>0&&o[0].className===TableBandElement.DUMMY_GROUP_FOOTER)o.splice(0,1),A();else if(F=H,F||(o.length>0?F=new TableBodyLine(o,0,r?r.trows:y):P?F=P:(F=I=B.clone(),R.push(F))),w&&N&&"gh"!==F.first.$_brt)F=N.clone(),F.appendTo(D),V+=$=F.height,k+=$,L--,i.prevHead=!1;else if(this.rowView.visible&&(F.appendTo(D),$=F.height,V+=$,k+=$,H=null),k>Q&&(i.prevHead||p>0||s>0))F.detach(),R.pop(),H=F,M>0&&(i.prevHead=!1),R.length&&v?M=S:T=h(this,!0);else{const r=!1;let l;F.isGroup&&!r&&A(),l=o.length?o.splice(0,F.count)[0]:P?P.first:I.first;const d="r"===l.$_brt;if(b&&d&&b.push(s),s>0&&!F.isGroup&&d&&TableBandElement.checkBlanks(i,s,F),!l.$_brb&&d){const e=F.isGroup?s:s+1;i.setPrinting(t,e,F.count)}g&&"gh"===l.$_brt&&(N=F),m&&(F.isGroup&&!r||(U||(U=[]),U.push(F))),(d||P&&l===P.first||I&&l===I.first)&&(L--,M++,P&&l===P.first&&(P=null)),f&&f.pushLine(F);const w=a.length;if(d&&_.count>0){t.row=0,t.y=k,t.h=t.bodyHeight-(k-t.bodyTop),t.yBand=V;for(let r=0;r<_.count;r++){const o=this._detailView.getChild(r),A=o.model;o.rowView.masterBandView=this,o.rowView.masterHeaderView=this._headerView.dom.firstChild,o.rowView.masterRowView=F,A.pageNo=0,A.masterValues=i.getValues(t,s,A._masterFlds),A.detailRows=A.rowsPerMaster;const l=t.detailRows=A.getNextDetailRows(t)||[];o.printBand(e,t,n,a,l,s)}T=a[a.length-1],G=t.y!==k,k=t.y,V=t.yBand}W=!1,L<=0&&(o.length>0||S<=0||M===S)&&i.pr<u&&(p>0&&i.repeatDetailFooter&&(c(this),W=!0),(o.length>0||W)&&s<u&&(a.length===w||W)&&(T=h(this,!0,0===o.length))),F.isGroupFooter&&r&&A()}}if(0==p||i.pr>E){if(!W&&(A(),c(this),W=!0,p>0&&w<Number.MAX_SAFE_INTEGER&&i.pr<u)){const i=this.$_createPage(e);t.yBand=V=0,t.y=t.bodyTop,k=t.bodyTop,a.push(i),l(this,i)}}else if(x){const e=x.height;x.remove(),V-=e,k-=e}W||(t.yBand=V,t.y=k,t.h=t.bodyHeight-(k-t.bodyTop))}$_printAcross(e,t,i,r,s,n,o,a,A){function l(t){S.length=0;for(let i=0;i<s;i++)B=t.$_addTable(e,b,r[2*i],w),S.push(B.tBodies[0])}function h(e){let t=0;for(let i=0;i<s;i++){const r=new TableLine(e._headerView._dom.firstChild);t=Math.max(t,r.height),t&&r.appendTo(S[i],TableBandElement.HEADER_CLASS)}w+=t,m=_+=t}const d=new TableLine(this._footerView._dom.firstChild),c=d.height,u=i.dataRow.rowCount;let p=0===a?s:Math.min(s,a),_=t.y,g=t.bodyBottom,m=_,f=_,w=0;const C=new Array(s),y=new Array,E=new Array;let b,B,P;const S=[];let v;const R=this._bodyView.endRowView;let I=this._bodyView.endMessageView;const{endRowCount:T}=i.getEndRowCount(0),x=[];let O,D=0;const L=a<T?T:a;b=this.$_createPage(e),A.push(b),l(this),h(this);for(let e=0;e<p;e++)C[e]=[];for(;(this._isPrintDataRow()||this._isPrintEndRow())&&!(D>=L);){0===w&&h(this);let r=-1,n=0;y.length=0;for(let e=0;e<p&&!(D>=L);e++){i.pr<a?v=E.pop()||new TableBodyLine(o,i.tr,u):I&&0===x.length?(O=I,x.push(O),v=O):(O=R.clone(),x.push(O),v=O),v.appendTo(S[e]),y.push(v);const A=v.height;if(_+A>g){r=e;break}D++,C[e].push(v),i.setPrinting(t,i.pr+1,v.count),e===s-1&&(m+=A),n=Math.max(n,A)}if(r>=0){for(let e of y)e.detach(),E.push(e);x.pop(),0===x.length&&(D=0),m=_=t.bodyTop,w=0,r=-1,f=t.bodyTop,b=this.$_createPage(e),A.push(b),l(this)}else _+=n,w+=n,E.length=0}let F=0;if(a>0)for(let e=0;e<p;e++)C[e].length&&F++;const H=i.footer.attachToBody,N=H?Math.min(F,s-1):s-1;H&&(P=S[N]),P||(P=this.$_addTable(e,b,r[2*N],_-f).tBodies[0]),c&&d.appendTo(P,TableBandElement.FOOTER_CLASS),H?_=Math.max(_,m+c):_+=c,_>g&&(d.remove(),b=this.$_createPage(e),A.push(b),l(this),P=S[N],c&&d.appendTo(P,TableBandElement.FOOTER_CLASS),_=t.bodyTop+c),t.y=_,t.h=t.bodyHeight-(_-t.bodyTop)}$_printDown(e,t,i,r,s,n,o,a,A){function l(t){b=0;for(let i=0;i<s;i++){m[i]=u,f[i]=[],E=t.$_addTable(e,y,r[2*i],g).tBodies[0],B[i]=E;const s=new TableLine(t._headerView._dom.firstChild);b=Math.max(b,s.height),b&&s.appendTo(E,TableBandElement.HEADER_CLASS)}g+=b,u+=b}const h=new TableLine(this._footerView._dom.firstChild),d=h.height;let c=0===a?s:Math.min(s,a),u=t.y,p=t.bodyBottom,_=u,g=0;const m=new Array(s),f=new Array(s);let w,C,y,E,b=0;const B=new Array(s),P=i.dataRow.rowCount,S=this._bodyView.endRowView;let v=this._bodyView.endMessageView;const{endRowCount:R}=i.getEndRowCount(0),I=[];let T,x=0;const O=a<R?R:a;y=this.$_createPage(e),A.push(y),l(this);do{if(x>=O)break;for(let r=0;r<s;r++)for(0===g&&(0===r?l(this):(g+=b,u+=b));(this._isPrintDataRow()||this._isPrintEndRow())&&!(x>=O);){w=C,i.pr<a?w=new TableBodyLine(o,i.tr,P):v&&0===I.length?(T=v,I.push(T),w=T):(T=S.clone(),I.push(T),w=T),C=null,E=B[r],w.appendTo(E);const n=w.height;if(g+=n,u+=n,m[r]=u,f[r].push(w),u>p){w.detach(),C=w,f[r].pop(),I.pop(),g=0,r===s-1?(0===I.length&&(x=0),y=this.$_createPage(e),A.push(y),_=t.bodyTop):_=A.length>1?t.bodyTop:t.y,u=_;break}x++,i.setPrinting(t,i.pr+1,w.count)}}while(this._isPrintDataRow()||this._isPrintEndRow());let D=0;if(a>1){let e=0;for(let t=0;t<m.length;t++)for(let i=0;i<f[t].length;i++)e+=f[t][i].height;const t=new Array(c);let i=Math.round(e/c);for(let e=0;e<c-1;e++){let r,s=f[e],n=0,o=0;for(;n<s.length;){if(o+=r=s[n].height,o>i){o-=r;break}n++}t[e]=o;const a=f[e+1];let A=0;for(;n<s.length;){const e=s[n];s.splice(n,1),a.splice(A++,0,e)}g=b;for(let t=0;t<a.length;t++)a[t].detach(),a[t].appendTo(B[e+1])}t[s-1]=0;for(let e=0;e<f[s-1].length;e++)t[s-1]+=f[s-1][e].height;for(let e=0;e<2;e++)(()=>{for(let e=c-1;e>0;e--)for(;t[e]>t[e-1];){const i=f[e],r=f[e-1],s=i.shift(),n=s.height;s.detach(),t[e]-=n,r.push(s),s.appendTo(B[e-1]),t[e-1]+=n}})();for(let e=0;e<s;e++){let t=f[e];if(m[e]=_+b,t.length>0){D=e+1;for(let i=0;i<t.length;i++)m[e]+=t[i].height}}}else{for(let e=0;e<s;e++)m[e]=_+b;D=a,D&&(m[0]+=f[0][0].height)}const L=i.footer.attachToBody,F=L?Math.min(D,s-1):s-1,H=L?m[F]:0;u=m[0];for(let e=1;e<c;e++)u=Math.max(u,m[e]);E=L?B[F]:this.$_addTable(e,y,r[2*F],u-_).tBodies[0],d&&h.appendTo(E,TableBandElement.FOOTER_CLASS),L?u=Math.max(u,H+d):u+=d,u>p&&(h.remove(),y=this.$_createPage(e),A.push(y),E=this.$_addTable(e,y,r[2*F],g=0).tBodies[0],d&&h.appendTo(E,TableBandElement.FOOTER_CLASS),u=t.bodyTop+d),t.y=u,t.h=t.bodyHeight-(u-t.bodyTop)}$_printMulti(e,t,i,r,s,n,o,a,A){let l,h,d=Math.min(s,a);const c=[],u=new Array(s);let p=0;l=this.$_createPage(e),A.push(l);for(let t=0;t<s;t++)h=this.$_addTable(e,l,r[2*t],p),c.push(h.tBodies[0]);!function(e){let t=0;for(let i=0;i<s;i++){const r=new TableLine(e._headerView._dom.firstChild);t=Math.max(t,r.height),t&&r.appendTo(c[i],TableBandElement.HEADER_CLASS)}p+=t}(this);for(let e=0;e<d;e++)u[e]=[]}}TableBandElement.HEADER_CLASS="-rrp-tableband-header",TableBandElement.FOOTER_CLASS="-rrp-tableband-footer",TableBandElement.ROW_CLASS="-rrp-tableband-row",TableBandElement.DUMMY_GROUP_FOOTER="_dummy_group_footer_";class FloatingContainerElement extends ReportGroupItemElement{constructor(e,t){super(e,t,"floatingContainerView")}_getCssSelector(){return"rr-floating-container rr-group-element"}get debugLabel(){return"floating"}get floating(){return!0}_needDesignBox(){return!0}_doMeasure(e,t,i,r){if(this.measureFixed||this._setModelSize(this.model,t,i,r,!0),super._doMeasure(e,t,i,r),this.childCount>0){const e=this.getChild(0);return new Size(e.measuredWidth,e.measuredHeight)}return new Size}_doAfterMeasure(e,t,i,r,s){!e.printing&&this.model.designHeight>0&&(s.height=this.model.designHeight),!e.printing&&this.model.designWidth>0&&(s.width=this.model.designWidth),super._doAfterMeasure(e,t,i,r,s),e.printing||(this._isEmpty()?this.dom.style.background="":(this.dom.style.background="#ff880010",this.dom.style.border=e.reportView.focusedElement===this.getChild(0)?"1px dashed #000":"1px dashed #55000080"))}_setDesignContent(e,t){super._setDesignContent(!0,t)}_layoutItem(e,t,i,r,s,n,o){r=(n-t.width)/2,s=(o-t.height)/2,t.move(r,s),t.setPrintStyles()}}const SVGNS="http://www.w3.org/2000/svg";let $_clip=0;class SvgRenderer extends Base{constructor(e,t){super(),this._transforms=[],this._defs=e,this._element=t}_doDispose(){this.clear(),super._doDispose()}get doc(){return getDoc(this._element)||document}get element(){return this._element}init(e,t){return this._defs=e,this._element=t,this}clear(){this._defs=null,this._element=null,this._transforms=null}save(){this._transforms.push(this._trans),this._trans=""}restore(){this._trans=this._transforms.pop()}translate(e,t){this._trans+="translate("+e+","+t+")"}rotate(e){this._trans+="rotate("+180*e/Math.PI+")"}rotateAt(e,t,i){this._trans+="rotate("+180*e/Math.PI+","+t+",)"}scale(e,t){this._trans+="scale("+e+","+t+")"}clipRect(e){this.clip(e.x,e.y,e.width,e.height)}clip(e,t,i,r){const s=this.doc,n=$_clip++,o=s.createElementNS(SVGNS,"clipPath");o.setAttributeNS(null,"id","clip"+n);const a=s.createElementNS(SVGNS,"rect");a.x.baseVal.value=e,a.y.baseVal.value=t,a.width.baseVal.value=i,a.height.baseVal.value=r,o.appendChild(a),this._defs.appendChild(o)}line(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"line");return this._element.appendChild(n),n.x1.baseVal.value=t,n.y1.baseVal.value=i,n.x2.baseVal.value=r,n.y2.baseVal.value=s,this.$_setStyles(n,e),n}sline(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"line");return this._element.appendChild(n),n.x1.baseVal.valueAsString=t,n.y1.baseVal.valueAsString=i,n.x2.baseVal.valueAsString=r,n.y2.baseVal.valueAsString=s,this.$_setStyles(n,e),n}lines(e,...t){if(null==t||t.length<4)return;const i=this.doc.createElementNS(SVGNS,"polyline"),r=[];r.push(t[0]+","+t[1]);for(let e=2;e<t.length;e+=2)r.push(t[e]+","+t[e+1]);i.setAttributeNS(null,"points",r.join(" ")),this.$_setStyles(i,e),this._element.appendChild(i)}polygon(e,t){if(null==t||t.length<4)return;const i=this.doc.createElementNS(SVGNS,"polygon"),r=[];r.push(t[0]+","+t[1]);for(let e=2;e<t.length;e+=2)r.push(t[e]+","+t[e+1]);return this._trans&&i.setAttributeNS(null,"transform",this._trans),i.setAttributeNS(null,"points",r.join(" ")),this.$_setStyles(i,e),this._element.appendChild(i),i}quadratic(e,t,i,r,s,n,o){const a=this.doc.createElementNS(SVGNS,"path");a.setAttributeNS(null,"d",["M",t,i,"Q",r,s,n,o].join(" ")),this.$_setStyles(a,e),this._element.appendChild(a)}squadratic(e,t,i,r,s,n,o){const a=this.doc.createElementNS(SVGNS,"path");a.setAttributeNS(null,"d",["M",t+"%",i+"%","Q",r+"%",s+"%",n+"%",o+"%"].join(" ")),this.$_setStyles(a,e),this._element.appendChild(a)}curve(e,...t){const i=this.$_getCurvedLinePath(t,0,t.length-1);if(i){const t=this.doc.createElementNS(SVGNS,"path");t.setAttributeNS(null,"d",i.join(" ")),this.$_setStyles(t,e),this._element.appendChild(t)}}scurve(e,...t){const i=this.$_getCurvedLinePath(t,0,t.length-1);if(i){const t=this.doc.createElementNS(SVGNS,"path");for(let e=0;e<i.length;e++)"number"==typeof i[e]&&(i[e]=i[e]+"%");t.setAttributeNS(null,"d",i.join(" ")),this.$_setStyles(t,e),this._element.appendChild(t)}}curveRange(e,t,i,r,s){if(r&&r.length>1&&s&&s.length>1&&(e||t)){let n=this.$_getCurvedLinePath(r,0,r.length/2-1,!0);if(n){n.push("L",s[s.length-2],[s.length-1]);const o=this.$_getCurvedLinePath(s,s.length/2-1,0,!1);o&&(n=n.concat(o)),n.push("L",r[0],r[1]);const a=this.doc.createElementNS(SVGNS,"path");a.setAttributeNS(null,"d",n.join(" ")),this.$_fillOrStroke(a,e,t,i),this._element.appendChild(a)}}}rect(e,t){const i=this.doc.createElementNS(SVGNS,"rect");i.x.baseVal.value=t.x,i.y.baseVal.value=t.y,i.width.baseVal.value=t.width,i.height.baseVal.value=t.height,this.$_setStyles(i,e),this._element.appendChild(i)}srect(e,t){const i=this.doc.createElementNS(SVGNS,"rect");i.x.baseVal.valueAsString=t.x+"%",i.y.baseVal.valueAsString=t.y+"%",i.width.baseVal.valueAsString=t.width+"%",i.height.baseVal.valueAsString=t.height+"%",this.$_setStyles(i,e),this._element.appendChild(i)}bounds(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"rect");n.x.baseVal.value=t,n.y.baseVal.value=s<0?i+s:i,n.width.baseVal.value=r,n.height.baseVal.value=Math.abs(s),this.$_setStyles(n,e),this._element.appendChild(n)}pbounds(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"rect");n.x.baseVal.valueAsString=t+"%",n.y.baseVal.valueAsString=(s<0?i+s:i)+"%",n.width.baseVal.valueAsString=r+"%",n.height.baseVal.valueAsString=Math.abs(s)+"%",this.$_setStyles(n,e),this._element.appendChild(n)}sbounds(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"rect");n.x.baseVal.valueAsString=t,n.y.baseVal.valueAsString=i,n.width.baseVal.valueAsString=r,n.height.baseVal.valueAsString=s,this.$_setStyles(n,e),this._element.appendChild(n)}circle(e,t,i,r){const s=this.doc.createElementNS(SVGNS,"circle");s.cx.baseVal.value=t,s.cy.baseVal.value=i,s.r.baseVal.value=r,this.$_setStyles(s,e),this._element.appendChild(s)}scircle(e,t,i,r){const s=this.doc.createElementNS(SVGNS,"circle");s.cx.baseVal.valueAsString=t,s.cy.baseVal.valueAsString=i,s.r.baseVal.valueAsString=r,this.$_setStyles(s,e),this._element.appendChild(s)}circleRect(e,t,i,r,s,n){const o=this.doc.createElementNS(SVGNS,"circle"),a=i+s/2,A=r+n/2,l=Math.min(s,n)/2;o.cx.baseVal.value=a,o.cy.baseVal.value=A,o.r.baseVal.value=l,this.$_setStyles(o,e),this._element.appendChild(o)}scircleRect(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"circle"),o=t+r/2,a=i+s/2,A=Math.min(r,s)/2;n.cx.baseVal.valueAsString=o+"%",n.cy.baseVal.valueAsString=a+"%",n.r.baseVal.valueAsString=A+"%",this.$_setStyles(n,e),this._element.appendChild(n)}ellipse(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"ellipse");return n.cx.baseVal.value=t,n.cy.baseVal.value=i,n.rx.baseVal.value=r,n.ry.baseVal.value=s,this.$_setStyles(n,e),this._element.appendChild(n),n}sellipse(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"ellipse");n.cx.baseVal.valueAsString=t+"%",n.cy.baseVal.valueAsString=i+"%",n.rx.baseVal.valueAsString=r+"%",n.ry.baseVal.valueAsString=s+"%",this.$_setStyles(n,e),this._element.appendChild(n)}ellipseRect(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"ellipse"),o=r/2,a=s/2;return n.cx.baseVal.value=t+o,n.cy.baseVal.value=i+a,n.rx.baseVal.value=o,n.ry.baseVal.value=a,this.$_setStyles(n,e),this._element.appendChild(n),n}sellipseRect(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"ellipse"),o=r/2,a=s/2;n.cx.baseVal.valueAsString=t+o+"%",n.cy.baseVal.valueAsString=i+a+"%",n.rx.baseVal.valueAsString=o+"%",n.ry.baseVal.valueAsString=a+"%",this.$_setStyles(n,e),this._element.appendChild(n)}text(e,t,i,r,s,n,o,a,A){const l=this.doc.createElementNS(SVGNS,"text");t=t||"Verdana",l.setAttributeNS(null,"y",a+""),l.setAttributeNS(null,"dy","top"),l.setAttributeNS(null,"x",o+""),l.setAttributeNS(null,"text-anchor",A),l.setAttributeNS(null,"font-family",t),l.setAttributeNS(null,"font-size",i+""),s&&l.setAttributeNS(null,"text-decoration",s),l[Utils.TextProp]=n,this.$_setStyles(l,e),this._element.appendChild(l)}stext(e,t,i,r,s){const n=this.doc.createElementNS(SVGNS,"text");n.setAttributeNS(null,"y",r+"%"),n.setAttributeNS(null,"dy","top"),n.setAttributeNS(null,"x",i+"%"),n[Utils.TextProp]=t,this.$_setStyles(n,e),this._element.appendChild(n)}$_setStyles(e,t){"string"==typeof t?e.setAttribute("class",t):t&&Utils.extend(e.style,t)}$_stroke(e,t,i){e.style.fill="none",e.style.stroke=t,isNaN(i)||(e.style.strokeWidth=i+"")}$_fill(e,t){e.style.fill=t}$_fillOrStroke(e,t,i,r){i&&(e.style.stroke=i,isNaN(r)||(e.style.strokeWidth=r+"")),e.style.fill=t||"none"}$_getCurvedLinePath(e,t,i,r=!0){if(e&&i!=t&&e.length/2>i){const s=[],n=t>i?-1:1;let o=t;if(r&&s.push("M",e[2*o],e[2*o+1]),2==Math.abs(i-t))return s.push("L",e[2*(o+n)],e[2*(o+n)+1]),s;const a=.25,A={x:0,y:0},l={x:0,y:0},h={x:0,y:0},d={x:e[2*(o+n)]-e[2*o],y:e[2*(o+n)+1]-e[2*o+1]};let c={x:0,y:0};const u={x:0,y:0},p={x:0,y:0},_={x:0,y:0};let g=Math.sqrt(d.x*d.x+d.y*d.y);d.x/=g,d.y/=g;let m=e[2*(o+n)]-e[2*o],f=e[2*o],w=e[2*o+1];for(o+=n;o!=i;o+=n){h.x=-d.x,h.y=-d.y,d.x=e[2*(o+n)]-e[2*o],d.y=e[2*(o+n)]-e[2*o+1],g=Math.sqrt(d.x*d.x+d.y*d.y),d.x/=g,d.y/=g,d.x<h.x?(c.x=h.x-d.x,c.y=h.y-d.y):(c.x=d.x-h.x,c.y=d.y-h.y);const i=Math.sqrt(c.x*c.x+c.y*c.y);c.x/=i,c.y/=i,h.y*d.y>=0&&(c={x:1,y:0}),A.x=-c.x*m*a,A.y=-c.y*m*a,o==n+t?s.push("Q",e[2*o]+A.x,e[2*o+1]+A.y,e[2*o],e[2*o+1]):(u.x=f+l.x,u.y=w+l.y,p.x=e[2*o]+A.x,p.y=e[2*o+1]+A.y,_.x=(u.x+p.x)/2,_.y=(u.y+p.y)/2,s.push("Q",u.x,u.y,_.x,_.y),s.push("Q",p.x,p.y,e[2*o],e[2*o+1])),m=e[2*(o+n)]-e[2*o],l.x=c.x*m*a,l.y=c.y*m*a,f=e[2*o],w=e[2*o+1]}return s.push("Q",f+l.x,w+l.y,e[2*o],e[2*o+1]),s}return null}}class SvgElement extends Base{constructor(e){super();const t=getDoc(e),i=this._element=t.createElementNS(SVGNS,"svg"),r=i.style,s=this._defs=t.createElementNS(SVGNS,"defs");i.appendChild(s),r.background="",r.border="none",r.pointerEvents="none",e.appendChild(i),this._renderer=new SvgRenderer(this._defs)}static createSVG(e,t,i){const r=getDoc(e),s=r.createElementNS(SVGNS,"svg");return s.appendChild(r.createElementNS(SVGNS,"defs")),s.appendChild(r.createElementNS(SVGNS,"g")),t&&s.setAttribute("class","rr-rating-shape"),Utils.extend(s.style,{background:"",border:"none",pointerEvents:"none"}),i&&Utils.extend(s.style,i),e.appendChild(s),s}static renderSVG(e,t,i,r){const s=i.lastElementChild,n=this._renderer.init(i.firstChild,s);Utils.clearChildren(s),r.call(e,t,n,i.clientWidth,i.clientHeight),n.clear()}static setAttr(e,t,i){e.setAttribute(t,i)}static setStyle(e,t,i){e.style[t]=i}static prepareExport(e,t,i){e.attributes.viewBox||e.setAttribute("viewBox",[0,0,t,i].join(" "));const r=e.style;if(!r.fill||!r.stroke){const t=getComputedStyle(e);r.fill||(r.fill=t.fill),r.stroke||(r.stroke=t.stroke)}}_doDispose(){this._renderer=this._renderer.dispose(),this._element.parentElement.removeChild(this._element),this._element=this._defs=null,super._doDispose()}get element(){return this._element}render(e){this._clear(),e?e.call(this,this._renderer,this._element.clientWidth,this._element.clientHeight):this._doRender(this._renderer,this._element.clientWidth,this._element.clientHeight)}_clear(){this._element.childElementCount>1&&this._element.removeChild(this._element.lastElementChild);const e=getDoc(this._element).createElementNS(SVGNS,"g");this._element.appendChild(e),this._renderer._element=e}_doRender(e,t,i){}}SvgElement._renderer=new SvgRenderer;var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e){var t={exports:{}};return e(t,t.exports),t.exports}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}function _classCallCheck$o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Barcode=function e(t,i){_classCallCheck$o(this,e),this.data=t,this.text=i.text||t,this.options=i},_default$y=Barcode,Barcode_1=Object.defineProperty({default:_default$y},"__esModule",{value:!0}),CODE39_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CODE39=void 0;var i,r=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();var s=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=e.toUpperCase(),i.mod43&&(e+=function(e){return n[e]}(function(e){for(var t=0,i=0;i<e.length;i++)t+=A(e[i]);return t%=43}(e))),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"encode",value:function(){for(var e=a("*"),t=0;t<this.data.length;t++)e+=a(this.data[t])+"0";return{data:e+=a("*"),text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)}}]),t}(((i=Barcode_1)&&i.__esModule?i:{default:i}).default),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],o=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function a(e){return function(e){return o[e].toString(2)}(A(e))}function A(e){return n.indexOf(e)}t.CODE39=s})),constants$2=createCommonjsModule((function(e,t){var i;function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(t,"__esModule",{value:!0});var s=t.SET_A=0,n=t.SET_B=1,o=t.SET_C=2;t.SHIFT=98;var a=t.START_A=103,A=t.START_B=104,l=t.START_C=105;t.MODULO=103,t.STOP=106,t.FNC1=207,t.SET_BY_CODE=(r(i={},a,s),r(i,A,n),r(i,l,o),i),t.SWAP={101:s,100:n,99:o},t.A_START_CHAR=String.fromCharCode(208),t.B_START_CHAR=String.fromCharCode(209),t.C_START_CHAR=String.fromCharCode(210),t.A_CHARS="[\0-_È-Ï]",t.B_CHARS="[ -È-Ï]",t.C_CHARS="(Ï*[0-9]{2}Ï*)",t.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]})),_createClass$h=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_Barcode3$7=_interopRequireDefault$o(Barcode_1);function _interopRequireDefault$o(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$j(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CODE128$1=function(e){function t(e,i){_classCallCheck$n(this,t);var r=_possibleConstructorReturn$j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.substring(1),i));return r.bytes=e.split("").map((function(e){return e.charCodeAt(0)})),r}return _inherits$j(t,_Barcode3$7.default),_createClass$h(t,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var e=this.bytes,i=e.shift()-105,r=constants$2.SET_BY_CODE[i];if(void 0===r)throw new RangeError("The encoding does not start with a start character.");!0===this.shouldEncodeAsEan128()&&e.unshift(constants$2.FNC1);var s=t.next(e,1,r);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:t.getBar(i)+s.result+t.getBar((s.checksum+i)%constants$2.MODULO)+t.getBar(constants$2.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var e=this.options.ean128||!1;return"string"==typeof e&&(e="true"===e.toLowerCase()),e}}],[{key:"getBar",value:function(e){return constants$2.BARS[e]?constants$2.BARS[e].toString():""}},{key:"correctIndex",value:function(e,t){if(t===constants$2.SET_A){var i=e.shift();return i<32?i+64:i-32}return t===constants$2.SET_B?e.shift()-32:10*(e.shift()-48)+e.shift()-48}},{key:"next",value:function(e,i,r){if(!e.length)return{result:"",checksum:0};var s=void 0,n=void 0;if(e[0]>=200){n=e.shift()-105;var o=constants$2.SWAP[n];void 0!==o?s=t.next(e,i+1,o):(r!==constants$2.SET_A&&r!==constants$2.SET_B||n!==constants$2.SHIFT||(e[0]=r===constants$2.SET_A?e[0]>95?e[0]-96:e[0]:e[0]<32?e[0]+96:e[0]),s=t.next(e,i+1,r))}else n=t.correctIndex(e,r),s=t.next(e,i+1,r);var a=n*i;return{result:t.getBar(n)+s.result,checksum:a+s.checksum}}}]),t}(),_default$x=CODE128$1,CODE128_1=Object.defineProperty({default:_default$x},"__esModule",{value:!0}),matchSetALength=function(e){return e.match(new RegExp("^"+constants$2.A_CHARS+"*"))[0].length},matchSetBLength=function(e){return e.match(new RegExp("^"+constants$2.B_CHARS+"*"))[0].length},matchSetC=function(e){return e.match(new RegExp("^"+constants$2.C_CHARS+"*"))[0]};function autoSelectFromAB(e,t){var i=t?constants$2.A_CHARS:constants$2.B_CHARS,r=e.match(new RegExp("^("+i+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(r)return r[1]+String.fromCharCode(204)+autoSelectFromC(e.substring(r[1].length));var s=e.match(new RegExp("^"+i+"+"))[0];return s.length===e.length?e:s+String.fromCharCode(t?205:206)+autoSelectFromAB(e.substring(s.length),!t)}function autoSelectFromC(e){var t=matchSetC(e),i=t.length;if(i===e.length)return e;e=e.substring(i);var r=matchSetALength(e)>=matchSetBLength(e);return t+String.fromCharCode(r?206:205)+autoSelectFromAB(e,r)}var _default$w=function(e){var t=void 0;if(matchSetC(e).length>=2)t=constants$2.C_START_CHAR+autoSelectFromC(e);else{var i=matchSetALength(e)>matchSetBLength(e);t=(i?constants$2.A_START_CHAR:constants$2.B_START_CHAR)+autoSelectFromAB(e,i)}return t.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,(function(e,t){return String.fromCharCode(203)+t}))},auto=Object.defineProperty({default:_default$w},"__esModule",{value:!0}),_CODE3$3=_interopRequireDefault$n(CODE128_1),_auto2=_interopRequireDefault$n(auto);function _interopRequireDefault$n(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CODE128AUTO=function(e){function t(e,i){if(_classCallCheck$m(this,t),/^[\x00-\x7F\xC8-\xD3]+$/.test(e))var r=_possibleConstructorReturn$i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(0,_auto2.default)(e),i));else r=_possibleConstructorReturn$i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return _possibleConstructorReturn$i(r)}return _inherits$i(t,_CODE3$3.default),t}(),_default$v=CODE128AUTO,CODE128_AUTO=Object.defineProperty({default:_default$v},"__esModule",{value:!0}),_createClass$g=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_CODE3$2=_interopRequireDefault$m(CODE128_1);function _interopRequireDefault$m(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CODE128A=function(e){function t(e,i){return _classCallCheck$l(this,t),_possibleConstructorReturn$h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,constants$2.A_START_CHAR+e,i))}return _inherits$h(t,_CODE3$2.default),_createClass$g(t,[{key:"valid",value:function(){return new RegExp("^"+constants$2.A_CHARS+"+$").test(this.data)}}]),t}(),_default$u=CODE128A,CODE128A_1=Object.defineProperty({default:_default$u},"__esModule",{value:!0}),_createClass$f=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_CODE3$1=_interopRequireDefault$l(CODE128_1);function _interopRequireDefault$l(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CODE128B=function(e){function t(e,i){return _classCallCheck$k(this,t),_possibleConstructorReturn$g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,constants$2.B_START_CHAR+e,i))}return _inherits$g(t,_CODE3$1.default),_createClass$f(t,[{key:"valid",value:function(){return new RegExp("^"+constants$2.B_CHARS+"+$").test(this.data)}}]),t}(),_default$t=CODE128B,CODE128B_1=Object.defineProperty({default:_default$t},"__esModule",{value:!0}),_createClass$e=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_CODE3=_interopRequireDefault$k(CODE128_1);function _interopRequireDefault$k(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CODE128C=function(e){function t(e,i){return _classCallCheck$j(this,t),_possibleConstructorReturn$f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,constants$2.C_START_CHAR+e,i))}return _inherits$f(t,_CODE3.default),_createClass$e(t,[{key:"valid",value:function(){return new RegExp("^"+constants$2.C_CHARS+"+$").test(this.data)}}]),t}(),_default$s=CODE128C,CODE128C_1=Object.defineProperty({default:_default$s},"__esModule",{value:!0}),CODE128=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CODE128C=t.CODE128B=t.CODE128A=t.CODE128=void 0;var i=o(CODE128_AUTO),r=o(CODE128A_1),s=o(CODE128B_1),n=o(CODE128C_1);function o(e){return e&&e.__esModule?e:{default:e}}t.CODE128=i.default,t.CODE128A=r.default,t.CODE128B=s.default,t.CODE128C=n.default})),constants$1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SIDE_BIN="101",t.MIDDLE_BIN="01010",t.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},t.EAN2_STRUCTURE=["LL","LG","GL","GG"],t.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],t.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]})),encode$1=function(e,t,i){var r=e.split("").map((function(e,i){return constants$1.BINARIES[t[i]]})).map((function(t,i){return t?t[e[i]]:""}));if(i){var s=e.length-1;r=r.map((function(e,t){return t<s?e+i:e}))}return r.join("")},_default$r=encode$1,encoder=Object.defineProperty({default:_default$r},"__esModule",{value:!0}),_createClass$d=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_encoder2$4=_interopRequireDefault$j(encoder),_Barcode3$6=_interopRequireDefault$j(Barcode_1);function _interopRequireDefault$j(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$e(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var EAN=function(e){function t(e,i){_classCallCheck$i(this,t);var r=_possibleConstructorReturn$e(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.fontSize=!i.flat&&i.fontSize>10*i.width?10*i.width:i.fontSize,r.guardHeight=i.height+r.fontSize/2+i.textMargin,r}return _inherits$e(t,_Barcode3$6.default),_createClass$d(t,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(e,t){return this.text.substr(e,t)}},{key:"leftEncode",value:function(e,t){return(0,_encoder2$4.default)(e,t)}},{key:"rightText",value:function(e,t){return this.text.substr(e,t)}},{key:"rightEncode",value:function(e,t){return(0,_encoder2$4.default)(e,t)}},{key:"encodeGuarded",value:function(){var e={fontSize:this.fontSize},t={height:this.guardHeight};return[{data:constants$1.SIDE_BIN,options:t},{data:this.leftEncode(),text:this.leftText(),options:e},{data:constants$1.MIDDLE_BIN,options:t},{data:this.rightEncode(),text:this.rightText(),options:e},{data:constants$1.SIDE_BIN,options:t}]}},{key:"encodeFlat",value:function(){return{data:[constants$1.SIDE_BIN,this.leftEncode(),constants$1.MIDDLE_BIN,this.rightEncode(),constants$1.SIDE_BIN].join(""),text:this.text}}}]),t}(),_default$q=EAN,EAN_1=Object.defineProperty({default:_default$q},"__esModule",{value:!0}),_createClass$c=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_get$1=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,i,r)}if("value"in s)return s.value;var o=s.get;return void 0!==o?o.call(r):void 0},_EAN3$1=_interopRequireDefault$i(EAN_1);function _interopRequireDefault$i(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var checksum$4=function(e){var t=e.substr(0,12).split("").map((function(e){return+e})).reduce((function(e,t,i){return i%2?e+3*t:e+t}),0);return(10-t%10)%10},EAN13=function(e){function t(e,i){_classCallCheck$h(this,t),-1!==e.search(/^[0-9]{12}$/)&&(e+=checksum$4(e));var r=_possibleConstructorReturn$d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.lastChar=i.lastChar,r}return _inherits$d(t,_EAN3$1.default),_createClass$c(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{13}$/)&&+this.data[12]===checksum$4(this.data)}},{key:"leftText",value:function(){return _get$1(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var e=this.data.substr(1,6),i=constants$1.EAN13_STRUCTURE[this.data[0]];return _get$1(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftEncode",this).call(this,e,i)}},{key:"rightText",value:function(){return _get$1(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var e=this.data.substr(7,6);return _get$1(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightEncode",this).call(this,e,"RRRRRR")}},{key:"encodeGuarded",value:function(){var e=_get$1(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(e.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(e.push({data:"00"}),e.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),e}}]),t}(),_default$p=EAN13,EAN13_1=Object.defineProperty({default:_default$p},"__esModule",{value:!0}),_createClass$b=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_get=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,i,r)}if("value"in s)return s.value;var o=s.get;return void 0!==o?o.call(r):void 0},_EAN3=_interopRequireDefault$h(EAN_1);function _interopRequireDefault$h(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var checksum$3=function(e){var t=e.substr(0,7).split("").map((function(e){return+e})).reduce((function(e,t,i){return i%2?e+t:e+3*t}),0);return(10-t%10)%10},EAN8=function(e){function t(e,i){return _classCallCheck$g(this,t),-1!==e.search(/^[0-9]{7}$/)&&(e+=checksum$3(e)),_possibleConstructorReturn$c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return _inherits$c(t,_EAN3.default),_createClass$b(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{8}$/)&&+this.data[7]===checksum$3(this.data)}},{key:"leftText",value:function(){return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var e=this.data.substr(0,4);return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftEncode",this).call(this,e,"LLLL")}},{key:"rightText",value:function(){return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var e=this.data.substr(4,4);return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightEncode",this).call(this,e,"RRRR")}}]),t}(),_default$o=EAN8,EAN8_1=Object.defineProperty({default:_default$o},"__esModule",{value:!0}),_createClass$a=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_encoder2$3=_interopRequireDefault$g(encoder),_Barcode3$5=_interopRequireDefault$g(Barcode_1);function _interopRequireDefault$g(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var checksum$2=function(e){var t=e.split("").map((function(e){return+e})).reduce((function(e,t,i){return i%2?e+9*t:e+3*t}),0);return t%10},EAN5=function(e){function t(e,i){return _classCallCheck$f(this,t),_possibleConstructorReturn$b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return _inherits$b(t,_Barcode3$5.default),_createClass$a(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{5}$/)}},{key:"encode",value:function(){var e=constants$1.EAN5_STRUCTURE[checksum$2(this.data)];return{data:"1011"+(0,_encoder2$3.default)(this.data,e,"01"),text:this.text}}}]),t}(),_default$n=EAN5,EAN5_1=Object.defineProperty({default:_default$n},"__esModule",{value:!0}),_createClass$9=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_encoder2$2=_interopRequireDefault$f(encoder),_Barcode3$4=_interopRequireDefault$f(Barcode_1);function _interopRequireDefault$f(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var EAN2=function(e){function t(e,i){return _classCallCheck$e(this,t),_possibleConstructorReturn$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return _inherits$a(t,_Barcode3$4.default),_createClass$9(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{2}$/)}},{key:"encode",value:function(){var e=constants$1.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,_encoder2$2.default)(this.data,e,"01"),text:this.text}}}]),t}(),_default$m=EAN2,EAN2_1=Object.defineProperty({default:_default$m},"__esModule",{value:!0}),_createClass$8=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),checksum_1=checksum$1,_encoder2$1=_interopRequireDefault$e(encoder),_Barcode3$3=_interopRequireDefault$e(Barcode_1);function _interopRequireDefault$e(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$9(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$9(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var UPC=function(e){function t(e,i){_classCallCheck$d(this,t),-1!==e.search(/^[0-9]{11}$/)&&(e+=checksum$1(e));var r=_possibleConstructorReturn$9(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.displayValue=i.displayValue,i.fontSize>10*i.width?r.fontSize=10*i.width:r.fontSize=i.fontSize,r.guardHeight=i.height+r.fontSize/2+i.textMargin,r}return _inherits$9(t,_Barcode3$3.default),_createClass$8(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{12}$/)&&this.data[11]==checksum$1(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var e="";return e+="101",e+=(0,_encoder2$1.default)(this.data.substr(0,6),"LLLLLL"),e+="01010",e+=(0,_encoder2$1.default)(this.data.substr(6,6),"RRRRRR"),{data:e+="101",text:this.text}}},{key:"guardedEncoding",value:function(){var e=[];return this.displayValue&&e.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),e.push({data:"101"+(0,_encoder2$1.default)(this.data[0],"L"),options:{height:this.guardHeight}}),e.push({data:(0,_encoder2$1.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),e.push({data:"01010",options:{height:this.guardHeight}}),e.push({data:(0,_encoder2$1.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),e.push({data:(0,_encoder2$1.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&e.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),e}}]),t}();function checksum$1(e){var t,i=0;for(t=1;t<11;t+=2)i+=parseInt(e[t]);for(t=0;t<11;t+=2)i+=3*parseInt(e[t]);return(10-i%10)%10}var _default$l=UPC,UPC_1=Object.defineProperty({checksum:checksum_1,default:_default$l},"__esModule",{value:!0}),_createClass$7=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_encoder2=_interopRequireDefault$d(encoder),_Barcode3$2=_interopRequireDefault$d(Barcode_1);function _interopRequireDefault$d(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$8(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$8(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var EXPANSIONS=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],PARITIES=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],UPCE=function(e){function t(e,i){_classCallCheck$c(this,t);var r=_possibleConstructorReturn$8(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));if(r.isValid=!1,-1!==e.search(/^[0-9]{6}$/))r.middleDigits=e,r.upcA=expandToUPCA(e,"0"),r.text=i.text||""+r.upcA[0]+e+r.upcA[r.upcA.length-1],r.isValid=!0;else{if(-1===e.search(/^[01][0-9]{7}$/))return _possibleConstructorReturn$8(r);if(r.middleDigits=e.substring(1,e.length-1),r.upcA=expandToUPCA(r.middleDigits,e[0]),r.upcA[r.upcA.length-1]!==e[e.length-1])return _possibleConstructorReturn$8(r);r.isValid=!0}return r.displayValue=i.displayValue,i.fontSize>10*i.width?r.fontSize=10*i.width:r.fontSize=i.fontSize,r.guardHeight=i.height+r.fontSize/2+i.textMargin,r}return _inherits$8(t,_Barcode3$2.default),_createClass$7(t,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var e="";return e+="101",e+=this.encodeMiddleDigits(),{data:e+="010101",text:this.text}}},{key:"guardedEncoding",value:function(){var e=[];return this.displayValue&&e.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),e.push({data:"101",options:{height:this.guardHeight}}),e.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),e.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&e.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),e}},{key:"encodeMiddleDigits",value:function(){var e=this.upcA[0],t=this.upcA[this.upcA.length-1],i=PARITIES[parseInt(t)][parseInt(e)];return(0,_encoder2.default)(this.middleDigits,i)}}]),t}();function expandToUPCA(e,t){for(var i=parseInt(e[e.length-1]),r=EXPANSIONS[i],s="",n=0,o=0;o<r.length;o++){var a=r[o];s+="X"===a?e[n++]:a}return""+(s=""+t+s)+(0,UPC_1.checksum)(s)}var _default$k=UPCE,UPCE_1=Object.defineProperty({default:_default$k},"__esModule",{value:!0}),EAN_UPC=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UPCE=t.UPC=t.EAN2=t.EAN5=t.EAN8=t.EAN13=void 0;var i=A(EAN13_1),r=A(EAN8_1),s=A(EAN5_1),n=A(EAN2_1),o=A(UPC_1),a=A(UPCE_1);function A(e){return e&&e.__esModule?e:{default:e}}t.EAN13=i.default,t.EAN8=r.default,t.EAN5=s.default,t.EAN2=n.default,t.UPC=o.default,t.UPCE=a.default})),constants=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.START_BIN="1010",t.END_BIN="11101",t.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]})),_createClass$6=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_Barcode3$1=_interopRequireDefault$c(Barcode_1);function _interopRequireDefault$c(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$7(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$7(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ITF$1=function(e){function t(){return _classCallCheck$b(this,t),_possibleConstructorReturn$7(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits$7(t,_Barcode3$1.default),_createClass$6(t,[{key:"valid",value:function(){return-1!==this.data.search(/^([0-9]{2})+$/)}},{key:"encode",value:function(){var e=this,t=this.data.match(/.{2}/g).map((function(t){return e.encodePair(t)})).join("");return{data:constants.START_BIN+t+constants.END_BIN,text:this.text}}},{key:"encodePair",value:function(e){var t=constants.BINARIES[e[1]];return constants.BINARIES[e[0]].split("").map((function(e,i){return("1"===e?"111":"1")+("1"===t[i]?"000":"0")})).join("")}}]),t}(),_default$j=ITF$1,ITF_1=Object.defineProperty({default:_default$j},"__esModule",{value:!0}),_createClass$5=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_ITF3=_interopRequireDefault$b(ITF_1);function _interopRequireDefault$b(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$6(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$6(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var checksum=function(e){var t=e.substr(0,13).split("").map((function(e){return parseInt(e,10)})).reduce((function(e,t,i){return e+t*(3-i%2*2)}),0);return 10*Math.ceil(t/10)-t},ITF14=function(e){function t(e,i){return _classCallCheck$a(this,t),-1!==e.search(/^[0-9]{13}$/)&&(e+=checksum(e)),_possibleConstructorReturn$6(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return _inherits$6(t,_ITF3.default),_createClass$5(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{14}$/)&&+this.data[13]===checksum(this.data)}}]),t}(),_default$i=ITF14,ITF14_1=Object.defineProperty({default:_default$i},"__esModule",{value:!0}),ITF=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ITF14=t.ITF=void 0;var i=s(ITF_1),r=s(ITF14_1);function s(e){return e&&e.__esModule?e:{default:e}}t.ITF=i.default,t.ITF14=r.default})),_createClass$4=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_Barcode3=_interopRequireDefault$a(Barcode_1);function _interopRequireDefault$a(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$5(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$5(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var MSI$1=function(e){function t(e,i){return _classCallCheck$9(this,t),_possibleConstructorReturn$5(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return _inherits$5(t,_Barcode3.default),_createClass$4(t,[{key:"encode",value:function(){for(var e="110",t=0;t<this.data.length;t++){var i=parseInt(this.data[t]).toString(2);i=addZeroes(i,4-i.length);for(var r=0;r<i.length;r++)e+="0"==i[r]?"100":"110"}return{data:e+="1001",text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]+$/)}}]),t}();function addZeroes(e,t){for(var i=0;i<t;i++)e="0"+e;return e}var _default$h=MSI$1,MSI_1=Object.defineProperty({default:_default$h},"__esModule",{value:!0}),mod10_1=mod10,mod11_1=mod11;function mod10(e){for(var t=0,i=0;i<e.length;i++){var r=parseInt(e[i]);(i+e.length)%2==0?t+=r:t+=2*r%10+Math.floor(2*r/10)}return(10-t%10)%10}function mod11(e){for(var t=0,i=[2,3,4,5,6,7],r=0;r<e.length;r++){var s=parseInt(e[e.length-1-r]);t+=i[r%i.length]*s}return(11-t%11)%11}var checksums=Object.defineProperty({mod10:mod10_1,mod11:mod11_1},"__esModule",{value:!0}),_MSI3$3=_interopRequireDefault$9(MSI_1);function _interopRequireDefault$9(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$4(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$4(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var MSI10=function(e){function t(e,i){return _classCallCheck$8(this,t),_possibleConstructorReturn$4(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e+(0,checksums.mod10)(e),i))}return _inherits$4(t,_MSI3$3.default),t}(),_default$g=MSI10,MSI10_1=Object.defineProperty({default:_default$g},"__esModule",{value:!0}),_MSI3$2=_interopRequireDefault$8(MSI_1);function _interopRequireDefault$8(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$3(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$3(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var MSI11=function(e){function t(e,i){return _classCallCheck$7(this,t),_possibleConstructorReturn$3(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e+(0,checksums.mod11)(e),i))}return _inherits$3(t,_MSI3$2.default),t}(),_default$f=MSI11,MSI11_1=Object.defineProperty({default:_default$f},"__esModule",{value:!0}),_MSI3$1=_interopRequireDefault$7(MSI_1);function _interopRequireDefault$7(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$2(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var MSI1010=function(e){function t(e,i){return _classCallCheck$6(this,t),e+=(0,checksums.mod10)(e),e+=(0,checksums.mod10)(e),_possibleConstructorReturn$2(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return _inherits$2(t,_MSI3$1.default),t}(),_default$e=MSI1010,MSI1010_1=Object.defineProperty({default:_default$e},"__esModule",{value:!0}),_MSI3=_interopRequireDefault$6(MSI_1);function _interopRequireDefault$6(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$1(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var MSI1110=function(e){function t(e,i){return _classCallCheck$5(this,t),e+=(0,checksums.mod11)(e),e+=(0,checksums.mod10)(e),_possibleConstructorReturn$1(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return _inherits$1(t,_MSI3.default),t}(),_default$d=MSI1110,MSI1110_1=Object.defineProperty({default:_default$d},"__esModule",{value:!0}),MSI=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MSI1110=t.MSI1010=t.MSI11=t.MSI10=t.MSI=void 0;var i=a(MSI_1),r=a(MSI10_1),s=a(MSI11_1),n=a(MSI1010_1),o=a(MSI1110_1);function a(e){return e&&e.__esModule?e:{default:e}}t.MSI=i.default,t.MSI10=r.default,t.MSI11=s.default,t.MSI1010=n.default,t.MSI1110=o.default})),pharmacode_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.pharmacode=void 0;var i,r=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();var s=function(e){function t(e,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return r.number=parseInt(e,10),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"encode",value:function(){for(var e=this.number,t="";!isNaN(e)&&0!=e;)e%2==0?(t="11100"+t,e=(e-2)/2):(t="100"+t,e=(e-1)/2);return{data:t=t.slice(0,-2),text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),t}(((i=Barcode_1)&&i.__esModule?i:{default:i}).default);t.pharmacode=s})),codabar_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.codabar=void 0;var i,r=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();var s=function(e){function t(e,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),0===e.search(/^[0-9\-\$\:\.\+\/]+$/)&&(e="A"+e+"A");var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.toUpperCase(),i));return r.text=r.options.text||r.text.replace(/[A-D]/g,""),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)}},{key:"encode",value:function(){for(var e=[],t=this.getEncodings(),i=0;i<this.data.length;i++)e.push(t[this.data.charAt(i)]),i!==this.data.length-1&&e.push("0");return{text:this.text,data:e.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),t}(((i=Barcode_1)&&i.__esModule?i:{default:i}).default);t.codabar=s})),GenericBarcode_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GenericBarcode=void 0;var i,r=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();var s=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),t}(((i=Barcode_1)&&i.__esModule?i:{default:i}).default);t.GenericBarcode=s})),_default$c={CODE39:CODE39_1.CODE39,CODE128:CODE128.CODE128,CODE128A:CODE128.CODE128A,CODE128B:CODE128.CODE128B,CODE128C:CODE128.CODE128C,EAN13:EAN_UPC.EAN13,EAN8:EAN_UPC.EAN8,EAN5:EAN_UPC.EAN5,EAN2:EAN_UPC.EAN2,UPC:EAN_UPC.UPC,UPCE:EAN_UPC.UPCE,ITF14:ITF.ITF14,ITF:ITF.ITF,MSI:MSI.MSI,MSI10:MSI.MSI10,MSI11:MSI.MSI11,MSI1010:MSI.MSI1010,MSI1110:MSI.MSI1110,pharmacode:pharmacode_1.pharmacode,codabar:codabar_1.codabar,GenericBarcode:GenericBarcode_1.GenericBarcode},barcodes=Object.defineProperty({default:_default$c},"__esModule",{value:!0}),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},_default$b=function(e,t){return _extends({},e,t)},merge=Object.defineProperty({default:_default$b},"__esModule",{value:!0}),_default$a=linearizeEncodings;function linearizeEncodings(e){var t=[];return function e(i){if(Array.isArray(i))for(var r=0;r<i.length;r++)e(i[r]);else i.text=i.text||"",i.data=i.data||"",t.push(i)}(e),t}var linearizeEncodings_1=Object.defineProperty({default:_default$a},"__esModule",{value:!0}),_default$9=fixOptions;function fixOptions(e){return e.marginTop=e.marginTop||e.margin,e.marginBottom=e.marginBottom||e.margin,e.marginRight=e.marginRight||e.margin,e.marginLeft=e.marginLeft||e.margin,e}var fixOptions_1=Object.defineProperty({default:_default$9},"__esModule",{value:!0}),_default$8=optionsFromStrings;function optionsFromStrings(e){var t=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var i in t)t.hasOwnProperty(i)&&"string"==typeof e[i=t[i]]&&(e[i]=parseInt(e[i],10));return"string"==typeof e.displayValue&&(e.displayValue="false"!=e.displayValue),e}var optionsFromStrings_1=Object.defineProperty({default:_default$8},"__esModule",{value:!0}),defaults={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}},_default$7=defaults,defaults_1=Object.defineProperty({default:_default$7},"__esModule",{value:!0}),_optionsFromStrings2$1=_interopRequireDefault$5(optionsFromStrings_1),_defaults2$1=_interopRequireDefault$5(defaults_1);function _interopRequireDefault$5(e){return e&&e.__esModule?e:{default:e}}function getOptionsFromElement(e){var t={};for(var i in _defaults2$1.default)_defaults2$1.default.hasOwnProperty(i)&&(e.hasAttribute("jsbarcode-"+i.toLowerCase())&&(t[i]=e.getAttribute("jsbarcode-"+i.toLowerCase())),e.hasAttribute("data-"+i.toLowerCase())&&(t[i]=e.getAttribute("data-"+i.toLowerCase())));return t.value=e.getAttribute("jsbarcode-value")||e.getAttribute("data-value"),t=(0,_optionsFromStrings2$1.default)(t)}var _default$6=getOptionsFromElement,getOptionsFromElement_1=Object.defineProperty({default:_default$6},"__esModule",{value:!0}),shared=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getTotalWidthOfEncodings=t.calculateEncodingAttributes=t.getBarcodePadding=t.getEncodingHeight=t.getMaximumHeightOfEncodings=void 0;var i,r=(i=merge)&&i.__esModule?i:{default:i};function s(e,t){return t.height+(t.displayValue&&e.text.length>0?t.fontSize+t.textMargin:0)+t.marginTop+t.marginBottom}function n(e,t,i){if(i.displayValue&&t<e){if("center"==i.textAlign)return Math.floor((e-t)/2);if("left"==i.textAlign)return 0;if("right"==i.textAlign)return Math.floor(e-t)}return 0}function o(e,t,i){var r;if(i)r=i;else{if("undefined"==typeof document)return 0;r=document.createElement("canvas").getContext("2d")}r.font=t.fontOptions+" "+t.fontSize+"px "+t.font;var s=r.measureText(e);return s?s.width:0}t.getMaximumHeightOfEncodings=function(e){for(var t=0,i=0;i<e.length;i++)e[i].height>t&&(t=e[i].height);return t},t.getEncodingHeight=s,t.getBarcodePadding=n,t.calculateEncodingAttributes=function(e,t,i){for(var a=0;a<e.length;a++){var A,l=e[a],h=(0,r.default)(t,l.options);A=h.displayValue?o(l.text,h,i):0;var d=l.data.length*h.width;l.width=Math.ceil(Math.max(A,d)),l.height=s(l,h),l.barcodePadding=n(A,d,h)}},t.getTotalWidthOfEncodings=function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i].width;return t}})),_createClass$3=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_merge2$2=_interopRequireDefault$4(merge);function _interopRequireDefault$4(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var CanvasRenderer$1=function(){function e(t,i,r){_classCallCheck$4(this,e),this.canvas=t,this.encodings=i,this.options=r}return _createClass$3(e,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var e=0;e<this.encodings.length;e++){var t=(0,_merge2$2.default)(this.options,this.encodings[e].options);this.drawCanvasBarcode(t,this.encodings[e]),this.drawCanvasText(t,this.encodings[e]),this.moveCanvasDrawing(this.encodings[e])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var e=this.canvas.getContext("2d");e.save(),(0,shared.calculateEncodingAttributes)(this.encodings,this.options,e);var t=(0,shared.getTotalWidthOfEncodings)(this.encodings),i=(0,shared.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=t+this.options.marginLeft+this.options.marginRight,this.canvas.height=i,e.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(e.fillStyle=this.options.background,e.fillRect(0,0,this.canvas.width,this.canvas.height)),e.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(e,t){var i,r=this.canvas.getContext("2d"),s=t.data;i="top"==e.textPosition?e.marginTop+e.fontSize+e.textMargin:e.marginTop,r.fillStyle=e.lineColor;for(var n=0;n<s.length;n++){var o=n*e.width+t.barcodePadding;"1"===s[n]?r.fillRect(o,i,e.width,e.height):s[n]&&r.fillRect(o,i,e.width,e.height*s[n])}}},{key:"drawCanvasText",value:function(e,t){var i,r,s=this.canvas.getContext("2d"),n=e.fontOptions+" "+e.fontSize+"px "+e.font;e.displayValue&&(r="top"==e.textPosition?e.marginTop+e.fontSize-e.textMargin:e.height+e.textMargin+e.marginTop+e.fontSize,s.font=n,"left"==e.textAlign||t.barcodePadding>0?(i=0,s.textAlign="left"):"right"==e.textAlign?(i=t.width-1,s.textAlign="right"):(i=t.width/2,s.textAlign="center"),s.fillText(t.text,i,r))}},{key:"moveCanvasDrawing",value:function(e){this.canvas.getContext("2d").translate(e.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),e}(),_default$5=CanvasRenderer$1,canvas=Object.defineProperty({default:_default$5},"__esModule",{value:!0}),_createClass$2=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_merge2$1=_interopRequireDefault$3(merge);function _interopRequireDefault$3(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck$3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var svgns="http://www.w3.org/2000/svg",SVGRenderer=function(){function e(t,i,r){_classCallCheck$3(this,e),this.svg=t,this.encodings=i,this.options=r,this.document=r.xmlDocument||document}return _createClass$2(e,[{key:"render",value:function(){var e=this.options.marginLeft;this.prepareSVG();for(var t=0;t<this.encodings.length;t++){var i=this.encodings[t],r=(0,_merge2$1.default)(this.options,i.options),s=this.createGroup(e,r.marginTop,this.svg);this.setGroupOptions(s,r),this.drawSvgBarcode(s,r,i),this.drawSVGText(s,r,i),e+=i.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,shared.calculateEncodingAttributes)(this.encodings,this.options);var e=(0,shared.getTotalWidthOfEncodings)(this.encodings),t=(0,shared.getMaximumHeightOfEncodings)(this.encodings),i=e+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(i,t),this.options.background&&this.drawRect(0,0,i,t,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(e,t,i){var r,s=i.data;r="top"==t.textPosition?t.fontSize+t.textMargin:0;for(var n=0,o=0,a=0;a<s.length;a++)o=a*t.width+i.barcodePadding,"1"===s[a]?n++:n>0&&(this.drawRect(o-t.width*n,r,t.width*n,t.height,e),n=0);n>0&&this.drawRect(o-t.width*(n-1),r,t.width*n,t.height,e)}},{key:"drawSVGText",value:function(e,t,i){var r,s,n=this.document.createElementNS(svgns,"text");t.displayValue&&(n.setAttribute("style","font:"+t.fontOptions+" "+t.fontSize+"px "+t.font),s="top"==t.textPosition?t.fontSize-t.textMargin:t.height+t.textMargin+t.fontSize,"left"==t.textAlign||i.barcodePadding>0?(r=0,n.setAttribute("text-anchor","start")):"right"==t.textAlign?(r=i.width-1,n.setAttribute("text-anchor","end")):(r=i.width/2,n.setAttribute("text-anchor","middle")),n.setAttribute("x",r),n.setAttribute("y",s),n.appendChild(this.document.createTextNode(i.text)),e.appendChild(n))}},{key:"setSvgAttributes",value:function(e,t){var i=this.svg;i.setAttribute("width",e+"px"),i.setAttribute("height",t+"px"),i.setAttribute("x","0px"),i.setAttribute("y","0px"),i.setAttribute("viewBox","0 0 "+e+" "+t),i.setAttribute("xmlns",svgns),i.setAttribute("version","1.1"),i.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(e,t,i){var r=this.document.createElementNS(svgns,"g");return r.setAttribute("transform","translate("+e+", "+t+")"),i.appendChild(r),r}},{key:"setGroupOptions",value:function(e,t){e.setAttribute("style","fill:"+t.lineColor+";")}},{key:"drawRect",value:function(e,t,i,r,s){var n=this.document.createElementNS(svgns,"rect");return n.setAttribute("x",e),n.setAttribute("y",t),n.setAttribute("width",i),n.setAttribute("height",r),s.appendChild(n),n}}]),e}(),_default$4=SVGRenderer,svg=Object.defineProperty({default:_default$4},"__esModule",{value:!0}),_createClass$1=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();function _classCallCheck$2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ObjectRenderer=function(){function e(t,i,r){_classCallCheck$2(this,e),this.object=t,this.encodings=i,this.options=r}return _createClass$1(e,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),e}(),_default$3=ObjectRenderer,object=Object.defineProperty({default:_default$3},"__esModule",{value:!0}),_canvas2=_interopRequireDefault$2(canvas),_svg2=_interopRequireDefault$2(svg),_object2=_interopRequireDefault$2(object);function _interopRequireDefault$2(e){return e&&e.__esModule?e:{default:e}}var _default$2={CanvasRenderer:_canvas2.default,SVGRenderer:_svg2.default,ObjectRenderer:_object2.default},renderers=Object.defineProperty({default:_default$2},"__esModule",{value:!0});function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var InvalidInputException=function(e){function t(e,i){_classCallCheck$1(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.name="InvalidInputException",r.symbology=e,r.input=i,r.message='"'+r.input+'" is not a valid input for '+r.symbology,r}return _inherits(t,Error),t}(),InvalidElementException=function(e){function t(){_classCallCheck$1(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="InvalidElementException",e.message="Not supported type to render on",e}return _inherits(t,Error),t}(),NoElementException=function(e){function t(){_classCallCheck$1(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.name="NoElementException",e.message="No element to render on.",e}return _inherits(t,Error),t}(),InvalidInputException_1=InvalidInputException,InvalidElementException_1=InvalidElementException,NoElementException_1=NoElementException,exceptions=Object.defineProperty({InvalidInputException:InvalidInputException_1,InvalidElementException:InvalidElementException_1,NoElementException:NoElementException_1},"__esModule",{value:!0}),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_getOptionsFromElement2=_interopRequireDefault$1(getOptionsFromElement_1),_renderers2=_interopRequireDefault$1(renderers);function _interopRequireDefault$1(e){return e&&e.__esModule?e:{default:e}}function getRenderProperties(e){if("string"==typeof e)return querySelectedRenderProperties(e);if(Array.isArray(e)){for(var t=[],i=0;i<e.length;i++)t.push(getRenderProperties(e[i]));return t}if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLImageElement)return newCanvasRenderProperties(e);if(e&&e.nodeName&&"svg"===e.nodeName.toLowerCase()||"undefined"!=typeof SVGElement&&e instanceof SVGElement)return{element:e,options:(0,_getOptionsFromElement2.default)(e),renderer:_renderers2.default.SVGRenderer};if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement)return{element:e,options:(0,_getOptionsFromElement2.default)(e),renderer:_renderers2.default.CanvasRenderer};if(e&&e.getContext)return{element:e,renderer:_renderers2.default.CanvasRenderer};if(e&&"object"===(void 0===e?"undefined":_typeof(e))&&!e.nodeName)return{element:e,renderer:_renderers2.default.ObjectRenderer};throw new exceptions.InvalidElementException}function querySelectedRenderProperties(e){var t=document.querySelectorAll(e);if(0!==t.length){for(var i=[],r=0;r<t.length;r++)i.push(getRenderProperties(t[r]));return i}}function newCanvasRenderProperties(e){var t=document.createElement("canvas");return{element:t,options:(0,_getOptionsFromElement2.default)(e),renderer:_renderers2.default.CanvasRenderer,afterRender:function(){e.setAttribute("src",t.toDataURL())}}}var _default$1=getRenderProperties,getRenderProperties_1=Object.defineProperty({default:_default$1},"__esModule",{value:!0}),_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ErrorHandler=function(){function e(t){_classCallCheck(this,e),this.api=t}return _createClass(e,[{key:"handleCatch",value:function(e){if("InvalidInputException"!==e.name)throw e;if(this.api._options.valid===this.api._defaults.valid)throw e.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(e){try{var t=e.apply(void 0,arguments);return this.api._options.valid(!0),t}catch(e){return this.handleCatch(e),this.api}}}]),e}(),_default=ErrorHandler,ErrorHandler_1=Object.defineProperty({default:_default},"__esModule",{value:!0}),_barcodes2=_interopRequireDefault(barcodes),_merge2=_interopRequireDefault(merge),_linearizeEncodings2=_interopRequireDefault(linearizeEncodings_1),_fixOptions2=_interopRequireDefault(fixOptions_1),_getRenderProperties2=_interopRequireDefault(getRenderProperties_1),_optionsFromStrings2=_interopRequireDefault(optionsFromStrings_1),_ErrorHandler2=_interopRequireDefault(ErrorHandler_1),_defaults2=_interopRequireDefault(defaults_1);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var API=function(){},JsBarcode=function(e,t,i){var r=new API;if(void 0===e)throw Error("No element to render on was provided.");return r._renderProperties=(0,_getRenderProperties2.default)(e),r._encodings=[],r._options=_defaults2.default,r._errorHandler=new _ErrorHandler2.default(r),void 0!==t&&((i=i||{}).format||(i.format=autoSelectBarcode()),r.options(i)[i.format](t,i).render()),r};for(var name$1 in JsBarcode.getModule=function(e){return _barcodes2.default[e]},_barcodes2.default)_barcodes2.default.hasOwnProperty(name$1)&&registerBarcode(_barcodes2.default,name$1);function registerBarcode(e,t){API.prototype[t]=API.prototype[t.toUpperCase()]=API.prototype[t.toLowerCase()]=function(i,r){var s=this;return s._errorHandler.wrapBarcodeCall((function(){r.text=void 0===r.text?void 0:""+r.text;var n=(0,_merge2.default)(s._options,r);n=(0,_optionsFromStrings2.default)(n);var o=e[t],a=encode(i,o,n);return s._encodings.push(a),s}))}}function encode(e,t,i){var r=new t(e=""+e,i);if(!r.valid())throw new exceptions.InvalidInputException(r.constructor.name,e);var s=r.encode();s=(0,_linearizeEncodings2.default)(s);for(var n=0;n<s.length;n++)s[n].options=(0,_merge2.default)(i,s[n].options);return s}function autoSelectBarcode(){return _barcodes2.default.CODE128?"CODE128":Object.keys(_barcodes2.default)[0]}function render(e,t,i){t=(0,_linearizeEncodings2.default)(t);for(var r=0;r<t.length;r++)t[r].options=(0,_merge2.default)(i,t[r].options),(0,_fixOptions2.default)(t[r].options);(0,_fixOptions2.default)(i),new(0,e.renderer)(e.element,t,i).render(),e.afterRender&&e.afterRender()}API.prototype.options=function(e){return this._options=(0,_merge2.default)(this._options,e),this},API.prototype.blank=function(e){var t=new Array(e+1).join("0");return this._encodings.push({data:t}),this},API.prototype.init=function(){var e;if(this._renderProperties)for(var t in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){e=this._renderProperties[t];var i=(0,_merge2.default)(this._options,e.options);"auto"==i.format&&(i.format=autoSelectBarcode()),this._errorHandler.wrapBarcodeCall((function(){var t=encode(i.value,_barcodes2.default[i.format.toUpperCase()],i);render(e,t,i)}))}},API.prototype.render=function(){if(!this._renderProperties)throw new exceptions.NoElementException;if(Array.isArray(this._renderProperties))for(var e=0;e<this._renderProperties.length;e++)render(this._renderProperties[e],this._encodings,this._options);else render(this._renderProperties,this._encodings,this._options);return this},API.prototype._defaults=_defaults2.default,"undefined"!=typeof window&&(window.JsBarcode=JsBarcode),"undefined"!=typeof jQuery&&(jQuery.fn.JsBarcode=function(e,t){var i=[];return jQuery(this).each((function(){i.push(this)})),JsBarcode(i,e,t)});var JsBarcode_1=JsBarcode;class BarcodeItemElement extends ReportItemElement{constructor(e,t){super(e,t,"barcodeItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-barcode rr-item-element"}get debugLabel(){return""}isDom(e){return super.isDom(e)||this.dom.contains(e)}_initDom(e,t){super._initDom(e,t),t.style.textAlign="center",t.appendChild(this._svg=e.createElementNS(SVGNS,"svg")),Object.assign(this._svg.style,{height:"100%",background:"",border:"none",pointerEvents:"none"})}_doMeasure(e,t,i,r){const s=this.model,n=getComputedStyle(t),o=this._svg,a=this.$_getText(e,s);let A="",l=0,h=0;this._setModelSize(s,t,i,r,!0),s.showText&&(A=n.fontFamily,l=parseFloat(n.fontSize),h=l+s.textMargin+1);const d=t.style,c=t.offsetWidth,u=(s.height?t.offsetHeight:60)-Utils.toInt(n.paddingTop)-Utils.toInt(n.paddingBottom);try{const e={format:s.format||BarcodeFormat.CODE128,displayValue:s.showText,margin:0,width:s.barWidth,height:u-h,font:A,fontSize:l,background:"transparent",textAlign:s.textAlign,textPosition:s.textPosition};d.color&&(e.lineColor=d.color),JsBarcode_1(o,a,e)}catch(e){console.error(e),t.style.backgroundColor="#ff000010",t.style.color="red",t.textContent=e}return e.printing&&SvgElement.prepareExport(this._svg,c,u),Size.create(t.offsetWidth,u)}$_getText(e,t){let i="";return t.value?(i=e.printing?this.getPrintValue(e,t):t.value,i=Utils.toStr(i)):t.text&&(i=t.text),i&&t.convertText(i)}}var qrCodeStyling=createCommonjsModule((function(e,t){self,e.exports=(()=>{var e={192:(e,t)=>{var i,r,s=function(){var e=function(e,t){var i=e,r=o[t],s=null,n=0,A=null,g=[],m={},w=function(e,t){s=function(e){for(var t=new Array(e),i=0;i<e;i+=1){t[i]=new Array(e);for(var r=0;r<e;r+=1)t[i][r]=null}return t}(n=4*i+17),C(0,0),C(n-7,0),C(0,n-7),E(),y(),B(e,t),i>=7&&b(e),null==A&&(A=S(i,r,g)),P(A,t)},C=function(e,t){for(var i=-1;i<=7;i+=1)if(!(e+i<=-1||n<=e+i))for(var r=-1;r<=7;r+=1)t+r<=-1||n<=t+r||(s[e+i][t+r]=0<=i&&i<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==i||6==i)||2<=i&&i<=4&&2<=r&&r<=4)},y=function(){for(var e=8;e<n-8;e+=1)null==s[e][6]&&(s[e][6]=e%2==0);for(var t=8;t<n-8;t+=1)null==s[6][t]&&(s[6][t]=t%2==0)},E=function(){for(var e=a.getPatternPosition(i),t=0;t<e.length;t+=1)for(var r=0;r<e.length;r+=1){var n=e[t],o=e[r];if(null==s[n][o])for(var A=-2;A<=2;A+=1)for(var l=-2;l<=2;l+=1)s[n+A][o+l]=-2==A||2==A||-2==l||2==l||0==A&&0==l}},b=function(e){for(var t=a.getBCHTypeNumber(i),r=0;r<18;r+=1){var o=!e&&1==(t>>r&1);s[Math.floor(r/3)][r%3+n-8-3]=o}for(r=0;r<18;r+=1)o=!e&&1==(t>>r&1),s[r%3+n-8-3][Math.floor(r/3)]=o},B=function(e,t){for(var i=r<<3|t,o=a.getBCHTypeInfo(i),A=0;A<15;A+=1){var l=!e&&1==(o>>A&1);A<6?s[A][8]=l:A<8?s[A+1][8]=l:s[n-15+A][8]=l}for(A=0;A<15;A+=1)l=!e&&1==(o>>A&1),A<8?s[8][n-A-1]=l:A<9?s[8][15-A-1+1]=l:s[8][15-A-1]=l;s[n-8][8]=!e},P=function(e,t){for(var i=-1,r=n-1,o=7,A=0,l=a.getMaskFunction(t),h=n-1;h>0;h-=2)for(6==h&&(h-=1);;){for(var d=0;d<2;d+=1)if(null==s[r][h-d]){var c=!1;A<e.length&&(c=1==(e[A]>>>o&1)),l(r,h-d)&&(c=!c),s[r][h-d]=c,-1==(o-=1)&&(A+=1,o=7)}if((r+=i)<0||n<=r){r-=i,i=-i;break}}},S=function(e,t,i){for(var r=h.getRSBlocks(e,t),s=d(),n=0;n<i.length;n+=1){var o=i[n];s.put(o.getMode(),4),s.put(o.getLength(),a.getLengthInBits(o.getMode(),e)),o.write(s)}var A=0;for(n=0;n<r.length;n+=1)A+=r[n].dataCount;if(s.getLengthInBits()>8*A)throw"code length overflow. ("+s.getLengthInBits()+">"+8*A+")";for(s.getLengthInBits()+4<=8*A&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=8*A||(s.put(236,8),s.getLengthInBits()>=8*A));)s.put(17,8);return function(e,t){for(var i=0,r=0,s=0,n=new Array(t.length),o=new Array(t.length),A=0;A<t.length;A+=1){var h=t[A].dataCount,d=t[A].totalCount-h;r=Math.max(r,h),s=Math.max(s,d),n[A]=new Array(h);for(var c=0;c<n[A].length;c+=1)n[A][c]=255&e.getBuffer()[c+i];i+=h;var u=a.getErrorCorrectPolynomial(d),p=l(n[A],u.getLength()-1).mod(u);for(o[A]=new Array(u.getLength()-1),c=0;c<o[A].length;c+=1){var _=c+p.getLength()-o[A].length;o[A][c]=_>=0?p.getAt(_):0}}var g=0;for(c=0;c<t.length;c+=1)g+=t[c].totalCount;var m=new Array(g),f=0;for(c=0;c<r;c+=1)for(A=0;A<t.length;A+=1)c<n[A].length&&(m[f]=n[A][c],f+=1);for(c=0;c<s;c+=1)for(A=0;A<t.length;A+=1)c<o[A].length&&(m[f]=o[A][c],f+=1);return m}(s,r)};m.addData=function(e,t){var i=null;switch(t=t||"Byte"){case"Numeric":i=c(e);break;case"Alphanumeric":i=u(e);break;case"Byte":i=p(e);break;case"Kanji":i=_(e);break;default:throw"mode:"+t}g.push(i),A=null},m.isDark=function(e,t){if(e<0||n<=e||t<0||n<=t)throw e+","+t;return s[e][t]},m.getModuleCount=function(){return n},m.make=function(){if(i<1){for(var e=1;e<40;e++){for(var t=h.getRSBlocks(e,r),s=d(),n=0;n<g.length;n++){var o=g[n];s.put(o.getMode(),4),s.put(o.getLength(),a.getLengthInBits(o.getMode(),e)),o.write(s)}var A=0;for(n=0;n<t.length;n++)A+=t[n].dataCount;if(s.getLengthInBits()<=8*A)break}i=e}w(!1,function(){for(var e=0,t=0,i=0;i<8;i+=1){w(!0,i);var r=a.getLostPoint(m);(0==i||e>r)&&(e=r,t=i)}return t}())},m.createTableTag=function(e,t){e=e||2;var i="";i+='<table style="',i+=" border-width: 0px; border-style: none;",i+=" border-collapse: collapse;",i+=" padding: 0px; margin: "+(t=void 0===t?4*e:t)+"px;",i+='">',i+="<tbody>";for(var r=0;r<m.getModuleCount();r+=1){i+="<tr>";for(var s=0;s<m.getModuleCount();s+=1)i+='<td style="',i+=" border-width: 0px; border-style: none;",i+=" border-collapse: collapse;",i+=" padding: 0px; margin: 0px;",i+=" width: "+e+"px;",i+=" height: "+e+"px;",i+=" background-color: ",i+=m.isDark(r,s)?"#000000":"#ffffff",i+=";",i+='"/>';i+="</tr>"}return(i+="</tbody>")+"</table>"},m.createSvgTag=function(e,t,i,r){var s={};"object"==typeof arguments[0]&&(e=(s=arguments[0]).cellSize,t=s.margin,i=s.alt,r=s.title),e=e||2,t=void 0===t?4*e:t,(i="string"==typeof i?{text:i}:i||{}).text=i.text||null,i.id=i.text?i.id||"qrcode-description":null,(r="string"==typeof r?{text:r}:r||{}).text=r.text||null,r.id=r.text?r.id||"qrcode-title":null;var n,o,a,A,l=m.getModuleCount()*e+2*t,h="";for(A="l"+e+",0 0,"+e+" -"+e+",0 0,-"+e+"z ",h+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',h+=s.scalable?"":' width="'+l+'px" height="'+l+'px"',h+=' viewBox="0 0 '+l+" "+l+'" ',h+=' preserveAspectRatio="xMinYMin meet"',h+=r.text||i.text?' role="img" aria-labelledby="'+v([r.id,i.id].join(" ").trim())+'"':"",h+=">",h+=r.text?'<title id="'+v(r.id)+'">'+v(r.text)+"</title>":"",h+=i.text?'<description id="'+v(i.id)+'">'+v(i.text)+"</description>":"",h+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',h+='<path d="',o=0;o<m.getModuleCount();o+=1)for(a=o*e+t,n=0;n<m.getModuleCount();n+=1)m.isDark(o,n)&&(h+="M"+(n*e+t)+","+a+A);return(h+='" stroke="transparent" fill="black"/>')+"</svg>"},m.createDataURL=function(e,t){e=e||2,t=void 0===t?4*e:t;var i=m.getModuleCount()*e+2*t,r=t,s=i-t;return f(i,i,(function(t,i){if(r<=t&&t<s&&r<=i&&i<s){var n=Math.floor((t-r)/e),o=Math.floor((i-r)/e);return m.isDark(o,n)?0:1}return 1}))},m.createImgTag=function(e,t,i){e=e||2,t=void 0===t?4*e:t;var r=m.getModuleCount()*e+2*t,s="";return s+="<img",s+=' src="',s+=m.createDataURL(e,t),s+='"',s+=' width="',s+=r,s+='"',s+=' height="',s+=r,s+='"',i&&(s+=' alt="',s+=v(i),s+='"'),s+"/>"};var v=function(e){for(var t="",i=0;i<e.length;i+=1){var r=e.charAt(i);switch(r){case"<":t+="&lt;";break;case">":t+="&gt;";break;case"&":t+="&amp;";break;case'"':t+="&quot;";break;default:t+=r}}return t};return m.createASCII=function(e,t){if((e=e||1)<2)return function(e){e=void 0===e?2:e;var t,i,r,s,n,o=1*m.getModuleCount()+2*e,a=e,A=o-e,l={"██":"█","█ ":"▀"," █":"▄","  ":" "},h={"██":"▀","█ ":"▀"," █":" ","  ":" "},d="";for(t=0;t<o;t+=2){for(r=Math.floor((t-a)/1),s=Math.floor((t+1-a)/1),i=0;i<o;i+=1)n="█",a<=i&&i<A&&a<=t&&t<A&&m.isDark(r,Math.floor((i-a)/1))&&(n=" "),a<=i&&i<A&&a<=t+1&&t+1<A&&m.isDark(s,Math.floor((i-a)/1))?n+=" ":n+="█",d+=e<1&&t+1>=A?h[n]:l[n];d+="\n"}return o%2&&e>0?d.substring(0,d.length-o-1)+Array(o+1).join("▀"):d.substring(0,d.length-1)}(t);e-=1,t=void 0===t?2*e:t;var i,r,s,n,o=m.getModuleCount()*e+2*t,a=t,A=o-t,l=Array(e+1).join("██"),h=Array(e+1).join("  "),d="",c="";for(i=0;i<o;i+=1){for(s=Math.floor((i-a)/e),c="",r=0;r<o;r+=1)n=1,a<=r&&r<A&&a<=i&&i<A&&m.isDark(s,Math.floor((r-a)/e))&&(n=0),c+=n?l:h;for(s=0;s<e;s+=1)d+=c+"\n"}return d.substring(0,d.length-1)},m.renderTo2dContext=function(e,t){t=t||2;for(var i=m.getModuleCount(),r=0;r<i;r++)for(var s=0;s<i;s++)e.fillStyle=m.isDark(r,s)?"black":"white",e.fillRect(r*t,s*t,t,t)},m};e.stringToBytes=(e.stringToBytesFuncs={default:function(e){for(var t=[],i=0;i<e.length;i+=1){var r=e.charCodeAt(i);t.push(255&r)}return t}}).default,e.createStringToBytes=function(e,t){var i=function(){for(var i=m(e),r=function(){var e=i.read();if(-1==e)throw"eof";return e},s=0,n={};;){var o=i.read();if(-1==o)break;var a=r(),A=r()<<8|r();n[String.fromCharCode(o<<8|a)]=A,s+=1}if(s!=t)throw s+" != "+t;return n}(),r="?".charCodeAt(0);return function(e){for(var t=[],s=0;s<e.length;s+=1){var n=e.charCodeAt(s);if(n<128)t.push(n);else{var o=i[e.charAt(s)];"number"==typeof o?(255&o)==o?t.push(o):(t.push(o>>>8),t.push(255&o)):t.push(r)}}return t}};var t,i,r,s,n,o={L:1,M:0,Q:3,H:2},a=(t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],i=1335,r=7973,n=function(e){for(var t=0;0!=e;)t+=1,e>>>=1;return t},(s={}).getBCHTypeInfo=function(e){for(var t=e<<10;n(t)-n(i)>=0;)t^=i<<n(t)-n(i);return 21522^(e<<10|t)},s.getBCHTypeNumber=function(e){for(var t=e<<12;n(t)-n(r)>=0;)t^=r<<n(t)-n(r);return e<<12|t},s.getPatternPosition=function(e){return t[e-1]},s.getMaskFunction=function(e){switch(e){case 0:return function(e,t){return(e+t)%2==0};case 1:return function(e,t){return e%2==0};case 2:return function(e,t){return t%3==0};case 3:return function(e,t){return(e+t)%3==0};case 4:return function(e,t){return(Math.floor(e/2)+Math.floor(t/3))%2==0};case 5:return function(e,t){return e*t%2+e*t%3==0};case 6:return function(e,t){return(e*t%2+e*t%3)%2==0};case 7:return function(e,t){return(e*t%3+(e+t)%2)%2==0};default:throw"bad maskPattern:"+e}},s.getErrorCorrectPolynomial=function(e){for(var t=l([1],0),i=0;i<e;i+=1)t=t.multiply(l([1,A.gexp(i)],0));return t},s.getLengthInBits=function(e,t){if(1<=t&&t<10)switch(e){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+e}else if(t<27)switch(e){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+e}else{if(!(t<41))throw"type:"+t;switch(e){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+e}}},s.getLostPoint=function(e){for(var t=e.getModuleCount(),i=0,r=0;r<t;r+=1)for(var s=0;s<t;s+=1){for(var n=0,o=e.isDark(r,s),a=-1;a<=1;a+=1)if(!(r+a<0||t<=r+a))for(var A=-1;A<=1;A+=1)s+A<0||t<=s+A||0==a&&0==A||o==e.isDark(r+a,s+A)&&(n+=1);n>5&&(i+=3+n-5)}for(r=0;r<t-1;r+=1)for(s=0;s<t-1;s+=1){var l=0;e.isDark(r,s)&&(l+=1),e.isDark(r+1,s)&&(l+=1),e.isDark(r,s+1)&&(l+=1),e.isDark(r+1,s+1)&&(l+=1),0!=l&&4!=l||(i+=3)}for(r=0;r<t;r+=1)for(s=0;s<t-6;s+=1)e.isDark(r,s)&&!e.isDark(r,s+1)&&e.isDark(r,s+2)&&e.isDark(r,s+3)&&e.isDark(r,s+4)&&!e.isDark(r,s+5)&&e.isDark(r,s+6)&&(i+=40);for(s=0;s<t;s+=1)for(r=0;r<t-6;r+=1)e.isDark(r,s)&&!e.isDark(r+1,s)&&e.isDark(r+2,s)&&e.isDark(r+3,s)&&e.isDark(r+4,s)&&!e.isDark(r+5,s)&&e.isDark(r+6,s)&&(i+=40);var h=0;for(s=0;s<t;s+=1)for(r=0;r<t;r+=1)e.isDark(r,s)&&(h+=1);return i+Math.abs(100*h/t/t-50)/5*10},s),A=function(){for(var e=new Array(256),t=new Array(256),i=0;i<8;i+=1)e[i]=1<<i;for(i=8;i<256;i+=1)e[i]=e[i-4]^e[i-5]^e[i-6]^e[i-8];for(i=0;i<255;i+=1)t[e[i]]=i;return{glog:function(e){if(e<1)throw"glog("+e+")";return t[e]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e[t]}}}();function l(e,t){if(void 0===e.length)throw e.length+"/"+t;var i=function(){for(var i=0;i<e.length&&0==e[i];)i+=1;for(var r=new Array(e.length-i+t),s=0;s<e.length-i;s+=1)r[s]=e[s+i];return r}(),r={getAt:function(e){return i[e]},getLength:function(){return i.length},multiply:function(e){for(var t=new Array(r.getLength()+e.getLength()-1),i=0;i<r.getLength();i+=1)for(var s=0;s<e.getLength();s+=1)t[i+s]^=A.gexp(A.glog(r.getAt(i))+A.glog(e.getAt(s)));return l(t,0)},mod:function(e){if(r.getLength()-e.getLength()<0)return r;for(var t=A.glog(r.getAt(0))-A.glog(e.getAt(0)),i=new Array(r.getLength()),s=0;s<r.getLength();s+=1)i[s]=r.getAt(s);for(s=0;s<e.getLength();s+=1)i[s]^=A.gexp(A.glog(e.getAt(s))+t);return l(i,0).mod(e)}};return r}var h=function(){var e=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t=function(e,t){var i={};return i.totalCount=e,i.dataCount=t,i},i={getRSBlocks:function(i,r){var s=function(t,i){switch(i){case o.L:return e[4*(t-1)+0];case o.M:return e[4*(t-1)+1];case o.Q:return e[4*(t-1)+2];case o.H:return e[4*(t-1)+3];default:return}}(i,r);if(void 0===s)throw"bad rs block @ typeNumber:"+i+"/errorCorrectionLevel:"+r;for(var n=s.length/3,a=[],A=0;A<n;A+=1)for(var l=s[3*A+0],h=s[3*A+1],d=s[3*A+2],c=0;c<l;c+=1)a.push(t(h,d));return a}};return i}(),d=function(){var e=[],t=0,i={getBuffer:function(){return e},getAt:function(t){var i=Math.floor(t/8);return 1==(e[i]>>>7-t%8&1)},put:function(e,t){for(var r=0;r<t;r+=1)i.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return t},putBit:function(i){var r=Math.floor(t/8);e.length<=r&&e.push(0),i&&(e[r]|=128>>>t%8),t+=1}};return i},c=function(e){var t=e,i={getMode:function(){return 1},getLength:function(e){return t.length},write:function(e){for(var i=t,s=0;s+2<i.length;)e.put(r(i.substring(s,s+3)),10),s+=3;s<i.length&&(i.length-s==1?e.put(r(i.substring(s,s+1)),4):i.length-s==2&&e.put(r(i.substring(s,s+2)),7))}},r=function(e){for(var t=0,i=0;i<e.length;i+=1)t=10*t+s(e.charAt(i));return t},s=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+e};return i},u=function(e){var t=e,i={getMode:function(){return 2},getLength:function(e){return t.length},write:function(e){for(var i=t,s=0;s+1<i.length;)e.put(45*r(i.charAt(s))+r(i.charAt(s+1)),11),s+=2;s<i.length&&e.put(r(i.charAt(s)),6)}},r=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);if("A"<=e&&e<="Z")return e.charCodeAt(0)-"A".charCodeAt(0)+10;switch(e){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+e}};return i},p=function(t){var i=e.stringToBytes(t);return{getMode:function(){return 4},getLength:function(e){return i.length},write:function(e){for(var t=0;t<i.length;t+=1)e.put(i[t],8)}}},_=function(t){var i=e.stringToBytesFuncs.SJIS;if(!i)throw"sjis not supported.";!function(e,t){var r=i("友");if(2!=r.length||38726!=(r[0]<<8|r[1]))throw"sjis not supported."}();var r=i(t);return{getMode:function(){return 8},getLength:function(e){return~~(r.length/2)},write:function(e){for(var t=r,i=0;i+1<t.length;){var s=(255&t[i])<<8|255&t[i+1];if(33088<=s&&s<=40956)s-=33088;else{if(!(57408<=s&&s<=60351))throw"illegal char at "+(i+1)+"/"+s;s-=49472}s=192*(s>>>8&255)+(255&s),e.put(s,13),i+=2}if(i<t.length)throw"illegal char at "+(i+1)}}},g=function(){var e=[],t={writeByte:function(t){e.push(255&t)},writeShort:function(e){t.writeByte(e),t.writeByte(e>>>8)},writeBytes:function(e,i,r){i=i||0,r=r||e.length;for(var s=0;s<r;s+=1)t.writeByte(e[s+i])},writeString:function(e){for(var i=0;i<e.length;i+=1)t.writeByte(e.charCodeAt(i))},toByteArray:function(){return e},toString:function(){var t="";t+="[";for(var i=0;i<e.length;i+=1)i>0&&(t+=","),t+=e[i];return t+"]"}};return t},m=function(e){var t=e,i=0,r=0,s=0,n={read:function(){for(;s<8;){if(i>=t.length){if(0==s)return-1;throw"unexpected end of file./"+s}var e=t.charAt(i);if(i+=1,"="==e)return s=0,-1;e.match(/^\s$/)||(r=r<<6|o(e.charCodeAt(0)),s+=6)}var n=r>>>s-8&255;return s-=8,n}},o=function(e){if(65<=e&&e<=90)return e-65;if(97<=e&&e<=122)return e-97+26;if(48<=e&&e<=57)return e-48+52;if(43==e)return 62;if(47==e)return 63;throw"c:"+e};return n},f=function(e,t,i){for(var r=function(e,t){var i=e,r=t,s=new Array(e*t),n={setPixel:function(e,t,r){s[t*i+e]=r},write:function(e){e.writeString("GIF87a"),e.writeShort(i),e.writeShort(r),e.writeByte(128),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(255),e.writeByte(255),e.writeByte(255),e.writeString(","),e.writeShort(0),e.writeShort(0),e.writeShort(i),e.writeShort(r),e.writeByte(0);var t=o(2);e.writeByte(2);for(var s=0;t.length-s>255;)e.writeByte(255),e.writeBytes(t,s,255),s+=255;e.writeByte(t.length-s),e.writeBytes(t,s,t.length-s),e.writeByte(0),e.writeString(";")}},o=function(e){for(var t=1<<e,i=1+(1<<e),r=e+1,n=a(),o=0;o<t;o+=1)n.add(String.fromCharCode(o));n.add(String.fromCharCode(t)),n.add(String.fromCharCode(i));var A,l,h,d=g(),c=(A=d,l=0,h=0,{write:function(e,t){if(e>>>t!=0)throw"length over";for(;l+t>=8;)A.writeByte(255&(e<<l|h)),t-=8-l,e>>>=8-l,h=0,l=0;h|=e<<l,l+=t},flush:function(){l>0&&A.writeByte(h)}});c.write(t,r);var u=0,p=String.fromCharCode(s[u]);for(u+=1;u<s.length;){var _=String.fromCharCode(s[u]);u+=1,n.contains(p+_)?p+=_:(c.write(n.indexOf(p),r),n.size()<4095&&(n.size()==1<<r&&(r+=1),n.add(p+_)),p=_)}return c.write(n.indexOf(p),r),c.write(i,r),c.flush(),d.toByteArray()},a=function(){var e={},t=0,i={add:function(r){if(i.contains(r))throw"dup key:"+r;e[r]=t,t+=1},size:function(){return t},indexOf:function(t){return e[t]},contains:function(t){return void 0!==e[t]}};return i};return n}(e,t),s=0;s<t;s+=1)for(var n=0;n<e;n+=1)r.setPixel(n,s,i(n,s));var o=g();r.write(o);for(var a=function(){var e=0,t=0,i=0,r="",s={},n=function(e){r+=String.fromCharCode(o(63&e))},o=function(e){if(e<0);else{if(e<26)return 65+e;if(e<52)return e-26+97;if(e<62)return e-52+48;if(62==e)return 43;if(63==e)return 47}throw"n:"+e};return s.writeByte=function(r){for(e=e<<8|255&r,t+=8,i+=1;t>=6;)n(e>>>t-6),t-=6},s.flush=function(){if(t>0&&(n(e<<6-t),e=0,t=0),i%3!=0)for(var s=3-i%3,o=0;o<s;o+=1)r+="="},s.toString=function(){return r},s}(),A=o.toByteArray(),l=0;l<A.length;l+=1)a.writeByte(A[l]);return a.flush(),"data:image/gif;base64,"+a};return e}();s.stringToBytesFuncs["UTF-8"]=function(e){return function(e){for(var t=[],i=0;i<e.length;i++){var r=e.charCodeAt(i);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(i++,r=65536+((1023&r)<<10|1023&e.charCodeAt(i)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t}(e)},void 0===(r="function"==typeof(i=function(){return s})?i.apply(t,[]):i)||(e.exports=r)},796:(e,t,i)=>{i.d(t,{default:()=>j});var r=function(){return(r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var r=Array(e),s=0;for(t=0;t<i;t++)for(var n=arguments[t],o=0,a=n.length;o<a;o++,s++)r[s]=n[o];return r},n=function(e){return!!e&&"object"==typeof e&&!Array.isArray(e)};function o(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(!t.length)return e;var a=t.shift();return void 0!==a&&n(e)&&n(a)?(e=r({},e),Object.keys(a).forEach((function(t){var i=e[t],r=a[t];Array.isArray(i)&&Array.isArray(r)?e[t]=r:n(i)&&n(r)?e[t]=o(Object.assign({},i),r):e[t]=r})),o.apply(void 0,s([e],t))):e}function a(e,t){var i=document.createElement("a");i.download=t,i.href=e,document.body.appendChild(i),i.click(),document.body.removeChild(i)}function A(e){var t=e.originalHeight,i=e.originalWidth,r=e.maxHiddenDots,s=e.maxHiddenAxisDots,n=e.dotSize,o={x:0,y:0},a={x:0,y:0};if(t<=0||i<=0||r<=0||n<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};var A=t/i;return o.x=Math.floor(Math.sqrt(r/A)),o.x<=0&&(o.x=1),s&&s<o.x&&(o.x=s),o.x%2==0&&o.x--,a.x=o.x*n,o.y=1+2*Math.ceil((o.x*A-1)/2),a.y=Math.round(a.x*A),(o.y*o.x>r||s&&s<o.y)&&(s&&s<o.y?(o.y=s,o.y%2==0&&o.x--):o.y-=2,a.y=o.y*n,o.x=1+2*Math.ceil((o.y/A-1)/2),a.x=Math.round(a.y/A)),{height:a.y,width:a.x,hideYDots:o.y,hideXDots:o.x}}const l={L:.07,M:.15,Q:.25,H:.3},h="dots",d="rounded",c="classy",u="classy-rounded",p="extra-rounded";var _=function(){return(_=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};const g=function(){function e(e){var t=e.context,i=e.type;this._context=t,this._type=i}return e.prototype.draw=function(e,t,i,r){var s,n=this._context;switch(this._type){case h:s=this._drawDot;break;case c:s=this._drawClassy;break;case u:s=this._drawClassyRounded;break;case d:s=this._drawRounded;break;case p:s=this._drawExtraRounded;break;default:s=this._drawSquare}s.call(this,{x:e,y:t,size:i,context:n,getNeighbor:r})},e.prototype._rotateFigure=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.rotation,o=void 0===n?0:n,a=e.draw,A=t+r/2,l=i+r/2;s.translate(A,l),o&&s.rotate(o),a(),s.closePath(),o&&s.rotate(-o),s.translate(-A,-l)},e.prototype._basicDot=function(e){var t=e.size,i=e.context;this._rotateFigure(_(_({},e),{draw:function(){i.arc(0,0,t/2,0,2*Math.PI)}}))},e.prototype._basicSquare=function(e){var t=e.size,i=e.context;this._rotateFigure(_(_({},e),{draw:function(){i.rect(-t/2,-t/2,t,t)}}))},e.prototype._basicSideRounded=function(e){var t=e.size,i=e.context;this._rotateFigure(_(_({},e),{draw:function(){i.arc(0,0,t/2,-Math.PI/2,Math.PI/2),i.lineTo(-t/2,t/2),i.lineTo(-t/2,-t/2),i.lineTo(0,-t/2)}}))},e.prototype._basicCornerRounded=function(e){var t=e.size,i=e.context;this._rotateFigure(_(_({},e),{draw:function(){i.arc(0,0,t/2,-Math.PI/2,0),i.lineTo(t/2,t/2),i.lineTo(-t/2,t/2),i.lineTo(-t/2,-t/2),i.lineTo(0,-t/2)}}))},e.prototype._basicCornerExtraRounded=function(e){var t=e.size,i=e.context;this._rotateFigure(_(_({},e),{draw:function(){i.arc(-t/2,t/2,t,-Math.PI/2,0),i.lineTo(-t/2,t/2),i.lineTo(-t/2,-t/2)}}))},e.prototype._basicCornersRounded=function(e){var t=e.size,i=e.context;this._rotateFigure(_(_({},e),{draw:function(){i.arc(0,0,t/2,-Math.PI/2,0),i.lineTo(t/2,t/2),i.lineTo(0,t/2),i.arc(0,0,t/2,Math.PI/2,Math.PI),i.lineTo(-t/2,-t/2),i.lineTo(0,-t/2)}}))},e.prototype._basicCornersExtraRounded=function(e){var t=e.size,i=e.context;this._rotateFigure(_(_({},e),{draw:function(){i.arc(-t/2,t/2,t,-Math.PI/2,0),i.arc(t/2,-t/2,t,Math.PI/2,Math.PI)}}))},e.prototype._drawDot=function(e){var t=e.x,i=e.y,r=e.size,s=e.context;this._basicDot({x:t,y:i,size:r,context:s,rotation:0})},e.prototype._drawSquare=function(e){var t=e.x,i=e.y,r=e.size,s=e.context;this._basicSquare({x:t,y:i,size:r,context:s,rotation:0})},e.prototype._drawRounded=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.getNeighbor,o=n?+n(-1,0):0,a=n?+n(1,0):0,A=n?+n(0,-1):0,l=n?+n(0,1):0,h=o+a+A+l;if(0!==h)if(h>2||o&&a||A&&l)this._basicSquare({x:t,y:i,size:r,context:s,rotation:0});else{if(2===h){var d=0;return o&&A?d=Math.PI/2:A&&a?d=Math.PI:a&&l&&(d=-Math.PI/2),void this._basicCornerRounded({x:t,y:i,size:r,context:s,rotation:d})}if(1===h)return d=0,A?d=Math.PI/2:a?d=Math.PI:l&&(d=-Math.PI/2),void this._basicSideRounded({x:t,y:i,size:r,context:s,rotation:d})}else this._basicDot({x:t,y:i,size:r,context:s,rotation:0})},e.prototype._drawExtraRounded=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.getNeighbor,o=n?+n(-1,0):0,a=n?+n(1,0):0,A=n?+n(0,-1):0,l=n?+n(0,1):0,h=o+a+A+l;if(0!==h)if(h>2||o&&a||A&&l)this._basicSquare({x:t,y:i,size:r,context:s,rotation:0});else{if(2===h){var d=0;return o&&A?d=Math.PI/2:A&&a?d=Math.PI:a&&l&&(d=-Math.PI/2),void this._basicCornerExtraRounded({x:t,y:i,size:r,context:s,rotation:d})}if(1===h)return d=0,A?d=Math.PI/2:a?d=Math.PI:l&&(d=-Math.PI/2),void this._basicSideRounded({x:t,y:i,size:r,context:s,rotation:d})}else this._basicDot({x:t,y:i,size:r,context:s,rotation:0})},e.prototype._drawClassy=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.getNeighbor,o=n?+n(-1,0):0,a=n?+n(1,0):0,A=n?+n(0,-1):0,l=n?+n(0,1):0;0!==o+a+A+l?o||A?a||l?this._basicSquare({x:t,y:i,size:r,context:s,rotation:0}):this._basicCornerRounded({x:t,y:i,size:r,context:s,rotation:Math.PI/2}):this._basicCornerRounded({x:t,y:i,size:r,context:s,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:i,size:r,context:s,rotation:Math.PI/2})},e.prototype._drawClassyRounded=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.getNeighbor,o=n?+n(-1,0):0,a=n?+n(1,0):0,A=n?+n(0,-1):0,l=n?+n(0,1):0;0!==o+a+A+l?o||A?a||l?this._basicSquare({x:t,y:i,size:r,context:s,rotation:0}):this._basicCornerExtraRounded({x:t,y:i,size:r,context:s,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:t,y:i,size:r,context:s,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:i,size:r,context:s,rotation:Math.PI/2})},e}(),m="square",f="extra-rounded";var w=function(){return(w=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};const C=function(){function e(e){var t=e.context,i=e.type;this._context=t,this._type=i}return e.prototype.draw=function(e,t,i,r){var s,n=this._context;switch(this._type){case m:s=this._drawSquare;break;case f:s=this._drawExtraRounded;break;default:s=this._drawDot}s.call(this,{x:e,y:t,size:i,context:n,rotation:r})},e.prototype._rotateFigure=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.rotation,o=void 0===n?0:n,a=e.draw,A=t+r/2,l=i+r/2;s.translate(A,l),o&&s.rotate(o),a(),s.closePath(),o&&s.rotate(-o),s.translate(-A,-l)},e.prototype._basicDot=function(e){var t=e.size,i=e.context,r=t/7;this._rotateFigure(w(w({},e),{draw:function(){i.arc(0,0,t/2,0,2*Math.PI),i.arc(0,0,t/2-r,0,2*Math.PI)}}))},e.prototype._basicSquare=function(e){var t=e.size,i=e.context,r=t/7;this._rotateFigure(w(w({},e),{draw:function(){i.rect(-t/2,-t/2,t,t),i.rect(-t/2+r,-t/2+r,t-2*r,t-2*r)}}))},e.prototype._basicExtraRounded=function(e){var t=e.size,i=e.context,r=t/7;this._rotateFigure(w(w({},e),{draw:function(){i.arc(-r,-r,2.5*r,Math.PI,-Math.PI/2),i.lineTo(r,-3.5*r),i.arc(r,-r,2.5*r,-Math.PI/2,0),i.lineTo(3.5*r,-r),i.arc(r,r,2.5*r,0,Math.PI/2),i.lineTo(-r,3.5*r),i.arc(-r,r,2.5*r,Math.PI/2,Math.PI),i.lineTo(-3.5*r,-r),i.arc(-r,-r,1.5*r,Math.PI,-Math.PI/2),i.lineTo(r,-2.5*r),i.arc(r,-r,1.5*r,-Math.PI/2,0),i.lineTo(2.5*r,-r),i.arc(r,r,1.5*r,0,Math.PI/2),i.lineTo(-r,2.5*r),i.arc(-r,r,1.5*r,Math.PI/2,Math.PI),i.lineTo(-2.5*r,-r)}}))},e.prototype._drawDot=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.rotation;this._basicDot({x:t,y:i,size:r,context:s,rotation:n})},e.prototype._drawSquare=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.rotation;this._basicSquare({x:t,y:i,size:r,context:s,rotation:n})},e.prototype._drawExtraRounded=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.rotation;this._basicExtraRounded({x:t,y:i,size:r,context:s,rotation:n})},e}(),y="square";var E=function(){return(E=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};const b=function(){function e(e){var t=e.context,i=e.type;this._context=t,this._type=i}return e.prototype.draw=function(e,t,i,r){var s=this._context;(this._type===y?this._drawSquare:this._drawDot).call(this,{x:e,y:t,size:i,context:s,rotation:r})},e.prototype._rotateFigure=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.rotation,o=void 0===n?0:n,a=e.draw,A=t+r/2,l=i+r/2;s.translate(A,l),o&&s.rotate(o),a(),s.closePath(),o&&s.rotate(-o),s.translate(-A,-l)},e.prototype._basicDot=function(e){var t=e.size,i=e.context;this._rotateFigure(E(E({},e),{draw:function(){i.arc(0,0,t/2,0,2*Math.PI)}}))},e.prototype._basicSquare=function(e){var t=e.size,i=e.context;this._rotateFigure(E(E({},e),{draw:function(){i.rect(-t/2,-t/2,t,t)}}))},e.prototype._drawDot=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.rotation;this._basicDot({x:t,y:i,size:r,context:s,rotation:n})},e.prototype._drawSquare=function(e){var t=e.x,i=e.y,r=e.size,s=e.context,n=e.rotation;this._basicSquare({x:t,y:i,size:r,context:s,rotation:n})},e}(),B="radial";var P=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],S=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];const v=function(){function e(e){this._canvas=document.createElement("canvas"),this._canvas.width=e.width,this._canvas.height=e.height,this._options=e}return Object.defineProperty(e.prototype,"context",{get:function(){return this._canvas.getContext("2d")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._canvas.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._canvas.height},enumerable:!1,configurable:!0}),e.prototype.getCanvas=function(){return this._canvas},e.prototype.clear=function(){var e=this.context;e&&e.clearRect(0,0,this._canvas.width,this._canvas.height)},e.prototype.drawQR=function(e){return t=this,i=void 0,s=function(){var t,i,r,s,n,o,a,h,d,c=this;return function(e,t){var i,r,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,r&&(s=2&n[0]?r.return:n[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,n[1])).done)return s;switch(r=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,r=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){o.label=n[1];break}if(6===n[0]&&o.label<s[1]){o.label=s[1],s=n;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(n);break}s[2]&&o.ops.pop(),o.trys.pop();continue}n=t.call(e,o)}catch(e){n=[6,e],r=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}(this,(function(u){switch(u.label){case 0:return t=e.getModuleCount(),i=Math.min(this._options.width,this._options.height)-2*this._options.margin,r=Math.floor(i/t),s={hideXDots:0,hideYDots:0,width:0,height:0},this._qr=e,this._options.image?[4,this.loadImage()]:[3,2];case 1:if(u.sent(),!this._image)return[2];n=this._options,o=n.imageOptions,a=n.qrOptions,h=o.imageSize*l[a.errorCorrectionLevel],d=Math.floor(h*t*t),s=A({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:d,maxHiddenAxisDots:t-14,dotSize:r}),u.label=2;case 2:return this.clear(),this.drawBackground(),this.drawDots((function(e,i){var r,n,o,a,A,l;return!(c._options.imageOptions.hideBackgroundDots&&e>=(t-s.hideXDots)/2&&e<(t+s.hideXDots)/2&&i>=(t-s.hideYDots)/2&&i<(t+s.hideYDots)/2||(null===(r=P[e])||void 0===r?void 0:r[i])||(null===(n=P[e-t+7])||void 0===n?void 0:n[i])||(null===(o=P[e])||void 0===o?void 0:o[i-t+7])||(null===(a=S[e])||void 0===a?void 0:a[i])||(null===(A=S[e-t+7])||void 0===A?void 0:A[i])||(null===(l=S[e])||void 0===l?void 0:l[i-t+7]))})),this.drawCorners(),this._options.image&&this.drawImage({width:s.width,height:s.height,count:t,dotSize:r}),[2]}}))},new((r=void 0)||(r=Promise))((function(e,n){function o(e){try{A(s.next(e))}catch(e){n(e)}}function a(e){try{A(s.throw(e))}catch(e){n(e)}}function A(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,a)}A((s=s.apply(t,i||[])).next())}));var t,i,r,s},e.prototype.drawBackground=function(){var e=this.context,t=this._options;if(e){if(t.backgroundOptions.gradient){var i=t.backgroundOptions.gradient,r=this._createGradient({context:e,options:i,additionalRotation:0,x:0,y:0,size:this._canvas.width>this._canvas.height?this._canvas.width:this._canvas.height});i.colorStops.forEach((function(e){var t=e.offset,i=e.color;r.addColorStop(t,i)})),e.fillStyle=r}else t.backgroundOptions.color&&(e.fillStyle=t.backgroundOptions.color);e.fillRect(0,0,this._canvas.width,this._canvas.height)}},e.prototype.drawDots=function(e){var t=this;if(!this._qr)throw"QR code is not defined";var i=this.context;if(!i)throw"QR code is not defined";var r=this._options,s=this._qr.getModuleCount();if(s>r.width||s>r.height)throw"The canvas is too small.";var n=Math.min(r.width,r.height)-2*r.margin,o=Math.floor(n/s),a=Math.floor((r.width-s*o)/2),A=Math.floor((r.height-s*o)/2),l=new g({context:i,type:r.dotsOptions.type});i.beginPath();for(var h=function(i){for(var r=function(r){return e&&!e(i,r)?"continue":d._qr.isDark(i,r)?void l.draw(a+i*o,A+r*o,o,(function(n,o){return!(i+n<0||r+o<0||i+n>=s||r+o>=s)&&!(e&&!e(i+n,r+o))&&!!t._qr&&t._qr.isDark(i+n,r+o)})):"continue"},n=0;n<s;n++)r(n)},d=this,c=0;c<s;c++)h(c);if(r.dotsOptions.gradient){var u=r.dotsOptions.gradient,p=this._createGradient({context:i,options:u,additionalRotation:0,x:a,y:A,size:s*o});u.colorStops.forEach((function(e){var t=e.offset,i=e.color;p.addColorStop(t,i)})),i.fillStyle=i.strokeStyle=p}else r.dotsOptions.color&&(i.fillStyle=i.strokeStyle=r.dotsOptions.color);i.fill("evenodd")},e.prototype.drawCorners=function(e){var t=this;if(!this._qr)throw"QR code is not defined";var i=this.context;if(!i)throw"QR code is not defined";var r=this._options,s=this._qr.getModuleCount(),n=Math.min(r.width,r.height)-2*r.margin,o=Math.floor(n/s),a=7*o,A=3*o,l=Math.floor((r.width-s*o)/2),h=Math.floor((r.height-s*o)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach((function(n){var d,c,u,p,_,m,f,w,y,E,B=n[0],v=n[1],R=n[2];if(!e||e(B,v)){var I=l+B*o*(s-7),T=h+v*o*(s-7);if(null===(d=r.cornersSquareOptions)||void 0===d?void 0:d.type){var x=new C({context:i,type:null===(c=r.cornersSquareOptions)||void 0===c?void 0:c.type});i.beginPath(),x.draw(I,T,a,R)}else{var O=new g({context:i,type:r.dotsOptions.type});i.beginPath();for(var D=function(e){for(var t=function(t){if(!(null===(u=P[e])||void 0===u?void 0:u[t]))return"continue";O.draw(I+e*o,T+t*o,o,(function(i,r){var s;return!!(null===(s=P[e+i])||void 0===s?void 0:s[t+r])}))},i=0;i<P[e].length;i++)t(i)},L=0;L<P.length;L++)D(L)}if(null===(p=r.cornersSquareOptions)||void 0===p?void 0:p.gradient){var F=r.cornersSquareOptions.gradient,H=t._createGradient({context:i,options:F,additionalRotation:R,x:I,y:T,size:a});F.colorStops.forEach((function(e){var t=e.offset,i=e.color;H.addColorStop(t,i)})),i.fillStyle=i.strokeStyle=H}else(null===(_=r.cornersSquareOptions)||void 0===_?void 0:_.color)&&(i.fillStyle=i.strokeStyle=r.cornersSquareOptions.color);if(i.fill("evenodd"),null===(m=r.cornersDotOptions)||void 0===m?void 0:m.type){var N=new b({context:i,type:null===(f=r.cornersDotOptions)||void 0===f?void 0:f.type});i.beginPath(),N.draw(I+2*o,T+2*o,A,R)}else{O=new g({context:i,type:r.dotsOptions.type}),i.beginPath();var U=function(e){for(var t=function(t){if(!(null===(w=S[e])||void 0===w?void 0:w[t]))return"continue";O.draw(I+e*o,T+t*o,o,(function(i,r){var s;return!!(null===(s=S[e+i])||void 0===s?void 0:s[t+r])}))},i=0;i<S[e].length;i++)t(i)};for(L=0;L<S.length;L++)U(L)}if(null===(y=r.cornersDotOptions)||void 0===y?void 0:y.gradient){F=r.cornersDotOptions.gradient;var M=t._createGradient({context:i,options:F,additionalRotation:R,x:I+2*o,y:T+2*o,size:A});F.colorStops.forEach((function(e){var t=e.offset,i=e.color;M.addColorStop(t,i)})),i.fillStyle=i.strokeStyle=M}else(null===(E=r.cornersDotOptions)||void 0===E?void 0:E.color)&&(i.fillStyle=i.strokeStyle=r.cornersDotOptions.color);i.fill("evenodd")}}))},e.prototype.loadImage=function(){var e=this;return new Promise((function(t,i){var r=e._options,s=new Image;if(!r.image)return i("Image is not defined");"string"==typeof r.imageOptions.crossOrigin&&(s.crossOrigin=r.imageOptions.crossOrigin),e._image=s,s.onload=function(){t()},s.src=r.image}))},e.prototype.drawImage=function(e){var t=e.width,i=e.height,r=e.count,s=e.dotSize,n=this.context;if(!n)throw"canvasContext is not defined";if(!this._image)throw"image is not defined";var o=this._options,a=Math.floor((o.width-r*s)/2),A=Math.floor((o.height-r*s)/2),l=a+o.imageOptions.margin+(r*s-t)/2,h=A+o.imageOptions.margin+(r*s-i)/2,d=t-2*o.imageOptions.margin,c=i-2*o.imageOptions.margin;n.drawImage(this._image,l,h,d<0?0:d,c<0?0:c)},e.prototype._createGradient=function(e){var t,i=e.context,r=e.options,s=e.additionalRotation,n=e.x,o=e.y,a=e.size;if(r.type===B)t=i.createRadialGradient(n+a/2,o+a/2,0,n+a/2,o+a/2,a/2);else{var A=((r.rotation||0)+s)%(2*Math.PI),l=(A+2*Math.PI)%(2*Math.PI),h=n+a/2,d=o+a/2,c=n+a/2,u=o+a/2;l>=0&&l<=.25*Math.PI||l>1.75*Math.PI&&l<=2*Math.PI?(h-=a/2,d-=a/2*Math.tan(A),c+=a/2,u+=a/2*Math.tan(A)):l>.25*Math.PI&&l<=.75*Math.PI?(d-=a/2,h-=a/2/Math.tan(A),u+=a/2,c+=a/2/Math.tan(A)):l>.75*Math.PI&&l<=1.25*Math.PI?(h+=a/2,d+=a/2*Math.tan(A),c-=a/2,u-=a/2*Math.tan(A)):l>1.25*Math.PI&&l<=1.75*Math.PI&&(d+=a/2,h+=a/2/Math.tan(A),u-=a/2,c-=a/2/Math.tan(A)),t=i.createLinearGradient(Math.round(h),Math.round(d),Math.round(c),Math.round(u))}return t},e}();var R=function(){return(R=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};const I=function(){function e(e){var t=e.svg,i=e.type;this._svg=t,this._type=i}return e.prototype.draw=function(e,t,i,r){var s;switch(this._type){case h:s=this._drawDot;break;case c:s=this._drawClassy;break;case u:s=this._drawClassyRounded;break;case d:s=this._drawRounded;break;case p:s=this._drawExtraRounded;break;default:s=this._drawSquare}s.call(this,{x:e,y:t,size:i,getNeighbor:r})},e.prototype._rotateFigure=function(e){var t,i=e.x,r=e.y,s=e.size,n=e.rotation,o=void 0===n?0:n,a=i+s/2,A=r+s/2;(0,e.draw)(),null===(t=this._element)||void 0===t||t.setAttribute("transform","rotate("+180*o/Math.PI+","+a+","+A+")")},e.prototype._basicDot=function(e){var t=this,i=e.size,r=e.x,s=e.y;this._rotateFigure(R(R({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),t._element.setAttribute("cx",String(r+i/2)),t._element.setAttribute("cy",String(s+i/2)),t._element.setAttribute("r",String(i/2))}}))},e.prototype._basicSquare=function(e){var t=this,i=e.size,r=e.x,s=e.y;this._rotateFigure(R(R({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),t._element.setAttribute("x",String(r)),t._element.setAttribute("y",String(s)),t._element.setAttribute("width",String(i)),t._element.setAttribute("height",String(i))}}))},e.prototype._basicSideRounded=function(e){var t=this,i=e.size,r=e.x,s=e.y;this._rotateFigure(R(R({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("d","M "+r+" "+s+"v "+i+"h "+i/2+"a "+i/2+" "+i/2+", 0, 0, 0, 0 "+-i)}}))},e.prototype._basicCornerRounded=function(e){var t=this,i=e.size,r=e.x,s=e.y;this._rotateFigure(R(R({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("d","M "+r+" "+s+"v "+i+"h "+i+"v "+-i/2+"a "+i/2+" "+i/2+", 0, 0, 0, "+-i/2+" "+-i/2)}}))},e.prototype._basicCornerExtraRounded=function(e){var t=this,i=e.size,r=e.x,s=e.y;this._rotateFigure(R(R({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("d","M "+r+" "+s+"v "+i+"h "+i+"a "+i+" "+i+", 0, 0, 0, "+-i+" "+-i)}}))},e.prototype._basicCornersRounded=function(e){var t=this,i=e.size,r=e.x,s=e.y;this._rotateFigure(R(R({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("d","M "+r+" "+s+"v "+i/2+"a "+i/2+" "+i/2+", 0, 0, 0, "+i/2+" "+i/2+"h "+i/2+"v "+-i/2+"a "+i/2+" "+i/2+", 0, 0, 0, "+-i/2+" "+-i/2)}}))},e.prototype._drawDot=function(e){var t=e.x,i=e.y,r=e.size;this._basicDot({x:t,y:i,size:r,rotation:0})},e.prototype._drawSquare=function(e){var t=e.x,i=e.y,r=e.size;this._basicSquare({x:t,y:i,size:r,rotation:0})},e.prototype._drawRounded=function(e){var t=e.x,i=e.y,r=e.size,s=e.getNeighbor,n=s?+s(-1,0):0,o=s?+s(1,0):0,a=s?+s(0,-1):0,A=s?+s(0,1):0,l=n+o+a+A;if(0!==l)if(l>2||n&&o||a&&A)this._basicSquare({x:t,y:i,size:r,rotation:0});else{if(2===l){var h=0;return n&&a?h=Math.PI/2:a&&o?h=Math.PI:o&&A&&(h=-Math.PI/2),void this._basicCornerRounded({x:t,y:i,size:r,rotation:h})}if(1===l)return h=0,a?h=Math.PI/2:o?h=Math.PI:A&&(h=-Math.PI/2),void this._basicSideRounded({x:t,y:i,size:r,rotation:h})}else this._basicDot({x:t,y:i,size:r,rotation:0})},e.prototype._drawExtraRounded=function(e){var t=e.x,i=e.y,r=e.size,s=e.getNeighbor,n=s?+s(-1,0):0,o=s?+s(1,0):0,a=s?+s(0,-1):0,A=s?+s(0,1):0,l=n+o+a+A;if(0!==l)if(l>2||n&&o||a&&A)this._basicSquare({x:t,y:i,size:r,rotation:0});else{if(2===l){var h=0;return n&&a?h=Math.PI/2:a&&o?h=Math.PI:o&&A&&(h=-Math.PI/2),void this._basicCornerExtraRounded({x:t,y:i,size:r,rotation:h})}if(1===l)return h=0,a?h=Math.PI/2:o?h=Math.PI:A&&(h=-Math.PI/2),void this._basicSideRounded({x:t,y:i,size:r,rotation:h})}else this._basicDot({x:t,y:i,size:r,rotation:0})},e.prototype._drawClassy=function(e){var t=e.x,i=e.y,r=e.size,s=e.getNeighbor,n=s?+s(-1,0):0,o=s?+s(1,0):0,a=s?+s(0,-1):0,A=s?+s(0,1):0;0!==n+o+a+A?n||a?o||A?this._basicSquare({x:t,y:i,size:r,rotation:0}):this._basicCornerRounded({x:t,y:i,size:r,rotation:Math.PI/2}):this._basicCornerRounded({x:t,y:i,size:r,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:i,size:r,rotation:Math.PI/2})},e.prototype._drawClassyRounded=function(e){var t=e.x,i=e.y,r=e.size,s=e.getNeighbor,n=s?+s(-1,0):0,o=s?+s(1,0):0,a=s?+s(0,-1):0,A=s?+s(0,1):0;0!==n+o+a+A?n||a?o||A?this._basicSquare({x:t,y:i,size:r,rotation:0}):this._basicCornerExtraRounded({x:t,y:i,size:r,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:t,y:i,size:r,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:i,size:r,rotation:Math.PI/2})},e}();var T=function(){return(T=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};const x=function(){function e(e){var t=e.svg,i=e.type;this._svg=t,this._type=i}return e.prototype.draw=function(e,t,i,r){var s;switch(this._type){case m:s=this._drawSquare;break;case f:s=this._drawExtraRounded;break;default:s=this._drawDot}s.call(this,{x:e,y:t,size:i,rotation:r})},e.prototype._rotateFigure=function(e){var t,i=e.x,r=e.y,s=e.size,n=e.rotation,o=void 0===n?0:n,a=i+s/2,A=r+s/2;(0,e.draw)(),null===(t=this._element)||void 0===t||t.setAttribute("transform","rotate("+180*o/Math.PI+","+a+","+A+")")},e.prototype._basicDot=function(e){var t=this,i=e.size,r=e.x,s=e.y,n=i/7;this._rotateFigure(T(T({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("clip-rule","evenodd"),t._element.setAttribute("d","M "+(r+i/2)+" "+s+"a "+i/2+" "+i/2+" 0 1 0 0.1 0zm 0 "+n+"a "+(i/2-n)+" "+(i/2-n)+" 0 1 1 -0.1 0Z")}}))},e.prototype._basicSquare=function(e){var t=this,i=e.size,r=e.x,s=e.y,n=i/7;this._rotateFigure(T(T({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("clip-rule","evenodd"),t._element.setAttribute("d","M "+r+" "+s+"v "+i+"h "+i+"v "+-i+"zM "+(r+n)+" "+(s+n)+"h "+(i-2*n)+"v "+(i-2*n)+"h "+(2*n-i)+"z")}}))},e.prototype._basicExtraRounded=function(e){var t=this,i=e.size,r=e.x,s=e.y,n=i/7;this._rotateFigure(T(T({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("clip-rule","evenodd"),t._element.setAttribute("d","M "+r+" "+(s+2.5*n)+"v "+2*n+"a "+2.5*n+" "+2.5*n+", 0, 0, 0, "+2.5*n+" "+2.5*n+"h "+2*n+"a "+2.5*n+" "+2.5*n+", 0, 0, 0, "+2.5*n+" "+2.5*-n+"v "+-2*n+"a "+2.5*n+" "+2.5*n+", 0, 0, 0, "+2.5*-n+" "+2.5*-n+"h "+-2*n+"a "+2.5*n+" "+2.5*n+", 0, 0, 0, "+2.5*-n+" "+2.5*n+"M "+(r+2.5*n)+" "+(s+n)+"h "+2*n+"a "+1.5*n+" "+1.5*n+", 0, 0, 1, "+1.5*n+" "+1.5*n+"v "+2*n+"a "+1.5*n+" "+1.5*n+", 0, 0, 1, "+1.5*-n+" "+1.5*n+"h "+-2*n+"a "+1.5*n+" "+1.5*n+", 0, 0, 1, "+1.5*-n+" "+1.5*-n+"v "+-2*n+"a "+1.5*n+" "+1.5*n+", 0, 0, 1, "+1.5*n+" "+1.5*-n)}}))},e.prototype._drawDot=function(e){var t=e.x,i=e.y,r=e.size,s=e.rotation;this._basicDot({x:t,y:i,size:r,rotation:s})},e.prototype._drawSquare=function(e){var t=e.x,i=e.y,r=e.size,s=e.rotation;this._basicSquare({x:t,y:i,size:r,rotation:s})},e.prototype._drawExtraRounded=function(e){var t=e.x,i=e.y,r=e.size,s=e.rotation;this._basicExtraRounded({x:t,y:i,size:r,rotation:s})},e}();var O=function(){return(O=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};const D=function(){function e(e){var t=e.svg,i=e.type;this._svg=t,this._type=i}return e.prototype.draw=function(e,t,i,r){(this._type===y?this._drawSquare:this._drawDot).call(this,{x:e,y:t,size:i,rotation:r})},e.prototype._rotateFigure=function(e){var t,i=e.x,r=e.y,s=e.size,n=e.rotation,o=void 0===n?0:n,a=i+s/2,A=r+s/2;(0,e.draw)(),null===(t=this._element)||void 0===t||t.setAttribute("transform","rotate("+180*o/Math.PI+","+a+","+A+")")},e.prototype._basicDot=function(e){var t=this,i=e.size,r=e.x,s=e.y;this._rotateFigure(O(O({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),t._element.setAttribute("cx",String(r+i/2)),t._element.setAttribute("cy",String(s+i/2)),t._element.setAttribute("r",String(i/2))}}))},e.prototype._basicSquare=function(e){var t=this,i=e.size,r=e.x,s=e.y;this._rotateFigure(O(O({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),t._element.setAttribute("x",String(r)),t._element.setAttribute("y",String(s)),t._element.setAttribute("width",String(i)),t._element.setAttribute("height",String(i))}}))},e.prototype._drawDot=function(e){var t=e.x,i=e.y,r=e.size,s=e.rotation;this._basicDot({x:t,y:i,size:r,rotation:s})},e.prototype._drawSquare=function(e){var t=e.x,i=e.y,r=e.size,s=e.rotation;this._basicSquare({x:t,y:i,size:r,rotation:s})},e}();var L=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],F=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];const H=function(){function e(e){this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(e.width)),this._element.setAttribute("height",String(e.height)),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._options=e}return Object.defineProperty(e.prototype,"width",{get:function(){return this._options.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._options.height},enumerable:!1,configurable:!0}),e.prototype.getElement=function(){return this._element},e.prototype.clear=function(){var e,t=this._element;this._element=t.cloneNode(!1),null===(e=null==t?void 0:t.parentNode)||void 0===e||e.replaceChild(this._element,t),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs)},e.prototype.drawQR=function(e){return t=this,i=void 0,s=function(){var t,i,r,s,n,o,a,h,d,c=this;return function(e,t){var i,r,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,r&&(s=2&n[0]?r.return:n[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,n[1])).done)return s;switch(r=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,r=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){o.label=n[1];break}if(6===n[0]&&o.label<s[1]){o.label=s[1],s=n;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(n);break}s[2]&&o.ops.pop(),o.trys.pop();continue}n=t.call(e,o)}catch(e){n=[6,e],r=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}(this,(function(u){switch(u.label){case 0:return t=e.getModuleCount(),i=Math.min(this._options.width,this._options.height)-2*this._options.margin,r=Math.floor(i/t),s={hideXDots:0,hideYDots:0,width:0,height:0},this._qr=e,this._options.image?[4,this.loadImage()]:[3,2];case 1:if(u.sent(),!this._image)return[2];n=this._options,o=n.imageOptions,a=n.qrOptions,h=o.imageSize*l[a.errorCorrectionLevel],d=Math.floor(h*t*t),s=A({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:d,maxHiddenAxisDots:t-14,dotSize:r}),u.label=2;case 2:return this.clear(),this.drawBackground(),this.drawDots((function(e,i){var r,n,o,a,A,l;return!(c._options.imageOptions.hideBackgroundDots&&e>=(t-s.hideXDots)/2&&e<(t+s.hideXDots)/2&&i>=(t-s.hideYDots)/2&&i<(t+s.hideYDots)/2||(null===(r=L[e])||void 0===r?void 0:r[i])||(null===(n=L[e-t+7])||void 0===n?void 0:n[i])||(null===(o=L[e])||void 0===o?void 0:o[i-t+7])||(null===(a=F[e])||void 0===a?void 0:a[i])||(null===(A=F[e-t+7])||void 0===A?void 0:A[i])||(null===(l=F[e])||void 0===l?void 0:l[i-t+7]))})),this.drawCorners(),this._options.image&&this.drawImage({width:s.width,height:s.height,count:t,dotSize:r}),[2]}}))},new((r=void 0)||(r=Promise))((function(e,n){function o(e){try{A(s.next(e))}catch(e){n(e)}}function a(e){try{A(s.throw(e))}catch(e){n(e)}}function A(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,a)}A((s=s.apply(t,i||[])).next())}));var t,i,r,s},e.prototype.drawBackground=function(){var e,t,i=this._element,r=this._options;if(i){var s=null===(e=r.backgroundOptions)||void 0===e?void 0:e.gradient,n=null===(t=r.backgroundOptions)||void 0===t?void 0:t.color;(s||n)&&this._createColor({options:s,color:n,additionalRotation:0,x:0,y:0,height:r.height,width:r.width,name:"background-color"})}},e.prototype.drawDots=function(e){var t,i,r=this;if(!this._qr)throw"QR code is not defined";var s=this._options,n=this._qr.getModuleCount();if(n>s.width||n>s.height)throw"The canvas is too small.";var o=Math.min(s.width,s.height)-2*s.margin,a=Math.floor(o/n),A=Math.floor((s.width-n*a)/2),l=Math.floor((s.height-n*a)/2),h=new I({svg:this._element,type:s.dotsOptions.type});this._dotsClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id","clip-path-dot-color"),this._defs.appendChild(this._dotsClipPath),this._createColor({options:null===(t=s.dotsOptions)||void 0===t?void 0:t.gradient,color:s.dotsOptions.color,additionalRotation:0,x:A,y:l,height:n*a,width:n*a,name:"dot-color"});for(var d=function(t){for(var s=function(s){return e&&!e(t,s)?"continue":(null===(i=c._qr)||void 0===i?void 0:i.isDark(t,s))?(h.draw(A+t*a,l+s*a,a,(function(i,o){return!(t+i<0||s+o<0||t+i>=n||s+o>=n)&&!(e&&!e(t+i,s+o))&&!!r._qr&&r._qr.isDark(t+i,s+o)})),void(h._element&&c._dotsClipPath&&c._dotsClipPath.appendChild(h._element))):"continue"},o=0;o<n;o++)s(o)},c=this,u=0;u<n;u++)d(u)},e.prototype.drawCorners=function(){var e=this;if(!this._qr)throw"QR code is not defined";var t=this._element,i=this._options;if(!t)throw"Element code is not defined";var r=this._qr.getModuleCount(),s=Math.min(i.width,i.height)-2*i.margin,n=Math.floor(s/r),o=7*n,a=3*n,A=Math.floor((i.width-r*n)/2),l=Math.floor((i.height-r*n)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach((function(t){var s,h,d,c,u,p,_,g,m,f,w,C,y=t[0],E=t[1],b=t[2],B=A+y*n*(r-7),P=l+E*n*(r-7),S=e._dotsClipPath,v=e._dotsClipPath;if(((null===(s=i.cornersSquareOptions)||void 0===s?void 0:s.gradient)||(null===(h=i.cornersSquareOptions)||void 0===h?void 0:h.color))&&((S=document.createElementNS("http://www.w3.org/2000/svg","clipPath")).setAttribute("id","clip-path-corners-square-color-"+y+"-"+E),e._defs.appendChild(S),e._cornersSquareClipPath=e._cornersDotClipPath=v=S,e._createColor({options:null===(d=i.cornersSquareOptions)||void 0===d?void 0:d.gradient,color:null===(c=i.cornersSquareOptions)||void 0===c?void 0:c.color,additionalRotation:b,x:B,y:P,height:o,width:o,name:"corners-square-color-"+y+"-"+E})),null===(u=i.cornersSquareOptions)||void 0===u?void 0:u.type){var R=new x({svg:e._element,type:i.cornersSquareOptions.type});R.draw(B,P,o,b),R._element&&S&&S.appendChild(R._element)}else for(var T=new I({svg:e._element,type:i.dotsOptions.type}),O=function(e){for(var t=function(t){if(!(null===(p=L[e])||void 0===p?void 0:p[t]))return"continue";T.draw(B+e*n,P+t*n,n,(function(i,r){var s;return!!(null===(s=L[e+i])||void 0===s?void 0:s[t+r])})),T._element&&S&&S.appendChild(T._element)},i=0;i<L[e].length;i++)t(i)},H=0;H<L.length;H++)O(H);if(((null===(_=i.cornersDotOptions)||void 0===_?void 0:_.gradient)||(null===(g=i.cornersDotOptions)||void 0===g?void 0:g.color))&&((v=document.createElementNS("http://www.w3.org/2000/svg","clipPath")).setAttribute("id","clip-path-corners-dot-color-"+y+"-"+E),e._defs.appendChild(v),e._cornersDotClipPath=v,e._createColor({options:null===(m=i.cornersDotOptions)||void 0===m?void 0:m.gradient,color:null===(f=i.cornersDotOptions)||void 0===f?void 0:f.color,additionalRotation:b,x:B+2*n,y:P+2*n,height:a,width:a,name:"corners-dot-color-"+y+"-"+E})),null===(w=i.cornersDotOptions)||void 0===w?void 0:w.type){var N=new D({svg:e._element,type:i.cornersDotOptions.type});N.draw(B+2*n,P+2*n,a,b),N._element&&v&&v.appendChild(N._element)}else{T=new I({svg:e._element,type:i.dotsOptions.type});var U=function(e){for(var t=function(t){if(!(null===(C=F[e])||void 0===C?void 0:C[t]))return"continue";T.draw(B+e*n,P+t*n,n,(function(i,r){var s;return!!(null===(s=F[e+i])||void 0===s?void 0:s[t+r])})),T._element&&v&&v.appendChild(T._element)},i=0;i<F[e].length;i++)t(i)};for(H=0;H<F.length;H++)U(H)}}))},e.prototype.loadImage=function(){var e=this;return new Promise((function(t,i){var r=e._options,s=new Image;if(!r.image)return i("Image is not defined");"string"==typeof r.imageOptions.crossOrigin&&(s.crossOrigin=r.imageOptions.crossOrigin),e._image=s,s.onload=function(){t()},s.src=r.image}))},e.prototype.drawImage=function(e){var t=e.width,i=e.height,r=e.count,s=e.dotSize,n=this._options,o=Math.floor((n.width-r*s)/2),a=Math.floor((n.height-r*s)/2),A=o+n.imageOptions.margin+(r*s-t)/2,l=a+n.imageOptions.margin+(r*s-i)/2,h=t-2*n.imageOptions.margin,d=i-2*n.imageOptions.margin,c=document.createElementNS("http://www.w3.org/2000/svg","image");c.setAttribute("href",n.image||""),c.setAttribute("x",String(A)),c.setAttribute("y",String(l)),c.setAttribute("width",h+"px"),c.setAttribute("height",d+"px"),this._element.appendChild(c)},e.prototype._createColor=function(e){var t=e.options,i=e.color,r=e.additionalRotation,s=e.x,n=e.y,o=e.height,a=e.width,A=e.name,l=a>o?a:o,h=document.createElementNS("http://www.w3.org/2000/svg","rect");if(h.setAttribute("x",String(s)),h.setAttribute("y",String(n)),h.setAttribute("height",String(o)),h.setAttribute("width",String(a)),h.setAttribute("clip-path","url('#clip-path-"+A+"')"),t){var d;if(t.type===B)(d=document.createElementNS("http://www.w3.org/2000/svg","radialGradient")).setAttribute("id",A),d.setAttribute("gradientUnits","userSpaceOnUse"),d.setAttribute("fx",String(s+a/2)),d.setAttribute("fy",String(n+o/2)),d.setAttribute("cx",String(s+a/2)),d.setAttribute("cy",String(n+o/2)),d.setAttribute("r",String(l/2));else{var c=((t.rotation||0)+r)%(2*Math.PI),u=(c+2*Math.PI)%(2*Math.PI),p=s+a/2,_=n+o/2,g=s+a/2,m=n+o/2;u>=0&&u<=.25*Math.PI||u>1.75*Math.PI&&u<=2*Math.PI?(p-=a/2,_-=o/2*Math.tan(c),g+=a/2,m+=o/2*Math.tan(c)):u>.25*Math.PI&&u<=.75*Math.PI?(_-=o/2,p-=a/2/Math.tan(c),m+=o/2,g+=a/2/Math.tan(c)):u>.75*Math.PI&&u<=1.25*Math.PI?(p+=a/2,_+=o/2*Math.tan(c),g-=a/2,m-=o/2*Math.tan(c)):u>1.25*Math.PI&&u<=1.75*Math.PI&&(_+=o/2,p+=a/2/Math.tan(c),m-=o/2,g-=a/2/Math.tan(c)),(d=document.createElementNS("http://www.w3.org/2000/svg","linearGradient")).setAttribute("id",A),d.setAttribute("gradientUnits","userSpaceOnUse"),d.setAttribute("x1",String(Math.round(p))),d.setAttribute("y1",String(Math.round(_))),d.setAttribute("x2",String(Math.round(g))),d.setAttribute("y2",String(Math.round(m)))}t.colorStops.forEach((function(e){var t=e.offset,i=e.color,r=document.createElementNS("http://www.w3.org/2000/svg","stop");r.setAttribute("offset",100*t+"%"),r.setAttribute("stop-color",i),d.appendChild(r)})),h.setAttribute("fill","url('#"+A+"')"),this._defs.appendChild(d)}else i&&h.setAttribute("fill",i);this._element.appendChild(h)},e}(),N="canvas";for(var U={},M=0;M<=40;M++)U[M]=M;const k={type:N,width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:U[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000"},backgroundOptions:{color:"#fff"}};var Q=function(){return(Q=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function V(e){var t=Q({},e);if(!t.colorStops||!t.colorStops.length)throw"Field 'colorStops' is required in gradient";return t.rotation?t.rotation=Number(t.rotation):t.rotation=0,t.colorStops=t.colorStops.map((function(e){return Q(Q({},e),{offset:Number(e.offset)})})),t}function G(e){var t=Q({},e);return t.width=Number(t.width),t.height=Number(t.height),t.margin=Number(t.margin),t.imageOptions=Q(Q({},t.imageOptions),{hideBackgroundDots:Boolean(t.imageOptions.hideBackgroundDots),imageSize:Number(t.imageOptions.imageSize),margin:Number(t.imageOptions.margin)}),t.margin>Math.min(t.width,t.height)&&(t.margin=Math.min(t.width,t.height)),t.dotsOptions=Q({},t.dotsOptions),t.dotsOptions.gradient&&(t.dotsOptions.gradient=V(t.dotsOptions.gradient)),t.cornersSquareOptions&&(t.cornersSquareOptions=Q({},t.cornersSquareOptions),t.cornersSquareOptions.gradient&&(t.cornersSquareOptions.gradient=V(t.cornersSquareOptions.gradient))),t.cornersDotOptions&&(t.cornersDotOptions=Q({},t.cornersDotOptions),t.cornersDotOptions.gradient&&(t.cornersDotOptions.gradient=V(t.cornersDotOptions.gradient))),t.backgroundOptions&&(t.backgroundOptions=Q({},t.backgroundOptions),t.backgroundOptions.gradient&&(t.backgroundOptions.gradient=V(t.backgroundOptions.gradient))),t}var $=i(192),W=i.n($),K=function(e,t,i,r){return new(i||(i=Promise))((function(s,n){function o(e){try{A(r.next(e))}catch(e){n(e)}}function a(e){try{A(r.throw(e))}catch(e){n(e)}}function A(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}A((r=r.apply(e,t||[])).next())}))},z=function(e,t){var i,r,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,r&&(s=2&n[0]?r.return:n[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,n[1])).done)return s;switch(r=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,r=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){o.label=n[1];break}if(6===n[0]&&o.label<s[1]){o.label=s[1],s=n;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(n);break}s[2]&&o.ops.pop(),o.trys.pop();continue}n=t.call(e,o)}catch(e){n=[6,e],r=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};const j=function(){function e(e){this._options=e?G(o(k,e)):k,this.update()}return e._clearContainer=function(e){e&&(e.innerHTML="")},e.prototype._getQRStylingElement=function(e){return void 0===e&&(e="png"),K(this,void 0,void 0,(function(){var t,i,r;return z(this,(function(s){switch(s.label){case 0:if(!this._qr)throw"QR code is empty";return"svg"!==e.toLowerCase()?[3,2]:(i=void 0,t=void 0,this._svg&&this._svgDrawingPromise?(t=this._svg,i=this._svgDrawingPromise):(t=new H(this._options),i=t.drawQR(this._qr)),[4,i]);case 1:return s.sent(),[2,t];case 2:return i=void 0,r=void 0,this._canvas&&this._canvasDrawingPromise?(r=this._canvas,i=this._canvasDrawingPromise):(r=new v(this._options),i=r.drawQR(this._qr)),[4,i];case 3:return s.sent(),[2,r]}}))}))},e.prototype.update=function(t){e._clearContainer(this._container),this._options=t?G(o(this._options,t)):this._options,this._options.data&&(this._qr=W()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(e){switch(!0){case/^[0-9]*$/.test(e):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(e):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===N?(this._canvas=new v(this._options),this._canvasDrawingPromise=this._canvas.drawQR(this._qr),this._svgDrawingPromise=void 0,this._svg=void 0):(this._svg=new H(this._options),this._svgDrawingPromise=this._svg.drawQR(this._qr),this._canvasDrawingPromise=void 0,this._canvas=void 0),this.append(this._container))},e.prototype.append=function(e){if(e){if("function"!=typeof e.appendChild)throw"Container should be a single DOM node";this._options.type===N?this._canvas&&e.appendChild(this._canvas.getCanvas()):this._svg&&e.appendChild(this._svg.getElement()),this._container=e}},e.prototype.getRawData=function(e){return void 0===e&&(e="png"),K(this,void 0,void 0,(function(){var t,i,r;return z(this,(function(s){switch(s.label){case 0:if(!this._qr)throw"QR code is empty";return[4,this._getQRStylingElement(e)];case 1:return t=s.sent(),"svg"===e.toLowerCase()?(i=new XMLSerializer,r=i.serializeToString(t.getElement()),[2,new Blob(['<?xml version="1.0" standalone="no"?>\r\n'+r],{type:"image/svg+xml"})]):[2,new Promise((function(i){return t.getCanvas().toBlob(i,"image/"+e,1)}))]}}))}))},e.prototype.download=function(e){return K(this,void 0,void 0,(function(){var t,i,r,s,n;return z(this,(function(o){switch(o.label){case 0:if(!this._qr)throw"QR code is empty";return t="png",i="qr","string"==typeof e?(t=e,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):"object"==typeof e&&null!==e&&(e.name&&(i=e.name),e.extension&&(t=e.extension)),[4,this._getQRStylingElement(t)];case 1:return r=o.sent(),"svg"===t.toLowerCase()?(s=new XMLSerializer,n='<?xml version="1.0" standalone="no"?>\r\n'+(n=s.serializeToString(r.getElement())),a("data:image/svg+xml;charset=utf-8,"+encodeURIComponent(n),i+".svg")):a(r.getCanvas().toDataURL("image/"+t),i+"."+t),[2]}}))}))},e}()}},t={};function i(r){if(t[r])return t[r].exports;var s=t[r]={exports:{}};return e[r](s,s.exports,i),s.exports}return i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i(796)})().default})),QRCodeStyling=getDefaultExportFromCjs(qrCodeStyling);class QrcodeItemElement extends ReportItemElement{constructor(e,t){super(e,t,"qrcodeItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-qrcode rr-item-element"}get guardLabel(){return"qrcode"}get debugLabel(){return"qrcode"}_doMeasure(e,t,i,r){const s=this.model;return this._setModelSize(s,t,i,r),this._isTesting()||this.$_render(e,s,t),Size.create(t.offsetWidth,t.offsetHeight)}isDom(e){return e.parentElement===this.dom||super.isDom(e)}$_getText(e,t){let i="";return t.value?(i=e.printing?this.getPrintValue(e,t):t.value,i=Utils.toStr(i)):t.text&&(i=t.text),i}$_render(e,t,i){const r=this._modelWidth||0,s=this._modelHeight||0,n=QrcodeItem.QRCODE_MIN_SIZE;if(r<n||s<n)return;const o=this.$_getText(e,t);if(this._qrcode){const{width:e,height:t}=this._qrcode._options;r===e&&s===t||this._qrcode.update({width:r,height:s})}else{this._qrcode=new QRCodeStyling({width:r,height:s,data:o,qrOptions:{errorCorrectionLevel:t.errorCorrectionLevel}}),this._qrcode.append(i);const e=i.querySelector("canvas");i.removeChild(e);const n=e.toDataURL(),a=document.createElement("img");a.src=n,a.alt="QR코드",i.appendChild(a)}}}class ShapeItemBaseElement extends ReportItemElement{_getShape(e,t){const i=t.shapeCallback;let r=t.shape;if(t.value&&i){let s;s=e.printing?this.getPrintValue(e,t):t.value,r=i(e.getUserData(),t,s)||r}return r}_getDrawing(e,t){let i;return e&&(e=e.toLowerCase(),EllipseShape.isEllipse(e)?(i=this._ellipse?this._ellipse:this._ellipse=new EllipseShape,this._ellipse.circled=e===EllipseShape.CIRCLE):LineShape.isLine(e)?(i=this._line?this._line:this._line=new LineShape,this._line.shape=e):(i=this._polygon?this._polygon:this._polygon=new PolygonShape(e),this._polygon.shape=e)),i.className=t,i}}class ShapeItemElement extends ShapeItemBaseElement{constructor(e,t){super(e,t,"shapeItemView"),this.$_render=(e,t,i,r)=>{const s=this._getShape(e,this.model);if(s){const e=this._getDrawing(s);if(e){const n=getComputedStyle(this._svg),o=parseFloat(n.strokeWidth)||0,a="star"!==s?1:0;this._isTesting()||e.drawAt(a,a,t,i-2*a,r-2*a,o)}}}}_doDispose(){super._doDispose()}prepareExport(){const e=this.dom;this._svg.setAttribute("viewBox",[0,0,e.offsetWidth,e.offsetHeight].join(" "))}_getCssSelector(){return"rr-shape rr-item-element"}get debugLabel(){return""}_initDom(e,t){super._initDom(e,t),this._svg=SvgElement.createSVG(t,"rr-shape-shape",{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"})}_setStyles(e,t,i){super._setStyles(e,t,i),ShapeItem.STYLE_PROPS.forEach((e=>{e in t&&(this._svg.style[e]=t[e])}))}_doMeasure(e,t,i,r){const s=this.model;this._setModelSize(s,t,i,r),SvgElement.renderSVG(null,e,this._svg,this.$_render);const n=t.offsetWidth,o=t.offsetHeight;return e.printing&&SvgElement.prepareExport(this._svg,n,o),Size.create(n,o)}}class SvgItemElement extends ReportItemElement{constructor(e,t){super(e,t,"svgItemView"),SvgItemElement.SVG||(SvgItemElement.SVG=e.createElement("div"))}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-svg rr-item-element"}get debugLabel(){return""}_doMeasure(e,t,i,r){const s=this.model,n=t.style;let o=s.svg&&e.assets.getSvg(s.svg);if(e.printing&&!o&&(o=this.getPrintValue(e,s)),this._setModelSize(s,t,i,r),Utils.isIE){const e=SvgItemElement.SVG;e.innerHTML=o.substring(o.indexOf("<svg"));const i=e.lastChild;i instanceof SVGSVGElement?(i.setAttribute("viewbox","0 0 "+i.getAttribute("width")+" "+i.getAttribute("height")),i.setAttribute("width","100%"),i.setAttribute("height","100%"),t.innerHTML=e.innerHTML,delete t.dataset.empty):(t.dataset.empty="true",t.innerHTML="<span></span>")}else o?(t.innerHTML="",n.background="no-repeat center/contain url('"+o+"')",delete t.dataset.empty):(t.dataset.empty="true",t.innerHTML="<span></span>"),e.printing&&(t._svg_=o);return Size.create(t.offsetWidth,t.offsetHeight)}}class HichartWrapper extends Base{constructor(e,t){super(),HichartWrapper.Highcharts||(HichartWrapper.Highcharts=window.Highcharts),HichartWrapper.Highcharts&&HichartWrapper.Highcharts.setOptions(HichartWrapper.hichart_options),this._container=e,this._model=t}_doDispose(){super._doDispose()}refreshChart(e,t,i){if(!HichartWrapper.Highcharts)return;const r=e.assets,s=this._model,n=s.theme?r.getHighchart(s.theme):null,o=n&&n.theme?Utils.deepClone(n.theme):{};o.chart={inverted:s.inverted,styledMode:!1,backgroundColor:null,plotBorderWidth:s.plotBorderWidth,plotBorderColor:s.plotBorderColor},o.plotOptions=o.plotOptions||{},o.plotOptions.series=o.plotOptions.series||{},Object.assign(o.plotOptions.series,{stacking:s.stacking}),o.credits={enabled:!1},o.title=s.title.getWrapper(),o.subtitle=s.subtitle.getWrapper(),this._buildConfig(e,s,o);const a=HichartWrapper.Highcharts.chart(this._container,o);this._doRefreshChart(a,s,o)}_buildConfig(e,t,i){this.$_buildXAxis(e,t.xAxis,i.xAxis=t.xAxis.getWrapper()),this.$_buildYAxis(e,t.yAxis,i.yAxis=t.yAxis.getWrapper()),this.$_buildLegend(t.legend,i.legend=t.legend.getWrapper());const r=i.series=[];for(let i=0;i<t.series.count;i++){const s=t.series.get(i),n={};n.id=s.id,n.data=s.getValues(e,e.dp),s.wrap(n),n.visible=s.visible&&(e.printing||s.designVisible),r.push(n)}}_doRefreshChart(e,t,i){}$_buildXAxis(e,t,i){i.categories=t.getCategories(e,e.dp)}$_buildYAxis(e,t,i){i.categories=t.getCategories(e,e.dp)}$_buildLegend(e,t){}}HichartWrapper.hichart_options={lang:{thousandsSep:","},plotOptions:{series:{animation:!1,enableMouseTracking:!1}}};class HichartItemElement extends ReportItemElement{constructor(e,t){super(e,t,"hichartItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-hichart rr-item-element"}get debugLabel(){return"Hichart"}_initDom(e,t){super._initDom(e,t);const i=this._chartDiv=e.createElement("div");i.className="rr-hichart-wrapper",t.appendChild(i)}_doMeasure(e,t,i,r){const s=this.model,n=t.style;return e.printing||(t.style.border="1px solid rgba(55, 55, 55, 0.1)"),this.$_prepareWrapper(s,this._chartDiv),this._setModelSize(s,t,i,r),n.overflow="hidden",new Size(t.offsetWidth,t.offsetHeight)}_doLayoutContent(e){this._wrapper&&(this._chartDiv.style.width=this.width+"px",this._chartDiv.style.height=this.height+"px",this._isTesting()||this.$_layoutWrapper(e,this._wrapper))}isDom(e){return this.containsDom(e)||super.isDom(e)}$_createWrapper(e,t){return new HichartWrapper(e,t)}$_prepareWrapper(e,t){this._wrapper||(this._wrapper=this.$_createWrapper(t,e))}$_layoutWrapper(e,t){t.refreshChart(e,this.width,this.height)}}class SummaryItemElement extends TextItemElementBase{constructor(e,t){super(e,t,"SummaryItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-summary rr-item-element"}get guardLabel(){return"summary"}get editable(){return!1}_getPrintText(e,t){this._error=null;try{const i=t.expression&&e.bandSummaryRuntime;let r=i?t.getSummary(i):this.getPrintValue(e,t);return this._getText(t,r)}catch(e){return this._error=e,console.error(e),"<<ERROR>>"}}_getDesignText(e,t){let i="";return e.expression?i="["+e.expression+"]":e.value&&(i=t?e.value:"["+e.value+"]"),i||"[summary]"}_doMeasure(e,t,i,r){const s=super._doMeasure(e,t,i,r);return t.dataset.error=this._error?"1":"0",this._error&&(t.title=this._error),s}}class BarItemElement extends ReportItemElement{constructor(e,t){super(e,t,"barItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-bar rr-item-element"}get debugLabel(){return""}_initDom(e,t){super._initDom(e,t),this._bar=e.createElement("span"),this._bar.className="rr-bar-bar",Utils.extend(this._bar.style,{position:"absolute",textAlign:"center",color:"gray"}),t.appendChild(this._bar)}_doMeasure(e,t,i,r){const s=this.model,n=100*((e.printing?this.getPrintValue(e,s,s.position):s.position)-s.minimum)/(s.maximum-s.minimum);return n<=0&&!e.printing?(Utils.extend(this._bar.style,{width:"100%",height:"",top:"50%",transform:"translateY(-50%)"}),this._bar.textContent="[ BAR ]",this._bar.dataset.design=""):(Utils.extend(this._bar.style,{width:n+"%",height:"100%",top:"",transform:""}),this._bar.textContent="",delete this._bar.dataset.design),e.printing&&(this._bar.dataset._m_=t.dataset._m_),Size.create(t.offsetWidth,t.offsetHeight)}_setStyles(e,t,i){super._setStyles(e,t,i),"barColor"in t&&(this._bar.style.backgroundColor=t.barColor)}isDom(e){return e===this._bar||super.isDom(e)}}class RatingItemElement extends ShapeItemBaseElement{constructor(e,t){super(e,t,"ratingItemView"),this.$_render=(e,t,i,r)=>{const s=this.model,n=this._getShape(e,s);if(n){const o="star"!==n?1:0,a=this._getDrawing(n,RatingItemElement.SVG_CLASS);if(a){const n=s.shapeCount,A=Math.min(i/n,r),l=e.printing?this.getPrintValue(e,s):s.designValue,h=Utils.toNumber(s.minimum,0),d=Utils.toNumber(s.maximum,n),c=Math.min(n,Math.round((l-h)*n/(d-h))),u=0,p=(i-A*n)/2,_=A-2*o,g=r-2*o;for(let e=0;e<c;e++){const i=p+e*A+o,r=u+o;a.drawAt(i,r,t,_,g)}for(let e=c;e<n;e++){const i=p+e*A+o,r=u+o,s=a.drawAt(i,r,t,_,g,0,RatingItemElement.BACK_CLASS);let n;this._backFill?SvgElement.setStyle(s,"fill",this._backFill):(n=getComputedStyle(s),n.fill&&SvgElement.setStyle(s,"fill",n.fill)),this._backStroke?SvgElement.setStyle(s,"stroke",this._backStroke):(n=n||getComputedStyle(s),n.stroke&&SvgElement.setStyle(s,"stroke",n.stroke))}}}}}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-rating rr-item-element"}get debugLabel(){return""}_initDom(e,t){super._initDom(e,t);this._svg=SvgElement.createSVG(t,"rr-rating-shape",{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"})}_doMeasure(e,t,i,r){this._setModelSize(this.model,t,i,r),SvgElement.renderSVG(null,e,this._svg,this.$_render);const s=t.offsetWidth,n=t.offsetHeight;return e.printing&&SvgElement.prepareExport(this._svg,s,n),Size.create(s,n)}_setStyles(e,t,i){super._setStyles(e,t,i),["fill","stroke"].forEach((e=>{e in t&&(this._svg.style[e]=t[e])})),this._backFill=t.backFill,this._backStroke=t.backStroke}}RatingItemElement.SVG_CLASS="rr-rating-shape-svg",RatingItemElement.BACK_CLASS="rr-rating-shape-back";class DataListContainerElement extends ReportGroupItemElement{constructor(e,t){super(e,t,"dataListBoxView"),this._gap=0}get debugLabel(){return"datalist"}_getCssSelector(){return"rr-datalist rr-group-element"}_needDesignBox(){return!0}_buildItems(e,t,i){if(e.printing){const e=t.model.data,r=e&&e.get(i.data),s=i.value;let n=r instanceof BandData?r.rowCount:r?1:0;isNaN(i.maxRows)||(n=Math.min(n,i.maxRows));const o=this.dom,a=this.doc;for(let e=0;e<n;e++){const t=a.createElement("span"),i=r instanceof BandData?r.getRowValue(e,s):r.getValue(s);Object.assign(t.style,{position:"absolute"}),t.textContent=i,o.appendChild(t)}}}_doMeasure(e,t,i,r){const s=this.model;this._paddings=e.reportView.getBoxPaddings(s),this.measureFixed||this._setModelSize(s,t,i,r,!0),super._doMeasure(e,t,i,r);const n=this.dom.children;let o=0,a=0,A=0;for(let e=0;e<n.length;e++){const t=n[e];t instanceof HTMLSpanElement&&(a+=t.offsetHeight,o=Math.max(o,t.offsetWidth),A++)}return a+=(A-1)*Utils.toNumber(this.model.rowGap,0),new Size(o,a)}_doAfterMeasure(e,t,i,r,s){s.height>0||e.printing||!(this.model.designHeight>0)||(s.height=this.model.designHeight),s.width>0||e.printing||!(this.model.designWidth>0)||(s.width=this.model.designWidth),this._applyPaddings(t,s),super._doAfterMeasure(e,t,i,r,s),t.style.padding="0"}_doLayoutContent(e){const t=this.model,i=this.dom.children,r=Utils.toNumber(t.rowGap,0),s=this.width,n=this.height,o=t.itemAlign,a=t.rowAlign,A=this._paddings;let l,h=0,d=A.top;switch(a){case Align.RIGHT:l=s-A.right;break;case Align.CENTER:l=(s-A.left-A.right)/2;break;default:l=A.left}if("middle"===o||"bottom"===o){let e=0;for(let t=0;t<i.length;t++){const r=i[t];r instanceof HTMLSpanElement&&(h+=r.offsetHeight,e++)}0!==e&&(h+=(e-1)*r),d="bottom"===o?Math.max(d,n-A.bottom-h):Math.max(d,(n-A.top-A.bottom-h)/2)}for(let e=0;e<i.length;e++){const t=i[e];if(t instanceof HTMLSpanElement){switch(t.style.top=d+"px",a){case Align.RIGHT:t.style.left=l-t.offsetWidth+"px";break;case Align.CENTER:t.style.left=l-t.offsetWidth/2+"px";break;default:t.style.left=l+"px"}d+=t.offsetHeight+r}}}}class PageItemElement extends ReportItemElement{constructor(e,t,i){super(e,t,i)}_doDispose(){super._doDispose()}_getCssSelector(){return PageItemElement.CLASS_LIST}get guardLabel(){return"page"}get debugLabel(){return"page"}_initDom(e,t){super._initDom(e,t);const i=this._span=e.createElement("span");i.className=PageItemElement.SPAN,i.style.display="table-cell",i.style.verticalAlign="middle",t.appendChild(i)}_doPrepareMeasure(e,t){super._doPrepareMeasure(e,t),e.printing&&(this._span.style.display="none")}_doMeasure(e,t,i,r){const s=this.model,n=this._span;this._setModelSize(s,t,i,r),n.textContent=s.pageName||"PAGE";let o=i,a=this._modelHeight;return isNaN(a)&&(a=Math.round(n.offsetHeight)),new Size(o,a)}_doLayoutContent(e){}isDom(e){return e===this._span||super.isDom(e)}}function DATAMatrix(e,t,i){var r=[],s=0,n=0,o=function(e,t){r[t]=r[t]||[],r[t][e]=1},a=function(e){for(var t=[],i=e.length,r=0;r<i;r++){var s=e.charCodeAt(r),n=r+1<i?e.charCodeAt(r+1):0;s>47&&s<58&&n>47&&n<58?(t.push(10*(s-48)+n+82),r++):s>127?(t.push(235),t.push(s-127&255)):t.push(s+1)}return t},A=function(e,t){var i,r,s=0,n=0,o=e.length,A=[t[0]],l=function(e){n=40*n+e,2==s++&&(A.push(++n>>8),A.push(255&n),s=n=0)};for(i=0;i<o&&(0!=s||i!=o-1);i++){var h=e.charCodeAt(i);for(h>127&&238!=A[0]&&(l(1),l(30),h-=128),r=1;h>t[r];r+=3);var d=t[r+1];if(8==d||9==d&&0==s&&i==o-1)return[];if(d<5&&2==s&&i==o-1)break;d<5&&l(d),l(h-t[r+2])}return 2==s&&238!==A[0]&&l(0),A.push(254),(s>0||i<o)&&(A=A.concat(a(e.substr(i-s)))),A},l=function(e,t){e=unescape(encodeURI(e));var i=a(e),r=i.length,l=A(e,[230,31,0,0,32,9,29,47,1,33,57,9,44,64,1,43,90,9,51,95,1,69,127,2,96,255,1,0]),h=l.length;h>0&&h<r&&(i=l,r=h),(h=(l=A(e,[239,31,0,0,32,9,29,47,1,33,57,9,44,64,1,43,90,2,64,95,1,69,122,9,83,127,2,96,255,1,0])).length)>0&&h<r&&(i=l,r=h),(h=(l=A(e,[238,12,8,0,13,9,13,31,8,0,32,9,29,41,8,0,42,9,41,47,8,0,57,9,44,64,8,0,90,9,51,255,8,0])).length)>0&&h<r&&(i=l,r=h),l=function(e){for(var t,i=e.length,r=i+1&-4,s=0,n=r>0?[240]:[],o=0;o<r;o++){if(o<r-1){if((t=e.charCodeAt(o))<32||t>94)return[]}else t=31;s=64*s+(63&t),3==(3&o)&&(n.push(s>>16),n.push(s>>8&255),n.push(255&s),s=0)}return r>i?n:n.concat(a(e.substr(0==r?0:r-1)))}(e),(h=l.length)>0&&h<r&&(i=l,r=h),l=function(e){var t=[231],i=e.length;250<i&&t.push(37+(i/250|0)&255),t.push(i%250+149*(t.length+1)%255+1&255);for(var r=0;r<i;r++)t.push(e.charCodeAt(r)+149*(t.length+1)%255+1&255);return t}(e),(h=l.length)>0&&h<r&&(i=l,r=h);var d,c,u,p,_,g,m,f,w=1,C=1,y=-1,E=1,b=new Array(70),B=new Array(70),P=new Array(256),S=new Array(255);if(t&&r<50){l=[16,7,28,11,24,14,32,18,32,24,44,28];do{h=(c=l[++y])*(d=6+(12&y))/8}while(h-l[++y]<r);c>25&&(w=2)}else{c=d=6,_=2,l=[5,7,10,12,14,18,20,24,28,36,42,48,56,68,84,112,144,192,224,272,336,408,496,620];do{if(++y==l.length)return[0,0];c>11*_&&(_=4+_&12),h=(c=d+=_)*d>>3}while(h-l[y]<r);c>27&&(C=w=2*(c/54|0)+2),h>255&&(E=2*(h>>9)+2)}for(u=c/w,p=d/C,r<h-(f=l[y])&&(i[r++]=129);r<h-f;)i[r++]=(149*r%253+130)%254;for(f/=E,y=1,_=0;_<255;_++)S[_]=y,P[y]=_,(y+=y)>255&&(y^=301);for(b[f]=0,_=1;_<=f;_++)for(b[y=f-_]=1;y<f;y++)b[y]=b[y+1]^S[(P[b[y]]+_)%255];for(g=0;g<E;g++){for(_=0;_<=f;_++)B[_]=0;for(_=g;_<r;_+=E)for(y=0,v=B[0]^i[_];y<f;y++)B[y]=B[y+1]^(v?S[(P[b[y]]+P[v])%255]:0);for(_=0;_<f;_++)i[r+g+_*E]=B[_]}for(_=0;_<d+2*C;_+=p+2)for(y=0;y<c+2*w;y++)o(y,_+p+1),0==(1&y)&&o(y,_);for(_=0;_<c+2*w;_+=u+2)for(y=0;y<d;y++)o(_,y+2*(y/p|0)+1),1==(1&y)&&o(_+u+1,y+2*(y/p|0));for(f=2,g=0,m=4,E=[0,0,-1,0,-2,0,0,-1,-1,-1,-2,-1,-1,-2,-2,-2],_=0;_<h;m-=f,g+=f){if(m==d-3&&-1==g)l=[c,6-d,c,5-d,c,4-d,c,3-d,c-1,3-d,3,2,2,2,1,2];else if(m==d+1&&1==g&&0==(7&c)&&6==(7&d))l=[c-2,-d,c-3,-d,c-4,-d,c-2,-1-d,c-3,-1-d,c-4,-1-d,c-2,-2,-1,-2];else{if(0==m&&g==c-2&&3&c)continue;if(m<0||g>=c||m>=d||g<0)for(m+=2+(f=-f)/2,g+=2-f/2;m<0||g>=c||m>=d||g<0;)m-=f,g+=f;if(m==d-2&&0==g&&3&c)l=[c-1,3-d,c-1,2-d,c-2,2-d,c-3,2-d,c-4,2-d,0,1,0,0,0,-1];else if(m==d-2&&0==g&&4==(7&c))l=[c-1,5-d,c-1,4-d,c-1,3-d,c-1,2-d,c-2,2-d,0,1,0,0,0,-1];else{if(1==m&&g==c-1&&0==(7&c)&&6==(7&d))continue;l=E}}for(r=i[_++],y=0;r>0;y+=2,r>>=1)if(1&r){var v=g+l[y],R=m+l[y+1];v<0&&(v+=c,R+=4-(c+4&7)),R<0&&(R+=d,v+=4-(d+4&7)),o(v+2*(v/u|0)+1,R+2*(R/p|0)+1)}}for(_=c;3&_;_--)o(_,_);s=c+2*w,n=d+2*C};return function(){function o(t,i){for(var r in t=t instanceof SVGSVGElement?t:e.createElementNS(g,t),i||{})t.setAttribute(r,i[r]);return t}var a,A,h,d,c,u,p,_=Math.abs,g="http://www.w3.org/2000/svg",m="",f="string"==typeof i?{msg:i}:i||{},w=f.pal||["#000"],C=_(f.dim)||256,y=[1,0,0,1,p=(p=_(f.pad))>-1?p:2,p],E=w[0]||"#000",b=w[1]||"transparent",B=f.vrb?0:1;for(l(f.msg||"",f.rct),c=s+2*p,u=n+2*p,h=n;h--;)for(d=0,A=s;A--;)r[h][A]&&(B?(d++,r[h][A-1]||(m+="M"+A+","+h+"h"+d+"v1h-"+d+"v-1z",d=0)):m+="M"+A+","+h+"h1v1h-1v-1z");return a=o(t,{viewBox:[0,0,c,u].join(" "),width:C/u*c|0,height:C,fill:E,"shape-rendering":"crispEdges",xmlns:g,version:"1.1"}),b&&a.appendChild(o("path",{fill:b,d:"M0,0v"+u+"h"+c+"V0H0Z"})),a.appendChild(o("path",{transform:"matrix("+y+")",d:m})),a}()}PageItemElement.CLASS_NAME="rr-pageitem",PageItemElement.CLASS_LIST=PageItemElement.CLASS_NAME+" rr-item-element",PageItemElement.SPAN="_rr_span_";class DataMatrixItemElement extends ReportItemElement{constructor(e,t){super(e,t,"dataMatrixItemView")}_doDispose(){super._doDispose(),this._svg=null}_getCssSelector(){return"rr-datamatrix rr-item-element"}get guardLabel(){return"dataMatrix"}get debugLabel(){return"dataMatrix"}_initDom(e,t){super._initDom(e,t),Object.assign(t.style,{display:"flex",justifyContent:"center",alignItems:"center"})}_doMeasure(e,t,i,r){const s=this.model;return this._setModelSize(s,t,i,r),this._isTesting()||(this._svg||(this._svg=t.ownerDocument.createElementNS(SVGNS,"svg"),t.appendChild(this._svg)),this._svg.dataset._m_=s.shash,this.$_render(e,s,t)),Size.create(t.offsetWidth,t.offsetHeight)}isDom(e){return this.dom.contains(e)||super.isDom(e)}$_getText(e,t){let i="";return t.value?(i=e.printing?this.getPrintValue(e,t):t.value,i=Utils.toStr(i)):t.text&&(i=t.text),i}$_render(e,t,i){const r=this._modelWidth||0,s=this._modelHeight||0,n=DataMatrixItem.MIN_SIZE;if(r<n||s<n)return;const o={msg:this.$_getText(e,t),dim:Math.min(r,s),pad:Utils.pickNum(this.model.pad,2)};i.style.color&&(o.pal=[i.style.color]),DATAMatrix(i.ownerDocument,this._svg,o)}}class HtmlItemElement extends ReportItemElement{constructor(e,t){super(e,t,"HtmlItemView")}_doDispose(){super._doDispose()}get debugLabel(){return"html"}_getCssSelector(){return"rr-html rr-item-element"}_initDom(e,t){super._initDom(e,t),this._content=e.createElement("div"),Object.assign(this._content.style,{pointerEvents:"none",display:"inline-block"}),t.appendChild(this._content)}_doMeasure(e,t,i,r){const s=this.model;let n=s.getHtml(e);if(t.style.width="",t.style.height="",this._setModelSize(s,t,i,r),isNaN(this._modelWidth)&&(t.style.width="100000px"),this._content.innerHTML=n,e.printing)this._setBindMarker(!1);else{s.value?this._setBindMarker(!0,!1):this._setBindMarker(!1)}let o=this._content.offsetWidth+1,a=this._content.offsetHeight;return isNaN(this._modelWidth)&&(t.style.width=""),new Size(o,a)}}class EmptyView extends LayerElement{constructor(e){super(e,"emptyView"),this._error=""}get error(){return this._error}set error(e){this._error=e}layoutContent(e){const t=this._errorView,i=e.loadError;if(this.error=i){t.style.visibility="",t.textContent=i;const e=Math.round((this.height-t.offsetHeight)/2);t.style.top=e+"px",t.style.width=this.width+"px"}else t.style.visibility="hidden"}_getCssSelector(){return"rr-empty"}_initDom(e,t){super._initDom(e,t);const i=e.createElement("span"),r=i.style;r.position="absolute",r.left="20px",r.top="20px",i.className="rr-empty-view rr-empty-message",i.textContent="Report model is not set.",t.appendChild(i);const s=e.createElement("span"),n=s.style;n.position="absolute",n.left="20px",n.bottom="10px",s.className="rr-empty-view rr-empty-bottom",s.textContent="RealReport v1.0",t.appendChild(s);const o=this._errorView=e.createElement("span");o.style.position="absolute",o.className="rr-empty-view rr-empty-error",t.appendChild(o)}}class ReportView extends LayerElement{constructor(e,t=!1,i=!1){super(e,"reportView"),this._loadError="",this._nameMap={},this._modelDirty=!1,this._editable=t,this.addChild(this._activePage=this._pageView=new PageView(e)),i||this.addChild(this._emptyView=this._createEmptyView(e))}_doDispose(){super._doDispose()}addImage(e){this._images[e]=1}imageLoaded(e){delete this._images[e]}imagesAllLoaded(){return Utils.isEmpty(this._images)}get editable(){return this._editable}get model(){return this._model}set model(e){e!==this._model&&(this._model&&this._model.removeListener(this),this._model=e,this._pageView.$_setModel(e&&e.page),this._nameMap={},this._model&&this._model.addListener(this),this._modelDirty=!0,this.invalidateLayout())}get pageView(){return this._pageView}get loadError(){return this._loadError}set loadError(e){this._loadError=e}get zoom(){return 100}getBoxPaddings(e){const t=this._boxMeasurer.style,i=e.styles;if(t.padding="0",t.paddingLeft="0",t.paddingTop="0",i)for(let e in i)"p"==e.charAt(0)&&"a"==e.charAt(1)&&(t[e]=i[e]);t.margin="0",t.border="none";const r=this._boxMeasurer.offsetWidth,s=this._boxMeasurer.offsetHeight,n=this._boxInner.offsetLeft-this._boxMeasurer.offsetLeft,o=this._boxInner.offsetTop-this._boxMeasurer.offsetTop;return{left:n,top:o,right:r-n-1,bottom:s-o-1}}findElement(e){let t=this._nameMap[e];return t||(t=this._activePage.findElement(e),t&&(this._nameMap[e]=t),t)}findElementOf(e){return this._activePage.findElementOf(e)}getElementOf(e){return this._activePage.getElementOf(e)}getItemBoundingRect(e,t=!1){const i=t?Utils.cloneDom(e.dom,t&&e.parent instanceof TableCellElement):e.dom,r=Utils.getBoundingClientRect2(i),s=Utils.getBoundingClientRect2(this._activePage.dom),n=e.offsetSize,o=100/this.zoom;return t&&i.remove(),new Rectangle((r.left-s.left)*o-2,(r.top-s.top)*o-2,n.width,n.height)}_getCssSelector(){return"rr-report-view"}_initDom(e,t){super._initDom(e,t),this._boxMeasurer=e.createElement("div"),this._boxMeasurer.className="box-measurer";let i=this._boxMeasurer.style;i.display="inline-block",i.position="abolute",i.left="0",i.top="0",i.visibility="hidden",i.pointerEvents="none",this._boxInner=e.createElement("div"),this._boxInner.className="box-measurer-inner",i=this._boxInner.style,i.width="1px",i.height="1px",this._boxMeasurer.appendChild(this._boxInner),t.appendChild(this._boxMeasurer)}_createEmptyView(e){return new EmptyView(e)}_layoutPageBorders(e,t){}$_layout(e,t){let i=t.clone();const r=this._model&&this._model.paper;if(!r)return Size.create(i.x,i.y);const s=this._activePage,n=this._emptyView;e.reportView=this,s.visible=!!this._model,this._emptyView.visible=!s.visible;try{if(this._activePage.visible){this._nameMap={},this._model.prepareLayout(),i=r.getContentRect(i.move(0,0));const n=s.measure(e,i.clone());s.layout(e,i.clone()),s.setRect(i),this._layoutPageBorders(t,i);const o=Size.create(t.width,t.height);return n.height>i.height&&(o.height+=n.height-i.height),n.width>i.width&&(o.width+=n.width-i.width),o}return n.setRect(i),n.layoutContent&&n.layoutContent(this),Size.create(i.x,i.y)}finally{this._modelDirty=!1,this._afterLayout(e)}}_afterLayout(e){}$_afterRender(e){const t=this._activePage;e&&e.reportView&&t.visible&&(t.layoutFloating(e),t.afterRender(e))}$_createElement(e){return ReportView.ViewCreators[e.constructor.$_ctor](this.doc,e)}$_preparePrint(e){const t=this._model&&this._model.paper;this._nameMap={},this._model.preparePrint(e),this._model.prepareLayout();const i=t.getClientRect();this._activePage.setRect(i),this.setPrintStyles(),this._images={}}$_endPrint(e){Utils.detach(this._boxMeasurer)}_modelChanged(){this._modelDirty=!0}onReportReset(e){this._modelChanged(),this.invalidateLayout()}onReportPaperChanged(e){this._modelChanged(),this.invalidateLayout()}onReportItemAdded(e,t,i,r){this._modelChanged(),this.invalidateLayout()}onReportItemRemoved(e,t,i){this._modelChanged(),this.invalidateLayout()}onReportItemsRemoved(e,t){this._modelChanged(),this.invalidateLayout()}onReportItemChanged(e,t,i,r,s){this._modelChanged(),this.invalidateLayout()}onReportCommandStackChanged(e,t){}}ReportView.PAGE_HEAD="rr-page-head",ReportView.BACK_HEAD="rr-back-head",ReportView.FRONT_HEAD="rr-front-head",ReportView.ViewCreators={TextItem:(e,t)=>new TextItemElement(e,t),SummaryItem:(e,t)=>new SummaryItemElement(e,t),ImageItem:(e,t)=>new ImageItemElement(e,t),CheckItem:(e,t)=>new CheckItemElement(e,t),SimpleBand:(e,t)=>new SimpleBandElement(e,t),SimpleBandRowGroupHeader:(e,t)=>new SimpleBandGroupHeaderElement(e,t),SimpleBandRowGroupFooter:(e,t)=>new SimpleBandGroupFooterElement(e,t),TableBand:(e,t)=>new TableBandElement(e,t),TableBandRowGroupHeader:(e,t)=>new TableBandGroupHeaderElement(e,t),TableBandRowGroupFooter:(e,t)=>new TableBandGroupFooterElement(e,t),BandGroup:(e,t)=>new BandGroupElement(e,t),BandCell:(e,t)=>new BandGroupCellElement(e,t),CrosstabBand:(e,t)=>new CrosstabBandElement(e,t),RowBoxContainer:(e,t)=>new RowBoxContainerElement(e,t),ColumnBoxContainer:(e,t)=>new ColumnBoxContainerElement(e,t),DiagonalBoxContainer:(e,t)=>new DiagonalBoxContainerElement(e,t),ListContainer:(e,t)=>new ListContainerElement(e,t),TableContainer:(e,t)=>new TableContainerElement(e,t),DataListContainer:(e,t)=>new DataListContainerElement(e,t),SpaceItem:(e,t)=>new SpaceItemElement(e,t),FloatingContainer:(e,t)=>new FloatingContainerElement(e,t),StackContainer:(e,t)=>new StackContainerElementImpl(e,t),ShapeItem:(e,t)=>new ShapeItemElement(e,t),BarItem:(e,t)=>new BarItemElement(e,t),RatingItem:(e,t)=>new RatingItemElement(e,t),BarcodeItem:(e,t)=>new BarcodeItemElement(e,t),QrcodeItem:(e,t)=>new QrcodeItemElement(e,t),DataMatrixItem:(e,t)=>new DataMatrixItemElement(e,t),SvgItem:(e,t)=>new SvgItemElement(e,t),HtmlItem:(e,t)=>new HtmlItemElement(e,t),HichartItem:(e,t)=>new HichartItemElement(e,t),PageItem:(e,t)=>new PageItemElement(e,t)};class ErrorView$1 extends VisualElement{_initDom(e,t){super._initDom(e,t),t.className="rr-print-error",Utils.extend(t.style,{display:"flex",alignItems:"center",top:"0px",width:"90%",height:"90%",background:"rgb(238, 238, 238, 0.95)",border:"2px dashed red",paddingTop:"8px",paddingLeft:"12px",zIndex:10}),t.appendChild(this._title=e.createElement("div")),Utils.extend(this._title.style,{color:"#333",fontWeight:"bold",fontSize:"1.3em",marginBottom:"8px",textDecoration:"underline"}),this._title.innerHTML="Print Error",t.appendChild(this._span=e.createElement("div")),Utils.extend(this._span.style,{color:"#333"}),this.visible=!1}setError(e){this._span.innerHTML=e}}class PrintContainer extends VisualContainer{constructor(e){super(e),this._pageGap=20,this._zoom=1,this._align=Align.CENTER,this._styles={},this.traceMode=!1,this._preview=!1,this._errorView=new ErrorView$1(this.doc),this._containerDiv.appendChild(this._errorView.dom)}_doDispose(){super._doDispose()}get pageCount(){return this._pages.length}get page(){const e=this._pages,t=this.scrollTop;for(let i=0;i<e.length;i++){const r=e[i].page.offsetTop,s=r+e[i].page.offsetHeight;if(r>=t&&r<t+this.scrollHeight||s>=t&&s<t+this.scrollHeight)return i}return e.length}set page(e){e=Math.max(0,Math.min(this._pages.length-1,e));this._pages[e].page.scrollIntoView({behavior:"smooth"})}get zoom(){return this._zoom}set zoom(e){var t;(e=Math.max(.1,Utils.toNumber(e)))!==this._zoom&&(this._zoom=e,this.$_resetPreviewer(),null===(t=this.onZoomed)||void 0===t||t.call(this,this._zoom))}get pages(){var e;return null===(e=this._pages)||void 0===e?void 0:e.slice(0)}print(e){Utils.isObject(e)&&(e=this._options=Object.assign({},{id:"",async:!1,pageMark:!0,noScroll:!1},e),this._pages=[],Utils.isArray(e.report)?this.printAll(e):e.report instanceof Report&&this.printSingle(e))}printSingle(e){if(!(e&&e.report instanceof Report))return;const t=e.report,i=e.data,r=e.async,s=e.preview,n=e.id,o=e.callback,a=e.endCallback;try{this._previewId=e.id,(this._preview=e.preview)&&(this._indicator=this.$_createIndicator(this.doc),this._containerDiv.appendChild(this._indicator)),this._reportView&&this.removeElement(this._reportView),this.addElement(this._reportView=new ReportView(this.doc,!1,!0));const r=this._context=new PrintContext(!0),s=this._reportView,n=e.report.info.paper.getClientRect();t._data=i,s.model=t,r.dp=i,r.designDp=t.designData,r.assets=t.assets,r.reportView=s,r.pageWidth=n.width,r.pageHeight=n.height,r.firstReport=r,r.preparePrint()}catch(e){const t=this.$_getPreviewer(n);return t&&(t.style.display="none"),Utils.remove(this._indicator),void this.$_showError(null,e)}s?this._isTesting?this.$_printSingle2(this.doc,this._context,!0,n,r,o,a):setTimeout((()=>{this.$_printSingle2(this.doc,this._context,!0,n,r,o,a)}),0):this.$_printSingle2(this.doc,this._context,!1,n,r,o,a)}$_printSingle2(e,t,i,r,s,n,o){s?this.$_printAsync(this.doc,this._context,i,r,!0,n,o):this.$_printAsync(this.doc,this._context,i,r,!1)}printAll(e){if(!e||!Array.isArray(e.report)||0===e.report.length)return;const t=e.report,i=e.data,r=e.id,s=e.preview,n=e.async,o=e.callback,a=e.endCallback,A=t.length;for(let e=0;e<A;e++)t[e]instanceof Report?t[e]={report:t[e],data:i}:t[e]._data=t[e].data||i;if(1===A){const i=t[0];return this.printSingle({report:i.report,data:i.data,preview:s,id:r,async:n}),void this.printSingle(e)}try{this._previewId=r,(this._preview=s)&&(this._indicator=this.$_createIndicator(this.doc),this._containerDiv.appendChild(this._indicator)),this._reportViews&&this._reportViews.forEach((e=>this.removeElement(e))),this._reportViews=[],this._contexts=[];for(let e=0;e<A;e++){const e=new PrintContext(!0,!0),t=new ReportView(this.doc,!1,!0);this._contexts.push(e),this.addElement(t),this._reportViews.push(t),e.reportView=t}t.forEach(((e,t)=>{const i=e.report,r=e.data,s=this._contexts[t],n=this._reportViews[t],o=i.info.paper.getClientRect();i._data=r,n.model=i,s.dp=r,s.designDp=i.designData,s.assets=i.assets,s.reportView=n,s.pageWidth=o.width,s.pageHeight=o.height,s.preparePrint()}))}catch(e){const t=this.$_getPreviewer(r);return t&&(t.style.display="none"),Utils.remove(this._indicator),void this.$_showError(null,e)}s?this._isTesting?this.$_printAll2(this.doc,this._contexts,!0,r,n,o,a):setTimeout((()=>{this.$_printAll2(this.doc,this._contexts,!0,r,n,o,a)}),0):this.$_printAll2(this.doc,this._contexts,!1,r,n,o,a)}$_printAll2(e,t,i,r,s,n,o){s?this.$_print2Async(e,t,i,r,!0,n,o):this.$_print2Async(e,t,i,r,!1,n,o)}isAllRendered(){return!!this.$_getContainer().getElementsByClassName(PrintContainer.CONFIRM_CLASS)}getPrintHtml(){const e=this.$_getPreviewer(this._previewId),t=e?parseFloat(e.style.left):0,i=this.zoom;try{return this.zoom=1,e&&(e.style.left="0px"),this.$_getContainer().innerHTML}finally{this.zoom=i,e&&(e.style.left=t+"px")}}setStyles(e){this._styles=e,this.$_resetPreviewer()}fitToWidth(){const e=this.$_getContainer().offsetWidth,t=this.$_getPreviewer(this._previewId).offsetWidth;this.zoom=e/t}fitToHeight(){const e=this._pages.length,t=this.$_getContainer().offsetHeight,i=(this.$_getPreviewer(this._previewId).offsetHeight-this._pageGap*(e-1))/e;this.zoom=t/i}fitToPage(){const e=this._pages.length,t=this.$_getContainer().offsetWidth,i=this.$_getPreviewer(this._previewId).offsetWidth,r=this.$_getContainer().offsetHeight,s=(this.$_getPreviewer(this._previewId).offsetHeight-this._pageGap*(e-1))/e;this.zoom=Math.min(t/i,r/s)}get printing(){return!0}_doPrepareContainer(e){super._doPrepareContainer(e),e.dataset.print="1",e.classList.add("rr-report-root"),e.classList.add(PrintContainer.CLASS_NAME)}_render(e){}_doResized(){if(this._preview){const e=this.$_getPreviewer(this._previewId);e&&e.parentElement&&this.$_resetPreviewer()}}$_showError(e,t){if(this._errorView.visible=!0,this._errorView.setError('<span class="rr-print-error-title">'+(t.message||t)+"</span><br/><br/>"+Utils.getErrorStack(t)),Utils.detach(e),this.traceMode)throw t}$_createIndicator(e){const t=this._containerDiv.getBoundingClientRect(),i=this.doc.createElement("div");return i.className="rr-print-indicator",Utils.extend(i.style,{position:"fixed",width:t.width+"px",height:t.height+"px",top:"0px",zIndex:1e3,pointerEvents:"none"}),i}$_refreshContextValues(e){let t=e.pages.length;if(e.pages.forEach(((i,r)=>{let s=i.pageFooter.querySelectorAll('[data-rr_ctx_val="${pages}"]');s.forEach((e=>e.textContent=`${t}`)),s=i.pageHeader.querySelectorAll('[data-rr_ctx_val="${pages}"]'),s.forEach((e=>e.textContent=`${t}`)),s=i.pageFooter.querySelectorAll("[data-rr_ctx_call]"),s.forEach((t=>{const i=e.contextElements[t.dataset.rr_ctx_view];e._page=+t.dataset.rr_ctx_call,i._span=t,i.refreshPrintValues(e)}))})),e.reportIndex===e.reportCount-1){let i=e.firstReport;for(t+=e.prevPages;i;)i.pages.forEach(((i,r)=>{let s=i.pageFooter.querySelectorAll('[data-rr_ctx_val="${all-pages}"]');s.forEach((e=>e.textContent=`${t}`)),s=i.pageHeader.querySelectorAll('[data-rr_ctx_val="${all-pages}"]'),s.forEach((e=>e.textContent=`${t}`)),s=i.pageFooter.querySelectorAll("[data-rr_ctx_all_call]"),s.forEach((t=>{const i=e.contextElements[t.dataset.rr_ctx_view];i&&(e._page=+t.dataset.rr_ctx_call,e._compositePage=+t.dataset.rr_ctx_all_call,i._span=t,i.refreshPrintValues(e))}))})),i=i.nextReport}}$_printAsync(e,t,i,r,s,n,o){function a(e,i){const r=t.floatings;if(r.length>0){const t=[];for(let e of r){const r=e.$_anc;for(let s of i){const i=s.page;if(i.contains(r)){t.push(i),s.contents.push(e);break}}}e.$_layoutFloatings(t,r)}}function A(a){if(t.reportIndex===t.reportCount-1){if(t.setCompositePageCount(t.prevPages+t.pages.length),t.async&&l.pageMark){const e=a._containerDiv.getElementsByClassName("rr-report-page-marker")[0];e&&(e.textContent=e.textContent+"(s) printed.",e.animate([{opacity:"1"},{opacity:"0"}],{duration:2e3}),setTimeout((()=>{a._containerDiv&&a._containerDiv.removeChild(e)})))}c.$_endPrint(t),Utils.remove(a._indicator),Utils.detach(a._containerDom),console.log("Printed in "+(+new Date-d)+"ms.")}else i&&a.$_addPageSpace(e,t.container),t.nextReport.prevPages=t.prevPages+t.pages.length,a.$_printAsync(e,t.nextReport,i,r,s,n,o)}const l=this._options,h=e.getElementById(PrintContainer.PREVIEW_CLASS+r);let d;0===t.reportIndex&&(d=+new Date,h&&(Utils.detach(h),this._containerDiv.appendChild(this._containerDom)),this._errorView.visible=!1);const c=t.reportView,u=c.pageView;t.async=s,t.preview=i,t.designDp&&t.designDp.preparePrint(t),t.dp&&t.dp.preparePrint(t),t.floatings=[],t.contextElements={},c.$_preparePrint(t);const p=u.prepareAsync(e,t);try{const s=function(s){let n,o;if(0===t.reportIndex){s._containerDom.style.opacity="0",n=e.createElement("div"),n.className="rr-print-back",n.style.position="absolute",n.style.width="100%",n.style.height="100%",s._containerDiv.appendChild(n);const a=e.createElement("div");i&&(a.id=PrintContainer.PREVIEW_CLASS+r),a.className="rr-report-root"+(i?" "+PrintContainer.PREVIEW_CLASS:""),a.style.setProperty("position","absolute","important"),a.style.setProperty("transform-origin","top left","important"),n.appendChild(a),t.container=a,l.pageMark&&(o=e.createElement("span"),o.className="rr-report-page-marker",Object.assign(o.style,{position:"fixed",fontFamily:"Arial Bold",fontSize:"100px",color:"#0000ff80",top:"calc(50% - .5em)",width:"100%",textAlign:"center"}),s._containerDiv.appendChild(o))}else n=s._containerDiv.getElementsByClassName("rr-print-back")[0],t.container=n.getElementsByClassName("rr-report-root")[0],l.pageMark&&(o=s._containerDiv.getElementsByClassName("rr-report-page-marker")[0]);return o}(this),h=[];if(t.async)this.$_buildOutputAsync(e,i,t,h,p,0,0,((e,t,i)=>{s&&(s.textContent=e.prevPages+i+1+"Page"),0===i&&this.$_resetPreviewer(),n&&n(e,t,i)}),((e,t)=>{a(this,t),A(this),this._pages=this._pages.concat(t),o&&o(e,this._pages)}));else{let r=0,s=0;if(p.length>0)for(;s<p.length;)s=this.$_buildOutputAsync(e,i,t,h,p,s,r,null,null),0==r++&&this.$_resetPreviewer();else this.$_buildOutputAsync(e,i,t,h,p,0,0,null,null),this.$_resetPreviewer();this.$_refreshContextValues(t),a(this,h),A(this),this._pages=h.concat(this._pages)}}catch(e){return Utils.remove(this._indicator),this.$_showError(h,e),void console.error(e)}}$_print2Async(e,t,i,r,s,n,o){const a=t.length;for(let e=0;e<a;e++){const i=t[e];i.reportCount=a,i.reportIndex=e,i.firstReport=t[0],i.nextReport=t[e+1]}this.$_printAsync(e,t[0],i,r,s)}$_getContainer(){return this._containerDiv}$_getPreviewer(e){return this.doc.getElementById(PrintContainer.PREVIEW_CLASS+(e||this._previewId))}$_resetPreviewer(){if(this._preview){const e=this.$_getPreviewer(this._previewId),t=this.$_getContainer().getBoundingClientRect(),i=this._zoom;Utils.extend(e.style,this._styles),e.style.transform=1==i?"":"scale("+i+")";const r=e.getBoundingClientRect().width||t.width;let s=0;switch(this._align){case Align.LEFT:break;case Align.RIGHT:s=t.width-r;break;case Align.CENTER:default:s=Math.round((t.width-r)/2)}e.style.left=Math.max(0,s)+"px"}}$_addPageSpace(e,t){const i=e.createElement("div");i.className="rr-print-space",i.style.height=this._pageGap+"px",t.appendChild(i)}$_buildOutputAsync(e,t,i,r,s,n,o,a,A){const l=i.reportView.pageView,h=i.report,d=h.page.pageHeader,c=h.page.pageFooter,u=h.page.reportFooter,p=h.info.paper,_=p.getClientRect().height,g=new PrintPage,m=g.contents,f=e.createElement("div"),w=e.createElement("div"),C=i.floatings,y=i.reportView.pageView.bodyView.itemsView.gap,E=n;let b;i.preparePage(o,i.prevPages+o);for(let e of i.contextValues)e.refreshPrintValues(i);g.page=f,f.className="rr-print-div2",w.className="rr-print-div3",i.preview&&(f.className="rr-print-page rr-page-break page"+o,f.dataset.page=o+"",p.applyPreviewExtents(f.style),p.applyPreviewClient(w.style)),w.style.position="absolute",f.appendChild(w),i.container.appendChild(f),g.background=b=l.backFloatingView.cloneNode(),w.appendChild(b);let B=0+Utils.toNumber(d.spaceTop);b=l.pageHeaderView.cloneNode(),b.style.top=B+"px",B+=b.$_h=l.pageHeaderView.$_h,g.pageHeader=b,w.appendChild(b),b=l.pageFooterView.cloneNode(),b.$_h=l.pageFooterView.$_h,g.pageFooter=b;const P=_-b.$_h-Utils.toNumber(c.spaceBottom);for(b.style.top=P+"px",w.appendChild(b),i.h=i.bodyHeight,0==o&&(b=l.reportHeaderView.cloneNode(),b.$_h=l.reportHeaderView.$_h,b.style.top=B+"px",m.push(b),w.appendChild(b),i.h-=b.$_h,B+=b.$_h);n<s.length&&i.h>0;){const t=s[n];if(t instanceof PageBreaker){n++;break}if(t instanceof HTMLDivElement){if(t.$_anc)C.push(t);else{let e=t.$_h;if(e>i.h&&t.classList.contains("rr-space")&&(e=i.h),i.h-e<0&&n>E)break;m.push(t),t.style.top=B+"px",w.appendChild(t),B+=e+y,i.h-=e+y}n++}else if(t instanceof BandPrintInfo){const r=t.getNextPage(e,i,i.pageWidth,w);if(r){m.push(r),r.style.top=B+"px";const e=r.$_h;if(B+=e,i.h-=e,i.h<=0){t.isEnded()&&n++;break}B+=y,i.h-=y}t.isEnded()&&n++}else n++}if(n==s.length&&l.reportFooterView.visible){b=l.reportFooterView.cloneNode();const e=b.$_h=l.reportFooterView.$_h;if(e>0){let t;t=u.alignToBottom?P-e:B,b.style.top=t+"px",i.h-=e,w.appendChild(b)}}if(g.foreground=b=l.frontFloatingView.cloneNode(),w.appendChild(b),a&&a(i,g,o),r.push(g),i.pages.push(g),i.async&&!this._options.noScroll&&g.page.scrollIntoView({behavior:"auto"}),C.length>0){const e=[],t=[];for(let i of C){const r=i.$_anc;if(w.contains(r)){e.push(w),m.push(i),t.push(i);break}}this.$_layoutFloatings(e,t)}const S=o+1;return i.finishPrint(S),n<s.length?(t&&this.$_addPageSpace(e,i.container),i.async&&setTimeout((()=>{try{this.$_buildOutputAsync(e,t,i,r,s,n,o+1,a,A)}catch(e){Utils.remove(this._indicator),this.$_showError(i.container.parentElement,e),console.error(e)}}),100),n):(i.async&&(this.$_refreshContextValues(i),A&&A(i,r)),s.length)}$_layoutFloatings(e,t){t.forEach(((t,i)=>{const r=t.$_anc,s=t.$anp;let n=r.offsetLeft,o=r.offsetTop,a=r.offsetParent;const A=e[i];for(;a instanceof HTMLElement&&a!==A;)n+=a.offsetLeft,o+=a.offsetTop,a=a.offsetParent;switch(A.appendChild(t),s){case AnchorPosition.INNER_LEFT:o-=(t.offsetHeight-r.offsetHeight)/2;break;case AnchorPosition.LEFT:n-=t.offsetWidth,o-=(t.offsetHeight-r.offsetHeight)/2;break;case AnchorPosition.INNER_RIGHT:n+=r.offsetWidth-t.offsetWidth,o-=(t.offsetHeight-r.offsetHeight)/2;break;case AnchorPosition.RIGHT:n+=r.offsetWidth,o-=(t.offsetHeight-r.offsetHeight)/2;break;case AnchorPosition.INNER_TOP:n-=(t.offsetWidth-r.offsetWidth)/2;break;case AnchorPosition.TOP:n-=(t.offsetWidth-r.offsetWidth)/2,o-=t.offsetHeight;break;case AnchorPosition.INNER_BOTTOM:n-=(t.offsetWidth-r.offsetWidth)/2,o+=r.offsetHeight-t.offsetHeight;break;case AnchorPosition.BOTTOM:n-=(t.offsetWidth-r.offsetWidth)/2,o+=r.offsetHeight;break;case AnchorPosition.CENTER:default:n-=(t.offsetWidth-r.offsetWidth)/2,o-=(t.offsetHeight-r.offsetHeight)/2}t.style.left=n+"px",t.style.top=o+"px"}))}}PrintContainer.CLASS_NAME="rr-report-container",PrintContainer.PREVIEW_CLASS="rr-report-preview",PrintContainer.CONFIRM_CLASS="rr-rendered";var extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},extendStatics(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var __assign=function(){return __assign=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},__assign.apply(this,arguments)};function __awaiter(e,t,i,r){return new(i||(i=Promise))((function(s,n){function o(e){try{A(r.next(e))}catch(e){n(e)}}function a(e){try{A(r.throw(e))}catch(e){n(e)}}function A(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}A((r=r.apply(e,t||[])).next())}))}function __generator(e,t){var i,r,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,r&&(s=2&n[0]?r.return:n[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,n[1])).done)return s;switch(r=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,r=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){o.label=n[1];break}if(6===n[0]&&o.label<s[1]){o.label=s[1],s=n;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(n);break}s[2]&&o.ops.pop(),o.trys.pop();continue}n=t.call(e,o)}catch(e){n=[6,e],r=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}function __spreadArray(e,t,i){if(i||2===arguments.length)for(var r,s=0,n=t.length;s<n;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||t)}for(var Bounds=function(){function e(e,t,i,r){this.left=e,this.top=t,this.width=i,this.height=r}return e.prototype.add=function(t,i,r,s){return new e(this.left+t,this.top+i,this.width+r,this.height+s)},e.fromClientRect=function(t,i){return new e(i.left+t.windowBounds.left,i.top+t.windowBounds.top,i.width,i.height)},e.fromDOMRectList=function(t,i){var r=Array.from(i).find((function(e){return 0!==e.width}));return r?new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),parseBounds=function(e,t){return Bounds.fromClientRect(e,t.getBoundingClientRect())},parseDocumentSize=function(e){var t=e.body,i=e.documentElement;if(!t||!i)throw new Error("Unable to get document size");var r=Math.max(Math.max(t.scrollWidth,i.scrollWidth),Math.max(t.offsetWidth,i.offsetWidth),Math.max(t.clientWidth,i.clientWidth)),s=Math.max(Math.max(t.scrollHeight,i.scrollHeight),Math.max(t.offsetHeight,i.offsetHeight),Math.max(t.clientHeight,i.clientHeight));return new Bounds(0,0,r,s)},toCodePoints$1=function(e){for(var t=[],i=0,r=e.length;i<r;){var s=e.charCodeAt(i++);if(s>=55296&&s<=56319&&i<r){var n=e.charCodeAt(i++);56320==(64512&n)?t.push(((1023&s)<<10)+(1023&n)+65536):(t.push(s),i--)}else t.push(s)}return t},fromCodePoint$1=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var i=e.length;if(!i)return"";for(var r=[],s=-1,n="";++s<i;){var o=e[s];o<=65535?r.push(o):(o-=65536,r.push(55296+(o>>10),o%1024+56320)),(s+1===i||r.length>16384)&&(n+=String.fromCharCode.apply(String,r),r.length=0)}return n},chars$2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$2="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$2=0;i$2<chars$2.length;i$2++)lookup$2[chars$2.charCodeAt(i$2)]=i$2;for(var chars$1$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1$1="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$1$1=0;i$1$1<chars$1$1.length;i$1$1++)lookup$1$1[chars$1$1.charCodeAt(i$1$1)]=i$1$1;for(var decode$1=function(e){var t,i,r,s,n,o=.75*e.length,a=e.length,A=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var l="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),h=Array.isArray(l)?l:new Uint8Array(l);for(t=0;t<a;t+=4)i=lookup$1$1[e.charCodeAt(t)],r=lookup$1$1[e.charCodeAt(t+1)],s=lookup$1$1[e.charCodeAt(t+2)],n=lookup$1$1[e.charCodeAt(t+3)],h[A++]=i<<2|r>>4,h[A++]=(15&r)<<4|s>>2,h[A++]=(3&s)<<6|63&n;return l},polyUint16Array$1=function(e){for(var t=e.length,i=[],r=0;r<t;r+=2)i.push(e[r+1]<<8|e[r]);return i},polyUint32Array$1=function(e){for(var t=e.length,i=[],r=0;r<t;r+=4)i.push(e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]);return i},UTRIE2_SHIFT_2$1=5,UTRIE2_SHIFT_1$1=11,UTRIE2_INDEX_SHIFT$1=2,UTRIE2_SHIFT_1_2$1=UTRIE2_SHIFT_1$1-UTRIE2_SHIFT_2$1,UTRIE2_LSCP_INDEX_2_OFFSET$1=65536>>UTRIE2_SHIFT_2$1,UTRIE2_DATA_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_2$1,UTRIE2_DATA_MASK$1=UTRIE2_DATA_BLOCK_LENGTH$1-1,UTRIE2_LSCP_INDEX_2_LENGTH$1=1024>>UTRIE2_SHIFT_2$1,UTRIE2_INDEX_2_BMP_LENGTH$1=UTRIE2_LSCP_INDEX_2_OFFSET$1+UTRIE2_LSCP_INDEX_2_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_OFFSET$1=UTRIE2_INDEX_2_BMP_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_LENGTH$1=32,UTRIE2_INDEX_1_OFFSET$1=UTRIE2_UTF8_2B_INDEX_2_OFFSET$1+UTRIE2_UTF8_2B_INDEX_2_LENGTH$1,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1=65536>>UTRIE2_SHIFT_1$1,UTRIE2_INDEX_2_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_1_2$1,UTRIE2_INDEX_2_MASK$1=UTRIE2_INDEX_2_BLOCK_LENGTH$1-1,slice16$1=function(e,t,i){return e.slice?e.slice(t,i):new Uint16Array(Array.prototype.slice.call(e,t,i))},slice32$1=function(e,t,i){return e.slice?e.slice(t,i):new Uint32Array(Array.prototype.slice.call(e,t,i))},createTrieFromBase64$1=function(e,t){var i=decode$1(e),r=Array.isArray(i)?polyUint32Array$1(i):new Uint32Array(i),s=Array.isArray(i)?polyUint16Array$1(i):new Uint16Array(i),n=slice16$1(s,12,r[4]/2),o=2===r[5]?slice16$1(s,(24+r[4])/2):slice32$1(r,Math.ceil((24+r[4])/4));return new Trie$1(r[0],r[1],r[2],r[3],n,o)},Trie$1=function(){function e(e,t,i,r,s,n){this.initialValue=e,this.errorValue=t,this.highStart=i,this.highValueIndex=r,this.index=s,this.data=n}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>UTRIE2_SHIFT_2$1])<<UTRIE2_INDEX_SHIFT$1)+(e&UTRIE2_DATA_MASK$1),this.data[t];if(e<=65535)return t=((t=this.index[UTRIE2_LSCP_INDEX_2_OFFSET$1+(e-55296>>UTRIE2_SHIFT_2$1)])<<UTRIE2_INDEX_SHIFT$1)+(e&UTRIE2_DATA_MASK$1),this.data[t];if(e<this.highStart)return t=UTRIE2_INDEX_1_OFFSET$1-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1+(e>>UTRIE2_SHIFT_1$1),t=this.index[t],t+=e>>UTRIE2_SHIFT_2$1&UTRIE2_INDEX_2_MASK$1,t=((t=this.index[t])<<UTRIE2_INDEX_SHIFT$1)+(e&UTRIE2_DATA_MASK$1),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),chars$3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$3="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$3=0;i$3<chars$3.length;i$3++)lookup$3[chars$3.charCodeAt(i$3)]=i$3;var base64$1="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",LETTER_NUMBER_MODIFIER=50,BK=1,CR$1=2,LF$1=3,CM=4,NL=5,WJ=7,ZW=8,GL=9,SP=10,ZWJ$1=11,B2=12,BA=13,BB=14,HY=15,CB=16,CL=17,CP=18,EX=19,IN=20,NS=21,OP=22,QU=23,IS=24,NU=25,PO=26,PR=27,SY=28,AI=29,AL=30,CJ=31,EB=32,EM=33,H2=34,H3=35,HL=36,ID=37,JL=38,JV=39,JT=40,RI$1=41,SA=42,XX=43,ea_OP=[9001,65288],BREAK_MANDATORY="!",BREAK_NOT_ALLOWED$1="×",BREAK_ALLOWED$1="÷",UnicodeTrie$1=createTrieFromBase64$1(base64$1),ALPHABETICS=[AL,HL],HARD_LINE_BREAKS=[BK,CR$1,LF$1,NL],SPACE$1=[SP,ZW],PREFIX_POSTFIX=[PR,PO],LINE_BREAKS=HARD_LINE_BREAKS.concat(SPACE$1),KOREAN_SYLLABLE_BLOCK=[JL,JV,JT,H2,H3],HYPHEN=[HY,BA],codePointsToCharacterClasses=function(e,t){void 0===t&&(t="strict");var i=[],r=[],s=[];return e.forEach((function(e,n){var o=UnicodeTrie$1.get(e);if(o>LETTER_NUMBER_MODIFIER?(s.push(!0),o-=LETTER_NUMBER_MODIFIER):s.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return r.push(n),i.push(CB);if(o===CM||o===ZWJ$1){if(0===n)return r.push(n),i.push(AL);var a=i[n-1];return-1===LINE_BREAKS.indexOf(a)?(r.push(r[n-1]),i.push(a)):(r.push(n),i.push(AL))}return r.push(n),o===CJ?i.push("strict"===t?NS:ID):o===SA||o===AI?i.push(AL):o===XX?e>=131072&&e<=196605||e>=196608&&e<=262141?i.push(ID):i.push(AL):void i.push(o)})),[r,i,s]},isAdjacentWithSpaceIgnored=function(e,t,i,r){var s=r[i];if(Array.isArray(e)?-1!==e.indexOf(s):e===s)for(var n=i;n<=r.length;){if((A=r[++n])===t)return!0;if(A!==SP)break}if(s===SP)for(n=i;n>0;){var o=r[--n];if(Array.isArray(e)?-1!==e.indexOf(o):e===o)for(var a=i;a<=r.length;){var A;if((A=r[++a])===t)return!0;if(A!==SP)break}if(o!==SP)break}return!1},previousNonSpaceClassType=function(e,t){for(var i=e;i>=0;){var r=t[i];if(r!==SP)return r;i--}return 0},_lineBreakAtIndex=function(e,t,i,r,s){if(0===i[r])return BREAK_NOT_ALLOWED$1;var n=r-1;if(Array.isArray(s)&&!0===s[n])return BREAK_NOT_ALLOWED$1;var o=n-1,a=n+1,A=t[n],l=o>=0?t[o]:0,h=t[a];if(A===CR$1&&h===LF$1)return BREAK_NOT_ALLOWED$1;if(-1!==HARD_LINE_BREAKS.indexOf(A))return BREAK_MANDATORY;if(-1!==HARD_LINE_BREAKS.indexOf(h))return BREAK_NOT_ALLOWED$1;if(-1!==SPACE$1.indexOf(h))return BREAK_NOT_ALLOWED$1;if(previousNonSpaceClassType(n,t)===ZW)return BREAK_ALLOWED$1;if(UnicodeTrie$1.get(e[n])===ZWJ$1)return BREAK_NOT_ALLOWED$1;if((A===EB||A===EM)&&UnicodeTrie$1.get(e[a])===ZWJ$1)return BREAK_NOT_ALLOWED$1;if(A===WJ||h===WJ)return BREAK_NOT_ALLOWED$1;if(A===GL)return BREAK_NOT_ALLOWED$1;if(-1===[SP,BA,HY].indexOf(A)&&h===GL)return BREAK_NOT_ALLOWED$1;if(-1!==[CL,CP,EX,IS,SY].indexOf(h))return BREAK_NOT_ALLOWED$1;if(previousNonSpaceClassType(n,t)===OP)return BREAK_NOT_ALLOWED$1;if(isAdjacentWithSpaceIgnored(QU,OP,n,t))return BREAK_NOT_ALLOWED$1;if(isAdjacentWithSpaceIgnored([CL,CP],NS,n,t))return BREAK_NOT_ALLOWED$1;if(isAdjacentWithSpaceIgnored(B2,B2,n,t))return BREAK_NOT_ALLOWED$1;if(A===SP)return BREAK_ALLOWED$1;if(A===QU||h===QU)return BREAK_NOT_ALLOWED$1;if(h===CB||A===CB)return BREAK_ALLOWED$1;if(-1!==[BA,HY,NS].indexOf(h)||A===BB)return BREAK_NOT_ALLOWED$1;if(l===HL&&-1!==HYPHEN.indexOf(A))return BREAK_NOT_ALLOWED$1;if(A===SY&&h===HL)return BREAK_NOT_ALLOWED$1;if(h===IN)return BREAK_NOT_ALLOWED$1;if(-1!==ALPHABETICS.indexOf(h)&&A===NU||-1!==ALPHABETICS.indexOf(A)&&h===NU)return BREAK_NOT_ALLOWED$1;if(A===PR&&-1!==[ID,EB,EM].indexOf(h)||-1!==[ID,EB,EM].indexOf(A)&&h===PO)return BREAK_NOT_ALLOWED$1;if(-1!==ALPHABETICS.indexOf(A)&&-1!==PREFIX_POSTFIX.indexOf(h)||-1!==PREFIX_POSTFIX.indexOf(A)&&-1!==ALPHABETICS.indexOf(h))return BREAK_NOT_ALLOWED$1;if(-1!==[PR,PO].indexOf(A)&&(h===NU||-1!==[OP,HY].indexOf(h)&&t[a+1]===NU)||-1!==[OP,HY].indexOf(A)&&h===NU||A===NU&&-1!==[NU,SY,IS].indexOf(h))return BREAK_NOT_ALLOWED$1;if(-1!==[NU,SY,IS,CL,CP].indexOf(h))for(var d=n;d>=0;){if((c=t[d])===NU)return BREAK_NOT_ALLOWED$1;if(-1===[SY,IS].indexOf(c))break;d--}if(-1!==[PR,PO].indexOf(h))for(d=-1!==[CL,CP].indexOf(A)?o:n;d>=0;){var c;if((c=t[d])===NU)return BREAK_NOT_ALLOWED$1;if(-1===[SY,IS].indexOf(c))break;d--}if(JL===A&&-1!==[JL,JV,H2,H3].indexOf(h)||-1!==[JV,H2].indexOf(A)&&-1!==[JV,JT].indexOf(h)||-1!==[JT,H3].indexOf(A)&&h===JT)return BREAK_NOT_ALLOWED$1;if(-1!==KOREAN_SYLLABLE_BLOCK.indexOf(A)&&-1!==[IN,PO].indexOf(h)||-1!==KOREAN_SYLLABLE_BLOCK.indexOf(h)&&A===PR)return BREAK_NOT_ALLOWED$1;if(-1!==ALPHABETICS.indexOf(A)&&-1!==ALPHABETICS.indexOf(h))return BREAK_NOT_ALLOWED$1;if(A===IS&&-1!==ALPHABETICS.indexOf(h))return BREAK_NOT_ALLOWED$1;if(-1!==ALPHABETICS.concat(NU).indexOf(A)&&h===OP&&-1===ea_OP.indexOf(e[a])||-1!==ALPHABETICS.concat(NU).indexOf(h)&&A===CP)return BREAK_NOT_ALLOWED$1;if(A===RI$1&&h===RI$1){for(var u=i[n],p=1;u>0&&t[--u]===RI$1;)p++;if(p%2!=0)return BREAK_NOT_ALLOWED$1}return A===EB&&h===EM?BREAK_NOT_ALLOWED$1:BREAK_ALLOWED$1},cssFormattedClasses=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var i=codePointsToCharacterClasses(e,t.lineBreak),r=i[0],s=i[1],n=i[2];"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(s=s.map((function(e){return-1!==[NU,AL,SA].indexOf(e)?ID:e})));var o="keep-all"===t.wordBreak?n.map((function(t,i){return t&&e[i]>=19968&&e[i]<=40959})):void 0;return[r,s,o]},Break=function(){function e(e,t,i,r){this.codePoints=e,this.required=t===BREAK_MANDATORY,this.start=i,this.end=r}return e.prototype.slice=function(){return fromCodePoint$1.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),LineBreaker=function(e,t){var i=toCodePoints$1(e),r=cssFormattedClasses(i,t),s=r[0],n=r[1],o=r[2],a=i.length,A=0,l=0;return{next:function(){if(l>=a)return{done:!0,value:null};for(var e=BREAK_NOT_ALLOWED$1;l<a&&(e=_lineBreakAtIndex(i,n,s,++l,o))===BREAK_NOT_ALLOWED$1;);if(e!==BREAK_NOT_ALLOWED$1||l===a){var t=new Break(i,e,A,l);return A=l,{value:t,done:!1}}return{done:!0,value:null}}}},FLAG_UNRESTRICTED=1,FLAG_ID=2,FLAG_INTEGER=4,FLAG_NUMBER=8,LINE_FEED=10,SOLIDUS=47,REVERSE_SOLIDUS=92,CHARACTER_TABULATION=9,SPACE=32,QUOTATION_MARK=34,EQUALS_SIGN=61,NUMBER_SIGN=35,DOLLAR_SIGN=36,PERCENTAGE_SIGN=37,APOSTROPHE=39,LEFT_PARENTHESIS=40,RIGHT_PARENTHESIS=41,LOW_LINE=95,HYPHEN_MINUS=45,EXCLAMATION_MARK=33,LESS_THAN_SIGN=60,GREATER_THAN_SIGN=62,COMMERCIAL_AT=64,LEFT_SQUARE_BRACKET=91,RIGHT_SQUARE_BRACKET=93,CIRCUMFLEX_ACCENT=61,LEFT_CURLY_BRACKET=123,QUESTION_MARK=63,RIGHT_CURLY_BRACKET=125,VERTICAL_LINE=124,TILDE=126,CONTROL=128,REPLACEMENT_CHARACTER=65533,ASTERISK=42,PLUS_SIGN=43,COMMA=44,COLON=58,SEMICOLON=59,FULL_STOP=46,NULL=0,BACKSPACE=8,LINE_TABULATION=11,SHIFT_OUT=14,INFORMATION_SEPARATOR_ONE=31,DELETE=127,EOF$1=-1,ZERO=48,a=97,e=101,f=102,u=117,z=122,A=65,E=69,F=70,U=85,Z=90,isDigit=function(e){return e>=ZERO&&e<=57},isSurrogateCodePoint=function(e){return e>=55296&&e<=57343},isHex=function(e){return isDigit(e)||e>=A&&e<=F||e>=a&&e<=f},isLowerCaseLetter=function(e){return e>=a&&e<=z},isUpperCaseLetter=function(e){return e>=A&&e<=Z},isLetter=function(e){return isLowerCaseLetter(e)||isUpperCaseLetter(e)},isNonASCIICodePoint=function(e){return e>=CONTROL},isWhiteSpace=function(e){return e===LINE_FEED||e===CHARACTER_TABULATION||e===SPACE},isNameStartCodePoint=function(e){return isLetter(e)||isNonASCIICodePoint(e)||e===LOW_LINE},isNameCodePoint=function(e){return isNameStartCodePoint(e)||isDigit(e)||e===HYPHEN_MINUS},isNonPrintableCodePoint=function(e){return e>=NULL&&e<=BACKSPACE||e===LINE_TABULATION||e>=SHIFT_OUT&&e<=INFORMATION_SEPARATOR_ONE||e===DELETE},isValidEscape=function(e,t){return e===REVERSE_SOLIDUS&&t!==LINE_FEED},isIdentifierStart=function(e,t,i){return e===HYPHEN_MINUS?isNameStartCodePoint(t)||isValidEscape(t,i):!!isNameStartCodePoint(e)||!(e!==REVERSE_SOLIDUS||!isValidEscape(e,t))},isNumberStart=function(e,t,i){return e===PLUS_SIGN||e===HYPHEN_MINUS?!!isDigit(t)||t===FULL_STOP&&isDigit(i):isDigit(e===FULL_STOP?t:e)},stringToNumber=function(t){var i=0,r=1;t[i]!==PLUS_SIGN&&t[i]!==HYPHEN_MINUS||(t[i]===HYPHEN_MINUS&&(r=-1),i++);for(var s=[];isDigit(t[i]);)s.push(t[i++]);var n=s.length?parseInt(fromCodePoint$1.apply(void 0,s),10):0;t[i]===FULL_STOP&&i++;for(var o=[];isDigit(t[i]);)o.push(t[i++]);var a=o.length,A=a?parseInt(fromCodePoint$1.apply(void 0,o),10):0;t[i]!==E&&t[i]!==e||i++;var l=1;t[i]!==PLUS_SIGN&&t[i]!==HYPHEN_MINUS||(t[i]===HYPHEN_MINUS&&(l=-1),i++);for(var h=[];isDigit(t[i]);)h.push(t[i++]);var d=h.length?parseInt(fromCodePoint$1.apply(void 0,h),10):0;return r*(n+A*Math.pow(10,-a))*Math.pow(10,l*d)},LEFT_PARENTHESIS_TOKEN={type:2},RIGHT_PARENTHESIS_TOKEN={type:3},COMMA_TOKEN={type:4},SUFFIX_MATCH_TOKEN={type:13},PREFIX_MATCH_TOKEN={type:8},COLUMN_TOKEN={type:21},DASH_MATCH_TOKEN={type:9},INCLUDE_MATCH_TOKEN={type:10},LEFT_CURLY_BRACKET_TOKEN={type:11},RIGHT_CURLY_BRACKET_TOKEN={type:12},SUBSTRING_MATCH_TOKEN={type:14},BAD_URL_TOKEN={type:23},BAD_STRING_TOKEN={type:1},CDO_TOKEN={type:25},CDC_TOKEN={type:24},COLON_TOKEN={type:26},SEMICOLON_TOKEN={type:27},LEFT_SQUARE_BRACKET_TOKEN={type:28},RIGHT_SQUARE_BRACKET_TOKEN={type:29},WHITESPACE_TOKEN={type:31},EOF_TOKEN={type:32},Tokenizer=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(toCodePoints$1(e))},t.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==EOF_TOKEN;)e.push(t),t=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case QUOTATION_MARK:return this.consumeStringToken(QUOTATION_MARK);case NUMBER_SIGN:var t=this.peekCodePoint(0),i=this.peekCodePoint(1),r=this.peekCodePoint(2);if(isNameCodePoint(t)||isValidEscape(i,r)){var s=isIdentifierStart(t,i,r)?FLAG_ID:FLAG_UNRESTRICTED;return{type:5,value:this.consumeName(),flags:s}}break;case DOLLAR_SIGN:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUFFIX_MATCH_TOKEN;break;case APOSTROPHE:return this.consumeStringToken(APOSTROPHE);case LEFT_PARENTHESIS:return LEFT_PARENTHESIS_TOKEN;case RIGHT_PARENTHESIS:return RIGHT_PARENTHESIS_TOKEN;case ASTERISK:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUBSTRING_MATCH_TOKEN;break;case PLUS_SIGN:if(isNumberStart(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case COMMA:return COMMA_TOKEN;case HYPHEN_MINUS:var n=e,o=this.peekCodePoint(0),a=this.peekCodePoint(1);if(isNumberStart(n,o,a))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(isIdentifierStart(n,o,a))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(o===HYPHEN_MINUS&&a===GREATER_THAN_SIGN)return this.consumeCodePoint(),this.consumeCodePoint(),CDC_TOKEN;break;case FULL_STOP:if(isNumberStart(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case SOLIDUS:if(this.peekCodePoint(0)===ASTERISK)for(this.consumeCodePoint();;){var A=this.consumeCodePoint();if(A===ASTERISK&&(A=this.consumeCodePoint())===SOLIDUS)return this.consumeToken();if(A===EOF$1)return this.consumeToken()}break;case COLON:return COLON_TOKEN;case SEMICOLON:return SEMICOLON_TOKEN;case LESS_THAN_SIGN:if(this.peekCodePoint(0)===EXCLAMATION_MARK&&this.peekCodePoint(1)===HYPHEN_MINUS&&this.peekCodePoint(2)===HYPHEN_MINUS)return this.consumeCodePoint(),this.consumeCodePoint(),CDO_TOKEN;break;case COMMERCIAL_AT:var l=this.peekCodePoint(0),h=this.peekCodePoint(1),d=this.peekCodePoint(2);if(isIdentifierStart(l,h,d))return{type:7,value:this.consumeName()};break;case LEFT_SQUARE_BRACKET:return LEFT_SQUARE_BRACKET_TOKEN;case REVERSE_SOLIDUS:if(isValidEscape(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case RIGHT_SQUARE_BRACKET:return RIGHT_SQUARE_BRACKET_TOKEN;case CIRCUMFLEX_ACCENT:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),PREFIX_MATCH_TOKEN;break;case LEFT_CURLY_BRACKET:return LEFT_CURLY_BRACKET_TOKEN;case RIGHT_CURLY_BRACKET:return RIGHT_CURLY_BRACKET_TOKEN;case u:case U:var c=this.peekCodePoint(0),p=this.peekCodePoint(1);return c!==PLUS_SIGN||!isHex(p)&&p!==QUESTION_MARK||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case VERTICAL_LINE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),DASH_MATCH_TOKEN;if(this.peekCodePoint(0)===VERTICAL_LINE)return this.consumeCodePoint(),COLUMN_TOKEN;break;case TILDE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),INCLUDE_MATCH_TOKEN;break;case EOF$1:return EOF_TOKEN}return isWhiteSpace(e)?(this.consumeWhiteSpace(),WHITESPACE_TOKEN):isDigit(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):isNameStartCodePoint(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:fromCodePoint$1(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return void 0===e?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();isHex(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var i=!1;t===QUESTION_MARK&&e.length<6;)e.push(t),t=this.consumeCodePoint(),i=!0;if(i)return{type:30,start:parseInt(fromCodePoint$1.apply(void 0,e.map((function(e){return e===QUESTION_MARK?ZERO:e}))),16),end:parseInt(fromCodePoint$1.apply(void 0,e.map((function(e){return e===QUESTION_MARK?F:e}))),16)};var r=parseInt(fromCodePoint$1.apply(void 0,e),16);if(this.peekCodePoint(0)===HYPHEN_MINUS&&isHex(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var s=[];isHex(t)&&s.length<6;)s.push(t),t=this.consumeCodePoint();return{type:30,start:r,end:parseInt(fromCodePoint$1.apply(void 0,s),16)}}return{type:30,start:r,end:r}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return"url"===e.toLowerCase()&&this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF$1)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===APOSTROPHE||t===QUOTATION_MARK){var i=this.consumeStringToken(this.consumeCodePoint());return 0===i.type&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF$1||this.peekCodePoint(0)===RIGHT_PARENTHESIS)?(this.consumeCodePoint(),{type:22,value:i.value}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN)}for(;;){var r=this.consumeCodePoint();if(r===EOF$1||r===RIGHT_PARENTHESIS)return{type:22,value:fromCodePoint$1.apply(void 0,e)};if(isWhiteSpace(r))return this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF$1||this.peekCodePoint(0)===RIGHT_PARENTHESIS?(this.consumeCodePoint(),{type:22,value:fromCodePoint$1.apply(void 0,e)}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN);if(r===QUOTATION_MARK||r===APOSTROPHE||r===LEFT_PARENTHESIS||isNonPrintableCodePoint(r))return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;if(r===REVERSE_SOLIDUS){if(!isValidEscape(r,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;e.push(this.consumeEscapedCodePoint())}else e.push(r)}},t.prototype.consumeWhiteSpace=function(){for(;isWhiteSpace(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===RIGHT_PARENTHESIS||e===EOF$1)return;isValidEscape(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var t="";e>0;){var i=Math.min(5e4,e);t+=fromCodePoint$1.apply(void 0,this._value.splice(0,i)),e-=i}return this._value.shift(),t},t.prototype.consumeStringToken=function(e){for(var t="",i=0;;){var r=this._value[i];if(r===EOF$1||void 0===r||r===e)return{type:0,value:t+=this.consumeStringSlice(i)};if(r===LINE_FEED)return this._value.splice(0,i),BAD_STRING_TOKEN;if(r===REVERSE_SOLIDUS){var s=this._value[i+1];s!==EOF$1&&void 0!==s&&(s===LINE_FEED?(t+=this.consumeStringSlice(i),i=-1,this._value.shift()):isValidEscape(r,s)&&(t+=this.consumeStringSlice(i),t+=fromCodePoint$1(this.consumeEscapedCodePoint()),i=-1))}i++}},t.prototype.consumeNumber=function(){var t=[],i=FLAG_INTEGER,r=this.peekCodePoint(0);for(r!==PLUS_SIGN&&r!==HYPHEN_MINUS||t.push(this.consumeCodePoint());isDigit(this.peekCodePoint(0));)t.push(this.consumeCodePoint());r=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(r===FULL_STOP&&isDigit(s))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),i=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)t.push(this.consumeCodePoint());r=this.peekCodePoint(0),s=this.peekCodePoint(1);var n=this.peekCodePoint(2);if((r===E||r===e)&&((s===PLUS_SIGN||s===HYPHEN_MINUS)&&isDigit(n)||isDigit(s)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),i=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[stringToNumber(t),i]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],i=e[1],r=this.peekCodePoint(0),s=this.peekCodePoint(1),n=this.peekCodePoint(2);return isIdentifierStart(r,s,n)?{type:15,number:t,flags:i,unit:this.consumeName()}:r===PERCENTAGE_SIGN?(this.consumeCodePoint(),{type:16,number:t,flags:i}):{type:17,number:t,flags:i}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(isHex(e)){for(var t=fromCodePoint$1(e);isHex(this.peekCodePoint(0))&&t.length<6;)t+=fromCodePoint$1(this.consumeCodePoint());isWhiteSpace(this.peekCodePoint(0))&&this.consumeCodePoint();var i=parseInt(t,16);return 0===i||isSurrogateCodePoint(i)||i>1114111?REPLACEMENT_CHARACTER:i}return e===EOF$1?REPLACEMENT_CHARACTER:e},t.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(isNameCodePoint(t))e+=fromCodePoint$1(t);else{if(!isValidEscape(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),e;e+=fromCodePoint$1(this.consumeEscapedCodePoint())}}},t}(),Parser=function(){function e(e){this._tokens=e}return e.create=function(t){var i=new Tokenizer;return i.write(t),new e(i.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var e=this.consumeToken();31===e.type;)e=this.consumeToken();if(32===e.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do{e=this.consumeToken()}while(31===e.type);if(32===e.type)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(32===t.type)return e;e.push(t),e.push()}},e.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},e.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},i=this.consumeToken();;){if(32===i.type||isEndingTokenFor(i,e))return t;this.reconsumeToken(i),t.values.push(this.consumeComponentValue()),i=this.consumeToken()}},e.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var i=this.consumeToken();if(32===i.type||3===i.type)return t;this.reconsumeToken(i),t.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var e=this._tokens.shift();return void 0===e?EOF_TOKEN:e},e.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},e}(),isDimensionToken=function(e){return 15===e.type},isNumberToken=function(e){return 17===e.type},isIdentToken=function(e){return 20===e.type},isStringToken=function(e){return 0===e.type},isIdentWithValue=function(e,t){return isIdentToken(e)&&e.value===t},nonWhiteSpace=function(e){return 31!==e.type},nonFunctionArgSeparator=function(e){return 31!==e.type&&4!==e.type},parseFunctionArgs=function(e){var t=[],i=[];return e.forEach((function(e){if(4===e.type){if(0===i.length)throw new Error("Error parsing function args, zero tokens for arg");return t.push(i),void(i=[])}31!==e.type&&i.push(e)})),i.length&&t.push(i),t},isEndingTokenFor=function(e,t){return 11===t&&12===e.type||(28===t&&29===e.type||2===t&&3===e.type)},isLength=function(e){return 17===e.type||15===e.type},isLengthPercentage=function(e){return 16===e.type||isLength(e)},parseLengthPercentageTuple=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},ZERO_LENGTH={type:17,number:0,flags:FLAG_INTEGER},FIFTY_PERCENT={type:16,number:50,flags:FLAG_INTEGER},HUNDRED_PERCENT={type:16,number:100,flags:FLAG_INTEGER},getAbsoluteValueForTuple=function(e,t,i){var r=e[0],s=e[1];return[getAbsoluteValue(r,t),getAbsoluteValue(void 0!==s?s:r,i)]},getAbsoluteValue=function(e,t){if(16===e.type)return e.number/100*t;if(isDimensionToken(e))switch(e.unit){case"rem":case"em":return 16*e.number;default:return e.number}return e.number},DEG="deg",GRAD="grad",RAD="rad",TURN="turn",angle={name:"angle",parse:function(e,t){if(15===t.type)switch(t.unit){case DEG:return Math.PI*t.number/180;case GRAD:return Math.PI/200*t.number;case RAD:return t.number;case TURN:return 2*Math.PI*t.number}throw new Error("Unsupported angle type")}},isAngle=function(e){return 15===e.type&&(e.unit===DEG||e.unit===GRAD||e.unit===RAD||e.unit===TURN)},parseNamedSide=function(e){switch(e.filter(isIdentToken).map((function(e){return e.value})).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[ZERO_LENGTH,ZERO_LENGTH];case"to top":case"bottom":return deg(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[ZERO_LENGTH,HUNDRED_PERCENT];case"to right":case"left":return deg(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[HUNDRED_PERCENT,HUNDRED_PERCENT];case"to bottom":case"top":return deg(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[HUNDRED_PERCENT,ZERO_LENGTH];case"to left":case"right":return deg(270)}return 0},deg=function(e){return Math.PI*e/180},color$1={name:"color",parse:function(e,t){if(18===t.type){var i=SUPPORTED_COLOR_FUNCTIONS[t.name];if(void 0===i)throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return i(e,t.values)}if(5===t.type){if(3===t.value.length){var r=t.value.substring(0,1),s=t.value.substring(1,2),n=t.value.substring(2,3);return pack$1(parseInt(r+r,16),parseInt(s+s,16),parseInt(n+n,16),1)}if(4===t.value.length){r=t.value.substring(0,1),s=t.value.substring(1,2),n=t.value.substring(2,3);var o=t.value.substring(3,4);return pack$1(parseInt(r+r,16),parseInt(s+s,16),parseInt(n+n,16),parseInt(o+o,16)/255)}if(6===t.value.length){r=t.value.substring(0,2),s=t.value.substring(2,4),n=t.value.substring(4,6);return pack$1(parseInt(r,16),parseInt(s,16),parseInt(n,16),1)}if(8===t.value.length){r=t.value.substring(0,2),s=t.value.substring(2,4),n=t.value.substring(4,6),o=t.value.substring(6,8);return pack$1(parseInt(r,16),parseInt(s,16),parseInt(n,16),parseInt(o,16)/255)}}if(20===t.type){var a=COLORS[t.value.toUpperCase()];if(void 0!==a)return a}return COLORS.TRANSPARENT}},isTransparent=function(e){return 0==(255&e)},asString=function(e){var t=255&e,i=255&e>>8,r=255&e>>16,s=255&e>>24;return t<255?"rgba("+s+","+r+","+i+","+t/255+")":"rgb("+s+","+r+","+i+")"},pack$1=function(e,t,i,r){return(e<<24|t<<16|i<<8|Math.round(255*r)<<0)>>>0},getTokenColorValue=function(e,t){if(17===e.type)return e.number;if(16===e.type){var i=3===t?1:255;return 3===t?e.number/100*i:Math.round(e.number/100*i)}return 0},rgb=function(e,t){var i=t.filter(nonFunctionArgSeparator);if(3===i.length){var r=i.map(getTokenColorValue),s=r[0],n=r[1],o=r[2];return pack$1(s,n,o,1)}if(4===i.length){var a=i.map(getTokenColorValue),A=(s=a[0],n=a[1],o=a[2],a[3]);return pack$1(s,n,o,A)}return 0};function hue2rgb(e,t,i){return i<0&&(i+=1),i>=1&&(i-=1),i<1/6?(t-e)*i*6+e:i<.5?t:i<2/3?6*(t-e)*(2/3-i)+e:e}var hsl=function(e,t){var i=t.filter(nonFunctionArgSeparator),r=i[0],s=i[1],n=i[2],o=i[3],a=(17===r.type?deg(r.number):angle.parse(e,r))/(2*Math.PI),A=isLengthPercentage(s)?s.number/100:0,l=isLengthPercentage(n)?n.number/100:0,h=void 0!==o&&isLengthPercentage(o)?getAbsoluteValue(o,1):1;if(0===A)return pack$1(255*l,255*l,255*l,1);var d=l<=.5?l*(A+1):l+A-l*A,c=2*l-d,u=hue2rgb(c,d,a+1/3),p=hue2rgb(c,d,a),_=hue2rgb(c,d,a-1/3);return pack$1(255*u,255*p,255*_,h)},SUPPORTED_COLOR_FUNCTIONS={hsl:hsl,hsla:hsl,rgb:rgb,rgba:rgb},parseColor=function(e,t){return color$1.parse(e,Parser.create(t).parseComponentValue())},COLORS={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},backgroundClip={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map((function(e){if(isIdentToken(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},backgroundColor={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},parseColorStop=function(e,t){var i=color$1.parse(e,t[0]),r=t[1];return r&&isLengthPercentage(r)?{color:i,stop:r}:{color:i,stop:null}},processColorStops=function(e,t){var i=e[0],r=e[e.length-1];null===i.stop&&(i.stop=ZERO_LENGTH),null===r.stop&&(r.stop=HUNDRED_PERCENT);for(var s=[],n=0,o=0;o<e.length;o++){var a=e[o].stop;if(null!==a){var A=getAbsoluteValue(a,t);A>n?s.push(A):s.push(n),n=A}else s.push(null)}var l=null;for(o=0;o<s.length;o++){var h=s[o];if(null===h)null===l&&(l=o);else if(null!==l){for(var d=o-l,c=(h-s[l-1])/(d+1),u=1;u<=d;u++)s[l+u-1]=c*u;l=null}}return e.map((function(e,i){return{color:e.color,stop:Math.max(Math.min(1,s[i]/t),0)}}))},getAngleFromCorner=function(e,t,i){var r=t/2,s=i/2,n=getAbsoluteValue(e[0],t)-r,o=s-getAbsoluteValue(e[1],i);return(Math.atan2(o,n)+2*Math.PI)%(2*Math.PI)},calculateGradientDirection=function(e,t,i){var r="number"==typeof e?e:getAngleFromCorner(e,t,i),s=Math.abs(t*Math.sin(r))+Math.abs(i*Math.cos(r)),n=t/2,o=i/2,a=s/2,A=Math.sin(r-Math.PI/2)*a,l=Math.cos(r-Math.PI/2)*a;return[s,n-l,n+l,o-A,o+A]},distance=function(e,t){return Math.sqrt(e*e+t*t)},findCorner=function(e,t,i,r,s){return[[0,0],[0,t],[e,0],[e,t]].reduce((function(e,t){var n=t[0],o=t[1],a=distance(i-n,r-o);return(s?a<e.optimumDistance:a>e.optimumDistance)?{optimumCorner:t,optimumDistance:a}:e}),{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},calculateRadius=function(e,t,i,r,s){var n=0,o=0;switch(e.size){case 0:0===e.shape?n=o=Math.min(Math.abs(t),Math.abs(t-r),Math.abs(i),Math.abs(i-s)):1===e.shape&&(n=Math.min(Math.abs(t),Math.abs(t-r)),o=Math.min(Math.abs(i),Math.abs(i-s)));break;case 2:if(0===e.shape)n=o=Math.min(distance(t,i),distance(t,i-s),distance(t-r,i),distance(t-r,i-s));else if(1===e.shape){var a=Math.min(Math.abs(i),Math.abs(i-s))/Math.min(Math.abs(t),Math.abs(t-r)),A=findCorner(r,s,t,i,!0),l=A[0],h=A[1];o=a*(n=distance(l-t,(h-i)/a))}break;case 1:0===e.shape?n=o=Math.max(Math.abs(t),Math.abs(t-r),Math.abs(i),Math.abs(i-s)):1===e.shape&&(n=Math.max(Math.abs(t),Math.abs(t-r)),o=Math.max(Math.abs(i),Math.abs(i-s)));break;case 3:if(0===e.shape)n=o=Math.max(distance(t,i),distance(t,i-s),distance(t-r,i),distance(t-r,i-s));else if(1===e.shape){a=Math.max(Math.abs(i),Math.abs(i-s))/Math.max(Math.abs(t),Math.abs(t-r));var d=findCorner(r,s,t,i,!1);l=d[0],h=d[1];o=a*(n=distance(l-t,(h-i)/a))}}return Array.isArray(e.size)&&(n=getAbsoluteValue(e.size[0],r),o=2===e.size.length?getAbsoluteValue(e.size[1],s):n),[n,o]},linearGradient=function(e,t){var i=deg(180),r=[];return parseFunctionArgs(t).forEach((function(t,s){if(0===s){var n=t[0];if(20===n.type&&"to"===n.value)return void(i=parseNamedSide(t));if(isAngle(n))return void(i=angle.parse(e,n))}var o=parseColorStop(e,t);r.push(o)})),{angle:i,stops:r,type:1}},prefixLinearGradient=function(e,t){var i=deg(180),r=[];return parseFunctionArgs(t).forEach((function(t,s){if(0===s){var n=t[0];if(20===n.type&&-1!==["top","left","right","bottom"].indexOf(n.value))return void(i=parseNamedSide(t));if(isAngle(n))return void(i=(angle.parse(e,n)+deg(270))%deg(360))}var o=parseColorStop(e,t);r.push(o)})),{angle:i,stops:r,type:1}},webkitGradient=function(e,t){var i=deg(180),r=[],s=1;return parseFunctionArgs(t).forEach((function(t,i){var n=t[0];if(0===i){if(isIdentToken(n)&&"linear"===n.value)return void(s=1);if(isIdentToken(n)&&"radial"===n.value)return void(s=2)}if(18===n.type)if("from"===n.name){var o=color$1.parse(e,n.values[0]);r.push({stop:ZERO_LENGTH,color:o})}else if("to"===n.name){o=color$1.parse(e,n.values[0]);r.push({stop:HUNDRED_PERCENT,color:o})}else if("color-stop"===n.name){var a=n.values.filter(nonFunctionArgSeparator);if(2===a.length){o=color$1.parse(e,a[1]);var A=a[0];isNumberToken(A)&&r.push({stop:{type:16,number:100*A.number,flags:A.flags},color:o})}}})),1===s?{angle:(i+deg(180))%deg(360),stops:r,type:s}:{size:3,shape:0,stops:r,position:[],type:s}},CLOSEST_SIDE="closest-side",FARTHEST_SIDE="farthest-side",CLOSEST_CORNER="closest-corner",FARTHEST_CORNER="farthest-corner",CIRCLE="circle",ELLIPSE="ellipse",COVER="cover",CONTAIN="contain",radialGradient=function(e,t){var i=0,r=3,s=[],n=[];return parseFunctionArgs(t).forEach((function(t,o){var a=!0;if(0===o){var A=!1;a=t.reduce((function(e,t){if(A)if(isIdentToken(t))switch(t.value){case"center":return n.push(FIFTY_PERCENT),e;case"top":case"left":return n.push(ZERO_LENGTH),e;case"right":case"bottom":return n.push(HUNDRED_PERCENT),e}else(isLengthPercentage(t)||isLength(t))&&n.push(t);else if(isIdentToken(t))switch(t.value){case CIRCLE:return i=0,!1;case ELLIPSE:return i=1,!1;case"at":return A=!0,!1;case CLOSEST_SIDE:return r=0,!1;case COVER:case FARTHEST_SIDE:return r=1,!1;case CONTAIN:case CLOSEST_CORNER:return r=2,!1;case FARTHEST_CORNER:return r=3,!1}else if(isLength(t)||isLengthPercentage(t))return Array.isArray(r)||(r=[]),r.push(t),!1;return e}),a)}if(a){var l=parseColorStop(e,t);s.push(l)}})),{size:r,shape:i,stops:s,position:n,type:2}},prefixRadialGradient=function(e,t){var i=0,r=3,s=[],n=[];return parseFunctionArgs(t).forEach((function(t,o){var a=!0;if(0===o?a=t.reduce((function(e,t){if(isIdentToken(t))switch(t.value){case"center":return n.push(FIFTY_PERCENT),!1;case"top":case"left":return n.push(ZERO_LENGTH),!1;case"right":case"bottom":return n.push(HUNDRED_PERCENT),!1}else if(isLengthPercentage(t)||isLength(t))return n.push(t),!1;return e}),a):1===o&&(a=t.reduce((function(e,t){if(isIdentToken(t))switch(t.value){case CIRCLE:return i=0,!1;case ELLIPSE:return i=1,!1;case CONTAIN:case CLOSEST_SIDE:return r=0,!1;case FARTHEST_SIDE:return r=1,!1;case CLOSEST_CORNER:return r=2,!1;case COVER:case FARTHEST_CORNER:return r=3,!1}else if(isLength(t)||isLengthPercentage(t))return Array.isArray(r)||(r=[]),r.push(t),!1;return e}),a)),a){var A=parseColorStop(e,t);s.push(A)}})),{size:r,shape:i,stops:s,position:n,type:2}},isLinearGradient=function(e){return 1===e.type},isRadialGradient=function(e){return 2===e.type},image={name:"image",parse:function(e,t){if(22===t.type){var i={url:t.value,type:0};return e.cache.addImage(t.value),i}if(18===t.type){var r=SUPPORTED_IMAGE_FUNCTIONS[t.name];if(void 0===r)throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return r(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function isSupportedImage(e){return!(20===e.type&&"none"===e.value||18===e.type&&!SUPPORTED_IMAGE_FUNCTIONS[e.name])}var BACKGROUND_SIZE,SUPPORTED_IMAGE_FUNCTIONS={"linear-gradient":linearGradient,"-moz-linear-gradient":prefixLinearGradient,"-ms-linear-gradient":prefixLinearGradient,"-o-linear-gradient":prefixLinearGradient,"-webkit-linear-gradient":prefixLinearGradient,"radial-gradient":radialGradient,"-moz-radial-gradient":prefixRadialGradient,"-ms-radial-gradient":prefixRadialGradient,"-o-radial-gradient":prefixRadialGradient,"-webkit-radial-gradient":prefixRadialGradient,"-webkit-gradient":webkitGradient},backgroundImage={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var i=t[0];return 20===i.type&&"none"===i.value?[]:t.filter((function(e){return nonFunctionArgSeparator(e)&&isSupportedImage(e)})).map((function(t){return image.parse(e,t)}))}},backgroundOrigin={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map((function(e){if(isIdentToken(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},backgroundPosition={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return parseFunctionArgs(t).map((function(e){return e.filter(isLengthPercentage)})).map(parseLengthPercentageTuple)}},backgroundRepeat={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return parseFunctionArgs(t).map((function(e){return e.filter(isIdentToken).map((function(e){return e.value})).join(" ")})).map(parseBackgroundRepeat)}},parseBackgroundRepeat=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};!function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"}(BACKGROUND_SIZE||(BACKGROUND_SIZE={}));var LINE_BREAK,backgroundSize={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return parseFunctionArgs(t).map((function(e){return e.filter(isBackgroundSizeInfoToken)}))}},isBackgroundSizeInfoToken=function(e){return isIdentToken(e)||isLengthPercentage(e)},borderColorForSide=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},borderTopColor=borderColorForSide("top"),borderRightColor=borderColorForSide("right"),borderBottomColor=borderColorForSide("bottom"),borderLeftColor=borderColorForSide("left"),borderRadiusForSide=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return parseLengthPercentageTuple(t.filter(isLengthPercentage))}}},borderTopLeftRadius=borderRadiusForSide("top-left"),borderTopRightRadius=borderRadiusForSide("top-right"),borderBottomRightRadius=borderRadiusForSide("bottom-right"),borderBottomLeftRadius=borderRadiusForSide("bottom-left"),borderStyleForSide=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},borderTopStyle=borderStyleForSide("top"),borderRightStyle=borderStyleForSide("right"),borderBottomStyle=borderStyleForSide("bottom"),borderLeftStyle=borderStyleForSide("left"),borderWidthForSide=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return isDimensionToken(t)?t.number:0}}},borderTopWidth=borderWidthForSide("top"),borderRightWidth=borderWidthForSide("right"),borderBottomWidth=borderWidthForSide("bottom"),borderLeftWidth=borderWidthForSide("left"),color={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},direction={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){return"rtl"===t?1:0}},display={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(isIdentToken).reduce((function(e,t){return e|parseDisplayValue(t.value)}),0)}},parseDisplayValue=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},float={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},letterSpacing={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return 20===t.type&&"normal"===t.value?0:17===t.type||15===t.type?t.number:0}};!function(e){e.NORMAL="normal",e.STRICT="strict"}(LINE_BREAK||(LINE_BREAK={}));var WORD_BREAK,lineBreak={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"strict"===t?LINE_BREAK.STRICT:LINE_BREAK.NORMAL}},lineHeight={name:"line-height",initialValue:"normal",prefix:!1,type:4},computeLineHeight=function(e,t){return isIdentToken(e)&&"normal"===e.value?1.2*t:17===e.type?t*e.number:isLengthPercentage(e)?getAbsoluteValue(e,t):t},listStyleImage={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return 20===t.type&&"none"===t.value?null:image.parse(e,t)}},listStylePosition={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){return"inside"===t?0:1}},listStyleType={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},marginForSide=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},marginTop=marginForSide("top"),marginRight=marginForSide("right"),marginBottom=marginForSide("bottom"),marginLeft=marginForSide("left"),overflow={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(isIdentToken).map((function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}}))}},overflowWrap={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"break-word"===t?"break-word":"normal"}},paddingForSide=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},paddingTop=paddingForSide("top"),paddingRight=paddingForSide("right"),paddingBottom=paddingForSide("bottom"),paddingLeft=paddingForSide("left"),textAlign={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},position={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},textShadow={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&isIdentWithValue(t[0],"none")?[]:parseFunctionArgs(t).map((function(t){for(var i={color:COLORS.TRANSPARENT,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH},r=0,s=0;s<t.length;s++){var n=t[s];isLength(n)?(0===r?i.offsetX=n:1===r?i.offsetY=n:i.blur=n,r++):i.color=color$1.parse(e,n)}return i}))}},textTransform={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},transform$1={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(20===t.type&&"none"===t.value)return null;if(18===t.type){var i=SUPPORTED_TRANSFORM_FUNCTIONS[t.name];if(void 0===i)throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return i(t.values)}return null}},matrix=function(e){var t=e.filter((function(e){return 17===e.type})).map((function(e){return e.number}));return 6===t.length?t:null},matrix3d=function(e){var t=e.filter((function(e){return 17===e.type})).map((function(e){return e.number})),i=t[0],r=t[1],s=t[4],n=t[5],o=t[12],a=t[13];return 16===t.length?[i,r,s,n,o,a]:null},SUPPORTED_TRANSFORM_FUNCTIONS={matrix:matrix,matrix3d:matrix3d},DEFAULT_VALUE={type:16,number:50,flags:FLAG_INTEGER},DEFAULT=[DEFAULT_VALUE,DEFAULT_VALUE],transformOrigin={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var i=t.filter(isLengthPercentage);return 2!==i.length?DEFAULT:[i[0],i[1]]}},visibility={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;default:return 0}}};!function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"}(WORD_BREAK||(WORD_BREAK={}));for(var wordBreak={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return WORD_BREAK.BREAK_ALL;case"keep-all":return WORD_BREAK.KEEP_ALL;default:return WORD_BREAK.NORMAL}}},zIndex={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(20===t.type)return{auto:!0,order:0};if(isNumberToken(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},time={name:"time",parse:function(e,t){if(15===t.type)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},opacity={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return isNumberToken(t)?t.number:1}},textDecorationColor={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},textDecorationLine={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(isIdentToken).map((function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0})).filter((function(e){return 0!==e}))}},fontFamily={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var i=[],r=[];return t.forEach((function(e){switch(e.type){case 20:case 0:i.push(e.value);break;case 17:i.push(e.number.toString());break;case 4:r.push(i.join(" ")),i.length=0}})),i.length&&r.push(i.join(" ")),r.map((function(e){return-1===e.indexOf(" ")?e:"'"+e+"'"}))}},fontSize={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},fontWeight={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){return isNumberToken(t)?t.number:isIdentToken(t)&&"bold"===t.value?700:400}},fontVariant={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(isIdentToken).map((function(e){return e.value}))}},fontStyle={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},contains=function(e,t){return 0!=(e&t)},content={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var i=t[0];return 20===i.type&&"none"===i.value?[]:t}},counterIncrement={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var i=t[0];if(20===i.type&&"none"===i.value)return null;for(var r=[],s=t.filter(nonWhiteSpace),n=0;n<s.length;n++){var o=s[n],a=s[n+1];if(20===o.type){var A=a&&isNumberToken(a)?a.number:1;r.push({counter:o.value,increment:A})}}return r}},counterReset={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return[];for(var i=[],r=t.filter(nonWhiteSpace),s=0;s<r.length;s++){var n=r[s],o=r[s+1];if(isIdentToken(n)&&"none"!==n.value){var a=o&&isNumberToken(o)?o.number:0;i.push({counter:n.value,reset:a})}}return i}},duration={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(isDimensionToken).map((function(t){return time.parse(e,t)}))}},quotes={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var i=t[0];if(20===i.type&&"none"===i.value)return null;var r=[],s=t.filter(isStringToken);if(s.length%2!=0)return null;for(var n=0;n<s.length;n+=2){var o=s[n].value,a=s[n+1].value;r.push({open:o,close:a})}return r}},getQuote=function(e,t,i){if(!e)return"";var r=e[Math.min(t,e.length-1)];return r?i?r.open:r.close:""},boxShadow={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&isIdentWithValue(t[0],"none")?[]:parseFunctionArgs(t).map((function(t){for(var i={color:255,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH,spread:ZERO_LENGTH,inset:!1},r=0,s=0;s<t.length;s++){var n=t[s];isIdentWithValue(n,"inset")?i.inset=!0:isLength(n)?(0===r?i.offsetX=n:1===r?i.offsetY=n:2===r?i.blur=n:i.spread=n,r++):i.color=color$1.parse(e,n)}return i}))}},paintOrder={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var i=[];return t.filter(isIdentToken).forEach((function(e){switch(e.value){case"stroke":i.push(1);break;case"fill":i.push(0);break;case"markers":i.push(2)}})),[0,1,2].forEach((function(e){-1===i.indexOf(e)&&i.push(e)})),i}},webkitTextStrokeColor={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},webkitTextStrokeWidth={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return isDimensionToken(t)?t.number:0}},CSSParsedDeclaration=function(){function e(e,t){var i,r;this.animationDuration=parse(e,duration,t.animationDuration),this.backgroundClip=parse(e,backgroundClip,t.backgroundClip),this.backgroundColor=parse(e,backgroundColor,t.backgroundColor),this.backgroundImage=parse(e,backgroundImage,t.backgroundImage),this.backgroundOrigin=parse(e,backgroundOrigin,t.backgroundOrigin),this.backgroundPosition=parse(e,backgroundPosition,t.backgroundPosition),this.backgroundRepeat=parse(e,backgroundRepeat,t.backgroundRepeat),this.backgroundSize=parse(e,backgroundSize,t.backgroundSize),this.borderTopColor=parse(e,borderTopColor,t.borderTopColor),this.borderRightColor=parse(e,borderRightColor,t.borderRightColor),this.borderBottomColor=parse(e,borderBottomColor,t.borderBottomColor),this.borderLeftColor=parse(e,borderLeftColor,t.borderLeftColor),this.borderTopLeftRadius=parse(e,borderTopLeftRadius,t.borderTopLeftRadius),this.borderTopRightRadius=parse(e,borderTopRightRadius,t.borderTopRightRadius),this.borderBottomRightRadius=parse(e,borderBottomRightRadius,t.borderBottomRightRadius),this.borderBottomLeftRadius=parse(e,borderBottomLeftRadius,t.borderBottomLeftRadius),this.borderTopStyle=parse(e,borderTopStyle,t.borderTopStyle),this.borderRightStyle=parse(e,borderRightStyle,t.borderRightStyle),this.borderBottomStyle=parse(e,borderBottomStyle,t.borderBottomStyle),this.borderLeftStyle=parse(e,borderLeftStyle,t.borderLeftStyle),this.borderTopWidth=parse(e,borderTopWidth,t.borderTopWidth),this.borderRightWidth=parse(e,borderRightWidth,t.borderRightWidth),this.borderBottomWidth=parse(e,borderBottomWidth,t.borderBottomWidth),this.borderLeftWidth=parse(e,borderLeftWidth,t.borderLeftWidth),this.boxShadow=parse(e,boxShadow,t.boxShadow),this.color=parse(e,color,t.color),this.direction=parse(e,direction,t.direction),this.display=parse(e,display,t.display),this.float=parse(e,float,t.cssFloat),this.fontFamily=parse(e,fontFamily,t.fontFamily),this.fontSize=parse(e,fontSize,t.fontSize),this.fontStyle=parse(e,fontStyle,t.fontStyle),this.fontVariant=parse(e,fontVariant,t.fontVariant),this.fontWeight=parse(e,fontWeight,t.fontWeight),this.letterSpacing=parse(e,letterSpacing,t.letterSpacing),this.lineBreak=parse(e,lineBreak,t.lineBreak),this.lineHeight=parse(e,lineHeight,t.lineHeight),this.listStyleImage=parse(e,listStyleImage,t.listStyleImage),this.listStylePosition=parse(e,listStylePosition,t.listStylePosition),this.listStyleType=parse(e,listStyleType,t.listStyleType),this.marginTop=parse(e,marginTop,t.marginTop),this.marginRight=parse(e,marginRight,t.marginRight),this.marginBottom=parse(e,marginBottom,t.marginBottom),this.marginLeft=parse(e,marginLeft,t.marginLeft),this.opacity=parse(e,opacity,t.opacity);var s=parse(e,overflow,t.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=parse(e,overflowWrap,t.overflowWrap),this.paddingTop=parse(e,paddingTop,t.paddingTop),this.paddingRight=parse(e,paddingRight,t.paddingRight),this.paddingBottom=parse(e,paddingBottom,t.paddingBottom),this.paddingLeft=parse(e,paddingLeft,t.paddingLeft),this.paintOrder=parse(e,paintOrder,t.paintOrder),this.position=parse(e,position,t.position),this.textAlign=parse(e,textAlign,t.textAlign),this.textDecorationColor=parse(e,textDecorationColor,null!==(i=t.textDecorationColor)&&void 0!==i?i:t.color),this.textDecorationLine=parse(e,textDecorationLine,null!==(r=t.textDecorationLine)&&void 0!==r?r:t.textDecoration),this.textShadow=parse(e,textShadow,t.textShadow),this.textTransform=parse(e,textTransform,t.textTransform),this.transform=parse(e,transform$1,t.transform),this.transformOrigin=parse(e,transformOrigin,t.transformOrigin),this.visibility=parse(e,visibility,t.visibility),this.webkitTextStrokeColor=parse(e,webkitTextStrokeColor,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=parse(e,webkitTextStrokeWidth,t.webkitTextStrokeWidth),this.wordBreak=parse(e,wordBreak,t.wordBreak),this.zIndex=parse(e,zIndex,t.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},e.prototype.isTransparent=function(){return isTransparent(this.backgroundColor)},e.prototype.isTransformed=function(){return null!==this.transform},e.prototype.isPositioned=function(){return 0!==this.position},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return 0!==this.float},e.prototype.isInlineLevel=function(){return contains(this.display,4)||contains(this.display,33554432)||contains(this.display,268435456)||contains(this.display,536870912)||contains(this.display,67108864)||contains(this.display,134217728)},e}(),CSSParsedPseudoDeclaration=function(e,t){this.content=parse(e,content,t.content),this.quotes=parse(e,quotes,t.quotes)},CSSParsedCounterDeclaration=function(e,t){this.counterIncrement=parse(e,counterIncrement,t.counterIncrement),this.counterReset=parse(e,counterReset,t.counterReset)},parse=function(e,t,i){var r=new Tokenizer,s=null!=i?i.toString():t.initialValue;r.write(s);var n=new Parser(r.read());switch(t.type){case 2:var o=n.parseComponentValue();return t.parse(e,isIdentToken(o)?o.value:t.initialValue);case 0:return t.parse(e,n.parseComponentValue());case 1:return t.parse(e,n.parseComponentValues());case 4:return n.parseComponentValue();case 3:switch(t.format){case"angle":return angle.parse(e,n.parseComponentValue());case"color":return color$1.parse(e,n.parseComponentValue());case"image":return image.parse(e,n.parseComponentValue());case"length":var a=n.parseComponentValue();return isLength(a)?a:ZERO_LENGTH;case"length-percentage":var A=n.parseComponentValue();return isLengthPercentage(A)?A:ZERO_LENGTH;case"time":return time.parse(e,n.parseComponentValue())}}},elementDebuggerAttribute="data-html2canvas-debug",getElementDebugType=function(e){switch(e.getAttribute(elementDebuggerAttribute)){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},isDebugging=function(e,t){var i=getElementDebugType(e);return 1===i||t===i},ElementContainer=function(e,t){this.context=e,this.textNodes=[],this.elements=[],this.flags=0,isDebugging(t,3),this.styles=new CSSParsedDeclaration(e,window.getComputedStyle(t,null)),isHTMLElementNode(t)&&(this.styles.animationDuration.some((function(e){return e>0}))&&(t.style.animationDuration="0s"),null!==this.styles.transform&&(t.style.transform="none")),this.bounds=parseBounds(this.context,t),isDebugging(t,4)&&(this.flags|=16)},base64="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",chars$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$1$2=0;i$1$2<chars$1.length;i$1$2++)lookup$1[chars$1.charCodeAt(i$1$2)]=i$1$2;for(var decode=function(e){var t,i,r,s,n,o=.75*e.length,a=e.length,A=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var l="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),h=Array.isArray(l)?l:new Uint8Array(l);for(t=0;t<a;t+=4)i=lookup$1[e.charCodeAt(t)],r=lookup$1[e.charCodeAt(t+1)],s=lookup$1[e.charCodeAt(t+2)],n=lookup$1[e.charCodeAt(t+3)],h[A++]=i<<2|r>>4,h[A++]=(15&r)<<4|s>>2,h[A++]=(3&s)<<6|63&n;return l},polyUint16Array=function(e){for(var t=e.length,i=[],r=0;r<t;r+=2)i.push(e[r+1]<<8|e[r]);return i},polyUint32Array=function(e){for(var t=e.length,i=[],r=0;r<t;r+=4)i.push(e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]);return i},UTRIE2_SHIFT_2=5,UTRIE2_SHIFT_1=11,UTRIE2_INDEX_SHIFT=2,UTRIE2_SHIFT_1_2=UTRIE2_SHIFT_1-UTRIE2_SHIFT_2,UTRIE2_LSCP_INDEX_2_OFFSET=65536>>UTRIE2_SHIFT_2,UTRIE2_DATA_BLOCK_LENGTH=1<<UTRIE2_SHIFT_2,UTRIE2_DATA_MASK=UTRIE2_DATA_BLOCK_LENGTH-1,UTRIE2_LSCP_INDEX_2_LENGTH=1024>>UTRIE2_SHIFT_2,UTRIE2_INDEX_2_BMP_LENGTH=UTRIE2_LSCP_INDEX_2_OFFSET+UTRIE2_LSCP_INDEX_2_LENGTH,UTRIE2_UTF8_2B_INDEX_2_OFFSET=UTRIE2_INDEX_2_BMP_LENGTH,UTRIE2_UTF8_2B_INDEX_2_LENGTH=32,UTRIE2_INDEX_1_OFFSET=UTRIE2_UTF8_2B_INDEX_2_OFFSET+UTRIE2_UTF8_2B_INDEX_2_LENGTH,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=65536>>UTRIE2_SHIFT_1,UTRIE2_INDEX_2_BLOCK_LENGTH=1<<UTRIE2_SHIFT_1_2,UTRIE2_INDEX_2_MASK=UTRIE2_INDEX_2_BLOCK_LENGTH-1,slice16=function(e,t,i){return e.slice?e.slice(t,i):new Uint16Array(Array.prototype.slice.call(e,t,i))},slice32=function(e,t,i){return e.slice?e.slice(t,i):new Uint32Array(Array.prototype.slice.call(e,t,i))},createTrieFromBase64=function(e,t){var i=decode(e),r=Array.isArray(i)?polyUint32Array(i):new Uint32Array(i),s=Array.isArray(i)?polyUint16Array(i):new Uint16Array(i),n=slice16(s,12,r[4]/2),o=2===r[5]?slice16(s,(24+r[4])/2):slice32(r,Math.ceil((24+r[4])/4));return new Trie(r[0],r[1],r[2],r[3],n,o)},Trie=function(){function e(e,t,i,r,s,n){this.initialValue=e,this.errorValue=t,this.highStart=i,this.highValueIndex=r,this.index=s,this.data=n}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>UTRIE2_SHIFT_2])<<UTRIE2_INDEX_SHIFT)+(e&UTRIE2_DATA_MASK),this.data[t];if(e<=65535)return t=((t=this.index[UTRIE2_LSCP_INDEX_2_OFFSET+(e-55296>>UTRIE2_SHIFT_2)])<<UTRIE2_INDEX_SHIFT)+(e&UTRIE2_DATA_MASK),this.data[t];if(e<this.highStart)return t=UTRIE2_INDEX_1_OFFSET-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH+(e>>UTRIE2_SHIFT_1),t=this.index[t],t+=e>>UTRIE2_SHIFT_2&UTRIE2_INDEX_2_MASK,t=((t=this.index[t])<<UTRIE2_INDEX_SHIFT)+(e&UTRIE2_DATA_MASK),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$4=0;i$4<chars.length;i$4++)lookup[chars.charCodeAt(i$4)]=i$4;var PseudoElementType,Prepend=1,CR=2,LF=3,Control=4,Extend=5,SpacingMark=7,L=8,V=9,T=10,LV=11,LVT=12,ZWJ=13,Extended_Pictographic=14,RI=15,toCodePoints=function(e){for(var t=[],i=0,r=e.length;i<r;){var s=e.charCodeAt(i++);if(s>=55296&&s<=56319&&i<r){var n=e.charCodeAt(i++);56320==(64512&n)?t.push(((1023&s)<<10)+(1023&n)+65536):(t.push(s),i--)}else t.push(s)}return t},fromCodePoint=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var i=e.length;if(!i)return"";for(var r=[],s=-1,n="";++s<i;){var o=e[s];o<=65535?r.push(o):(o-=65536,r.push(55296+(o>>10),o%1024+56320)),(s+1===i||r.length>16384)&&(n+=String.fromCharCode.apply(String,r),r.length=0)}return n},UnicodeTrie=createTrieFromBase64(base64),BREAK_NOT_ALLOWED="×",BREAK_ALLOWED="÷",codePointToClass=function(e){return UnicodeTrie.get(e)},_graphemeBreakAtIndex=function(e,t,i){var r=i-2,s=t[r],n=t[i-1],o=t[i];if(n===CR&&o===LF)return BREAK_NOT_ALLOWED;if(n===CR||n===LF||n===Control)return BREAK_ALLOWED;if(o===CR||o===LF||o===Control)return BREAK_ALLOWED;if(n===L&&-1!==[L,V,LV,LVT].indexOf(o))return BREAK_NOT_ALLOWED;if(!(n!==LV&&n!==V||o!==V&&o!==T))return BREAK_NOT_ALLOWED;if((n===LVT||n===T)&&o===T)return BREAK_NOT_ALLOWED;if(o===ZWJ||o===Extend)return BREAK_NOT_ALLOWED;if(o===SpacingMark)return BREAK_NOT_ALLOWED;if(n===Prepend)return BREAK_NOT_ALLOWED;if(n===ZWJ&&o===Extended_Pictographic){for(;s===Extend;)s=t[--r];if(s===Extended_Pictographic)return BREAK_NOT_ALLOWED}if(n===RI&&o===RI){for(var a=0;s===RI;)a++,s=t[--r];if(a%2==0)return BREAK_NOT_ALLOWED}return BREAK_ALLOWED},GraphemeBreaker=function(e){var t=toCodePoints(e),i=t.length,r=0,s=0,n=t.map(codePointToClass);return{next:function(){if(r>=i)return{done:!0,value:null};for(var e=BREAK_NOT_ALLOWED;r<i&&(e=_graphemeBreakAtIndex(t,n,++r))===BREAK_NOT_ALLOWED;);if(e!==BREAK_NOT_ALLOWED||r===i){var o=fromCodePoint.apply(null,t.slice(s,r));return s=r,{value:o,done:!1}}return{done:!0,value:null}}}},splitGraphemes=function(e){for(var t,i=GraphemeBreaker(e),r=[];!(t=i.next()).done;)t.value&&r.push(t.value.slice());return r},testRangeBounds=function(e){if(e.createRange){var t=e.createRange();if(t.getBoundingClientRect){var i=e.createElement("boundtest");i.style.height="123px",i.style.display="block",e.body.appendChild(i),t.selectNode(i);var r=t.getBoundingClientRect(),s=Math.round(r.height);if(e.body.removeChild(i),123===s)return!0}}return!1},testIOSLineBreak=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var i=e.createRange();t.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var r=t.firstChild,s=toCodePoints$1(r.data).map((function(e){return fromCodePoint$1(e)})),n=0,o={},a=s.every((function(e,t){i.setStart(r,n),i.setEnd(r,n+e.length);var s=i.getBoundingClientRect();n+=e.length;var a=s.x>o.x||s.y>o.y;return o=s,0===t||a}));return e.body.removeChild(t),a},testCORS=function(){return void 0!==(new Image).crossOrigin},testResponseType=function(){return"string"==typeof(new XMLHttpRequest).responseType},testSVG=function(e){var t=new Image,i=e.createElement("canvas"),r=i.getContext("2d");if(!r)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(t,0,0),i.toDataURL()}catch(e){return!1}return!0},isGreenPixel=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},testForeignObject=function(e){var t=e.createElement("canvas"),i=100;t.width=i,t.height=i;var r=t.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,i,i);var s=new Image,n=t.toDataURL();s.src=n;var o=createForeignObjectSVG(i,i,0,0,s);return r.fillStyle="red",r.fillRect(0,0,i,i),loadSerializedSVG$1(o).then((function(t){r.drawImage(t,0,0);var s=r.getImageData(0,0,i,i).data;r.fillStyle="red",r.fillRect(0,0,i,i);var o=e.createElement("div");return o.style.backgroundImage="url("+n+")",o.style.height="100px",isGreenPixel(s)?loadSerializedSVG$1(createForeignObjectSVG(i,i,0,0,o)):Promise.reject(!1)})).then((function(e){return r.drawImage(e,0,0),isGreenPixel(r.getImageData(0,0,i,i).data)})).catch((function(){return!1}))},createForeignObjectSVG=function(e,t,i,r,s){var n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"svg"),a=document.createElementNS(n,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",i.toString()),a.setAttributeNS(null,"y",r.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(a),a.appendChild(s),o},loadSerializedSVG$1=function(e){return new Promise((function(t,i){var r=new Image;r.onload=function(){return t(r)},r.onerror=i,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},FEATURES={get SUPPORT_RANGE_BOUNDS(){var e=testRangeBounds(document);return Object.defineProperty(FEATURES,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=FEATURES.SUPPORT_RANGE_BOUNDS&&testIOSLineBreak(document);return Object.defineProperty(FEATURES,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=testSVG(document);return Object.defineProperty(FEATURES,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?testForeignObject(document):Promise.resolve(!1);return Object.defineProperty(FEATURES,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=testCORS();return Object.defineProperty(FEATURES,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=testResponseType();return Object.defineProperty(FEATURES,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(FEATURES,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(FEATURES,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},TextBounds=function(e,t){this.text=e,this.bounds=t},parseTextBounds=function(e,t,i,r){var s=breakText(t,i),n=[],o=0;return s.forEach((function(t){if(i.textDecorationLine.length||t.trim().length>0)if(FEATURES.SUPPORT_RANGE_BOUNDS){var s=createRange(r,o,t.length).getClientRects();if(s.length>1){var a=segmentGraphemes(t),A=0;a.forEach((function(t){n.push(new TextBounds(t,Bounds.fromDOMRectList(e,createRange(r,A+o,t.length).getClientRects()))),A+=t.length}))}else n.push(new TextBounds(t,Bounds.fromDOMRectList(e,s)))}else{var l=r.splitText(t.length);n.push(new TextBounds(t,getWrapperBounds(e,r))),r=l}else FEATURES.SUPPORT_RANGE_BOUNDS||(r=r.splitText(t.length));o+=t.length})),n},getWrapperBounds=function(e,t){var i=t.ownerDocument;if(i){var r=i.createElement("html2canvaswrapper");r.appendChild(t.cloneNode(!0));var s=t.parentNode;if(s){s.replaceChild(r,t);var n=parseBounds(e,r);return r.firstChild&&s.replaceChild(r.firstChild,r),n}}return Bounds.EMPTY},createRange=function(e,t,i){var r=e.ownerDocument;if(!r)throw new Error("Node has no owner document");var s=r.createRange();return s.setStart(e,t),s.setEnd(e,t+i),s},segmentGraphemes=function(e){if(FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map((function(e){return e.segment}))}return splitGraphemes(e)},segmentWords=function(e,t){if(FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION){var i=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(i.segment(e)).map((function(e){return e.segment}))}return breakWords(e,t)},breakText=function(e,t){return 0!==t.letterSpacing?segmentGraphemes(e):segmentWords(e,t)},wordSeparators=[32,160,4961,65792,65793,4153,4241],breakWords=function(e,t){for(var i,r=LineBreaker(e,{lineBreak:t.lineBreak,wordBreak:"break-word"===t.overflowWrap?"break-word":t.wordBreak}),s=[],n=function(){if(i.value){var e=i.value.slice(),t=toCodePoints$1(e),r="";t.forEach((function(e){-1===wordSeparators.indexOf(e)?r+=fromCodePoint$1(e):(r.length&&s.push(r),s.push(fromCodePoint$1(e)),r="")})),r.length&&s.push(r)}};!(i=r.next()).done;)n();return s},TextContainer=function(e,t,i){this.text=transform(t.data,i.textTransform),this.textBounds=parseTextBounds(e,this.text,i,t)},transform=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(CAPITALIZE,capitalize);case 2:return e.toUpperCase();default:return e}},CAPITALIZE=/(^|\s|:|-|\(|\))([a-z])/g,capitalize=function(e,t,i){return e.length>0?t+i.toUpperCase():e},ImageElementContainer=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.src=i.currentSrc||i.src,r.intrinsicWidth=i.naturalWidth,r.intrinsicHeight=i.naturalHeight,r.context.cache.addImage(r.src),r}return __extends(t,e),t}(ElementContainer),CanvasElementContainer=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.canvas=i,r.intrinsicWidth=i.width,r.intrinsicHeight=i.height,r}return __extends(t,e),t}(ElementContainer),SVGElementContainer=function(e){function t(t,i){var r=e.call(this,t,i)||this,s=new XMLSerializer,n=parseBounds(t,i);return i.setAttribute("width",n.width+"px"),i.setAttribute("height",n.height+"px"),r.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(i)),r.intrinsicWidth=i.width.baseVal.value,r.intrinsicHeight=i.height.baseVal.value,r.context.cache.addImage(r.svg),r}return __extends(t,e),t}(ElementContainer),LIElementContainer=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.value=i.value,r}return __extends(t,e),t}(ElementContainer),OLElementContainer=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.start=i.start,r.reversed="boolean"==typeof i.reversed&&!0===i.reversed,r}return __extends(t,e),t}(ElementContainer),CHECKBOX_BORDER_RADIUS=[{type:15,flags:0,unit:"px",number:3}],RADIO_BORDER_RADIUS=[{type:16,flags:0,number:50}],reformatInputBounds=function(e){return e.width>e.height?new Bounds(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new Bounds(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},getInputValue=function(e){var t=e.type===PASSWORD?new Array(e.value.length+1).join("•"):e.value;return 0===t.length?e.placeholder||"":t},CHECKBOX="checkbox",RADIO="radio",PASSWORD="password",INPUT_COLOR=707406591,InputElementContainer=function(e){function t(t,i){var r=e.call(this,t,i)||this;switch(r.type=i.type.toLowerCase(),r.checked=i.checked,r.value=getInputValue(i),r.type!==CHECKBOX&&r.type!==RADIO||(r.styles.backgroundColor=3739148031,r.styles.borderTopColor=r.styles.borderRightColor=r.styles.borderBottomColor=r.styles.borderLeftColor=2779096575,r.styles.borderTopWidth=r.styles.borderRightWidth=r.styles.borderBottomWidth=r.styles.borderLeftWidth=1,r.styles.borderTopStyle=r.styles.borderRightStyle=r.styles.borderBottomStyle=r.styles.borderLeftStyle=1,r.styles.backgroundClip=[0],r.styles.backgroundOrigin=[0],r.bounds=reformatInputBounds(r.bounds)),r.type){case CHECKBOX:r.styles.borderTopRightRadius=r.styles.borderTopLeftRadius=r.styles.borderBottomRightRadius=r.styles.borderBottomLeftRadius=CHECKBOX_BORDER_RADIUS;break;case RADIO:r.styles.borderTopRightRadius=r.styles.borderTopLeftRadius=r.styles.borderBottomRightRadius=r.styles.borderBottomLeftRadius=RADIO_BORDER_RADIUS}return r}return __extends(t,e),t}(ElementContainer),SelectElementContainer=function(e){function t(t,i){var r=e.call(this,t,i)||this,s=i.options[i.selectedIndex||0];return r.value=s&&s.text||"",r}return __extends(t,e),t}(ElementContainer),TextareaElementContainer=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.value=i.value,r}return __extends(t,e),t}(ElementContainer),IFrameElementContainer=function(e){function t(t,i){var r=e.call(this,t,i)||this;r.src=i.src,r.width=parseInt(i.width,10)||0,r.height=parseInt(i.height,10)||0,r.backgroundColor=r.styles.backgroundColor;try{if(i.contentWindow&&i.contentWindow.document&&i.contentWindow.document.documentElement){r.tree=parseTree(t,i.contentWindow.document.documentElement);var s=i.contentWindow.document.documentElement?parseColor(t,getComputedStyle(i.contentWindow.document.documentElement).backgroundColor):COLORS.TRANSPARENT,n=i.contentWindow.document.body?parseColor(t,getComputedStyle(i.contentWindow.document.body).backgroundColor):COLORS.TRANSPARENT;r.backgroundColor=isTransparent(s)?isTransparent(n)?r.styles.backgroundColor:n:s}}catch(e){}return r}return __extends(t,e),t}(ElementContainer),LIST_OWNERS=["OL","UL","MENU"],parseNodeTree=function(e,t,i,r){for(var s=t.firstChild,n=void 0;s;s=n)if(n=s.nextSibling,isTextNode(s)&&s.data.trim().length>0)i.textNodes.push(new TextContainer(e,s,i.styles));else if(isElementNode(s))if(isSlotElement(s)&&s.assignedNodes)s.assignedNodes().forEach((function(t){return parseNodeTree(e,t,i,r)}));else{var o=createContainer(e,s);o.styles.isVisible()&&(createsRealStackingContext(s,o,r)?o.flags|=4:createsStackingContext(o.styles)&&(o.flags|=2),-1!==LIST_OWNERS.indexOf(s.tagName)&&(o.flags|=8),i.elements.push(o),s.shadowRoot?parseNodeTree(e,s.shadowRoot,o,r):isTextareaElement(s)||isSVGElement(s)||isSelectElement(s)||parseNodeTree(e,s,o,r))}},createContainer=function(e,t){return isImageElement(t)?new ImageElementContainer(e,t):isCanvasElement(t)?new CanvasElementContainer(e,t):isSVGElement(t)?new SVGElementContainer(e,t):isLIElement(t)?new LIElementContainer(e,t):isOLElement(t)?new OLElementContainer(e,t):isInputElement(t)?new InputElementContainer(e,t):isSelectElement(t)?new SelectElementContainer(e,t):isTextareaElement(t)?new TextareaElementContainer(e,t):isIFrameElement(t)?new IFrameElementContainer(e,t):new ElementContainer(e,t)},parseTree=function(e,t){var i=createContainer(e,t);return i.flags|=4,parseNodeTree(e,t,i,i),i},createsRealStackingContext=function(e,t,i){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||isBodyElement(e)&&i.styles.isTransparent()},createsStackingContext=function(e){return e.isPositioned()||e.isFloating()},isTextNode=function(e){return e.nodeType===Node.TEXT_NODE},isElementNode=function(e){return e.nodeType===Node.ELEMENT_NODE},isHTMLElementNode=function(e){return isElementNode(e)&&void 0!==e.style&&!isSVGElementNode(e)},isSVGElementNode=function(e){return"object"==typeof e.className},isLIElement=function(e){return"LI"===e.tagName},isOLElement=function(e){return"OL"===e.tagName},isInputElement=function(e){return"INPUT"===e.tagName},isHTMLElement=function(e){return"HTML"===e.tagName},isSVGElement=function(e){return"svg"===e.tagName},isBodyElement=function(e){return"BODY"===e.tagName},isCanvasElement=function(e){return"CANVAS"===e.tagName},isVideoElement=function(e){return"VIDEO"===e.tagName},isImageElement=function(e){return"IMG"===e.tagName},isIFrameElement=function(e){return"IFRAME"===e.tagName},isStyleElement=function(e){return"STYLE"===e.tagName},isScriptElement=function(e){return"SCRIPT"===e.tagName},isTextareaElement=function(e){return"TEXTAREA"===e.tagName},isSelectElement=function(e){return"SELECT"===e.tagName},isSlotElement=function(e){return"SLOT"===e.tagName},isCustomElement=function(e){return e.tagName.indexOf("-")>0},CounterState=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},e.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},e.prototype.pop=function(e){var t=this;e.forEach((function(e){return t.counters[e].pop()}))},e.prototype.parse=function(e){var t=this,i=e.counterIncrement,r=e.counterReset,s=!0;null!==i&&i.forEach((function(e){var i=t.counters[e.counter];i&&0!==e.increment&&(s=!1,i.length||i.push(1),i[Math.max(0,i.length-1)]+=e.increment)}));var n=[];return s&&r.forEach((function(e){var i=t.counters[e.counter];n.push(e.counter),i||(i=t.counters[e.counter]=[]),i.push(e.reset)})),n},e}(),ROMAN_UPPER={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},ARMENIAN={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},HEBREW={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},GEORGIAN={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},createAdditiveCounter=function(e,t,i,r,s,n){return e<t||e>i?createCounterText(e,s,n.length>0):r.integers.reduce((function(t,i,s){for(;e>=i;)e-=i,t+=r.values[s];return t}),"")+n},createCounterStyleWithSymbolResolver=function(e,t,i,r){var s="";do{i||e--,s=r(e)+s,e/=t}while(e*t>=t);return s},createCounterStyleFromRange=function(e,t,i,r,s){var n=i-t+1;return(e<0?"-":"")+(createCounterStyleWithSymbolResolver(Math.abs(e),n,r,(function(e){return fromCodePoint$1(Math.floor(e%n)+t)}))+s)},createCounterStyleFromSymbols=function(e,t,i){void 0===i&&(i=". ");var r=t.length;return createCounterStyleWithSymbolResolver(Math.abs(e),r,!1,(function(e){return t[Math.floor(e%r)]}))+i},CJK_ZEROS=1,CJK_TEN_COEFFICIENTS=2,CJK_TEN_HIGH_COEFFICIENTS=4,CJK_HUNDRED_COEFFICIENTS=8,createCJKCounter=function(e,t,i,r,s,n){if(e<-9999||e>9999)return createCounterText(e,4,s.length>0);var o=Math.abs(e),a=s;if(0===o)return t[0]+a;for(var A=0;o>0&&A<=4;A++){var l=o%10;0===l&&contains(n,CJK_ZEROS)&&""!==a?a=t[l]+a:l>1||1===l&&0===A||1===l&&1===A&&contains(n,CJK_TEN_COEFFICIENTS)||1===l&&1===A&&contains(n,CJK_TEN_HIGH_COEFFICIENTS)&&e>100||1===l&&A>1&&contains(n,CJK_HUNDRED_COEFFICIENTS)?a=t[l]+(A>0?i[A-1]:"")+a:1===l&&A>0&&(a=i[A-1]+a),o=Math.floor(o/10)}return(e<0?r:"")+a},CHINESE_INFORMAL_MULTIPLIERS="十百千萬",CHINESE_FORMAL_MULTIPLIERS="拾佰仟萬",JAPANESE_NEGATIVE="マイナス",KOREAN_NEGATIVE="마이너스",createCounterText=function(e,t,i){var r=i?". ":"",s=i?"、":"",n=i?", ":"",o=i?" ":"";switch(t){case 0:return"•"+o;case 1:return"◦"+o;case 2:return"◾"+o;case 5:var a=createCounterStyleFromRange(e,48,57,!0,r);return a.length<4?"0"+a:a;case 4:return createCounterStyleFromSymbols(e,"〇一二三四五六七八九",s);case 6:return createAdditiveCounter(e,1,3999,ROMAN_UPPER,3,r).toLowerCase();case 7:return createAdditiveCounter(e,1,3999,ROMAN_UPPER,3,r);case 8:return createCounterStyleFromRange(e,945,969,!1,r);case 9:return createCounterStyleFromRange(e,97,122,!1,r);case 10:return createCounterStyleFromRange(e,65,90,!1,r);case 11:return createCounterStyleFromRange(e,1632,1641,!0,r);case 12:case 49:return createAdditiveCounter(e,1,9999,ARMENIAN,3,r);case 35:return createAdditiveCounter(e,1,9999,ARMENIAN,3,r).toLowerCase();case 13:return createCounterStyleFromRange(e,2534,2543,!0,r);case 14:case 30:return createCounterStyleFromRange(e,6112,6121,!0,r);case 15:return createCounterStyleFromSymbols(e,"子丑寅卯辰巳午未申酉戌亥",s);case 16:return createCounterStyleFromSymbols(e,"甲乙丙丁戊己庚辛壬癸",s);case 17:case 48:return createCJKCounter(e,"零一二三四五六七八九",CHINESE_INFORMAL_MULTIPLIERS,"負",s,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 47:return createCJKCounter(e,"零壹貳參肆伍陸柒捌玖",CHINESE_FORMAL_MULTIPLIERS,"負",s,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 42:return createCJKCounter(e,"零一二三四五六七八九",CHINESE_INFORMAL_MULTIPLIERS,"负",s,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 41:return createCJKCounter(e,"零壹贰叁肆伍陆柒捌玖",CHINESE_FORMAL_MULTIPLIERS,"负",s,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 26:return createCJKCounter(e,"〇一二三四五六七八九","十百千万",JAPANESE_NEGATIVE,s,0);case 25:return createCJKCounter(e,"零壱弐参四伍六七八九","拾百千万",JAPANESE_NEGATIVE,s,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 31:return createCJKCounter(e,"영일이삼사오육칠팔구","십백천만",KOREAN_NEGATIVE,n,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 33:return createCJKCounter(e,"零一二三四五六七八九","十百千萬",KOREAN_NEGATIVE,n,0);case 32:return createCJKCounter(e,"零壹貳參四五六七八九","拾百千",KOREAN_NEGATIVE,n,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 18:return createCounterStyleFromRange(e,2406,2415,!0,r);case 20:return createAdditiveCounter(e,1,19999,GEORGIAN,3,r);case 21:return createCounterStyleFromRange(e,2790,2799,!0,r);case 22:return createCounterStyleFromRange(e,2662,2671,!0,r);case 22:return createAdditiveCounter(e,1,10999,HEBREW,3,r);case 23:return createCounterStyleFromSymbols(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return createCounterStyleFromSymbols(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return createCounterStyleFromRange(e,3302,3311,!0,r);case 28:return createCounterStyleFromSymbols(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",s);case 29:return createCounterStyleFromSymbols(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",s);case 34:return createCounterStyleFromRange(e,3792,3801,!0,r);case 37:return createCounterStyleFromRange(e,6160,6169,!0,r);case 38:return createCounterStyleFromRange(e,4160,4169,!0,r);case 39:return createCounterStyleFromRange(e,2918,2927,!0,r);case 40:return createCounterStyleFromRange(e,1776,1785,!0,r);case 43:return createCounterStyleFromRange(e,3046,3055,!0,r);case 44:return createCounterStyleFromRange(e,3174,3183,!0,r);case 45:return createCounterStyleFromRange(e,3664,3673,!0,r);case 46:return createCounterStyleFromRange(e,3872,3881,!0,r);default:return createCounterStyleFromRange(e,48,57,!0,r)}},IGNORE_ATTRIBUTE="data-html2canvas-ignore",DocumentCloner=function(){function e(e,t,i){if(this.context=e,this.options=i,this.scrolledElements=[],this.referenceElement=t,this.counters=new CounterState,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(e,t){var i=this,r=createIFrameContainer(e,t);if(!r.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,n=e.defaultView.pageYOffset,o=r.contentWindow,a=o.document,A=iframeLoader(r).then((function(){return __awaiter(i,void 0,void 0,(function(){var e,i;return __generator(this,(function(s){switch(s.label){case 0:return this.scrolledElements.forEach(restoreNodeScroll),o&&(o.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||o.scrollY===t.top&&o.scrollX===t.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-t.left,o.scrollY-t.top,0,0))),e=this.options.onclone,void 0===(i=this.clonedReferenceElement)?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:a.fonts&&a.fonts.ready?[4,a.fonts.ready]:[3,2];case 1:s.sent(),s.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,imagesReady(a)]:[3,4];case 3:s.sent(),s.label=4;case 4:return"function"==typeof e?[2,Promise.resolve().then((function(){return e(a,i)})).then((function(){return r}))]:[2,r]}}))}))}));return a.open(),a.write(serializeDoctype(document.doctype)+"<html></html>"),restoreOwnerScroll(this.referenceElement.ownerDocument,s,n),a.replaceChild(a.adoptNode(this.documentElement),a.documentElement),a.close(),A},e.prototype.createElementClone=function(e){if(isDebugging(e,2),isCanvasElement(e))return this.createCanvasClone(e);if(isVideoElement(e))return this.createVideoClone(e);if(isStyleElement(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return isImageElement(t)&&(isImageElement(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),"lazy"===t.loading&&(t.loading="eager")),isCustomElement(t)?this.createCustomElementClone(t):t},e.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return copyCSSStyles(e.style,t),t},e.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var i=[].slice.call(t.cssRules,0).reduce((function(e,t){return t&&"string"==typeof t.cssText?e+t.cssText:e}),""),r=e.cloneNode(!1);return r.textContent=i,r}}catch(e){if(this.context.logger.error("Unable to access cssRules property",e),"SecurityError"!==e.name)throw e}return e.cloneNode(!1)},e.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var i=e.ownerDocument.createElement("img");try{return i.src=e.toDataURL(),i}catch(t){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var r=e.cloneNode(!1);try{r.width=e.width,r.height=e.height;var s=e.getContext("2d"),n=r.getContext("2d");if(n)if(!this.options.allowTaint&&s)n.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var o=null!==(t=e.getContext("webgl2"))&&void 0!==t?t:e.getContext("webgl");if(o){var a=o.getContextAttributes();!1===(null==a?void 0:a.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}n.drawImage(e,0,0)}return r}catch(t){this.context.logger.info("Unable to clone canvas as it is tainted",e)}return r},e.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var i=t.getContext("2d");try{return i&&(i.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||i.getImageData(0,0,t.width,t.height)),t}catch(t){this.context.logger.info("Unable to clone video as it is tainted",e)}var r=e.ownerDocument.createElement("canvas");return r.width=e.offsetWidth,r.height=e.offsetHeight,r},e.prototype.appendChildNode=function(e,t,i){isElementNode(t)&&(isScriptElement(t)||t.hasAttribute(IGNORE_ATTRIBUTE)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(t))||this.options.copyStyles&&isElementNode(t)&&isStyleElement(t)||e.appendChild(this.cloneNode(t,i))},e.prototype.cloneChildNodes=function(e,t,i){for(var r=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(isElementNode(s)&&isSlotElement(s)&&"function"==typeof s.assignedNodes){var n=s.assignedNodes();n.length&&n.forEach((function(e){return r.appendChildNode(t,e,i)}))}else this.appendChildNode(t,s,i)},e.prototype.cloneNode=function(e,t){if(isTextNode(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var i=e.ownerDocument.defaultView;if(i&&isElementNode(e)&&(isHTMLElementNode(e)||isSVGElementNode(e))){var r=this.createElementClone(e);r.style.transitionProperty="none";var s=i.getComputedStyle(e),n=i.getComputedStyle(e,":before"),o=i.getComputedStyle(e,":after");this.referenceElement===e&&isHTMLElementNode(r)&&(this.clonedReferenceElement=r),isBodyElement(r)&&createPseudoHideStyles(r);var a=this.counters.parse(new CSSParsedCounterDeclaration(this.context,s)),A=this.resolvePseudoContent(e,r,n,PseudoElementType.BEFORE);isCustomElement(e)&&(t=!0),isVideoElement(e)||this.cloneChildNodes(e,r,t),A&&r.insertBefore(A,r.firstChild);var l=this.resolvePseudoContent(e,r,o,PseudoElementType.AFTER);return l&&r.appendChild(l),this.counters.pop(a),(s&&(this.options.copyStyles||isSVGElementNode(e))&&!isIFrameElement(e)||t)&&copyCSSStyles(s,r),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([r,e.scrollLeft,e.scrollTop]),(isTextareaElement(e)||isSelectElement(e))&&(isTextareaElement(r)||isSelectElement(r))&&(r.value=e.value),r}return e.cloneNode(!1)},e.prototype.resolvePseudoContent=function(e,t,i,r){var s=this;if(i){var n=i.content,o=t.ownerDocument;if(o&&n&&"none"!==n&&"-moz-alt-content"!==n&&"none"!==i.display){this.counters.parse(new CSSParsedCounterDeclaration(this.context,i));var a=new CSSParsedPseudoDeclaration(this.context,i),A=o.createElement("html2canvaspseudoelement");copyCSSStyles(i,A),a.content.forEach((function(t){if(0===t.type)A.appendChild(o.createTextNode(t.value));else if(22===t.type){var i=o.createElement("img");i.src=t.value,i.style.opacity="1",A.appendChild(i)}else if(18===t.type){if("attr"===t.name){var r=t.values.filter(isIdentToken);r.length&&A.appendChild(o.createTextNode(e.getAttribute(r[0].value)||""))}else if("counter"===t.name){var n=t.values.filter(nonFunctionArgSeparator),l=n[0],h=n[1];if(l&&isIdentToken(l)){var d=s.counters.getCounterValue(l.value),c=h&&isIdentToken(h)?listStyleType.parse(s.context,h.value):3;A.appendChild(o.createTextNode(createCounterText(d,c,!1)))}}else if("counters"===t.name){var u=t.values.filter(nonFunctionArgSeparator),p=(l=u[0],u[1]);h=u[2];if(l&&isIdentToken(l)){var _=s.counters.getCounterValues(l.value),g=h&&isIdentToken(h)?listStyleType.parse(s.context,h.value):3,m=p&&0===p.type?p.value:"",f=_.map((function(e){return createCounterText(e,g,!1)})).join(m);A.appendChild(o.createTextNode(f))}}}else if(20===t.type)switch(t.value){case"open-quote":A.appendChild(o.createTextNode(getQuote(a.quotes,s.quoteDepth++,!0)));break;case"close-quote":A.appendChild(o.createTextNode(getQuote(a.quotes,--s.quoteDepth,!1)));break;default:A.appendChild(o.createTextNode(t.value))}})),A.className=PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;var l=r===PseudoElementType.BEFORE?" "+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE:" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;return isSVGElementNode(t)?t.className.baseValue+=l:t.className+=l,A}}},e.destroy=function(e){return!!e.parentNode&&(e.parentNode.removeChild(e),!0)},e}();!function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"}(PseudoElementType||(PseudoElementType={}));var CORNER,createIFrameContainer=function(e,t){var i=e.createElement("iframe");return i.className="html2canvas-container",i.style.visibility="hidden",i.style.position="fixed",i.style.left="-10000px",i.style.top="0px",i.style.border="0",i.width=t.width.toString(),i.height=t.height.toString(),i.scrolling="no",i.setAttribute(IGNORE_ATTRIBUTE,"true"),e.body.appendChild(i),i},imageReady=function(e){return new Promise((function(t){e.complete?t():e.src?(e.onload=t,e.onerror=t):t()}))},imagesReady=function(e){return Promise.all([].slice.call(e.images,0).map(imageReady))},iframeLoader=function(e){return new Promise((function(t,i){var r=e.contentWindow;if(!r)return i("No window assigned for iframe");var s=r.document;r.onload=e.onload=function(){r.onload=e.onload=null;var i=setInterval((function(){s.body.childNodes.length>0&&"complete"===s.readyState&&(clearInterval(i),t(e))}),50)}}))},ignoredStyleProperties=["all","d","content"],copyCSSStyles=function(e,t){for(var i=e.length-1;i>=0;i--){var r=e.item(i);-1===ignoredStyleProperties.indexOf(r)&&t.style.setProperty(r,e.getPropertyValue(r))}return t},serializeDoctype=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},restoreOwnerScroll=function(e,t,i){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||i!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,i)},restoreNodeScroll=function(e){var t=e[0],i=e[1],r=e[2];t.scrollLeft=i,t.scrollTop=r},PSEUDO_BEFORE=":before",PSEUDO_AFTER=":after",PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",PSEUDO_HIDE_ELEMENT_STYLE='{\n    content: "" !important;\n    display: none !important;\n}',createPseudoHideStyles=function(e){createStyles(e,"."+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+PSEUDO_BEFORE+PSEUDO_HIDE_ELEMENT_STYLE+"\n         ."+PSEUDO_HIDE_ELEMENT_CLASS_AFTER+PSEUDO_AFTER+PSEUDO_HIDE_ELEMENT_STYLE)},createStyles=function(e,t){var i=e.ownerDocument;if(i){var r=i.createElement("style");r.textContent=t,e.appendChild(r)}},CacheStorage=function(){function e(){}return e.getOrigin=function(t){var i=e._link;return i?(i.href=t,i.href=i.href,i.protocol+i.hostname+i.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),Cache=function(){function e(e,t){this.context=e,this._options=t,this._cache={}}return e.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)?t:isBlobImage(e)||isRenderable(e)?((this._cache[e]=this.loadImage(e)).catch((function(){})),t):t},e.prototype.match=function(e){return this._cache[e]},e.prototype.loadImage=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,r,s,n=this;return __generator(this,(function(o){switch(o.label){case 0:return t=CacheStorage.isSameOrigin(e),i=!isInlineImage(e)&&!0===this._options.useCORS&&FEATURES.SUPPORT_CORS_IMAGES&&!t,r=!isInlineImage(e)&&!t&&!isBlobImage(e)&&"string"==typeof this._options.proxy&&FEATURES.SUPPORT_CORS_XHR&&!i,t||!1!==this._options.allowTaint||isInlineImage(e)||isBlobImage(e)||r||i?(s=e,r?[4,this.proxy(s)]:[3,2]):[2];case 1:s=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise((function(e,t){var r=new Image;r.onload=function(){return e(r)},r.onerror=t,(isInlineBase64Image(s)||i)&&(r.crossOrigin="anonymous"),r.src=s,!0===r.complete&&setTimeout((function(){return e(r)}),500),n._options.imageTimeout>0&&setTimeout((function(){return t("Timed out ("+n._options.imageTimeout+"ms) loading image")}),n._options.imageTimeout)}))];case 3:return[2,o.sent()]}}))}))},e.prototype.has=function(e){return void 0!==this._cache[e]},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(e){var t=this,i=this._options.proxy;if(!i)throw new Error("No proxy defined");var r=e.substring(0,256);return new Promise((function(s,n){var o=FEATURES.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest;a.onload=function(){if(200===a.status)if("text"===o)s(a.response);else{var e=new FileReader;e.addEventListener("load",(function(){return s(e.result)}),!1),e.addEventListener("error",(function(e){return n(e)}),!1),e.readAsDataURL(a.response)}else n("Failed to proxy resource "+r+" with status code "+a.status)},a.onerror=n;var A=i.indexOf("?")>-1?"&":"?";if(a.open("GET",""+i+A+"url="+encodeURIComponent(e)+"&responseType="+o),"text"!==o&&a instanceof XMLHttpRequest&&(a.responseType=o),t._options.imageTimeout){var l=t._options.imageTimeout;a.timeout=l,a.ontimeout=function(){return n("Timed out ("+l+"ms) proxying "+r)}}a.send()}))},e}(),INLINE_SVG=/^data:image\/svg\+xml/i,INLINE_BASE64=/^data:image\/.*;base64,/i,INLINE_IMG=/^data:image\/.*/i,isRenderable=function(e){return FEATURES.SUPPORT_SVG_DRAWING||!isSVG(e)},isInlineImage=function(e){return INLINE_IMG.test(e)},isInlineBase64Image=function(e){return INLINE_BASE64.test(e)},isBlobImage=function(e){return"blob"===e.substr(0,4)},isSVG=function(e){return"svg"===e.substr(-3).toLowerCase()||INLINE_SVG.test(e)},Vector=function(){function e(e,t){this.type=0,this.x=e,this.y=t}return e.prototype.add=function(t,i){return new e(this.x+t,this.y+i)},e}(),lerp=function(e,t,i){return new Vector(e.x+(t.x-e.x)*i,e.y+(t.y-e.y)*i)},BezierCurve=function(){function e(e,t,i,r){this.type=1,this.start=e,this.startControl=t,this.endControl=i,this.end=r}return e.prototype.subdivide=function(t,i){var r=lerp(this.start,this.startControl,t),s=lerp(this.startControl,this.endControl,t),n=lerp(this.endControl,this.end,t),o=lerp(r,s,t),a=lerp(s,n,t),A=lerp(o,a,t);return i?new e(this.start,r,o,A):new e(A,a,n,this.end)},e.prototype.add=function(t,i){return new e(this.start.add(t,i),this.startControl.add(t,i),this.endControl.add(t,i),this.end.add(t,i))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),isBezierCurve=function(e){return 1===e.type},BoundCurves=function(e){var t=e.styles,i=e.bounds,r=getAbsoluteValueForTuple(t.borderTopLeftRadius,i.width,i.height),s=r[0],n=r[1],o=getAbsoluteValueForTuple(t.borderTopRightRadius,i.width,i.height),a=o[0],A=o[1],l=getAbsoluteValueForTuple(t.borderBottomRightRadius,i.width,i.height),h=l[0],d=l[1],c=getAbsoluteValueForTuple(t.borderBottomLeftRadius,i.width,i.height),u=c[0],p=c[1],_=[];_.push((s+a)/i.width),_.push((u+h)/i.width),_.push((n+p)/i.height),_.push((A+d)/i.height);var g=Math.max.apply(Math,_);g>1&&(s/=g,n/=g,a/=g,A/=g,h/=g,d/=g,u/=g,p/=g);var m=i.width-a,f=i.height-d,w=i.width-h,C=i.height-p,y=t.borderTopWidth,E=t.borderRightWidth,b=t.borderBottomWidth,B=t.borderLeftWidth,P=getAbsoluteValue(t.paddingTop,e.bounds.width),S=getAbsoluteValue(t.paddingRight,e.bounds.width),v=getAbsoluteValue(t.paddingBottom,e.bounds.width),R=getAbsoluteValue(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||n>0?getCurvePoints(i.left+B/3,i.top+y/3,s-B/3,n-y/3,CORNER.TOP_LEFT):new Vector(i.left+B/3,i.top+y/3),this.topRightBorderDoubleOuterBox=s>0||n>0?getCurvePoints(i.left+m,i.top+y/3,a-E/3,A-y/3,CORNER.TOP_RIGHT):new Vector(i.left+i.width-E/3,i.top+y/3),this.bottomRightBorderDoubleOuterBox=h>0||d>0?getCurvePoints(i.left+w,i.top+f,h-E/3,d-b/3,CORNER.BOTTOM_RIGHT):new Vector(i.left+i.width-E/3,i.top+i.height-b/3),this.bottomLeftBorderDoubleOuterBox=u>0||p>0?getCurvePoints(i.left+B/3,i.top+C,u-B/3,p-b/3,CORNER.BOTTOM_LEFT):new Vector(i.left+B/3,i.top+i.height-b/3),this.topLeftBorderDoubleInnerBox=s>0||n>0?getCurvePoints(i.left+2*B/3,i.top+2*y/3,s-2*B/3,n-2*y/3,CORNER.TOP_LEFT):new Vector(i.left+2*B/3,i.top+2*y/3),this.topRightBorderDoubleInnerBox=s>0||n>0?getCurvePoints(i.left+m,i.top+2*y/3,a-2*E/3,A-2*y/3,CORNER.TOP_RIGHT):new Vector(i.left+i.width-2*E/3,i.top+2*y/3),this.bottomRightBorderDoubleInnerBox=h>0||d>0?getCurvePoints(i.left+w,i.top+f,h-2*E/3,d-2*b/3,CORNER.BOTTOM_RIGHT):new Vector(i.left+i.width-2*E/3,i.top+i.height-2*b/3),this.bottomLeftBorderDoubleInnerBox=u>0||p>0?getCurvePoints(i.left+2*B/3,i.top+C,u-2*B/3,p-2*b/3,CORNER.BOTTOM_LEFT):new Vector(i.left+2*B/3,i.top+i.height-2*b/3),this.topLeftBorderStroke=s>0||n>0?getCurvePoints(i.left+B/2,i.top+y/2,s-B/2,n-y/2,CORNER.TOP_LEFT):new Vector(i.left+B/2,i.top+y/2),this.topRightBorderStroke=s>0||n>0?getCurvePoints(i.left+m,i.top+y/2,a-E/2,A-y/2,CORNER.TOP_RIGHT):new Vector(i.left+i.width-E/2,i.top+y/2),this.bottomRightBorderStroke=h>0||d>0?getCurvePoints(i.left+w,i.top+f,h-E/2,d-b/2,CORNER.BOTTOM_RIGHT):new Vector(i.left+i.width-E/2,i.top+i.height-b/2),this.bottomLeftBorderStroke=u>0||p>0?getCurvePoints(i.left+B/2,i.top+C,u-B/2,p-b/2,CORNER.BOTTOM_LEFT):new Vector(i.left+B/2,i.top+i.height-b/2),this.topLeftBorderBox=s>0||n>0?getCurvePoints(i.left,i.top,s,n,CORNER.TOP_LEFT):new Vector(i.left,i.top),this.topRightBorderBox=a>0||A>0?getCurvePoints(i.left+m,i.top,a,A,CORNER.TOP_RIGHT):new Vector(i.left+i.width,i.top),this.bottomRightBorderBox=h>0||d>0?getCurvePoints(i.left+w,i.top+f,h,d,CORNER.BOTTOM_RIGHT):new Vector(i.left+i.width,i.top+i.height),this.bottomLeftBorderBox=u>0||p>0?getCurvePoints(i.left,i.top+C,u,p,CORNER.BOTTOM_LEFT):new Vector(i.left,i.top+i.height),this.topLeftPaddingBox=s>0||n>0?getCurvePoints(i.left+B,i.top+y,Math.max(0,s-B),Math.max(0,n-y),CORNER.TOP_LEFT):new Vector(i.left+B,i.top+y),this.topRightPaddingBox=a>0||A>0?getCurvePoints(i.left+Math.min(m,i.width-E),i.top+y,m>i.width+E?0:Math.max(0,a-E),Math.max(0,A-y),CORNER.TOP_RIGHT):new Vector(i.left+i.width-E,i.top+y),this.bottomRightPaddingBox=h>0||d>0?getCurvePoints(i.left+Math.min(w,i.width-B),i.top+Math.min(f,i.height-b),Math.max(0,h-E),Math.max(0,d-b),CORNER.BOTTOM_RIGHT):new Vector(i.left+i.width-E,i.top+i.height-b),this.bottomLeftPaddingBox=u>0||p>0?getCurvePoints(i.left+B,i.top+Math.min(C,i.height-b),Math.max(0,u-B),Math.max(0,p-b),CORNER.BOTTOM_LEFT):new Vector(i.left+B,i.top+i.height-b),this.topLeftContentBox=s>0||n>0?getCurvePoints(i.left+B+R,i.top+y+P,Math.max(0,s-(B+R)),Math.max(0,n-(y+P)),CORNER.TOP_LEFT):new Vector(i.left+B+R,i.top+y+P),this.topRightContentBox=a>0||A>0?getCurvePoints(i.left+Math.min(m,i.width+B+R),i.top+y+P,m>i.width+B+R?0:a-B+R,A-(y+P),CORNER.TOP_RIGHT):new Vector(i.left+i.width-(E+S),i.top+y+P),this.bottomRightContentBox=h>0||d>0?getCurvePoints(i.left+Math.min(w,i.width-(B+R)),i.top+Math.min(f,i.height+y+P),Math.max(0,h-(E+S)),d-(b+v),CORNER.BOTTOM_RIGHT):new Vector(i.left+i.width-(E+S),i.top+i.height-(b+v)),this.bottomLeftContentBox=u>0||p>0?getCurvePoints(i.left+B+R,i.top+C,Math.max(0,u-(B+R)),p-(b+v),CORNER.BOTTOM_LEFT):new Vector(i.left+B+R,i.top+i.height-(b+v))};!function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(CORNER||(CORNER={}));var getCurvePoints=function(e,t,i,r,s){var n=(Math.sqrt(2)-1)/3*4,o=i*n,a=r*n,A=e+i,l=t+r;switch(s){case CORNER.TOP_LEFT:return new BezierCurve(new Vector(e,l),new Vector(e,l-a),new Vector(A-o,t),new Vector(A,t));case CORNER.TOP_RIGHT:return new BezierCurve(new Vector(e,t),new Vector(e+o,t),new Vector(A,l-a),new Vector(A,l));case CORNER.BOTTOM_RIGHT:return new BezierCurve(new Vector(A,t),new Vector(A,t+a),new Vector(e+o,l),new Vector(e,l));case CORNER.BOTTOM_LEFT:default:return new BezierCurve(new Vector(A,l),new Vector(A-o,l),new Vector(e,t+a),new Vector(e,t))}},calculateBorderBoxPath=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},calculateContentBoxPath=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},calculatePaddingBoxPath=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},TransformEffect=function(e,t,i){this.offsetX=e,this.offsetY=t,this.matrix=i,this.type=0,this.target=6},ClipEffect=function(e,t){this.path=e,this.target=t,this.type=1},OpacityEffect=function(e){this.opacity=e,this.type=2,this.target=6},isTransformEffect=function(e){return 0===e.type},isClipEffect=function(e){return 1===e.type},isOpacityEffect=function(e){return 2===e.type},equalPath=function(e,t){return e.length===t.length&&e.some((function(e,i){return e===t[i]}))},transformPath=function(e,t,i,r,s){return e.map((function(e,n){switch(n){case 0:return e.add(t,i);case 1:return e.add(t+r,i);case 2:return e.add(t+r,i+s);case 3:return e.add(t,i+s)}return e}))},StackingContext=function(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]},ElementPaint=function(){function e(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new BoundCurves(this.container),this.container.styles.opacity<1&&this.effects.push(new OpacityEffect(this.container.styles.opacity)),null!==this.container.styles.transform){var i=this.container.bounds.left+this.container.styles.transformOrigin[0].number,r=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new TransformEffect(i,r,s))}if(0!==this.container.styles.overflowX){var n=calculateBorderBoxPath(this.curves),o=calculatePaddingBoxPath(this.curves);equalPath(n,o)?this.effects.push(new ClipEffect(n,6)):(this.effects.push(new ClipEffect(n,2)),this.effects.push(new ClipEffect(o,4)))}}return e.prototype.getEffects=function(e){for(var t=-1===[2,3].indexOf(this.container.styles.position),i=this.parent,r=this.effects.slice(0);i;){var s=i.effects.filter((function(e){return!isClipEffect(e)}));if(t||0!==i.container.styles.position||!i.parent){if(r.unshift.apply(r,s),t=-1===[2,3].indexOf(i.container.styles.position),0!==i.container.styles.overflowX){var n=calculateBorderBoxPath(i.curves),o=calculatePaddingBoxPath(i.curves);equalPath(n,o)||r.unshift(new ClipEffect(o,6))}}else r.unshift.apply(r,s);i=i.parent}return r.filter((function(t){return contains(t.target,e)}))},e}(),parseStackTree=function(e,t,i,r){e.container.elements.forEach((function(s){var n=contains(s.flags,4),o=contains(s.flags,2),a=new ElementPaint(s,e);contains(s.styles.display,2048)&&r.push(a);var A=contains(s.flags,8)?[]:r;if(n||o){var l=n||s.styles.isPositioned()?i:t,h=new StackingContext(a);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var d=s.styles.zIndex.order;if(d<0){var c=0;l.negativeZIndex.some((function(e,t){return d>e.element.container.styles.zIndex.order?(c=t,!1):c>0})),l.negativeZIndex.splice(c,0,h)}else if(d>0){var u=0;l.positiveZIndex.some((function(e,t){return d>=e.element.container.styles.zIndex.order?(u=t+1,!1):u>0})),l.positiveZIndex.splice(u,0,h)}else l.zeroOrAutoZIndexOrTransformedOrOpacity.push(h)}else s.styles.isFloating()?l.nonPositionedFloats.push(h):l.nonPositionedInlineLevel.push(h);parseStackTree(a,h,n?h:i,A)}else s.styles.isInlineLevel()?t.inlineLevel.push(a):t.nonInlineLevel.push(a),parseStackTree(a,t,i,A);contains(s.flags,8)&&processListItems(s,A)}))},processListItems=function(e,t){for(var i=e instanceof OLElementContainer?e.start:1,r=e instanceof OLElementContainer&&e.reversed,s=0;s<t.length;s++){var n=t[s];n.container instanceof LIElementContainer&&"number"==typeof n.container.value&&0!==n.container.value&&(i=n.container.value),n.listValue=createCounterText(i,n.container.styles.listStyleType,!0),i+=r?-1:1}},parseStackingContexts=function(e){var t=new ElementPaint(e,null),i=new StackingContext(t),r=[];return parseStackTree(t,i,i,r),processListItems(t.container,r),i},parsePathForBorder=function(e,t){switch(t){case 0:return createPathFromCurves(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return createPathFromCurves(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return createPathFromCurves(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);default:return createPathFromCurves(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},parsePathForBorderDoubleOuter=function(e,t){switch(t){case 0:return createPathFromCurves(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return createPathFromCurves(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return createPathFromCurves(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);default:return createPathFromCurves(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},parsePathForBorderDoubleInner=function(e,t){switch(t){case 0:return createPathFromCurves(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return createPathFromCurves(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return createPathFromCurves(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);default:return createPathFromCurves(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},parsePathForBorderStroke=function(e,t){switch(t){case 0:return createStrokePathFromCurves(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return createStrokePathFromCurves(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return createStrokePathFromCurves(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);default:return createStrokePathFromCurves(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},createStrokePathFromCurves=function(e,t){var i=[];return isBezierCurve(e)?i.push(e.subdivide(.5,!1)):i.push(e),isBezierCurve(t)?i.push(t.subdivide(.5,!0)):i.push(t),i},createPathFromCurves=function(e,t,i,r){var s=[];return isBezierCurve(e)?s.push(e.subdivide(.5,!1)):s.push(e),isBezierCurve(i)?s.push(i.subdivide(.5,!0)):s.push(i),isBezierCurve(r)?s.push(r.subdivide(.5,!0).reverse()):s.push(r),isBezierCurve(t)?s.push(t.subdivide(.5,!1).reverse()):s.push(t),s},paddingBox=function(e){var t=e.bounds,i=e.styles;return t.add(i.borderLeftWidth,i.borderTopWidth,-(i.borderRightWidth+i.borderLeftWidth),-(i.borderTopWidth+i.borderBottomWidth))},contentBox=function(e){var t=e.styles,i=e.bounds,r=getAbsoluteValue(t.paddingLeft,i.width),s=getAbsoluteValue(t.paddingRight,i.width),n=getAbsoluteValue(t.paddingTop,i.width),o=getAbsoluteValue(t.paddingBottom,i.width);return i.add(r+t.borderLeftWidth,n+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+r+s),-(t.borderTopWidth+t.borderBottomWidth+n+o))},calculateBackgroundPositioningArea=function(e,t){return 0===e?t.bounds:2===e?contentBox(t):paddingBox(t)},calculateBackgroundPaintingArea=function(e,t){return 0===e?t.bounds:2===e?contentBox(t):paddingBox(t)},calculateBackgroundRendering=function(e,t,i){var r=calculateBackgroundPositioningArea(getBackgroundValueForIndex(e.styles.backgroundOrigin,t),e),s=calculateBackgroundPaintingArea(getBackgroundValueForIndex(e.styles.backgroundClip,t),e),n=calculateBackgroundSize(getBackgroundValueForIndex(e.styles.backgroundSize,t),i,r),o=n[0],a=n[1],A=getAbsoluteValueForTuple(getBackgroundValueForIndex(e.styles.backgroundPosition,t),r.width-o,r.height-a);return[calculateBackgroundRepeatPath(getBackgroundValueForIndex(e.styles.backgroundRepeat,t),A,n,r,s),Math.round(r.left+A[0]),Math.round(r.top+A[1]),o,a]},isAuto=function(e){return isIdentToken(e)&&e.value===BACKGROUND_SIZE.AUTO},hasIntrinsicValue=function(e){return"number"==typeof e},calculateBackgroundSize=function(e,t,i){var r=t[0],s=t[1],n=t[2],o=e[0],a=e[1];if(!o)return[0,0];if(isLengthPercentage(o)&&a&&isLengthPercentage(a))return[getAbsoluteValue(o,i.width),getAbsoluteValue(a,i.height)];var A=hasIntrinsicValue(n);if(isIdentToken(o)&&(o.value===BACKGROUND_SIZE.CONTAIN||o.value===BACKGROUND_SIZE.COVER))return hasIntrinsicValue(n)?i.width/i.height<n!=(o.value===BACKGROUND_SIZE.COVER)?[i.width,i.width/n]:[i.height*n,i.height]:[i.width,i.height];var l=hasIntrinsicValue(r),h=hasIntrinsicValue(s),d=l||h;if(isAuto(o)&&(!a||isAuto(a)))return l&&h?[r,s]:A||d?d&&A?[l?r:s*n,h?s:r/n]:[l?r:i.width,h?s:i.height]:[i.width,i.height];if(A){var c=0,u=0;return isLengthPercentage(o)?c=getAbsoluteValue(o,i.width):isLengthPercentage(a)&&(u=getAbsoluteValue(a,i.height)),isAuto(o)?c=u*n:a&&!isAuto(a)||(u=c/n),[c,u]}var p=null,_=null;if(isLengthPercentage(o)?p=getAbsoluteValue(o,i.width):a&&isLengthPercentage(a)&&(_=getAbsoluteValue(a,i.height)),null===p||a&&!isAuto(a)||(_=l&&h?p/r*s:i.height),null!==_&&isAuto(o)&&(p=l&&h?_/s*r:i.width),null!==p&&null!==_)return[p,_];throw new Error("Unable to calculate background-size for element")},getBackgroundValueForIndex=function(e,t){var i=e[t];return void 0===i?e[0]:i},calculateBackgroundRepeatPath=function(e,t,i,r,s){var n=t[0],o=t[1],a=i[0],A=i[1];switch(e){case 2:return[new Vector(Math.round(r.left),Math.round(r.top+o)),new Vector(Math.round(r.left+r.width),Math.round(r.top+o)),new Vector(Math.round(r.left+r.width),Math.round(A+r.top+o)),new Vector(Math.round(r.left),Math.round(A+r.top+o))];case 3:return[new Vector(Math.round(r.left+n),Math.round(r.top)),new Vector(Math.round(r.left+n+a),Math.round(r.top)),new Vector(Math.round(r.left+n+a),Math.round(r.height+r.top)),new Vector(Math.round(r.left+n),Math.round(r.height+r.top))];case 1:return[new Vector(Math.round(r.left+n),Math.round(r.top+o)),new Vector(Math.round(r.left+n+a),Math.round(r.top+o)),new Vector(Math.round(r.left+n+a),Math.round(r.top+o+A)),new Vector(Math.round(r.left+n),Math.round(r.top+o+A))];default:return[new Vector(Math.round(s.left),Math.round(s.top)),new Vector(Math.round(s.left+s.width),Math.round(s.top)),new Vector(Math.round(s.left+s.width),Math.round(s.height+s.top)),new Vector(Math.round(s.left),Math.round(s.height+s.top))]}},SMALL_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",SAMPLE_TEXT="Hidden Text",FontMetrics=function(){function e(e){this._data={},this._document=e}return e.prototype.parseMetrics=function(e,t){var i=this._document.createElement("div"),r=this._document.createElement("img"),s=this._document.createElement("span"),n=this._document.body;i.style.visibility="hidden",i.style.fontFamily=e,i.style.fontSize=t,i.style.margin="0",i.style.padding="0",i.style.whiteSpace="nowrap",n.appendChild(i),r.src=SMALL_IMAGE,r.width=1,r.height=1,r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(SAMPLE_TEXT)),i.appendChild(s),i.appendChild(r);var o=r.offsetTop-s.offsetTop+2;i.removeChild(s),i.appendChild(this._document.createTextNode(SAMPLE_TEXT)),i.style.lineHeight="normal",r.style.verticalAlign="super";var a=r.offsetTop-i.offsetTop+2;return n.removeChild(i),{baseline:o,middle:a}},e.prototype.getMetrics=function(e,t){var i=e+" "+t;return void 0===this._data[i]&&(this._data[i]=this.parseMetrics(e,t)),this._data[i]},e}(),Renderer=function(e,t){this.context=e,this.options=t},MASK_OFFSET=1e4,CanvasRenderer=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r._activeEffects=[],r.canvas=i.canvas?i.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),i.canvas||(r.canvas.width=Math.floor(i.width*i.scale),r.canvas.height=Math.floor(i.height*i.scale),r.canvas.style.width=i.width+"px",r.canvas.style.height=i.height+"px"),r.fontMetrics=new FontMetrics(document),r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-i.x,-i.y),r.ctx.textBaseline="bottom",r._activeEffects=[],r.context.logger.debug("Canvas renderer initialized ("+i.width+"x"+i.height+") with scale "+i.scale),r}return __extends(t,e),t.prototype.applyEffects=function(e){for(var t=this;this._activeEffects.length;)this.popEffect();e.forEach((function(e){return t.applyEffect(e)}))},t.prototype.applyEffect=function(e){this.ctx.save(),isOpacityEffect(e)&&(this.ctx.globalAlpha=e.opacity),isTransformEffect(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),isClipEffect(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return e.element.container.styles.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.renderNode=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return contains(e.container.flags,16),e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return t.sent(),[4,this.renderNodeContent(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},t.prototype.renderTextWithLetterSpacing=function(e,t,i){var r=this;0===t?this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+i):segmentGraphemes(e.text).reduce((function(t,s){return r.ctx.fillText(s,t,e.bounds.top+i),t+r.ctx.measureText(s).width}),e.bounds.left)},t.prototype.createFontStyle=function(e){var t=e.fontVariant.filter((function(e){return"normal"===e||"small-caps"===e})).join(""),i=fixIOSSystemFonts(e.fontFamily).join(", "),r=isDimensionToken(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,t,e.fontWeight,r,i].join(" "),i,r]},t.prototype.renderTextNode=function(e,t){return __awaiter(this,void 0,void 0,(function(){var i,r,s,n,o,a,A,l,h=this;return __generator(this,(function(d){return i=this.createFontStyle(t),r=i[0],s=i[1],n=i[2],this.ctx.font=r,this.ctx.direction=1===t.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",o=this.fontMetrics.getMetrics(s,n),a=o.baseline,A=o.middle,l=t.paintOrder,e.textBounds.forEach((function(e){l.forEach((function(i){switch(i){case 0:h.ctx.fillStyle=asString(t.color),h.renderTextWithLetterSpacing(e,t.letterSpacing,a);var r=t.textShadow;r.length&&e.text.trim().length&&(r.slice(0).reverse().forEach((function(i){h.ctx.shadowColor=asString(i.color),h.ctx.shadowOffsetX=i.offsetX.number*h.options.scale,h.ctx.shadowOffsetY=i.offsetY.number*h.options.scale,h.ctx.shadowBlur=i.blur.number,h.renderTextWithLetterSpacing(e,t.letterSpacing,a)})),h.ctx.shadowColor="",h.ctx.shadowOffsetX=0,h.ctx.shadowOffsetY=0,h.ctx.shadowBlur=0),t.textDecorationLine.length&&(h.ctx.fillStyle=asString(t.textDecorationColor||t.color),t.textDecorationLine.forEach((function(t){switch(t){case 1:h.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top+a),e.bounds.width,1);break;case 2:h.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1);break;case 3:h.ctx.fillRect(e.bounds.left,Math.ceil(e.bounds.top+A),e.bounds.width,1)}})));break;case 1:t.webkitTextStrokeWidth&&e.text.trim().length&&(h.ctx.strokeStyle=asString(t.webkitTextStrokeColor),h.ctx.lineWidth=t.webkitTextStrokeWidth,h.ctx.lineJoin=window.chrome?"miter":"round",h.ctx.strokeText(e.text,e.bounds.left,e.bounds.top+a)),h.ctx.strokeStyle="",h.ctx.lineWidth=0,h.ctx.lineJoin="miter"}}))})),[2]}))}))},t.prototype.renderReplacedElement=function(e,t,i){if(i&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var r=contentBox(e),s=calculatePaddingBoxPath(t);this.path(s),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(i,0,0,e.intrinsicWidth,e.intrinsicHeight,r.left,r.top,r.width,r.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(e){return __awaiter(this,void 0,void 0,(function(){var i,r,s,n,o,a,A,l,h,d,c,u,p,_,g,m,f,w;return __generator(this,(function(C){switch(C.label){case 0:this.applyEffects(e.getEffects(4)),i=e.container,r=e.curves,s=i.styles,n=0,o=i.textNodes,C.label=1;case 1:return n<o.length?(a=o[n],[4,this.renderTextNode(a,s)]):[3,4];case 2:C.sent(),C.label=3;case 3:return n++,[3,1];case 4:if(!(i instanceof ImageElementContainer))return[3,8];C.label=5;case 5:return C.trys.push([5,7,,8]),[4,this.context.cache.match(i.src)];case 6:return g=C.sent(),this.renderReplacedElement(i,r,g),[3,8];case 7:return C.sent(),this.context.logger.error("Error loading image "+i.src),[3,8];case 8:if(i instanceof CanvasElementContainer&&this.renderReplacedElement(i,r,i.canvas),!(i instanceof SVGElementContainer))return[3,12];C.label=9;case 9:return C.trys.push([9,11,,12]),[4,this.context.cache.match(i.svg)];case 10:return g=C.sent(),this.renderReplacedElement(i,r,g),[3,12];case 11:return C.sent(),this.context.logger.error("Error loading svg "+i.svg.substring(0,255)),[3,12];case 12:return i instanceof IFrameElementContainer&&i.tree?[4,new t(this.context,{scale:this.options.scale,backgroundColor:i.backgroundColor,x:0,y:0,width:i.width,height:i.height}).render(i.tree)]:[3,14];case 13:A=C.sent(),i.width&&i.height&&this.ctx.drawImage(A,0,0,i.width,i.height,i.bounds.left,i.bounds.top,i.bounds.width,i.bounds.height),C.label=14;case 14:if(i instanceof InputElementContainer&&(l=Math.min(i.bounds.width,i.bounds.height),i.type===CHECKBOX?i.checked&&(this.ctx.save(),this.path([new Vector(i.bounds.left+.39363*l,i.bounds.top+.79*l),new Vector(i.bounds.left+.16*l,i.bounds.top+.5549*l),new Vector(i.bounds.left+.27347*l,i.bounds.top+.44071*l),new Vector(i.bounds.left+.39694*l,i.bounds.top+.5649*l),new Vector(i.bounds.left+.72983*l,i.bounds.top+.23*l),new Vector(i.bounds.left+.84*l,i.bounds.top+.34085*l),new Vector(i.bounds.left+.39363*l,i.bounds.top+.79*l)]),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore()):i.type===RADIO&&i.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(i.bounds.left+l/2,i.bounds.top+l/2,l/4,0,2*Math.PI,!0),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore())),isTextInputElement(i)&&i.value.length){switch(h=this.createFontStyle(s),f=h[0],d=h[1],c=this.fontMetrics.getMetrics(f,d).baseline,this.ctx.font=f,this.ctx.fillStyle=asString(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=canvasTextAlign(i.styles.textAlign),w=contentBox(i),u=0,i.styles.textAlign){case 1:u+=w.width/2;break;case 2:u+=w.width}p=w.add(u,0,0,-w.height/2+1),this.ctx.save(),this.path([new Vector(w.left,w.top),new Vector(w.left+w.width,w.top),new Vector(w.left+w.width,w.top+w.height),new Vector(w.left,w.top+w.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new TextBounds(i.value,p),s.letterSpacing,c),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!contains(i.styles.display,2048))return[3,20];if(null===i.styles.listStyleImage)return[3,19];if(0!==(_=i.styles.listStyleImage).type)return[3,18];g=void 0,m=_.url,C.label=15;case 15:return C.trys.push([15,17,,18]),[4,this.context.cache.match(m)];case 16:return g=C.sent(),this.ctx.drawImage(g,i.bounds.left-(g.width+10),i.bounds.top),[3,18];case 17:return C.sent(),this.context.logger.error("Error loading list-style-image "+m),[3,18];case 18:return[3,20];case 19:e.listValue&&-1!==i.styles.listStyleType&&(f=this.createFontStyle(s)[0],this.ctx.font=f,this.ctx.fillStyle=asString(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",w=new Bounds(i.bounds.left,i.bounds.top+getAbsoluteValue(i.styles.paddingTop,i.bounds.width),i.bounds.width,computeLineHeight(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new TextBounds(e.listValue,w),s.letterSpacing,computeLineHeight(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),C.label=20;case 20:return[2]}}))}))},t.prototype.renderStackContent=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,r,s,n,o,a,A,l,h,d,c,u,p,_;return __generator(this,(function(g){switch(g.label){case 0:return contains(e.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:g.sent(),t=0,i=e.negativeZIndex,g.label=2;case 2:return t<i.length?(_=i[t],[4,this.renderStack(_)]):[3,5];case 3:g.sent(),g.label=4;case 4:return t++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:g.sent(),r=0,s=e.nonInlineLevel,g.label=7;case 7:return r<s.length?(_=s[r],[4,this.renderNode(_)]):[3,10];case 8:g.sent(),g.label=9;case 9:return r++,[3,7];case 10:n=0,o=e.nonPositionedFloats,g.label=11;case 11:return n<o.length?(_=o[n],[4,this.renderStack(_)]):[3,14];case 12:g.sent(),g.label=13;case 13:return n++,[3,11];case 14:a=0,A=e.nonPositionedInlineLevel,g.label=15;case 15:return a<A.length?(_=A[a],[4,this.renderStack(_)]):[3,18];case 16:g.sent(),g.label=17;case 17:return a++,[3,15];case 18:l=0,h=e.inlineLevel,g.label=19;case 19:return l<h.length?(_=h[l],[4,this.renderNode(_)]):[3,22];case 20:g.sent(),g.label=21;case 21:return l++,[3,19];case 22:d=0,c=e.zeroOrAutoZIndexOrTransformedOrOpacity,g.label=23;case 23:return d<c.length?(_=c[d],[4,this.renderStack(_)]):[3,26];case 24:g.sent(),g.label=25;case 25:return d++,[3,23];case 26:u=0,p=e.positiveZIndex,g.label=27;case 27:return u<p.length?(_=p[u],[4,this.renderStack(_)]):[3,30];case 28:g.sent(),g.label=29;case 29:return u++,[3,27];case 30:return[2]}}))}))},t.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},t.prototype.formatPath=function(e){var t=this;e.forEach((function(e,i){var r=isBezierCurve(e)?e.start:e;0===i?t.ctx.moveTo(r.x,r.y):t.ctx.lineTo(r.x,r.y),isBezierCurve(e)&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)}))},t.prototype.renderRepeat=function(e,t,i,r){this.path(e),this.ctx.fillStyle=t,this.ctx.translate(i,r),this.ctx.fill(),this.ctx.translate(-i,-r)},t.prototype.resizeImage=function(e,t,i){var r;if(e.width===t&&e.height===i)return e;var s=(null!==(r=this.canvas.ownerDocument)&&void 0!==r?r:document).createElement("canvas");return s.width=Math.max(1,t),s.height=Math.max(1,i),s.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t,i),s},t.prototype.renderBackgroundImage=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,r,s,n,o;return __generator(this,(function(a){switch(a.label){case 0:t=e.styles.backgroundImage.length-1,i=function(i){var s,n,o,a,A,l,h,d,c,u,p,_,g,m,f,w,C,y,E,b,B,P,S,v,R,I,T,x,O,D,L;return __generator(this,(function(F){switch(F.label){case 0:if(0!==i.type)return[3,5];s=void 0,n=i.url,F.label=1;case 1:return F.trys.push([1,3,,4]),[4,r.context.cache.match(n)];case 2:return s=F.sent(),[3,4];case 3:return F.sent(),r.context.logger.error("Error loading background-image "+n),[3,4];case 4:return s&&(o=calculateBackgroundRendering(e,t,[s.width,s.height,s.width/s.height]),w=o[0],P=o[1],S=o[2],E=o[3],b=o[4],m=r.ctx.createPattern(r.resizeImage(s,E,b),"repeat"),r.renderRepeat(w,m,P,S)),[3,6];case 5:isLinearGradient(i)?(a=calculateBackgroundRendering(e,t,[null,null,null]),w=a[0],P=a[1],S=a[2],E=a[3],b=a[4],A=calculateGradientDirection(i.angle,E,b),l=A[0],h=A[1],d=A[2],c=A[3],u=A[4],(p=document.createElement("canvas")).width=E,p.height=b,_=p.getContext("2d"),g=_.createLinearGradient(h,c,d,u),processColorStops(i.stops,l).forEach((function(e){return g.addColorStop(e.stop,asString(e.color))})),_.fillStyle=g,_.fillRect(0,0,E,b),E>0&&b>0&&(m=r.ctx.createPattern(p,"repeat"),r.renderRepeat(w,m,P,S))):isRadialGradient(i)&&(f=calculateBackgroundRendering(e,t,[null,null,null]),w=f[0],C=f[1],y=f[2],E=f[3],b=f[4],B=0===i.position.length?[FIFTY_PERCENT]:i.position,P=getAbsoluteValue(B[0],E),S=getAbsoluteValue(B[B.length-1],b),v=calculateRadius(i,P,S,E,b),R=v[0],I=v[1],R>0&&I>0&&(T=r.ctx.createRadialGradient(C+P,y+S,0,C+P,y+S,R),processColorStops(i.stops,2*R).forEach((function(e){return T.addColorStop(e.stop,asString(e.color))})),r.path(w),r.ctx.fillStyle=T,R!==I?(x=e.bounds.left+.5*e.bounds.width,O=e.bounds.top+.5*e.bounds.height,L=1/(D=I/R),r.ctx.save(),r.ctx.translate(x,O),r.ctx.transform(1,0,0,D,0,0),r.ctx.translate(-x,-O),r.ctx.fillRect(C,L*(y-O)+O,E,b*L),r.ctx.restore()):r.ctx.fill())),F.label=6;case 6:return t--,[2]}}))},r=this,s=0,n=e.styles.backgroundImage.slice(0).reverse(),a.label=1;case 1:return s<n.length?(o=n[s],[5,i(o)]):[3,4];case 2:a.sent(),a.label=3;case 3:return s++,[3,1];case 4:return[2]}}))}))},t.prototype.renderSolidBorder=function(e,t,i){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){return this.path(parsePathForBorder(i,t)),this.ctx.fillStyle=asString(e),this.ctx.fill(),[2]}))}))},t.prototype.renderDoubleBorder=function(e,t,i,r){return __awaiter(this,void 0,void 0,(function(){var s,n;return __generator(this,(function(o){switch(o.label){case 0:return t<3?[4,this.renderSolidBorder(e,i,r)]:[3,2];case 1:return o.sent(),[2];case 2:return s=parsePathForBorderDoubleOuter(r,i),this.path(s),this.ctx.fillStyle=asString(e),this.ctx.fill(),n=parsePathForBorderDoubleInner(r,i),this.path(n),this.ctx.fill(),[2]}}))}))},t.prototype.renderNodeBackgroundAndBorders=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i,r,s,n,o,a,A,l=this;return __generator(this,(function(h){switch(h.label){case 0:return this.applyEffects(e.getEffects(2)),t=e.container.styles,i=!isTransparent(t.backgroundColor)||t.backgroundImage.length,r=[{style:t.borderTopStyle,color:t.borderTopColor,width:t.borderTopWidth},{style:t.borderRightStyle,color:t.borderRightColor,width:t.borderRightWidth},{style:t.borderBottomStyle,color:t.borderBottomColor,width:t.borderBottomWidth},{style:t.borderLeftStyle,color:t.borderLeftColor,width:t.borderLeftWidth}],s=calculateBackgroundCurvedPaintingArea(getBackgroundValueForIndex(t.backgroundClip,0),e.curves),i||t.boxShadow.length?(this.ctx.save(),this.path(s),this.ctx.clip(),isTransparent(t.backgroundColor)||(this.ctx.fillStyle=asString(t.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),t.boxShadow.slice(0).reverse().forEach((function(t){l.ctx.save();var i=calculateBorderBoxPath(e.curves),r=t.inset?0:MASK_OFFSET,s=transformPath(i,-r+(t.inset?1:-1)*t.spread.number,(t.inset?1:-1)*t.spread.number,t.spread.number*(t.inset?-2:2),t.spread.number*(t.inset?-2:2));t.inset?(l.path(i),l.ctx.clip(),l.mask(s)):(l.mask(i),l.ctx.clip(),l.path(s)),l.ctx.shadowOffsetX=t.offsetX.number+r,l.ctx.shadowOffsetY=t.offsetY.number,l.ctx.shadowColor=asString(t.color),l.ctx.shadowBlur=t.blur.number,l.ctx.fillStyle=t.inset?asString(t.color):"rgba(0,0,0,1)",l.ctx.fill(),l.ctx.restore()})),h.label=2;case 2:n=0,o=0,a=r,h.label=3;case 3:return o<a.length?0!==(A=a[o]).style&&!isTransparent(A.color)&&A.width>0?2!==A.style?[3,5]:[4,this.renderDashedDottedBorder(A.color,A.width,n,e.curves,2)]:[3,11]:[3,13];case 4:return h.sent(),[3,11];case 5:return 3!==A.style?[3,7]:[4,this.renderDashedDottedBorder(A.color,A.width,n,e.curves,3)];case 6:return h.sent(),[3,11];case 7:return 4!==A.style?[3,9]:[4,this.renderDoubleBorder(A.color,A.width,n,e.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(A.color,n,e.curves)];case 10:h.sent(),h.label=11;case 11:n++,h.label=12;case 12:return o++,[3,3];case 13:return[2]}}))}))},t.prototype.renderDashedDottedBorder=function(e,t,i,r,s){return __awaiter(this,void 0,void 0,(function(){var n,o,a,A,l,h,d,c,u,p,_,g,m,f,w,C;return __generator(this,(function(y){return this.ctx.save(),n=parsePathForBorderStroke(r,i),o=parsePathForBorder(r,i),2===s&&(this.path(o),this.ctx.clip()),isBezierCurve(o[0])?(a=o[0].start.x,A=o[0].start.y):(a=o[0].x,A=o[0].y),isBezierCurve(o[1])?(l=o[1].end.x,h=o[1].end.y):(l=o[1].x,h=o[1].y),d=0===i||2===i?Math.abs(a-l):Math.abs(A-h),this.ctx.beginPath(),3===s?this.formatPath(n):this.formatPath(o.slice(0,2)),c=t<3?3*t:2*t,u=t<3?2*t:t,3===s&&(c=t,u=t),p=!0,d<=2*c?p=!1:d<=2*c+u?(c*=_=d/(2*c+u),u*=_):(g=Math.floor((d+u)/(c+u)),m=(d-g*c)/(g-1),u=(f=(d-(g+1)*c)/g)<=0||Math.abs(u-m)<Math.abs(u-f)?m:f),p&&(3===s?this.ctx.setLineDash([0,c+u]):this.ctx.setLineDash([c,u])),3===s?(this.ctx.lineCap="round",this.ctx.lineWidth=t):this.ctx.lineWidth=2*t+1.1,this.ctx.strokeStyle=asString(e),this.ctx.stroke(),this.ctx.setLineDash([]),2===s&&(isBezierCurve(o[0])&&(w=o[3],C=o[0],this.ctx.beginPath(),this.formatPath([new Vector(w.end.x,w.end.y),new Vector(C.start.x,C.start.y)]),this.ctx.stroke()),isBezierCurve(o[1])&&(w=o[1],C=o[2],this.ctx.beginPath(),this.formatPath([new Vector(w.end.x,w.end.y),new Vector(C.start.x,C.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]}))}))},t.prototype.render=function(e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),t=parseStackingContexts(e),[4,this.renderStack(t)];case 1:return i.sent(),this.applyEffects([]),[2,this.canvas]}}))}))},t}(Renderer),isTextInputElement=function(e){return e instanceof TextareaElementContainer||(e instanceof SelectElementContainer||e instanceof InputElementContainer&&e.type!==RADIO&&e.type!==CHECKBOX)},calculateBackgroundCurvedPaintingArea=function(e,t){switch(e){case 0:return calculateBorderBoxPath(t);case 2:return calculateContentBoxPath(t);default:return calculatePaddingBoxPath(t)}},canvasTextAlign=function(e){switch(e){case 1:return"center";case 2:return"right";default:return"left"}},iOSBrokenFonts=["-apple-system","system-ui"],fixIOSSystemFonts=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter((function(e){return-1===iOSBrokenFonts.indexOf(e)})):e},ForeignObjectRenderer=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.canvas=i.canvas?i.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),r.options=i,r.canvas.width=Math.floor(i.width*i.scale),r.canvas.height=Math.floor(i.height*i.scale),r.canvas.style.width=i.width+"px",r.canvas.style.height=i.height+"px",r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-i.x,-i.y),r.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+i.width+"x"+i.height+" at "+i.x+","+i.y+") with scale "+i.scale),r}return __extends(t,e),t.prototype.render=function(e){return __awaiter(this,void 0,void 0,(function(){var t,i;return __generator(this,(function(r){switch(r.label){case 0:return t=createForeignObjectSVG(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,loadSerializedSVG(t)];case 1:return i=r.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(i,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}}))}))},t}(Renderer),loadSerializedSVG=function(e){return new Promise((function(t,i){var r=new Image;r.onload=function(){t(r)},r.onerror=i,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},Logger=function(){function e(e){var t=e.id,i=e.enabled;this.id=t,this.enabled=i,this.start=Date.now()}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug?console.debug.apply(console,__spreadArray([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof console.info&&console.info.apply(console,__spreadArray([this.id,this.getTime()+"ms"],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn?console.warn.apply(console,__spreadArray([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error?console.error.apply(console,__spreadArray([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},e.instances={},e}(),Context=function(){function e(t,i){var r;this.windowBounds=i,this.instanceName="#"+e.instanceCount++,this.logger=new Logger({id:this.instanceName,enabled:t.logging}),this.cache=null!==(r=t.cache)&&void 0!==r?r:new Cache(this,t)}return e.instanceCount=1,e}(),html2canvas=function(e,t){return void 0===t&&(t={}),renderElement(e,t)};"undefined"!=typeof window&&CacheStorage.setContext(window);var renderElement=function(e,t){return __awaiter(void 0,void 0,void 0,(function(){var i,r,s,n,o,a,A,l,h,d,c,u,p,_,g,m,f,w,C,y,E,b,B,P,S,v,R,I,T,x,O,D,L,F,H,N,U,M;return __generator(this,(function(k){switch(k.label){case 0:if(!e||"object"!=typeof e)return[2,Promise.reject("Invalid element provided as first argument")];if(!(i=e.ownerDocument))throw new Error("Element is not attached to a Document");if(!(r=i.defaultView))throw new Error("Document is not attached to a Window");return s={allowTaint:null!==(b=t.allowTaint)&&void 0!==b&&b,imageTimeout:null!==(B=t.imageTimeout)&&void 0!==B?B:15e3,proxy:t.proxy,useCORS:null!==(P=t.useCORS)&&void 0!==P&&P},n=__assign({logging:null===(S=t.logging)||void 0===S||S,cache:t.cache},s),o={windowWidth:null!==(v=t.windowWidth)&&void 0!==v?v:r.innerWidth,windowHeight:null!==(R=t.windowHeight)&&void 0!==R?R:r.innerHeight,scrollX:null!==(I=t.scrollX)&&void 0!==I?I:r.pageXOffset,scrollY:null!==(T=t.scrollY)&&void 0!==T?T:r.pageYOffset},a=new Bounds(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),A=new Context(n,a),l=null!==(x=t.foreignObjectRendering)&&void 0!==x&&x,h={allowTaint:null!==(O=t.allowTaint)&&void 0!==O&&O,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:l,copyStyles:l},A.logger.debug("Starting document clone with size "+a.width+"x"+a.height+" scrolled to "+-a.left+","+-a.top),d=new DocumentCloner(A,e,h),(c=d.clonedReferenceElement)?[4,d.toIFrame(i,a)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return u=k.sent(),p=isBodyElement(c)||isHTMLElement(c)?parseDocumentSize(c.ownerDocument):parseBounds(A,c),_=p.width,g=p.height,m=p.left,f=p.top,w=parseBackgroundColor(A,c,t.backgroundColor),C={canvas:t.canvas,backgroundColor:w,scale:null!==(L=null!==(D=t.scale)&&void 0!==D?D:r.devicePixelRatio)&&void 0!==L?L:1,x:(null!==(F=t.x)&&void 0!==F?F:0)+m,y:(null!==(H=t.y)&&void 0!==H?H:0)+f,width:null!==(N=t.width)&&void 0!==N?N:Math.ceil(_),height:null!==(U=t.height)&&void 0!==U?U:Math.ceil(g)},l?(A.logger.debug("Document cloned, using foreign object rendering"),[4,new ForeignObjectRenderer(A,C).render(c)]):[3,3];case 2:return y=k.sent(),[3,5];case 3:return A.logger.debug("Document cloned, element located at "+m+","+f+" with size "+_+"x"+g+" using computed rendering"),A.logger.debug("Starting DOM parsing"),E=parseTree(A,c),w===E.styles.backgroundColor&&(E.styles.backgroundColor=COLORS.TRANSPARENT),A.logger.debug("Starting renderer for element at "+C.x+","+C.y+" with size "+C.width+"x"+C.height),[4,new CanvasRenderer(A,C).render(E)];case 4:y=k.sent(),k.label=5;case 5:return(null===(M=t.removeContainer)||void 0===M||M)&&(DocumentCloner.destroy(u)||A.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),A.logger.debug("Finished rendering"),[2,y]}}))}))},parseBackgroundColor=function(e,t,i){var r=t.ownerDocument,s=r.documentElement?parseColor(e,getComputedStyle(r.documentElement).backgroundColor):COLORS.TRANSPARENT,n=r.body?parseColor(e,getComputedStyle(r.body).backgroundColor):COLORS.TRANSPARENT,o="string"==typeof i?parseColor(e,i):null===i?COLORS.TRANSPARENT:4294967295;return t===r.documentElement?isTransparent(s)?isTransparent(n)?o:n:s:o},u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(e,t){for(var i=new u16(31),r=0;r<31;++r)i[r]=t+=1<<e[r-1];var s=new u32(i[30]);for(r=1;r<30;++r)for(var n=i[r];n<i[r+1];++n)s[n]=n-i[r]<<5|r;return[i,s]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;for(var _b=freb(fdeb,0),revfd=_b[1],rev=new u16(32768),i$1=0;i$1<32768;++i$1){var x=(43690&i$1)>>>1|(21845&i$1)<<1;x=(61680&(x=(52428&x)>>>2|(13107&x)<<2))>>>4|(3855&x)<<4,rev[i$1]=((65280&x)>>>8|(255&x)<<8)>>>1}var hMap=function(e,t,i){for(var r=e.length,s=0,n=new u16(t);s<r;++s)e[s]&&++n[e[s]-1];var o,a=new u16(t);for(s=0;s<t;++s)a[s]=a[s-1]+n[s-1]<<1;if(i){o=new u16(1<<t);var A=15-t;for(s=0;s<r;++s)if(e[s])for(var l=s<<4|e[s],h=t-e[s],d=a[e[s]-1]++<<h,c=d|(1<<h)-1;d<=c;++d)o[rev[d]>>>A]=l}else for(o=new u16(r),s=0;s<r;++s)e[s]&&(o[s]=rev[a[e[s]-1]++]>>>15-e[s]);return o},flt=new u8(288);for(i$1=0;i$1<144;++i$1)flt[i$1]=8;for(i$1=144;i$1<256;++i$1)flt[i$1]=9;for(i$1=256;i$1<280;++i$1)flt[i$1]=7;for(i$1=280;i$1<288;++i$1)flt[i$1]=8;var fdt=new u8(32);for(i$1=0;i$1<32;++i$1)fdt[i$1]=5;var flm=hMap(flt,9,0),fdm=hMap(fdt,5,0),shft=function(e){return(e+7)/8|0},slc=function(e,t,i){(null==t||t<0)&&(t=0),(null==i||i>e.length)&&(i=e.length);var r=new(2==e.BYTES_PER_ELEMENT?u16:4==e.BYTES_PER_ELEMENT?u32:u8)(i-t);return r.set(e.subarray(t,i)),r},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],err=function(e,t,i){var r=new Error(t||ec[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,err),!i)throw r;return r},wbits=function(e,t,i){i<<=7&t;var r=t/8|0;e[r]|=i,e[r+1]|=i>>>8},wbits16=function(e,t,i){i<<=7&t;var r=t/8|0;e[r]|=i,e[r+1]|=i>>>8,e[r+2]|=i>>>16},hTree=function(e,t){for(var i=[],r=0;r<e.length;++r)e[r]&&i.push({s:r,f:e[r]});var s=i.length,n=i.slice();if(!s)return[et,0];if(1==s){var o=new u8(i[0].s+1);return o[i[0].s]=1,[o,1]}i.sort((function(e,t){return e.f-t.f})),i.push({s:-1,f:25001});var a=i[0],A=i[1],l=0,h=1,d=2;for(i[0]={s:-1,f:a.f+A.f,l:a,r:A};h!=s-1;)a=i[i[l].f<i[d].f?l++:d++],A=i[l!=h&&i[l].f<i[d].f?l++:d++],i[h++]={s:-1,f:a.f+A.f,l:a,r:A};var c=n[0].s;for(r=1;r<s;++r)n[r].s>c&&(c=n[r].s);var u=new u16(c+1),p=ln(i[h-1],u,0);if(p>t){r=0;var _=0,g=p-t,m=1<<g;for(n.sort((function(e,t){return u[t.s]-u[e.s]||e.f-t.f}));r<s;++r){var f=n[r].s;if(!(u[f]>t))break;_+=m-(1<<p-u[f]),u[f]=t}for(_>>>=g;_>0;){var w=n[r].s;u[w]<t?_-=1<<t-u[w]++-1:++r}for(;r>=0&&_;--r){var C=n[r].s;u[C]==t&&(--u[C],++_)}p=t}return[new u8(u),p]},ln=function(e,t,i){return-1==e.s?Math.max(ln(e.l,t,i+1),ln(e.r,t,i+1)):t[e.s]=i},lc=function(e){for(var t=e.length;t&&!e[--t];);for(var i=new u16(++t),r=0,s=e[0],n=1,o=function(e){i[r++]=e},a=1;a<=t;++a)if(e[a]==s&&a!=t)++n;else{if(!s&&n>2){for(;n>138;n-=138)o(32754);n>2&&(o(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(o(s),--n;n>6;n-=6)o(8304);n>2&&(o(n-3<<5|8208),n=0)}for(;n--;)o(s);n=1,s=e[a]}return[i.subarray(0,r),t]},clen=function(e,t){for(var i=0,r=0;r<t.length;++r)i+=e[r]*t[r];return i},wfblk=function(e,t,i){var r=i.length,s=shft(t+2);e[s]=255&r,e[s+1]=r>>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var n=0;n<r;++n)e[s+n+4]=i[n];return 8*(s+4+r)},wblk=function(e,t,i,r,s,n,o,a,A,l,h){wbits(t,h++,i),++s[256];for(var d=hTree(s,15),c=d[0],u=d[1],p=hTree(n,15),_=p[0],g=p[1],m=lc(c),f=m[0],w=m[1],C=lc(_),y=C[0],E=C[1],b=new u16(19),B=0;B<f.length;++B)b[31&f[B]]++;for(B=0;B<y.length;++B)b[31&y[B]]++;for(var P=hTree(b,7),S=P[0],v=P[1],R=19;R>4&&!S[clim[R-1]];--R);var I,T,x,O,D=l+5<<3,L=clen(s,flt)+clen(n,fdt)+o,F=clen(s,c)+clen(n,_)+o+14+3*R+clen(b,S)+(2*b[16]+3*b[17]+7*b[18]);if(D<=L&&D<=F)return wfblk(t,h,e.subarray(A,A+l));if(wbits(t,h,1+(F<L)),h+=2,F<L){I=hMap(c,u,0),T=c,x=hMap(_,g,0),O=_;var H=hMap(S,v,0);wbits(t,h,w-257),wbits(t,h+5,E-1),wbits(t,h+10,R-4),h+=14;for(B=0;B<R;++B)wbits(t,h+3*B,S[clim[B]]);h+=3*R;for(var N=[f,y],U=0;U<2;++U){var M=N[U];for(B=0;B<M.length;++B){var k=31&M[B];wbits(t,h,H[k]),h+=S[k],k>15&&(wbits(t,h,M[B]>>>5&127),h+=M[B]>>>12)}}}else I=flm,T=flt,x=fdm,O=fdt;for(B=0;B<a;++B)if(r[B]>255){k=r[B]>>>18&31;wbits16(t,h,I[k+257]),h+=T[k+257],k>7&&(wbits(t,h,r[B]>>>23&31),h+=fleb[k]);var Q=31&r[B];wbits16(t,h,x[Q]),h+=O[Q],Q>3&&(wbits16(t,h,r[B]>>>5&8191),h+=fdeb[Q])}else wbits16(t,h,I[r[B]]),h+=T[r[B]];return wbits16(t,h,I[256]),h+T[256]},deo=new u32([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),et=new u8(0),dflt=function(e,t,i,r,s,n){var o=e.length,a=new u8(r+o+5*(1+Math.ceil(o/7e3))+s),A=a.subarray(r,a.length-s),l=0;if(!t||o<8)for(var h=0;h<=o;h+=65535){var d=h+65535;d>=o&&(A[l>>3]=n),l=wfblk(A,l+1,e.subarray(h,d))}else{for(var c=deo[t-1],u=c>>>13,p=8191&c,_=(1<<i)-1,g=new u16(32768),m=new u16(_+1),f=Math.ceil(i/3),w=2*f,C=function(t){return(e[t]^e[t+1]<<f^e[t+2]<<w)&_},y=new u32(25e3),E=new u16(288),b=new u16(32),B=0,P=0,S=(h=0,0),v=0,R=0;h<o;++h){var I=C(h),T=32767&h,x=m[I];if(g[T]=x,m[I]=T,v<=h){var O=o-h;if((B>7e3||S>24576)&&O>423){l=wblk(e,A,0,y,E,b,P,S,R,h-R,l),S=B=P=0,R=h;for(var D=0;D<286;++D)E[D]=0;for(D=0;D<30;++D)b[D]=0}var L=2,F=0,H=p,N=T-x&32767;if(O>2&&I==C(h-N))for(var U=Math.min(u,O)-1,M=Math.min(32767,h),k=Math.min(258,O);N<=M&&--H&&T!=x;){if(e[h+L]==e[h+L-N]){for(var Q=0;Q<k&&e[h+Q]==e[h+Q-N];++Q);if(Q>L){if(L=Q,F=N,Q>U)break;var V=Math.min(N,Q-2),G=0;for(D=0;D<V;++D){var $=h-N+D+32768&32767,W=$-g[$]+32768&32767;W>G&&(G=W,x=$)}}}N+=(T=x)-(x=g[T])+32768&32767}if(F){y[S++]=268435456|revfl[L]<<18|revfd[F];var K=31&revfl[L],z=31&revfd[F];P+=fleb[K]+fdeb[z],++E[257+K],++b[z],v=h+L,++B}else y[S++]=e[h],++E[e[h]]}}l=wblk(e,A,n,y,E,b,P,S,R,h-R,l),!n&&7&l&&(l=wfblk(A,l+1,et))}return slc(a,0,r+shft(l)+s)},crct=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var i=t,r=9;--r;)i=(1&i&&-306674912)^i>>>1;e[t]=i}return e}(),crc=function(){var e=-1;return{p:function(t){for(var i=e,r=0;r<t.length;++r)i=crct[255&i^t[r]]^i>>>8;e=i},d:function(){return~e}}},dopt=function(e,t,i,r,s){return dflt(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,i,r,!s)},mrg=function(e,t){var i={};for(var r in e)i[r]=e[r];for(var r in t)i[r]=t[r];return i},wbytes=function(e,t,i){for(;i;++t)e[t]=i,i>>>=8};function deflateSync(e,t){return dopt(e,t||{},0,0)}var fltn=function(e,t,i,r){for(var s in e){var n=e[s],o=t+s,a=r;Array.isArray(n)&&(a=mrg(r,n[1]),n=n[0]),n instanceof u8?i[o]=[n,a]:(i[o+="/"]=[new u8(0),a],fltn(n,o,i,r))}},te="undefined"!=typeof TextEncoder&&new TextEncoder,td="undefined"!=typeof TextDecoder&&new TextDecoder;try{td.decode(et,{stream:!0})}catch(e){}function strToU8(e,t){if(t){for(var i=new u8(e.length),r=0;r<e.length;++r)i[r]=e.charCodeAt(r);return i}if(te)return te.encode(e);var s=e.length,n=new u8(e.length+(e.length>>1)),o=0,a=function(e){n[o++]=e};for(r=0;r<s;++r){if(o+5>n.length){var A=new u8(o+8+(s-r<<1));A.set(n),n=A}var l=e.charCodeAt(r);l<128||t?a(l):l<2048?(a(192|l>>6),a(128|63&l)):l>55295&&l<57344?(a(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++r))>>18),a(128|l>>12&63),a(128|l>>6&63),a(128|63&l)):(a(224|l>>12),a(128|l>>6&63),a(128|63&l))}return slc(n,0,o)}var exfl=function(e){var t=0;if(e)for(var i in e){var r=e[i].length;r>65535&&err(9),t+=r+4}return t},wzh=function(e,t,i,r,s,n,o,a){var A=r.length,l=i.extra,h=a&&a.length,d=exfl(l);wbytes(e,t,null!=o?33639248:67324752),t+=4,null!=o&&(e[t++]=20,e[t++]=i.os),e[t]=20,t+=2,e[t++]=i.flag<<1|(null==n&&8),e[t++]=s&&8,e[t++]=255&i.compression,e[t++]=i.compression>>8;var c=new Date(null==i.mtime?Date.now():i.mtime),u=c.getFullYear()-1980;if((u<0||u>119)&&err(10),wbytes(e,t,u<<25|c.getMonth()+1<<21|c.getDate()<<16|c.getHours()<<11|c.getMinutes()<<5|c.getSeconds()>>>1),t+=4,null!=n&&(wbytes(e,t,i.crc),wbytes(e,t+4,n),wbytes(e,t+8,i.size)),wbytes(e,t+12,A),wbytes(e,t+14,d),t+=16,null!=o&&(wbytes(e,t,h),wbytes(e,t+6,i.attrs),wbytes(e,t+10,o),t+=14),e.set(r,t),t+=A,d)for(var p in l){var _=l[p],g=_.length;wbytes(e,t,+p),wbytes(e,t+2,g),e.set(_,t+4),t+=4+g}return h&&(e.set(a,t),t+=h),t},wzf=function(e,t,i,r,s){wbytes(e,t,101010256),wbytes(e,t+8,i),wbytes(e,t+10,i),wbytes(e,t+12,r),wbytes(e,t+16,s)};function zipSync(e,t){t||(t={});var i={},r=[];fltn(e,"",i,t);var s=0,n=0;for(var o in i){var a=i[o],A=a[0],l=a[1],h=0==l.level?0:8,d=(b=strToU8(o)).length,c=l.comment,u=c&&strToU8(c),p=u&&u.length,_=exfl(l.extra);d>65535&&err(11);var g=h?deflateSync(A,l):A,m=g.length,f=crc();f.p(A),r.push(mrg(l,{size:A.length,crc:f.d(),c:g,f:b,m:u,u:d!=o.length||u&&c.length!=p,o:s,compression:h})),s+=30+d+_+m,n+=76+2*(d+_)+(p||0)+m}for(var w=new u8(n+22),C=s,y=n-s,E=0;E<r.length;++E){var b=r[E];wzh(w,b.o,b,b.f,b.u,b.c.length);var B=30+b.f.length+exfl(b.extra);w.set(b.c,b.o+B),wzh(w,s,b,b.f,b.u,b.c.length,b.o,b.m),s+=16+B+(b.m?b.m.length:0)}return wzf(w,s,r.length,y,C),w}var download=createCommonjsModule((function(e,t){e.exports=function e(t,i,r){var s,n,o=window,a="application/octet-stream",A=r||a,l=t,h=!i&&!r&&l,d=document.createElement("a"),c=function(e){return String(e)},u=o.Blob||o.MozBlob||o.WebKitBlob||c,p=i||"download";if(u=u.call?u.bind(o):Blob,"true"===String(this)&&(A=(l=[l,A])[0],l=l[1]),h&&h.length<2048&&(p=h.split("/").pop().split("?")[0],d.href=h,-1!==d.href.indexOf(h))){var _=new XMLHttpRequest;return _.open("GET",h,!0),_.responseType="blob",_.onload=function(t){e(t.target.response,p,a)},setTimeout((function(){_.send()}),0),_}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l)){if(!(l.length>2096103.424&&u!==c))return navigator.msSaveBlob?navigator.msSaveBlob(w(l),p):C(l);A=(l=w(l)).type||a}else if(/([\x80-\xff])/.test(l)){for(var g=0,m=new Uint8Array(l.length),f=m.length;g<f;++g)m[g]=l.charCodeAt(g);l=new u([m],{type:A})}function w(e){for(var t=e.split(/[:;,]/),i=t[1],r=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),s=r.length,n=0,o=new Uint8Array(s);n<s;++n)o[n]=r.charCodeAt(n);return new u([o],{type:i})}function C(e,t){if("download"in d)return d.href=e,d.setAttribute("download",p),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===t&&setTimeout((function(){o.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var i=document.createElement("iframe");document.body.appendChild(i),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,a)),i.src=e,setTimeout((function(){document.body.removeChild(i)}),333)}if(s=l instanceof u?l:new u([l],{type:A}),navigator.msSaveBlob)return navigator.msSaveBlob(s,p);if(o.URL)C(o.URL.createObjectURL(s),!0);else{if("string"==typeof s||s.constructor===c)try{return C("data:"+A+";base64,"+o.btoa(s))}catch(e){return C("data:"+A+","+encodeURIComponent(s))}(n=new FileReader).onload=function(e){C(this.result)},n.readAsDataURL(s)}return!0}})),es6Promise=createCommonjsModule((function(e,t){e.exports=function(){function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function t(e){return"function"==typeof e}var i=void 0;i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var r=i,s=0,n=void 0,o=void 0,a=function(e,t){C[s]=e,C[s+1]=t,2===(s+=2)&&(o?o(y):b())};function A(e){o=e}function l(e){a=e}var h="undefined"!=typeof window?window:void 0,d=h||{},c=d.MutationObserver||d.WebKitMutationObserver,u="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function _(){return function(){return process.nextTick(y)}}function g(){return void 0!==n?function(){n(y)}:w()}function m(){var e=0,t=new c(y),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}function f(){var e=new MessageChannel;return e.port1.onmessage=y,function(){return e.port2.postMessage(0)}}function w(){var e=setTimeout;return function(){return e(y,1)}}var C=new Array(1e3);function y(){for(var e=0;e<s;e+=2)(0,C[e])(C[e+1]),C[e]=void 0,C[e+1]=void 0;s=0}function E(){try{var e=Function("return this")().require("vertx");return n=e.runOnLoop||e.runOnContext,g()}catch(e){return w()}}var b=void 0;function B(e,t){var i=this,r=new this.constructor(v);void 0===r[S]&&z(r);var s=i._state;if(s){var n=arguments[s-1];a((function(){return G(s,r,n,i._result)}))}else Q(i,r,e,t);return r}function P(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var i=new t(v);return N(i,e),i}b=u?_():c?m():p?f():void 0===h&&"function"==typeof commonjsRequire?E():w();var S=Math.random().toString(36).substring(2);function v(){}var R=void 0,I=1,T=2;function x(){return new TypeError("You cannot resolve a promise with itself")}function O(){return new TypeError("A promises callback cannot return that same promise.")}function D(e,t,i,r){try{e.call(t,i,r)}catch(e){return e}}function L(e,t,i){a((function(e){var r=!1,s=D(i,t,(function(i){r||(r=!0,t!==i?N(e,i):M(e,i))}),(function(t){r||(r=!0,k(e,t))}));!r&&s&&(r=!0,k(e,s))}),e)}function F(e,t){t._state===I?M(e,t._result):t._state===T?k(e,t._result):Q(t,void 0,(function(t){return N(e,t)}),(function(t){return k(e,t)}))}function H(e,i,r){i.constructor===e.constructor&&r===B&&i.constructor.resolve===P?F(e,i):void 0===r?M(e,i):t(r)?L(e,i,r):M(e,i)}function N(t,i){if(t===i)k(t,x());else if(e(i)){var r=void 0;try{r=i.then}catch(e){return void k(t,e)}H(t,i,r)}else M(t,i)}function U(e){e._onerror&&e._onerror(e._result),V(e)}function M(e,t){e._state===R&&(e._result=t,e._state=I,0!==e._subscribers.length&&a(V,e))}function k(e,t){e._state===R&&(e._state=T,e._result=t,a(U,e))}function Q(e,t,i,r){var s=e._subscribers,n=s.length;e._onerror=null,s[n]=t,s[n+I]=i,s[n+T]=r,0===n&&e._state&&a(V,e)}function V(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var r=void 0,s=void 0,n=e._result,o=0;o<t.length;o+=3)r=t[o],s=t[o+i],r?G(i,r,s,n):s(n);e._subscribers.length=0}}function G(e,i,r,s){var n=t(r),o=void 0,a=void 0,A=!0;if(n){try{o=r(s)}catch(e){A=!1,a=e}if(i===o)return void k(i,O())}else o=s;i._state!==R||(n&&A?N(i,o):!1===A?k(i,a):e===I?M(i,o):e===T&&k(i,o))}function $(e,t){try{t((function(t){N(e,t)}),(function(t){k(e,t)}))}catch(t){k(e,t)}}var W=0;function K(){return W++}function z(e){e[S]=W++,e._state=void 0,e._result=void 0,e._subscribers=[]}function j(){return new Error("Array Methods must be provided an Array")}var X=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(v),this.promise[S]||z(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&M(this.promise,this._result))):k(this.promise,j())}return e.prototype._enumerate=function(e){for(var t=0;this._state===R&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var i=this._instanceConstructor,r=i.resolve;if(r===P){var s=void 0,n=void 0,o=!1;try{s=e.then}catch(e){o=!0,n=e}if(s===B&&e._state!==R)this._settledAt(e._state,t,e._result);else if("function"!=typeof s)this._remaining--,this._result[t]=e;else if(i===te){var a=new i(v);o?k(a,n):H(a,e,s),this._willSettleAt(a,t)}else this._willSettleAt(new i((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,i){var r=this.promise;r._state===R&&(this._remaining--,e===T?k(r,i):this._result[t]=i),0===this._remaining&&M(r,this._result)},e.prototype._willSettleAt=function(e,t){var i=this;Q(e,void 0,(function(e){return i._settledAt(I,t,e)}),(function(e){return i._settledAt(T,t,e)}))},e}();function Y(e){return new X(this,e).promise}function J(e){var t=this;return r(e)?new t((function(i,r){for(var s=e.length,n=0;n<s;n++)t.resolve(e[n]).then(i,r)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))}function q(e){var t=new this(v);return k(t,e),t}function Z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ee(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var te=function(){function e(t){this[S]=K(),this._result=this._state=void 0,this._subscribers=[],v!==t&&("function"!=typeof t&&Z(),this instanceof e?$(this,t):ee())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var i=this,r=i.constructor;return t(e)?i.then((function(t){return r.resolve(e()).then((function(){return t}))}),(function(t){return r.resolve(e()).then((function(){throw t}))})):i.then(e,e)},e}();function ie(){var e=void 0;if(void 0!==commonjsGlobal)e=commonjsGlobal;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var i=null;try{i=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===i&&!t.cast)return}e.Promise=te}return te.prototype.then=B,te.all=Y,te.race=J,te.resolve=P,te.reject=q,te._setScheduler=A,te._setAsap=l,te._asap=a,te.polyfill=ie,te.Promise=te,te}()}));const G3CODE_EOL=-1,G3CODE_INVALID=-2,EOL_CODES=[12,1,-1,9,1,-2,10,1,-2,11,1,-2,12,0,-2],WHITE_TERMS=[8,53,0,6,7,1,4,7,2,4,8,3,4,11,4,4,12,5,4,14,6,4,15,7,5,19,8,5,20,9,5,7,10,5,8,11,6,8,12,6,3,13,6,52,14,6,53,15,6,42,16,6,43,17,7,39,18,7,12,19,7,8,20,7,23,21,7,3,22,7,4,23,7,40,24,7,43,25,7,19,26,7,36,27,7,24,28,8,2,29,8,3,30,8,26,31,8,27,32,8,18,33,8,19,34,8,20,35,8,21,36,8,22,37,8,23,38,8,40,39,8,41,40,8,42,41,8,43,42,8,44,43,8,45,44,8,4,45,8,5,46,8,10,47,8,11,48,8,82,49,8,83,50,8,84,51,8,85,52,8,36,53,8,37,54,8,88,55,8,89,56,8,90,57,8,91,58,8,74,59,8,75,60,8,50,61,8,51,62,8,52,63],WHITE_MARKS=[5,27,64,5,18,128,6,23,192,7,55,256,8,54,320,8,55,384,8,100,448,8,101,512,8,104,576,8,103,640,9,204,704,9,205,768,9,210,832,9,211,896,9,212,960,9,213,1024,9,214,1088,9,215,1152,9,216,1216,9,217,1280,9,218,1344,9,219,1408,9,152,1472,9,153,1536,9,154,1600,6,24,1664,9,155,1728,11,8,1792,11,12,1856,11,13,1920,12,18,1984,12,19,2048,12,20,2112,12,21,2176,12,22,2240,12,23,2304,12,28,2368,12,29,2432,12,30,2496,12,31,2560],BLACK_TERMS=[10,55,0,3,2,1,2,3,2,2,2,3,3,3,4,4,3,5,4,2,6,5,3,7,6,5,8,6,4,9,7,4,10,7,5,11,7,7,12,8,4,13,8,7,14,9,24,15,10,23,16,10,24,17,10,8,18,11,103,19,11,104,20,11,108,21,11,55,22,11,40,23,11,23,24,11,24,25,12,202,26,12,203,27,12,204,28,12,205,29,12,104,30,12,105,31,12,106,32,12,107,33,12,210,34,12,211,35,12,212,36,12,213,37,12,214,38,12,215,39,12,108,40,12,109,41,12,218,42,12,219,43,12,84,44,12,85,45,12,86,46,12,87,47,12,100,48,12,101,49,12,82,50,12,83,51,12,36,52,12,55,53,12,56,54,12,39,55,12,40,56,12,88,57,12,89,58,12,43,59,12,44,60,12,90,61,12,102,62,12,103,63],BLACK_MARKS=[10,15,64,12,200,128,12,201,192,12,91,256,12,51,320,12,52,384,12,53,448,13,108,512,13,109,576,13,74,640,13,75,704,13,76,768,13,77,832,13,114,896,13,115,960,13,116,1024,13,117,1088,13,118,1152,13,119,1216,13,82,1280,13,83,1344,13,84,1408,13,85,1472,13,90,1536,13,91,1600,13,100,1664,13,101,1728,11,8,1792,11,12,1856,11,13,1920,12,18,1984,12,19,2048,12,20,2112,12,21,2176,12,22,2240,12,23,2304,12,28,2368,12,29,2432,12,30,2496,12,31,2560],createColorCode=function(e,t,i){return{codeLen:e,code:t,runLength:i}},buildColorCodes=function(e){const t=[];for(let i=0,r=e.length;i<r;i+=3)t.push({codeLen:e[i],code:e[i+1],runLength:e[i+2]});return t},TERMS=[buildColorCodes(WHITE_TERMS),buildColorCodes(BLACK_TERMS)],MARKS=[buildColorCodes(WHITE_MARKS),buildColorCodes(BLACK_MARKS)],EOLS=buildColorCodes(EOL_CODES),PASS_CODE=createColorCode(4,1,0),HORI_CODE=createColorCode(3,1,0),VERT_CODES=buildColorCodes([7,3,0,6,3,0,3,3,0,1,1,0,3,2,0,6,2,0,7,2,0]);var CCITTScheme;!function(e){e.GROUP_3="g3",e.GROUP_3_2D="g3-2d",e.GROUP_4="g4"}(CCITTScheme||(CCITTScheme={}));const WHITE=0,BLACK=1,MASK_1=[128,64,32,16,8,4,2,1],MASK_4=[240,15];class CCITTLine{constructor(e,t){if(1!==e&&4!==e&&8!==e)throw new Error("Invalid bps: "+e);this._bps=e,this._pixels=t,this._bytes=this.bytesOfPixels(t),this._dv=new DataView(new ArrayBuffer(this._bytes))}get byteLength(){return this._bytes}bytesOfPixels(e){return(e*this._bps+7)/8|0}prepare(e,t){for(let i=0;i<this._bytes;i++)this._dv.setUint8(i,e[t+i]);return this}clear(){for(let e=0;e<this._bytes;e++)this._dv.setUint8(e,0);return this}getRow(e){return new Uint8Array(this._dv.buffer.slice(0,this.bytesOfPixels(e)))}getByte(e){return this._dv.getUint8(e)}getBytes(e){return new Uint8Array(this._dv.buffer.slice(0,e))}getPixel(e){const t=e*this._bps,i=t/8|0,r=t%8,s=this._dv.getUint8(i);return 1===this._bps?s&MASK_1[r]:4===this._bps?s&MASK_4[r]:s}getBit(e){const t=e/8|0,i=e%8;return this._dv.getUint8(t)&MASK_1[i]?1:0}setBits(e,t,i){const r=i-1;let s=e/8|0,n=e%8,o=0;for(;o<i;)try{let e=this._dv.getUint8(s);for(;n<8&&o<i;){e&=255&~(1<<7-n),e|=(t&1<<r-o?1:0)<<7-n,o++,n++}this._dv.setUint8(s,e),s++,n=0}catch(e){}}setString(e,t){const i=t.length;let r=0;for(let e=0;e<i;e++){r+=("0"===t.charAt(e)?0:1)<<i-1-e}this.setBits(e,r,i)}getBits(e,t){const i=t-1;let r=e/8|0,s=e%8,n=0,o=0;for(;o<t;){const e=this._dv.getUint8(r);for(;s<8&&o<t;){n|=(e&MASK_1[s]?1:0)<<i-o,o++,s++}r++,s=0}return n}getSpan(e){const t=this._dv.byteLength;let i=e/8|0,r=e%8,s=this._dv.getUint8(i);const n=s&MASK_1[r++]?1:0;let o=1;for(;i<t;){for(;r<8;){if((s&MASK_1[r++]?1:0)!==n)return o;o++}i++,r=0,i<t&&(s=this._dv.getUint8(i))}return o}toString(){let e="";for(let t=0,i=this._dv.byteLength;t<i;t++){const i=this._dv.getUint8(t);for(let t=0;t<8;t++){e+=i&1<<7-t?1:0}}return e}}class CCITTEncoder{constructor(){}static encodePixcels(e,t){return t.scheme===CCITTScheme.GROUP_4?(new CCITTGroup4Encoder).encode(e,t):(new CCITTGroup3Encoder).encode(e,t)}encode(e,t){return this._wPixels=t.columns,this._doEncode(e,t)}_encodeLine1D(e,t,i,r){let s=0,n=0,o=0,a=0;const A=EOLS[0];if(t.setBits(n,A.code,A.codeLen),n+=A.codeLen,r&&(t.setBits(n,1,1),n+=1),1===e.getBit(0)){const e=TERMS[0][0];t.setBits(n,e.code,e.codeLen),n+=e.codeLen,o=1}for(;s<i;){const i=e.getSpan(s);if(i<64){const e=TERMS[o][i];t.setBits(n,e.code,e.codeLen),n+=e.codeLen,a+=e.runLength}else if(i<2624){const e=MARKS[o][(i-64)/64|0];t.setBits(n,e.code,e.codeLen),n+=e.codeLen,a+=e.runLength;const r=TERMS[o][i%64];t.setBits(n,r.code,r.codeLen),n+=r.codeLen,a+=r.runLength}s+=i,o=1-o}return a!==i&&console.log(a),n}$_findDiff(e,t,i){let r=t;for(;r<this._wPixels;r++)if(e.getBit(r)!==i)return r;return r}$_setSpan(e,t,i,r){let s=0;if(i<64){const n=TERMS[r][i];e.setBits(t,n.code,n.codeLen),s+=n.codeLen}else if(i<2624){const n=MARKS[r][(i-64)/64|0];e.setBits(t,n.code,n.codeLen),t+=n.codeLen,s+=n.codeLen;const o=TERMS[r][i%64];e.setBits(t,o.code,o.codeLen),s+=o.codeLen}return s}_encodeLine2D(e,t,i,r){let s=0,n=0!==t.getBit(0)?0:this.$_findDiff(t,0,0),o=0!==e.getBit(0)?0:this.$_findDiff(e,0,0),a=0;for(;;){const A=o<r?this.$_findDiff(e,o,e.getBit(o)):r;if(A>=n){const e=o-n;if(e>=-3&&e<=3){const t=VERT_CODES[e+3];i.setBits(a,t.code,t.codeLen),a+=t.codeLen,s=n}else{const e=n<r?this.$_findDiff(t,n,t.getBit(n)):r;i.setBits(a,HORI_CODE.code,HORI_CODE.codeLen),a+=HORI_CODE.codeLen,s+n===0||0===t.getBit(s)?(a+=this.$_setSpan(i,a,n-s,0),a+=this.$_setSpan(i,a,e-n,1)):(a+=this.$_setSpan(i,a,n-s,1),a+=this.$_setSpan(i,a,e-n,0)),s=e}}else i.setBits(a,PASS_CODE.code,PASS_CODE.codeLen),a+=PASS_CODE.codeLen,s=A;if(s>=r)break;const l=t.getBit(s);n=this.$_findDiff(t,s,l),o=this.$_findDiff(e,s,1-l),o=this.$_findDiff(e,o,l)}return a}}class CCITTGroup3Encoder extends CCITTEncoder{_doEncode(e,t){const i=t.columns,r=t.height;return t.scheme===CCITTScheme.GROUP_3?this.$_encode1D(e,i,r):this.$_encode2D(e,i,r)}$_encode1D(e,t,i){const r=[],s=[],n=new CCITTLine(1,t),o=n.byteLength,a=new CCITTLine(1,4*t);for(let A=0;A<i;A++){const i=this._encodeLine1D(n.prepare(e,o*A),a.clear(),t,!1),l=a.bytesOfPixels(i);r.push(l),s.push(a.getBytes(l))}const A=s.map((e=>e.length)).reduce(((e,t)=>e+t),0),l=new Uint8Array(new ArrayBuffer(A));for(let e=0,t=0;e<i;e++)l.set(s[e],t),t+=r[e];return{counts:r,rows:l}}$_encode2D(e,t,i){const r=[],s=[],n=new CCITTLine(1,t),o=n.byteLength,a=new CCITTLine(1,4*t);for(let A=0;A<i;A++){const i=this._encodeLine1D(n.prepare(e,o*A),a.clear(),t,!0),l=a.bytesOfPixels(i);r.push(l),s.push(a.getBytes(l))}const A=s.map((e=>e.length)).reduce(((e,t)=>e+t),0),l=new Uint8Array(new ArrayBuffer(A));for(let e=0,t=0;e<i;e++)l.set(s[e],t),t+=r[e];return{counts:r,rows:l}}}class CCITTGroup4Encoder extends CCITTEncoder{_doEncode(e,t){const i=t.columns,r=t.height,s=[],n=[];let o=new CCITTLine(1,i).clear();const a=new CCITTLine(1,i),A=a.byteLength,l=new CCITTLine(1,4*i);for(let t=0;t<r;t++){const r=this._encodeLine2D(o,a.prepare(e,A*t),l.clear(),i),h=l.bytesOfPixels(r);s.push(h),n.push(l.getBytes(h))}const h=n.map((e=>e.length)).reduce(((e,t)=>e+t),0),d=new Uint8Array(new ArrayBuffer(h));for(let e=0,t=0;e<r;e++)d.set(n[e],t),t+=s[e];return{counts:s,rows:d}}}const T_SHORT=3,T_LONG=4,T_RATIONAL=5,COMPRESSION_T4=3,COMPRESSION_T6=4,WHITE_IS_ZERO=0,RES_INCH=2,IMG_START=500;class TFile{constructor(){this._curr=0}encode(e,t){const i=8+500*e.length+e.map((e=>Utils.toEven(8*e.encoded.counts.length+e.encoded.rows.length))).reduce(((e,t)=>e+t),0),r=new ArrayBuffer(i),s=this._dv=new DataView(r);return this.$_writeHeader(s),e.forEach(((e,i,r)=>this.$_writeIFD(e,t,i,r.length))),r}seek(e){this._curr=e}skip(e){this._curr+=e}set16(e){this._dv.setInt16(this._curr,e),this._curr+=2}setU16(e){this._dv.setUint16(this._curr,e),this._curr+=2}set32(e){this._dv.setInt32(this._curr,e),this._curr+=4}setU32(e){this._dv.setUint32(this._curr,e),this._curr+=4}setStr(e){for(let t=0,i=e.length;t<i;t++)this._dv.setUint8(this._curr++,255&e.charCodeAt(t));1&this._curr&&this._curr++}strLen(e){return Utils.toEven(e.length)}dateStr(e){function t(e){return e<10?"0"+e:String(e)}return e.getFullYear()+":"+t(e.getMonth()+1)+":"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())}$_writeHeader(e){this.set16(19789),this.set16(42),this.set32(8)}$_writeIFD(e,t,i,r){const s=i===r-1,n=e.width,o=e.height,a=t.encoding===CCITTScheme.GROUP_3_2D||t.encoding===CCITTScheme.GROUP_3?3:4,A=this._curr,l=e.encoded.counts,h=l.length,d=e.encoded.rows,c=s?0:Utils.toEven(A+500+8*l.length+d.length);this._entryCount=0,this._pointer=0,this._pointers=[],this.skip(2),this.$_addVal(256,3,1,n),this.$_addVal(257,3,1,o),this.$_addVal(259,3,1,a),this.$_addVal(262,3,1,0),this.$_addVal(266,3,1,1),this.$_addVal(273,4,h,A+500+4*h),this.$_addVal(277,3,1,1),this.$_addVal(278,3,1,1),this.$_addVal(279,4,h,A+500),this.$_addOff(282,5,1,8),this.$_addOff(283,5,1,8),this.$_addVal(292,4,1,1),this.$_addVal(296,3,1,2),this.set32(c),this.set32(t.dpi||204),this.set32(1),this.set32(t.dpi||196),this.set32(1);let u=A+2+12*this._entryCount+4;this._pointers.forEach((e=>{const t=this._dv.getUint32(e);this._dv.setUint32(e,u+t)}));const p=this._curr;this.seek(A),this.setU16(this._entryCount),this.seek(p),this.seek(A+500);for(let e=0;e<h;e++)this.setU32(l[e]);for(let e=0,t=this._curr+4*h;e<h;e++)this.setU32(t),t+=l[e];this._curr;new Uint8Array(this._dv.buffer).set(e.encoded.rows,this._curr),s||this.seek(c)}$_addVal(e,t,i,r){this.set16(e),this.set16(t),this.set32(i),3===t&&1===i?(this.set16(r),this.set16(0)):this.set32(r),this._entryCount++}$_addOff(e,t,i,r){this.set16(e),this.set16(t),this.set32(i),this._pointers.push(this._curr),this.set32(this._pointer),this._pointer+=r,this._entryCount++}}class TiffEncoder{constructor(){}encode(e,t){t.encoding=t.encoding||CCITTScheme.GROUP_4;const i=this.$_getImages(e,t.encoding),r=(new TFile).encode(i,t);return[new Uint8Array(r)]}$_getImages(e,t){const i=[];return e.forEach(((e,r)=>{const s=e.width,n=e.height,o=e.getContext("2d").getImageData(0,0,s,n).data,a=o.length,A=Math.floor((s+7)/8)*n,l=new Uint8Array(A),h=new DataView(l.buffer);let d=0,c=0;for(;d<a;){let e=0;for(;c<A&&d<a&&e<s;){let t=0;for(let i=0;i<8&&d<a&&e<s;i++,e++)if(o[d+3]>0){const e=o[d++],r=o[d++],s=o[d++];d++,t+=(255===e&&255===r&&255===s?0:1)<<7-i}else d+=4;h.setUint8(c++,t)}}l.length;const u=CCITTEncoder.encodePixcels(l,{scheme:t,width:32*e.width,height:e.height,columns:e.width});i.push({index:r,width:e.width,height:e.height,imageData:l,length:Utils.toEven(A),encoded:u})})),i}}function toInt(e){return~~e}var ncycles$1=100,netsize$1=256,maxnetpos$1=netsize$1-1,netbiasshift$1=4,intbiasshift$1=16,intbias$1=1<<intbiasshift$1,gammashift$1=10,betashift$1=10,beta$1=intbias$1>>betashift$1,betagamma$1=intbias$1<<gammashift$1-betashift$1,initrad$1=netsize$1>>3,radiusbiasshift$1=6,radiusbias$1=1<<radiusbiasshift$1,initradius$1=initrad$1*radiusbias$1,radiusdec$1=30,alphabiasshift$1=10,initalpha$1=1<<alphabiasshift$1,radbiasshift$1=8,radbias$1=1<<radbiasshift$1,alpharadbshift$1=alphabiasshift$1+radbiasshift$1,alpharadbias$1=1<<alpharadbshift$1,prime1$1=499,prime2$1=491,prime3$1=487,prime4$1=503,minpicturebytes$1=3*prime4$1;function NeuQuant$1(e,t){var i,r,s,n,o;function a(e,t,r,s,n){i[t][0]-=e*(i[t][0]-r)/initalpha$1,i[t][1]-=e*(i[t][1]-s)/initalpha$1,i[t][2]-=e*(i[t][2]-n)/initalpha$1}function A(e,t,r,s,n){for(var a,A,l=Math.abs(t-e),h=Math.min(t+e,netsize$1),d=t+1,c=t-1,u=1;d<h||c>l;)A=o[u++],d<h&&((a=i[d++])[0]-=A*(a[0]-r)/alpharadbias$1,a[1]-=A*(a[1]-s)/alpharadbias$1,a[2]-=A*(a[2]-n)/alpharadbias$1),c>l&&((a=i[c--])[0]-=A*(a[0]-r)/alpharadbias$1,a[1]-=A*(a[1]-s)/alpharadbias$1,a[2]-=A*(a[2]-n)/alpharadbias$1)}function l(e,t,r){const o=netsize$1/8;var a,A,l,h,d,c=~(1<<31),u=c,p=-1,_=p;for(a=0;a<o;a++)A=i[a],(l=Math.abs(A[0]-e)+Math.abs(A[1]-t)+Math.abs(A[2]-r))<c&&(c=l,p=a),(h=l-(s[a]>>intbiasshift$1-netbiasshift$1))<u&&(u=h,_=a),d=n[a]>>betashift$1,n[a]-=d,s[a]+=d<<gammashift$1;return n[p]+=beta$1,s[p]-=betagamma$1,_}this.buildColormap=function(){!function(){var e,t;for(i=[],r=[],s=[],n=[],o=[],e=0;e<netsize$1;e++)t=(e<<netbiasshift$1+8)/netsize$1,i[e]=[t,t,t],n[e]=intbias$1/netsize$1,s[e]=0}(),function(){var i,r,s,n,h,d,c=e.length,u=toInt(30+(t-1)/3),p=toInt(c/(3*t)),_=toInt(p/ncycles$1),g=initalpha$1,m=initradius$1,f=m>>radiusbiasshift$1;for(f<=1&&(f=0),i=0;i<f;i++)o[i]=toInt(g*((f*f-i*i)*radbias$1/(f*f)));c<minpicturebytes$1?(t=1,r=3):r=c%prime1$1!=0?3*prime1$1:c%prime2$1!=0?3*prime2$1:c%prime3$1!=0?3*prime3$1:3*prime4$1;var w=0;for(i=0;i<p;)if(a(g,d=l(s=(255&e[w])<<netbiasshift$1,n=(255&e[w+1])<<netbiasshift$1,h=(255&e[w+2])<<netbiasshift$1),s,n,h),0!==f&&A(f,d,s,n,h),(w+=r)>=c&&(w-=c),0===_&&(_=1),++i%_==0)for(g-=g/u,(f=(m-=m/radiusdec$1)>>radiusbiasshift$1)<=1&&(f=0),d=0;d<f;d++)o[d]=~~(g*((f*f-d*d)*radbias$1/(f*f)))}(),function(){for(var e=0;e<netsize$1;e++)i[e][0]>>=netbiasshift$1,i[e][1]>>=netbiasshift$1,i[e][2]>>=netbiasshift$1,i[e][3]=e}(),function(){var e,t,s,n,o,a,A=0,l=0;for(e=0;e<netsize$1;e++){for(o=e,a=(s=i[e])[1],t=e+1;t<netsize$1;t++)(n=i[t])[1]<a&&(o=t,a=n[1]);if(n=i[o],e!=o&&(t=n[0],n[0]=s[0],s[0]=t,t=n[1],n[1]=s[1],s[1]=t,t=n[2],n[2]=s[2],s[2]=t,t=n[3],n[3]=s[3],s[3]=t),a!=A){for(r[A]=l+e>>1,t=A+1;t<a;t++)r[t]=e;A=a,l=e}}for(r[A]=l+maxnetpos$1>>1,t=A+1;t<256;t++)r[t]=maxnetpos$1}()},this.getColormap=function(){for(var e=[],t=[],r=0;r<netsize$1;r++)t[i[r][3]]=r;for(var s=0,n=0;n<netsize$1;n++){var o=t[n];e[s++]=i[o][0],e[s++]=i[o][1],e[s++]=i[o][2]}return e},this.lookupRGB=function(e,t,s){for(var n,o,a,A=1e3,l=-1,h=r[t],d=h-1;h<netsize$1||d>=0;)h<netsize$1&&((a=(o=i[h])[1]-t)>=A?h=netsize$1:(h++,a<0&&(a=-a),(n=o[0]-e)<0&&(n=-n),(a+=n)<A&&((n=o[2]-s)<0&&(n=-n),(a+=n)<A&&(A=a,l=o[3])))),d>=0&&((a=t-(o=i[d])[1])>=A?d=-1:(d--,a<0&&(a=-a),(n=o[0]-e)<0&&(n=-n),(a+=n)<A&&((n=o[2]-s)<0&&(n=-n),(a+=n)<A&&(A=a,l=o[3]))));return l}}var NeuQuant_1=NeuQuant$1,ncycles=100,netsize=256,maxnetpos=netsize-1,netbiasshift=4,intbiasshift=16,intbias=1<<intbiasshift,gammashift=10,betashift=10,beta=intbias>>betashift,betagamma=intbias<<gammashift-betashift,initrad=netsize>>3,radiusbiasshift=6,radiusbias=1<<radiusbiasshift,initradius=initrad*radiusbias,radiusdec=30,alphabiasshift=10,initalpha=1<<alphabiasshift,radbiasshift=8,radbias=1<<radbiasshift,alpharadbshift=alphabiasshift+radbiasshift,alpharadbias=1<<alpharadbshift,prime1=499,prime2=491,prime3=487,prime4=503,minpicturebytes=3*prime4;function NeuQuant(e,t){var i,r,s,n,o;function a(e,t,r,s,n){i[t][0]-=e*(i[t][0]-r)/initalpha,i[t][1]-=e*(i[t][1]-s)/initalpha,i[t][2]-=e*(i[t][2]-n)/initalpha}function A(e,t,r,s,n){for(var a,A,l=Math.abs(t-e),h=Math.min(t+e,netsize),d=t+1,c=t-1,u=1;d<h||c>l;)A=o[u++],d<h&&((a=i[d++])[0]-=A*(a[0]-r)/alpharadbias,a[1]-=A*(a[1]-s)/alpharadbias,a[2]-=A*(a[2]-n)/alpharadbias),c>l&&((a=i[c--])[0]-=A*(a[0]-r)/alpharadbias,a[1]-=A*(a[1]-s)/alpharadbias,a[2]-=A*(a[2]-n)/alpharadbias)}function l(e,t,r){var o,a,A,l,h,d=~(1<<31),c=d,u=-1,p=u;for(o=0;o<netsize;o++)a=i[o],(A=Math.abs(a[0]-e)+Math.abs(a[1]-t)+Math.abs(a[2]-r))<d&&(d=A,u=o),(l=A-(s[o]>>intbiasshift-netbiasshift))<c&&(c=l,p=o),h=n[o]>>betashift,n[o]-=h,s[o]+=h<<gammashift;return n[u]+=beta,s[u]-=betagamma,p}this.buildColormap=function(){!function(){var e,t;for(i=[],r=new Int32Array(256),s=new Int32Array(netsize),n=new Int32Array(netsize),o=new Int32Array(netsize>>3),e=0;e<netsize;e++)t=(e<<netbiasshift+8)/netsize,i[e]=new Float64Array([t,t,t,0]),n[e]=intbias/netsize,s[e]=0}(),function(){var i,r,s,n,h,d,c=e.length,u=30+(t-1)/3,p=c/(3*t),_=~~(p/ncycles),g=initalpha,m=initradius,f=m>>radiusbiasshift;for(f<=1&&(f=0),i=0;i<f;i++)o[i]=g*((f*f-i*i)*radbias/(f*f));c<minpicturebytes?(t=1,r=3):r=c%prime1!=0?3*prime1:c%prime2!=0?3*prime2:c%prime3!=0?3*prime3:3*prime4;var w=0;for(i=0;i<p;)if(a(g,d=l(s=(255&e[w])<<netbiasshift,n=(255&e[w+1])<<netbiasshift,h=(255&e[w+2])<<netbiasshift),s,n,h),0!==f&&A(f,d,s,n,h),(w+=r)>=c&&(w-=c),0===_&&(_=1),++i%_==0)for(g-=g/u,(f=(m-=m/radiusdec)>>radiusbiasshift)<=1&&(f=0),d=0;d<f;d++)o[d]=g*((f*f-d*d)*radbias/(f*f))}(),function(){for(var e=0;e<netsize;e++)i[e][0]>>=netbiasshift,i[e][1]>>=netbiasshift,i[e][2]>>=netbiasshift,i[e][3]=e}(),function(){var e,t,s,n,o,a,A=0,l=0;for(e=0;e<netsize;e++){for(o=e,a=(s=i[e])[1],t=e+1;t<netsize;t++)(n=i[t])[1]<a&&(o=t,a=n[1]);if(n=i[o],e!=o&&(t=n[0],n[0]=s[0],s[0]=t,t=n[1],n[1]=s[1],s[1]=t,t=n[2],n[2]=s[2],s[2]=t,t=n[3],n[3]=s[3],s[3]=t),a!=A){for(r[A]=l+e>>1,t=A+1;t<a;t++)r[t]=e;A=a,l=e}}for(r[A]=l+maxnetpos>>1,t=A+1;t<256;t++)r[t]=maxnetpos}()},this.getColormap=function(){for(var e=[],t=[],r=0;r<netsize;r++)t[i[r][3]]=r;for(var s=0,n=0;n<netsize;n++){var o=t[n];e[s++]=i[o][0],e[s++]=i[o][1],e[s++]=i[o][2]}return e},this.lookupRGB=function(e,t,s){for(var n,o,a,A=1e3,l=-1,h=r[t],d=h-1;h<netsize||d>=0;)h<netsize&&((a=(o=i[h])[1]-t)>=A?h=netsize:(h++,a<0&&(a=-a),(n=o[0]-e)<0&&(n=-n),(a+=n)<A&&((n=o[2]-s)<0&&(n=-n),(a+=n)<A&&(A=a,l=o[3])))),d>=0&&((a=t-(o=i[d])[1])>=A?d=-1:(d--,a<0&&(a=-a),(n=o[0]-e)<0&&(n=-n),(a+=n)<A&&((n=o[2]-s)<0&&(n=-n),(a+=n)<A&&(A=a,l=o[3]))));return l}}var TypedNeuQuant=NeuQuant,EOF=-1,BITS=12,HSIZE=5003,masks=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function LZWEncoder(e,t,i,r){var s,n,o,a,A,l,h,d,c,u=Math.max(2,r),p=new Uint8Array(256),_=new Int32Array(HSIZE),g=new Int32Array(HSIZE),m=0,f=0,w=!1;function C(e,t){p[n++]=e,n>=254&&b(t)}function y(e){E(HSIZE),f=d+2,w=!0,S(d,e)}function E(e){for(var t=0;t<e;++t)_[t]=-1}function b(e){n>0&&(e.writeByte(n),e.writeBytes(p,0,n),n=0)}function B(e){return(1<<e)-1}function P(){return 0===a?EOF:(--a,255&i[A++])}function S(e,t){for(s&=masks[m],m>0?s|=e<<m:s=e,m+=l;m>=8;)C(255&s,t),s>>=8,m-=8;if((f>o||w)&&(w?(o=B(l=h),w=!1):(++l,o=l==BITS?1<<BITS:B(l))),e==c){for(;m>0;)C(255&s,t),s>>=8,m-=8;b(t)}}this.encode=function(i){i.writeByte(u),a=e*t,A=0,function(e,t){var i,r,s,a,A,u,p;for(w=!1,o=B(l=h=e),c=1+(d=1<<e-1),f=d+2,n=0,a=P(),p=0,i=HSIZE;i<65536;i*=2)++p;p=8-p,E(u=HSIZE),S(d,t);e:for(;(r=P())!=EOF;)if(i=(r<<BITS)+a,_[s=r<<p^a]!==i){if(_[s]>=0){A=u-s,0===s&&(A=1);do{if((s-=A)<0&&(s+=u),_[s]===i){a=g[s];continue e}}while(_[s]>=0)}S(a,t),a=r,f<1<<BITS?(g[s]=f++,_[s]=i):y(t)}else a=g[s];S(a,t),S(c,t)}(u+1,i),i.writeByte(0)}}var LZWEncoder_1=LZWEncoder;function ByteArray(){this.page=-1,this.pages=[],this.newPage()}ByteArray.pageSize=4096,ByteArray.charMap={};for(var i=0;i<256;i++)ByteArray.charMap[i]=String.fromCharCode(i);function GIFEncoder(e,t){this.width=~~e,this.height=~~t,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new ByteArray}ByteArray.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(ByteArray.pageSize),this.cursor=0},ByteArray.prototype.getData=function(){for(var e="",t=0;t<this.pages.length;t++)for(var i=0;i<ByteArray.pageSize;i++)e+=ByteArray.charMap[this.pages[t][i]];return e},ByteArray.prototype.writeByte=function(e){this.cursor>=ByteArray.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=e},ByteArray.prototype.writeUTFBytes=function(e){for(var t=e.length,i=0;i<t;i++)this.writeByte(e.charCodeAt(i))},ByteArray.prototype.writeBytes=function(e,t,i){for(var r=i||e.length,s=t||0;s<r;s++)this.writeByte(e[s])},GIFEncoder.prototype.setDelay=function(e){this.delay=Math.round(e/10)},GIFEncoder.prototype.setFrameRate=function(e){this.delay=Math.round(100/e)},GIFEncoder.prototype.setDispose=function(e){e>=0&&(this.dispose=e)},GIFEncoder.prototype.setRepeat=function(e){this.repeat=e},GIFEncoder.prototype.setTransparent=function(e){this.transparent=e},GIFEncoder.prototype.addFrame=function(e){this.image=e,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},GIFEncoder.prototype.finish=function(){this.out.writeByte(59)},GIFEncoder.prototype.setQuality=function(e){e<1&&(e=1),this.sample=e},GIFEncoder.prototype.setDither=function(e){!0===e&&(e="FloydSteinberg"),this.dither=e},GIFEncoder.prototype.setGlobalPalette=function(e){this.globalPalette=e},GIFEncoder.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},GIFEncoder.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},GIFEncoder.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new NeuQuant_1(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},GIFEncoder.prototype.indexPixels=function(e){var t=this.pixels.length/3;this.indexedPixels=new Uint8Array(t);for(var i=0,r=0;r<t;r++){var s=this.findClosestRGB(255&this.pixels[i++],255&this.pixels[i++],255&this.pixels[i++]);this.usedEntry[s]=!0,this.indexedPixels[r]=s}},GIFEncoder.prototype.ditherPixels=function(e,t){var i={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!e||!i[e])throw"Unknown dithering kernel: "+e;var r=i[e],s=0,n=this.height,o=this.width,a=this.pixels,A=t?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var l=0;l<n;l++){t&&(A*=-1);for(var h=1==A?0:o-1,d=1==A?o:0;h!==d;h+=A){var c=3*(s=l*o+h),u=a[c],p=a[c+1],_=a[c+2];c=this.findClosestRGB(u,p,_),this.usedEntry[c]=!0,this.indexedPixels[s]=c,c*=3;for(var g=u-this.colorTab[c],m=p-this.colorTab[c+1],f=_-this.colorTab[c+2],w=1==A?0:r.length-1,C=1==A?r.length:0;w!==C;w+=A){var y=r[w][1],E=r[w][2];if(y+h>=0&&y+h<o&&E+l>=0&&E+l<n){var b=r[w][0];c=s+y+E*o,a[c*=3]=Math.max(0,Math.min(255,a[c]+g*b)),a[c+1]=Math.max(0,Math.min(255,a[c+1]+m*b)),a[c+2]=Math.max(0,Math.min(255,a[c+2]+f*b))}}}}},GIFEncoder.prototype.findClosest=function(e,t){return this.findClosestRGB((16711680&e)>>16,(65280&e)>>8,255&e,t)},GIFEncoder.prototype.findClosestRGB=function(e,t,i,r){if(null===this.colorTab)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(e,t,i);for(var s=0,n=16777216,o=this.colorTab.length,a=0,A=0;a<o;A++){var l=e-(255&this.colorTab[a++]),h=t-(255&this.colorTab[a++]),d=i-(255&this.colorTab[a++]),c=l*l+h*h+d*d;(!r||this.usedEntry[A])&&c<n&&(n=c,s=A)}return s},GIFEncoder.prototype.getImagePixels=function(){var e=this.width,t=this.height;this.pixels=new Uint8Array(e*t*3);for(var i=this.image,r=0,s=0,n=0;n<t;n++)for(var o=0;o<e;o++)this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],r++},GIFEncoder.prototype.writeGraphicCtrlExt=function(){var e,t;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(e=0,t=0):(e=1,t=2),this.dispose>=0&&(t=7&dispose),t<<=2,this.out.writeByte(0|t|e),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},GIFEncoder.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},GIFEncoder.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},GIFEncoder.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},GIFEncoder.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var e=768-this.colorTab.length,t=0;t<e;t++)this.out.writeByte(0)},GIFEncoder.prototype.writeShort=function(e){this.out.writeByte(255&e),this.out.writeByte(e>>8&255)},GIFEncoder.prototype.writePixels=function(){new LZWEncoder_1(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},GIFEncoder.prototype.stream=function(){return this.out};var GIFEncoder_1=GIFEncoder,gif={NeuQuant:NeuQuant_1,TypedNeuQuant:TypedNeuQuant,GIFEncoder:GIFEncoder_1,LZWEncoder:LZWEncoder_1};class ImageExporter extends Base{constructor(){super()}_doDispose(){super._doDispose()}export(e,t,i,r){function s(e,t){r?r(e,t):download(e,t)}const n=i.type||"png",o=i.fileName||"realreport",a=(i.zipName||"realreport")+".zip";if("tiff"===n||"tif"===n){const e=[],r=[];for(let i=0;i<t.length;i++){const s=t[i].page,n={onclone:e=>{const t=e.body.getElementsByClassName("rr-print-page");for(let e of t)e.style.boxShadow="unset";const i=e.body.getElementsByClassName("rr-group-element");for(let e of i){const t=getComputedStyle(e).backgroundColor;t&&"rgba(0, 0, 0, 0)"!==t&&"rgba(0,0,0,0)"!==t&&(e.style.backgroundColor="#fff",e.style.backgroundImage="url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='7' height='7'%3E%3Crect x='3.5' y='3.5' width='0.5' height='0.5' fill='%23000'/%3E%3C/svg%3E\")")}}},o=function(t,i){return new es6Promise.Promise(((r,s)=>{html2canvas(i,n).then((i=>{e.push(i),r(t)}))}))}(i,s);r.push(o)}es6Promise.Promise.all(r).then((()=>{const t=(new TiffEncoder).encode(e,i.tiff||{}),r={};t.forEach(((e,t)=>{r[o+"."+n]=[e,{}]}));s(zipSync(r),a)})).catch((e=>{console.error(e),alert(e)}))}else if("gif"===n){const e={},i=[],r={onclone:e=>{const t=e.body.getElementsByClassName("rr-print-page");for(let e of t)e.style.boxShadow="unset"}};for(let s=0;s<t.length;s++){const a=function(i,s){return new es6Promise.Promise(((a,A)=>{html2canvas(s,r).then((r=>{const s=r.getContext("2d").getImageData(0,0,r.width,r.height).data,A=new gif.GIFEncoder(r.width,r.height);A.writeHeader(),A.addFrame(s),A.finish();const l=A.out,h=l.pages;let d=0;for(let e=0;e<h.length-1;e++)d+=h[e].length;d+=l.cursor;const c=new Uint8Array(d);h[h.length-1]=h[h.length-1].subarray(0,l.cursor);for(let e=0,t=0;e<h.length;e++)c.set(h[e],t),t+=h[e].length;const u=o+(t.length>1?i+1:"");e[u+"."+n]=[c,{}],a(i)}))}))}(s,t[s].page);i.push(a)}es6Promise.Promise.all(i).then((()=>{s(zipSync(e),a)}))}else{const e={png:"",jpg:"image/jpeg",jpeg:"image/jpeg"},i={},r=[],A={onclone:e=>{const t=e.body.getElementsByClassName("rr-print-page");for(let e of t)e.style.boxShadow="unset"}};for(let s=0;s<t.length;s++){const a=function(r,s){return new es6Promise.Promise(((a,l)=>{html2canvas(s,A).then((s=>{const A=s.toDataURL(e[n]),l=Utils.dataUriToBinary(A),h=o+(t.length>1?r+1:"");i[h+"."+n]=[l,{}],a(r)}))}))}(s,t[s].page);r.push(a)}es6Promise.Promise.all(r).then((()=>{s(zipSync(i),a)}))}}}var build=createCommonjsModule((function(e,t){e.exports=(()=>{var e={742:(e,t)=>{t.byteLength=function(e){var t=A(e),i=t[0],r=t[1];return 3*(i+r)/4-r},t.toByteArray=function(e){var t,i,n=A(e),o=n[0],a=n[1],l=new s(function(e,t,i){return 3*(t+i)/4-i}(0,o,a)),h=0,d=a>0?o-4:o;for(i=0;i<d;i+=4)t=r[e.charCodeAt(i)]<<18|r[e.charCodeAt(i+1)]<<12|r[e.charCodeAt(i+2)]<<6|r[e.charCodeAt(i+3)],l[h++]=t>>16&255,l[h++]=t>>8&255,l[h++]=255&t;return 2===a&&(t=r[e.charCodeAt(i)]<<2|r[e.charCodeAt(i+1)]>>4,l[h++]=255&t),1===a&&(t=r[e.charCodeAt(i)]<<10|r[e.charCodeAt(i+1)]<<4|r[e.charCodeAt(i+2)]>>2,l[h++]=t>>8&255,l[h++]=255&t),l},t.fromByteArray=function(e){for(var t,r=e.length,s=r%3,n=[],o=16383,a=0,A=r-s;a<A;a+=o)n.push(l(e,a,a+o>A?A:a+o));return 1===s?(t=e[r-1],n.push(i[t>>2]+i[t<<4&63]+"==")):2===s&&(t=(e[r-2]<<8)+e[r-1],n.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),n.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)i[o]=n[o],r[n.charCodeAt(o)]=o;function A(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function l(e,t,r){for(var s,n,o=[],a=t;a<r;a+=3)s=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(i[(n=s)>>18&63]+i[n>>12&63]+i[n>>6&63]+i[63&n]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},764:(e,t,i)=>{const r=i(742),s=i(645),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=A,t.SlowBuffer=function(e){return+e!=e&&(e=0),A.alloc(+e)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,A.prototype),t}function A(e,t,i){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return l(e,t,i)}function l(e,t,i){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!A.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const i=0|_(e,t);let r=a(i);const s=r.write(e,t);return s!==i&&(r=r.slice(0,s)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(X(e,Uint8Array)){const t=new Uint8Array(e);return u(t.buffer,t.byteOffset,t.byteLength)}return c(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,ArrayBuffer)||e&&X(e.buffer,ArrayBuffer))return u(e,t,i);if("undefined"!=typeof SharedArrayBuffer&&(X(e,SharedArrayBuffer)||e&&X(e.buffer,SharedArrayBuffer)))return u(e,t,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return A.from(r,t,i);const s=function(e){if(A.isBuffer(e)){const t=0|p(e.length),i=a(t);return 0===i.length||e.copy(i,0,0,t),i}return void 0!==e.length?"number"!=typeof e.length||Y(e.length)?a(0):c(e):"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return A.from(e[Symbol.toPrimitive]("string"),t,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return h(e),a(e<0?0:0|p(e))}function c(e){const t=e.length<0?0:0|p(e.length),i=a(t);for(let r=0;r<t;r+=1)i[r]=255&e[r];return i}function u(e,t,i){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),Object.setPrototypeOf(r,A.prototype),r}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function _(e,t){if(A.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||X(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const i=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===i)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return z(e).length;default:if(s)return r?-1:K(e).length;t=(""+t).toLowerCase(),s=!0}}function g(e,t,i){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,i);case"utf8":case"utf-8":return S(this,t,i);case"ascii":return R(this,t,i);case"latin1":case"binary":return I(this,t,i);case"base64":return P(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,i);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,i){const r=e[t];e[t]=e[i],e[i]=r}function f(e,t,i,r,s){if(0===e.length)return-1;if("string"==typeof i?(r=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),Y(i=+i)&&(i=s?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(s)return-1;i=e.length-1}else if(i<0){if(!s)return-1;i=0}if("string"==typeof t&&(t=A.from(t,r)),A.isBuffer(t))return 0===t.length?-1:w(e,t,i,r,s);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):w(e,[t],i,r,s);throw new TypeError("val must be string, number or Buffer")}function w(e,t,i,r,s){let n,o=1,a=e.length,A=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,A/=2,i/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let r=-1;for(n=i;n<a;n++)if(l(e,n)===l(t,-1===r?0:n-r)){if(-1===r&&(r=n),n-r+1===A)return r*o}else-1!==r&&(n-=n-r),r=-1}else for(i+A>a&&(i=a-A),n=i;n>=0;n--){let i=!0;for(let r=0;r<A;r++)if(l(e,n+r)!==l(t,r)){i=!1;break}if(i)return n}return-1}function C(e,t,i,r){i=Number(i)||0;const s=e.length-i;r?(r=Number(r))>s&&(r=s):r=s;const n=t.length;let o;for(r>n/2&&(r=n/2),o=0;o<r;++o){const r=parseInt(t.substr(2*o,2),16);if(Y(r))return o;e[i+o]=r}return o}function y(e,t,i,r){return j(K(t,e.length-i),e,i,r)}function E(e,t,i,r){return j(function(e){const t=[];for(let i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,r)}function b(e,t,i,r){return j(z(t),e,i,r)}function B(e,t,i,r){return j(function(e,t){let i,r,s;const n=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)i=e.charCodeAt(o),r=i>>8,s=i%256,n.push(s),n.push(r);return n}(t,e.length-i),e,i,r)}function P(e,t,i){return 0===t&&i===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,i))}function S(e,t,i){i=Math.min(e.length,i);const r=[];let s=t;for(;s<i;){const t=e[s];let n=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=i){let i,r,a,A;switch(o){case 1:t<128&&(n=t);break;case 2:i=e[s+1],128==(192&i)&&(A=(31&t)<<6|63&i,A>127&&(n=A));break;case 3:i=e[s+1],r=e[s+2],128==(192&i)&&128==(192&r)&&(A=(15&t)<<12|(63&i)<<6|63&r,A>2047&&(A<55296||A>57343)&&(n=A));break;case 4:i=e[s+1],r=e[s+2],a=e[s+3],128==(192&i)&&128==(192&r)&&128==(192&a)&&(A=(15&t)<<18|(63&i)<<12|(63&r)<<6|63&a,A>65535&&A<1114112&&(n=A))}}null===n?(n=65533,o=1):n>65535&&(n-=65536,r.push(n>>>10&1023|55296),n=56320|1023&n),r.push(n),s+=o}return function(e){const t=e.length;if(t<=v)return String.fromCharCode.apply(String,e);let i="",r=0;for(;r<t;)i+=String.fromCharCode.apply(String,e.slice(r,r+=v));return i}(r)}t.kMaxLength=o,A.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),A.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(A.prototype,"parent",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.buffer}}),Object.defineProperty(A.prototype,"offset",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.byteOffset}}),A.poolSize=8192,A.from=function(e,t,i){return l(e,t,i)},Object.setPrototypeOf(A.prototype,Uint8Array.prototype),Object.setPrototypeOf(A,Uint8Array),A.alloc=function(e,t,i){return function(e,t,i){return h(e),e<=0?a(e):void 0!==t?"string"==typeof i?a(e).fill(t,i):a(e).fill(t):a(e)}(e,t,i)},A.allocUnsafe=function(e){return d(e)},A.allocUnsafeSlow=function(e){return d(e)},A.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==A.prototype},A.compare=function(e,t){if(X(e,Uint8Array)&&(e=A.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=A.from(t,t.offset,t.byteLength)),!A.isBuffer(e)||!A.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,r=t.length;for(let s=0,n=Math.min(i,r);s<n;++s)if(e[s]!==t[s]){i=e[s],r=t[s];break}return i<r?-1:r<i?1:0},A.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},A.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return A.alloc(0);let i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;const r=A.allocUnsafe(t);let s=0;for(i=0;i<e.length;++i){let t=e[i];if(X(t,Uint8Array))s+t.length>r.length?(A.isBuffer(t)||(t=A.from(t)),t.copy(r,s)):Uint8Array.prototype.set.call(r,t,s);else{if(!A.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,s)}s+=t.length}return r},A.byteLength=_,A.prototype._isBuffer=!0,A.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)m(this,t,t+1);return this},A.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},A.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},A.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):g.apply(this,arguments)},A.prototype.toLocaleString=A.prototype.toString,A.prototype.equals=function(e){if(!A.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===A.compare(this,e)},A.prototype.inspect=function(){let e="";const i=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(e+=" ... "),"<Buffer "+e+">"},n&&(A.prototype[n]=A.prototype.inspect),A.prototype.compare=function(e,t,i,r,s){if(X(e,Uint8Array)&&(e=A.from(e,e.offset,e.byteLength)),!A.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),t<0||i>e.length||r<0||s>this.length)throw new RangeError("out of range index");if(r>=s&&t>=i)return 0;if(r>=s)return-1;if(t>=i)return 1;if(this===e)return 0;let n=(s>>>=0)-(r>>>=0),o=(i>>>=0)-(t>>>=0);const a=Math.min(n,o),l=this.slice(r,s),h=e.slice(t,i);for(let e=0;e<a;++e)if(l[e]!==h[e]){n=l[e],o=h[e];break}return n<o?-1:o<n?1:0},A.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},A.prototype.indexOf=function(e,t,i){return f(this,e,t,i,!0)},A.prototype.lastIndexOf=function(e,t,i){return f(this,e,t,i,!1)},A.prototype.write=function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0)}const s=this.length-t;if((void 0===i||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let n=!1;for(;;)switch(r){case"hex":return C(this,e,t,i);case"utf8":case"utf-8":return y(this,e,t,i);case"ascii":case"latin1":case"binary":return E(this,e,t,i);case"base64":return b(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,t,i);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),n=!0}},A.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const v=4096;function R(e,t,i){let r="";i=Math.min(e.length,i);for(let s=t;s<i;++s)r+=String.fromCharCode(127&e[s]);return r}function I(e,t,i){let r="";i=Math.min(e.length,i);for(let s=t;s<i;++s)r+=String.fromCharCode(e[s]);return r}function T(e,t,i){const r=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>r)&&(i=r);let s="";for(let r=t;r<i;++r)s+=J[e[r]];return s}function x(e,t,i){const r=e.slice(t,i);let s="";for(let e=0;e<r.length-1;e+=2)s+=String.fromCharCode(r[e]+256*r[e+1]);return s}function O(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,i,r,s,n){if(!A.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<n)throw new RangeError('"value" argument is out of bounds');if(i+r>e.length)throw new RangeError("Index out of range")}function L(e,t,i,r,s){V(t,r,s,e,i,7);let n=Number(t&BigInt(4294967295));e[i++]=n,n>>=8,e[i++]=n,n>>=8,e[i++]=n,n>>=8,e[i++]=n;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o,i}function F(e,t,i,r,s){V(t,r,s,e,i,7);let n=Number(t&BigInt(4294967295));e[i+7]=n,n>>=8,e[i+6]=n,n>>=8,e[i+5]=n,n>>=8,e[i+4]=n;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[i+3]=o,o>>=8,e[i+2]=o,o>>=8,e[i+1]=o,o>>=8,e[i]=o,i+8}function H(e,t,i,r,s,n){if(i+r>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function N(e,t,i,r,n){return t=+t,i>>>=0,n||H(e,0,i,4),s.write(e,t,i,r,23,4),i+4}function U(e,t,i,r,n){return t=+t,i>>>=0,n||H(e,0,i,8),s.write(e,t,i,r,52,8),i+8}A.prototype.slice=function(e,t){const i=this.length;(e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,A.prototype),r},A.prototype.readUintLE=A.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||O(e,t,this.length);let r=this[e],s=1,n=0;for(;++n<t&&(s*=256);)r+=this[e+n]*s;return r},A.prototype.readUintBE=A.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||O(e,t,this.length);let r=this[e+--t],s=1;for(;t>0&&(s*=256);)r+=this[e+--t]*s;return r},A.prototype.readUint8=A.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},A.prototype.readUint16LE=A.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},A.prototype.readUint16BE=A.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},A.prototype.readUint32LE=A.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},A.prototype.readUint32BE=A.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},A.prototype.readBigUInt64LE=q((function(e){G(e>>>=0,"offset");const t=this[e],i=this[e+7];void 0!==t&&void 0!==i||$(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,s=this[++e]+256*this[++e]+65536*this[++e]+i*2**24;return BigInt(r)+(BigInt(s)<<BigInt(32))})),A.prototype.readBigUInt64BE=q((function(e){G(e>>>=0,"offset");const t=this[e],i=this[e+7];void 0!==t&&void 0!==i||$(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],s=this[++e]*2**24+65536*this[++e]+256*this[++e]+i;return(BigInt(r)<<BigInt(32))+BigInt(s)})),A.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||O(e,t,this.length);let r=this[e],s=1,n=0;for(;++n<t&&(s*=256);)r+=this[e+n]*s;return s*=128,r>=s&&(r-=Math.pow(2,8*t)),r},A.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||O(e,t,this.length);let r=t,s=1,n=this[e+--r];for(;r>0&&(s*=256);)n+=this[e+--r]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n},A.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},A.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);const i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},A.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);const i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},A.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},A.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},A.prototype.readBigInt64LE=q((function(e){G(e>>>=0,"offset");const t=this[e],i=this[e+7];void 0!==t&&void 0!==i||$(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(i<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),A.prototype.readBigInt64BE=q((function(e){G(e>>>=0,"offset");const t=this[e],i=this[e+7];void 0!==t&&void 0!==i||$(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+i)})),A.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),s.read(this,e,!0,23,4)},A.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),s.read(this,e,!1,23,4)},A.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),s.read(this,e,!0,52,8)},A.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),s.read(this,e,!1,52,8)},A.prototype.writeUintLE=A.prototype.writeUIntLE=function(e,t,i,r){e=+e,t>>>=0,i>>>=0,r||D(this,e,t,i,Math.pow(2,8*i)-1,0);let s=1,n=0;for(this[t]=255&e;++n<i&&(s*=256);)this[t+n]=e/s&255;return t+i},A.prototype.writeUintBE=A.prototype.writeUIntBE=function(e,t,i,r){e=+e,t>>>=0,i>>>=0,r||D(this,e,t,i,Math.pow(2,8*i)-1,0);let s=i-1,n=1;for(this[t+s]=255&e;--s>=0&&(n*=256);)this[t+s]=e/n&255;return t+i},A.prototype.writeUint8=A.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,1,255,0),this[t]=255&e,t+1},A.prototype.writeUint16LE=A.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},A.prototype.writeUint16BE=A.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},A.prototype.writeUint32LE=A.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},A.prototype.writeUint32BE=A.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},A.prototype.writeBigUInt64LE=q((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),A.prototype.writeBigUInt64BE=q((function(e,t=0){return F(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),A.prototype.writeIntLE=function(e,t,i,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*i-1);D(this,e,t,i,r-1,-r)}let s=0,n=1,o=0;for(this[t]=255&e;++s<i&&(n*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/n>>0)-o&255;return t+i},A.prototype.writeIntBE=function(e,t,i,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*i-1);D(this,e,t,i,r-1,-r)}let s=i-1,n=1,o=0;for(this[t+s]=255&e;--s>=0&&(n*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/n>>0)-o&255;return t+i},A.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},A.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},A.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},A.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},A.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},A.prototype.writeBigInt64LE=q((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),A.prototype.writeBigInt64BE=q((function(e,t=0){return F(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),A.prototype.writeFloatLE=function(e,t,i){return N(this,e,t,!0,i)},A.prototype.writeFloatBE=function(e,t,i){return N(this,e,t,!1,i)},A.prototype.writeDoubleLE=function(e,t,i){return U(this,e,t,!0,i)},A.prototype.writeDoubleBE=function(e,t,i){return U(this,e,t,!1,i)},A.prototype.copy=function(e,t,i,r){if(!A.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<i&&(r=i),r===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);const s=r-i;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,i,r):Uint8Array.prototype.set.call(e,this.subarray(i,r),t),s},A.prototype.fill=function(e,t,i,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!A.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;let s;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=t;s<i;++s)this[s]=e;else{const n=A.isBuffer(e)?e:A.from(e,r),o=n.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=n[s%o]}return this};const M={};function k(e,t,i){M[e]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function Q(e){let t="",i=e.length;const r="-"===e[0]?1:0;for(;i>=r+4;i-=3)t=`_${e.slice(i-3,i)}${t}`;return`${e.slice(0,i)}${t}`}function V(e,t,i,r,s,n){if(e>i||e<t){const r="bigint"==typeof t?"n":"";let s;throw s=n>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(n+1)}${r}`:`>= -(2${r} ** ${8*(n+1)-1}${r}) and < 2 ** ${8*(n+1)-1}${r}`:`>= ${t}${r} and <= ${i}${r}`,new M.ERR_OUT_OF_RANGE("value",s,e)}!function(e,t,i){G(t,"offset"),void 0!==e[t]&&void 0!==e[t+i]||$(t,e.length-(i+1))}(r,s,n)}function G(e,t){if("number"!=typeof e)throw new M.ERR_INVALID_ARG_TYPE(t,"number",e)}function $(e,t,i){if(Math.floor(e)!==e)throw G(e,i),new M.ERR_OUT_OF_RANGE(i||"offset","an integer",e);if(t<0)throw new M.ERR_BUFFER_OUT_OF_BOUNDS;throw new M.ERR_OUT_OF_RANGE(i||"offset",`>= ${i?1:0} and <= ${t}`,e)}k("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),k("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),k("ERR_OUT_OF_RANGE",(function(e,t,i){let r=`The value of "${e}" is out of range.`,s=i;return Number.isInteger(i)&&Math.abs(i)>2**32?s=Q(String(i)):"bigint"==typeof i&&(s=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(s=Q(s)),s+="n"),r+=` It must be ${t}. Received ${s}`,r}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function K(e,t){let i;t=t||1/0;const r=e.length;let s=null;const n=[];for(let o=0;o<r;++o){if(i=e.charCodeAt(o),i>55295&&i<57344){if(!s){if(i>56319){(t-=3)>-1&&n.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&n.push(239,191,189);continue}s=i;continue}if(i<56320){(t-=3)>-1&&n.push(239,191,189),s=i;continue}i=65536+(s-55296<<10|i-56320)}else s&&(t-=3)>-1&&n.push(239,191,189);if(s=null,i<128){if((t-=1)<0)break;n.push(i)}else if(i<2048){if((t-=2)<0)break;n.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;n.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;n.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return n}function z(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,i,r){let s;for(s=0;s<r&&!(s+i>=t.length||s>=e.length);++s)t[s+i]=e[s];return s}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let i=0;i<16;++i){const r=16*i;for(let s=0;s<16;++s)t[r+s]=e[i]+e[s]}return t}();function q(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},187:e=>{var t,i="object"==typeof Reflect?Reflect:null,r=i&&"function"==typeof i.apply?i.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};t=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function n(){n.init.call(this)}e.exports=n,e.exports.once=function(e,t){return new Promise((function(i,r){function s(i){e.removeListener(t,n),r(i)}function n(){"function"==typeof e.removeListener&&e.removeListener("error",s),i([].slice.call(arguments))}_(e,t,n,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&_(e,"error",t,{once:!0})}(e,s)}))},n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function A(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function l(e,t,i,r){var s,n,o,l;if(a(i),void 0===(n=e._events)?(n=e._events=Object.create(null),e._eventsCount=0):(void 0!==n.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),n=e._events),o=n[t]),void 0===o)o=n[t]=i,++e._eventsCount;else if("function"==typeof o?o=n[t]=r?[i,o]:[o,i]:r?o.unshift(i):o.push(i),(s=A(e))>0&&o.length>s&&!o.warned){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=o.length,l=h,console&&console.warn&&console.warn(l)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,i){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},s=h.bind(r);return s.listener=i,r.wrapFn=s,s}function c(e,t,i){var r=e._events;if(void 0===r)return[];var s=r[t];return void 0===s?[]:"function"==typeof s?i?[s.listener||s]:[s]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(s):p(s,s.length)}function u(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function p(e,t){for(var i=new Array(t),r=0;r<t;++r)i[r]=e[r];return i}function _(e,t,i,r){if("function"==typeof e.on)r.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function s(n){r.once&&e.removeEventListener(t,s),i(n)}))}}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),n.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return A(this)},n.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var s="error"===e,n=this._events;if(void 0!==n)s=s&&void 0===n.error;else if(!s)return!1;if(s){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var A=n[e];if(void 0===A)return!1;if("function"==typeof A)r(A,this,t);else{var l=A.length,h=p(A,l);for(i=0;i<l;++i)r(h[i],this,t)}return!0},n.prototype.addListener=function(e,t){return l(this,e,t,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(e,t){return l(this,e,t,!0)},n.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},n.prototype.removeListener=function(e,t){var i,r,s,n,o;if(a(t),void 0===(r=this._events))return this;if(void 0===(i=r[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(s=-1,n=i.length-1;n>=0;n--)if(i[n]===t||i[n].listener===t){o=i[n].listener,s=n;break}if(s<0)return this;0===s?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,s),1===i.length&&(r[e]=i[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(e){var t,i,r;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var s,n=Object.keys(i);for(r=0;r<n.length;++r)"removeListener"!==(s=n[r])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},n.prototype.listeners=function(e){return c(this,e,!0)},n.prototype.rawListeners=function(e){return c(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):u.call(e,t)},n.prototype.listenerCount=u,n.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},645:(e,t)=>{t.read=function(e,t,i,r,s){var n,o,a=8*s-r-1,A=(1<<a)-1,l=A>>1,h=-7,d=i?s-1:0,c=i?-1:1,u=e[t+d];for(d+=c,n=u&(1<<-h)-1,u>>=-h,h+=a;h>0;n=256*n+e[t+d],d+=c,h-=8);for(o=n&(1<<-h)-1,n>>=-h,h+=r;h>0;o=256*o+e[t+d],d+=c,h-=8);if(0===n)n=1-l;else{if(n===A)return o?NaN:1/0*(u?-1:1);o+=Math.pow(2,r),n-=l}return(u?-1:1)*o*Math.pow(2,n-r)},t.write=function(e,t,i,r,s,n){var o,a,A,l=8*n-s-1,h=(1<<l)-1,d=h>>1,c=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,u=r?0:n-1,p=r?1:-1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=h):(o=Math.floor(Math.log(t)/Math.LN2),t*(A=Math.pow(2,-o))<1&&(o--,A*=2),(t+=o+d>=1?c/A:c*Math.pow(2,1-d))*A>=2&&(o++,A/=2),o+d>=h?(a=0,o=h):o+d>=1?(a=(t*A-1)*Math.pow(2,s),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;e[i+u]=255&a,u+=p,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;e[i+u]=255&o,u+=p,o/=256,l-=8);e[i+u-p]|=128*_}},717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},733:(e,t,i)=>{e.exports=function e(t,i,r){function s(o,a){if(!i[o]){if(!t[o]){if(n)return n(o,!0);var A=new Error("Cannot find module '"+o+"'");throw A.code="MODULE_NOT_FOUND",A}var l=i[o]={exports:{}};t[o][0].call(l.exports,(function(e){return s(t[o][1][e]||e)}),l,l.exports,e,t,i,r)}return i[o].exports}for(var n=void 0,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(e,t,i){var r=e("./utils"),s=e("./support"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e){for(var t,i,s,o,a,A,l,h=[],d=0,c=e.length,u=c,p="string"!==r.getTypeOf(e);d<e.length;)u=c-d,s=p?(t=e[d++],i=d<c?e[d++]:0,d<c?e[d++]:0):(t=e.charCodeAt(d++),i=d<c?e.charCodeAt(d++):0,d<c?e.charCodeAt(d++):0),o=t>>2,a=(3&t)<<4|i>>4,A=1<u?(15&i)<<2|s>>6:64,l=2<u?63&s:64,h.push(n.charAt(o)+n.charAt(a)+n.charAt(A)+n.charAt(l));return h.join("")},i.decode=function(e){var t,i,r,o,a,A,l=0,h=0,d="data:";if(e.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var c,u=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===n.charAt(64)&&u--,e.charAt(e.length-2)===n.charAt(64)&&u--,u%1!=0)throw new Error("Invalid base64 input, bad content length.");for(c=s.uint8array?new Uint8Array(0|u):new Array(0|u);l<e.length;)t=n.indexOf(e.charAt(l++))<<2|(o=n.indexOf(e.charAt(l++)))>>4,i=(15&o)<<4|(a=n.indexOf(e.charAt(l++)))>>2,r=(3&a)<<6|(A=n.indexOf(e.charAt(l++))),c[h++]=t,64!==a&&(c[h++]=i),64!==A&&(c[h++]=r);return c}},{"./support":30,"./utils":32}],2:[function(e,t,i){var r=e("./external"),s=e("./stream/DataWorker"),n=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function a(e,t,i,r,s){this.compressedSize=e,this.uncompressedSize=t,this.crc32=i,this.compression=r,this.compressedContent=s}a.prototype={getContentWorker:function(){var e=new s(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new s(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(e,t,i){return e.pipe(new n).pipe(new o("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,i){var r=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(e){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,i){var r=e("./utils"),s=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,i,r){var n=s,o=0+i;e^=-1;for(var a=0;a<o;a++)e=e>>>8^n[255&(e^t[a])];return-1^e}(0|t,e,e.length):function(e,t,i,r){var n=s,o=0+i;e^=-1;for(var a=0;a<o;a++)e=e>>>8^n[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,t,i){var r;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,i){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,s=e("pako"),n=e("./utils"),o=e("./stream/GenericWorker"),a=r?"uint8array":"array";function A(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}i.magic="\b\0",n.inherits(A,o),A.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(n.transformTo(a,e.data),!1)},A.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},A.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},A.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},i.compressWorker=function(e){return new A("Deflate",e)},i.uncompressWorker=function(){return new A("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,i){function r(e,t){var i,r="";for(i=0;i<t;i++)r+=String.fromCharCode(255&e),e>>>=8;return r}function s(e,t,i,s,o,h){var d,c,u=e.file,p=e.compression,_=h!==a.utf8encode,g=n.transformTo("string",h(u.name)),m=n.transformTo("string",a.utf8encode(u.name)),f=u.comment,w=n.transformTo("string",h(f)),C=n.transformTo("string",a.utf8encode(f)),y=m.length!==u.name.length,E=C.length!==f.length,b="",B="",P="",S=u.dir,v=u.date,R={crc32:0,compressedSize:0,uncompressedSize:0};t&&!i||(R.crc32=e.crc32,R.compressedSize=e.compressedSize,R.uncompressedSize=e.uncompressedSize);var I=0;t&&(I|=8),_||!y&&!E||(I|=2048);var T=0,x=0;S&&(T|=16),"UNIX"===o?(x=798,T|=function(e,t){var i=e;return e||(i=t?16893:33204),(65535&i)<<16}(u.unixPermissions,S)):(x=20,T|=function(e){return 63&(e||0)}(u.dosPermissions)),d=v.getUTCHours(),d<<=6,d|=v.getUTCMinutes(),d<<=5,d|=v.getUTCSeconds()/2,c=v.getUTCFullYear()-1980,c<<=4,c|=v.getUTCMonth()+1,c<<=5,c|=v.getUTCDate(),y&&(B=r(1,1)+r(A(g),4)+m,b+="up"+r(B.length,2)+B),E&&(P=r(1,1)+r(A(w),4)+C,b+="uc"+r(P.length,2)+P);var O="";return O+="\n\0",O+=r(I,2),O+=p.magic,O+=r(d,2),O+=r(c,2),O+=r(R.crc32,4),O+=r(R.compressedSize,4),O+=r(R.uncompressedSize,4),O+=r(g.length,2),O+=r(b.length,2),{fileRecord:l.LOCAL_FILE_HEADER+O+g+b,dirRecord:l.CENTRAL_FILE_HEADER+r(x,2)+O+r(w.length,2)+"\0\0\0\0"+r(T,4)+r(s,4)+g+b+w}}var n=e("../utils"),o=e("../stream/GenericWorker"),a=e("../utf8"),A=e("../crc32"),l=e("../signature");function h(e,t,i,r){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=i,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(h,o),h.prototype.push=function(e){var t=e.meta.percent||0,i=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:i?(t+100*(i-r-1))/i:100}}))},h.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var i=s(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,i=s(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),t)this.push({data:function(e){return l.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var i=this.bytesWritten-e,s=function(e,t,i,s,o){var a=n.transformTo("string",o(s));return l.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(i,4)+r(a.length,2)+a}(this.dirRecords.length,i,e,this.zipComment,this.encodeFileName);this.push({data:s,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},h.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var i=0;i<t.length;i++)try{t[i].error(e)}catch(e){}return!0},h.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,i){var r=e("../compressions"),s=e("./ZipFileWorker");i.generateWorker=function(e,t,i){var n=new s(t.streamFiles,i,t.platform,t.encodeFileName),o=0;try{e.forEach((function(e,i){o++;var s=function(e,t){var i=e||t,s=r[i];if(!s)throw new Error(i+" is not a valid compression method !");return s}(i.options.compression,t.compression),a=i.options.compressionOptions||t.compressionOptions||{},A=i.dir,l=i.date;i._compressWorker(s,a).withStreamInfo("file",{name:e,dir:A,date:l,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(n)})),n.entriesCount=o}catch(e){n.error(e)}return n}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,i){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.7.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,i){var r=e("./utils"),s=e("./external"),n=e("./utf8"),o=e("./zipEntries"),a=e("./stream/Crc32Probe"),A=e("./nodejsUtils");function l(e){return new s.Promise((function(t,i){var r=e.decompressed.getContentWorker().pipe(new a);r.on("error",(function(e){i(e)})).on("end",(function(){r.streamInfo.crc32!==e.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var i=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),A.isNode&&A.isStream(e)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var i=new o(t);return i.load(e),i})).then((function(e){var i=[s.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var n=0;n<r.length;n++)i.push(l(r[n]));return s.Promise.all(i)})).then((function(e){for(var r=e.shift(),s=r.files,n=0;n<s.length;n++){var o=s[n];i.file(o.fileNameStr,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders})}return r.zipComment.length&&(i.comment=r.zipComment),i}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,i){var r=e("../utils"),s=e("../stream/GenericWorker");function n(e,t){s.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(n,s),n.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},n.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,i){var r=e("readable-stream").Readable;function s(e,t,i){r.call(this,t),this._helper=e;var s=this;e.on("data",(function(e,t){s.push(e)||s._helper.pause(),i&&i(t)})).on("error",(function(e){s.emit("error",e)})).on("end",(function(){s.push(null)}))}e("../utils").inherits(s,r),s.prototype._read=function(){this._helper.resume()},t.exports=s},{"../utils":32,"readable-stream":16}],14:[function(e,t,i){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,i){function r(e,t,i){var r,s=n.getTypeOf(t),a=n.extend(i||{},A);a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),"string"==typeof a.unixPermissions&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&16384&a.unixPermissions&&(a.dir=!0),a.dosPermissions&&16&a.dosPermissions&&(a.dir=!0),a.dir&&(e=_(e)),a.createFolders&&(r=p(e))&&g.call(this,r,!0);var d,m="string"===s&&!1===a.binary&&!1===a.base64;i&&void 0!==i.binary||(a.binary=!m),(t instanceof l&&0===t.uncompressedSize||a.dir||!t||0===t.length)&&(a.base64=!1,a.binary=!0,t="",a.compression="STORE",s="string"),d=t instanceof l||t instanceof o?t:c.isNode&&c.isStream(t)?new u(e,t):n.prepareContent(e,t,a.binary,a.optimizedBinaryString,a.base64);var f=new h(e,d,a);this.files[e]=f}var s=e("./utf8"),n=e("./utils"),o=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),A=e("./defaults"),l=e("./compressedObject"),h=e("./zipObject"),d=e("./generate"),c=e("./nodejsUtils"),u=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},_=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:A.createFolders,e=_(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function m(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var f={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,i,r;for(t in this.files)r=this.files[t],(i=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(i,r)},filter:function(e){var t=[];return this.forEach((function(i,r){e(i,r)&&t.push(r)})),t},file:function(e,t,i){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,i),this;if(m(e)){var s=e;return this.filter((function(e,t){return!t.dir&&s.test(e)}))}var n=this.files[this.root+e];return n&&!n.dir?n:null},folder:function(e){if(!e)return this;if(m(e))return this.filter((function(t,i){return i.dir&&e.test(t)}));var t=this.root+e,i=g.call(this,t),r=this.clone();return r.root=i.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var i=this.filter((function(t,i){return i.name.slice(0,e.length)===e})),r=0;r<i.length;r++)delete this.files[i[r].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,i={};try{if((i=n.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),"binarystring"===i.type&&(i.type="string"),!i.type)throw new Error("No output type specified.");n.checkSupport(i.type),"darwin"!==i.platform&&"freebsd"!==i.platform&&"linux"!==i.platform&&"sunos"!==i.platform||(i.platform="UNIX"),"win32"===i.platform&&(i.platform="DOS");var r=i.comment||this.comment||"";t=d.generateWorker(this,i,r)}catch(e){(t=new o("error")).error(e)}return new a(t,i.type||"string",i.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=f},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,i){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,i){var r=e("./DataReader");function s(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(s,r),s.prototype.byteAt=function(e){return this.data[this.zero+e]},s.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),i=e.charCodeAt(1),r=e.charCodeAt(2),s=e.charCodeAt(3),n=this.length-4;0<=n;--n)if(this.data[n]===t&&this.data[n+1]===i&&this.data[n+2]===r&&this.data[n+3]===s)return n-this.zero;return-1},s.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),r=e.charCodeAt(2),s=e.charCodeAt(3),n=this.readData(4);return t===n[0]&&i===n[1]&&r===n[2]&&s===n[3]},s.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./DataReader":18}],18:[function(e,t,i){var r=e("../utils");function s(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,i=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)i=(i<<8)+this.byteAt(t);return this.index+=e,i},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=s},{"../utils":32}],19:[function(e,t,i){var r=e("./Uint8ArrayReader");function s(e){r.call(this,e)}e("../utils").inherits(s,r),s.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,i){var r=e("./DataReader");function s(e){r.call(this,e)}e("../utils").inherits(s,r),s.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},s.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},s.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},s.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./DataReader":18}],21:[function(e,t,i){var r=e("./ArrayReader");function s(e){r.call(this,e)}e("../utils").inherits(s,r),s.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,i){var r=e("../utils"),s=e("../support"),n=e("./ArrayReader"),o=e("./StringReader"),a=e("./NodeBufferReader"),A=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||s.uint8array?"nodebuffer"===t?new a(e):s.uint8array?new A(r.transformTo("uint8array",e)):new n(r.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,i){var r=e("./GenericWorker"),s=e("../utils");function n(e){r.call(this,"ConvertWorker to "+e),this.destType=e}s.inherits(n,r),n.prototype.processChunk=function(e){this.push({data:s.transformTo(this.destType,e.data),meta:e.meta})},t.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,i){var r=e("./GenericWorker"),s=e("../crc32");function n(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(n,r),n.prototype.processChunk=function(e){this.streamInfo.crc32=s(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,i){var r=e("../utils"),s=e("./GenericWorker");function n(e){s.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(n,s),n.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}s.prototype.processChunk.call(this,e)},t.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,i){var r=e("../utils"),s=e("./GenericWorker");function n(e){s.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}r.inherits(n,s),n.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,i){function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var i=0;i<this._listeners[e].length;i++)this._listeners[e][i].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,i){var r=e("../utils"),s=e("./ConvertWorker"),n=e("./GenericWorker"),o=e("../base64"),a=e("../support"),A=e("../external"),l=null;if(a.nodestream)try{l=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function h(e,t,i){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=i,r.checkSupport(o),this._worker=e.pipe(new s(o)),e.lock()}catch(e){this._worker=new n("error"),this._worker.error(e)}}h.prototype={accumulate:function(e){return function(e,t){return new A.Promise((function(i,s){var n=[],a=e._internalType,A=e._outputType,l=e._mimeType;e.on("data",(function(e,i){n.push(e),t&&t(i)})).on("error",(function(e){n=[],s(e)})).on("end",(function(){try{var e=function(e,t,i){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),i);case"base64":return o.encode(t);default:return r.transformTo(e,t)}}(A,function(e,t){var i,r=0,s=null,n=0;for(i=0;i<t.length;i++)n+=t[i].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(s=new Uint8Array(n),i=0;i<t.length;i++)s.set(t[i],r),r+=t[i].length;return s;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(a,n),l);i(e)}catch(e){s(e)}n=[]})).resume()}))}(this,e)},on:function(e,t){var i=this;return"data"===e?this._worker.on(e,(function(e){t.call(i,e.data,e.meta)})):this._worker.on(e,(function(){r.delay(t,arguments,i)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new l(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer="undefined"!=typeof Buffer,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var r=new ArrayBuffer(0);try{i.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(r),i.blob=0===s.getBlob("application/zip").size}catch(e){i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch(e){i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,i){for(var r=e("./utils"),s=e("./support"),n=e("./nodejsUtils"),o=e("./stream/GenericWorker"),a=new Array(256),A=0;A<256;A++)a[A]=252<=A?6:248<=A?5:240<=A?4:224<=A?3:192<=A?2:1;function l(){o.call(this,"utf-8 decode"),this.leftOver=null}function h(){o.call(this,"utf-8 encode")}a[254]=a[254]=1,i.utf8encode=function(e){return s.nodebuffer?n.newBufferFrom(e,"utf-8"):function(e){var t,i,r,n,o,a=e.length,A=0;for(n=0;n<a;n++)55296==(64512&(i=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(r=e.charCodeAt(n+1)))&&(i=65536+(i-55296<<10)+(r-56320),n++),A+=i<128?1:i<2048?2:i<65536?3:4;for(t=s.uint8array?new Uint8Array(A):new Array(A),n=o=0;o<A;n++)55296==(64512&(i=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(r=e.charCodeAt(n+1)))&&(i=65536+(i-55296<<10)+(r-56320),n++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t}(e)},i.utf8decode=function(e){return s.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,i,s,n,o=e.length,A=new Array(2*o);for(t=i=0;t<o;)if((s=e[t++])<128)A[i++]=s;else if(4<(n=a[s]))A[i++]=65533,t+=n-1;else{for(s&=2===n?31:3===n?15:7;1<n&&t<o;)s=s<<6|63&e[t++],n--;1<n?A[i++]=65533:s<65536?A[i++]=s:(s-=65536,A[i++]=55296|s>>10&1023,A[i++]=56320|1023&s)}return A.length!==i&&(A.subarray?A=A.subarray(0,i):A.length=i),r.applyFromCharCode(A)}(e=r.transformTo(s.uint8array?"uint8array":"array",e))},r.inherits(l,o),l.prototype.processChunk=function(e){var t=r.transformTo(s.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var n=t;(t=new Uint8Array(n.length+this.leftOver.length)).set(this.leftOver,0),t.set(n,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+a[e[i]]>t?i:t}(t),A=t;o!==t.length&&(s.uint8array?(A=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(A=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:i.utf8decode(A),meta:e.meta})},l.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=l,r.inherits(h,o),h.prototype.processChunk=function(e){this.push({data:i.utf8encode(e.data),meta:e.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,i){var r=e("./support"),s=e("./base64"),n=e("./nodejsUtils"),o=e("set-immediate-shim"),a=e("./external");function A(e){return e}function l(e,t){for(var i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t}i.newBlob=function(e,t){i.checkSupport("blob");try{return new Blob([e],{type:t})}catch(i){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(e,t,i){var r=[],s=0,n=e.length;if(n<=i)return String.fromCharCode.apply(null,e);for(;s<n;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(s,Math.min(s+i,n)))):r.push(String.fromCharCode.apply(null,e.subarray(s,Math.min(s+i,n)))),s+=i;return r.join("")},stringifyByChar:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,n.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,r=i.getTypeOf(e),s=!0;if("uint8array"===r?s=h.applyCanBeUsed.uint8array:"nodebuffer"===r&&(s=h.applyCanBeUsed.nodebuffer),s)for(;1<t;)try{return h.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return h.stringifyByChar(e)}function c(e,t){for(var i=0;i<e.length;i++)t[i]=e[i];return t}i.applyFromCharCode=d;var u={};u.string={string:A,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,n.allocBuffer(e.length))}},u.array={string:d,array:A,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return n.newBufferFrom(e)}},u.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return c(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:A,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return n.newBufferFrom(new Uint8Array(e))}},u.uint8array={string:d,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:A,nodebuffer:function(e){return n.newBufferFrom(e)}},u.nodebuffer={string:d,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:A},i.transformTo=function(e,t){if(t=t||"",!e)return t;i.checkSupport(e);var r=i.getTypeOf(t);return u[r][e](t)},i.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&n.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(e){var t,i,r="";for(i=0;i<(e||"").length;i++)r+="\\x"+((t=e.charCodeAt(i))<16?"0":"")+t.toString(16).toUpperCase();return r},i.delay=function(e,t,i){o((function(){e.apply(i||null,t||[])}))},i.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.prototype=new i},i.extend=function(){var e,t,i={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===i[t]&&(i[t]=arguments[e][t]);return i},i.prepareContent=function(e,t,n,o,A){return a.Promise.resolve(t).then((function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise((function(t,i){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){i(e.target.error)},r.readAsArrayBuffer(e)})):e})).then((function(t){var h=i.getTypeOf(t);return h?("arraybuffer"===h?t=i.transformTo("uint8array",t):"string"===h&&(A?t=s.decode(t):n&&!0!==o&&(t=function(e){return l(e,r.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(e,t,i){var r=e("./reader/readerFor"),s=e("./utils"),n=e("./signature"),o=e("./zipEntry"),a=(e("./utf8"),e("./support"));function A(e){this.files=[],this.loadOptions=e}A.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(t)+", expected "+s.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(i),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=a.uint8array?"uint8array":"array",i=s.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,i,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),i=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var r=t-i;if(0<r)this.isSignature(t,n.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=A},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,i){var r=e("./reader/readerFor"),s=e("./utils"),n=e("./compressedObject"),o=e("./crc32"),a=e("./utf8"),A=e("./compressions"),l=e("./support");function h(e,t){this.options=e,this.loadOptions=t}h.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in A)if(A.hasOwnProperty(t)&&A[t].magic===e)return A[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=r(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,i,r,s=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<s;)t=e.readInt(2),i=e.readInt(2),r=e.readData(i),this.extraFields[t]={id:t,length:i,value:r};e.setIndex(s)},handleUTF8:function(){var e=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var i=s.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var n=s.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(n)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null}},t.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,i){function r(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}}var s=e("./stream/StreamHelper"),n=e("./stream/DataWorker"),o=e("./utf8"),a=e("./compressedObject"),A=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,i="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(i=e.toLowerCase())||"text"===i;"binarystring"!==i&&"text"!==i||(i="string"),t=this._decompressWorker();var n=!this._dataBinary;n&&!r&&(t=t.pipe(new o.Utf8EncodeWorker)),!n&&r&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new A("error")).error(e)}return new s(t,i,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(i,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof A?this._data:new n(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<l.length;d++)r.prototype[l[d]]=h;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){var i,r,s=e.MutationObserver||e.WebKitMutationObserver;if(s){var n=0,o=new s(h),a=e.document.createTextNode("");o.observe(a,{characterData:!0}),i=function(){a.data=n=++n%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){h(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(h,0)};else{var A=new e.MessageChannel;A.port1.onmessage=h,i=function(){A.port2.postMessage(0)}}var l=[];function h(){var e,t;r=!0;for(var i=l.length;i;){for(t=l,l=[],e=-1;++e<i;)t[e]();i=l.length}r=!1}t.exports=function(e){1!==l.push(e)||r||i()}}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,i){var r=e("immediate");function s(){}var n={},o=["REJECTED"],a=["FULFILLED"],A=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=A,this.queue=[],this.outcome=void 0,e!==s&&u(this,e)}function h(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function d(e,t,i){r((function(){var r;try{r=t(i)}catch(r){return n.reject(e,r)}r===e?n.reject(e,new TypeError("Cannot resolve promise with itself")):n.resolve(e,r)}))}function c(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function u(e,t){var i=!1;function r(t){i||(i=!0,n.reject(e,t))}function s(t){i||(i=!0,n.resolve(e,t))}var o=p((function(){t(s,r)}));"error"===o.status&&r(o.value)}function p(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}(t.exports=l).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(i){return t.resolve(e()).then((function(){return i}))}),(function(i){return t.resolve(e()).then((function(){throw i}))}))},l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var i=new this.constructor(s);return this.state!==A?d(i,this.state===a?e:t,this.outcome):this.queue.push(new h(i,e,t)),i},h.prototype.callFulfilled=function(e){n.resolve(this.promise,e)},h.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},h.prototype.callRejected=function(e){n.reject(this.promise,e)},h.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},n.resolve=function(e,t){var i=p(c,t);if("error"===i.status)return n.reject(e,i.value);var r=i.value;if(r)u(e,r);else{e.state=a,e.outcome=t;for(var s=-1,o=e.queue.length;++s<o;)e.queue[s].callFulfilled(t)}return e},n.reject=function(e,t){e.state=o,e.outcome=t;for(var i=-1,r=e.queue.length;++i<r;)e.queue[i].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:n.resolve(new this(s),e)},l.reject=function(e){var t=new this(s);return n.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var o=new Array(i),a=0,A=-1,l=new this(s);++A<i;)h(e[A],A);return l;function h(e,s){t.resolve(e).then((function(e){o[s]=e,++a!==i||r||(r=!0,n.resolve(l,o))}),(function(e){r||(r=!0,n.reject(l,e))}))}},l.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,i=!1;if(!t)return this.resolve([]);for(var r,o=-1,a=new this(s);++o<t;)r=e[o],this.resolve(r).then((function(e){i||(i=!0,n.resolve(a,e))}),(function(e){i||(i=!0,n.reject(a,e))}));return a}},{immediate:36}],38:[function(e,t,i){var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,i){var r=e("./zlib/deflate"),s=e("./utils/common"),n=e("./utils/strings"),o=e("./zlib/messages"),a=e("./zlib/zstream"),A=Object.prototype.toString;function l(e){if(!(this instanceof l))return new l(e);this.options=s.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var i=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==i)throw new Error(o[i]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var h;if(h="string"==typeof t.dictionary?n.string2buf(t.dictionary):"[object ArrayBuffer]"===A.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(i=r.deflateSetDictionary(this.strm,h)))throw new Error(o[i]);this._dict_set=!0}}function h(e,t){var i=new l(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}l.prototype.push=function(e,t){var i,o,a=this.strm,l=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=n.string2buf(e):"[object ArrayBuffer]"===A.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new s.Buf8(l),a.next_out=0,a.avail_out=l),1!==(i=r.deflate(a,o))&&0!==i)return this.onEnd(i),!(this.ended=!0);0!==a.avail_out&&(0!==a.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(n.buf2binstring(s.shrinkBuf(a.output,a.next_out))):this.onData(s.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&1!==i);return 4===o?(i=r.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,0===i):2!==o||(this.onEnd(0),!(a.avail_out=0))},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=l,i.deflate=h,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,h(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,i){var r=e("./zlib/inflate"),s=e("./utils/common"),n=e("./utils/strings"),o=e("./zlib/constants"),a=e("./zlib/messages"),A=e("./zlib/zstream"),l=e("./zlib/gzheader"),h=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A,this.strm.avail_out=0;var i=r.inflateInit2(this.strm,t.windowBits);if(i!==o.Z_OK)throw new Error(a[i]);this.header=new l,r.inflateGetHeader(this.strm,this.header)}function c(e,t){var i=new d(t);if(i.push(e,!0),i.err)throw i.msg||a[i.err];return i.result}d.prototype.push=function(e,t){var i,a,A,l,d,c,u=this.strm,p=this.options.chunkSize,_=this.options.dictionary,g=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?u.input=n.binstring2buf(e):"[object ArrayBuffer]"===h.call(e)?u.input=new Uint8Array(e):u.input=e,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new s.Buf8(p),u.next_out=0,u.avail_out=p),(i=r.inflate(u,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&_&&(c="string"==typeof _?n.string2buf(_):"[object ArrayBuffer]"===h.call(_)?new Uint8Array(_):_,i=r.inflateSetDictionary(this.strm,c)),i===o.Z_BUF_ERROR&&!0===g&&(i=o.Z_OK,g=!1),i!==o.Z_STREAM_END&&i!==o.Z_OK)return this.onEnd(i),!(this.ended=!0);u.next_out&&(0!==u.avail_out&&i!==o.Z_STREAM_END&&(0!==u.avail_in||a!==o.Z_FINISH&&a!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(A=n.utf8border(u.output,u.next_out),l=u.next_out-A,d=n.buf2string(u.output,A),u.next_out=l,u.avail_out=p-l,l&&s.arraySet(u.output,u.output,A,l,0),this.onData(d)):this.onData(s.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(g=!0)}while((0<u.avail_in||0===u.avail_out)&&i!==o.Z_STREAM_END);return i===o.Z_STREAM_END&&(a=o.Z_FINISH),a===o.Z_FINISH?(i=r.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===o.Z_OK):a!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(u.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=d,i.inflate=c,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},i.ungzip=c},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,i){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,i,r,s){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+r),s);else for(var n=0;n<r;n++)e[s+n]=t[i+n]},flattenChunks:function(e){var t,i,r,s,n,o;for(t=r=0,i=e.length;t<i;t++)r+=e[t].length;for(o=new Uint8Array(r),t=s=0,i=e.length;t<i;t++)n=e[t],o.set(n,s),s+=n.length;return o}},n={arraySet:function(e,t,i,r,s){for(var n=0;n<r;n++)e[s+n]=t[i+n]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,n))},i.setTyped(r)},{}],42:[function(e,t,i){var r=e("./common"),s=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch(e){s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){n=!1}for(var o=new r.Buf8(256),a=0;a<256;a++)o[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function A(e,t){if(t<65537&&(e.subarray&&n||!e.subarray&&s))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var i="",o=0;o<t;o++)i+=String.fromCharCode(e[o]);return i}o[254]=o[254]=1,i.string2buf=function(e){var t,i,s,n,o,a=e.length,A=0;for(n=0;n<a;n++)55296==(64512&(i=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(s=e.charCodeAt(n+1)))&&(i=65536+(i-55296<<10)+(s-56320),n++),A+=i<128?1:i<2048?2:i<65536?3:4;for(t=new r.Buf8(A),n=o=0;o<A;n++)55296==(64512&(i=e.charCodeAt(n)))&&n+1<a&&56320==(64512&(s=e.charCodeAt(n+1)))&&(i=65536+(i-55296<<10)+(s-56320),n++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t},i.buf2binstring=function(e){return A(e,e.length)},i.binstring2buf=function(e){for(var t=new r.Buf8(e.length),i=0,s=t.length;i<s;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,r,s,n,a=t||e.length,l=new Array(2*a);for(i=r=0;i<a;)if((s=e[i++])<128)l[r++]=s;else if(4<(n=o[s]))l[r++]=65533,i+=n-1;else{for(s&=2===n?31:3===n?15:7;1<n&&i<a;)s=s<<6|63&e[i++],n--;1<n?l[r++]=65533:s<65536?l[r++]=s:(s-=65536,l[r++]=55296|s>>10&1023,l[r++]=56320|1023&s)}return A(l,r)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+o[e[i]]>t?i:t}},{"./common":41}],43:[function(e,t,i){t.exports=function(e,t,i,r){for(var s=65535&e|0,n=e>>>16&65535|0,o=0;0!==i;){for(i-=o=2e3<i?2e3:i;n=n+(s=s+t[r++]|0)|0,--o;);s%=65521,n%=65521}return s|n<<16|0}},{}],44:[function(e,t,i){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,i){var r=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,s){var n=r,o=s+i;e^=-1;for(var a=s;a<o;a++)e=e>>>8^n[255&(e^t[a])];return-1^e}},{}],46:[function(e,t,i){var r,s=e("../utils/common"),n=e("./trees"),o=e("./adler32"),a=e("./crc32"),A=e("./messages"),l=-2,h=258,d=262,c=113;function u(e,t){return e.msg=A[t],t}function p(e){return(e<<1)-(4<e?9:0)}function _(e){for(var t=e.length;0<=--t;)e[t]=0}function g(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(s.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function m(e,t){n._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,g(e.strm)}function f(e,t){e.pending_buf[e.pending++]=t}function w(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function C(e,t){var i,r,s=e.max_chain_length,n=e.strstart,o=e.prev_length,a=e.nice_match,A=e.strstart>e.w_size-d?e.strstart-(e.w_size-d):0,l=e.window,c=e.w_mask,u=e.prev,p=e.strstart+h,_=l[n+o-1],g=l[n+o];e.prev_length>=e.good_match&&(s>>=2),a>e.lookahead&&(a=e.lookahead);do{if(l[(i=t)+o]===g&&l[i+o-1]===_&&l[i]===l[n]&&l[++i]===l[n+1]){n+=2,i++;do{}while(l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&l[++n]===l[++i]&&n<p);if(r=h-(p-n),n=p-h,o<r){if(e.match_start=t,a<=(o=r))break;_=l[n+o-1],g=l[n+o]}}}while((t=u[t&c])>A&&0!=--s);return o<=e.lookahead?o:e.lookahead}function y(e){var t,i,r,n,A,l,h,c,u,p,_=e.w_size;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=_+(_-d)){for(s.arraySet(e.window,e.window,_,_,0),e.match_start-=_,e.strstart-=_,e.block_start-=_,t=i=e.hash_size;r=e.head[--t],e.head[t]=_<=r?r-_:0,--i;);for(t=i=_;r=e.prev[--t],e.prev[t]=_<=r?r-_:0,--i;);n+=_}if(0===e.strm.avail_in)break;if(l=e.strm,h=e.window,c=e.strstart+e.lookahead,p=void 0,(u=n)<(p=l.avail_in)&&(p=u),i=0===p?0:(l.avail_in-=p,s.arraySet(h,l.input,l.next_in,p,c),1===l.state.wrap?l.adler=o(l.adler,h,p,c):2===l.state.wrap&&(l.adler=a(l.adler,h,p,c)),l.next_in+=p,l.total_in+=p,p),e.lookahead+=i,e.lookahead+e.insert>=3)for(A=e.strstart-e.insert,e.ins_h=e.window[A],e.ins_h=(e.ins_h<<e.hash_shift^e.window[A+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[A+3-1])&e.hash_mask,e.prev[A&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=A,A++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<d&&0!==e.strm.avail_in)}function E(e,t){for(var i,r;;){if(e.lookahead<d){if(y(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-d&&(e.match_length=C(e,i)),e.match_length>=3)if(r=n._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(m(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(m(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(m(e,!1),0===e.strm.avail_out)?1:2}function b(e,t){for(var i,r,s;;){if(e.lookahead<d){if(y(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-d&&(e.match_length=C(e,i),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(s=e.strstart+e.lookahead-3,r=n._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(m(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=n._tr_tally(e,0,e.window[e.strstart-1]))&&m(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=n._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(m(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(m(e,!1),0===e.strm.avail_out)?1:2}function B(e,t,i,r,s){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=s}function P(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(1146),this.dyn_dtree=new s.Buf16(122),this.bl_tree=new s.Buf16(78),_(this.dyn_ltree),_(this.dyn_dtree),_(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(16),this.heap=new s.Buf16(573),_(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(573),_(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function S(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:c,e.adler=2===t.wrap?0:1,t.last_flush=0,n._tr_init(t),0):u(e,l)}function v(e){var t=S(e);return 0===t&&function(e){e.window_size=2*e.w_size,_(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}(e.state),t}function R(e,t,i,r,n,o){if(!e)return l;var a=1;if(-1===t&&(t=6),r<0?(a=0,r=-r):15<r&&(a=2,r-=16),n<1||9<n||8!==i||r<8||15<r||t<0||9<t||o<0||4<o)return u(e,l);8===r&&(r=9);var A=new P;return(e.state=A).strm=e,A.wrap=a,A.gzhead=null,A.w_bits=r,A.w_size=1<<A.w_bits,A.w_mask=A.w_size-1,A.hash_bits=n+7,A.hash_size=1<<A.hash_bits,A.hash_mask=A.hash_size-1,A.hash_shift=~~((A.hash_bits+3-1)/3),A.window=new s.Buf8(2*A.w_size),A.head=new s.Buf16(A.hash_size),A.prev=new s.Buf16(A.w_size),A.lit_bufsize=1<<n+6,A.pending_buf_size=4*A.lit_bufsize,A.pending_buf=new s.Buf8(A.pending_buf_size),A.d_buf=1*A.lit_bufsize,A.l_buf=3*A.lit_bufsize,A.level=t,A.strategy=o,A.method=i,v(e)}r=[new B(0,0,0,0,(function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(y(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+i;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,m(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-d&&(m(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(m(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(m(e,!1),e.strm.avail_out),1)})),new B(4,4,8,4,E),new B(4,5,16,8,E),new B(4,6,32,32,E),new B(4,4,16,16,b),new B(8,16,32,32,b),new B(8,16,128,128,b),new B(8,32,128,256,b),new B(32,128,258,1024,b),new B(32,258,258,4096,b)],i.deflateInit=function(e,t){return R(e,t,8,15,8,0)},i.deflateInit2=R,i.deflateReset=v,i.deflateResetKeep=S,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?l:(e.state.gzhead=t,0):l},i.deflate=function(e,t){var i,s,o,A;if(!e||!e.state||5<t||t<0)return e?u(e,l):l;if(s=e.state,!e.output||!e.input&&0!==e.avail_in||666===s.status&&4!==t)return u(e,0===e.avail_out?-5:l);if(s.strm=e,i=s.last_flush,s.last_flush=t,42===s.status)if(2===s.wrap)e.adler=0,f(s,31),f(s,139),f(s,8),s.gzhead?(f(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),f(s,255&s.gzhead.time),f(s,s.gzhead.time>>8&255),f(s,s.gzhead.time>>16&255),f(s,s.gzhead.time>>24&255),f(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),f(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(f(s,255&s.gzhead.extra.length),f(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=a(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(f(s,0),f(s,0),f(s,0),f(s,0),f(s,0),f(s,9===s.level?2:2<=s.strategy||s.level<2?4:0),f(s,3),s.status=c);else{var d=8+(s.w_bits-8<<4)<<8;d|=(2<=s.strategy||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(d|=32),d+=31-d%31,s.status=c,w(s,d),0!==s.strstart&&(w(s,e.adler>>>16),w(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(o=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),g(e),o=s.pending,s.pending!==s.pending_buf_size));)f(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){o=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),g(e),o=s.pending,s.pending===s.pending_buf_size)){A=1;break}A=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,f(s,A)}while(0!==A);s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),0===A&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){o=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),g(e),o=s.pending,s.pending===s.pending_buf_size)){A=1;break}A=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,f(s,A)}while(0!==A);s.gzhead.hcrc&&s.pending>o&&(e.adler=a(e.adler,s.pending_buf,s.pending-o,o)),0===A&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&g(e),s.pending+2<=s.pending_buf_size&&(f(s,255&e.adler),f(s,e.adler>>8&255),e.adler=0,s.status=c)):s.status=c),0!==s.pending){if(g(e),0===e.avail_out)return s.last_flush=-1,0}else if(0===e.avail_in&&p(t)<=p(i)&&4!==t)return u(e,-5);if(666===s.status&&0!==e.avail_in)return u(e,-5);if(0!==e.avail_in||0!==s.lookahead||0!==t&&666!==s.status){var C=2===s.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&(y(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,i=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(m(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(m(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(m(e,!1),0===e.strm.avail_out)?1:2}(s,t):3===s.strategy?function(e,t){for(var i,r,s,o,a=e.window;;){if(e.lookahead<=h){if(y(e),e.lookahead<=h&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(r=a[s=e.strstart-1])===a[++s]&&r===a[++s]&&r===a[++s]){o=e.strstart+h;do{}while(r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&r===a[++s]&&s<o);e.match_length=h-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=n._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(m(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(m(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(m(e,!1),0===e.strm.avail_out)?1:2}(s,t):r[s.level].func(s,t);if(3!==C&&4!==C||(s.status=666),1===C||3===C)return 0===e.avail_out&&(s.last_flush=-1),0;if(2===C&&(1===t?n._tr_align(s):5!==t&&(n._tr_stored_block(s,0,0,!1),3===t&&(_(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),g(e),0===e.avail_out))return s.last_flush=-1,0}return 4!==t?0:s.wrap<=0?1:(2===s.wrap?(f(s,255&e.adler),f(s,e.adler>>8&255),f(s,e.adler>>16&255),f(s,e.adler>>24&255),f(s,255&e.total_in),f(s,e.total_in>>8&255),f(s,e.total_in>>16&255),f(s,e.total_in>>24&255)):(w(s,e.adler>>>16),w(s,65535&e.adler)),g(e),0<s.wrap&&(s.wrap=-s.wrap),0!==s.pending?0:1)},i.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==c&&666!==t?u(e,l):(e.state=null,t===c?u(e,-3):0):l},i.deflateSetDictionary=function(e,t){var i,r,n,a,A,h,d,c,u=t.length;if(!e||!e.state)return l;if(2===(a=(i=e.state).wrap)||1===a&&42!==i.status||i.lookahead)return l;for(1===a&&(e.adler=o(e.adler,t,u,0)),i.wrap=0,u>=i.w_size&&(0===a&&(_(i.head),i.strstart=0,i.block_start=0,i.insert=0),c=new s.Buf8(i.w_size),s.arraySet(c,t,u-i.w_size,i.w_size,0),t=c,u=i.w_size),A=e.avail_in,h=e.next_in,d=e.input,e.avail_in=u,e.next_in=0,e.input=t,y(i);i.lookahead>=3;){for(r=i.strstart,n=i.lookahead-2;i.ins_h=(i.ins_h<<i.hash_shift^i.window[r+3-1])&i.hash_mask,i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++,--n;);i.strstart=r,i.lookahead=2,y(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=h,e.input=d,e.avail_in=A,i.wrap=a,0},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,i){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,i){t.exports=function(e,t){var i,r,s,n,o,a,A,l,h,d,c,u,p,_,g,m,f,w,C,y,E,b,B,P,S;i=e.state,r=e.next_in,P=e.input,s=r+(e.avail_in-5),n=e.next_out,S=e.output,o=n-(t-e.avail_out),a=n+(e.avail_out-257),A=i.dmax,l=i.wsize,h=i.whave,d=i.wnext,c=i.window,u=i.hold,p=i.bits,_=i.lencode,g=i.distcode,m=(1<<i.lenbits)-1,f=(1<<i.distbits)-1;e:do{p<15&&(u+=P[r++]<<p,p+=8,u+=P[r++]<<p,p+=8),w=_[u&m];t:for(;;){if(u>>>=C=w>>>24,p-=C,0==(C=w>>>16&255))S[n++]=65535&w;else{if(!(16&C)){if(0==(64&C)){w=_[(65535&w)+(u&(1<<C)-1)];continue t}if(32&C){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}y=65535&w,(C&=15)&&(p<C&&(u+=P[r++]<<p,p+=8),y+=u&(1<<C)-1,u>>>=C,p-=C),p<15&&(u+=P[r++]<<p,p+=8,u+=P[r++]<<p,p+=8),w=g[u&f];i:for(;;){if(u>>>=C=w>>>24,p-=C,!(16&(C=w>>>16&255))){if(0==(64&C)){w=g[(65535&w)+(u&(1<<C)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(E=65535&w,p<(C&=15)&&(u+=P[r++]<<p,(p+=8)<C&&(u+=P[r++]<<p,p+=8)),A<(E+=u&(1<<C)-1)){e.msg="invalid distance too far back",i.mode=30;break e}if(u>>>=C,p-=C,(C=n-o)<E){if(h<(C=E-C)&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(B=c,(b=0)===d){if(b+=l-C,C<y){for(y-=C;S[n++]=c[b++],--C;);b=n-E,B=S}}else if(d<C){if(b+=l+d-C,(C-=d)<y){for(y-=C;S[n++]=c[b++],--C;);if(b=0,d<y){for(y-=C=d;S[n++]=c[b++],--C;);b=n-E,B=S}}}else if(b+=d-C,C<y){for(y-=C;S[n++]=c[b++],--C;);b=n-E,B=S}for(;2<y;)S[n++]=B[b++],S[n++]=B[b++],S[n++]=B[b++],y-=3;y&&(S[n++]=B[b++],1<y&&(S[n++]=B[b++]))}else{for(b=n-E;S[n++]=S[b++],S[n++]=S[b++],S[n++]=S[b++],2<(y-=3););y&&(S[n++]=S[b++],1<y&&(S[n++]=S[b++]))}break}}break}}while(r<s&&n<a);r-=y=p>>3,u&=(1<<(p-=y<<3))-1,e.next_in=r,e.next_out=n,e.avail_in=r<s?s-r+5:5-(r-s),e.avail_out=n<a?a-n+257:257-(n-a),i.hold=u,i.bits=p}},{}],49:[function(e,t,i){var r=e("../utils/common"),s=e("./adler32"),n=e("./crc32"),o=e("./inffast"),a=e("./inftrees"),A=-2;function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function h(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):A}function c(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):A}function u(e,t){var i,r;return e&&e.state?(r=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?A:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,c(e))):A}function p(e,t){var i,r;return e?(r=new h,(e.state=r).window=null,0!==(i=u(e,t))&&(e.state=null),i):A}var _,g,m=!0;function f(e){if(m){var t;for(_=new r.Buf32(512),g=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,_,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,g,0,e.work,{bits:5}),m=!1}e.lencode=_,e.lenbits=9,e.distcode=g,e.distbits=5}function w(e,t,i,s){var n,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),s>=o.wsize?(r.arraySet(o.window,t,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(s<(n=o.wsize-o.wnext)&&(n=s),r.arraySet(o.window,t,i-s,n,o.wnext),(s-=n)?(r.arraySet(o.window,t,i-s,s,0),o.wnext=s,o.whave=o.wsize):(o.wnext+=n,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=n))),0}i.inflateReset=c,i.inflateReset2=u,i.inflateResetKeep=d,i.inflateInit=function(e){return p(e,15)},i.inflateInit2=p,i.inflate=function(e,t){var i,h,d,c,u,p,_,g,m,C,y,E,b,B,P,S,v,R,I,T,x,O,D,L,F=0,H=new r.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return A;12===(i=e.state).mode&&(i.mode=13),u=e.next_out,d=e.output,_=e.avail_out,c=e.next_in,h=e.input,p=e.avail_in,g=i.hold,m=i.bits,C=p,y=_,O=0;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;m<16;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if(2&i.wrap&&35615===g){H[i.check=0]=255&g,H[1]=g>>>8&255,i.check=n(i.check,H,2,0),m=g=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",i.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",i.mode=30;break}if(m-=4,x=8+(15&(g>>>=4)),0===i.wbits)i.wbits=x;else if(x>i.wbits){e.msg="invalid window size",i.mode=30;break}i.dmax=1<<x,e.adler=i.check=1,i.mode=512&g?10:12,m=g=0;break;case 2:for(;m<16;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if(i.flags=g,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=g>>8&1),512&i.flags&&(H[0]=255&g,H[1]=g>>>8&255,i.check=n(i.check,H,2,0)),m=g=0,i.mode=3;case 3:for(;m<32;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}i.head&&(i.head.time=g),512&i.flags&&(H[0]=255&g,H[1]=g>>>8&255,H[2]=g>>>16&255,H[3]=g>>>24&255,i.check=n(i.check,H,4,0)),m=g=0,i.mode=4;case 4:for(;m<16;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}i.head&&(i.head.xflags=255&g,i.head.os=g>>8),512&i.flags&&(H[0]=255&g,H[1]=g>>>8&255,i.check=n(i.check,H,2,0)),m=g=0,i.mode=5;case 5:if(1024&i.flags){for(;m<16;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}i.length=g,i.head&&(i.head.extra_len=g),512&i.flags&&(H[0]=255&g,H[1]=g>>>8&255,i.check=n(i.check,H,2,0)),m=g=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(p<(E=i.length)&&(E=p),E&&(i.head&&(x=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),r.arraySet(i.head.extra,h,c,E,x)),512&i.flags&&(i.check=n(i.check,h,E,c)),p-=E,c+=E,i.length-=E),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===p)break e;for(E=0;x=h[c+E++],i.head&&x&&i.length<65536&&(i.head.name+=String.fromCharCode(x)),x&&E<p;);if(512&i.flags&&(i.check=n(i.check,h,E,c)),p-=E,c+=E,x)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===p)break e;for(E=0;x=h[c+E++],i.head&&x&&i.length<65536&&(i.head.comment+=String.fromCharCode(x)),x&&E<p;);if(512&i.flags&&(i.check=n(i.check,h,E,c)),p-=E,c+=E,x)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;m<16;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if(g!==(65535&i.check)){e.msg="header crc mismatch",i.mode=30;break}m=g=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=12;break;case 10:for(;m<32;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}e.adler=i.check=l(g),m=g=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=u,e.avail_out=_,e.next_in=c,e.avail_in=p,i.hold=g,i.bits=m,2;e.adler=i.check=1,i.mode=12;case 12:if(5===t||6===t)break e;case 13:if(i.last){g>>>=7&m,m-=7&m,i.mode=27;break}for(;m<3;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}switch(i.last=1&g,m-=1,3&(g>>>=1)){case 0:i.mode=14;break;case 1:if(f(i),i.mode=20,6!==t)break;g>>>=2,m-=2;break e;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=30}g>>>=2,m-=2;break;case 14:for(g>>>=7&m,m-=7&m;m<32;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&g,m=g=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(E=i.length){if(p<E&&(E=p),_<E&&(E=_),0===E)break e;r.arraySet(d,h,c,E,u),p-=E,c+=E,_-=E,u+=E,i.length-=E;break}i.mode=12;break;case 17:for(;m<14;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if(i.nlen=257+(31&g),g>>>=5,m-=5,i.ndist=1+(31&g),g>>>=5,m-=5,i.ncode=4+(15&g),g>>>=4,m-=4,286<i.nlen||30<i.ndist){e.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;m<3;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}i.lens[N[i.have++]]=7&g,g>>>=3,m-=3}for(;i.have<19;)i.lens[N[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,D={bits:i.lenbits},O=a(0,i.lens,0,19,i.lencode,0,i.work,D),i.lenbits=D.bits,O){e.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;S=(F=i.lencode[g&(1<<i.lenbits)-1])>>>16&255,v=65535&F,!((P=F>>>24)<=m);){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if(v<16)g>>>=P,m-=P,i.lens[i.have++]=v;else{if(16===v){for(L=P+2;m<L;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if(g>>>=P,m-=P,0===i.have){e.msg="invalid bit length repeat",i.mode=30;break}x=i.lens[i.have-1],E=3+(3&g),g>>>=2,m-=2}else if(17===v){for(L=P+3;m<L;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}m-=P,x=0,E=3+(7&(g>>>=P)),g>>>=3,m-=3}else{for(L=P+7;m<L;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}m-=P,x=0,E=11+(127&(g>>>=P)),g>>>=7,m-=7}if(i.have+E>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=30;break}for(;E--;)i.lens[i.have++]=x}}if(30===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,D={bits:i.lenbits},O=a(1,i.lens,0,i.nlen,i.lencode,0,i.work,D),i.lenbits=D.bits,O){e.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,D={bits:i.distbits},O=a(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,D),i.distbits=D.bits,O){e.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(6<=p&&258<=_){e.next_out=u,e.avail_out=_,e.next_in=c,e.avail_in=p,i.hold=g,i.bits=m,o(e,y),u=e.next_out,d=e.output,_=e.avail_out,c=e.next_in,h=e.input,p=e.avail_in,g=i.hold,m=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;S=(F=i.lencode[g&(1<<i.lenbits)-1])>>>16&255,v=65535&F,!((P=F>>>24)<=m);){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if(S&&0==(240&S)){for(R=P,I=S,T=v;S=(F=i.lencode[T+((g&(1<<R+I)-1)>>R)])>>>16&255,v=65535&F,!(R+(P=F>>>24)<=m);){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}g>>>=R,m-=R,i.back+=R}if(g>>>=P,m-=P,i.back+=P,i.length=v,0===S){i.mode=26;break}if(32&S){i.back=-1,i.mode=12;break}if(64&S){e.msg="invalid literal/length code",i.mode=30;break}i.extra=15&S,i.mode=22;case 22:if(i.extra){for(L=i.extra;m<L;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}i.length+=g&(1<<i.extra)-1,g>>>=i.extra,m-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;S=(F=i.distcode[g&(1<<i.distbits)-1])>>>16&255,v=65535&F,!((P=F>>>24)<=m);){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if(0==(240&S)){for(R=P,I=S,T=v;S=(F=i.distcode[T+((g&(1<<R+I)-1)>>R)])>>>16&255,v=65535&F,!(R+(P=F>>>24)<=m);){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}g>>>=R,m-=R,i.back+=R}if(g>>>=P,m-=P,i.back+=P,64&S){e.msg="invalid distance code",i.mode=30;break}i.offset=v,i.extra=15&S,i.mode=24;case 24:if(i.extra){for(L=i.extra;m<L;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}i.offset+=g&(1<<i.extra)-1,g>>>=i.extra,m-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===_)break e;if(E=y-_,i.offset>E){if((E=i.offset-E)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=30;break}b=E>i.wnext?(E-=i.wnext,i.wsize-E):i.wnext-E,E>i.length&&(E=i.length),B=i.window}else B=d,b=u-i.offset,E=i.length;for(_<E&&(E=_),_-=E,i.length-=E;d[u++]=B[b++],--E;);0===i.length&&(i.mode=21);break;case 26:if(0===_)break e;d[u++]=i.length,_--,i.mode=21;break;case 27:if(i.wrap){for(;m<32;){if(0===p)break e;p--,g|=h[c++]<<m,m+=8}if(y-=_,e.total_out+=y,i.total+=y,y&&(e.adler=i.check=i.flags?n(i.check,d,y,u-y):s(i.check,d,y,u-y)),y=_,(i.flags?g:l(g))!==i.check){e.msg="incorrect data check",i.mode=30;break}m=g=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;m<32;){if(0===p)break e;p--,g+=h[c++]<<m,m+=8}if(g!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=30;break}m=g=0}i.mode=29;case 29:O=1;break e;case 30:O=-3;break e;case 31:return-4;default:return A}return e.next_out=u,e.avail_out=_,e.next_in=c,e.avail_in=p,i.hold=g,i.bits=m,(i.wsize||y!==e.avail_out&&i.mode<30&&(i.mode<27||4!==t))&&w(e,e.output,e.next_out,y-e.avail_out)?(i.mode=31,-4):(C-=e.avail_in,y-=e.avail_out,e.total_in+=C,e.total_out+=y,i.total+=y,i.wrap&&y&&(e.adler=i.check=i.flags?n(i.check,d,y,e.next_out-y):s(i.check,d,y,e.next_out-y)),e.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0==C&&0===y||4===t)&&0===O&&(O=-5),O)},i.inflateEnd=function(e){if(!e||!e.state)return A;var t=e.state;return t.window&&(t.window=null),e.state=null,0},i.inflateGetHeader=function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?A:((i.head=t).done=!1,0):A},i.inflateSetDictionary=function(e,t){var i,r=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?A:11===i.mode&&s(1,t,r,0)!==i.check?-3:w(e,t,r,r)?(i.mode=31,-4):(i.havedict=1,0):A},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,i){var r=e("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,A,l,h,d,c){var u,p,_,g,m,f,w,C,y,E=c.bits,b=0,B=0,P=0,S=0,v=0,R=0,I=0,T=0,x=0,O=0,D=null,L=0,F=new r.Buf16(16),H=new r.Buf16(16),N=null,U=0;for(b=0;b<=15;b++)F[b]=0;for(B=0;B<A;B++)F[t[i+B]]++;for(v=E,S=15;1<=S&&0===F[S];S--);if(S<v&&(v=S),0===S)return l[h++]=20971520,l[h++]=20971520,c.bits=1,0;for(P=1;P<S&&0===F[P];P++);for(v<P&&(v=P),b=T=1;b<=15;b++)if(T<<=1,(T-=F[b])<0)return-1;if(0<T&&(0===e||1!==S))return-1;for(H[1]=0,b=1;b<15;b++)H[b+1]=H[b]+F[b];for(B=0;B<A;B++)0!==t[i+B]&&(d[H[t[i+B]]++]=B);if(f=0===e?(D=N=d,19):1===e?(D=s,L-=257,N=n,U-=257,256):(D=o,N=a,-1),b=P,m=h,I=B=O=0,_=-1,g=(x=1<<(R=v))-1,1===e&&852<x||2===e&&592<x)return 1;for(;;){for(w=b-I,y=d[B]<f?(C=0,d[B]):d[B]>f?(C=N[U+d[B]],D[L+d[B]]):(C=96,0),u=1<<b-I,P=p=1<<R;l[m+(O>>I)+(p-=u)]=w<<24|C<<16|y|0,0!==p;);for(u=1<<b-1;O&u;)u>>=1;if(0!==u?(O&=u-1,O+=u):O=0,B++,0==--F[b]){if(b===S)break;b=t[i+d[B]]}if(v<b&&(O&g)!==_){for(0===I&&(I=v),m+=P,T=1<<(R=b-I);R+I<S&&!((T-=F[R+I])<=0);)R++,T<<=1;if(x+=1<<R,1===e&&852<x||2===e&&592<x)return 1;l[_=O&g]=v<<24|R<<16|m-h|0}}return 0!==O&&(l[m+O]=b-I<<24|64<<16|0),c.bits=v,0}},{"../utils/common":41}],51:[function(e,t,i){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,i){var r=e("../utils/common");function s(e){for(var t=e.length;0<=--t;)e[t]=0}var n=256,o=286,a=30,A=15,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],h=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);s(u);var p=new Array(60);s(p);var _=new Array(512);s(_);var g=new Array(256);s(g);var m=new Array(29);s(m);var f,w,C,y=new Array(a);function E(e,t,i,r,s){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=s,this.has_stree=e&&e.length}function b(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function B(e){return e<256?_[e]:_[256+(e>>>7)]}function P(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function S(e,t,i){e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,P(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function v(e,t,i){S(e,i[2*t],i[2*t+1])}function R(e,t){for(var i=0;i|=1&e,e>>>=1,i<<=1,0<--t;);return i>>>1}function I(e,t,i){var r,s,n=new Array(16),o=0;for(r=1;r<=A;r++)n[r]=o=o+i[r-1]<<1;for(s=0;s<=t;s++){var a=e[2*s+1];0!==a&&(e[2*s]=R(n[a]++,a))}}function T(e){var t;for(t=0;t<o;t++)e.dyn_ltree[2*t]=0;for(t=0;t<a;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function x(e){8<e.bi_valid?P(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function O(e,t,i,r){var s=2*t,n=2*i;return e[s]<e[n]||e[s]===e[n]&&r[t]<=r[i]}function D(e,t,i){for(var r=e.heap[i],s=i<<1;s<=e.heap_len&&(s<e.heap_len&&O(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!O(t,r,e.heap[s],e.depth));)e.heap[i]=e.heap[s],i=s,s<<=1;e.heap[i]=r}function L(e,t,i){var r,s,o,a,A=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*A]<<8|e.pending_buf[e.d_buf+2*A+1],s=e.pending_buf[e.l_buf+A],A++,0===r?v(e,s,t):(v(e,(o=g[s])+n+1,t),0!==(a=l[o])&&S(e,s-=m[o],a),v(e,o=B(--r),i),0!==(a=h[o])&&S(e,r-=y[o],a)),A<e.last_lit;);v(e,256,t)}function F(e,t){var i,r,s,n=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<l;i++)0!==n[2*i]?(e.heap[++e.heap_len]=h=i,e.depth[i]=0):n[2*i+1]=0;for(;e.heap_len<2;)n[2*(s=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[s]=0,e.opt_len--,a&&(e.static_len-=o[2*s+1]);for(t.max_code=h,i=e.heap_len>>1;1<=i;i--)D(e,n,i);for(s=l;i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],D(e,n,1),r=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=r,n[2*s]=n[2*i]+n[2*r],e.depth[s]=(e.depth[i]>=e.depth[r]?e.depth[i]:e.depth[r])+1,n[2*i+1]=n[2*r+1]=s,e.heap[1]=s++,D(e,n,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,r,s,n,o,a,l=t.dyn_tree,h=t.max_code,d=t.stat_desc.static_tree,c=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,_=t.stat_desc.max_length,g=0;for(n=0;n<=A;n++)e.bl_count[n]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<573;i++)_<(n=l[2*l[2*(r=e.heap[i])+1]+1]+1)&&(n=_,g++),l[2*r+1]=n,h<r||(e.bl_count[n]++,o=0,p<=r&&(o=u[r-p]),a=l[2*r],e.opt_len+=a*(n+o),c&&(e.static_len+=a*(d[2*r+1]+o)));if(0!==g){do{for(n=_-1;0===e.bl_count[n];)n--;e.bl_count[n]--,e.bl_count[n+1]+=2,e.bl_count[_]--,g-=2}while(0<g);for(n=_;0!==n;n--)for(r=e.bl_count[n];0!==r;)h<(s=e.heap[--i])||(l[2*s+1]!==n&&(e.opt_len+=(n-l[2*s+1])*l[2*s],l[2*s+1]=n),r--)}}(e,t),I(n,h,e.bl_count)}function H(e,t,i){var r,s,n=-1,o=t[1],a=0,A=7,l=4;for(0===o&&(A=138,l=3),t[2*(i+1)+1]=65535,r=0;r<=i;r++)s=o,o=t[2*(r+1)+1],++a<A&&s===o||(a<l?e.bl_tree[2*s]+=a:0!==s?(s!==n&&e.bl_tree[2*s]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,n=s,l=(a=0)===o?(A=138,3):s===o?(A=6,3):(A=7,4))}function N(e,t,i){var r,s,n=-1,o=t[1],a=0,A=7,l=4;for(0===o&&(A=138,l=3),r=0;r<=i;r++)if(s=o,o=t[2*(r+1)+1],!(++a<A&&s===o)){if(a<l)for(;v(e,s,e.bl_tree),0!=--a;);else 0!==s?(s!==n&&(v(e,s,e.bl_tree),a--),v(e,16,e.bl_tree),S(e,a-3,2)):a<=10?(v(e,17,e.bl_tree),S(e,a-3,3)):(v(e,18,e.bl_tree),S(e,a-11,7));n=s,l=(a=0)===o?(A=138,3):s===o?(A=6,3):(A=7,4)}}s(y);var U=!1;function M(e,t,i,s){S(e,0+(s?1:0),3),function(e,t,i,s){x(e),P(e,i),P(e,~i),r.arraySet(e.pending_buf,e.window,t,i,e.pending),e.pending+=i}(e,t,i)}i._tr_init=function(e){U||(function(){var e,t,i,r,s,n=new Array(16);for(r=i=0;r<28;r++)for(m[r]=i,e=0;e<1<<l[r];e++)g[i++]=r;for(g[i-1]=r,r=s=0;r<16;r++)for(y[r]=s,e=0;e<1<<h[r];e++)_[s++]=r;for(s>>=7;r<a;r++)for(y[r]=s<<7,e=0;e<1<<h[r]-7;e++)_[256+s++]=r;for(t=0;t<=A;t++)n[t]=0;for(e=0;e<=143;)u[2*e+1]=8,e++,n[8]++;for(;e<=255;)u[2*e+1]=9,e++,n[9]++;for(;e<=279;)u[2*e+1]=7,e++,n[7]++;for(;e<=287;)u[2*e+1]=8,e++,n[8]++;for(I(u,287,n),e=0;e<a;e++)p[2*e+1]=5,p[2*e]=R(e,5);f=new E(u,l,257,o,A),w=new E(p,h,0,a,A),C=new E(new Array(0),d,0,19,7)}(),U=!0),e.l_desc=new b(e.dyn_ltree,f),e.d_desc=new b(e.dyn_dtree,w),e.bl_desc=new b(e.bl_tree,C),e.bi_buf=0,e.bi_valid=0,T(e)},i._tr_stored_block=M,i._tr_flush_block=function(e,t,i,r){var s,o,a=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<n;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),F(e,e.l_desc),F(e,e.d_desc),a=function(e){var t;for(H(e,e.dyn_ltree,e.l_desc.max_code),H(e,e.dyn_dtree,e.d_desc.max_code),F(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*c[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),s=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=s&&(s=o)):s=o=i+5,i+4<=s&&-1!==t?M(e,t,i,r):4===e.strategy||o===s?(S(e,2+(r?1:0),3),L(e,u,p)):(S(e,4+(r?1:0),3),function(e,t,i,r){var s;for(S(e,t-257,5),S(e,i-1,5),S(e,r-4,4),s=0;s<r;s++)S(e,e.bl_tree[2*c[s]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),L(e,e.dyn_ltree,e.dyn_dtree)),T(e),r&&x(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(g[i]+n+1)]++,e.dyn_dtree[2*B(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){S(e,2,3),v(e,256,u),function(e){16===e.bi_valid?(P(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,i){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){t.exports="function"==typeof setImmediate?setImmediate:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}},{}]},{},[10])(10)},155:e=>{var t,i,r=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{i="function"==typeof clearTimeout?clearTimeout:n}catch(e){i=n}}();var a,A=[],l=!1,h=-1;function d(){l&&a&&(l=!1,a.length?A=a.concat(A):h=-1,A.length&&c())}function c(){if(!l){var e=o(d);l=!0;for(var t=A.length;t;){for(a=A,A=[];++h<t;)a&&a[h].run();h=-1,t=A.length}a=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===n||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function u(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];A.push(new u(e,t)),1!==A.length||l||o(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},509:(e,t,i)=>{var r=i(764),s=r.Buffer;function n(e,t){for(var i in e)t[i]=e[i]}function o(e,t,i){return s(e,t,i)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=r:(n(r,t),t.Buffer=o),n(s,o),o.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,i)},o.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=s(e);return void 0!==t?"string"==typeof i?r.fill(t,i):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},99:(e,t,i)=>{!function(e){e.parser=function(e,t){return new s(e,t)},e.SAXParser=s,e.SAXStream=o,e.createStream=function(e,t){return new o(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function s(t,i){if(!(this instanceof s))return new s(t,i);var n=this;!function(e){for(var t=0,i=r.length;t<i;t++)e[r[t]]=""}(n),n.q=n.c="",n.bufferCheckPosition=e.MAX_BUFFER_LENGTH,n.opt=i||{},n.opt.lowercase=n.opt.lowercase||n.opt.lowercasetags,n.looseCase=n.opt.lowercase?"toLowerCase":"toUpperCase",n.tags=[],n.closed=n.closedRoot=n.sawRoot=!1,n.tag=n.error=null,n.strict=!!t,n.noscript=!(!t&&!n.opt.noscript),n.state=E.BEGIN,n.strictEntities=n.opt.strictEntities,n.ENTITIES=n.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),n.attribList=[],n.opt.xmlns&&(n.ns=Object.create(l)),n.trackPosition=!1!==n.opt.position,n.trackPosition&&(n.position=n.line=n.column=0),B(n,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}),s.prototype={end:function(){I(this)},write:function(t){var i=this;if(this.error)throw this.error;if(i.closed)return R(i,"Cannot write after close. Assign an onready handler.");if(null===t)return I(i);"object"==typeof t&&(t=t.toString());for(var s=0,n="";n=U(t,s++),i.c=n,n;)switch(i.trackPosition&&(i.position++,"\n"===n?(i.line++,i.column=0):i.column++),i.state){case E.BEGIN:if(i.state=E.BEGIN_WHITESPACE,"\ufeff"===n)continue;N(i,n);continue;case E.BEGIN_WHITESPACE:N(i,n);continue;case E.TEXT:if(i.sawRoot&&!i.closedRoot){for(var o=s-1;n&&"<"!==n&&"&"!==n;)(n=U(t,s++))&&i.trackPosition&&(i.position++,"\n"===n?(i.line++,i.column=0):i.column++);i.textNode+=t.substring(o,s-1)}"<"!==n||i.sawRoot&&i.closedRoot&&!i.strict?(p(n)||i.sawRoot&&!i.closedRoot||T(i,"Text data outside of root node."),"&"===n?i.state=E.TEXT_ENTITY:i.textNode+=n):(i.state=E.OPEN_WAKA,i.startTagPosition=i.position);continue;case E.SCRIPT:"<"===n?i.state=E.SCRIPT_ENDING:i.script+=n;continue;case E.SCRIPT_ENDING:"/"===n?i.state=E.CLOSE_TAG:(i.script+="<"+n,i.state=E.SCRIPT);continue;case E.OPEN_WAKA:if("!"===n)i.state=E.SGML_DECL,i.sgmlDecl="";else if(p(n));else if(m(h,n))i.state=E.OPEN_TAG,i.tagName=n;else if("/"===n)i.state=E.CLOSE_TAG,i.tagName="";else if("?"===n)i.state=E.PROC_INST,i.procInstName=i.procInstBody="";else{if(T(i,"Unencoded <"),i.startTagPosition+1<i.position){var a=i.position-i.startTagPosition;n=new Array(a).join(" ")+n}i.textNode+="<"+n,i.state=E.TEXT}continue;case E.SGML_DECL:"[CDATA["===(i.sgmlDecl+n).toUpperCase()?(P(i,"onopencdata"),i.state=E.CDATA,i.sgmlDecl="",i.cdata=""):i.sgmlDecl+n==="--"?(i.state=E.COMMENT,i.comment="",i.sgmlDecl=""):"DOCTYPE"===(i.sgmlDecl+n).toUpperCase()?(i.state=E.DOCTYPE,(i.doctype||i.sawRoot)&&T(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):">"===n?(P(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=E.TEXT):_(n)?(i.state=E.SGML_DECL_QUOTED,i.sgmlDecl+=n):i.sgmlDecl+=n;continue;case E.SGML_DECL_QUOTED:n===i.q&&(i.state=E.SGML_DECL,i.q=""),i.sgmlDecl+=n;continue;case E.DOCTYPE:">"===n?(i.state=E.TEXT,P(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=n,"["===n?i.state=E.DOCTYPE_DTD:_(n)&&(i.state=E.DOCTYPE_QUOTED,i.q=n));continue;case E.DOCTYPE_QUOTED:i.doctype+=n,n===i.q&&(i.q="",i.state=E.DOCTYPE);continue;case E.DOCTYPE_DTD:i.doctype+=n,"]"===n?i.state=E.DOCTYPE:_(n)&&(i.state=E.DOCTYPE_DTD_QUOTED,i.q=n);continue;case E.DOCTYPE_DTD_QUOTED:i.doctype+=n,n===i.q&&(i.state=E.DOCTYPE_DTD,i.q="");continue;case E.COMMENT:"-"===n?i.state=E.COMMENT_ENDING:i.comment+=n;continue;case E.COMMENT_ENDING:"-"===n?(i.state=E.COMMENT_ENDED,i.comment=v(i.opt,i.comment),i.comment&&P(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+n,i.state=E.COMMENT);continue;case E.COMMENT_ENDED:">"!==n?(T(i,"Malformed comment"),i.comment+="--"+n,i.state=E.COMMENT):i.state=E.TEXT;continue;case E.CDATA:"]"===n?i.state=E.CDATA_ENDING:i.cdata+=n;continue;case E.CDATA_ENDING:"]"===n?i.state=E.CDATA_ENDING_2:(i.cdata+="]"+n,i.state=E.CDATA);continue;case E.CDATA_ENDING_2:">"===n?(i.cdata&&P(i,"oncdata",i.cdata),P(i,"onclosecdata"),i.cdata="",i.state=E.TEXT):"]"===n?i.cdata+="]":(i.cdata+="]]"+n,i.state=E.CDATA);continue;case E.PROC_INST:"?"===n?i.state=E.PROC_INST_ENDING:p(n)?i.state=E.PROC_INST_BODY:i.procInstName+=n;continue;case E.PROC_INST_BODY:if(!i.procInstBody&&p(n))continue;"?"===n?i.state=E.PROC_INST_ENDING:i.procInstBody+=n;continue;case E.PROC_INST_ENDING:">"===n?(P(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=E.TEXT):(i.procInstBody+="?"+n,i.state=E.PROC_INST_BODY);continue;case E.OPEN_TAG:m(d,n)?i.tagName+=n:(x(i),">"===n?L(i):"/"===n?i.state=E.OPEN_TAG_SLASH:(p(n)||T(i,"Invalid character in tag name"),i.state=E.ATTRIB));continue;case E.OPEN_TAG_SLASH:">"===n?(L(i,!0),F(i)):(T(i,"Forward-slash in opening tag not followed by >"),i.state=E.ATTRIB);continue;case E.ATTRIB:if(p(n))continue;">"===n?L(i):"/"===n?i.state=E.OPEN_TAG_SLASH:m(h,n)?(i.attribName=n,i.attribValue="",i.state=E.ATTRIB_NAME):T(i,"Invalid attribute name");continue;case E.ATTRIB_NAME:"="===n?i.state=E.ATTRIB_VALUE:">"===n?(T(i,"Attribute without value"),i.attribValue=i.attribName,D(i),L(i)):p(n)?i.state=E.ATTRIB_NAME_SAW_WHITE:m(d,n)?i.attribName+=n:T(i,"Invalid attribute name");continue;case E.ATTRIB_NAME_SAW_WHITE:if("="===n)i.state=E.ATTRIB_VALUE;else{if(p(n))continue;T(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",P(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",">"===n?L(i):m(h,n)?(i.attribName=n,i.state=E.ATTRIB_NAME):(T(i,"Invalid attribute name"),i.state=E.ATTRIB)}continue;case E.ATTRIB_VALUE:if(p(n))continue;_(n)?(i.q=n,i.state=E.ATTRIB_VALUE_QUOTED):(T(i,"Unquoted attribute value"),i.state=E.ATTRIB_VALUE_UNQUOTED,i.attribValue=n);continue;case E.ATTRIB_VALUE_QUOTED:if(n!==i.q){"&"===n?i.state=E.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=n;continue}D(i),i.q="",i.state=E.ATTRIB_VALUE_CLOSED;continue;case E.ATTRIB_VALUE_CLOSED:p(n)?i.state=E.ATTRIB:">"===n?L(i):"/"===n?i.state=E.OPEN_TAG_SLASH:m(h,n)?(T(i,"No whitespace between attributes"),i.attribName=n,i.attribValue="",i.state=E.ATTRIB_NAME):T(i,"Invalid attribute name");continue;case E.ATTRIB_VALUE_UNQUOTED:if(!g(n)){"&"===n?i.state=E.ATTRIB_VALUE_ENTITY_U:i.attribValue+=n;continue}D(i),">"===n?L(i):i.state=E.ATTRIB;continue;case E.CLOSE_TAG:if(i.tagName)">"===n?F(i):m(d,n)?i.tagName+=n:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=E.SCRIPT):(p(n)||T(i,"Invalid tagname in closing tag"),i.state=E.CLOSE_TAG_SAW_WHITE);else{if(p(n))continue;f(h,n)?i.script?(i.script+="</"+n,i.state=E.SCRIPT):T(i,"Invalid tagname in closing tag."):i.tagName=n}continue;case E.CLOSE_TAG_SAW_WHITE:if(p(n))continue;">"===n?F(i):T(i,"Invalid characters in closing tag");continue;case E.TEXT_ENTITY:case E.ATTRIB_VALUE_ENTITY_Q:case E.ATTRIB_VALUE_ENTITY_U:var A,l;switch(i.state){case E.TEXT_ENTITY:A=E.TEXT,l="textNode";break;case E.ATTRIB_VALUE_ENTITY_Q:A=E.ATTRIB_VALUE_QUOTED,l="attribValue";break;case E.ATTRIB_VALUE_ENTITY_U:A=E.ATTRIB_VALUE_UNQUOTED,l="attribValue"}";"===n?(i[l]+=H(i),i.entity="",i.state=A):m(i.entity.length?u:c,n)?i.entity+=n:(T(i,"Invalid character in entity name"),i[l]+="&"+i.entity+n,i.entity="",i.state=A);continue;default:throw new Error(i,"Unknown state: "+i.state)}return i.position>=i.bufferCheckPosition&&function(t){for(var i=Math.max(e.MAX_BUFFER_LENGTH,10),s=0,n=0,o=r.length;n<o;n++){var a=t[r[n]].length;if(a>i)switch(r[n]){case"textNode":S(t);break;case"cdata":P(t,"oncdata",t.cdata),t.cdata="";break;case"script":P(t,"onscript",t.script),t.script="";break;default:R(t,"Max buffer length exceeded: "+r[n])}s=Math.max(s,a)}var A=e.MAX_BUFFER_LENGTH-s;t.bufferCheckPosition=A+t.position}(i),i},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;S(e=this),""!==e.cdata&&(P(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(P(e,"onscript",e.script),e.script="")}};try{t=i(830).Stream}catch(e){t=function(){}}var n=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function o(e,i){if(!(this instanceof o))return new o(e,i);t.apply(this),this._parser=new s(e,i),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,n.forEach((function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t)},enumerable:!0,configurable:!1})}))}o.prototype=Object.create(t.prototype,{constructor:{value:o}}),o.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=i(553).s;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(e,i){var r=this;return r._parser["on"+e]||-1===n.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),t.prototype.on.call(r,e,i)};var a="http://www.w3.org/XML/1998/namespace",A="http://www.w3.org/2000/xmlns/",l={xml:a,xmlns:A},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,c=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,u=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function p(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function _(e){return'"'===e||"'"===e}function g(e){return">"===e||p(e)}function m(e,t){return e.test(t)}function f(e,t){return!m(e,t)}var w,C,y,E=0;for(var b in e.STATE={BEGIN:E++,BEGIN_WHITESPACE:E++,TEXT:E++,TEXT_ENTITY:E++,OPEN_WAKA:E++,SGML_DECL:E++,SGML_DECL_QUOTED:E++,DOCTYPE:E++,DOCTYPE_QUOTED:E++,DOCTYPE_DTD:E++,DOCTYPE_DTD_QUOTED:E++,COMMENT_STARTING:E++,COMMENT:E++,COMMENT_ENDING:E++,COMMENT_ENDED:E++,CDATA:E++,CDATA_ENDING:E++,CDATA_ENDING_2:E++,PROC_INST:E++,PROC_INST_BODY:E++,PROC_INST_ENDING:E++,OPEN_TAG:E++,OPEN_TAG_SLASH:E++,ATTRIB:E++,ATTRIB_NAME:E++,ATTRIB_NAME_SAW_WHITE:E++,ATTRIB_VALUE:E++,ATTRIB_VALUE_QUOTED:E++,ATTRIB_VALUE_CLOSED:E++,ATTRIB_VALUE_UNQUOTED:E++,ATTRIB_VALUE_ENTITY_Q:E++,ATTRIB_VALUE_ENTITY_U:E++,CLOSE_TAG:E++,CLOSE_TAG_SAW_WHITE:E++,SCRIPT:E++,SCRIPT_ENDING:E++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var i=e.ENTITIES[t],r="number"==typeof i?String.fromCharCode(i):i;e.ENTITIES[t]=r})),e.STATE)e.STATE[e.STATE[b]]=b;function B(e,t,i){e[t]&&e[t](i)}function P(e,t,i){e.textNode&&S(e),B(e,t,i)}function S(e){e.textNode=v(e.opt,e.textNode),e.textNode&&B(e,"ontext",e.textNode),e.textNode=""}function v(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function R(e,t){return S(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,B(e,"onerror",t),e}function I(e){return e.sawRoot&&!e.closedRoot&&T(e,"Unclosed root tag"),e.state!==E.BEGIN&&e.state!==E.BEGIN_WHITESPACE&&e.state!==E.TEXT&&R(e,"Unexpected end"),S(e),e.c="",e.closed=!0,B(e,"onend"),s.call(e,e.strict,e.opt),e}function T(e,t){if("object"!=typeof e||!(e instanceof s))throw new Error("bad call to strictFail");e.strict&&R(e,t)}function x(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,i=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(i.ns=t.ns),e.attribList.length=0,P(e,"onopentagstart",i)}function O(e,t){var i=e.indexOf(":")<0?["",e]:e.split(":"),r=i[0],s=i[1];return t&&"xmlns"===e&&(r="xmlns",s=""),{prefix:r,local:s}}function D(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=O(e.attribName,!0),i=t.prefix,r=t.local;if("xmlns"===i)if("xml"===r&&e.attribValue!==a)T(e,"xml: prefix must be bound to "+a+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==A)T(e,"xmlns: prefix must be bound to "+A+"\nActual: "+e.attribValue);else{var s=e.tag,n=e.tags[e.tags.length-1]||e;s.ns===n.ns&&(s.ns=Object.create(n.ns)),s.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,P(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function L(e,t){if(e.opt.xmlns){var i=e.tag,r=O(e.tagName);i.prefix=r.prefix,i.local=r.local,i.uri=i.ns[r.prefix]||"",i.prefix&&!i.uri&&(T(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),i.uri=r.prefix);var s=e.tags[e.tags.length-1]||e;i.ns&&s.ns!==i.ns&&Object.keys(i.ns).forEach((function(t){P(e,"onopennamespace",{prefix:t,uri:i.ns[t]})}));for(var n=0,o=e.attribList.length;n<o;n++){var a=e.attribList[n],A=a[0],l=a[1],h=O(A,!0),d=h.prefix,c=h.local,u=""===d?"":i.ns[d]||"",p={name:A,value:l,prefix:d,local:c,uri:u};d&&"xmlns"!==d&&!u&&(T(e,"Unbound namespace prefix: "+JSON.stringify(d)),p.uri=d),e.tag.attributes[A]=p,P(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),P(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=E.TEXT:e.state=E.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function F(e){if(!e.tagName)return T(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=E.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=E.SCRIPT);P(e,"onscript",e.script),e.script=""}var t=e.tags.length,i=e.tagName;e.strict||(i=i[e.looseCase]());for(var r=i;t--&&e.tags[t].name!==r;)T(e,"Unexpected close tag");if(t<0)return T(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=E.TEXT);e.tagName=i;for(var s=e.tags.length;s-- >t;){var n=e.tag=e.tags.pop();e.tagName=e.tag.name,P(e,"onclosetag",e.tagName);var o={};for(var a in n.ns)o[a]=n.ns[a];var A=e.tags[e.tags.length-1]||e;e.opt.xmlns&&n.ns!==A.ns&&Object.keys(n.ns).forEach((function(t){var i=n.ns[t];P(e,"onclosenamespace",{prefix:t,uri:i})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=E.TEXT}function H(e){var t,i=e.entity,r=i.toLowerCase(),s="";return e.ENTITIES[i]?e.ENTITIES[i]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(i=r).charAt(0)&&("x"===i.charAt(1)?(i=i.slice(2),s=(t=parseInt(i,16)).toString(16)):(i=i.slice(1),s=(t=parseInt(i,10)).toString(10))),i=i.replace(/^0+/,""),isNaN(t)||s.toLowerCase()!==i?(T(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function N(e,t){"<"===t?(e.state=E.OPEN_WAKA,e.startTagPosition=e.position):p(t)||(T(e,"Non-whitespace before first tag."),e.textNode=t,e.state=E.TEXT)}function U(e,t){var i="";return t<e.length&&(i=e.charAt(t)),i}E=e.STATE,String.fromCodePoint||(w=String.fromCharCode,C=Math.floor,y=function(){var e,t,i=16384,r=[],s=-1,n=arguments.length;if(!n)return"";for(var o="";++s<n;){var a=Number(arguments[s]);if(!isFinite(a)||a<0||a>1114111||C(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?r.push(a):(e=55296+((a-=65536)>>10),t=a%1024+56320,r.push(e,t)),(s+1===n||r.length>i)&&(o+=w.apply(null,r),r.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:y,configurable:!0,writable:!0}):String.fromCodePoint=y)}(t)},830:(e,t,i)=>{e.exports=s;var r=i(187).EventEmitter;function s(){r.call(this)}i(717)(s,r),s.Readable=i(577),s.Writable=i(323),s.Duplex=i(656),s.Transform=i(473),s.PassThrough=i(366),s.finished=i(86),s.pipeline=i(472),s.Stream=s,s.prototype.pipe=function(e,t){var i=this;function s(t){e.writable&&!1===e.write(t)&&i.pause&&i.pause()}function n(){i.readable&&i.resume&&i.resume()}i.on("data",s),e.on("drain",n),e._isStdio||t&&!1===t.end||(i.on("end",a),i.on("close",A));var o=!1;function a(){o||(o=!0,e.end())}function A(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(h(),0===r.listenerCount(this,"error"))throw e}function h(){i.removeListener("data",s),e.removeListener("drain",n),i.removeListener("end",a),i.removeListener("close",A),i.removeListener("error",l),e.removeListener("error",l),i.removeListener("end",h),i.removeListener("close",h),e.removeListener("close",h)}return i.on("error",l),e.on("error",l),i.on("end",h),i.on("close",h),e.on("close",h),e.emit("pipe",i),e}},106:e=>{var t={};function i(e,i,r){r||(r=Error);var s=function(e){var t,r;function s(t,r,s){return e.call(this,function(e,t,r){return"string"==typeof i?i:i(e,t,r)}(t,r,s))||this}return r=e,(t=s).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,s}(r);s.prototype.name=r.name,s.prototype.code=e,t[e]=s}function r(e,t){if(Array.isArray(e)){var i=e.length;return e=e.map((function(e){return String(e)})),i>2?"one of ".concat(t," ").concat(e.slice(0,i-1).join(", "),", or ")+e[i-1]:2===i?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,i){var s,n,o,a,A;if("string"==typeof t&&(n="not ",t.substr(0,n.length)===n)?(s="must not be",t=t.replace(/^not /,"")):s="must be",function(e,t,i){return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t}(e," argument"))o="The ".concat(e," ").concat(s," ").concat(r(t,"type"));else{var l=("number"!=typeof A&&(A=0),A+".".length>(a=e).length||-1===a.indexOf(".",A)?"argument":"property");o='The "'.concat(e,'" ').concat(l," ").concat(s," ").concat(r(t,"type"))}return o+". Received type ".concat(typeof i)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},656:(e,t,i)=>{var r=i(155),s=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};e.exports=h;var n=i(577),o=i(323);i(717)(h,n);for(var a=s(o.prototype),A=0;A<a.length;A++){var l=a[A];h.prototype[l]||(h.prototype[l]=o.prototype[l])}function h(e){if(!(this instanceof h))return new h(e);n.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",d)))}function d(){this._writableState.ended||r.nextTick(c,this)}function c(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},366:(e,t,i)=>{e.exports=s;var r=i(473);function s(e){if(!(this instanceof s))return new s(e);r.call(this,e)}i(717)(s,r),s.prototype._transform=function(e,t,i){i(null,e)}},577:(e,t,i)=>{var r,s=i(155);e.exports=P,P.ReadableState=B,i(187).EventEmitter;var n,o=function(e,t){return e.listeners(t).length},a=i(194),A=i(764).Buffer,l=i.g.Uint8Array||function(){},h=i(964);n=h&&h.debuglog?h.debuglog("stream"):function(){};var d,c,u,p=i(686),_=i(29),g=i(94).getHighWaterMark,m=i(106).q,f=m.ERR_INVALID_ARG_TYPE,w=m.ERR_STREAM_PUSH_AFTER_EOF,C=m.ERR_METHOD_NOT_IMPLEMENTED,y=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;i(717)(P,a);var E=_.errorOrDestroy,b=["error","close","destroy","pause","resume"];function B(e,t,s){r=r||i(656),e=e||{},"boolean"!=typeof s&&(s=t instanceof r),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",s),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(d||(d=i(553).s),this.decoder=new d(e.encoding),this.encoding=e.encoding)}function P(e){if(r=r||i(656),!(this instanceof P))return new P(e);var t=this instanceof r;this._readableState=new B(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function S(e,t,i,r,s){n("readableAddChunk",t);var o,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(n("onEofChunk"),!t.ended){if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,t.sync?T(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,x(e)))}}(e,a);else if(s||(o=function(e,t){var i,r;return r=t,A.isBuffer(r)||r instanceof l||"string"==typeof t||void 0===t||e.objectMode||(i=new f("chunk",["string","Buffer","Uint8Array"],t)),i}(a,t)),o)E(e,o);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===A.prototype||(t=function(e){return A.from(e)}(t)),r)a.endEmitted?E(e,new y):v(e,a,t,!0);else if(a.ended)E(e,new w);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!i?(t=a.decoder.write(t),a.objectMode||0!==t.length?v(e,a,t,!1):O(e,a)):v(e,a,t,!1)}else r||(a.reading=!1,O(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function v(e,t,i,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",i)):(t.length+=t.objectMode?1:i.length,r?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&T(e)),O(e,t)}Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),P.prototype.destroy=_.destroy,P.prototype._undestroy=_.undestroy,P.prototype._destroy=function(e,t){t(e)},P.prototype.push=function(e,t){var i,r=this._readableState;return r.objectMode?i=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=A.from(e,t),t=""),i=!0),S(this,e,t,!1,i)},P.prototype.unshift=function(e){return S(this,e,null,!0,!1)},P.prototype.isPaused=function(){return!1===this._readableState.flowing},P.prototype.setEncoding=function(e){d||(d=i(553).s);var t=new d(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,s="";null!==r;)s+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==s&&this._readableState.buffer.push(s),this._readableState.length=s.length,this};var R=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=R?e=R:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function T(e){var t=e._readableState;n("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(n("emitReadable",t.flowing),t.emittedReadable=!0,s.nextTick(x,e))}function x(e){var t=e._readableState;n("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function O(e,t){t.readingMore||(t.readingMore=!0,s.nextTick(D,e,t))}function D(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var i=t.length;if(n("maybeReadMore read 0"),e.read(0),i===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function F(e){n("readable nexttick read 0"),e.read(0)}function H(e,t){n("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(n("flow",t.flowing);t.flowing&&null!==e.read(););}function U(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):i=t.buffer.consume(e,t.decoder),i);var i}function M(e){var t=e._readableState;n("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,s.nextTick(k,t,e))}function k(e,t){if(n("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var i=t._writableState;(!i||i.autoDestroy&&i.finished)&&t.destroy()}}function Q(e,t){for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}P.prototype.read=function(e){n("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return n("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?M(this):T(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&M(this),null;var r,s=t.needReadable;return n("need readable",s),(0===t.length||t.length-e<t.highWaterMark)&&n("length less than watermark",s=!0),t.ended||t.reading?n("reading or ended",s=!1):s&&(n("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(i,t))),null===(r=e>0?U(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&M(this)),null!==r&&this.emit("data",r),r},P.prototype._read=function(e){E(this,new C("_read()"))},P.prototype.pipe=function(e,t){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,n("pipe count=%d opts=%j",r.pipesCount,t);var a=t&&!1===t.end||e===s.stdout||e===s.stderr?_:A;function A(){n("onend"),e.end()}r.endEmitted?s.nextTick(a):i.once("end",a),e.on("unpipe",(function t(s,o){n("onunpipe"),s===i&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,n("cleanup"),e.removeListener("close",u),e.removeListener("finish",p),e.removeListener("drain",l),e.removeListener("error",c),e.removeListener("unpipe",t),i.removeListener("end",A),i.removeListener("end",_),i.removeListener("data",d),h=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}));var l=function(e){return function(){var t=e._readableState;n("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,N(e))}}(i);e.on("drain",l);var h=!1;function d(t){n("ondata");var s=e.write(t);n("dest.write",s),!1===s&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==Q(r.pipes,e))&&!h&&(n("false write response, pause",r.awaitDrain),r.awaitDrain++),i.pause())}function c(t){n("onerror",t),_(),e.removeListener("error",c),0===o(e,"error")&&E(e,t)}function u(){e.removeListener("finish",p),_()}function p(){n("onfinish"),e.removeListener("close",u),_()}function _(){n("unpipe"),i.unpipe(e)}return i.on("data",d),function(e,t,i){if("function"==typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events.error?Array.isArray(e._events.error)?e._events.error.unshift(i):e._events.error=[i,e._events.error]:e.on(t,i)}(e,"error",c),e.once("close",u),e.once("finish",p),e.emit("pipe",i),r.flowing||(n("pipe resume"),i.resume()),e},P.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var r=t.pipes,s=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var n=0;n<s;n++)r[n].emit("unpipe",this,{hasUnpiped:!1});return this}var o=Q(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},P.prototype.on=function(e,t){var i=a.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,n("on readable",r.length,r.reading),r.length?T(this):r.reading||s.nextTick(F,this))),i},P.prototype.addListener=P.prototype.on,P.prototype.removeListener=function(e,t){var i=a.prototype.removeListener.call(this,e,t);return"readable"===e&&s.nextTick(L,this),i},P.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||s.nextTick(L,this),t},P.prototype.resume=function(){var e=this._readableState;return e.flowing||(n("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,s.nextTick(H,e,t))}(this,e)),e.paused=!1,this},P.prototype.pause=function(){return n("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(n("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},P.prototype.wrap=function(e){var t=this,i=this._readableState,r=!1;for(var s in e.on("end",(function(){if(n("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(s){n("wrapped data"),i.decoder&&(s=i.decoder.write(s)),i.objectMode&&null==s||(i.objectMode||s&&s.length)&&(t.push(s)||(r=!0,e.pause()))})),e)void 0===this[s]&&"function"==typeof e[s]&&(this[s]=function(t){return function(){return e[t].apply(e,arguments)}}(s));for(var o=0;o<b.length;o++)e.on(b[o],this.emit.bind(this,b[o]));return this._read=function(t){n("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(P.prototype[Symbol.asyncIterator]=function(){return void 0===c&&(c=i(828)),c(this)}),Object.defineProperty(P.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(P.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(P.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),P._fromList=U,Object.defineProperty(P.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(P.from=function(e,t){return void 0===u&&(u=i(265)),u(P,e,t)})},473:(e,t,i)=>{e.exports=h;var r=i(106).q,s=r.ERR_METHOD_NOT_IMPLEMENTED,n=r.ERR_MULTIPLE_CALLBACK,o=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,A=i(656);function l(e,t){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(null===r)return this.emit("error",new n);i.writechunk=null,i.writecb=null,null!=t&&this.push(t),r(e);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function h(e){if(!(this instanceof h))return new h(e);A.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?c(this,null,null):this._flush((function(t,i){c(e,t,i)}))}function c(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}i(717)(h,A),h.prototype.push=function(e,t){return this._transformState.needTransform=!1,A.prototype.push.call(this,e,t)},h.prototype._transform=function(e,t,i){i(new s("_transform()"))},h.prototype._write=function(e,t,i){var r=this._transformState;if(r.writecb=i,r.writechunk=e,r.writeencoding=t,!r.transforming){var s=this._readableState;(r.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},h.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},h.prototype._destroy=function(e,t){A.prototype._destroy.call(this,e,(function(e){t(e)}))}},323:(e,t,i)=>{var r,s=i(155);function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var r=e.entry;for(e.entry=null;r;){var s=r.callback;t.pendingcb--,s(void 0),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=P,P.WritableState=B;var o,a={deprecate:i(927)},A=i(194),l=i(764).Buffer,h=i.g.Uint8Array||function(){},d=i(29),c=i(94).getHighWaterMark,u=i(106).q,p=u.ERR_INVALID_ARG_TYPE,_=u.ERR_METHOD_NOT_IMPLEMENTED,g=u.ERR_MULTIPLE_CALLBACK,m=u.ERR_STREAM_CANNOT_PIPE,f=u.ERR_STREAM_DESTROYED,w=u.ERR_STREAM_NULL_VALUES,C=u.ERR_STREAM_WRITE_AFTER_END,y=u.ERR_UNKNOWN_ENCODING,E=d.errorOrDestroy;function b(){}function B(e,t,o){r=r||i(656),e=e||{},"boolean"!=typeof o&&(o=t instanceof r),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=c(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,r=i.sync,n=i.writecb;if("function"!=typeof n)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,r,n){--t.pendingcb,i?(s.nextTick(n,r),s.nextTick(x,e,t),e._writableState.errorEmitted=!0,E(e,r)):(n(r),e._writableState.errorEmitted=!0,E(e,r),x(e,t))}(e,i,r,t,n);else{var o=I(i)||e.destroyed;o||i.corked||i.bufferProcessing||!i.bufferedRequest||R(e,i),r?s.nextTick(v,e,i,o,n):v(e,i,o,n)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function P(e){var t=this instanceof(r=r||i(656));if(!t&&!o.call(P,this))return new P(e);this._writableState=new B(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),A.call(this)}function S(e,t,i,r,s,n,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new f("write")):i?e._writev(s,t.onwrite):e._write(s,n,t.onwrite),t.sync=!1}function v(e,t,i,r){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),x(e,t)}function R(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var r=t.bufferedRequestCount,s=new Array(r),o=t.corkedRequestsFree;o.entry=i;for(var a=0,A=!0;i;)s[a]=i,i.isBuf||(A=!1),i=i.next,a+=1;s.allBuffers=A,S(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;i;){var l=i.chunk,h=i.encoding,d=i.callback;if(S(e,t,!1,t.objectMode?1:l.length,l,h,d),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(e,t){e._final((function(i){t.pendingcb--,i&&E(e,i),t.prefinished=!0,e.emit("prefinish"),x(e,t)}))}function x(e,t){var i=I(t);if(i&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,s.nextTick(T,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return i}i(717)(P,A),B.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(B.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(P,Symbol.hasInstance,{value:function(e){return!!o.call(this,e)||this===P&&e&&e._writableState instanceof B}})):o=function(e){return e instanceof this},P.prototype.pipe=function(){E(this,new m)},P.prototype.write=function(e,t,i){var r,n=this._writableState,o=!1,a=!n.objectMode&&(r=e,l.isBuffer(r)||r instanceof h);return a&&!l.isBuffer(e)&&(e=function(e){return l.from(e)}(e)),"function"==typeof t&&(i=t,t=null),a?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof i&&(i=b),n.ending?function(e,t){var i=new C;E(e,i),s.nextTick(t,i)}(this,i):(a||function(e,t,i,r){var n;return null===i?n=new w:"string"==typeof i||t.objectMode||(n=new p("chunk",["string","Buffer"],i)),!n||(E(e,n),s.nextTick(r,n),!1)}(this,n,e,i))&&(n.pendingcb++,o=function(e,t,i,r,s,n){if(!i){var o=function(e,t,i){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,i)),t}(t,r,s);r!==o&&(i=!0,s="buffer",r=o)}var a=t.objectMode?1:r.length;t.length+=a;var A=t.length<t.highWaterMark;if(A||(t.needDrain=!0),t.writing||t.corked){var h=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:s,isBuf:i,callback:n,next:null},h?h.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else S(e,t,!1,a,r,s,n);return A}(this,n,a,e,t,i)),o},P.prototype.cork=function(){this._writableState.corked++},P.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||R(this,e))},P.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new y(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(P.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(P.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),P.prototype._write=function(e,t,i){i(new _("_write()"))},P.prototype._writev=null,P.prototype.end=function(e,t,i){var r=this._writableState;return"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,i){t.ending=!0,x(e,t),i&&(t.finished?s.nextTick(i):e.once("finish",i)),t.ended=!0,e.writable=!1}(this,r,i),this},Object.defineProperty(P.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),P.prototype.destroy=d.destroy,P.prototype._undestroy=d.undestroy,P.prototype._destroy=function(e,t){t(e)}},828:(e,t,i)=>{var r,s=i(155);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o=i(86),a=Symbol("lastResolve"),A=Symbol("lastReject"),l=Symbol("error"),h=Symbol("ended"),d=Symbol("lastPromise"),c=Symbol("handlePromise"),u=Symbol("stream");function p(e,t){return{value:e,done:t}}function _(e){var t=e[a];if(null!==t){var i=e[u].read();null!==i&&(e[d]=null,e[a]=null,e[A]=null,t(p(i,!1)))}}function g(e){s.nextTick(_,e)}var m=Object.getPrototypeOf((function(){})),f=Object.setPrototypeOf((n(r={get stream(){return this[u]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[h])return Promise.resolve(p(void 0,!0));if(this[u].destroyed)return new Promise((function(t,i){s.nextTick((function(){e[l]?i(e[l]):t(p(void 0,!0))}))}));var i,r=this[d];if(r)i=new Promise(function(e,t){return function(i,r){e.then((function(){t[h]?i(p(void 0,!0)):t[c](i,r)}),r)}}(r,this));else{var n=this[u].read();if(null!==n)return Promise.resolve(p(n,!1));i=new Promise(this[c])}return this[d]=i,i}},Symbol.asyncIterator,(function(){return this})),n(r,"return",(function(){var e=this;return new Promise((function(t,i){e[u].destroy(null,(function(e){e?i(e):t(p(void 0,!0))}))}))})),r),m);e.exports=function(e){var t,i=Object.create(f,(n(t={},u,{value:e,writable:!0}),n(t,a,{value:null,writable:!0}),n(t,A,{value:null,writable:!0}),n(t,l,{value:null,writable:!0}),n(t,h,{value:e._readableState.endEmitted,writable:!0}),n(t,c,{value:function(e,t){var r=i[u].read();r?(i[d]=null,i[a]=null,i[A]=null,e(p(r,!1))):(i[a]=e,i[A]=t)},writable:!0}),t));return i[d]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=i[A];return null!==t&&(i[d]=null,i[a]=null,i[A]=null,t(e)),void(i[l]=e)}var r=i[a];null!==r&&(i[d]=null,i[a]=null,i[A]=null,r(p(void 0,!0))),i[h]=!0})),e.on("readable",g.bind(null,i)),i}},686:(e,t,i)=>{function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=i(764).Buffer,a=i(862).inspect,A=a&&a.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t;return t=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,i,r,s=o.allocUnsafe(e>>>0),n=this.head,a=0;n;)t=n.data,i=s,r=a,o.prototype.copy.call(t,i,r),a+=n.data.length,n=n.next;return s}},{key:"consume",value:function(e,t){var i;return e<this.head.data.length?(i=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):i=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,i=1,r=t.data;for(e-=r.length;t=t.next;){var s=t.data,n=e>s.length?s.length:e;if(n===s.length?r+=s:r+=s.slice(0,e),0==(e-=n)){n===s.length?(++i,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=s.slice(n));break}++i}return this.length-=i,r}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),i=this.head,r=1;for(i.data.copy(t),e-=i.data.length;i=i.next;){var s=i.data,n=e>s.length?s.length:e;if(s.copy(t,t.length-e,0,n),0==(e-=n)){n===s.length?(++r,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=s.slice(n));break}++r}return this.length-=r,t}},{key:A,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],t&&n(e.prototype,t),e}()},29:(e,t,i)=>{var r=i(155);function s(e,t){o(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function o(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var i=this,a=this._readableState&&this._readableState.destroyed,A=this._writableState&&this._writableState.destroyed;return a||A?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(o,this,e)):r.nextTick(o,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?i._writableState?i._writableState.errorEmitted?r.nextTick(n,i):(i._writableState.errorEmitted=!0,r.nextTick(s,i,e)):r.nextTick(s,i,e):t?(r.nextTick(n,i),t(e)):r.nextTick(n,i)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var i=e._readableState,r=e._writableState;i&&i.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}},86:(e,t,i)=>{var r=i(106).q.ERR_STREAM_PREMATURE_CLOSE;function s(){}e.exports=function e(t,i,n){if("function"==typeof i)return e(t,null,i);i||(i={}),n=function(e){var t=!1;return function(){if(!t){t=!0;for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];e.apply(this,r)}}}(n||s);var o=i.readable||!1!==i.readable&&t.readable,a=i.writable||!1!==i.writable&&t.writable,A=function(){t.writable||h()},l=t._writableState&&t._writableState.finished,h=function(){a=!1,l=!0,o||n.call(t)},d=t._readableState&&t._readableState.endEmitted,c=function(){o=!1,d=!0,a||n.call(t)},u=function(e){n.call(t,e)},p=function(){var e;return o&&!d?(t._readableState&&t._readableState.ended||(e=new r),n.call(t,e)):a&&!l?(t._writableState&&t._writableState.ended||(e=new r),n.call(t,e)):void 0},_=function(){t.req.on("finish",h)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",h),t.on("abort",p),t.req?_():t.on("request",_)):a&&!t._writableState&&(t.on("end",A),t.on("close",A)),t.on("end",c),t.on("finish",h),!1!==i.error&&t.on("error",u),t.on("close",p),function(){t.removeListener("complete",h),t.removeListener("abort",p),t.removeListener("request",_),t.req&&t.req.removeListener("finish",h),t.removeListener("end",A),t.removeListener("close",A),t.removeListener("finish",h),t.removeListener("end",c),t.removeListener("error",u),t.removeListener("close",p)}}},265:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},472:(e,t,i)=>{var r,s=i(106).q,n=s.ERR_MISSING_ARGS,o=s.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function A(e,t,s,n){n=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(n);var a=!1;e.on("close",(function(){a=!0})),void 0===r&&(r=i(86)),r(e,{readable:t,writable:s},(function(e){if(e)return n(e);a=!0,n()}));var A=!1;return function(t){if(!a&&!A)return A=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void n(t||new o("pipe"))}}function l(e){e()}function h(e,t){return e.pipe(t)}function d(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var r,s=d(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new n("streams");var o=t.map((function(e,i){var n=i<t.length-1;return A(e,n,i>0,(function(e){r||(r=e),e&&o.forEach(l),n||(o.forEach(l),s(r))}))}));return t.reduce(h)}},94:(e,t,i)=>{var r=i(106).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,i,s){var n=function(e,t,i){return null!=e.highWaterMark?e.highWaterMark:t?e[i]:null}(t,s,i);if(null!=n){if(!isFinite(n)||Math.floor(n)!==n||n<0)throw new r(s?i:"highWaterMark",n);return Math.floor(n)}return e.objectMode?16:16384}}},194:(e,t,i)=>{e.exports=i(187).EventEmitter},553:(e,t,i)=>{var r=i(509).Buffer,s=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===s||!s(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=A,this.end=l,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=h,this.end=d,t=3;break;default:return this.write=c,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,i=function(e,t,i){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==i?i:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function A(e,t){if((e.length-t)%2==0){var i=e.toString("utf16le",t);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function l(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,i)}return t}function h(e,t){var i=(e.length-t)%3;return 0===i?e.toString("base64",t):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-i))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function c(e){return e.toString(this.encoding)}function u(e){return e&&e.length?this.write(e):""}t.s=n,n.prototype.write=function(e){if(0===e.length)return"";var t,i;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<e.length?t?t+this.text(e,i):this.text(e,i):t||""},n.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},n.prototype.text=function(e,t){var i=function(e,t,i){var r=t.length-1;if(r<i)return 0;var s=o(t[r]);return s>=0?(s>0&&(e.lastNeed=s-1),s):--r<i||-2===s?0:(s=o(t[r]))>=0?(s>0&&(e.lastNeed=s-2),s):--r<i||-2===s?0:(s=o(t[r]))>=0?(s>0&&(2===s?s=0:e.lastNeed=s-3),s):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=i;var r=e.length-(i-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},n.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},927:(e,t,i)=>{function r(e){try{if(!i.g.localStorage)return!1}catch(e){return!1}var t=i.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var i=!1;return function(){if(!i){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}},881:e=>{e.exports={isArray:function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}}},888:(e,t,i)=>{var r=i(229),s=i(388),n=i(501),o=i(673);e.exports={xml2js:r,xml2json:s,js2xml:n,json2xml:o}},501:(e,t,i)=>{var r,s,n=i(740),o=i(881).isArray;function a(e,t,i){return(!i&&e.spaces?"\n":"")+Array(t+1).join(e.spaces)}function A(e,t,i){if(t.ignoreAttributes)return"";"attributesFn"in t&&(e=t.attributesFn(e,s,r));var n,o,A,l,h=[];for(n in e)e.hasOwnProperty(n)&&null!==e[n]&&void 0!==e[n]&&(l=t.noQuotesForNativeAttributes&&"string"!=typeof e[n]?"":'"',o=(o=""+e[n]).replace(/"/g,"&quot;"),A="attributeNameFn"in t?t.attributeNameFn(n,o,s,r):n,h.push(t.spaces&&t.indentAttributes?a(t,i+1,!1):" "),h.push(A+"="+l+("attributeValueFn"in t?t.attributeValueFn(o,n,s,r):o)+l));return e&&Object.keys(e).length&&t.spaces&&t.indentAttributes&&h.push(a(t,i,!1)),h.join("")}function l(e,t,i){return r=e,s="xml",t.ignoreDeclaration?"":"<?xml"+A(e[t.attributesKey],t,i)+"?>"}function h(e,t,i){if(t.ignoreInstruction)return"";var n;for(n in e)if(e.hasOwnProperty(n))break;var o="instructionNameFn"in t?t.instructionNameFn(n,e[n],s,r):n;if("object"==typeof e[n])return r=e,s=o,"<?"+o+A(e[n][t.attributesKey],t,i)+"?>";var a=e[n]?e[n]:"";return"instructionFn"in t&&(a=t.instructionFn(a,n,s,r)),"<?"+o+(a?" "+a:"")+"?>"}function d(e,t){return t.ignoreComment?"":"\x3c!--"+("commentFn"in t?t.commentFn(e,s,r):e)+"--\x3e"}function c(e,t){return t.ignoreCdata?"":"<![CDATA["+("cdataFn"in t?t.cdataFn(e,s,r):e.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function u(e,t){return t.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in t?t.doctypeFn(e,s,r):e)+">"}function p(e,t){return t.ignoreText?"":(e=(e=(e=""+e).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in t?t.textFn(e,s,r):e)}function _(e,t,i,n){return e.reduce((function(e,o){var l=a(t,i,n&&!e);switch(o.type){case"element":return e+l+function(e,t,i){r=e,s=e.name;var n=[],o="elementNameFn"in t?t.elementNameFn(e.name,e):e.name;n.push("<"+o),e[t.attributesKey]&&n.push(A(e[t.attributesKey],t,i));var a=e[t.elementsKey]&&e[t.elementsKey].length||e[t.attributesKey]&&"preserve"===e[t.attributesKey]["xml:space"];return a||(a="fullTagEmptyElementFn"in t?t.fullTagEmptyElementFn(e.name,e):t.fullTagEmptyElement),a?(n.push(">"),e[t.elementsKey]&&e[t.elementsKey].length&&(n.push(_(e[t.elementsKey],t,i+1)),r=e,s=e.name),n.push(t.spaces&&function(e,t){var i;if(e.elements&&e.elements.length)for(i=0;i<e.elements.length;++i)switch(e.elements[i][t.typeKey]){case"text":if(t.indentText)return!0;break;case"cdata":if(t.indentCdata)return!0;break;case"instruction":if(t.indentInstruction)return!0;break;default:return!0}return!1}(e,t)?"\n"+Array(i+1).join(t.spaces):""),n.push("</"+o+">")):n.push("/>"),n.join("")}(o,t,i);case"comment":return e+l+d(o[t.commentKey],t);case"doctype":return e+l+u(o[t.doctypeKey],t);case"cdata":return e+(t.indentCdata?l:"")+c(o[t.cdataKey],t);case"text":return e+(t.indentText?l:"")+p(o[t.textKey],t);case"instruction":var g={};return g[o[t.nameKey]]=o[t.attributesKey]?o:o[t.instructionKey],e+(t.indentInstruction?l:"")+h(g,t,i)}}),"")}function g(e,t,i){var r;for(r in e)if(e.hasOwnProperty(r))switch(r){case t.parentKey:case t.attributesKey:break;case t.textKey:if(t.indentText||i)return!0;break;case t.cdataKey:if(t.indentCdata||i)return!0;break;case t.instructionKey:if(t.indentInstruction||i)return!0;break;case t.doctypeKey:case t.commentKey:default:return!0}return!1}function m(e,t,i,n,o){r=e,s=t;var l="elementNameFn"in i?i.elementNameFn(t,e):t;if(null==e||""===e)return"fullTagEmptyElementFn"in i&&i.fullTagEmptyElementFn(t,e)||i.fullTagEmptyElement?"<"+l+"></"+l+">":"<"+l+"/>";var h=[];if(t){if(h.push("<"+l),"object"!=typeof e)return h.push(">"+p(e,i)+"</"+l+">"),h.join("");e[i.attributesKey]&&h.push(A(e[i.attributesKey],i,n));var d=g(e,i,!0)||e[i.attributesKey]&&"preserve"===e[i.attributesKey]["xml:space"];if(d||(d="fullTagEmptyElementFn"in i?i.fullTagEmptyElementFn(t,e):i.fullTagEmptyElement),!d)return h.push("/>"),h.join("");h.push(">")}return h.push(f(e,i,n+1,!1)),r=e,s=t,t&&h.push((o?a(i,n,!1):"")+"</"+l+">"),h.join("")}function f(e,t,i,r){var s,n,A,_=[];for(n in e)if(e.hasOwnProperty(n))for(A=o(e[n])?e[n]:[e[n]],s=0;s<A.length;++s){switch(n){case t.declarationKey:_.push(l(A[s],t,i));break;case t.instructionKey:_.push((t.indentInstruction?a(t,i,r):"")+h(A[s],t,i));break;case t.attributesKey:case t.parentKey:break;case t.textKey:_.push((t.indentText?a(t,i,r):"")+p(A[s],t));break;case t.cdataKey:_.push((t.indentCdata?a(t,i,r):"")+c(A[s],t));break;case t.doctypeKey:_.push(a(t,i,r)+u(A[s],t));break;case t.commentKey:_.push(a(t,i,r)+d(A[s],t));break;default:_.push(a(t,i,r)+m(A[s],n,t,i,g(A[s],t)))}r=r&&!_.length}return _.join("")}e.exports=function(e,t){t=function(e){var t=n.copyOptions(e);return n.ensureFlagExists("ignoreDeclaration",t),n.ensureFlagExists("ignoreInstruction",t),n.ensureFlagExists("ignoreAttributes",t),n.ensureFlagExists("ignoreText",t),n.ensureFlagExists("ignoreComment",t),n.ensureFlagExists("ignoreCdata",t),n.ensureFlagExists("ignoreDoctype",t),n.ensureFlagExists("compact",t),n.ensureFlagExists("indentText",t),n.ensureFlagExists("indentCdata",t),n.ensureFlagExists("indentAttributes",t),n.ensureFlagExists("indentInstruction",t),n.ensureFlagExists("fullTagEmptyElement",t),n.ensureFlagExists("noQuotesForNativeAttributes",t),n.ensureSpacesExists(t),"number"==typeof t.spaces&&(t.spaces=Array(t.spaces+1).join(" ")),n.ensureKeyExists("declaration",t),n.ensureKeyExists("instruction",t),n.ensureKeyExists("attributes",t),n.ensureKeyExists("text",t),n.ensureKeyExists("comment",t),n.ensureKeyExists("cdata",t),n.ensureKeyExists("doctype",t),n.ensureKeyExists("type",t),n.ensureKeyExists("name",t),n.ensureKeyExists("elements",t),n.checkFnExists("doctype",t),n.checkFnExists("instruction",t),n.checkFnExists("cdata",t),n.checkFnExists("comment",t),n.checkFnExists("text",t),n.checkFnExists("instructionName",t),n.checkFnExists("elementName",t),n.checkFnExists("attributeName",t),n.checkFnExists("attributeValue",t),n.checkFnExists("attributes",t),n.checkFnExists("fullTagEmptyElement",t),t}(t);var i=[];return r=e,s="_root_",t.compact?i.push(f(e,t,0,!0)):(e[t.declarationKey]&&i.push(l(e[t.declarationKey],t,0)),e[t.elementsKey]&&e[t.elementsKey].length&&i.push(_(e[t.elementsKey],t,0,!i.length))),i.join("")}},673:(e,t,i)=>{var r=i(501);e.exports=function(e,t){e instanceof Buffer&&(e=e.toString());var i=null;if("string"==typeof e)try{i=JSON.parse(e)}catch(e){throw new Error("The JSON structure is invalid")}else i=e;return r(i,t)}},740:(e,t,i)=>{var r=i(881).isArray;e.exports={copyOptions:function(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i},ensureFlagExists:function(e,t){e in t&&"boolean"==typeof t[e]||(t[e]=!1)},ensureSpacesExists:function(e){(!("spaces"in e)||"number"!=typeof e.spaces&&"string"!=typeof e.spaces)&&(e.spaces=0)},ensureAlwaysArrayExists:function(e){"alwaysArray"in e&&("boolean"==typeof e.alwaysArray||r(e.alwaysArray))||(e.alwaysArray=!1)},ensureKeyExists:function(e,t){e+"Key"in t&&"string"==typeof t[e+"Key"]||(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}}},229:(e,t,i)=>{var r,s,n=i(99),o=i(740),a=i(881).isArray;function A(e){var t=Number(e);if(!isNaN(t))return t;var i=e.toLowerCase();return"true"===i||"false"!==i&&e}function l(e,t){var i;if(r.compact){if(!s[r[e+"Key"]]&&(a(r.alwaysArray)?-1!==r.alwaysArray.indexOf(r[e+"Key"]):r.alwaysArray)&&(s[r[e+"Key"]]=[]),s[r[e+"Key"]]&&!a(s[r[e+"Key"]])&&(s[r[e+"Key"]]=[s[r[e+"Key"]]]),e+"Fn"in r&&"string"==typeof t&&(t=r[e+"Fn"](t,s)),"instruction"===e&&("instructionFn"in r||"instructionNameFn"in r))for(i in t)if(t.hasOwnProperty(i))if("instructionFn"in r)t[i]=r.instructionFn(t[i],i,s);else{var n=t[i];delete t[i],t[r.instructionNameFn(i,n,s)]=n}a(s[r[e+"Key"]])?s[r[e+"Key"]].push(t):s[r[e+"Key"]]=t}else{s[r.elementsKey]||(s[r.elementsKey]=[]);var o={};if(o[r.typeKey]=e,"instruction"===e){for(i in t)if(t.hasOwnProperty(i))break;o[r.nameKey]="instructionNameFn"in r?r.instructionNameFn(i,t,s):i,r.instructionHasAttributes?(o[r.attributesKey]=t[i][r.attributesKey],"instructionFn"in r&&(o[r.attributesKey]=r.instructionFn(o[r.attributesKey],i,s))):("instructionFn"in r&&(t[i]=r.instructionFn(t[i],i,s)),o[r.instructionKey]=t[i])}else e+"Fn"in r&&(t=r[e+"Fn"](t,s)),o[r[e+"Key"]]=t;r.addParent&&(o[r.parentKey]=s),s[r.elementsKey].push(o)}}function h(e){var t;if("attributesFn"in r&&e&&(e=r.attributesFn(e,s)),(r.trim||"attributeValueFn"in r||"attributeNameFn"in r||r.nativeTypeAttributes)&&e)for(t in e)if(e.hasOwnProperty(t)&&(r.trim&&(e[t]=e[t].trim()),r.nativeTypeAttributes&&(e[t]=A(e[t])),"attributeValueFn"in r&&(e[t]=r.attributeValueFn(e[t],t,s)),"attributeNameFn"in r)){var i=e[t];delete e[t],e[r.attributeNameFn(t,e[t],s)]=i}return e}function d(e){var t={};if(e.body&&("xml"===e.name.toLowerCase()||r.instructionHasAttributes)){for(var i,n=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(i=n.exec(e.body));)t[i[1]]=i[2]||i[3]||i[4];t=h(t)}if("xml"===e.name.toLowerCase()){if(r.ignoreDeclaration)return;s[r.declarationKey]={},Object.keys(t).length&&(s[r.declarationKey][r.attributesKey]=t),r.addParent&&(s[r.declarationKey][r.parentKey]=s)}else{if(r.ignoreInstruction)return;r.trim&&(e.body=e.body.trim());var o={};r.instructionHasAttributes&&Object.keys(t).length?(o[e.name]={},o[e.name][r.attributesKey]=t):o[e.name]=e.body,l("instruction",o)}}function c(e,t){var i;if("object"==typeof e&&(t=e.attributes,e=e.name),t=h(t),"elementNameFn"in r&&(e=r.elementNameFn(e,s)),r.compact){var n;if(i={},!r.ignoreAttributes&&t&&Object.keys(t).length)for(n in i[r.attributesKey]={},t)t.hasOwnProperty(n)&&(i[r.attributesKey][n]=t[n]);!(e in s)&&(a(r.alwaysArray)?-1!==r.alwaysArray.indexOf(e):r.alwaysArray)&&(s[e]=[]),s[e]&&!a(s[e])&&(s[e]=[s[e]]),a(s[e])?s[e].push(i):s[e]=i}else s[r.elementsKey]||(s[r.elementsKey]=[]),(i={})[r.typeKey]="element",i[r.nameKey]=e,!r.ignoreAttributes&&t&&Object.keys(t).length&&(i[r.attributesKey]=t),r.alwaysChildren&&(i[r.elementsKey]=[]),s[r.elementsKey].push(i);i[r.parentKey]=s,s=i}function u(e){r.ignoreText||(e.trim()||r.captureSpacesBetweenElements)&&(r.trim&&(e=e.trim()),r.nativeType&&(e=A(e)),r.sanitize&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),l("text",e))}function p(e){r.ignoreComment||(r.trim&&(e=e.trim()),l("comment",e))}function _(e){var t=s[r.parentKey];r.addParent||delete s[r.parentKey],s=t}function g(e){r.ignoreCdata||(r.trim&&(e=e.trim()),l("cdata",e))}function m(e){r.ignoreDoctype||(e=e.replace(/^ /,""),r.trim&&(e=e.trim()),l("doctype",e))}function f(e){e.note=e}e.exports=function(e,t){var i=n.parser(!0,{}),a={};if(s=a,r=function(e){return r=o.copyOptions(e),o.ensureFlagExists("ignoreDeclaration",r),o.ensureFlagExists("ignoreInstruction",r),o.ensureFlagExists("ignoreAttributes",r),o.ensureFlagExists("ignoreText",r),o.ensureFlagExists("ignoreComment",r),o.ensureFlagExists("ignoreCdata",r),o.ensureFlagExists("ignoreDoctype",r),o.ensureFlagExists("compact",r),o.ensureFlagExists("alwaysChildren",r),o.ensureFlagExists("addParent",r),o.ensureFlagExists("trim",r),o.ensureFlagExists("nativeType",r),o.ensureFlagExists("nativeTypeAttributes",r),o.ensureFlagExists("sanitize",r),o.ensureFlagExists("instructionHasAttributes",r),o.ensureFlagExists("captureSpacesBetweenElements",r),o.ensureAlwaysArrayExists(r),o.ensureKeyExists("declaration",r),o.ensureKeyExists("instruction",r),o.ensureKeyExists("attributes",r),o.ensureKeyExists("text",r),o.ensureKeyExists("comment",r),o.ensureKeyExists("cdata",r),o.ensureKeyExists("doctype",r),o.ensureKeyExists("type",r),o.ensureKeyExists("name",r),o.ensureKeyExists("elements",r),o.ensureKeyExists("parent",r),o.checkFnExists("doctype",r),o.checkFnExists("instruction",r),o.checkFnExists("cdata",r),o.checkFnExists("comment",r),o.checkFnExists("text",r),o.checkFnExists("instructionName",r),o.checkFnExists("elementName",r),o.checkFnExists("attributeName",r),o.checkFnExists("attributeValue",r),o.checkFnExists("attributes",r),r}(t),i.opt={strictEntities:!0},i.onopentag=c,i.ontext=u,i.oncomment=p,i.onclosetag=_,i.onerror=f,i.oncdata=g,i.ondoctype=m,i.onprocessinginstruction=d,i.write(e).close(),a[r.elementsKey]){var A=a[r.elementsKey];delete a[r.elementsKey],a[r.elementsKey]=A,delete a.text}return a}},388:(e,t,i)=>{var r=i(740),s=i(229);e.exports=function(e,t){var i,n,o;return i=function(e){var t=r.copyOptions(e);return r.ensureSpacesExists(t),t}(t),n=s(e,i),o="compact"in i&&i.compact?"_parent":"parent",("addParent"in i&&i.addParent?JSON.stringify(n,(function(e,t){return e===o?"_":t}),i.spaces):JSON.stringify(n,null,i.spaces)).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}},255:e=>{var t={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};e.exports=function(e){return e&&e.replace?e.replace(/([&"<>'])/g,(function(e,i){return t[i]})):e}},479:(e,t,i)=>{var r=i(155),s=i(255),n=i(830).Stream;function o(e,t,i){i=i||0;var r,n,a=(r=t,new Array(i||0).join(r||"")),A=e;if("object"==typeof e&&(A=e[n=Object.keys(e)[0]])&&A._elem)return A._elem.name=n,A._elem.icount=i,A._elem.indent=t,A._elem.indents=a,A._elem.interrupt=A,A._elem;var l,h=[],d=[];function c(e){Object.keys(e).forEach((function(t){h.push(function(e,t){return e+'="'+s(t)+'"'}(t,e[t]))}))}switch(typeof A){case"object":if(null===A)break;A._attr&&c(A._attr),A._cdata&&d.push(("<![CDATA["+A._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),A.forEach&&(l=!1,d.push(""),A.forEach((function(e){"object"==typeof e?"_attr"==Object.keys(e)[0]?c(e._attr):d.push(o(e,t,i+1)):(d.pop(),l=!0,d.push(s(e)))})),l||d.push(""));break;default:d.push(s(A))}return{name:n,interrupt:!1,attributes:h,content:d,icount:i,indents:a,indent:t}}function a(e,t,i){if("object"!=typeof t)return e(!1,t);var r=t.interrupt?1:t.content.length;function s(){for(;t.content.length;){var s=t.content.shift();if(void 0!==s){if(n(s))return;a(e,s)}}e(!1,(r>1?t.indents:"")+(t.name?"</"+t.name+">":"")+(t.indent&&!i?"\n":"")),i&&i()}function n(t){return!!t.interrupt&&(t.interrupt.append=e,t.interrupt.end=s,t.interrupt=!1,e(!0),!0)}if(e(!1,t.indents+(t.name?"<"+t.name:"")+(t.attributes.length?" "+t.attributes.join(" "):"")+(r?t.name?">":"":t.name?"/>":"")+(t.indent&&r>1?"\n":"")),!r)return e(!1,t.indent?"\n":"");n(t)||s()}e.exports=function(e,t){"object"!=typeof t&&(t={indent:t});var i,s,A=t.stream?new n:null,l="",h=!1,d=t.indent?!0===t.indent?"    ":t.indent:"",c=!0;function u(e){c?r.nextTick(e):e()}function p(e,t){if(void 0!==t&&(l+=t),e&&!h&&(A=A||new n,h=!0),e&&h){var i=l;u((function(){A.emit("data",i)})),l=""}}function _(e,t){a(p,o(e,d,d?1:0),t)}function g(){if(A){var e=l;u((function(){A.emit("data",e),A.emit("end"),A.readable=!1,A.emit("close")}))}}return u((function(){c=!1})),t.declaration&&(s={version:"1.0",encoding:(i=t.declaration).encoding||"UTF-8"},i.standalone&&(s.standalone=i.standalone),_({"?xml":{_attr:s}}),l=l.replace("/>","?>")),e&&e.forEach?e.forEach((function(t,i){var r;i+1===e.length&&(r=g),_(t,r)})):_(e,g),A?(A.readable=!0,A):l},e.exports.element=e.exports.Element=function(){var e={_elem:o(Array.prototype.slice.call(arguments)),push:function(e){if(!this.append)throw new Error("not assigned to a parent!");var t=this,i=this._elem.indent;a(this.append,o(e,i,this._elem.icount+(i?1:0)),(function(){t.append(!0)}))},close:function(e){void 0!==e&&this.push(e),this.end&&this.end()}};return e}},862:()=>{},964:()=>{}},t={};function i(r){var s=t[r];if(void 0!==s)return s.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{i.r(r),i.d(r,{AbstractNumbering:()=>lo,Alignment:()=>j,AlignmentAttributes:()=>z,AlignmentType:()=>M,Attributes:()=>a,BaseEmphasisMark:()=>ue,BaseXmlComponent:()=>e,Body:()=>yr,Bookmark:()=>Gi,BookmarkEnd:()=>Wi,BookmarkStart:()=>$i,Border:()=>J,BorderElement:()=>X,BorderStyle:()=>k,Column:()=>br,ColumnAttributes:()=>Er,ColumnBreak:()=>Bi,Columns:()=>tr,ColumnsAttributes:()=>er,ConcreteHyperlink:()=>Ui,ConcreteNumbering:()=>uo,DeletedTextRun:()=>wa,DocGridAttributes:()=>ir,Document:()=>Jo,DocumentAttributes:()=>Br,DocumentBackground:()=>Sr,DocumentBackgroundAttributes:()=>Pr,DocumentDefaults:()=>jo,DocumentGrid:()=>rr,DocumentGridType:()=>tt,DotEmphasisMark:()=>_e,Drawing:()=>ui,DropCapType:()=>xr,EMPTY_OBJECT:()=>t,EmphasisMark:()=>pe,EmphasisMarkType:()=>$,ExternalHyperlink:()=>ki,File:()=>Jo,FootNoteReferenceRunAttributes:()=>la,FootNotes:()=>$n,Footer:()=>Aa,FooterWrapper:()=>Ln,FootnoteReference:()=>ha,FootnoteReferenceRun:()=>da,FrameAnchorType:()=>Or,FrameProperties:()=>Fr,FramePropertiesAttributes:()=>Lr,FrameWrap:()=>Dr,GridSpan:()=>Qs,Header:()=>aa,HeaderFooterReference:()=>Zi,HeaderFooterReferenceType:()=>Ze,HeaderFooterType:()=>et,HeaderWrapper:()=>jn,HeadingLevel:()=>Ke,HeightRule:()=>rn,HorizontalPosition:()=>_t,HorizontalPositionAlign:()=>ya,HorizontalPositionRelativeFrom:()=>ke,HpsMeasureElement:()=>F,HyperlinkType:()=>Je,IgnoreIfEmptyXmlComponent:()=>n,ImageRun:()=>pi,ImportDotx:()=>La,ImportedRootElementAttributes:()=>c,ImportedXmlComponent:()=>d,Indent:()=>ee,InitializableXmlComponent:()=>p,InsertedTextRun:()=>ca,InternalHyperlink:()=>Mi,LeaderType:()=>je,Level:()=>no,LevelBase:()=>so,LevelForOverride:()=>oo,LevelFormat:()=>Jn,LevelOverride:()=>_o,LevelSuffix:()=>qn,LineNumberAttributes:()=>sr,LineNumberRestartFormat:()=>it,LineNumberType:()=>nr,LineRuleType:()=>We,Math:()=>Ur,MathAccentCharacter:()=>Wr,MathAngledBrackets:()=>Rs,MathBase:()=>Kr,MathCurlyBrackets:()=>vs,MathDegree:()=>cs,MathDenominator:()=>Qr,MathFraction:()=>Gr,MathFunction:()=>ws,MathFunctionName:()=>ms,MathFunctionProperties:()=>fs,MathLimitLocation:()=>jr,MathNArayProperties:()=>Zr,MathNumerator:()=>Vr,MathPreSubSuperScript:()=>hs,MathPreSubSuperScriptProperties:()=>ls,MathRadical:()=>gs,MathRadicalProperties:()=>_s,MathRoundBrackets:()=>Ps,MathRun:()=>kr,MathSquareBrackets:()=>Ss,MathSubScript:()=>os,MathSubScriptElement:()=>es,MathSubScriptProperties:()=>ns,MathSubSuperScript:()=>As,MathSubSuperScriptProperties:()=>as,MathSum:()=>is,MathSuperScript:()=>ss,MathSuperScriptElement:()=>ts,MathSuperScriptProperties:()=>rs,Media:()=>Xn,NumberFormat:()=>ba,NumberProperties:()=>Oi,NumberValueElement:()=>N,Numbering:()=>fo,OnOffElement:()=>L,OutlineLevel:()=>Ki,OverlapType:()=>Js,Packer:()=>Ta,PageBorderDisplay:()=>rt,PageBorderOffsetFrom:()=>st,PageBorderZOrder:()=>nt,PageBorders:()=>ar,PageBreak:()=>bi,PageBreakBefore:()=>Pi,PageMargin:()=>lr,PageMarginAttributes:()=>Ar,PageNumber:()=>K,PageNumberSeparator:()=>ot,PageNumberType:()=>dr,PageNumberTypeAttributes:()=>hr,PageOrientation:()=>at,PageReference:()=>Xi,PageSize:()=>ur,PageSizeAttributes:()=>cr,PageTextDirection:()=>_r,PageTextDirectionType:()=>At,Paragraph:()=>Nr,ParagraphProperties:()=>Hr,ParagraphPropertiesDefaults:()=>Ko,RelativeHorizontalPosition:()=>Zs,RelativeVerticalPosition:()=>en,Run:()=>Te,RunFonts:()=>ye,RunProperties:()=>Se,RunPropertiesChange:()=>ve,RunPropertiesDefaults:()=>zo,SectionProperties:()=>Cr,SectionType:()=>lt,SectionTypeAttributes:()=>gr,SequentialIdentifier:()=>mi,Shading:()=>ce,ShadingType:()=>G,SimpleField:()=>Ci,SimpleMailMergeField:()=>yi,SimplePos:()=>dt,Spacing:()=>vi,StringContainer:()=>U,StringValueElement:()=>H,Style:()=>Ri,StyleForCharacter:()=>To,StyleForParagraph:()=>Io,StyleLevel:()=>oa,Styles:()=>Wo,SymbolRun:()=>Le,TDirection:()=>Ws,Tab:()=>fi,TabAttributes:()=>Ti,TabStop:()=>Ii,TabStopItem:()=>xi,TabStopPosition:()=>Xe,TabStopType:()=>ze,Table:()=>cn,TableAnchorType:()=>qs,TableBorders:()=>Ys,TableCell:()=>zs,TableCellBorders:()=>Ms,TableFloatOptionsAttributes:()=>an,TableFloatProperties:()=>An,TableLayout:()=>hn,TableLayoutType:()=>tn,TableOfContents:()=>na,TableOverlap:()=>on,TableProperties:()=>dn,TableRow:()=>gn,TableRowHeight:()=>pn,TableRowHeightAttributes:()=>un,TableRowProperties:()=>_n,TableWidthElement:()=>Ns,TextDirection:()=>Fs,TextRun:()=>xe,TextWrappingSide:()=>Ge,TextWrappingType:()=>Ve,ThematicBreak:()=>q,Type:()=>mr,Underline:()=>Pe,UnderlineType:()=>W,VerticalAlign:()=>qe,VerticalAlignAttributes:()=>Yi,VerticalAlignElement:()=>Ji,VerticalMerge:()=>Gs,VerticalMergeType:()=>Ls,VerticalPosition:()=>mt,VerticalPositionAlign:()=>Ea,VerticalPositionRelativeFrom:()=>Qe,WORKAROUND:()=>qo,WORKAROUND2:()=>Yn,WORKAROUND3:()=>u,WORKAROUND4:()=>ds,WidthType:()=>Os,WrapNone:()=>zt,WrapSquare:()=>Xt,WrapTight:()=>Jt,WrapTopAndBottom:()=>Zt,XmlAttributeComponent:()=>o,XmlComponent:()=>s,convertInchesToTwip:()=>Ne,convertMillimetersToTwip:()=>He,convertToXmlComponent:()=>l,dateTimeValue:()=>D,decimalNumber:()=>_,eighthPointMeasureValue:()=>x,hexColorValue:()=>B,hpsMeasureValue:()=>S,longHexNumber:()=>f,measurementOrPercentValue:()=>T,percentageValue:()=>I,pointMeasureValue:()=>O,positiveUniversalMeasureValue:()=>b,sectionMarginDefaults:()=>fr,sectionPageSizeDefaults:()=>wr,shortHexNumber:()=>w,signedHpsMeasureValue:()=>v,signedTwipsMeasureValue:()=>P,twipsMeasureValue:()=>R,uCharHexNumber:()=>C,uniqueId:()=>Me,uniqueNumericId:()=>Ue,universalMeasureValue:()=>y,unsignedDecimalNumber:()=>g});class e{constructor(e){this.rootKey=e}}const t=Object.seal({});class s extends e{constructor(e){super(e),this.root=new Array}prepForXml(i){var r;const s=this.root.map((t=>t instanceof e?t.prepForXml(i):t)).filter((e=>void 0!==e));return{[this.rootKey]:s.length?1===s.length&&(null===(r=s[0])||void 0===r?void 0:r._attr)?s[0]:s:t}}addChildElement(e){return this.root.push(e),this}}class n extends s{prepForXml(e){const t=super.prepForXml(e);if(t&&("object"!=typeof t[this.rootKey]||Object.keys(t[this.rootKey]).length))return t}}class o extends e{constructor(e){super("_attr"),this.root=e}prepForXml(e){const t={};return Object.keys(this.root).forEach((e=>{const i=this.root[e];if(void 0!==i){const r=this.xmlKeys&&this.xmlKeys[e]||e;t[r]=i}})),{_attr:t}}set(e){this.root=e}}class a extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"}}}var A=i(888);function l(e){switch(e.type){case void 0:case"element":const t=new d(e.name,e.attributes),i=e.elements||[];for(const e of i){const i=l(e);void 0!==i&&t.push(i)}return t;case"text":return e.text;default:return}}class h extends o{}class d extends s{static fromXmlString(e){return l((0,A.xml2js)(e,{compact:!1}))}constructor(e,t){super(e),t&&this.root.push(new h(t))}push(e){this.root.push(e)}}class c extends s{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}}const u="";class p extends s{constructor(e,t){super(e),t&&(this.root=t.root)}}function _(e){if(isNaN(e))throw new Error(`Invalid value '${e}' specified. Must be an integer.`);return Math.floor(e)}function g(e){const t=_(e);if(t<0)throw new Error(`Invalid value '${e}' specified. Must be a positive integer.`);return t}function m(e,t){const i=2*t;if(e.length!==i||isNaN(Number("0x"+e)))throw new Error(`Invalid hex value '${e}'. Expected ${i} digit hex value`);return e}function f(e){return m(e,4)}function w(e){return m(e,2)}function C(e){return m(e,1)}function y(e){const t=e.slice(-2);if(!E.includes(t))throw new Error(`Invalid unit '${t}' specified. Valid units are ${E.join(", ")}`);const i=e.substring(0,e.length-2);if(isNaN(Number(i)))throw new Error(`Invalid value '${i}' specified. Expected a valid number.`);return`${Number(i)}${t}`}const E=["mm","cm","in","pt","pc","pi"];function b(e){const t=y(e);if(parseFloat(t)<0)throw new Error(`Invalid value '${t}' specified. Expected a positive number.`);return t}function B(e){return"auto"===e?e:m("#"===e.charAt(0)?e.substring(1):e,3)}function P(e){return"string"==typeof e?y(e):_(e)}function S(e){return"string"==typeof e?b(e):g(e)}function v(e){return"string"==typeof e?y(e):_(e)}function R(e){return"string"==typeof e?b(e):g(e)}function I(e){if("%"!==e.slice(-1))throw new Error(`Invalid value '${e}'. Expected percentage value (eg '55%')`);const t=e.substring(0,e.length-1);if(isNaN(Number(t)))throw new Error(`Invalid value '${t}' specified. Expected a valid number.`);return`${Number(t)}%`}function T(e){return"number"==typeof e?_(e):"%"===e.slice(-1)?I(e):y(e)}const x=g,O=g;function D(e){return e.toISOString()}class L extends s{constructor(e,t=!0){super(e),!0!==t&&this.root.push(new a({val:t}))}}class F extends s{constructor(e,t){super(e),this.root.push(new a({val:S(t)}))}}class H extends s{constructor(e,t){super(e),this.root.push(new a({val:t}))}}class N extends s{constructor(e,t){super(e),this.root.push(new a({val:t}))}}class U extends s{constructor(e,t){super(e),this.root.push(t)}}var M,k,Q,V,G,$,W,K;!function(e){e.START="start",e.END="end",e.CENTER="center",e.BOTH="both",e.JUSTIFIED="both",e.DISTRIBUTE="distribute",e.LEFT="left",e.RIGHT="right"}(M||(M={}));class z extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class j extends s{constructor(e){super("w:jc"),this.root.push(new z({val:e}))}}class X extends s{constructor(e,{color:t,size:i,space:r,style:s}){super(e),this.root.push(new Y({style:s,color:void 0===t?void 0:B(t),size:void 0===i?void 0:x(i),space:void 0===r?void 0:O(r)}))}}class Y extends o{constructor(){super(...arguments),this.xmlKeys={style:"w:val",color:"w:color",size:"w:sz",space:"w:space"}}}!function(e){e.SINGLE="single",e.DASH_DOT_STROKED="dashDotStroked",e.DASHED="dashed",e.DASH_SMALL_GAP="dashSmallGap",e.DOT_DASH="dotDash",e.DOT_DOT_DASH="dotDotDash",e.DOTTED="dotted",e.DOUBLE="double",e.DOUBLE_WAVE="doubleWave",e.INSET="inset",e.NIL="nil",e.NONE="none",e.OUTSET="outset",e.THICK="thick",e.THICK_THIN_LARGE_GAP="thickThinLargeGap",e.THICK_THIN_MEDIUM_GAP="thickThinMediumGap",e.THICK_THIN_SMALL_GAP="thickThinSmallGap",e.THIN_THICK_LARGE_GAP="thinThickLargeGap",e.THIN_THICK_MEDIUM_GAP="thinThickMediumGap",e.THIN_THICK_SMALL_GAP="thinThickSmallGap",e.THIN_THICK_THIN_LARGE_GAP="thinThickThinLargeGap",e.THIN_THICK_THIN_MEDIUM_GAP="thinThickThinMediumGap",e.THIN_THICK_THIN_SMALL_GAP="thinThickThinSmallGap",e.THREE_D_EMBOSS="threeDEmboss",e.THREE_D_ENGRAVE="threeDEngrave",e.TRIPLE="triple",e.WAVE="wave"}(k||(k={}));class J extends n{constructor(e){super("w:pBdr"),e.top&&this.root.push(new X("w:top",e.top)),e.bottom&&this.root.push(new X("w:bottom",e.bottom)),e.left&&this.root.push(new X("w:left",e.left)),e.right&&this.root.push(new X("w:right",e.right))}}class q extends s{constructor(){super("w:pBdr");const e=new X("w:bottom",{color:"auto",space:1,style:k.SINGLE,size:6});this.root.push(e)}}class Z extends o{constructor(){super(...arguments),this.xmlKeys={start:"w:start",end:"w:end",left:"w:left",right:"w:right",hanging:"w:hanging",firstLine:"w:firstLine"}}}class ee extends s{constructor({start:e,end:t,left:i,right:r,hanging:s,firstLine:n}){super("w:ind"),this.root.push(new Z({start:void 0===e?void 0:P(e),end:void 0===t?void 0:P(t),left:void 0===i?void 0:P(i),right:void 0===r?void 0:P(r),hanging:void 0===s?void 0:R(s),firstLine:void 0===n?void 0:R(n)}))}}class te extends s{constructor(){super("w:br")}}!function(e){e.BEGIN="begin",e.END="end",e.SEPARATE="separate"}(Q||(Q={}));class ie extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:fldCharType",dirty:"w:dirty"}}}class re extends s{constructor(e){super("w:fldChar"),this.root.push(new ie({type:Q.BEGIN,dirty:e}))}}class se extends s{constructor(e){super("w:fldChar"),this.root.push(new ie({type:Q.SEPARATE,dirty:e}))}}class ne extends s{constructor(e){super("w:fldChar"),this.root.push(new ie({type:Q.END,dirty:e}))}}!function(e){e.DEFAULT="default",e.PRESERVE="preserve"}(V||(V={}));class oe extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class ae extends s{constructor(){super("w:instrText"),this.root.push(new oe({space:V.PRESERVE})),this.root.push("PAGE")}}class Ae extends s{constructor(){super("w:instrText"),this.root.push(new oe({space:V.PRESERVE})),this.root.push("NUMPAGES")}}class le extends s{constructor(){super("w:instrText"),this.root.push(new oe({space:V.PRESERVE})),this.root.push("SECTIONPAGES")}}class he extends o{constructor(){super(...arguments),this.xmlKeys={id:"w:id",author:"w:author",date:"w:date"}}}class de extends o{constructor(){super(...arguments),this.xmlKeys={fill:"w:fill",color:"w:color",type:"w:val"}}}class ce extends s{constructor({fill:e,color:t,type:i}){super("w:shd"),this.root.push(new de({fill:void 0===e?void 0:B(e),color:void 0===t?void 0:B(t),type:i}))}}!function(e){e.CLEAR="clear",e.DIAGONAL_CROSS="diagCross",e.DIAGONAL_STRIPE="diagStripe",e.HORIZONTAL_CROSS="horzCross",e.HORIZONTAL_STRIPE="horzStripe",e.NIL="nil",e.PERCENT_5="pct5",e.PERCENT_10="pct10",e.PERCENT_12="pct12",e.PERCENT_15="pct15",e.PERCENT_20="pct20",e.PERCENT_25="pct25",e.PERCENT_30="pct30",e.PERCENT_35="pct35",e.PERCENT_37="pct37",e.PERCENT_40="pct40",e.PERCENT_45="pct45",e.PERCENT_50="pct50",e.PERCENT_55="pct55",e.PERCENT_60="pct60",e.PERCENT_62="pct62",e.PERCENT_65="pct65",e.PERCENT_70="pct70",e.PERCENT_75="pct75",e.PERCENT_80="pct80",e.PERCENT_85="pct85",e.PERCENT_87="pct87",e.PERCENT_90="pct90",e.PERCENT_95="pct95",e.REVERSE_DIAGONAL_STRIPE="reverseDiagStripe",e.SOLID="solid",e.THIN_DIAGONAL_CROSS="thinDiagCross",e.THIN_DIAGONAL_STRIPE="thinDiagStripe",e.THIN_HORIZONTAL_CROSS="thinHorzCross",e.THIN_REVERSE_DIAGONAL_STRIPE="thinReverseDiagStripe",e.THIN_VERTICAL_STRIPE="thinVertStripe",e.VERTICAL_STRIPE="vertStripe"}(G||(G={})),function(e){e.DOT="dot"}($||($={}));class ue extends s{constructor(e){super("w:em"),this.root.push(new a({val:e}))}}class pe extends ue{constructor(e=$.DOT){super(e)}}class _e extends ue{constructor(){super($.DOT)}}class ge extends s{constructor(e){super("w:spacing"),this.root.push(new a({val:P(e)}))}}class me extends s{constructor(e){super("w:color"),this.root.push(new a({val:B(e)}))}}class fe extends s{constructor(e){super("w:highlight"),this.root.push(new a({val:e}))}}class we extends s{constructor(e){super("w:highlightCs"),this.root.push(new a({val:e}))}}class Ce extends o{constructor(){super(...arguments),this.xmlKeys={ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"}}}class ye extends s{constructor(e,t){if(super("w:rFonts"),"string"==typeof e){const i=e;this.root.push(new Ce({ascii:i,cs:i,eastAsia:i,hAnsi:i,hint:t}))}else{const t=e;this.root.push(new Ce(t))}}}class Ee extends s{constructor(e){super("w:vertAlign"),this.root.push(new a({val:e}))}}class be extends Ee{constructor(){super("superscript")}}class Be extends Ee{constructor(){super("subscript")}}!function(e){e.SINGLE="single",e.WORDS="words",e.DOUBLE="double",e.THICK="thick",e.DOTTED="dotted",e.DOTTEDHEAVY="dottedHeavy",e.DASH="dash",e.DASHEDHEAVY="dashedHeavy",e.DASHLONG="dashLong",e.DASHLONGHEAVY="dashLongHeavy",e.DOTDASH="dotDash",e.DASHDOTHEAVY="dashDotHeavy",e.DOTDOTDASH="dotDotDash",e.DASHDOTDOTHEAVY="dashDotDotHeavy",e.WAVE="wave",e.WAVYHEAVY="wavyHeavy",e.WAVYDOUBLE="wavyDouble"}(W||(W={}));class Pe extends s{constructor(e=W.SINGLE,t){super("w:u"),this.root.push(new a({val:e,color:void 0===t?void 0:B(t)}))}}class Se extends n{constructor(e){var t,i;if(super("w:rPr"),!e)return;void 0!==e.bold&&this.push(new L("w:b",e.bold)),(void 0===e.boldComplexScript&&void 0!==e.bold||e.boldComplexScript)&&this.push(new L("w:bCs",null!==(t=e.boldComplexScript)&&void 0!==t?t:e.bold)),void 0!==e.italics&&this.push(new L("w:i",e.italics)),(void 0===e.italicsComplexScript&&void 0!==e.italics||e.italicsComplexScript)&&this.push(new L("w:iCs",null!==(i=e.italicsComplexScript)&&void 0!==i?i:e.italics)),e.underline&&this.push(new Pe(e.underline.type,e.underline.color)),e.emphasisMark&&this.push(new pe(e.emphasisMark.type)),e.color&&this.push(new me(e.color)),void 0!==e.size&&this.push(new F("w:sz",e.size));const r=void 0===e.sizeComplexScript||!0===e.sizeComplexScript?e.size:e.sizeComplexScript;r&&this.push(new F("w:szCs",r)),void 0!==e.rightToLeft&&this.push(new L("w:rtl",e.rightToLeft)),void 0!==e.smallCaps?this.push(new L("w:smallCaps",e.smallCaps)):void 0!==e.allCaps&&this.push(new L("w:caps",e.allCaps)),void 0!==e.strike&&this.push(new L("w:strike",e.strike)),void 0!==e.doubleStrike&&this.push(new L("w:dstrike",e.doubleStrike)),e.subScript&&this.push(new Be),e.superScript&&this.push(new be),e.style&&this.push(new H("w:rStyle",e.style)),e.font&&("string"==typeof e.font?this.push(new ye(e.font)):"name"in e.font?this.push(new ye(e.font.name,e.font.hint)):this.push(new ye(e.font))),e.highlight&&this.push(new fe(e.highlight));const s=void 0===e.highlightComplexScript||!0===e.highlightComplexScript?e.highlight:e.highlightComplexScript;s&&this.push(new we(s)),e.characterSpacing&&this.push(new ge(e.characterSpacing)),void 0!==e.emboss&&this.push(new L("w:emboss",e.emboss)),void 0!==e.imprint&&this.push(new L("w:imprint",e.imprint)),e.shading&&this.push(new ce(e.shading)),e.revision&&this.push(new ve(e.revision))}push(e){this.root.push(e)}}class ve extends s{constructor(e){super("w:rPrChange"),this.root.push(new he({id:e.id,author:e.author,date:e.date})),this.addChildElement(new Se(e))}}class Re extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class Ie extends s{constructor(e){super("w:t"),this.root.push(new Re({space:V.PRESERVE})),this.root.push(e)}}!function(e){e.CURRENT="CURRENT",e.TOTAL_PAGES="TOTAL_PAGES",e.TOTAL_PAGES_IN_SECTION="TOTAL_PAGES_IN_SECTION"}(K||(K={}));class Te extends s{constructor(e){if(super("w:r"),this.properties=new Se(e),this.root.push(this.properties),e.break)for(let t=0;t<e.break;t++)this.root.push(new te);if(e.children)for(const t of e.children)if("string"!=typeof t)this.root.push(t);else switch(t){case K.CURRENT:this.root.push(new re),this.root.push(new ae),this.root.push(new se),this.root.push(new ne);break;case K.TOTAL_PAGES:this.root.push(new re),this.root.push(new Ae),this.root.push(new se),this.root.push(new ne);break;case K.TOTAL_PAGES_IN_SECTION:this.root.push(new re),this.root.push(new le),this.root.push(new se),this.root.push(new ne);break;default:this.root.push(new Ie(t))}else e.text&&this.root.push(new Ie(e.text))}}class xe extends Te{constructor(e){if("string"==typeof e)return super({}),this.root.push(new Ie(e)),this;super(e)}}class Oe extends o{constructor(){super(...arguments),this.xmlKeys={char:"w:char",symbolfont:"w:font"}}}class De extends s{constructor(e="",t="Wingdings"){super("w:sym"),this.root.push(new Oe({char:e,symbolfont:t}))}}class Le extends Te{constructor(e){if("string"==typeof e)return super({}),void this.root.push(new De(e));super(e),this.root.push(new De(e.char,e.symbolfont))}}let Fe=0;const He=e=>Math.floor(e/25.4*72*20),Ne=e=>Math.floor(72*e*20),Ue=()=>++Fe,Me=()=>((e=21)=>{let t="",i=e;for(;i--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t})().toLowerCase();var ke,Qe,Ve,Ge,$e,We,Ke,ze,je,Xe,Ye,Je,qe,Ze,et,tt,it,rt,st,nt,ot,at,At,lt;!function(e){e.CHARACTER="character",e.COLUMN="column",e.INSIDE_MARGIN="insideMargin",e.LEFT_MARGIN="leftMargin",e.MARGIN="margin",e.OUTSIDE_MARGIN="outsideMargin",e.PAGE="page",e.RIGHT_MARGIN="rightMargin"}(ke||(ke={})),function(e){e.BOTTOM_MARGIN="bottomMargin",e.INSIDE_MARGIN="insideMargin",e.LINE="line",e.MARGIN="margin",e.OUTSIDE_MARGIN="outsideMargin",e.PAGE="page",e.PARAGRAPH="paragraph",e.TOP_MARGIN="topMargin"}(Qe||(Qe={}));class ht extends o{constructor(){super(...arguments),this.xmlKeys={x:"x",y:"y"}}}class dt extends s{constructor(){super("wp:simplePos"),this.root.push(new ht({x:0,y:0}))}}class ct extends s{constructor(e){super("wp:align"),this.root.push(e)}}class ut extends s{constructor(e){super("wp:posOffset"),this.root.push(e.toString())}}class pt extends o{constructor(){super(...arguments),this.xmlKeys={relativeFrom:"relativeFrom"}}}class _t extends s{constructor(e){if(super("wp:positionH"),this.root.push(new pt({relativeFrom:e.relative||ke.PAGE})),e.align)this.root.push(new ct(e.align));else{if(void 0===e.offset)throw new Error("There is no configuration provided for floating position (Align or offset)");this.root.push(new ut(e.offset))}}}class gt extends o{constructor(){super(...arguments),this.xmlKeys={relativeFrom:"relativeFrom"}}}class mt extends s{constructor(e){if(super("wp:positionV"),this.root.push(new gt({relativeFrom:e.relative||Qe.PAGE})),e.align)this.root.push(new ct(e.align));else{if(void 0===e.offset)throw new Error("There is no configuration provided for floating position (Align or offset)");this.root.push(new ut(e.offset))}}}class ft extends o{constructor(){super(...arguments),this.xmlKeys={uri:"uri"}}}class wt extends o{constructor(){super(...arguments),this.xmlKeys={embed:"r:embed",cstate:"cstate"}}}class Ct extends s{constructor(e){super("a:blip"),this.root.push(new wt({embed:`rId{${e.fileName}}`,cstate:"none"}))}}class yt extends s{constructor(){super("a:srcRect")}}class Et extends s{constructor(){super("a:fillRect")}}class bt extends s{constructor(){super("a:stretch"),this.root.push(new Et)}}class Bt extends s{constructor(e){super("pic:blipFill"),this.root.push(new Ct(e)),this.root.push(new yt),this.root.push(new bt)}}class Pt extends o{constructor(){super(...arguments),this.xmlKeys={noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"}}}class St extends s{constructor(){super("a:picLocks"),this.root.push(new Pt({noChangeAspect:1,noChangeArrowheads:1}))}}class vt extends s{constructor(){super("pic:cNvPicPr"),this.root.push(new St)}}class Rt extends o{constructor(){super(...arguments),this.xmlKeys={id:"id",name:"name",descr:"descr"}}}class It extends s{constructor(){super("pic:cNvPr"),this.root.push(new Rt({id:0,name:"",descr:""}))}}class Tt extends s{constructor(){super("pic:nvPicPr"),this.root.push(new It),this.root.push(new vt)}}class xt extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns:pic"}}}class Ot extends o{constructor(){super(...arguments),this.xmlKeys={cx:"cx",cy:"cy"}}}class Dt extends s{constructor(e,t){super("a:ext"),this.attributes=new Ot({cx:e,cy:t}),this.root.push(this.attributes)}}class Lt extends o{constructor(){super(...arguments),this.xmlKeys={x:"x",y:"y"}}}class Ft extends s{constructor(){super("a:off"),this.root.push(new Lt({x:0,y:0}))}}class Ht extends o{constructor(){super(...arguments),this.xmlKeys={flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"}}}class Nt extends s{constructor(e){var t,i;super("a:xfrm"),this.root.push(new Ht({flipVertical:null===(t=e.flip)||void 0===t?void 0:t.vertical,flipHorizontal:null===(i=e.flip)||void 0===i?void 0:i.horizontal,rotation:e.rotation})),this.extents=new Dt(e.emus.x,e.emus.y),this.root.push(new Ft),this.root.push(this.extents)}}class Ut extends s{constructor(){super("a:avLst")}}class Mt extends o{constructor(){super(...arguments),this.xmlKeys={prst:"prst"}}}class kt extends s{constructor(){super("a:prstGeom"),this.root.push(new Mt({prst:"rect"})),this.root.push(new Ut)}}class Qt extends o{constructor(){super(...arguments),this.xmlKeys={bwMode:"bwMode"}}}class Vt extends s{constructor(e){super("pic:spPr"),this.root.push(new Qt({bwMode:"auto"})),this.form=new Nt(e),this.root.push(this.form),this.root.push(new kt)}}class Gt extends s{constructor(e,t){super("pic:pic"),this.root.push(new xt({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new Tt),this.root.push(new Bt(e)),this.root.push(new Vt(t))}}class $t extends s{constructor(e,t){super("a:graphicData"),this.root.push(new ft({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new Gt(e,t),this.root.push(this.pic)}}class Wt extends o{constructor(){super(...arguments),this.xmlKeys={a:"xmlns:a"}}}class Kt extends s{constructor(e,t){super("a:graphic"),this.root.push(new Wt({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new $t(e,t),this.root.push(this.data)}}!function(e){e[e.NONE=0]="NONE",e[e.SQUARE=1]="SQUARE",e[e.TIGHT=2]="TIGHT",e[e.TOP_AND_BOTTOM=3]="TOP_AND_BOTTOM"}(Ve||(Ve={})),function(e){e.BOTH_SIDES="bothSides",e.LEFT="left",e.RIGHT="right",e.LARGEST="largest"}(Ge||(Ge={}));class zt extends s{constructor(){super("wp:wrapNone")}}class jt extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"}}}class Xt extends s{constructor(e,t={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new jt({wrapText:e.side||Ge.BOTH_SIDES,distT:t.top,distB:t.bottom,distL:t.left,distR:t.right}))}}class Yt extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB"}}}class Jt extends s{constructor(e={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new Yt({distT:e.top,distB:e.bottom}))}}class qt extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB"}}}class Zt extends s{constructor(e={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new qt({distT:e.top,distB:e.bottom}))}}class ei extends o{constructor(){super(...arguments),this.xmlKeys={id:"id",name:"name",descr:"descr"}}}class ti extends s{constructor(){super("wp:docPr"),this.root.push(new ei({id:0,name:"",descr:""}))}}class ii extends o{constructor(){super(...arguments),this.xmlKeys={b:"b",l:"l",r:"r",t:"t"}}}class ri extends s{constructor(){super("wp:effectExtent"),this.root.push(new ii({b:0,l:0,r:0,t:0}))}}class si extends o{constructor(){super(...arguments),this.xmlKeys={cx:"cx",cy:"cy"}}}class ni extends s{constructor(e,t){super("wp:extent"),this.attributes=new si({cx:e,cy:t}),this.root.push(this.attributes)}}class oi extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"}}}class ai extends s{constructor(){super("a:graphicFrameLocks"),this.root.push(new oi({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}}class Ai extends s{constructor(){super("wp:cNvGraphicFramePr"),this.root.push(new ai)}}class li extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"}}}class hi extends s{constructor(e,t,i){super("wp:anchor");const r=Object.assign({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},i.floating);if(this.root.push(new li({distT:r.margins&&r.margins.top||0,distB:r.margins&&r.margins.bottom||0,distL:r.margins&&r.margins.left||0,distR:r.margins&&r.margins.right||0,simplePos:"0",allowOverlap:!0===r.allowOverlap?"1":"0",behindDoc:!0===r.behindDocument?"1":"0",locked:!0===r.lockAnchor?"1":"0",layoutInCell:!0===r.layoutInCell?"1":"0",relativeHeight:r.zIndex?r.zIndex:t.emus.y})),this.root.push(new dt),this.root.push(new _t(r.horizontalPosition)),this.root.push(new mt(r.verticalPosition)),this.root.push(new ni(t.emus.x,t.emus.y)),this.root.push(new ri),void 0!==i.floating&&void 0!==i.floating.wrap)switch(i.floating.wrap.type){case Ve.SQUARE:this.root.push(new Xt(i.floating.wrap,i.floating.margins));break;case Ve.TIGHT:this.root.push(new Jt(i.floating.margins));break;case Ve.TOP_AND_BOTTOM:this.root.push(new Zt(i.floating.margins));break;case Ve.NONE:default:this.root.push(new zt)}else this.root.push(new zt);this.root.push(new ti),this.root.push(new Ai),this.root.push(new Kt(e,t))}}class di extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR"}}}class ci extends s{constructor(e,t){super("wp:inline"),this.root.push(new di({distT:0,distB:0,distL:0,distR:0})),this.extent=new ni(t.emus.x,t.emus.y),this.graphic=new Kt(e,t),this.root.push(this.extent),this.root.push(new ri),this.root.push(new ti),this.root.push(new Ai),this.root.push(this.graphic)}}class ui extends s{constructor(e,t={}){super("w:drawing"),t.floating?this.root.push(new hi(e,e.transformation,t)):(this.inline=new ci(e,e.transformation),this.root.push(this.inline))}}class pi extends Te{constructor(e){super({}),this.key=`${Me()}.png`;const t="string"==typeof e.data?this.convertDataURIToBinary(e.data):e.data;this.imageData={stream:t,fileName:this.key,transformation:{pixels:{x:Math.round(e.transformation.width),y:Math.round(e.transformation.height)},emus:{x:Math.round(9525*e.transformation.width),y:Math.round(9525*e.transformation.height)},flip:e.transformation.flip,rotation:e.transformation.rotation?6e4*e.transformation.rotation:void 0}};const i=new ui(this.imageData,{floating:e.floating});this.root.push(i)}prepForXml(e){return e.file.Media.addImage(this.key,this.imageData),super.prepForXml(e)}convertDataURIToBinary(e){const t=";base64,",r=e.indexOf(t)+t.length;return"function"==typeof atob?new Uint8Array(atob(e.substring(r)).split("").map((e=>e.charCodeAt(0)))):new(i(764).Buffer)(e,"base64")}}class _i extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class gi extends s{constructor(e){super("w:instrText"),this.root.push(new _i({space:V.PRESERVE})),this.root.push(`SEQ ${e}`)}}class mi extends Te{constructor(e){super({}),this.root.push(new re(!0)),this.root.push(new gi(e)),this.root.push(new se),this.root.push(new ne)}}class fi extends s{constructor(){super("w:tab")}}class wi extends o{constructor(){super(...arguments),this.xmlKeys={instr:"w:instr"}}}class Ci extends s{constructor(e,t){super("w:fldSimple"),this.root.push(new wi({instr:e})),void 0!==t&&this.root.push(new xe(t))}}class yi extends Ci{constructor(e){super(` MERGEFIELD ${e} `,`«${e}»`)}}!function(e){e.COLUMN="column",e.PAGE="page"}($e||($e={}));class Ei extends s{constructor(e){super("w:br"),this.root.push(new a({type:e}))}}class bi extends Te{constructor(){super({}),this.root.push(new Ei($e.PAGE))}}class Bi extends Te{constructor(){super({}),this.root.push(new Ei($e.COLUMN))}}class Pi extends s{constructor(){super("w:pageBreakBefore")}}!function(e){e.AT_LEAST="atLeast",e.EXACTLY="exactly",e.AUTO="auto"}(We||(We={}));class Si extends o{constructor(){super(...arguments),this.xmlKeys={after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"}}}class vi extends s{constructor(e){super("w:spacing"),this.root.push(new Si(e))}}!function(e){e.HEADING_1="Heading1",e.HEADING_2="Heading2",e.HEADING_3="Heading3",e.HEADING_4="Heading4",e.HEADING_5="Heading5",e.HEADING_6="Heading6",e.TITLE="Title"}(Ke||(Ke={}));class Ri extends s{constructor(e){super("w:pStyle"),this.root.push(new a({val:e}))}}class Ii extends s{constructor(e,t,i){super("w:tabs"),this.root.push(new xi(e,t,i))}}!function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.BAR="bar",e.CLEAR="clear",e.DECIMAL="decimal",e.END="end",e.NUM="num",e.START="start"}(ze||(ze={})),function(e){e.DOT="dot",e.HYPHEN="hyphen",e.MIDDLE_DOT="middleDot",e.NONE="none",e.UNDERSCORE="underscore"}(je||(je={})),function(e){e[e.MAX=9026]="MAX"}(Xe||(Xe={}));class Ti extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val",pos:"w:pos",leader:"w:leader"}}}class xi extends s{constructor(e,t,i){super("w:tab"),this.root.push(new Ti({val:e,pos:t,leader:i}))}}class Oi extends s{constructor(e,t){super("w:numPr"),this.root.push(new Di(t)),this.root.push(new Li(e))}}class Di extends s{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new a({val:e}))}}class Li extends s{constructor(e){super("w:numId"),this.root.push(new a({val:"string"==typeof e?`{${e}}`:e}))}}class Fi extends o{constructor(){super(...arguments),this.xmlKeys={id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"}}}!function(e){e.EXTERNAL="External"}(Ye||(Ye={}));class Hi extends s{constructor(e,t,i,r){super("Relationship"),this.root.push(new Fi({id:e,type:t,target:i,targetMode:r}))}}class Ni extends o{constructor(){super(...arguments),this.xmlKeys={id:"r:id",history:"w:history",anchor:"w:anchor"}}}!function(e){e.INTERNAL="INTERNAL",e.EXTERNAL="EXTERNAL"}(Je||(Je={}));class Ui extends s{constructor(e,t,i){super("w:hyperlink"),this.linkId=t;const r={history:1,anchor:i||void 0,id:i?void 0:`rId${this.linkId}`},s=new Ni(r);this.root.push(s),e.forEach((e=>{this.root.push(e)}))}}class Mi extends Ui{constructor(e){super(e.children,Me(),e.anchor)}}class ki{constructor(e){this.options=e}}class Qi extends o{constructor(){super(...arguments),this.xmlKeys={id:"w:id",name:"w:name"}}}class Vi extends o{constructor(){super(...arguments),this.xmlKeys={id:"w:id"}}}class Gi{constructor(e){const t=Ue();this.start=new $i(e.id,t),this.children=e.children,this.end=new Wi(t)}}class $i extends s{constructor(e,t){super("w:bookmarkStart");const i=new Qi({name:e,id:t});this.root.push(i)}}class Wi extends s{constructor(e){super("w:bookmarkEnd");const t=new Vi({id:e});this.root.push(t)}}class Ki extends s{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new a({val:e}))}}class zi extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class ji extends s{constructor(e,t={}){super("w:instrText"),this.root.push(new zi({space:V.PRESERVE}));let i=`PAGEREF ${e}`;t.hyperlink&&(i=`${i} \\h`),t.useRelativePosition&&(i=`${i} \\p`),this.root.push(i)}}class Xi extends Te{constructor(e,t={}){super({children:[new re(!0),new ji(e,t),new ne]})}}!function(e){e.BOTH="both",e.BOTTOM="bottom",e.CENTER="center",e.TOP="top"}(qe||(qe={}));class Yi extends o{constructor(){super(...arguments),this.xmlKeys={verticalAlign:"w:val"}}}class Ji extends s{constructor(e){super("w:vAlign"),this.root.push(new Yi({verticalAlign:e}))}}!function(e){e.DEFAULT="default",e.FIRST="first",e.EVEN="even"}(Ze||(Ze={}));class qi extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",id:"r:id"}}}!function(e){e.HEADER="w:headerReference",e.FOOTER="w:footerReference"}(et||(et={}));class Zi extends s{constructor(e,t){super(e),this.root.push(new qi({type:t.type||Ze.DEFAULT,id:`rId${t.id}`}))}}class er extends o{constructor(){super(...arguments),this.xmlKeys={space:"w:space",count:"w:num",separate:"w:sep",equalWidth:"w:equalWidth"}}}class tr extends s{constructor({space:e,count:t,separate:i,equalWidth:r,children:s}){super("w:cols"),this.root.push(new er({space:void 0===e?void 0:R(e),count:void 0===t?void 0:_(t),separate:i,equalWidth:r})),!r&&s&&s.forEach((e=>this.addChildElement(e)))}}!function(e){e.DEFAULT="default",e.LINES="lines",e.LINES_AND_CHARS="linesAndChars",e.SNAP_TO_CHARS="snapToChars"}(tt||(tt={}));class ir extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"}}}class rr extends s{constructor(e,t,i){super("w:docGrid"),this.root.push(new ir({type:i,linePitch:_(e),charSpace:t?_(t):void 0}))}}!function(e){e.NEW_PAGE="newPage",e.NEW_SECTION="newSection",e.CONTINUOUS="continuous"}(it||(it={}));class sr extends o{constructor(){super(...arguments),this.xmlKeys={countBy:"w:countBy",start:"w:start",restart:"w:restart",distance:"w:distance"}}}class nr extends s{constructor({countBy:e,start:t,restart:i,distance:r}){super("w:lnNumType"),this.root.push(new sr({countBy:void 0===e?void 0:_(e),start:void 0===t?void 0:_(t),restart:i,distance:void 0===r?void 0:R(r)}))}}!function(e){e.ALL_PAGES="allPages",e.FIRST_PAGE="firstPage",e.NOT_FIRST_PAGE="notFirstPage"}(rt||(rt={})),function(e){e.PAGE="page",e.TEXT="text"}(st||(st={})),function(e){e.BACK="back",e.FRONT="front"}(nt||(nt={}));class or extends o{constructor(){super(...arguments),this.xmlKeys={display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"}}}class ar extends n{constructor(e){super("w:pgBorders"),e&&(e.pageBorders?this.root.push(new or({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new or({})),e.pageBorderTop&&this.root.push(new X("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new X("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new X("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new X("w:right",e.pageBorderRight)))}}class Ar extends o{constructor(){super(...arguments),this.xmlKeys={top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter"}}}class lr extends s{constructor(e,t,i,r,s,n,o){super("w:pgMar"),this.root.push(new Ar({top:P(e),right:R(t),bottom:P(i),left:R(r),header:R(s),footer:R(n),gutter:R(o)}))}}!function(e){e.HYPHEN="hyphen",e.PERIOD="period",e.COLON="colon",e.EM_DASH="emDash",e.EN_DASH="endash"}(ot||(ot={}));class hr extends o{constructor(){super(...arguments),this.xmlKeys={start:"w:start",formatType:"w:fmt",separator:"w:chapSep"}}}class dr extends s{constructor({start:e,formatType:t,separator:i}){super("w:pgNumType"),this.root.push(new hr({start:void 0===e?void 0:_(e),formatType:t,separator:i}))}}!function(e){e.PORTRAIT="portrait",e.LANDSCAPE="landscape"}(at||(at={}));class cr extends o{constructor(){super(...arguments),this.xmlKeys={width:"w:w",height:"w:h",orientation:"w:orient"}}}class ur extends s{constructor(e,t,i){super("w:pgSz");const r=i===at.LANDSCAPE,s=R(e),n=R(t);this.root.push(new cr({width:r?n:s,height:r?s:n,orientation:i}))}}!function(e){e.LEFT_TO_RIGHT_TOP_TO_BOTTOM="lrTb",e.TOP_TO_BOTTOM_RIGHT_TO_LEFT="tbRl"}(At||(At={}));class pr extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class _r extends s{constructor(e){super("w:textDirection"),this.root.push(new pr({val:e}))}}!function(e){e.NEXT_PAGE="nextPage",e.NEXT_COLUMN="nextColumn",e.CONTINUOUS="continuous",e.EVEN_PAGE="evenPage",e.ODD_PAGE="oddPage"}(lt||(lt={}));class gr extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class mr extends s{constructor(e){super("w:type"),this.root.push(new gr({val:e}))}}const fr={TOP:"1in",RIGHT:"1in",BOTTOM:"1in",LEFT:"1in",HEADER:708,FOOTER:708,GUTTER:0},wr={WIDTH:11906,HEIGHT:16838,ORIENTATION:at.PORTRAIT};class Cr extends s{constructor({page:{size:{width:e=wr.WIDTH,height:t=wr.HEIGHT,orientation:i=wr.ORIENTATION}={},margin:{top:r=fr.TOP,right:s=fr.RIGHT,bottom:n=fr.BOTTOM,left:o=fr.LEFT,header:a=fr.HEADER,footer:A=fr.FOOTER,gutter:l=fr.GUTTER}={},pageNumbers:h={},borders:d,textDirection:c}={},grid:{linePitch:u=360,charSpace:p,type:_}={},headerWrapperGroup:g={},footerWrapperGroup:m={},lineNumbers:f,titlePage:w,verticalAlign:C,column:y,type:E}={}){super("w:sectPr"),this.addHeaderFooterGroup(et.HEADER,g),this.addHeaderFooterGroup(et.FOOTER,m),E&&this.root.push(new mr(E)),this.root.push(new ur(e,t,i)),this.root.push(new lr(r,s,n,o,a,A,l)),d&&this.root.push(new ar(d)),f&&this.root.push(new nr(f)),this.root.push(new dr(h)),y&&this.root.push(new tr(y)),C&&this.root.push(new Ji(C)),void 0!==w&&this.root.push(new L("w:titlePg",w)),c&&this.root.push(new _r(c)),this.root.push(new rr(u,p,_))}addHeaderFooterGroup(e,t){t.default&&this.root.push(new Zi(e,{type:Ze.DEFAULT,id:t.default.View.ReferenceId})),t.first&&this.root.push(new Zi(e,{type:Ze.FIRST,id:t.first.View.ReferenceId})),t.even&&this.root.push(new Zi(e,{type:Ze.EVEN,id:t.even.View.ReferenceId}))}}class yr extends s{constructor(){super("w:body"),this.sections=[]}addSection(e){const t=this.sections.pop();this.root.push(this.createSectionParagraph(t)),this.sections.push(new Cr(e))}prepForXml(e){return 1===this.sections.length&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){const t=new Nr({}),i=new Hr({});return i.push(e),t.addChildElement(i),t}}class Er extends o{constructor(){super(...arguments),this.xmlKeys={width:"w:w",space:"w:space"}}}class br extends s{constructor({width:e,space:t}){super("w:col"),this.root.push(new Er({width:R(e),space:void 0===t?void 0:R(t)}))}}class Br extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"}}}class Pr extends o{constructor(){super(...arguments),this.xmlKeys={color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"}}}class Sr extends s{constructor(e){super("w:background"),this.root.push(new Pr({color:void 0===e.color?void 0:B(e.color),themeColor:e.themeColor,themeShade:void 0===e.themeShade?void 0:C(e.themeShade),themeTint:void 0===e.themeTint?void 0:C(e.themeTint)}))}}class vr extends s{constructor(e){super("w:document"),this.root.push(new Br({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.body=new yr,this.root.push(new Sr(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}}class Rr extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns"}}}class Ir extends s{constructor(){super("Relationships"),this.root.push(new Rr({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}addRelationship(e){this.root.push(e)}createRelationship(e,t,i,r){const s=new Hi(`rId${e}`,t,i,r);return this.addRelationship(s),s}get RelationshipCount(){return this.root.length-1}}class Tr{constructor(e){this.document=new vr(e),this.relationships=new Ir}get View(){return this.document}get Relationships(){return this.relationships}}var xr,Or,Dr;!function(e){e.NONE="none",e.DROP="drop",e.MARGIN="margin"}(xr||(xr={})),function(e){e.MARGIN="margin",e.PAGE="page",e.TEXT="text"}(Or||(Or={})),function(e){e.AROUND="around",e.AUTO="auto",e.NONE="none",e.NOT_BESIDE="notBeside",e.THROUGH="through",e.TIGHT="tight"}(Dr||(Dr={}));class Lr extends o{constructor(){super(...arguments),this.xmlKeys={anchorLock:"w:anchorLock",dropCap:"w:dropCap",width:"w:w",height:"w:h",x:"w:x",y:"w:y",anchorHorizontal:"w:hAnchor",anchorVertical:"w:vAnchor",spaceHorizontal:"w:hSpace",spaceVertical:"w:vSpace",rule:"w:hRule",alignmentX:"w:xAlign",alignmentY:"w:yAlign",lines:"w:lines",wrap:"w:wrap"}}}class Fr extends s{constructor(e){var t,i;super("w:framePr"),this.root.push(new Lr({anchorLock:e.anchorLock,dropCap:e.dropCap,width:e.width,height:e.height,x:e.position.x,y:e.position.y,anchorHorizontal:e.anchor.horizontal,anchorVertical:e.anchor.vertical,spaceHorizontal:null===(t=e.space)||void 0===t?void 0:t.horizontal,spaceVertical:null===(i=e.space)||void 0===i?void 0:i.vertical,rule:e.rule,alignmentX:e.alignment.x,alignmentY:e.alignment.y,lines:e.lines,wrap:e.wrap}))}}class Hr extends n{constructor(e){var t,i;if(super("w:pPr"),this.numberingReferences=[],!e)return this;if(e.heading&&this.push(new Ri(e.heading)),e.bullet&&this.push(new Ri("ListParagraph")),e.numbering&&(e.style||e.heading||e.numbering.custom||this.push(new Ri("ListParagraph"))),e.style&&this.push(new Ri(e.style)),void 0!==e.keepNext&&this.push(new L("w:keepNext",e.keepNext)),void 0!==e.keepLines&&this.push(new L("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new Pi),e.frame&&this.push(new Fr(e.frame)),void 0!==e.widowControl&&this.push(new L("w:widowControl",e.widowControl)),e.bullet&&this.push(new Oi(1,e.bullet.level)),e.numbering&&(this.numberingReferences.push({reference:e.numbering.reference,instance:null!==(t=e.numbering.instance)&&void 0!==t?t:0}),this.push(new Oi(`${e.numbering.reference}-${null!==(i=e.numbering.instance)&&void 0!==i?i:0}`,e.numbering.level))),e.border&&this.push(new J(e.border)),e.thematicBreak&&this.push(new q),e.shading&&this.push(new ce(e.shading)),e.rightTabStop&&this.push(new Ii(ze.RIGHT,e.rightTabStop)),e.tabStops)for(const t of e.tabStops)this.push(new Ii(t.type,t.position,t.leader));e.leftTabStop&&this.push(new Ii(ze.LEFT,e.leftTabStop)),void 0!==e.bidirectional&&this.push(new L("w:bidi",e.bidirectional)),e.spacing&&this.push(new vi(e.spacing)),e.indent&&this.push(new ee(e.indent)),void 0!==e.contextualSpacing&&this.push(new L("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new j(e.alignment)),void 0!==e.outlineLevel&&this.push(new Ki(e.outlineLevel)),void 0!==e.suppressLineNumbers&&this.push(new L("w:suppressLineNumbers",e.suppressLineNumbers))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof Tr)for(const t of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(t.reference,t.instance);return super.prepForXml(e)}}class Nr extends s{constructor(e){if(super("w:p"),"string"==typeof e)return this.properties=new Hr({}),this.root.push(this.properties),this.root.push(new xe(e)),this;if(this.properties=new Hr(e),this.root.push(this.properties),e.text&&this.root.push(new xe(e.text)),e.children)for(const t of e.children)if(t instanceof Gi){this.root.push(t.start);for(const e of t.children)this.root.push(e);this.root.push(t.end)}else this.root.push(t)}prepForXml(e){for(const t of this.root)if(t instanceof ki){const i=this.root.indexOf(t),r=new Ui(t.options.children,Me());e.viewWrapper.Relationships.createRelationship(r.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.options.link,Ye.EXTERNAL),this.root[i]=r}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}}class Ur extends s{constructor(e){super("m:oMath");for(const t of e.children)this.root.push(t)}}class Mr extends s{constructor(e){super("m:t"),this.root.push(e)}}class kr extends s{constructor(e){super("m:r"),this.root.push(new Mr(e))}}class Qr extends s{constructor(e){super("m:den");for(const t of e)this.root.push(t)}}class Vr extends s{constructor(e){super("m:num");for(const t of e)this.root.push(t)}}class Gr extends s{constructor(e){super("m:f"),this.root.push(new Vr(e.numerator)),this.root.push(new Qr(e.denominator))}}class $r extends o{constructor(){super(...arguments),this.xmlKeys={accent:"m:val"}}}class Wr extends s{constructor(e){super("m:chr"),this.root.push(new $r({accent:e}))}}class Kr extends s{constructor(e){super("m:e");for(const t of e)this.root.push(t)}}class zr extends o{constructor(){super(...arguments),this.xmlKeys={value:"m:val"}}}class jr extends s{constructor(){super("m:limLoc"),this.root.push(new zr({value:"undOvr"}))}}class Xr extends o{constructor(){super(...arguments),this.xmlKeys={hide:"m:val"}}}class Yr extends s{constructor(){super("m:subHide"),this.root.push(new Xr({hide:1}))}}class Jr extends o{constructor(){super(...arguments),this.xmlKeys={hide:"m:val"}}}class qr extends s{constructor(){super("m:supHide"),this.root.push(new Jr({hide:1}))}}class Zr extends s{constructor(e,t,i){super("m:naryPr"),this.root.push(new Wr(e)),this.root.push(new jr),t||this.root.push(new qr),i||this.root.push(new Yr)}}class es extends s{constructor(e){super("m:sub");for(const t of e)this.root.push(t)}}class ts extends s{constructor(e){super("m:sup");for(const t of e)this.root.push(t)}}class is extends s{constructor(e){super("m:nary"),this.root.push(new Zr("∑",!!e.superScript,!!e.subScript)),e.subScript&&this.root.push(new es(e.subScript)),e.superScript&&this.root.push(new ts(e.superScript)),this.root.push(new Kr(e.children))}}class rs extends s{constructor(){super("m:sSupPr")}}class ss extends s{constructor(e){super("m:sSup"),this.root.push(new rs),this.root.push(new Kr(e.children)),this.root.push(new ts(e.superScript))}}class ns extends s{constructor(){super("m:sSubPr")}}class os extends s{constructor(e){super("m:sSub"),this.root.push(new ns),this.root.push(new Kr(e.children)),this.root.push(new es(e.subScript))}}class as extends s{constructor(){super("m:sSubSupPr")}}class As extends s{constructor(e){super("m:sSubSup"),this.root.push(new as),this.root.push(new Kr(e.children)),this.root.push(new es(e.subScript)),this.root.push(new ts(e.superScript))}}class ls extends s{constructor(){super("m:sPrePr")}}class hs extends s{constructor(e){super("m:sPre"),this.root.push(new ls),this.root.push(new Kr(e.children)),this.root.push(new es(e.subScript)),this.root.push(new ts(e.superScript))}}const ds="";class cs extends s{constructor(e){if(super("m:deg"),e)for(const t of e)this.root.push(t)}}class us extends o{constructor(){super(...arguments),this.xmlKeys={hide:"m:val"}}}class ps extends s{constructor(){super("m:degHide"),this.root.push(new us({hide:1}))}}class _s extends s{constructor(e){super("m:radPr"),e||this.root.push(new ps)}}class gs extends s{constructor(e){super("m:rad"),this.root.push(new _s(!!e.degree)),this.root.push(new cs(e.degree)),this.root.push(new Kr(e.children))}}class ms extends s{constructor(e){super("m:fName");for(const t of e)this.root.push(t)}}class fs extends s{constructor(){super("m:funcPr")}}class ws extends s{constructor(e){super("m:func"),this.root.push(new fs),this.root.push(new ms(e.name)),this.root.push(new Kr(e.children))}}class Cs extends o{constructor(){super(...arguments),this.xmlKeys={character:"m:val"}}}class ys extends s{constructor(e){super("m:begChr"),this.root.push(new Cs({character:e}))}}class Es extends o{constructor(){super(...arguments),this.xmlKeys={character:"m:val"}}}class bs extends s{constructor(e){super("m:endChr"),this.root.push(new Es({character:e}))}}class Bs extends s{constructor(e){super("m:dPr"),e&&(this.root.push(new ys(e.beginningCharacter)),this.root.push(new bs(e.endingCharacter)))}}class Ps extends s{constructor(e){super("m:d"),this.root.push(new Bs),this.root.push(new Kr(e.children))}}class Ss extends s{constructor(e){super("m:d"),this.root.push(new Bs({beginningCharacter:"[",endingCharacter:"]"})),this.root.push(new Kr(e.children))}}class vs extends s{constructor(e){super("m:d"),this.root.push(new Bs({beginningCharacter:"{",endingCharacter:"}"})),this.root.push(new Kr(e.children))}}class Rs extends s{constructor(e){super("m:d"),this.root.push(new Bs({beginningCharacter:"〈",endingCharacter:"〉"})),this.root.push(new Kr(e.children))}}class Is extends s{constructor(e){super("w:tblGrid");for(const t of e)this.root.push(new xs(t))}}class Ts extends o{constructor(){super(...arguments),this.xmlKeys={w:"w:w"}}}class xs extends s{constructor(e){super("w:gridCol"),void 0!==e&&this.root.push(new Ts({w:R(e)}))}}var Os,Ds,Ls,Fs;!function(e){e.AUTO="auto",e.DXA="dxa",e.NIL="nil",e.PERCENTAGE="pct"}(Os||(Os={}));class Hs extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",size:"w:w"}}}class Ns extends s{constructor(e,{type:t=Os.AUTO,size:i}){super(e);let r=i;t===Os.PERCENTAGE&&"number"==typeof i&&(r=`${i}%`),this.root.push(new Hs({type:t,size:T(r)}))}}!function(e){e.TABLE="w:tblCellMar",e.TABLE_CELL="w:tcMar"}(Ds||(Ds={}));class Us extends n{constructor(e,{marginUnitType:t=Os.DXA,top:i,left:r,bottom:s,right:n}){super(e),void 0!==i&&this.root.push(new Ns("w:top",{type:t,size:i})),void 0!==r&&this.root.push(new Ns("w:left",{type:t,size:r})),void 0!==s&&this.root.push(new Ns("w:bottom",{type:t,size:s})),void 0!==n&&this.root.push(new Ns("w:right",{type:t,size:n}))}}class Ms extends n{constructor(e){super("w:tcBorders"),e.top&&this.root.push(new X("w:top",e.top)),e.start&&this.root.push(new X("w:start",e.start)),e.left&&this.root.push(new X("w:left",e.left)),e.bottom&&this.root.push(new X("w:bottom",e.bottom)),e.end&&this.root.push(new X("w:end",e.end)),e.right&&this.root.push(new X("w:right",e.right))}}class ks extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class Qs extends s{constructor(e){super("w:gridSpan"),this.root.push(new ks({val:_(e)}))}}!function(e){e.CONTINUE="continue",e.RESTART="restart"}(Ls||(Ls={}));class Vs extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class Gs extends s{constructor(e){super("w:vMerge"),this.root.push(new Vs({val:e}))}}!function(e){e.BOTTOM_TO_TOP_LEFT_TO_RIGHT="btLr",e.LEFT_TO_RIGHT_TOP_TO_BOTTOM="lrTb",e.TOP_TO_BOTTOM_RIGHT_TO_LEFT="tbRl"}(Fs||(Fs={}));class $s extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class Ws extends s{constructor(e){super("w:textDirection"),this.root.push(new $s({val:e}))}}class Ks extends n{constructor(e){super("w:tcPr"),e.width&&this.root.push(new Ns("w:tcW",e.width)),e.columnSpan&&this.root.push(new Qs(e.columnSpan)),e.verticalMerge?this.root.push(new Gs(e.verticalMerge)):e.rowSpan&&e.rowSpan>1&&this.root.push(new Gs(Ls.RESTART)),e.borders&&this.root.push(new Ms(e.borders)),e.shading&&this.root.push(new ce(e.shading)),e.margins&&this.root.push(new Us(Ds.TABLE_CELL,e.margins)),e.textDirection&&this.root.push(new Ws(e.textDirection)),e.verticalAlign&&this.root.push(new Ji(e.verticalAlign))}}class zs extends s{constructor(e){super("w:tc"),this.options=e,this.root.push(new Ks(e));for(const t of e.children)this.root.push(t)}prepForXml(e){return this.root[this.root.length-1]instanceof Nr||this.root.push(new Nr({})),super.prepForXml(e)}}const js={style:k.NONE,size:0,color:"auto"},Xs={style:k.SINGLE,size:4,color:"auto"};class Ys extends s{constructor(e){super("w:tblBorders"),e.top?this.root.push(new X("w:top",e.top)):this.root.push(new X("w:top",Xs)),e.left?this.root.push(new X("w:left",e.left)):this.root.push(new X("w:left",Xs)),e.bottom?this.root.push(new X("w:bottom",e.bottom)):this.root.push(new X("w:bottom",Xs)),e.right?this.root.push(new X("w:right",e.right)):this.root.push(new X("w:right",Xs)),e.insideHorizontal?this.root.push(new X("w:insideH",e.insideHorizontal)):this.root.push(new X("w:insideH",Xs)),e.insideVertical?this.root.push(new X("w:insideV",e.insideVertical)):this.root.push(new X("w:insideV",Xs))}}var Js,qs,Zs,en,tn,rn,sn;Ys.NONE={top:js,bottom:js,left:js,right:js,insideHorizontal:js,insideVertical:js},function(e){e.NEVER="never",e.OVERLAP="overlap"}(Js||(Js={}));class nn extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class on extends s{constructor(e){super("w:tblOverlap"),this.root.push(new nn({val:e}))}}!function(e){e.MARGIN="margin",e.PAGE="page",e.TEXT="text"}(qs||(qs={})),function(e){e.CENTER="center",e.INSIDE="inside",e.LEFT="left",e.OUTSIDE="outside",e.RIGHT="right"}(Zs||(Zs={})),function(e){e.CENTER="center",e.INSIDE="inside",e.BOTTOM="bottom",e.OUTSIDE="outside",e.INLINE="inline",e.TOP="top"}(en||(en={}));class an extends o{constructor(){super(...arguments),this.xmlKeys={horizontalAnchor:"w:horzAnchor",verticalAnchor:"w:vertAnchor",absoluteHorizontalPosition:"w:tblpX",relativeHorizontalPosition:"w:tblpXSpec",absoluteVerticalPosition:"w:tblpY",relativeVerticalPosition:"w:tblpYSpec",bottomFromText:"w:bottomFromText",topFromText:"w:topFromText",leftFromText:"w:leftFromText",rightFromText:"w:rightFromText"}}}class An extends s{constructor(e){var{leftFromText:t,rightFromText:i,topFromText:r,bottomFromText:s,absoluteHorizontalPosition:n,absoluteVerticalPosition:o}=e,a=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]])}return i}(e,["leftFromText","rightFromText","topFromText","bottomFromText","absoluteHorizontalPosition","absoluteVerticalPosition"]);super("w:tblpPr"),this.root.push(new an(Object.assign({leftFromText:void 0===t?void 0:R(t),rightFromText:void 0===i?void 0:R(i),topFromText:void 0===r?void 0:R(r),bottomFromText:void 0===s?void 0:R(s),absoluteHorizontalPosition:void 0===n?void 0:P(n),absoluteVerticalPosition:void 0===o?void 0:P(o)},a))),a.overlap&&this.root.push(new on(a.overlap))}}!function(e){e.AUTOFIT="autofit",e.FIXED="fixed"}(tn||(tn={}));class ln extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type"}}}class hn extends s{constructor(e){super("w:tblLayout"),this.root.push(new ln({type:e}))}}class dn extends n{constructor(e){super("w:tblPr"),e.style&&this.root.push(new H("w:tblStyle",e.style)),e.float&&this.root.push(new An(e.float)),void 0!==e.visuallyRightToLeft&&this.root.push(new L("w:bidiVisual",e.visuallyRightToLeft)),e.width&&this.root.push(new Ns("w:tblW",e.width)),e.alignment&&this.root.push(new j(e.alignment)),e.indent&&this.root.push(new Ns("w:tblInd",e.indent)),e.borders&&this.root.push(new Ys(e.borders)),e.shading&&this.root.push(new ce(e.shading)),e.layout&&this.root.push(new hn(e.layout)),e.cellMargin&&this.root.push(new Us(Ds.TABLE,e.cellMargin))}}class cn extends s{constructor({rows:e,width:t,columnWidths:i=Array(Math.max(...e.map((e=>e.CellCount)))).fill(100),margins:r,indent:s,float:n,layout:o,style:a,borders:A,alignment:l,visuallyRightToLeft:h}){super("w:tbl"),this.root.push(new dn({borders:null!=A?A:{},width:null!=t?t:{size:100},indent:s,float:n,layout:o,style:a,alignment:l,cellMargin:r,visuallyRightToLeft:h})),this.root.push(new Is(i));for(const t of e)this.root.push(t);e.forEach(((t,i)=>{if(i===e.length-1)return;let r=0;t.cells.forEach((t=>{if(t.options.rowSpan&&t.options.rowSpan>1){const s=new zs({rowSpan:t.options.rowSpan-1,columnSpan:t.options.columnSpan,borders:t.options.borders,children:[],verticalMerge:Ls.CONTINUE});e[i+1].addCellToColumnIndex(s,r)}r+=t.options.columnSpan||1}))}))}}!function(e){e.AUTO="auto",e.ATLEAST="atLeast",e.EXACT="exact"}(rn||(rn={}));class un extends o{constructor(){super(...arguments),this.xmlKeys={value:"w:val",rule:"w:hRule"}}}class pn extends s{constructor(e,t){super("w:trHeight"),this.root.push(new un({value:R(e),rule:t}))}}class _n extends n{constructor(e){super("w:trPr"),void 0!==e.cantSplit&&this.root.push(new L("w:cantSplit",e.cantSplit)),void 0!==e.tableHeader&&this.root.push(new L("w:tblHeader",e.tableHeader)),e.height&&this.root.push(new pn(e.height.value,e.height.rule))}}class gn extends s{constructor(e){super("w:tr"),this.options=e,this.root.push(new _n(e));for(const t of e.children)this.root.push(t)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter((e=>e instanceof zs))}addCellToIndex(e,t){this.root.splice(t+1,0,e)}addCellToColumnIndex(e,t){const i=this.columnIndexToRootIndex(t,!0);this.addCellToIndex(e,i-1)}rootIndexToColumnIndex(e){if(e<1||e>=this.root.length)throw new Error("cell 'rootIndex' should between 1 to "+(this.root.length-1));let t=0;for(let i=1;i<e;i++)t+=this.root[i].options.columnSpan||1;return t}columnIndexToRootIndex(e,t=!1){if(e<0)throw new Error("cell 'columnIndex' should not less than zero");let i=0,r=1;for(;i<=e;){if(r>=this.root.length){if(t)return this.root.length;throw new Error("cell 'columnIndex' should not great than "+(i-1))}const e=this.root[r];r+=1,i+=e&&e.options.columnSpan||1}return r-1}}class mn extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns",vt:"xmlns:vt"}}}class fn extends s{constructor(){super("Properties"),this.root.push(new mn({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class wn extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns"}}}class Cn extends o{constructor(){super(...arguments),this.xmlKeys={contentType:"ContentType",extension:"Extension"}}}class yn extends s{constructor(e,t){super("Default"),this.root.push(new Cn({contentType:e,extension:t}))}}class En extends o{constructor(){super(...arguments),this.xmlKeys={contentType:"ContentType",partName:"PartName"}}}class bn extends s{constructor(e,t){super("Override"),this.root.push(new En({contentType:e,partName:t}))}}class Bn extends s{constructor(){super("Types"),this.root.push(new wn({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new yn("image/png","png")),this.root.push(new yn("image/jpeg","jpeg")),this.root.push(new yn("image/jpeg","jpg")),this.root.push(new yn("image/bmp","bmp")),this.root.push(new yn("image/gif","gif")),this.root.push(new yn("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new yn("application/xml","xml")),this.root.push(new bn("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new bn("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new bn("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new bn("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new bn("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new bn("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new bn("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new bn("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml"))}addFooter(e){this.root.push(new bn("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new bn("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}}class Pn extends s{constructor(e){super("cp:coreProperties"),this.root.push(new Br({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),e.title&&this.root.push(new U("dc:title",e.title)),e.subject&&this.root.push(new U("dc:subject",e.subject)),e.creator&&this.root.push(new U("dc:creator",e.creator)),e.keywords&&this.root.push(new U("cp:keywords",e.keywords)),e.description&&this.root.push(new U("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new U("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new U("cp:revision",String(e.revision))),this.root.push(new Sn("dcterms:created")),this.root.push(new Sn("dcterms:modified"))}}class Sn extends s{constructor(e){super(e),this.root.push(new Br({type:"dcterms:W3CDTF"})),this.root.push(D(new Date))}}class vn extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns",vt:"xmlns:vt"}}}class Rn extends o{constructor(){super(...arguments),this.xmlKeys={fmtid:"fmtid",pid:"pid",name:"name"}}}class In extends s{constructor(e,t){super("property"),this.root.push(new Rn({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:t.name})),this.root.push(new Tn(t.value))}}class Tn extends s{constructor(e){super("vt:lpwstr"),this.root.push(e)}}class xn extends s{constructor(e){super("Properties"),this.properties=[],this.root.push(new vn({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const t of e)this.addCustomProperty(t)}prepForXml(e){return this.properties.forEach((e=>this.root.push(e))),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new In(this.nextId++,e))}}class On extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"}}}class Dn extends p{constructor(e,t){super("w:ftr",t),this.refId=e,t||this.root.push(new On({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}}class Ln{constructor(e,t,i){this.media=e,this.footer=new Dn(t,i),this.relationships=new Ir}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class Fn extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",id:"w:id"}}}class Hn extends s{constructor(){super("w:footnoteRef")}}class Nn extends Te{constructor(){super({style:"FootnoteReference"}),this.root.push(new Hn)}}!function(e){e.SEPERATOR="separator",e.CONTINUATION_SEPERATOR="continuationSeparator"}(sn||(sn={}));class Un extends s{constructor(e){super("w:footnote"),this.root.push(new Fn({type:e.type,id:e.id}));for(let t=0;t<e.children.length;t++){const i=e.children[t];0===t&&i.addRunToFront(new Nn),this.root.push(i)}}}class Mn extends s{constructor(){super("w:continuationSeparator")}}class kn extends Te{constructor(){super({}),this.root.push(new Mn)}}class Qn extends s{constructor(){super("w:separator")}}class Vn extends Te{constructor(){super({}),this.root.push(new Qn)}}class Gn extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"}}}class $n extends s{constructor(){super("w:footnotes"),this.root.push(new Gn({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const e=new Un({id:-1,type:sn.SEPERATOR,children:[new Nr({spacing:{after:0,line:240,lineRule:We.AUTO},children:[new Vn]})]});this.root.push(e);const t=new Un({id:0,type:sn.CONTINUATION_SEPERATOR,children:[new Nr({spacing:{after:0,line:240,lineRule:We.AUTO},children:[new kn]})]});this.root.push(t)}createFootNote(e,t){const i=new Un({id:e,children:t});this.root.push(i)}}class Wn{constructor(){this.footnotess=new $n,this.relationships=new Ir}get View(){return this.footnotess}get Relationships(){return this.relationships}}class Kn extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"}}}class zn extends p{constructor(e,t){super("w:hdr",t),this.refId=e,t||this.root.push(new Kn({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}}class jn{constructor(e,t,i){this.media=e,this.header=new zn(t,i),this.relationships=new Ir}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class Xn{constructor(){this.map=new Map}addMedia(e,t){const i=`${Me()}.png`,r={stream:"string"==typeof e?this.convertDataURIToBinary(e):e,fileName:i,transformation:{pixels:{x:Math.round(t.width),y:Math.round(t.height)},emus:{x:Math.round(9525*t.width),y:Math.round(9525*t.height)},flip:t.flip,rotation:t.rotation?6e4*t.rotation:void 0}};return this.map.set(i,r),r}addImage(e,t){this.map.set(e,t)}get Array(){return Array.from(this.map.values())}convertDataURIToBinary(e){const t=";base64,",r=e.indexOf(t)+t.length;return"function"==typeof atob?new Uint8Array(atob(e.substring(r)).split("").map((e=>e.charCodeAt(0)))):new(i(764).Buffer)(e,"base64")}}const Yn="";var Jn,qn;!function(e){e.BULLET="bullet",e.CARDINAL_TEXT="cardinalText",e.CHICAGO="chicago",e.DECIMAL="decimal",e.DECIMAL_ENCLOSED_CIRCLE="decimalEnclosedCircle",e.DECIMAL_ENCLOSED_FULLSTOP="decimalEnclosedFullstop",e.DECIMAL_ENCLOSED_PARENTHESES="decimalEnclosedParen",e.DECIMAL_ZERO="decimalZero",e.LOWER_LETTER="lowerLetter",e.LOWER_ROMAN="lowerRoman",e.NONE="none",e.ORDINAL_TEXT="ordinalText",e.UPPER_LETTER="upperLetter",e.UPPER_ROMAN="upperRoman"}(Jn||(Jn={}));class Zn extends o{constructor(){super(...arguments),this.xmlKeys={ilvl:"w:ilvl",tentative:"w15:tentative"}}}class eo extends s{constructor(e){super("w:numFmt"),this.root.push(new a({val:e}))}}class to extends s{constructor(e){super("w:lvlText"),this.root.push(new a({val:e}))}}class io extends s{constructor(e){super("w:lvlJc"),this.root.push(new a({val:e}))}}!function(e){e.NOTHING="nothing",e.SPACE="space",e.TAB="tab"}(qn||(qn={}));class ro extends s{constructor(e){super("w:suff"),this.root.push(new a({val:e}))}}class so extends s{constructor({level:e,format:t,text:i,alignment:r=M.START,start:s=1,style:n,suffix:o}){if(super("w:lvl"),this.root.push(new N("w:start",_(s))),t&&this.root.push(new eo(t)),o&&this.root.push(new ro(o)),i&&this.root.push(new to(i)),this.root.push(new io(r)),this.paragraphProperties=new Hr(n&&n.paragraph),this.runProperties=new Se(n&&n.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Zn({ilvl:_(e),tentative:1}))}}class no extends so{constructor(e){super(e)}}class oo extends so{}class ao extends s{constructor(e){super("w:multiLevelType"),this.root.push(new a({val:e}))}}class Ao extends o{constructor(){super(...arguments),this.xmlKeys={abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"}}}class lo extends s{constructor(e,t){super("w:abstractNum"),this.root.push(new Ao({abstractNumId:_(e),restartNumberingAfterBreak:0})),this.root.push(new ao("hybridMultilevel")),this.id=e;for(const e of t)this.root.push(new no(e))}}class ho extends s{constructor(e){super("w:abstractNumId"),this.root.push(new a({val:e}))}}class co extends o{constructor(){super(...arguments),this.xmlKeys={numId:"w:numId"}}}class uo extends s{constructor(e){super("w:num"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new co({numId:_(e.numId)})),this.root.push(new ho(_(e.abstractNumId))),e.overrideLevel&&this.root.push(new _o(e.overrideLevel.num,e.overrideLevel.start))}}class po extends o{constructor(){super(...arguments),this.xmlKeys={ilvl:"w:ilvl"}}}class _o extends s{constructor(e,t){super("w:lvlOverride"),this.root.push(new po({ilvl:e})),void 0!==t&&this.root.push(new mo(t))}}class go extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class mo extends s{constructor(e){super("w:startOverride"),this.root.push(new go({val:e}))}}class fo extends s{constructor(e){super("w:numbering"),this.abstractNumberingMap=new Map,this.concreteNumberingMap=new Map,this.referenceConfigMap=new Map,this.root.push(new Br({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new lo(Ue(),[{level:0,format:Jn.BULLET,text:"●",alignment:M.LEFT,style:{paragraph:{indent:{left:Ne(.5),hanging:Ne(.25)}}}},{level:1,format:Jn.BULLET,text:"○",alignment:M.LEFT,style:{paragraph:{indent:{left:Ne(1),hanging:Ne(.25)}}}},{level:2,format:Jn.BULLET,text:"■",alignment:M.LEFT,style:{paragraph:{indent:{left:2160,hanging:Ne(.25)}}}},{level:3,format:Jn.BULLET,text:"●",alignment:M.LEFT,style:{paragraph:{indent:{left:2880,hanging:Ne(.25)}}}},{level:4,format:Jn.BULLET,text:"○",alignment:M.LEFT,style:{paragraph:{indent:{left:3600,hanging:Ne(.25)}}}},{level:5,format:Jn.BULLET,text:"■",alignment:M.LEFT,style:{paragraph:{indent:{left:4320,hanging:Ne(.25)}}}},{level:6,format:Jn.BULLET,text:"●",alignment:M.LEFT,style:{paragraph:{indent:{left:5040,hanging:Ne(.25)}}}},{level:7,format:Jn.BULLET,text:"●",alignment:M.LEFT,style:{paragraph:{indent:{left:5760,hanging:Ne(.25)}}}},{level:8,format:Jn.BULLET,text:"●",alignment:M.LEFT,style:{paragraph:{indent:{left:6480,hanging:Ne(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new uo({numId:1,abstractNumId:t.id,reference:"default-bullet-numbering",instance:0,overrideLevel:{num:0,start:1}})),this.abstractNumberingMap.set("default-bullet-numbering",t);for(const t of e.config)this.abstractNumberingMap.set(t.reference,new lo(Ue(),t.levels)),this.referenceConfigMap.set(t.reference,t.levels)}prepForXml(e){for(const e of this.abstractNumberingMap.values())this.root.push(e);for(const e of this.concreteNumberingMap.values())this.root.push(e);return super.prepForXml(e)}createConcreteNumberingInstance(e,t){const i=this.abstractNumberingMap.get(e);if(!i)return;const r=`${e}-${t}`;if(this.concreteNumberingMap.has(r))return;const s={numId:Ue(),abstractNumId:i.id,reference:e,instance:t,overrideLevel:{num:0,start:1}},n=this.referenceConfigMap.get(e),o=n&&n[0].start;o&&Number.isInteger(o)&&(s.overrideLevel={num:0,start:o}),this.concreteNumberingMap.set(r,new uo(s))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class wo extends o{constructor(){super(...arguments),this.xmlKeys={version:"w:val",name:"w:name",uri:"w:uri"}}}class Co extends s{constructor(e){super("w:compatSetting"),this.root.push(new wo({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class yo extends s{constructor(e){super("w:compat"),void 0!==e.doNotExpandShiftReturn&&this.root.push(new L("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.version&&this.root.push(new Co(e.version))}}class Eo extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"}}}class bo extends s{constructor(e){super("w:settings"),this.root.push(new Eo({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new L("w:displayBackgroundShape",!0)),void 0!==e.trackRevisions&&this.root.push(new L("w:trackRevisions",e.trackRevisions)),void 0!==e.evenAndOddHeaders&&this.root.push(new L("w:evenAndOddHeaders",e.evenAndOddHeaders)),void 0!==e.updateFields&&this.root.push(new L("w:updateFields",e.updateFields)),this.root.push(new yo({version:e.compatabilityModeVersion||15}))}}class Bo extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class Po extends s{constructor(e){super("w:name"),this.root.push(new Bo({val:e}))}}class So extends s{constructor(e){super("w:uiPriority"),this.root.push(new Bo({val:_(e)}))}}class vo extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"}}}class Ro extends s{constructor(e,t){super("w:style"),this.root.push(new vo(e)),t.name&&this.root.push(new Po(t.name)),t.basedOn&&this.root.push(new H("w:basedOn",t.basedOn)),t.next&&this.root.push(new H("w:next",t.next)),t.link&&this.root.push(new H("w:link",t.link)),void 0!==t.uiPriority&&this.root.push(new So(t.uiPriority)),void 0!==t.semiHidden&&this.root.push(new L("w:semiHidden",t.semiHidden)),void 0!==t.unhideWhenUsed&&this.root.push(new L("w:unhideWhenUsed",t.unhideWhenUsed)),void 0!==t.quickFormat&&this.root.push(new L("w:qFormat",t.quickFormat))}}class Io extends Ro{constructor(e){super({type:"paragraph",styleId:e.id},e),this.paragraphProperties=new Hr(e.paragraph),this.runProperties=new Se(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class To extends Ro{constructor(e){super({type:"character",styleId:e.id},Object.assign({uiPriority:99,unhideWhenUsed:!0},e)),this.runProperties=new Se(e.run),this.root.push(this.runProperties)}}class xo extends Io{constructor(e){super(Object.assign(Object.assign({},e),{basedOn:"Normal",next:"Normal",quickFormat:!0}))}}class Oo extends xo{constructor(e){super(Object.assign(Object.assign({},e),{id:"Title",name:"Title"}))}}class Do extends xo{constructor(e){super(Object.assign(Object.assign({},e),{id:"Heading1",name:"Heading 1"}))}}class Lo extends xo{constructor(e){super(Object.assign(Object.assign({},e),{id:"Heading2",name:"Heading 2"}))}}class Fo extends xo{constructor(e){super(Object.assign(Object.assign({},e),{id:"Heading3",name:"Heading 3"}))}}class Ho extends xo{constructor(e){super(Object.assign(Object.assign({},e),{id:"Heading4",name:"Heading 4"}))}}class No extends xo{constructor(e){super(Object.assign(Object.assign({},e),{id:"Heading5",name:"Heading 5"}))}}class Uo extends xo{constructor(e){super(Object.assign(Object.assign({},e),{id:"Heading6",name:"Heading 6"}))}}class Mo extends xo{constructor(e){super(Object.assign(Object.assign({},e),{id:"Strong",name:"Strong"}))}}class ko extends Io{constructor(e){super(Object.assign(Object.assign({},e),{id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0}))}}class Qo extends Io{constructor(e){super(Object.assign(Object.assign({},e),{id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:We.AUTO}},run:{size:20}}))}}class Vo extends To{constructor(e){super(Object.assign(Object.assign({},e),{id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}}))}}class Go extends To{constructor(e){super(Object.assign(Object.assign({},e),{id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}}))}}class $o extends To{constructor(e){super(Object.assign(Object.assign({},e),{id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:W.SINGLE}}}))}}class Wo extends s{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(const t of e.importedStyles)this.root.push(t);if(e.paragraphStyles)for(const t of e.paragraphStyles)this.root.push(new Io(t));if(e.characterStyles)for(const t of e.characterStyles)this.root.push(new To(t))}}class Ko extends s{constructor(e){super("w:pPrDefault"),this.root.push(new Hr(e))}}class zo extends s{constructor(e){super("w:rPrDefault"),this.root.push(new Se(e))}}class jo extends s{constructor(e){super("w:docDefaults"),this.runPropertiesDefaults=new zo(e.run),this.paragraphPropertiesDefaults=new Ko(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class Xo{newInstance(e){const t=(0,A.xml2js)(e,{compact:!1});let i;for(const e of t.elements||[])"w:styles"===e.name&&(i=e);if(void 0===i)throw new Error("can not find styles element");const r=i.elements||[];return new Wo({initialStyles:new c(i.attributes),importedStyles:r.map((e=>l(e)))})}}class Yo{newInstance(e={}){var t;return{initialStyles:new Br({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new jo(null!==(t=e.document)&&void 0!==t?t:{}),new Oo(Object.assign({run:{size:56}},e.title)),new Do(Object.assign({run:{color:"2E74B5",size:32}},e.heading1)),new Lo(Object.assign({run:{color:"2E74B5",size:26}},e.heading2)),new Fo(Object.assign({run:{color:"1F4D78",size:24}},e.heading3)),new Ho(Object.assign({run:{color:"2E74B5",italics:!0}},e.heading4)),new No(Object.assign({run:{color:"2E74B5"}},e.heading5)),new Uo(Object.assign({run:{color:"1F4D78"}},e.heading6)),new Mo(Object.assign({run:{bold:!0}},e.strong)),new ko(e.listParagraph||{}),new $o(e.hyperlink||{}),new Vo(e.footnoteReference||{}),new Qo(e.footnoteText||{}),new Go(e.footnoteTextChar||{})]}}}class Jo{constructor(e,t={}){var i,r,s,n,o,a;if(this.currentRelationshipId=1,this.headers=[],this.footers=[],this.coreProperties=new Pn(Object.assign(Object.assign({},e),{creator:null!==(i=e.creator)&&void 0!==i?i:"Un-named",revision:null!==(r=e.revision)&&void 0!==r?r:1,lastModifiedBy:null!==(s=e.lastModifiedBy)&&void 0!==s?s:"Un-named"})),this.numbering=new fo(e.numbering?e.numbering:{config:[]}),this.fileRelationships=new Ir,this.customProperties=new xn(null!==(n=e.customProperties)&&void 0!==n?n:[]),this.appProperties=new fn,this.footnotesWrapper=new Wn,this.contentTypes=new Bn,this.documentWrapper=new Tr({background:e.background||{}}),this.settings=new bo({compatabilityModeVersion:e.compatabilityModeVersion,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:null===(o=e.features)||void 0===o?void 0:o.trackRevisions,updateFields:null===(a=e.features)||void 0===a?void 0:a.updateFields}),this.media=t.template&&t.template.media?t.template.media:new Xn,t.template&&(this.currentRelationshipId=t.template.currentRelationshipId+1),t.template&&e.externalStyles)throw Error("can not use both template and external styles");if(t.template){const e=new Xo;this.styles=e.newInstance(t.template.styles)}else if(e.externalStyles){const t=new Xo;this.styles=t.newInstance(e.externalStyles)}else if(e.styles){const t=(new Yo).newInstance(e.styles.default);this.styles=new Wo(Object.assign(Object.assign({},t),e.styles))}else{const e=new Yo;this.styles=new Wo(e.newInstance())}if(this.addDefaultRelationships(),t.template&&t.template.headers)for(const e of t.template.headers)this.addHeaderToDocument(e.header,e.type);if(t.template&&t.template.footers)for(const e of t.template.footers)this.addFooterToDocument(e.footer,e.type);for(const t of e.sections)this.addSection(t);if(e.footnotes)for(const t in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(t),e.footnotes[t].children)}addSection({headers:e={},footers:t={},children:i,properties:r}){this.documentWrapper.View.Body.addSection(Object.assign(Object.assign({},r),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:t.default?this.createFooter(t.default):void 0,first:t.first?this.createFooter(t.first):void 0,even:t.even?this.createFooter(t.even):void 0}}));for(const e of i)this.documentWrapper.View.add(e)}createHeader(e){const t=new jn(this.media,this.currentRelationshipId++);for(const i of e.options.children)t.add(i);return this.addHeaderToDocument(t),t}createFooter(e){const t=new Ln(this.media,this.currentRelationshipId++);for(const i of e.options.children)t.add(i);return this.addFooterToDocument(t),t}addHeaderToDocument(e,t=Ze.DEFAULT){this.headers.push({header:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,t=Ze.DEFAULT){this.footers.push({footer:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map((e=>e.header))}get Footers(){return this.footers.map((e=>e.footer))}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}}const qo="";class Zo extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class ea extends s{constructor(e={}){super("w:instrText"),this.properties=e,this.root.push(new Zo({space:V.PRESERVE}));let t="TOC";this.properties.captionLabel&&(t=`${t} \\a "${this.properties.captionLabel}"`),this.properties.entriesFromBookmark&&(t=`${t} \\b "${this.properties.entriesFromBookmark}"`),this.properties.captionLabelIncludingNumbers&&(t=`${t} \\c "${this.properties.captionLabelIncludingNumbers}"`),this.properties.sequenceAndPageNumbersSeparator&&(t=`${t} \\d "${this.properties.sequenceAndPageNumbersSeparator}"`),this.properties.tcFieldIdentifier&&(t=`${t} \\f "${this.properties.tcFieldIdentifier}"`),this.properties.hyperlink&&(t=`${t} \\h`),this.properties.tcFieldLevelRange&&(t=`${t} \\l "${this.properties.tcFieldLevelRange}"`),this.properties.pageNumbersEntryLevelsRange&&(t=`${t} \\n "${this.properties.pageNumbersEntryLevelsRange}"`),this.properties.headingStyleRange&&(t=`${t} \\o "${this.properties.headingStyleRange}"`),this.properties.entryAndPageNumberSeparator&&(t=`${t} \\p "${this.properties.entryAndPageNumberSeparator}"`),this.properties.seqFieldIdentifierForPrefix&&(t=`${t} \\s "${this.properties.seqFieldIdentifierForPrefix}"`),this.properties.stylesWithLevels&&this.properties.stylesWithLevels.length&&(t=`${t} \\t "${this.properties.stylesWithLevels.map((e=>`${e.styleName},${e.level}`)).join(",")}"`),this.properties.useAppliedParagraphOutlineLevel&&(t=`${t} \\u`),this.properties.preserveTabInEntries&&(t=`${t} \\w`),this.properties.preserveNewLineInEntries&&(t=`${t} \\x`),this.properties.hideTabAndPageNumbersInWebView&&(t=`${t} \\z`),this.root.push(t)}}class ta extends s{constructor(){super("w:sdtContent")}}class ia extends o{constructor(){super(...arguments),this.xmlKeys={alias:"w:val"}}}class ra extends s{constructor(e){super("w:alias"),this.root.push(new ia({alias:e}))}}class sa extends s{constructor(e){super("w:sdtPr"),this.root.push(new ra(e))}}class na extends s{constructor(e="Table of Contents",t){super("w:sdt"),this.root.push(new sa(e));const i=new ta,r=new Nr({children:[new Te({children:[new re(!0),new ea(t),new se]})]});i.addChildElement(r);const s=new Nr({children:[new Te({children:[new ne]})]});i.addChildElement(s),this.root.push(i)}}class oa{constructor(e,t){this.styleName=e,this.level=t}}class aa{constructor(e={children:[]}){this.options=e}}class Aa{constructor(e={children:[]}){this.options=e}}class la extends o{constructor(){super(...arguments),this.xmlKeys={id:"w:id"}}}class ha extends s{constructor(e){super("w:footnoteReference"),this.root.push(new la({id:e}))}}class da extends Te{constructor(e){super({style:"FootnoteReference"}),this.root.push(new ha(e))}}class ca extends s{constructor(e){super("w:ins"),this.root.push(new he({id:e.id,author:e.author,date:e.date})),this.addChildElement(new xe(e))}}class ua extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class pa extends s{constructor(){super("w:delInstrText"),this.root.push(new ua({space:V.PRESERVE})),this.root.push("PAGE")}}class _a extends s{constructor(){super("w:delInstrText"),this.root.push(new ua({space:V.PRESERVE})),this.root.push("NUMPAGES")}}class ga extends s{constructor(){super("w:delInstrText"),this.root.push(new ua({space:V.PRESERVE})),this.root.push("SECTIONPAGES")}}class ma extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class fa extends s{constructor(e){super("w:delText"),this.root.push(new ma({space:V.PRESERVE})),this.root.push(e)}}class wa extends s{constructor(e){super("w:del"),this.root.push(new he({id:e.id,author:e.author,date:e.date})),this.deletedTextRunWrapper=new Ca(e),this.addChildElement(this.deletedTextRunWrapper)}}class Ca extends s{constructor(e){if(super("w:r"),this.root.push(new Se(e)),e.children)for(const t of e.children)if("string"!=typeof t)this.root.push(t);else switch(t){case K.CURRENT:this.root.push(new re),this.root.push(new pa),this.root.push(new se),this.root.push(new ne);break;case K.TOTAL_PAGES:this.root.push(new re),this.root.push(new _a),this.root.push(new se),this.root.push(new ne);break;case K.TOTAL_PAGES_IN_SECTION:this.root.push(new re),this.root.push(new ga),this.root.push(new se),this.root.push(new ne);break;default:this.root.push(new fa(t))}else e.text&&this.root.push(new fa(e.text));if(e.break)for(let t=0;t<e.break;t++)this.root.splice(1,0,new te)}}var ya,Ea,ba;!function(e){e.CENTER="center",e.INSIDE="inside",e.LEFT="left",e.OUTSIDE="outside",e.RIGHT="right"}(ya||(ya={})),function(e){e.BOTTOM="bottom",e.CENTER="center",e.INSIDE="inside",e.OUTSIDE="outside",e.TOP="top"}(Ea||(Ea={})),function(e){e.DECIMAL="decimal",e.UPPER_ROMAN="upperRoman",e.LOWER_ROMAN="lowerRoman",e.UPPER_LETTER="upperLetter",e.LOWER_LETTER="lowerLetter",e.ORDINAL="ordinal",e.CARDINAL_TEXT="cardinalText",e.ORDINAL_TEXT="ordinalText",e.HEX="hex",e.CHICAGO="chicago",e.IDEOGRAPH_DIGITAL="ideographDigital",e.JAPANESE_COUNTING="japaneseCounting",e.AIUEO="aiueo",e.IROHA="iroha",e.DECIMAL_FULL_WIDTH="decimalFullWidth",e.DECIMAL_HALF_WIDTH="decimalHalfWidth",e.JAPANESE_LEGAL="japaneseLegal",e.JAPANESE_DIGITAL_TEN_THOUSAND="japaneseDigitalTenThousand",e.DECIMAL_ENCLOSED_CIRCLE="decimalEnclosedCircle",e.DECIMAL_FULL_WIDTH_2="decimalFullWidth2",e.AIUEO_FULL_WIDTH="aiueoFullWidth",e.IROHA_FULL_WIDTH="irohaFullWidth",e.DECIMAL_ZERO="decimalZero",e.BULLET="bullet",e.GANADA="ganada",e.CHOSUNG="chosung",e.DECIMAL_ENCLOSED_FULL_STOP="decimalEnclosedFullstop",e.DECIMAL_ENCLOSED_PAREN="decimalEnclosedParen",e.DECIMAL_ENCLOSED_CIRCLE_CHINESE="decimalEnclosedCircleChinese",e.IDEOGRAPH_ENCLOSED_CIRCLE="ideographEnclosedCircle",e.IDEOGRAPH_TRADITIONAL="ideographTraditional",e.IDEOGRAPH_ZODIAC="ideographZodiac",e.IDEOGRAPH_ZODIAC_TRADITIONAL="ideographZodiacTraditional",e.TAIWANESE_COUNTING="taiwaneseCounting",e.IDEOGRAPH_LEGAL_TRADITIONAL="ideographLegalTraditional",e.TAIWANESE_COUNTING_THOUSAND="taiwaneseCountingThousand",e.TAIWANESE_DIGITAL="taiwaneseDigital",e.CHINESE_COUNTING="chineseCounting",e.CHINESE_LEGAL_SIMPLIFIED="chineseLegalSimplified",e.CHINESE_COUNTING_TEN_THOUSAND="chineseCountingThousand",e.KOREAN_DIGITAL="koreanDigital",e.KOREAN_COUNTING="koreanCounting",e.KOREAN_LEGAL="koreanLegal",e.KOREAN_DIGITAL_2="koreanDigital2",e.VIETNAMESE_COUNTING="vietnameseCounting",e.RUSSIAN_LOWER="russianLower",e.RUSSIAN_UPPER="russianUpper",e.NONE="none",e.NUMBER_IN_DASH="numberInDash",e.HEBREW_1="hebrew1",e.HEBREW_2="hebrew2",e.ARABIC_ALPHA="arabicAlpha",e.ARABIC_ABJAD="arabicAbjad",e.HINDI_VOWELS="hindiVowels",e.HINDI_CONSONANTS="hindiConsonants",e.HINDI_NUMBERS="hindiNumbers",e.HINDI_COUNTING="hindiCounting",e.THAI_LETTERS="thaiLetters",e.THAI_NUMBERS="thaiNumbers",e.THAI_COUNTING="thaiCounting",e.BAHT_TEXT="bahtText",e.DOLLAR_TEXT="dollarText"}(ba||(ba={}));var Ba=i(733),Pa=i(479);class Sa{format(e,t={}){const i=e.prepForXml(t);if(i)return i;throw Error("XMLComponent did not format correctly")}}class va{replace(e,t,i){let r=e;return t.forEach(((e,t)=>{r=r.replace(new RegExp(`{${e.fileName}}`,"g"),(i+t).toString())})),r}getMediaData(e,t){return t.Array.filter((t=>e.search(`{${t.fileName}}`)>0))}}class Ra{replace(e,t){let i=e;for(const e of t)i=i.replace(new RegExp(`{${e.reference}-${e.instance}}`,"g"),e.numId.toString());return i}}var Ia=function(e,t,i,r){return new(i||(i=Promise))((function(s,n){function o(e){try{A(r.next(e))}catch(e){n(e)}}function a(e){try{A(r.throw(e))}catch(e){n(e)}}function A(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}A((r=r.apply(e,t||[])).next())}))};class Ta{static toBuffer(e,t){return Ia(this,void 0,void 0,(function*(){const i=this.compiler.compile(e,t);return yield i.generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}))}static toBase64String(e,t){return Ia(this,void 0,void 0,(function*(){const i=this.compiler.compile(e,t);return yield i.generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}))}static toBlob(e,t){return Ia(this,void 0,void 0,(function*(){const i=this.compiler.compile(e,t);return yield i.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}))}}Ta.compiler=new class{constructor(){this.formatter=new Sa,this.imageReplacer=new va,this.numberingReplacer=new Ra}compile(e,t){const i=new Ba,r=this.xmlifyFile(e,t),s=new Map(Object.entries(r));for(const[,e]of s)if(Array.isArray(e))for(const t of e)i.file(t.path,t.data);else i.file(e.path,e.data);for(const t of e.Media.Array){const e=t.stream;i.file(`word/media/${t.fileName}`,e)}return i}xmlifyFile(e,t){const i=e.Document.Relationships.RelationshipCount+1,r=Pa(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),s=this.imageReplacer.getMediaData(r,e.Media);return{Relationships:{data:(()=>(s.forEach(((t,r)=>{e.Document.Relationships.createRelationship(i+r,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${t.fileName}`)})),Pa(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{encoding:"UTF-8"}})))(),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const t=this.imageReplacer.replace(r,s,i);return this.numberingReplacer.replace(t,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const i=Pa(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(i,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:Pa(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:Pa(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:Pa(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map(((i,r)=>{const s=Pa(this.formatter.format(i.View,{viewWrapper:i,file:e}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(s,e.Media).forEach(((e,t)=>{i.Relationships.createRelationship(t,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${e.fileName}`)})),{data:Pa(this.formatter.format(i.Relationships,{viewWrapper:i,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${r+1}.xml.rels`}})),FooterRelationships:e.Footers.map(((i,r)=>{const s=Pa(this.formatter.format(i.View,{viewWrapper:i,file:e}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(s,e.Media).forEach(((e,t)=>{i.Relationships.createRelationship(t,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${e.fileName}`)})),{data:Pa(this.formatter.format(i.Relationships,{viewWrapper:i,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${r+1}.xml.rels`}})),Headers:e.Headers.map(((i,r)=>{const s=Pa(this.formatter.format(i.View,{viewWrapper:i,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),n=this.imageReplacer.getMediaData(s,e.Media);return{data:this.imageReplacer.replace(s,n,0),path:`word/header${r+1}.xml`}})),Footers:e.Footers.map(((i,r)=>{const s=Pa(this.formatter.format(i.View,{viewWrapper:i,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),n=this.imageReplacer.getMediaData(s,e.Media);return{data:this.imageReplacer.replace(s,n,0),path:`word/footer${r+1}.xml`}})),ContentTypes:{data:Pa(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:Pa(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:Pa(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:Pa(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:Pa(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:Pa(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"}}}};var xa=function(e,t,i,r){return new(i||(i=Promise))((function(s,n){function o(e){try{A(r.next(e))}catch(e){n(e)}}function a(e){try{A(r.throw(e))}catch(e){n(e)}}function A(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}A((r=r.apply(e,t||[])).next())}))};const Oa={"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header":"header","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer":"footer","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":"image","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink":"hyperlink"};var Da;!function(e){e.HEADER="header",e.FOOTER="footer",e.IMAGE="image",e.HYPERLINK="hyperlink"}(Da||(Da={}));class La{extract(e){return xa(this,void 0,void 0,(function*(){const t=yield Ba.loadAsync(e),i=yield t.files["word/document.xml"].async("text"),r=yield t.files["word/_rels/document.xml.rels"].async("text"),s=this.extractDocumentRefs(i),n=this.findReferenceFiles(r),o=new Xn;return{headers:yield this.createHeaders(t,s,n,o,0),footers:yield this.createFooters(t,s,n,o,s.headers.length),currentRelationshipId:s.footers.length+s.headers.length,styles:yield t.files["word/styles.xml"].async("text"),titlePageIsDefined:this.checkIfTitlePageIsDefined(i),media:o}}))}createFooters(e,t,i,r,s){return xa(this,void 0,void 0,(function*(){const n=t.footers.map(((t,n)=>xa(this,void 0,void 0,(function*(){const o=i.find((e=>e.id===t.id));if(null===o||!o)throw new Error(`Can not find target file for id ${t.id}`);const a=yield e.files[`word/${o.target}`].async("text"),h=(0,A.xml2js)(a,{compact:!1,captureSpacesBetweenElements:!0});if(!h.elements)return;const d=l(h.elements.reduce(((e,t)=>"w:ftr"===t.name?t:e))),c=new Ln(r,s+n,d);return yield this.addRelationshipToWrapper(o,e,c,r),{type:t.type,footer:c}})))).filter((e=>!!e));return Promise.all(n)}))}createHeaders(e,t,i,r,s){return xa(this,void 0,void 0,(function*(){const n=t.headers.map(((t,n)=>xa(this,void 0,void 0,(function*(){const o=i.find((e=>e.id===t.id));if(null===o||!o)throw new Error(`Can not find target file for id ${t.id}`);const a=yield e.files[`word/${o.target}`].async("text"),h=(0,A.xml2js)(a,{compact:!1,captureSpacesBetweenElements:!0});if(!h.elements)return;const d=l(h.elements.reduce(((e,t)=>"w:hdr"===t.name?t:e))),c=new jn(r,s+n,d);return yield this.addRelationshipToWrapper(o,e,c,r),{type:t.type,header:c}})))).filter((e=>!!e));return Promise.all(n)}))}addRelationshipToWrapper(e,t,i,r){return xa(this,void 0,void 0,(function*(){const s=t.files[`word/_rels/${e.target}.rels`];if(!s)return;const n=yield s.async("text"),o=this.findReferenceFiles(n).filter((e=>e.type===Da.IMAGE)),a=this.findReferenceFiles(n).filter((e=>e.type===Da.HYPERLINK));for(const e of o){const s=yield t.files[`word/${e.target}`].async("nodebuffer"),n=r.addMedia(s,{width:100,height:100});i.Relationships.createRelationship(e.id,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${n.fileName}`)}for(const e of a)i.Relationships.createRelationship(e.id,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",e.target,Ye.EXTERNAL)}))}findReferenceFiles(e){const t=(0,A.xml2js)(e,{compact:!0});return(Array.isArray(t.Relationships.Relationship)?t.Relationships.Relationship:[t.Relationships.Relationship]).map((e=>{if(void 0===e._attributes)throw Error("relationship element has no attributes");return{id:this.parseRefId(e._attributes.Id),type:Oa[e._attributes.Type],target:e._attributes.Target}})).filter((e=>null!==e.type))}extractDocumentRefs(e){const t=(0,A.xml2js)(e,{compact:!0})["w:document"]["w:body"]["w:sectPr"],i=t["w:headerReference"];let r;r=void 0===i?[]:Array.isArray(i)?i:[i];const s=r.map((e=>{if(void 0===e._attributes)throw Error("header reference element has no attributes");return{type:e._attributes["w:type"],id:this.parseRefId(e._attributes["r:id"])}})),n=t["w:footerReference"];let o;return o=void 0===n?[]:Array.isArray(n)?n:[n],{headers:s,footers:o.map((e=>{if(void 0===e._attributes)throw Error("footer reference element has no attributes");return{type:e._attributes["w:type"],id:this.parseRefId(e._attributes["r:id"])}}))}}checkIfTitlePageIsDefined(e){return void 0!==(0,A.xml2js)(e,{compact:!0})["w:document"]["w:body"]["w:sectPr"]["w:titlePg"]}parseRefId(e){const t=/^rId(\d+)$/.exec(e);if(null===t)throw new Error("Invalid ref id");return parseInt(t[1],10)}}})(),r})()}));class ImageLoader{constructor(){this._elements=[],this._images={},this._loadCount=0}get loaded(){return 0===this._elements.length}add(e,t){if(!(e in this._images)){const i=document.createElement("img");i.crossOrigin="anonymous",i.src=e,i.style.opacity=t,this._elements.push(i),this._images[e]=""}}get(e){return this._images[e]}load(e=3){if(this._loadCount<e){for(let e=this._elements.length-1;e>=0;e--){const t=this._elements[e];if(t.complete&&t.naturalHeight>0){const i=document.createElement("canvas"),r=i.getContext("2d"),s=parseFloat(t.style.opacity)||1;i.width=t.width,i.height=t.height,r.globalAlpha=s,r.drawImage(t,0,0);const n=i.toDataURL("image/png");this._images[t.src]=n,this._elements.splice(e,1)}}return this._loadCount++,0===this._elements.length}return!0}}function extractBorderStyles(e,t){const i={};if(e.borderLeft){const e=t.borderLeftStyle,r=t.borderLeftColor;i.left={style:e,color:r}}if(e.borderRight){const e=t.borderRightStyle,r=t.borderRightColor;i.right={style:e,color:r}}if(e.borderTop){const e=t.borderTopStyle,r=t.borderTopColor;i.top={style:e,color:r}}if(e.borderBottom){const e=t.borderBottomStyle,r=t.borderBottomColor;i.bottom={style:e,color:r}}return Utils.isEmpty(i)?null:i}function dboxToImage(e,t){const i=t.getBoundingClientRect(),r=t.firstElementChild.children[0].firstElementChild.firstElementChild,s=t.firstElementChild.children[1].firstElementChild.firstElementChild,n=t.children[1],o=document.createElement("canvas"),a=o.getContext("2d");o.width=i.width,o.height=i.height,a.strokeStyle=getComputedStyle(n).borderTopColor,a.beginPath(),a.moveTo(0,0),a.lineTo(i.width,i.height),a.stroke();let A=getComputedStyle(r);return a.textBaseline="bottom",a.fillStyle=A.color,a.font=A.font,a.fillText(r.textContent,0,i.height-1),A=getComputedStyle(s),a.textBaseline="top",a.textAlign="right",a.fillStyle=A.color,a.font=A.font,a.fillText(s.textContent,i.width,1),o.toDataURL()}const BORDER_TOP$1=0,BORDER_BOTTOM$1=1,BORDER_LEFT$1=2,BORDER_RIGHT$1=3,BORDER_STYLES$1=["borderTopStyle","borderBottomStyle","borderLeftStyle","borderRightStyle"],BORDER_COLORS$1=["borderTopColor","borderBottomColor","borderLeftColor","borderRightColor"];class DOCObject{}class DOCElement extends DOCObject{constructor(e,t,i){if(super(),this._dom=t,this._model=i,t instanceof Text?this._elements=[]:this._elements=this.$_build(e,t,i)||[],t instanceof Element&&i){const i=this._elements,r=e.getBounds(t),s=getComputedStyle(t),n=ColorUtils.cssToColor(s.backgroundColor);for(let t=0;t<BORDER_STYLES$1.length;t++){const n=s[BORDER_STYLES$1[t]];if(n&&"none"!=n){let o,a,A,l;switch(t){case 0:o=r.x,A=r.x+r.width,a=l=r.y;break;case 1:o=r.x,A=r.x+r.width,a=l=r.y+r.height>>>0;break;case 2:o=A=r.x,a=r.y,l=r.y+r.height;break;case 3:o=A=r.x+r.width>>>0,a=r.y,l=r.y+r.height}const h=new DOCLine(e,o,a,A,l,n,s[BORDER_COLORS$1[t]]);i.unshift(h)}}if(n){const r=new DOCRectangle(e,t,null);r.color=n.color,r.alpha=n.alpha,i.unshift(r)}}}get model(){return this._model}write(e){return this._doWrite(e,this._dom,this._model)}_doWrite(e,t,i){const r=[],s=this._elements;return null==s||s.forEach((t=>{t.write(e).forEach((e=>r.push(e)))})),r}$_build(e,t,i){return this._doBuild(e,t,i)}_doBuild(e,t,i){const r=[],s=t.children;for(let t=0;t<s.length;t++){const i=s[t],n=e.createDOCElements(i);Utils.isArray(n)?r.push(...n):n&&r.push(n)}return r}_fontName(e){if(e){const t=e.split(/,\s*/)[0];return t.startsWith('"')?t.substring(1,t.length-1):t}return"굴림"}_fontSize(e){return e?e.endsWith("px")?Math.round(72*parseInt(e)/96)+"pt":e.endsWith("pt")?e:e+"pt":"10px"}_toBold(e){return parseInt(e)>=700}_toUnderline(e){if(e&&e.indexOf("underline")>=0)return{}}_toColor(e){function t(e){return 1===(e=(+e).toString(16)).length?"0"+e:e}if(e.startsWith("#"))return e.substr(e.length-6);if(e.startsWith("rgb(")){const i=e.substring(4,e.length-1).split(/,\s*/);return i[2],t(i[0])+t(i[1])+t(i[2])}if(e.startsWith("rgba(")){const i=e.substring(5,e.length-1).split(/,\s*/);return i[3],t(i[0])+t(i[1])+t(i[2])}return"000000"}_toDoc(e){return 20*e*72/96>>0}_toPosition(e){return 914400*e/96>>0}_toSize(e){return e>>0}_toShading(e,t){return t<1?{fill:Utils.pad16(ColorUtils.lighten(e,t),6)}:{fill:Utils.pad16(e,6)}}_createText(e,t){return 1===e.length&&160===e.charCodeAt(0)&&(e=""),new build.TextRun({text:e,font:this._fontName(t.fontFamily),size:this._fontSize(t.fontSize),color:this._toColor(t.color),italics:"italic"===t.fontStyle,bold:this._toBold(t.fontWeight),underline:this._toUnderline(t.textDecoration)})}_getFloating(e){return{horizontalPosition:{relative:build.HorizontalPositionRelativeFrom.PAGE,offset:this._toPosition(e.x)},verticalPosition:{relative:build.VerticalPositionRelativeFrom.PAGE,offset:this._toPosition(e.y)},allowOverlap:!0}}}class DOCHtmlElement extends DOCElement{constructor(e,t,i){super(e,t,i)}_doBuild(e,t,i){const r=[],s=t.childNodes;for(let t=0;t<s.length;t++){const i=s[t],n=i instanceof Text?new DOCText(e,i,null):e.createDOCElements(i);Utils.isArray(n)?r.push(...n):n&&r.push(n)}return r}}class DOCRectangle extends DOCElement{constructor(){super(...arguments),this.alpha=1}_doWrite(e,t,i){if(e.inTable){const i=e.getBounds(t);return[new build.ImageRun({data:this.$_createImage(e,i,t),transformation:{width:this._toSize(i.width),height:this._toSize(i.height)}})]}const r=e.getBounds(t);return[new build.Paragraph({frame:{position:{x:this._toDoc(r.x),y:this._toDoc(r.y)},width:1*this._toDoc(r.width),height:1*this._toDoc(r.height),anchor:{horizontal:build.FrameAnchorType.TEXT,vertical:build.FrameAnchorType.TEXT},alignment:{x:build.HorizontalPositionAlign.CENTER,y:build.VerticalPositionAlign.CENTER}},shading:this._toShading(this.color,this.alpha),children:[]})]}$_createImage(e,t,i){const r=document.createElement("canvas"),s=r.getContext("2d");return r.width=Math.max(1,t.width),r.height=Math.max(1,t.height),s.fillStyle=ColorUtils.colorToCss(this.color,this.alpha),s.fillRect(0,0,r.width,r.height),r.toDataURL()}}class DOCText extends DOCElement{_doWrite(e,t){const i=t instanceof Text?e.getTextBounds(t):e.getBounds(t),r=getComputedStyle(t instanceof Text?t.parentElement:t),s=t.textContent;return e.inTable?[this._createText(s,r)]:[new build.Paragraph({frame:{position:{x:this._toDoc(i.x),y:this._toDoc(i.y-.2*i.height)},width:1.05*this._toDoc(i.width),height:1*this._toDoc(i.height),anchor:{horizontal:build.FrameAnchorType.PAGE,vertical:build.FrameAnchorType.PAGE},alignment:{x:build.HorizontalPositionAlign.CENTER,y:build.VerticalPositionAlign.CENTER}},children:[this._createText(s,r)]})]}_doBuild(e,t,i){}}class DOCImage extends DOCElement{constructor(e,t,i){super(e,t,i)}_doBuild(e,t,i){const r=getComputedStyle(t),s=Utils.getImageUrl(r);s.startsWith("data:image")?this._data=s:s.startsWith("http")&&e.addImage(this._url=s,r.opacity)}_doWrite(e,t,i){const r=this._data||e.getImage(this._url)||new Uint8Array(0),s=e.getBounds(t),n=[new build.ImageRun({data:r,transformation:{width:this._toSize(s.width),height:this._toSize(s.height)},floating:e.inTable?void 0:this._getFloating(s)})];return e.inTable?n:[new build.Paragraph({children:n})]}}class DOCQrcode extends DOCElement{constructor(e,t,i){super(e,t,i)}_doBuild(e,t,i){const r=t.querySelector("img");r&&(this._data=r.src)}_doWrite(e,t,i){const r=this._data||new Uint8Array(0),s=e.getBounds(t),n=[new build.ImageRun({data:r,transformation:{width:this._toSize(s.width),height:this._toSize(s.height)},floating:e.inTable?void 0:this._getFloating(s)})];return e.inTable?n:[new build.Paragraph({children:n})]}}class DOCCellDbox extends DOCElement{constructor(e,t,i){super(e,t,i)}_doBuild(e,t,i){this._data=dboxToImage(i,t)}_doWrite(e,t,i){const r=e.getBounds(t);return[new build.ImageRun({data:this._data,transformation:{width:this._toSize(r.width),height:this._toSize(r.height)},floating:e.inTable?void 0:this._getFloating(r)})]}}class DOCSvg extends DOCElement{constructor(e,t,i,r){super(e,t,r);const s=new Blob([i],{type:"image/svg+xml;charset=utf-8"});this._svgData=(URL||webkitURL).createObjectURL(s),e.addImage(this._svgData,"1")}_doBuild(e,t,i){}_doWrite(e,t,i){const r=e.getImage(this._svgData+""),s=e.getBounds(t),n=[new build.ImageRun({data:r||new Uint8Array(0),transformation:{width:this._toSize(s.width),height:this._toSize(s.height)},floating:e.inTable?void 0:this._getFloating(s)})];return e.inTable?n:[new build.Paragraph({children:n})]}}class DOCCanvas extends DOCElement{constructor(e,t,i){super(e,t,i)}_doBuild(e,t,i){this._data=t.toDataURL()}_doWrite(e,t,i){const r=e.getBounds(t),s=[new build.ImageRun({data:this._data,transformation:{width:this._toSize(r.width),height:this._toSize(r.height)},floating:e.inTable?void 0:this._getFloating(r)})];return e.inTable?s:[new build.Paragraph({children:s})]}}class DOCBar extends DOCElement{}class DOCLine extends DOCElement{constructor(e,t,i,r,s,n,o){super(e,null,null),this._x1=Math.min(t,r),this._y1=Math.min(i,s),this._x2=Math.max(t,r),this._y2=Math.max(i,s),this._x11=t-this._x1,this._y11=i-this._y1,this._x22=r-this._x1,this._y22=s-this._y1,this._cssStyle=n,this._cssColor=o}static bulidLine(e,t,i,r,s,n){const o=document.createElement("canvas"),a=o.getContext("2d");switch(o.width=Math.max(1,Math.abs(i-e)),o.height=Math.max(1,Math.abs(r-t)),s){case"dashed":a.setLineDash([4,3]);break;case"dotted":a.setLineDash([2,2])}a.strokeStyle=n,a.beginPath(),a.moveTo(e,t),a.lineTo(i,r),a.stroke();return o.toDataURL()}static write(e,t,i,r,s,n){const o=[new build.ImageRun({data:t,transformation:{width:s,height:n},floating:e.inTable?void 0:{horizontalPosition:{relative:build.HorizontalPositionRelativeFrom.PAGE,offset:i},verticalPosition:{relative:build.VerticalPositionRelativeFrom.PAGE,offset:r},allowOverlap:!0}})];return e.inTable?o:[new build.Paragraph({children:o})]}_doBuild(e,t,i){}_doWrite(e,t,i){return this._data||(this._data=DOCLine.bulidLine(this._x11,this._y11,this._x22,this._y22,this._cssStyle,this._cssColor)),DOCLine.write(e,this._data,this._toPosition(this._x1),this._toPosition(this._y1),this._toSize(Math.max(1,this._x2-this._x1)),this._toSize(Math.max(1,this._y2-this._y1)))}}class DOCDiagonalLine extends DOCElement{constructor(e,t,i){super(e,t,i)}_doBuild(e,t,i){const r=t.getBoundingClientRect();i.reversed?this._data=DOCLine.bulidLine(0,r.height,r.width,0,"solid","black"):this._data=DOCLine.bulidLine(0,0,r.width,r.height,"solid","black")}_doWrite(e,t,i){const r=e.getBounds(t);return DOCLine.write(e,this._data,this._toPosition(r.x),this._toPosition(r.y),this._toSize(r.width),this._toSize(r.height))}}class DOCModel{constructor(e,t,i){this._pages=[],i.forEach((t=>{e.setPageDiv(t.page),this._pages.push(new DOCPage(e,t))}))}get pages(){return this._pages}}class DOCPage extends DOCObject{constructor(e,t){super(),this._page=t,this._elements=this.$_build(e)}write(e){const t=[];e.setPageDiv(this._page.page);for(let i of this._elements){const r=i.write(e);null==r||r.forEach((e=>t.push(e)))}return t}$_buildBackground(e,t){return new DOCElement(e,t,null)}$_buildForeground(e,t){return new DOCElement(e,t,null)}$_buildPageHeader(e,t){return new DOCElement(e,t,e.report.page.pageHeader)}$_buildPageFooter(e,t){return new DOCElement(e,t,e.report.page.pageFooter)}$_buildPageBody(e,t){const i=[];for(let r of t){const t=e.createDOCElements(r);Utils.isArray(t)?i.push(...t):t&&i.push(t)}return i}$_build(e){const t=this._page,i=[];return i.push(this.$_buildBackground(e,t.background)),i.push(this.$_buildPageHeader(e,t.pageHeader)),this.$_buildPageBody(e,t.contents).forEach((e=>e&&i.push(e))),i.push(this.$_buildPageFooter(e,t.pageFooter)),i.push(this.$_buildForeground(e,t.foreground)),i}}const _alignmets={l:build.AlignmentType.LEFT,c:build.AlignmentType.CENTER,r:build.AlignmentType.RIGHT};class DOCTable extends DOCElement{constructor(e,t,i){super(e,t,i)}write(e){const t=e.inTable;e.inTable=this;try{return super.write(e)}finally{e.inTable=t}}_doBuild(e,t,i){var r;const s=t.rows,n=this._elts=[],o=e.inTable;e.inTable=this;try{for(let t=0;t<s.length;t++){const i=s[t].cells,o=[];for(let t=0;t<i.length;t++){const s=i[t];if("none"===getComputedStyle(s).display)o.push(null);else{const t=e.createDOCElements(null===(r=s.firstElementChild)||void 0===r?void 0:r.firstElementChild);o.push(t)}}n.push(o)}}finally{e.inTable=o}}_doWrite(e,t,i){const r=t.firstChild.children,s=r.length,n=new Array(s),o=e.getBounds(t);for(let e=0;e<s;e++){const t=r[e],i=t.$_w;n[e]=this._toDoc(isNaN(i)?+t.dataset.width:i)}return[new build.Table({float:{horizontalAnchor:build.TableAnchorType.PAGE,verticalAnchor:build.TableAnchorType.PAGE,overlap:build.OverlapType.OVERLAP,absoluteHorizontalPosition:this._toDoc(o.x),absoluteVerticalPosition:this._toDoc(o.y)},layout:build.TableLayoutType.FIXED,columnWidths:n,rows:this.$_writeRows(e,t.rows)})]}$_writeRows(e,t){const i=[];for(let r=0;r<t.length;r++)i.push(this.$_writeRow(e,r,t[r]));return i}$_writeRow(e,t,i){function r(e){if(e){if("none"===e.style)return{style:build.BorderStyle.NONE,size:0,color:"ffffff"};if(0===ColorUtils.cssToColor(e.color,!1).alpha)return{style:build.BorderStyle.NONE,size:0,color:"ffffff"}}}const s=i.cells,n=getComputedStyle(i),o=ColorUtils.cssToColor(n.backgroundColor),a=[];for(let i=0;i<s.length;i++){const n=s[i],A=getComputedStyle(n);if("none"===A.display)continue;const l=ColorUtils.cssToColor(A.backgroundColor)||o;let h=A;const d=n.getElementsByClassName(TextItemElementBase.SPAN)[0];d&&(h=getComputedStyle(d));const c=extractBorderStyles(n.style,A);let u;c&&(u={start:r(c.left),end:r(c.right),top:r(c.top),bottom:r(c.bottom)});const p=_alignmets[n.dataset._align],_=this._elts[t][i];let g;if(_ instanceof DOCElement&&_.model instanceof TextItemBase)g=[this._createText(n.textContent,h)];else if(Array.isArray(_)){g=[];for(let t of _)g.push(...t.write(e))}else g=_?_.write(e):[];let m=!0;for(let e of g)if(!(e instanceof build.Run)){m=!1;break}m&&(g=[new build.Paragraph({children:g,alignment:p})]);const f=new build.TableCell({columnSpan:n.colSpan||1,rowSpan:n.rowSpan||1,children:g,shading:l&&this._toShading(l.color,l.alpha),verticalAlign:build.VerticalAlign.CENTER,borders:u});a.push(f)}return new build.TableRow({height:{value:this._toDoc(i.clientHeight),rule:build.HeightRule.EXACT},children:a})}}class DOCBoxTable extends DOCElement{constructor(e,t,i){super(e,t,i)}write(e){const t=e.inTable;e.inTable=this;try{return super.write(e)}finally{e.inTable=t}}_doBuild(e,t,i){const r=Array.from(t.firstElementChild.children);this._vertical=i instanceof ColumnBoxContainer;const s=this._elts=[],n=e.inTable;e.inTable=this;try{for(let t=0;t<r.length;t++){const i=e.createDOCElements(r[t]);s.push(i)}}finally{e.inTable=n}}_doWrite(e,t,i){const r=Array.from(t.firstElementChild.children),s=this._elts,n=i instanceof ColumnBoxContainer,o=n?1:s.length,a=n?s.length:1,A=i.getItemGap(t.offsetWidth),l=i.itemsAlign,h=this._wDom=t.offsetWidth,d=this._hDom=t.offsetHeight,c=this._wCols=new Array(o),u=this._hRows=new Array(a);if(n){c[0]=this._toDoc(h);let e=0;for(let t=0;t<a;t++){const i=r[t].offsetHeight+A;u[t]=this._toDoc(i),e+=i}e<d&&(l===BoxItemsAlign.MIDDLE?(r.unshift(null),u.unshift(this._toDoc((d-e)/2)),s.unshift(null),r.push(null),u.push(this._toDoc((d-e)/2)),s.push(null)):l===BoxItemsAlign.END?(r.unshift(null),u.unshift(this._toDoc(d-e)),s.unshift(null)):(r.push(null),u.push(this._toDoc(d-e)),s.push(null)))}else{u[0]=this._toDoc(d);let e=0;for(let t=0;t<o;t++){const i=r[t].offsetWidth+A;c[t]=this._toDoc(i),e+=i}e<h&&(l===BoxItemsAlign.MIDDLE?(r.unshift(null),c.unshift(this._toDoc((h-e)/2)),s.unshift(null),r.push(null),c.push(this._toDoc((h-e)/2)),s.push(null)):l===BoxItemsAlign.END?(r.unshift(null),c.unshift(this._toDoc(h-e)),s.unshift(null)):(r.push(null),c.push(this._toDoc(h-e)),s.push(null)))}const p=e.getBounds(t);return[new build.Table({float:{horizontalAnchor:build.TableAnchorType.PAGE,verticalAnchor:build.TableAnchorType.PAGE,overlap:build.OverlapType.OVERLAP,absoluteHorizontalPosition:this._toDoc(p.x),absoluteVerticalPosition:this._toDoc(p.y)},layout:build.TableLayoutType.FIXED,columnWidths:c,rows:this.$_writeRows(e,r)})]}$_writeRows(e,t){const i=[];if(this._vertical)for(let r=0;r<t.length;r++)i.push(this.$_writeRow(e,r,[t[r]]));else i.push(this.$_writeRow(e,0,t));return i}$_writeRow(e,t,i){const r=this._wDom,s=this._hDom,n=[];for(let o=0;o<i.length;o++){const a={start:{style:build.BorderStyle.NONE,size:0,color:"ffffff"},end:{style:build.BorderStyle.NONE,size:0,color:"ffffff"},top:{style:build.BorderStyle.NONE,size:0,color:"ffffff"},bottom:{style:build.BorderStyle.NONE,size:0,color:"ffffff"}},A=i[o],l=this._elts[t*i.length+o];let h;if(l instanceof DOCElement&&l.model instanceof TextItemBase){const e=getComputedStyle(A);h=[this._createText(A.textContent,e)]}else if(Array.isArray(l)){h=[];for(let t of l)h.push(...t.write(e))}else h=l?l.write(e):[];let d=build.AlignmentType.CENTER,c=build.VerticalAlign.CENTER;const u={left:0,right:0,top:0,bottom:0};if(l){const t=A instanceof HTMLElement&&e.report.models[A.dataset._m_];if(this._vertical){const e=t.getLeft(r),i=t.getRight(r);(isNaN(e)||isNaN(i))&&isNaN(e)?isNaN(i)||(d=build.AlignmentType.RIGHT,u.right=this._toDoc(i)):(d=build.AlignmentType.LEFT,u.left=this._toDoc(e))}else{const e=t.getTop(s),i=t.getBottom(s);(isNaN(e)||isNaN(i))&&isNaN(e)?isNaN(i)||(u.bottom=this._toDoc(i),c=build.VerticalAlign.BOTTOM):(c=build.VerticalAlign.TOP,u.top=this._toDoc(e))}}let p=!0;for(let e of h)if(!(e instanceof build.Run)){p=!1;break}p&&(h=[new build.Paragraph({children:h,alignment:d,spacing:{lineRule:build.LineRuleType.EXACTLY}})]);const _=new build.TableCell({columnSpan:1,rowSpan:1,children:h,verticalAlign:c,borders:a,margins:u});n.push(_)}return new build.TableRow({height:{value:this._hRows[t],rule:build.HeightRule.EXACT},children:n})}}class PickerElement extends UIElement{get picker(){return this.container}}class AlphaSlider extends PickerElement{constructor(e){super(e,"rr-color-picker-alpha-slider"),this._color=16777215,this._alpha=1,this._addChild(this._selector=new AlphaSliderSelector(e)),this._changed()}get selector(){return this._selector}get color(){return this._color}set color(e){e!=this._color&&(this._color=e,this._changed())}get alpha(){return this._alpha}set alpha(e){e!=this._alpha&&(this._alpha=e,this.picker&&this.picker.refresh())}moveSelector(e){const t=this.height;this.alpha=(t-e)/t,e=100*(1-this.alpha),this.selector.setYP(e),this.picker&&this.picker.refresh()}moveByAlpha(e){this.alpha=e,this.selector.setYP(100*(1-this.alpha))}_changed(){const e=this._color;let t="linear-gradient(";t+=ColorUtils.toHex(e)+","+ColorUtils.toRgba(e,0)+")",t+=",",t+='url("'+AlphaSlider.BACKGROUND+'")',this.setStyles({backgroundImage:t}),this._selector.setStyles({top:Math.round(100*(1-this._alpha))+"%"})}}AlphaSlider.BACKGROUND="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgray'/%3E%3C/svg%3E";class AlphaSliderSelector extends UIElement{constructor(e){super(e,"rr-color-picker-alpha-selector")}}class ReportContainer extends VisualContainer{constructor(e){super(e),this._context=new PrintContext}_doDispose(){super._doDispose()}_doPrepareContainer(e){super._doPrepareContainer(e),e.classList.add(ReportContainer.CLASS_NAME),e.classList.add("rr-report-root")}_doLayout(e){}}ReportContainer.CLASS_NAME="rr-report-container";class FeedbackAction{constructor(e,t){this._started=Utils.getTimeF(),this._target=e,this._duration=t,this._doStart(this._target)}get target(){return this._target}run(e){const t=e-this._started;return t<=this._duration?(this._doRun(this._target,this._duration,t),!0):(this._doEnd(this._target),!1)}execute(){this.run(this._started)}_doStart(e){}_doEnd(e){}}class RevelaSpanAction extends FeedbackAction{_doStart(e){e.style.display="inline-block"}_doRun(e,t,i){}_doEnd(e){e.style.display="none"}}class FeedbackLayer extends LayerElement{constructor(e){super(e,"feedbackLayer"),this._childMap={},this._actions=[],setInterval((()=>{this.update()}),300)}update(){const e=Utils.getTimeF();for(let t=this._actions.length-1;t>=0;t--)this._actions[t].run(e)||this._actions.splice(t,1)}addSpan(e,t,i,r){if(this._childMap[t])throw new Error("Already exists: "+t);const s=e.createElement("span"),n=s.style;if(n.position="absolute",n.display="none","string"==typeof i)s.className=i;else if(i)for(let e in i)n[e]=i[e];return r&&(s.textContent=r),this._dom.appendChild(s),this._childMap[t]=s,s}clearAction(e,t=!1){const i=this._childMap[e];if(i){const e=Utils.getTimeF();for(let r=this._actions.length-1;r>=0;r--)this._actions[r].target===i&&(t&&this._actions[r].run(e),this._actions.splice(r,1))}}showSpan(e,t,i,r,s=3){const n=this._childMap[e];if(n){const e=n.style;e.left=i+"px",e.top=r+"px",n.textContent=t||"",this.$_addAction(new RevelaSpanAction(n,s))}}_initDom(e,t){super._initDom(e,t),t.style.pointerEvents="none"}$_addAction(e){e&&this._actions.indexOf(e)<0&&(this._actions.push(e),e.execute())}}class EditMarquee extends VisualElement{constructor(e){super(e,"editMarquee")}get target(){return this._target}set target(e){e!==this._target&&(this._target=e,this.invalidate())}get targetItem(){if(this._target instanceof ReportItemElement)return this._target.model}layout(e){const t=e.getItemBoundingRect(this._target);this._doLayout(this.doc,this.dom,t)}_getCssSelector(){return"rr-edit-marquee"}get findable(){return!1}_initDom(e,t){super._initDom(e,t),t.style.zIndex=EditMarquee.MARQUEE_ZINDEX}_doDraw(e){}_selectItem(e,t=!0,i=!1){delete e.dataset.cellselect,delete e.dataset.select,delete e.dataset.focus,i?e.dataset.focus="":t&&(e.dataset.select="")}_selectCell(e,t=!0){delete e.dataset.select,delete e.dataset.focus,t?e.dataset.cellselect="":delete e.dataset.cellselect}_isColSelected(e,t,i){const r=t.rowCount;let s=!1;return e.selections.forEach(((e,t)=>{if(e instanceof TableSelection)for(let t=0;t<r;t++)if(e.contains(t,i))return s=!0,!0})),s}_isRowSelected(e,t,i){const r=t.colCount;let s=!1;return e.selections.forEach(((e,t)=>{if(e instanceof TableSelection)for(let t=0;t<r;t++)if(e.contains(i,t))return s=!0,!0})),s}}EditMarquee.MARQUEE_ZINDEX="20",EditMarquee.ITEM_CLASS="rr-edit-marquee-item",EditMarquee.TRACKER_STYLE="rr-edit-marquee-tracker";const HEADER=0,DATAROW=1,FOOTER=2,GROUP=1e3,GROUP_HEADER=2e3,GROUP_FOOTER=3e3;class TableBandMarquee extends EditMarquee{constructor(e){super(e),this._leftItems=[],this._rightItems=[],this._topItems=[],this._bottomItems=[],this._leftTrackers=[],this._rightTrackers=[],this._topTrackers=[],this._bottomTrackers=[],this._sectionFocus=-1,this._colFocus=-1,this._rowFocus=-1}static $_isBand(e){return e.parentElement.classList.contains(TableBandMarquee.STYLE_NAME)}static getTarget(e,t){if(e instanceof TableBand&&this.$_isBand(t)){let i=t.dataset.target;if(i)if(i.startsWith("r")){const r=parseInt(i.substr(1)),s=parseInt(t.dataset.section);let n;switch(s){case 0:n=e.header.rows;break;case 1:n=e.dataRow.rows;break;case 2:n=e.footer.rows;break;default:if(s>=3e3){const t=s-3e3;n=e.groups.get(t).footer.rows}else if(s>=2e3){const t=s-2e3;n=e.groups.get(t).header.rows}}n?(e=n.get(r),i=i.substr(1)):i=""}else if(i.startsWith("c")){const t=i.substr(1);t&&(i=t,e=e.columns.get(parseInt(t)))}return i?{target:e,tag:i}:null}}static isColSizeTracker(e){return e instanceof HTMLElement&&e.classList.contains(EditMarquee.TRACKER_STYLE)&&this.$_isBand(e)&&"ew-resize"===e.style.cursor?e.$_idx:-1}static isRowSizeTracker(e){if(e instanceof HTMLElement&&e.classList.contains(EditMarquee.TRACKER_STYLE)&&this.$_isBand(e)&&"ns-resize"===e.style.cursor){return{table:this.$_getTable(e),row:e.$_idx}}}static $_getTable(e){const t=e&&e.$_grp;return t instanceof TableBase?t:t instanceof TableCell||t instanceof TableRow?t.table:t.model}$_createResizeFeedback(){return this._sizeFeedback||(this._sizeFeedback=this.doc.createElement("div"),Utils.extend(this._sizeFeedback.style,{position:"absolute",boxSizing:"border-box",borderColor:"#000088aa",borderStyle:"none"}),this._sizeValueFeedback=this.doc.createElement("div"),this._sizeValueFeedback.className="rr-table-size-value-feedback",Utils.extend(this._sizeValueFeedback.style,{position:"absolute",backgroundColor:"#11c",color:"white",borderRadius:"3px",padding:"3px 5px",textAlign:"center",minWidth:"32px"})),this._sizeFeedback}showColSizeFeedback(e,t,i){let r=this.$_createResizeFeedback();const s=this.height-2*TableBandMarquee.H_ITEM;Utils.extend(r.style,{top:TableBandMarquee.H_ITEM+"px",left:t+"px",width:"1px",height:s+"px",borderBottomStyle:"none",borderRightWidth:"2px",borderRightStyle:"dotted"}),this.dom.appendChild(r),r=this._sizeValueFeedback,r.textContent=i,Utils.extend(r.style,{left:t-r.offsetWidth+"px",top:-r.offsetHeight+"px"}),this.dom.appendChild(r)}showRowSizeFeedback(e,t,i,r){let s=this.$_createResizeFeedback();const n=this.width-2*TableBandMarquee.W_ITEM;Utils.extend(s.style,{left:TableBandMarquee.W_ITEM+"px",top:i+"px",height:"1px",width:n+"px",borderRightStyle:"none",borderBottomWidth:"2px",borderBottomStyle:"dashed"}),this.dom.appendChild(s),s=this._sizeValueFeedback,s.textContent=r,Utils.extend(s.style,{left:17-s.offsetWidth+"px",top:i-s.offsetHeight+"px"}),this.dom.appendChild(s)}hideSizeFeedbacks(){Utils.remove(this._sizeFeedback),Utils.remove(this._sizeValueFeedback)}_getCssSelector(){return super._getCssSelector()+" "+TableBandMarquee.STYLE_NAME}_doLayout(e,t,i){function r(e,t){for(let i of n._tables)if(e._isColSelected(o,i,t))return!0;return!1}const s=this.target,n=s.model,o=s.container;let a=o.focusedItem;const A=TableBandMarquee.W_ITEM,l=TableBandMarquee.H_ITEM,h=i.x-A,d=i.y-l,c=i.width+2*A,u=i.height+2*l;let p,_,g,m,f=!1;if(this._rowFocus=this._colFocus=this._sectionFocus=-1,a instanceof TableCell?(this._rowFocus=a.row,this._colFocus=a.col,p=a.table,f=!0):a instanceof TableRow&&(this._rowFocus=a.index,p=a.table),a instanceof TableBandColumn?this._colFocus=a.index:p&&(this._sectionFocus=function(e){return e instanceof TableBandHeader?0:e instanceof TableBandDataRow?1:e instanceof TableBandFooter?2:e instanceof TableBandRowGroup?s.indexOfGroup(e)+1e3:e instanceof TableBandRowGroupHeader?s.indexOfGroup(e.group)+2e3:e instanceof TableBandRowGroupFooter?s.indexOfGroup(e.group)+3e3:void 0}(p)),m=function(e){let t,i=0;switch(e){case 0:t=s.headerView;break;case 1:t=s.dataRowView;break;case 2:t=s.footerView;break;default:if(e>=3e3){const r=s.getGroupView(e%3e3);i=r.y,t=r.footer}else if(e>=2e3){const r=s.getGroupView(e%2e3);i=r.y,t=r.header}}if(t){const e=t.y+i,r=t.getRowPoints();for(let t=0;t<r.length;t++)r[t]+=e;return r}}(this._sectionFocus),m){_=this.$_getItems(e,t,this._leftItems,m.length-1);for(let e=0;e<Math.min(_.length,m.length-1);e++){const t=_[e];if(t.dataset.target="r"+e,t.dataset.section=this._sectionFocus+"",f)this._selectCell(t,this._rowFocus===e||this._isRowSelected(o,p,e));else if(this._rowFocus===e)this._selectItem(t,!0,o.selectionCount>1);else{const i=p&&o.isSelected(p.getRow(e));this._selectItem(t,i,!1)}t.textContent="r-"+e,t.title="row "+e,Utils.setBounds(t,0,m[e]+l+2,A,m[e+1]-m[e])}g=this.$_getTrackers(e,t,this._leftTrackers,m.length-2);for(let e=0;e<m.length-2;e++){const t=g[e];t.$_idx=e,t.$_grp=a,t.style.cursor="ns-resize",Utils.setBounds(t,0,m[e+1]+l+2,A,3)}_=this.$_getItems(e,t,this._rightItems,m.length-1);for(let e=0;e<Math.min(_.length,m.length-1);e++){const t=_[e];if(t.dataset.target="r"+e,t.dataset.section=this._sectionFocus+"",f)this._selectCell(t,this._rowFocus===e||this._isRowSelected(o,p,e));else if(this._rowFocus===e)this._selectItem(t,!0,o.selectionCount>1);else{const i=p&&o.isSelected(p.getRow(e));this._selectItem(t,i,!1)}t.textContent="r-"+e,t.title="row "+e,Utils.setBounds(t,A+i.width,m[e]+l+2,A,m[e+1]-m[e])}g=this.$_getTrackers(e,t,this._rightTrackers,m.length-2);for(let e=0;e<m.length-2;e++){const t=g[e];t.$_idx=e,t.$_grp=a,t.style.cursor="ns-resize",Utils.setBounds(t,A+i.width,m[e+1]+l+2,A,3)}}else this.$_getItems(e,t,this._leftItems,0),this.$_getItems(e,t,this._rightItems,0);m=s.getColPoints(),_=this.$_getItems(e,t,this._topItems,m.length-1);for(let e=0;e<Math.min(_.length,m.length-1);e++){const t=_[e];if(t.dataset.target="c"+e,f)this._selectCell(t,this._colFocus===e||r(this,e));else if(this._colFocus===e)this._selectItem(t,!0,o.selectionCount>1);else{const i=o.isSelected(n.getColumn(e));this._selectItem(t,i,!1)}t.textContent="c-"+e,t.title="column "+e,Utils.setBounds(t,A+m[e]+2,0,m[e+1]-m[e],l)}g=this.$_getTrackers(e,t,this._topTrackers,m.length-2);for(let e=0;e<m.length-2;e++){const t=g[e];t.$_idx=e,t.$_grp=this.target,t.style.cursor="ew-resize",Utils.setBounds(t,A+m[e+1]+2-1,0,3,l)}_=this.$_getItems(e,t,this._bottomItems,m.length-1);for(let e=0;e<Math.min(_.length,m.length-1);e++){const t=_[e];if(t.dataset.target="c"+e,f)this._selectCell(t,this._colFocus===e||r(this,e));else if(this._colFocus===e)this._selectItem(t,!0,o.selectionCount>1);else{const i=o.isSelected(n.getColumn(e));this._selectItem(t,i,!1)}t.textContent="c-"+e,t.title="column "+e,Utils.setBounds(t,A+m[e]+2,l+i.height,m[e+1]-m[e],l)}g=this.$_getTrackers(e,t,this._bottomTrackers,m.length-2);for(let e=0;e<m.length-2;e++){const t=g[e];t.$_idx=e,t.$_grp=this.target,t.style.cursor="ew-resize",Utils.setBounds(t,A+m[e+1]+2-1,l+i.height,3,l)}this.setBounds(h,d,c,u).applyBounds()}$_getDivs(e,t,i,r,s){for(;i.length<r;){const r=e.createElement("div");r.className=s,t.appendChild(r),i.push(r)}for(let e=i.length-1;e>=0;e--)i[e].style.display=e>=r?"none":"",i[e].$_grp=null;return i}$_getItems(e,t,i,r){return this.$_getDivs(e,t,i,r,EditMarquee.ITEM_CLASS)}$_getTrackers(e,t,i,r){return this.$_getDivs(e,t,i,r,EditMarquee.TRACKER_STYLE)}}TableBandMarquee.STYLE_NAME="rr-tableband-marquee",TableBandMarquee.W_ITEM=50,TableBandMarquee.H_ITEM=17;class TableContainerMarquee extends EditMarquee{constructor(e){super(e),this._leftItems=[],this._rightItems=[],this._topItems=[],this._bottomItems=[],this._leftTrackers=[],this._rightTrackers=[],this._topTrackers=[],this._bottomTrackers=[],this._colFocus=-1,this._rowFocus=-1,this._topDivs=[]}static $_isContainer(e){return e.parentElement.classList.contains(TableContainerMarquee.STYLE_NAME)}static getTarget(e,t){if(e instanceof TableContainer&&this.$_isContainer(t)){let i=t.dataset.target;if(i){if(i.startsWith("r")){const t=i.substr(1);return i=t,{target:e.rows.get(parseInt(t)),tag:i}}if(i.startsWith("c")){const t=i.substr(1);return i=t,{target:e.columns.get(parseInt(t)),tag:i}}}return i?{target:e,tag:i}:null}}static isColSizeTracker(e){return e instanceof HTMLElement&&e.classList.contains(EditMarquee.TRACKER_STYLE)&&this.$_isContainer(e)&&"ew-resize"===e.style.cursor?e.$_idx:-1}static isRowSizeTracker(e){return e instanceof HTMLElement&&e.classList.contains(EditMarquee.TRACKER_STYLE)&&this.$_isContainer(e)&&"ns-resize"===e.style.cursor?e.$_idx:-1}$_createResizeFeedback(){return this._sizeFeedback||(this._sizeFeedback=this.doc.createElement("div"),this._sizeFeedback.className="rr-table-size-feedback",Utils.extend(this._sizeFeedback.style,{position:"absolute",boxSizing:"border-box",borderColor:"#000088aa",borderStyle:"none"}),this._sizeValueFeedback=this.doc.createElement("div"),this._sizeValueFeedback.className="rr-table-size-value-feedback",Utils.extend(this._sizeValueFeedback.style,{position:"absolute",backgroundColor:"#11c",color:"white",borderRadius:"3px",padding:"3px 5px",textAlign:"center",minWidth:"32px"})),this._sizeFeedback}showColSizeFeedback(e,t,i){let r=this.$_createResizeFeedback();const s=this.height-2*TableContainerMarquee.H_ITEM;Utils.extend(r.style,{top:TableContainerMarquee.H_ITEM+"px",left:t+"px",width:"1px",height:s+"px",borderBottomStyle:"none",borderRightWidth:"2px",borderRightStyle:"dotted"}),this.dom.appendChild(r),r=this._sizeValueFeedback,r.textContent=i,Utils.extend(r.style,{left:t-r.offsetWidth+"px",top:-r.offsetHeight+"px"}),this.dom.appendChild(r)}showRowSizeFeedback(e,t,i,r){let s=this.$_createResizeFeedback();const n=this.width-2*TableContainerMarquee.W_ITEM;Utils.extend(s.style,{left:TableContainerMarquee.W_ITEM+"px",top:i+"px",height:"1px",width:n+"px",borderRightStyle:"none",borderBottomWidth:"2px",borderBottomStyle:"dashed"}),this.dom.appendChild(s),s=this._sizeValueFeedback,s.textContent=r,Utils.extend(s.style,{left:17-s.offsetWidth+"px",top:i-s.offsetHeight+"px"}),this.dom.appendChild(s)}hideSizeFeedbacks(){Utils.remove(this._sizeFeedback),Utils.remove(this._sizeValueFeedback)}_getCssSelector(){return super._getCssSelector()+" "+TableContainerMarquee.STYLE_NAME}_initDom(e,t){super._initDom(e,t);const i=this._tableItem=e.createElement("div");i.className=EditMarquee.ITEM_CLASS,i.dataset.target="t",i.style.cursor="pointer",i.textContent="table",i.title="Table",t.appendChild(i)}_doLayout(e,t,i){const r=this.target,s=r.model,n=r.container,o=n.focusedItem,a=TableContainerMarquee.W_ITEM,A=TableContainerMarquee.H_ITEM,l=i.x-a,h=i.y-A,d=i.width+2*a,c=i.height+2*A;let u,p,_,g=!1;this._colFocus=this._rowFocus=-1,o instanceof TableColumn?this._colFocus=o.index:o instanceof TableRow?this._rowFocus=o.index:o instanceof TableCell&&(this._colFocus=o.col,this._rowFocus=o.row,g=!0);let m=this._tableItem;this._selectItem(m,o===s),Utils.setBounds(m,0,0,a-1,A),_=r.getRowPoints(),u=this.$_getItems(e,t,this._leftItems,r.rowCount);for(let e=0;e<_.length-1;e++){if(m=u[e],m.dataset.target="r"+e,g)this._selectCell(m,this._rowFocus===e||this._isRowSelected(n,s,e));else if(this._rowFocus===e)this._selectItem(m,!0,n.selectionCount>1);else{const t=n.isSelected(s.getRow(e));this._selectItem(m,t,!1)}m.textContent="r-"+e,m.title="row "+e,Utils.setBounds(m,0,_[e]+A+2,a,_[e+1]-_[e])}p=this.$_getTrackers(e,t,this._leftTrackers,_.length-2);for(let e=0;e<_.length-2;e++)m=p[e],m.$_idx=e,m.$_grp=this.target,m.style.cursor="ns-resize",Utils.setBounds(m,0,_[e+1]+A+2,a,3);u=this.$_getItems(e,t,this._rightItems,r.rowCount);for(let e=0;e<_.length-1;e++){if(m=u[e],m.dataset.target="r"+e,g)this._selectCell(m,this._rowFocus===e||this._isRowSelected(n,s,e));else if(this._rowFocus===e)this._selectItem(m,!0,n.selectionCount>1);else{const t=n.isSelected(s.getRow(e));this._selectItem(m,t,!1)}m.textContent="r-"+e,m.title="row "+e,Utils.setBounds(m,a+i.width,_[e]+A+2,a,_[e+1]-_[e])}p=this.$_getTrackers(e,t,this._rightTrackers,_.length-2);for(let e=0;e<_.length-2;e++)m=p[e],m.$_idx=e,m.$_grp=this.target,m.style.cursor="ns-resize",Utils.setBounds(m,a+i.width,_[e+1]+A+2,a,3);_=r.getColPoints(),u=this.$_getItems(e,t,this._topItems,_.length-1);for(let e=0;e<_.length-1;e++){if(m=u[e],m.dataset.target="c"+e,g)this._selectCell(m,this._colFocus===e||this._isColSelected(n,s,e));else if(this._colFocus===e)this._selectItem(m,!0,n.selectionCount>1);else{const t=n.isSelected(s.getColumn(e));this._selectItem(m,t,!1)}m.textContent="c-"+e,m.title="column "+e,Utils.setBounds(m,a+_[e]+2,0,_[e+1]-_[e],A)}p=this.$_getTrackers(e,t,this._topTrackers,_.length-2);for(let e=0;e<_.length-2;e++)m=p[e],m.$_idx=e,m.$_grp=this.target,m.style.cursor="ew-resize",Utils.setBounds(m,a+_[e+1]+2-1,0,3,A);u=this.$_getItems(e,t,this._bottomItems,_.length-1);for(let e=0;e<_.length-1;e++){if(m=u[e],m.dataset.target="c"+e,g)this._selectCell(m,this._colFocus===e||this._isColSelected(n,s,e));else if(this._colFocus===e)this._selectItem(m,!0,n.selectionCount>1);else{const t=n.isSelected(s.getColumn(e));this._selectItem(m,t,!1)}m.textContent="c-"+e,m.title="column "+e,Utils.setBounds(m,a+_[e]+2,A+i.height+2,_[e+1]-_[e],A)}p=this.$_getTrackers(e,t,this._bottomTrackers,_.length-2);for(let e=0;e<_.length-2;e++)m=p[e],m.$_idx=e,m.$_grp=this.target,m.style.cursor="ew-resize",Utils.setBounds(m,a+_[e+1]+2-1,A+i.height,3,A);this.setBounds(l,h,d,c).applyBounds()}$_getDivs(e,t,i,r,s){for(;i.length<r;){const r=e.createElement("div");r.className=s,t.appendChild(r),i.push(r)}for(let e=i.length-1;e>=0;e--)i[e].style.display=e>=r?"none":"",i[e].$_grp=null;return i}$_getItems(e,t,i,r){return this.$_getDivs(e,t,i,r,EditMarquee.ITEM_CLASS)}$_getTrackers(e,t,i,r){return this.$_getDivs(e,t,i,r,EditMarquee.TRACKER_STYLE)}}TableContainerMarquee.STYLE_NAME="rr-table-container-marquee",TableContainerMarquee.W_ITEM=50,TableContainerMarquee.H_ITEM=17;class ColumnBoxMarquee extends EditMarquee{constructor(e){super(e),this._leftItems=[],this._rightItems=[]}static getTarget(e,t){if(t.parentElement.classList.contains(ColumnBoxMarquee.STYLE_NAME)){let i=t.dataset.target;if(i.startsWith("c-")){const e=i.substr(2);e&&(i=e)}return i?{target:e,tag:i}:null}}_getCssSelector(){return super._getCssSelector()+" "+ColumnBoxMarquee.STYLE_NAME}_initDom(e,t){super._initDom(e,t)}_doLayout(e,t,i){const r=this.target,s=i.x-50,n=i.y,o=i.width+100,a=i.height;let A,l,h;l=r.getRowPoints(),h=h=l.length/2,A=this.$_getItems(e,t,this._leftItems,h);for(let e=0;e<h;e++){const t=A[e];t.dataset.target="r"+e,t.textContent="r-"+e,t.title="row "+e,Utils.setBounds(t,0,l[2*e],50,l[2*e+1]-l[2*e])}A=this.$_getItems(e,t,this._rightItems,h);for(let e=0;e<h;e++){const t=A[e];t.dataset.target="r"+e,t.textContent="r-"+e,t.title="row "+e,Utils.setBounds(t,50+i.width,l[2*e],50,l[2*e+1]-l[2*e])}this.setBounds(s,n,o,a).applyBounds()}$_getItems(e,t,i,r,s=!1){for(;i.length<r;){const r=e.createElement("div");r.className="rr-edit-marquee-item",t.appendChild(r),i.push(r)}for(let e=i.length-1;e>=0;e--)i[e].style.display=e>=r?"none":"";return i}}ColumnBoxMarquee.STYLE_NAME="rr-column-box-marquee";class RowBoxMarquee extends EditMarquee{constructor(e){super(e),this._topItems=[],this._bottomItems=[]}static getTarget(e,t){if(t.parentElement.classList.contains(RowBoxMarquee.STYLE_NAME)){let i=t.dataset.target;if(i.startsWith("r-")){const e=i.substr(2);e&&(i=e)}return i?{target:e,tag:i}:null}}_getCssSelector(){return super._getCssSelector()+" "+RowBoxMarquee.STYLE_NAME}_initDom(e,t){super._initDom(e,t)}_doLayout(e,t,i){const r=this.target,s=i.x,n=i.y-32,o=i.width,a=i.height+64;let A,l,h;l=r.getColPoints(),h=h=l.length/2,A=this.$_getItems(e,t,this._topItems,h);for(let e=0;e<h;e++){const t=A[e];t.dataset.target="c"+e,t.textContent="c-"+e,t.title="col "+e,Utils.setBounds(t,l[2*e],0,l[2*e+1]-l[2*e],32)}A=this.$_getItems(e,t,this._bottomItems,h);for(let e=0;e<h;e++){const t=A[e];t.dataset.target="c"+e,t.textContent="c-"+e,t.title="col "+e,Utils.setBounds(t,l[2*e],32+i.height,l[2*e+1]-l[2*e],32)}this.setBounds(s,n,o,a).applyBounds()}$_getItems(e,t,i,r,s=!1){for(;i.length<r;){const r=e.createElement("div");r.className="rr-edit-marquee-item",t.appendChild(r),i.push(r)}for(let e=i.length-1;e>=0;e--)i[e].style.display=e>=r?"none":"";return i}}RowBoxMarquee.STYLE_NAME="rr-row-box-marquee";class HichartMarquee extends EditMarquee{constructor(e){super(e),this._seriesItems=[]}static getTarget(e,t){if(e instanceof HichartItem&&t.parentElement.classList.contains(HichartMarquee.STYLE_NAME)){let i=t.dataset.target;switch(i){case"xaxis":e=e.xAxis;break;case"yaxis":e=e.yAxis;break;default:i.startsWith("series")&&(e=e.series.get(parseInt(i.substr(6))))}return i?{target:e,tag:i}:null}}get chart(){return this.target.model}getSeriesMarqueeAt(e){for(let t of this._seriesItems){const i=t.offsetLeft,r=t.offsetWidth;if(e>=i&&e<i+r)return t}}getSeriesIndex(e){const t=e.dataset.target;if(t.startsWith("series"))return parseInt(t.substring(6))}isSeries(e){if(e instanceof HTMLDivElement&&this._seriesItems.indexOf(e)>=0)return e}_getCssSelector(){return super._getCssSelector()+" "+HichartMarquee.STYLE_NAME}_initDom(e,t){super._initDom(e,t);let i=this._chartItem=e.createElement("div");i.className=EditMarquee.ITEM_CLASS,i.dataset.target="chart",i.textContent="highchart",t.appendChild(i),i=this._xAxisItem=e.createElement("div"),i.className=EditMarquee.ITEM_CLASS,i.dataset.target="xaxis",i.textContent="x axis",t.appendChild(i),i=this._yAxisItem=e.createElement("div"),i.className=EditMarquee.ITEM_CLASS,i.dataset.target="yaxis",i.style.transform="rotate(90deg)",i.textContent="y axis",t.appendChild(i)}_doLayout(e,t,i){const r=this.target,s=r.model,n=r.container.focusedItem,o=i.x,a=i.y,A=i.width,l=i.height,h=17;let d,c;this.$_prepareSeries(r,e,t),d=this._chartItem,c=64,this._selectItem(d,n===s),Utils.setBounds(d,0,-19,c,h);let u=c+4;this._seriesItems.forEach(((e,t)=>{Utils.setBounds(e,u,-19,55,h),this._selectItem(e,n===s.series.get(t)),u+=59})),s.inverted?(d=this._yAxisItem,d.style.transform="",c=50,Utils.setBounds(d,(A-c)/2,l+2+2,c,h),this._selectItem(d,n===s.yAxis),d=this._xAxisItem,d.style.transform="rotate(90deg)",c=50,this._selectItem(d,n===s.xAxis),Utils.setBounds(d,-c-2+h,(l-h)/2,c,h)):(d=this._xAxisItem,d.style.transform="",c=50,this._selectItem(d,n===s.xAxis),Utils.setBounds(d,(A-c)/2,l+2+2,c,h),d=this._yAxisItem,d.style.transform="rotate(90deg)",c=50,this._selectItem(d,n===s.yAxis),Utils.setBounds(d,-c-2+h,(l-h)/2,c,h)),this.setBounds(o,a,A,l).applyBounds()}$_prepareSeries(e,t,i){const r=e.model.series,s=r.count;for(;this._seriesItems.length<s;){const e=t.createElement("div");e.className=EditMarquee.ITEM_CLASS,i.appendChild(e),this._seriesItems.push(e)}for(;this._seriesItems.length>s;)Utils.remove(this._seriesItems.pop());this._seriesItems.forEach(((e,t)=>{const i=r.get(t).name;e.dataset.target="series"+t,e.textContent=i||"series "+(t+1)}))}}HichartMarquee.STYLE_NAME="rr-hichart-marquee";class BandGroupMarquee extends EditMarquee{constructor(e){super(e),this._topItems=[],this._bottomItems=[],this._topTrackers=[],this._bottomTrackers=[],this._cellFocus=-1,this._topDivs=[]}static $_isContainer(e){return e.parentElement.classList.contains(BandGroupMarquee.STYLE_NAME)}static getTarget(e,t){if(e instanceof BandGroup&&this.$_isContainer(t)){let i=t.dataset.target;if(i.startsWith("c")){const t=i.substring(1);return i=t,{target:e.get(+t),tag:i}}return i?{target:e,tag:i}:null}}_getCssSelector(){return super._getCssSelector()+" "+BandGroupMarquee.STYLE_NAME}_initDom(e,t){super._initDom(e,t);const i=this._tableItem=e.createElement("div");i.className=EditMarquee.ITEM_CLASS,i.dataset.target="g",i.style.cursor="pointer",i.style.border="1px solid black",i.textContent="BAND GROUP",i.title="Band Group",t.appendChild(i)}_doLayout(e,t,i){const r=this.target,s=r.model,n=r.container.focusedItem,o=BandGroupMarquee.W_ITEM,a=BandGroupMarquee.H_ITEM,A=i.x,l=i.y-a,h=i.width,d=i.height+a;let c,u,p=this._tableItem;this._selectItem(p,n===s),Utils.setBounds(p,2,1.2*-a,1.5*o,1.2*a),u=r.getCellPoints(),c=this.$_getItems(e,t,this._topItems,u.length-1);for(let e=0;e<u.length-1;e++)p=c[e],p.dataset.target="c"+e,this._selectItem(p,n===s.get(e),!1),p.textContent="bandcell-"+e,p.title="cell "+e,Utils.setBounds(p,u[e],0,u[e+1]-u[e],a);c=this.$_getItems(e,t,this._bottomItems,u.length-1);for(let e=0;e<u.length-1;e++)p=c[e],p.dataset.target="c"+e,this._selectItem(p,n===s.get(e),!1),p.textContent="bandcell-"+e,p.title="cell "+e,Utils.setBounds(p,u[e],a+i.height+2,u[e+1]-u[e],a);this.setBounds(A,l,h,d).applyBounds()}$_getDivs(e,t,i,r,s){for(;i.length<r;){const r=e.createElement("div");r.className=s,t.appendChild(r),i.push(r)}for(let e=i.length-1;e>=0;e--)i[e].style.display=e>=r?"none":"",i[e].$_grp=null;return i}$_getItems(e,t,i,r){return this.$_getDivs(e,t,i,r,EditMarquee.ITEM_CLASS)}$_getTrackers(e,t,i,r){return this.$_getDivs(e,t,i,r,EditMarquee.TRACKER_STYLE)}}BandGroupMarquee.STYLE_NAME="rr-bandgroup-marquee",BandGroupMarquee.W_ITEM=50,BandGroupMarquee.H_ITEM=17;class SelectView extends VisualElement{constructor(e){super(e,"selectView")}layout(e,t){this.dom.dataset.cell=t instanceof TableSelection&&!t.isSingle(!1)?"1":"0",this.setRect(e).draw(),this.setRotation(t instanceof ReportItem?t.rotation:0)}_getCssSelector(){return SelectView.STYLE}get isLayer(){return!0}_initDom(e,t){super._initDom(e,t),t.style.zIndex=ReportEditLayer.SELECT_ZINDEX}}SelectView.STYLE="rr-select-view";class TableSelectView extends SelectView{_getCssSelector(){return TableSelectView.STYLE}layout(e,t){this.setRect(e).draw()}}TableSelectView.STYLE="rr-table-select-view";class FocusHandle extends VisualElement{constructor(e,t){super(e,"focusHandle"),this._enabled=!0,this.dir=t,this.resize(9,9)}get dir(){return this._dir}set dir(e){e!==this._dir&&(this._dir=e,this.invalidate())}get enabled(){return this._enabled}get vertical(){return this._dir===ResizeDirection.TOP||this._dir===ResizeDirection.BOTTOM||this._dir===ResizeDirection.TOP_LEFT||this._dir===ResizeDirection.BOTTOM_RIGHT||this._dir===ResizeDirection.TOP_RIGHT||this._dir===ResizeDirection.BOTTOM_LEFT}get horizontal(){return this._dir===ResizeDirection.LEFT||this._dir===ResizeDirection.RIGHT||this._dir===ResizeDirection.TOP_LEFT||this._dir===ResizeDirection.BOTTOM_RIGHT||this._dir===ResizeDirection.TOP_RIGHT||this._dir===ResizeDirection.BOTTOM_LEFT}_getCssSelector(){return"rr-focus-handle"}_initDom(e,t){super._initDom(e,t)}_doDraw(e){var t;const i=this.dir,r=this.itemView;r?(e.dataset.hidden="",this._enabled=r.model.canResize(i)&&(null===(t=r.model.parent)||void 0===t?void 0:t.canResizeChild(r.model,i)),e.dataset.disabled=String(!this.enabled),e.dataset.dir=i==ResizeDirection.LEFT||i==ResizeDirection.RIGHT?"horz":i==ResizeDirection.TOP||i==ResizeDirection.BOTTOM?"vert":i==ResizeDirection.TOP_RIGHT||i==ResizeDirection.BOTTOM_LEFT?"up":i==ResizeDirection.TOP_LEFT||i==ResizeDirection.BOTTOM_RIGHT?"down":""):e.dataset.hidden="true"}}class RotateHandle extends VisualElement{constructor(){super(...arguments),this._dragging=!1}setTarget(e,t){this._editView=e,this._target=t}_getCssSelector(){return"rr-rotate-handle"}_initDom(e,t){t.style.position="absolute",t.style.display="inline-block",t.style.pointerEvents="all",this.width=this.height=20,t.ondblclick=e=>{this._target.model.rotation=0},t.onpointerdown=e=>{t.setPointerCapture(e.pointerId),this._oldRotation=this._target.model.rotation,this._dragging=!0},t.onpointerup=e=>{this._target.model.report.setItemProperty(this._target.model,"rotation",this._target.rotation),this._dragging=!1,t.releasePointerCapture(e.pointerId)},t.onpointermove=e=>{if(this._dragging){const t=this._target.dom.getBoundingClientRect();t.x+=t.width/2,t.y+=t.height/2;const i=+(180*Math.atan2(e.clientX-t.x,e.clientY-t.y)/Math.PI).toPrecision(15);this._target.setRotation(+((360-i)%360).toFixed(1)),this._editView.editLayer.resetFocusView()}}}}class RotateLine extends VisualElement{_getCssSelector(){return"rr-rotate-line"}}class FocusView extends VisualElement{constructor(e,t){super(e,"focusView"),this._simpleMode=!1,this._editView=t,this.addChild(this._rotateLine=new RotateLine(e)),this.addChild(this._topHandle=new FocusHandle(e,ResizeDirection.TOP)),this.addChild(this._bottomHandle=new FocusHandle(e,ResizeDirection.BOTTOM)),this.addChild(this._leftHandle=new FocusHandle(e,ResizeDirection.LEFT)),this.addChild(this._rightHandle=new FocusHandle(e,ResizeDirection.RIGHT)),this.addChild(this._topLeftHandle=new FocusHandle(e,ResizeDirection.TOP_LEFT)),this.addChild(this._topRightHandle=new FocusHandle(e,ResizeDirection.TOP_RIGHT)),this.addChild(this._bottomLeftHandle=new FocusHandle(e,ResizeDirection.BOTTOM_LEFT)),this.addChild(this._bottomRightHandle=new FocusHandle(e,ResizeDirection.BOTTOM_RIGHT)),this.addChild(this._rotateHandle=new RotateHandle(e))}get simpleMode(){return this._simpleMode}set simpleMode(e){e!=this._simpleMode&&(this._simpleMode=e,this._topHandle.dir=e?ResizeDirection.TOP_LEFT:ResizeDirection.TOP,this._bottomHandle.dir=e?ResizeDirection.BOTTOM_RIGHT:ResizeDirection.BOTTOM,this._leftHandle.visible=!e,this._rightHandle.visible=!e)}layout(e){if(this._topHandle.itemView=this._bottomHandle.itemView=this._leftHandle.itemView=this._rightHandle.itemView=null,this._topLeftHandle.itemView=this._bottomLeftHandle.itemView=this._topRightHandle.itemView=this._bottomRightHandle.itemView=null,e instanceof ReportItemElement){const t=this.width,i=this.height,r=6,s=r/2;this._simpleMode?(this._topHandle.itemView=this._bottomHandle.itemView=e,this._topHandle.move(-s,-s,!0),this._bottomHandle.move(t-r,i-r,!0)):(this._topHandle.itemView=this._bottomHandle.itemView=this._leftHandle.itemView=this._rightHandle.itemView=e,this._topLeftHandle.itemView=this._bottomLeftHandle.itemView=this._topRightHandle.itemView=this._bottomRightHandle.itemView=e,this._topHandle.move((t-r-s)/2,-r,!0),this._bottomHandle.move((t-r-s)/2,i-s,!0),this._leftHandle.move(-r,(i-r-s)/2,!0),this._rightHandle.move(t-s,(i-r-s)/2,!0),this._topLeftHandle.move(-r,-r,!0),this._topRightHandle.move(t-s,-r,!0),this._bottomLeftHandle.move(-r,i-s,!0),this._bottomRightHandle.move(t-s,i-s,!0)),(this._rotateHandle.visible=e.model.canRotate())&&(this._rotateHandle.setTarget(this._editView,e),this._rotateHandle.move((t-this._rotateHandle.width)/2,i+this._rotateHandle.width,!0)),(this._rotateLine.visible=this._rotateHandle.visible)&&(this._rotateLine.width=1,this._rotateLine.height=this._rotateHandle.width,this._rotateLine.move(t/2,i)),this.setRotation(e.rotation)}else this._rotateHandle.visible=this._rotateLine.visible=!1,this.setRotation(0)}_getCssSelector(){return FocusView.STYLE}get isLayer(){return!0}_initDom(e,t){super._initDom(e,t),t.style.zIndex=ReportEditLayer.FOCUS_ZINDEX}}FocusView.STYLE="rr-focus-view";class ErrorView extends UIElement{constructor(e){super(e,"rr-error-view")}setError(e){this.setText(e)}_prepareDom(e,t){Utils.extend(t.style,{position:"absolute"})}}class ReportEditLayer extends LayerElement{constructor(e,t){super(e,"reportEditLayer"),this._selectPool=[],this._selectViews=[],this._tableSelectPool=[],this._tableSelectViews=[],this._marquees={TableBand:null,TableContainer:null,BandGroup:null,ColumnBoxContainer:null,RowBoxContainer:null,ChartItem:null,HichartItem:null},this._reportView=t,this.addChild(this._focusView=new FocusView(e,t))}_doDispose(){super._doDispose()}get editMarquee(){return this._editMarquee}layoutContent(){const e=this._reportView;this.$_layoutFocus(e),this.$_layoutSelection(e),this.$_layoutTableSelection(e),this.$_layoutMarquee(e)}closeEditMarquees(){this._editMarquee&&(this._editMarquee.visible=!1,this._editMarquee=null)}showFocus(){this._focusView.visible=!0}hideFocus(){this._focusView.visible=!1}showError(e,t,i=3){const r=this._reportView.getElementOf(e);if(!r)return!1;this.hideError();const s=this.container.getDomPosition(r);let n=s.x,o=s.y;const a=this.width,A=this.height;this._errorView||(this._errorView=new ErrorView(this.doc)),this._errorView.dom.classList.remove("rr-error-view-hide"),this._errorView.setError(t),this.container.addFeedback(this._errorView);const l=this._errorView.getBounds();return n=Math.max(0,n+(a-l.width)/2),l.height<=o?o-=l.height:o=Math.max(A-l.height,o+l.height+2),this._errorView.move(n,o),this._errorView.dom.classList.remove("rp-error-view-hide"),this._errorTimer=setTimeout((()=>{this.hideError()}),1e3*i),!0}hideError(){this._hideErrorTimer&&(clearTimeout(this._hideErrorTimer),this._hideErrorTimer=null,this.container.removeFeedback(this._errorView)),this._errorTimer&&(clearTimeout(this._errorTimer),this._errorTimer=null,this._errorView.dom.classList.add("rp-error-view-hide"),this._hideErrorTimer=setTimeout((()=>{this.container.removeFeedback(this._errorView)}),500))}itemsRemoved(e){}itemRemoved(e){}resetFocusView(){this.$_layoutFocus(this._reportView)}_getCssSelector(){return"rr-edit-layer"}_isEmptySize(){return!0}_initDom(e,t){super._initDom(e,t)}$_getCellRect(e,t,i,r,s){const n=e.getElementOf(t.table),o=e.getItemBoundingRect(n,s),a=n.getCellBoundingRect(t.col,t.row,i,r);return a.x+=o.x,a.y+=o.y,a}$_getFieldRect(e,t){const i=CrosstabBand.getBandOf(t),r=e.getElementOf(i),s=e.getItemBoundingRect(r),n=r.getFieldBoundingRect(t);return n.x+=s.x,n.y+=s.y,n}$_layoutSelection(e){const t=this.doc,i=this._selectPool,r=this._selectViews,s=e.selection,n=e.focusedItem;let o=s?s.length:0;if(o>0)for(let e of s)e===n?o--:e instanceof TableSelection?e.equals(n)&&o--:e instanceof ReportItem||o--;for(;r.length>o;){const e=r.pop();this.removeChild(e),i.push(e)}for(;r.length<o;){const e=i.pop()||new SelectView(t);this.addChild(e),r.push(e)}if(o>0){let t=0;for(let i=0,o=s.length;i<o;i++){const o=s[i];if(o instanceof ReportItem&&o!==n){const i=e.getElementOf(o);if(i){const s=e.getItemBoundingRect(i,0!==o.rotation);r[t++].layout(s,o)}}else if(o instanceof TableSelection&&n instanceof TableCell&&!o.equals(n)){const i=this.$_getCellRect(e,o.cell,o.cols,o.rows,!1);r[t++].layout(i,o)}}}}$_layoutTableSelection(e){var t;const i=this.doc,r=this._tableSelectPool,s=this._tableSelectViews,n=null===(t=e.selection)||void 0===t?void 0:t.filter((e=>e instanceof TableColumnBase||e instanceof TableRow));let o=n?n.length:0;for(;s.length>o;){const e=s.pop();this.removeChild(e),r.push(e)}for(;s.length<o;){const e=r.pop()||new TableSelectView(i);this.addChild(e),s.push(e)}if(o>0){let t=0;for(let i=0,r=n.length;i<r;i++){const r=n[i];let o,a;if(r instanceof TableColumn){const t=e.getTableElementOfColumn(r);o=e.getItemBoundingRect(t),a=t.getColRect(r.index,1)}else if(r instanceof TableBandColumn){const t=e.getTableBandElementOfColumn(r);o=e.getItemBoundingRect(t),a=t.getColRect(r.index,1)}else if(r instanceof TableRow){const t=e.getTableElementOfRow(r);o=e.getItemBoundingRect(t),a=t.getRowRect(r.index,1)}a.x+=o.x+2,a.y+=o.y+2,s[t++].layout(a,r)}}}$_layoutFocus(e){const t=this._focusView,i=e.getFocusedElement(),r=e.focusedItem,s=i instanceof ReportItemElement&&!isNaN(i.rotation)&&0!==i.rotation;let n;r instanceof TableCell?(t.visible=!e.editing)&&(n=this.$_getCellRect(e,r,r.width,r.height,s)):CrosstabBand.isFieldCell(r)?(t.visible=!e.editing)&&(n=this.$_getFieldRect(e,r)):(t.visible=!e.editing&&!!i)&&(n=e.getItemBoundingRect(i,s)),t.visible&&(t.setRect(n),t.layout(i),t.draw())}$_getMarquee(e){const t=e&&e.constructor.$_ctor;let i=this._marquees[t];return!i&&t in this._marquees&&(i=new ReportEditLayer.MarqueeTypes[t](this.doc),this.addChild(i),this._marquees[t]=i),i}$_getMarqueeParent(e){for(;e;){const t=e.marqueeParent;if(t===e)return e;e=t}}$_layoutMarquee(e){const t=e.focusedItem,i=this.$_getMarqueeParent(t),r=this._editMarquee;if(i){const t=e.getElementOf(i);if(t&&!e.pageView.isPageDom(t.dom)){const e=this.$_getMarquee(i);return r&&r.target!==t&&(r.visible=!1),void(e&&(e.target=t,e.visible=!0,e.layout(this._reportView),this._editMarquee=e))}}r&&(r.visible=!1)}}ReportEditLayer.SELECT_ZINDEX="100",ReportEditLayer.FOCUS_ZINDEX="101",ReportEditLayer.MarqueeTypes={TableBand:TableBandMarquee,TableContainer:TableContainerMarquee,BandGroup:BandGroupMarquee,ColumnBoxContainer:ColumnBoxMarquee,RowBoxContainer:RowBoxMarquee,HichartItem:HichartMarquee};class ChangeParentCommand extends EditCommand{constructor(e,t){super("Change Itme Parent"),assert(!!e),this._item=e,this._newParent=t,this._oldParent=e.parent}static createCommands(e,t){if(e&&e.length>0){const i=[];return e.forEach(((e,r)=>{i.push(new ChangeParentCommand(e,t))})),i.length>0?i:null}}_doDispose(){this._item=this._oldParent=this._newParent=null}redo(e){this._oldParent.remove(this._item),this._newParent.add(this._item)}undo(){this._newParent.remove(this._item),this._oldParent.add(this._item)}get description(){return"Change parent: "+this._item.designText}get source(){return this._item}}class ChangeItemsParentCommand extends EditCommandGroup{constructor(e,t){super("Change Items Parent",ChangeParentCommand.createCommands(e,t))}}class ReportDragTracker extends DragTracker{constructor(e,t){super(e,t),this._editor=e}_doDispose(){this._editor=null,super._doDispose()}get editor(){return this._editor}get selectable(){return!1}handleSelection(){return null}get startWhenCreated(){return!0}}class HandModeTracker extends ReportDragTracker{constructor(e){super(e,"handModeTracker"),this._saveLeft=0,this._saveTop=0}_doStart(e,t,i,r){const s=this.editor;return this._saveLeft=s.leftPos,this._saveTop=s.topPos,s.setCursor("grabbing"),!0}_doDrag(e,t,i){return this.editor.leftPos=this._saveLeft-(t-this.startX),this.editor.topPos=this._saveTop-(i-this.startY),!0}_doEnded(){this.editor.setCursor("grab")}}class ItemResizeTracker extends ReportDragTracker{constructor(e,t){super(e,"itemResizeTracker"),this._isLeft=!1,this._isTop=!1,this._zoom=1,this._handle=t,this._itemView=this._handle.itemView}_doDispose(){super._doDispose()}handleSelection(){const e=this.editor,t=this._itemView.model;return e.clearSelection(),t}_doStart(e,t,i,r){const s=this._itemView,n=s.model,o=this._handle.dir;return this._zoom=this.editor.zoom/100,n instanceof SpaceItem?this._saveWidth=this._saveHeight=n.size:(this._saveWidth=n.width,this._saveHeight=n.height),this._oldWidth=s.width,this._oldHeight=s.height,this._isLeft=ResizeDirection.isLeft(o),this._isTop=ResizeDirection.isTop(o),this._saveX=n.left,this._saveY=n.top,this._oldPos=this.editor.getDomPosition(s),this._oldLeft=n.getLeft(Number.MAX_SAFE_INTEGER),this._oldTop=n.getTop(Number.MAX_SAFE_INTEGER),!0}_doDrag(e,t,i){const r=1/this._zoom,s=this.$_getDelta(this._handle.dir),n=this._handle.itemView.model,o=(t-this.startX)*s.dx*r,a=(i-this.startY)*s.dy*r,A=this._isLeft?this._oldLeft-o:NaN,l=this._isTop?this._oldTop-a:NaN,h=Math.max(0,Math.round(this._oldWidth+o)),d=Math.max(0,Math.round(this._oldHeight+a));return this._handle.horizontal&&(n instanceof SpaceItem&&n.parent instanceof RowBoxContainer?n.size=h:(isNaN(A)||n.setChildProp("left",A),n.width=h)),this._handle.vertical&&(n instanceof SpaceItem&&n.parent instanceof ColumnBoxContainer?n.size=d:(isNaN(l)||n.setChildProp("top",l),n.height=d)),!0}_doCompleted(){const e=this.editor.report,t=1/this._zoom,i=this._handle.itemView.model,r=this.$_getDelta(this._handle.dir),s=this._handle.horizontal?Math.round((this.currentX-this.startX)*r.dx*t):0,n=this._handle.vertical?Math.round((this.currentY-this.startY)*r.dy*t):0;if(i instanceof SpaceItem)i.parent instanceof RowBoxContainer?e.resizeSpace(i,this._saveWidth,this._oldWidth,s):i.parent instanceof ColumnBoxContainer&&e.resizeSpace(i,this._saveHeight,this._oldHeight,n);else if(this._saveX!==i.left||this._saveY!==i.top){const t=this._isLeft?this._oldLeft-s:this._oldLeft,r=this._isTop?this._oldTop-n:this._oldTop;e.resizeAndMove(i,this._saveWidth,this._saveHeight,this._oldWidth,this._oldHeight,s,n,t,r)}else e.resizeItem(i,this._saveWidth,this._saveHeight,this._oldWidth,this._oldHeight,s,n)}_doCanceled(){this._handle.itemView.model.resize(this._oldWidth,this._oldHeight)}_doEnded(){}$_getDelta(e){let t=0,i=0;switch(e){case ResizeDirection.LEFT:t=-1;break;case ResizeDirection.RIGHT:t=1;break;case ResizeDirection.TOP:i=-1;break;case ResizeDirection.BOTTOM:i=1;break;case ResizeDirection.TOP_LEFT:t=i=-1;break;case ResizeDirection.BOTTOM_RIGHT:t=i=1;break;case ResizeDirection.TOP_RIGHT:t=1,i=-1;break;case ResizeDirection.BOTTOM_LEFT:t=-1,i=1}return{dx:t,dy:i}}}class MoveFeedback extends UIElement{constructor(e,t){super(e,"rr-move-feedback")}_prepareDom(e,t){this.setImportantStyle("position","absolute"),t.appendChild(this._span=e.createElement("span"))}setNewPosition(e,t){return delete this._span.dataset.change,this._span.textContent="(left: "+e+", top: "+t+")",this._span.style.display="",this._span.style.left=-(this._span.offsetWidth+1)+"px",this}setNewParent(e){let t=e.model.pathLabel;return e.model.name&&(t=e.model.name+"("+t+")"),this._span.dataset.change="",this._span.textContent="[to "+t+"]",this._span.style.display="",this._span.style.left="",this}hideSpan(){this._span.style.display="none"}}class MoveLineFeedback extends UIElement{constructor(e,t){super(e,t||"rr-move-line-feedback"),this._width="1px"}vline(e,t,i){this.show(),this.clearStyle("border-top-width"),this.setStyle("border-left-width",this._width),this.setBounds(e,Math.min(t,i),2,Math.abs(t-i))}hline(e,t,i){this.show(),this.clearStyle("border-left-width"),this.setStyle("border-top-width",this._width),this.setBounds(Math.min(t,i),e,Math.abs(i-t),2)}}class MoveMask extends UIElement{constructor(e){super(e,"rr-move-mask-feedback")}}class GuideFeedback extends MoveLineFeedback{constructor(e){super(e,"rr-move-guide-feedback"),this._width="2px"}}class ItemMoveTracker extends ReportDragTracker{constructor(e,t,i){if(super(e,"itemMoveTracker"),this._alt=!1,this._dir="",this._guideX=NaN,this._guideY=NaN,this._zoom=1,this._itemView=t,this._moveType=i,this._parentView=t.parent,this._parentView instanceof StackContainerElement){const e=this._parentView.container;this._siblings=this._parentView.elements.filter((e=>e!==this._itemView&&e instanceof ReportItemElement)).map((t=>{const i=e.getDomPosition(t);return Rectangle.create(i.x,i.y,t.width,t.height)}))}}_doDispose(){super._doDispose()}get selectable(){return!0}get cursor(){return"move"}handleSelection(){var e;const t=this.editor,i=this._itemView.model;return this._items=[i],this._itemViews=[this._itemView],t.isSelected(i)?null===(e=t.getSelection())||void 0===e||e.forEach((e=>{e instanceof ReportItem&&e!==i&&e.parent===i.parent?(this._items.push(e),this._itemViews.push(t.reportView.pageView.getElementOf(e))):t.removeSelection(e)})):t.clearSelection(),i}_doStart(e,t,i,r,s){const n=this.editor,o=this._itemViews;return this._zoom=n.zoom/100,this._alt=s,this._parentPos=this._parentView.container.getDomPosition(this._parentView),this.$_prepare(n.doc),this._itemPts=[],this._feedbacks.forEach(((e,t)=>{const i=o[t],r=n.getDomPosition(i,0!==i.rotation);e.setBounds(r.x,r.y,r.width,r.height),e.setRotation(i.rotation),this._itemPts.push(r)})),!0}_doDrag(e,t,i){const r=this.editor.findReportElementOf(e),s=this._itemView;let n=t-this.startX,o=i-this.startY;if(r!==s&&r instanceof ReportGroupItemElement&&r!==s.parent&&!s.isAncestorOf(r)){const e=r.boundsByContainer();e.x-=this.editor.leftPos,e.y-=this.editor.topPos,this._mask.setRect(e),this._mask.show(),this._newParent=r,this._feedbacks.forEach(((e,t)=>{const i=this._itemPts[t];e.setNewParent(r).move(i.x+n,i.y+o)})),this._hline.hide(),this._vline.hide()}else{this._mask.hide(),this._newParent=null;let e=this._dir;e||n===o||(e=this._alt?Math.abs(n)>Math.abs(o)?"h":"v":""),this._dir=e,"h"===e&&(o=0),"v"===e&&(n=0);const r=this.$_calcPts(n,o);if(this._feedbacks.forEach(((e,s)=>{const a=this._itemPts[s],A=r[s],l=a.x+n,h=a.y+o;e.setNewPosition(A.x,A.y).move(l,h),0===s&&(t=l,i=h)})),"h"!==e&&e?this._hline.hide():this._hline.hline(i+s.height/2,t,this._parentPos.x),"v"!==e&&e?this._vline.hide():this._vline.vline(t+s.width/2,i,this._parentPos.y),this._guideX=this._guideY=NaN,this._hguide.hide(),this._vguide.hide(),this._siblings){const e=Rectangle.create(t,i,s.width,s.height);let r;r=this.$_getNearest(e,"t","t"),r?(this._guideY=i-r.y,this._hguide.hline(r.y,r.x,r.x+r.width),this._feedbacks[0].hideSpan()):(r=this.$_getNearest(e,"b","b"),r&&(this._guideY=i+e.height-(r.y+r.height),this._hguide.hline(r.y+r.height,r.x,r.x+r.width))),r=this.$_getNearest(e,"l","l"),r?(this._guideX=t-r.x,this._vguide.vline(r.x,r.y,r.y+r.height),this._feedbacks[0].hideSpan()):(r=this.$_getNearest(e,"r","r"),r&&(this._guideX=t+e.width-(r.x+r.width),this._vguide.vline(r.x+r.width,r.y,r.y+r.height)))}}return!0}_doCompleted(){const e=this._itemView.model,t=e.report;let i=this.currentX-this.startX,r=this.currentY-this.startY;if("h"===this._dir&&(r=0),"v"===this._dir&&(i=0),this._newParent)this._items.length>1?t.execute(new ChangeItemsParentCommand(this._items,this._newParent.model)):t.execute(new ChangeParentCommand(e,this._newParent.model));else if(0!==i||0!==r){isNaN(this._guideY)||(r-=this._guideY),isNaN(this._guideX)||(i-=this._guideX);const s=this.$_calcPts(i,r);s.length>1?t.execute(new MoveItemsCommand(this._items,s)):t.execute(new MoveItemCommand(e,s[0].x,s[0].y))}}_doCanceled(){}_doEnded(){this._editor.removeFeedbacks(this._hguide,this._vguide,this._hline,this._vline,this._mask),this._feedbacks.forEach((e=>this._editor.removeFeedback(e)))}$_calcPts(e,t){const i=this._zoom,r=this._parentPos,s=[];return this._itemPts.forEach((n=>{const o=Math.round((n.x-r.x+e)/i),a=Math.round((n.y-r.y+t)/i);s.push({x:o,y:a})})),s}$_prepare(e){this._feedbacks=[],this._items.forEach((t=>{this._feedbacks.push(new MoveFeedback(e,t))})),this._hguide=new GuideFeedback(e),this._vguide=new GuideFeedback(e),this._hline=new MoveLineFeedback(e),this._vline=new MoveLineFeedback(e),this._mask=new MoveMask(e),this._feedbacks.forEach((e=>this._editor.addFeedbacks(e))),this._editor.addFeedbacks(this._hguide,this._vguide,this._hline,this._vline,this._mask)}$_distance(e,t){const i=Math.pow(e.x+e.width/2-(t.x+t.width/2),2),r=Math.pow(e.y+e.height/2-(t.y+t.height/2),2);return Math.sqrt(i+r)}$_getNearest(e,t,i){const r=e.x,s=e.y,n=e.x+e.width,o=e.y+e.height;let a,A;for(let l=0;l<this._siblings.length;l++){const h=this._siblings[l];let d;switch(t){case"t":if("t"===i)s>=h.y-1&&s<=h.y+1&&(d=h);break;case"b":if("b"===i)o>=h.y+h.height-1&&o<=h.y+h.height+1&&(d=h);case"l":if("l"===i)r>=h.x-1&&r<=h.x+1&&(d=h);case"r":if("r"===i)n>=h.x+h.width-1&&n<=h.x+h.width+1&&(d=h)}if(d)if(A){const t=this.$_distance(e,d);t<a&&(A=d,a=t)}else A=d,a=this.$_distance(e,A)}return A}}class TableColumnResizeTracker extends ReportDragTracker{constructor(e,t,i,r){super(e,"tableColumnResizeTracker"),this._table=t,this._marquee=i,this._col=r,this._sibling=Utils.isDefined(t.model.width)&&r<t.colCount-1?r+1:-1,this._oldPoints=t.getColPoints(),this._oldSize=this._oldPoints[this._col+1]-this._oldPoints[this._col]}get cursor(){return"ew-resize"}get startWhenCreated(){return!0}_doStart(e,t,i,r){return this._start=t,!0}_doDrag(e,t,i){const r=this._oldPoints,s=this._col,n=t-this._start;if(n<=0&&r[s+1]+n<=r[s]+4)return!1;if(n>0&&this._sibling&&r[s+1]+n>=r[s+2]-4)return!1;const o=this.editor.getDomPosition(this._marquee);return this._newSize=Math.round(this._oldSize+n),this._marquee.showColSizeFeedback(this._col,t-o.x,this._newSize+"px"),!0}_doCompleted(){if(this._sibling>=0)this.editor.report.adjustColumnWidths(this._table,this._col,this._oldPoints,this._newSize);else{const e=this._table.getColumn(this._col);this.editor.report.setItemProperty(e,"width",this._newSize)}}_doEnded(){this._marquee.hideSizeFeedbacks()}}class TableRowResizeTracker extends ReportDragTracker{constructor(e,t,i,r){super(e,"tableRowResizeTracker"),this._table=t,this._marquee=i,this._row=r,this._sibling=Utils.isDefined(t.model.height)?r+1:-1,this._oldPoints=t.getRowPoints(),this._oldSize=this._oldPoints[this._row+1]-this._oldPoints[this._row]}get cursor(){return"ns-resize"}get startWhenCreated(){return!0}_doStart(e,t,i,r){return this._start=i,!0}_doDrag(e,t,i){const r=this._oldPoints,s=this._row,n=i-this._start;if(n<=0&&r[s+1]+n<=r[s]+4)return!1;if(n>0&&this._sibling&&r[s+1]+n>=r[s+2]-4)return!1;const o=this.editor.getDomPosition(this._marquee);return this._newSize=Math.round(this._oldSize+n),this._marquee.showRowSizeFeedback(this._table,this._row,i-o.y,this._newSize+"px"),!0}_doCompleted(){if(this._sibling>=0)this.editor.report.adjustRowHeights(this._table.model,this._row,this._oldPoints,this._newSize);else{const e=this._table.model.getRow(this._row);this.editor.report.setItemProperty(e,"height",this._newSize)}}_doEnded(){this._marquee.hideSizeFeedbacks()}}class ChartSeriesMoveTracker extends ReportDragTracker{constructor(e,t,i){super(e,"chartSeriesMoveTracker"),this._dom=t,this._bounds=Utils.getOffsetRect(t)}get selectable(){return!0}_doStart(e,t,i,r){return this._feedback=this.editor.doc.createElement("div"),this._feedback.className="rr-series-move-feedback",Object.assign(this._feedback.style,{position:"absolute",backgroundColor:"#33333380",border:"1px solid #111"}),Utils.setRect(this._feedback,this._bounds),this._dom.parentElement.appendChild(this._feedback),!0}_doDrag(e,t,i){const r=this.editor.getEditMarquee();this.editor.dom.getBoundingClientRect().x,this.editor.leftPos;const s=r.isSeries(e);return s!==this._targetDom&&(this._targetDom&&(this._targetDom.style.backgroundColor=""),s!==this._dom?(this._targetDom=s,this._targetDom&&(s.style.backgroundColor="#f80")):this._targetDom=null),t=this._bounds.x+100*(t-this.startX)/this.editor.zoom,this._feedback.style.left=t+"px",!0}_doCompleted(e,t,i){if(this._targetDom){const e=this.editor.getEditMarquee(),t=e.chart,i=e.getSeriesIndex(this._dom),r=e.getSeriesIndex(this._targetDom);this.editor.report.moveCollectionItem(t.series,i,r)}}_doEnded(){this._targetDom&&(this._targetDom.style.backgroundColor="",this._targetDom=null),this._dom.parentElement.removeChild(this._feedback),this._dom=null}}class GuardItemView extends ReportElement{constructor(e){super(e,"gaurdItemView"),this._index=-1,this._focused=!1}_doDispose(){super._doDispose()}get section(){return this._section}_debuggable(){return!1}isDom(e){return e===this._label||super.isDom(e)}_initDom(e,t){super._initDom(e,t),t.style.overflow="hidden",this._label=e.createElement("div"),t.appendChild(this._label)}_doMeasure(e,t,i,r){let s=this._index%2?"rr-section-guard-item-odd":"rr-section-guard-item";return this._focused&&(s+=" rr-section-guard-item-focus"),this.styleName=s,this._section.model instanceof ReportPage&&(t.style.backgroundColor=this._focused?"":"#ddd"),new Size(i,r)}_doLayoutContent(e){this._label.textContent=this._section.guardLabel}$_setSection(e,t,i){this._index=e,this._section=t,this._focused=i}}class SectionGuard extends ReportElement{constructor(e,t){super(e,"sectionGaurd"),this._itemPool=[],this._itemViews=[],this._editor=t}_doDispose(){super._doDispose()}_debuggable(){return!1}_getCssSelector(){return"rr-section-guard"}_initDom(e,t){super._initDom(e,t)}_doPrepareMeasure(e,t){const i=this._editor.reportView.pageView.getSections().length,r=this._itemViews,s=this.doc;let n;for(;r.length<i;)n=this.$_borrow(s),this.addChild(n),r.push(n);for(;r.length>i;)n=r.pop(),this.removeChild(n),this.$_free(n)}_doAfterMeasure(e,t,i,r,s){}_doMeasure(e,t,i,r){const s=this._editor.reportView.pageView.getSections(),n=this._itemViews,o=s.length,a=this.width-1,A=this._editor.focusedItem;for(let t=0;t<o;t++){const i=s[t],r=n[t];r.$_setSection(t,i,i.model==A),r.measure(e,a,i.height)}return new Size(i,r)}_doLayoutContent(e){const t=this._editor,i=t.reportView,r=t.zoom/100,s=t.reportView.pageView.getSections(),n=this._itemViews,o=s.length,a=t.topPos,A=i.boundsByContainer().y;let l=n[0],h=A+s[1].boundsBy(i).y*r-a-20;l.resize(n[1].measuredWidth,20,!0),l.layoutContent(e),l.move(0,h);for(let t=1;t<o;t++)l=n[t],h=A+s[t].boundsBy(i).y*r,l.resize(l.measuredWidth,l.measuredHeight*r,!0),l.layoutContent(e),l.move(0,h-a)}$_borrow(e){return this._itemPool.pop()||new GuardItemView(e)}$_free(e){this._itemPool.push(e)}}class ReportAddFeedback extends UIElement{constructor(e){super(e,"rr-add-feedback","div"),this.hide()}_doDispose(){super._doDispose()}get target(){return this._target}get tableTarget(){return this._tableTarget}get trow(){return this._tcell?this._tcell.parentElement.rowIndex-0:-1}get tcol(){return this._tcell?this._tcell.cellIndex:-1}setTarget(e){!e||e instanceof ReportGroupItemElement||(e=e.modelParent);const t=e;if(t!==this._target)if(this._target=t,this._tcell=this._tableTarget=null,t&&t.container instanceof ReportEditor){const i=t.container,r=i.getDomPosition(t),s=e.width*i.zoom/100,n=e.height*i.zoom/100;r.x+=i.leftPos,r.y+=i.topPos,this.setStyles({display:"",left:r.x-i.leftPos+"px",top:r.y-i.topPos+"px",width:s+"px",height:n+"px"})}else this.setStyle("display","none")}setTableTarget(e,t){if(t!==this._tcell){const i=this._tcell=t&&t.parentElement;if(this._tableTarget=i&&e.findTable(this._tcell),this._target=null,this._tcell){const t=i.getBoundingClientRect(),r=e.getBound(),s=i.offsetWidth*e.zoom/100,n=i.offsetHeight*e.zoom/100;this.setStyles({display:"",left:t.x-r.x+"px",top:t.y-r.y+"px",width:s+"px",height:n+"px"})}else this.setStyle("display","none")}}clearTarget(){this.setTarget(null),this.setTableTarget(null,null)}}class ReportAddEffect extends UIElement{constructor(e){super(e,"rr-add-effect","span"),this.hide()}_doDispose(){super._doDispose()}setAddType(e,t=0,i=0){e?(this.setText(e),this.setStyles({display:"",left:t+18+"px",top:i+"px"})):this.hide()}clearAddType(){this.hide()}}class TableSelectTracker extends ReportDragTracker{constructor(e,t){super(e,"tableSelectionTracker"),this._table=t}get selectable(){return!0}_doStart(e,t,i,r){return this._selection=this.editor.getSelection()[0],!0}_doDrag(e,t,i){const r=this._table.getCellOf(e,!0);if(r)return this.editor.selections.resize(this._selection,r),!0}_doCompleted(e,t,i){}_doEnded(){}}class SelectFeedback extends UIElement{constructor(e){super(e,"rr-select-feedback")}_prepareDom(e,t){this.setImportantStyle("position","absolute")}}class ItemSelectTracker extends ReportDragTracker{constructor(e,t,i){super(e,"itemSelectionTracker"),this._selectable=!i}get startWhenCreated(){return this._offset=this.editor.getDomPosition(this.editor.reportView.pageView),!1}get selectable(){return this._selectable}_doStart(e,t,i,r){const s=this.editor;return this.$_prepare(s.doc),this._bounds=Rectangle.create(t,i,0,0),this._offset=this.editor.getDomPosition(this.editor.reportView.pageView),!0}_doDrag(e,t,i){return this._bounds.x=Math.min(this.startX,t),this._bounds.y=Math.min(this.startY,i),this._bounds.width=Math.abs(t-this.startX),this._bounds.height=Math.abs(i-this.startY),this._feedback.setRect(this._bounds),!0}_doCompleted(e,t,i){const r=this.$_getItems();r&&r.length>0&&(this.editor.clearSelection(),this.editor.addSelections(r),this.editor.focusedItem=r[0])}_doEnded(){this._editor.removeFeedback(this._feedback)}$_prepare(e){this._feedback=new SelectFeedback(e),this._editor.addFeedback(this._feedback)}$_getItems(){this._bounds.translate(-this._offset.x,-this._offset.y);const e=this.editor.reportView.activeContainerView;return this.editor.reportView.pageView.getAllElements(e,this._bounds).map((e=>e.model))}}class TableColumnMarqueeSelectTracker extends ReportDragTracker{constructor(e,t){super(e,"tableColumnMarqueeSelectTracker"),this._column=t.target}get selectable(){return!0}_doStart(e,t,i,r){return!0}_doDrag(e,t,i){const r=this.editor,s=r.getEditMarqueeTarget(e);if(s&&s.target instanceof TableColumnBase){const e=this._column.collection.getRange(this._column.index,s.target.index);return r.selections.replace(e),!0}}_doCompleted(e,t,i){}_doEnded(){}}class TableRowMarqueeSelectTracker extends ReportDragTracker{constructor(e,t){super(e,"tableRowMarqueeSelectTracker"),this._row=t.target}get selectable(){return!0}_doStart(e,t,i,r){return!0}_doDrag(e,t,i){const r=this.editor,s=r.getEditMarqueeTarget(e);if(s&&s.target instanceof TableRow){const e=this._row.collection.getRange(this._row.index,s.target.index);return r.selections.replace(e),!0}}_doCompleted(e,t,i){}_doEnded(){}}class ItemMoveAction{constructor(e){this._dx=0,this._dy=0,this._view=e,this._item=e.model,this._oldX=e.x,this._oldY=e.y}isMe(e){return e===this._item}move(e,t){return this._dx+=e,this._dy+=t,0!==this._dx&&(this._view.x=this._oldX+this._dx),0!==this._dy&&(this._view.y=this._oldY+this._dy),this}run(e){0!==this._dx&&0!==this._dy?e.moveItem(this._item,this._oldX+this._dx,this._oldY+this._dy):0!==this._dx?e.moveItemDir(this._item,"left",this._oldX+this._dx):0!==this._dy&&e.moveItemDir(this._item,"top",this._oldY+this._dy)}}class ItemsMoveAction{constructor(e,t){var i;this._oldX=[],this._oldY=[],this._dx=0,this._dy=0;const r=t.model;this._views=[t],this._items=[r],e.isSelected(r)?null===(i=e.getSelection())||void 0===i||i.forEach((t=>{t instanceof ReportItem&&t!==r&&t.parent===r.parent?(this._items.push(t),this._views.push(e.reportView.pageView.getElementOf(t))):e.removeSelection(t)})):e.clearSelection(),this._views.forEach((e=>{this._oldX.push(e.x),this._oldY.push(e.y)}))}isMe(e){return this._items.indexOf(e)>=0}move(e,t){return this._dx+=e,this._dy+=t,0!==this._dx&&this._views.forEach(((e,t)=>e.x=this._oldX[t]+this._dx)),0!==this._dy&&this._views.forEach(((e,t)=>e.y=this._oldY[t]+this._dy)),this}run(e){if(0!==this._dx&&0!==this._dy){const t=[];for(let e=0;e<this._items.length;e++)t.push({x:this._oldX[e]+this._dx,y:this._oldY[e]+this._dy});e.execute(new MoveItemsCommand(this._items,t))}else if(0!==this._dx){const t=[];for(let e=0;e<this._items.length;e++)t.push(this._oldX[e]+this._dx);e.execute(new MoveItemsDirCommand(this._items,"left",t))}else if(0!==this._dy){const t=[];for(let e=0;e<this._items.length;e++)t.push(this._oldY[e]+this._dy);e.execute(new MoveItemsDirCommand(this._items,"top",t))}}}class CrosstabTool extends Base{constructor(e){super(),this._editor=e}_doDispose(){this._editor=null,super._doDispose()}mouseDown(e){const t=e.target,i=this.$_getCrosstab(t);if(t instanceof Element&&i){const e=this._editor,r=e.focusedItem;if(CrosstabBandElement.isFieldArrow(t))r instanceof CrosstabFieldCollection&&(e.report.addCrosstabField(r,t.$_fld),e.focusedItem=r);else{const r=i.getFieldOf(t);if(r)e.setFocused(r);else{const r=i.getFieldsOf(t);e.setFocused(r||i.model)}}return!0}}click(e){const t=e.target;this.$_getCrosstab(t)}$_getCrosstab(e){const t=e instanceof HTMLElement&&this._editor.findReportElementOf(e);return t instanceof CrosstabBandElement&&t}}class ReportSelectionTool extends VisualTool{constructor(e){super(e,"reportSelectionTool"),this._crosstabTool=new CrosstabTool(e),this._editor=e,this._editor.addFeedback(this._addFeedback=new ReportAddFeedback(e.doc)),this._editor.addFeedback(this._addEffect=new ReportAddEffect(e.doc))}_doDispose(){this._editor.removeFeedback(this._addEffect),this._editor.removeFeedback(this._addFeedback),this._editor=null,this._crosstabTool=this._crosstabTool.dispose(),super._doDispose()}get editor(){return this._editor}_doMouseDown(e){const t=e.target,i=this._editor,r=i.report,s=r.page,n="mousedown"===e.type?e.button:0,o=Utils.isMac,a=o&&e.metaKey||!o&&e.ctrlKey,A=e.shiftKey,l=e.altKey;if(i.reportView.editLayer.hideError(),i.isEditing()&&t instanceof HTMLInputElement)return!0;if(i.isScrollContainer(t))return!0;if(i.isRuler(t))return!0;if(this.$_selectMarquee(t,n,A,a))return!0;const h=t instanceof Element?t:null;let d=h&&i.findElementOf(h),c=!1;if(this._clickElement=d,i.addMode){const e=!i.addShifted||0==i.addedCount;if(e&&i.clearSelection(),i.addStyle===ReportAddStyle.CLICK){let t=this._addFeedback.target;const s=this._addFeedback.tableTarget,n=this._addFeedback.trow,o=this._addFeedback.tcol;return this.$_finishAdding(),s?i.endAddCell(s,n,o,(t=>{t&&(e?i.focusedItem=t:i.addSelection(t))})):t?(t instanceof BodyItemsElement&&(i.focusedItem!==r.page.backContainer&&i.focusedItem!==r.page.frontContainer||(t=i.focusedElement)),i.endAdd(!0,t,(t=>{t&&(e?i.focusedItem=t:i.addSelection(t))}))):i.cancelAdd(),!0}}if(i.isEditor(this.mouseEventTarget)||i.hideEditor(!0),this.mouseEventTarget.classList.contains("rr-outline-expander"))return!1;if(0===n&&(this.dragTracker=this._getTracker(h,this._clickElement,A,l,a),this.dragTracker instanceof ReportDragTracker)){const e=this.dragTracker.handleSelection();if(e)return i.focusedItem=e,!1}if(!this.dragTracker||this.dragTracker.selectable){const r=i.focusedItem;let o,h,u=TableElement.getTable(d);if(d===i.reportView)h=i.report.root;else if(d instanceof SectionHeadView)c=!0,h=d.containsClass(ReportView.PAGE_HEAD)?i.report.page:d.containsClass(ReportView.BACK_HEAD)?i.report.page.backContainer:d.containsClass(ReportView.FRONT_HEAD)?i.report.page.frontContainer:d.model;else if(d instanceof GuardItemView&&d.section instanceof ReportItemElement)h=d.section.model;else if(!(d instanceof ReportItemElement)&&e.target instanceof HTMLElement&&(d=this._clickElement=i.reportView.findElementOf(e.target),d&&!u&&(u=TableElement.getTable(d))),d instanceof ReportItemElement&&d.model instanceof CellGroup&&(d=d.navigableParent),d instanceof ReportItemElement){let e;h=a&&(e=ReportItem.findFloatingAnchor(d.model))?e:d.model}else h=d instanceof PageBodyElement?d.model:null;if(u&&t instanceof HTMLElement&&(o=u.getCellOf(t,l)),o)(A||a)&&o!==r?i.toggleSelection(o,A)&&i.setFocused(o):0!=n&&i.isSelected(o)||i.setFocused(o);else if(a||A)h&&!i.focusedItem?(i.focusedItem=h,h instanceof ReportItem&&i.addSelection(h)):h!==r&&h instanceof ReportPageItem&&i.toggleSelection(h,A)&&i.setFocused(h);else if(h)if(0==n){if(i.reportView.activeContainer===s.backContainer?c||s.backContainer.isAncestorOf(h)||(h=null):i.reportView.activeContainer===s.frontContainer&&(c||s.frontContainer.isAncestorOf(h)||(h=null)),h instanceof CrosstabBand)return this._crosstabTool.mouseDown(e);h&&i.setFocused(h)}else{const e=i.getSelection();e&&(e.length>1||e[0]instanceof TableSelection&&!e[0].isSingle(!1))||i.isSelected(h)||i.setFocused(h)}}return!1}_doMouseMove(e){var t;const i=e.target,r=e.mouseX,s=e.mouseY,n=this._editor;if(n.addMode){n.setCursor("copy");const e=i instanceof HTMLElement?i.classList:null,o=this._addFeedback;let a=i instanceof HTMLElement&&n.findElementOf(i),A=a instanceof ReportItemElement&&a.model;!a&&i instanceof HTMLElement&&(null===(t=i.parentElement)||void 0===t?void 0:t.classList.contains("rr-item-container"))&&(a=n.findElementOf(i.parentElement),A=a instanceof ReportItemElement&&a.model),e&&e.contains(TableCellElementBase.STYLE)?o.setTableTarget(n,i):i instanceof HTMLTableCellElement?i.firstElementChild&&i.firstElementChild.classList.contains(TableCellElementBase.STYLE)&&o.setTableTarget(n,i.firstElementChild):a instanceof ListContainerElement||a instanceof StackContainerElement||a instanceof BoxContainerElement||a instanceof FloatingContainerElement||a instanceof DiagonalBoxContainerElement?o.setTarget(a):a instanceof BandElement?o.clearTarget():a instanceof BandCollectionElement?o.setTarget(a):A instanceof CellContainer||A&&A.parent instanceof CellGroup?o.clearTarget():a instanceof ReportItemElement?o.setTarget(a):a instanceof PageBodyElement?o.setTarget(a.itemsView):o.clearTarget(),this._addEffect.setAddType(n.addType.ITEM_TYPE,r,s)}else n.handMode?n.setCursor("grab"):n.setCursor("")}_doMouseUp(e){}_doClick(e){if(this._crosstabTool.click(e))return;const t=e.target,i=this._editor;t instanceof HTMLElement&&i.findElementOf(t)}_doDblClick(e){const t=e.target,i=this._editor,r=t instanceof HTMLElement&&i.findElementOf(t);i.addMode||!r||r!==this._clickElement||!this.editor.focusedItem||i.showEditor()}_doMouseWheel(e){const t=this._editor;if(t.isEditing())return e.stopImmediatePropagation(),!0;if(e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY)){const i=t.leftPos;return t.leftPos=i+e.deltaX,t.invalidateLayout(!0),!0}{const i=t.topPos;return t.topPos=i+e.deltaY,t.invalidateLayout(!0),!0}}_doMouseEnter(e){}_doMouseLeave(e){}_doMouseOutside(){this._editor.endAdd()}_doMouseOver(e){}_doContextMenu(e){return!1}_doKeyDown(e){const t=e.code,i=Utils.isMac,r=e.shiftKey,s=e.altKey,n=e.ctrlKey,o=i&&e.metaKey||!i&&n,a=o&&!s&&!r,A=this._editor,l=A.report,h=A.reportView.pageView,d=A.focusedItem,c=A.focusedItemElement;let u,p;if(this.$_isEditingCode(t))return!1;switch(t){case"KeyZ":if(i&&o&&r)return A.redo();if(n&&r&&!s)return A.redo();if(a)return A.undo();break;case"KeyY":if(a)return A.redo();break;case"KeyC":if(i&&e.ctrlKey&&e.metaKey&&!e.altKey&&!e.shiftKey){this.$_doAlignItems("center");break}if(n&&s&&e.metaKey&&!e.shiftKey){this.$_doAlignItems("center");break}if(a)return A.copy();break;case"KeyV":if(a)return A.paste();break;case"KeyX":if(a)return A.cut();break;case"Delete":return A.deleteSelection();case"Backspace":if(i&&a)return A.deleteSelection();case"Escape":if(this._doEsc(a))return!0;break;case"Enter":e.isComposing||this._doEnter(r)||e.preventDefault();break;case"Tab":if(this._doTab(r))return!0;break;case"Home":a&&(p=h.getFirst()),c&&(p=h.getFirstInGroup(c.navigableParent));break;case"End":a&&(p=h.getLast()),c&&(p=h.getLastInGroup(c.navigableParent));break;case"ArrowUp":if(i&&e.ctrlKey&&e.metaKey&&!e.altKey&&!e.shiftKey){this.$_doAlignItems("top");break}if(n&&s&&e.metaKey&&!e.shiftKey){this.$_doAlignItems("top");break}if(!o&&s&&d instanceof ReportItem)return this.$_moveItem(c,0,-1),!0;if(o&&s&&d instanceof ReportItem)l.changeItemIndex(d,d.index-1);else if(d instanceof TableCell){if(r)return A.selections.resizeBy(A.selections.find(d),0,-1),!0;u=d.table.getCell(d.row-1,d.col),u||(p=h.getUpper(h.getElementOf(d.table)))}else p=h.getUpper(c);break;case"ArrowDown":if(i&&e.ctrlKey&&e.metaKey&&!e.altKey&&!e.shiftKey){this.$_doAlignItems("bottom");break}if(n&&s&&e.metaKey&&!e.shiftKey){this.$_doAlignItems("bottom");break}if(!o&&s&&d instanceof ReportItem)return this.$_moveItem(c,0,1),!0;if(o&&s&&d instanceof ReportItem)l.changeItemIndex(d,d.index+1);else if(d instanceof TableCell){if(r)return A.selections.resizeBy(A.selections.find(d),0,1),!0;u=d.table.getCell(d.row+1,d.col),u||(p=h.getLower(h.getElementOf(d.table)))}else p=h.getLower(c);break;case"ArrowLeft":if(i&&e.ctrlKey&&e.metaKey&&!e.altKey&&!e.shiftKey){this.$_doAlignItems("left");break}if(n&&s&&e.metaKey&&!e.shiftKey){this.$_doAlignItems("left");break}if(!o&&s&&d instanceof ReportItem)return this.$_moveItem(c,-1,0),!0;if(o&&s&&d instanceof ReportItem)l.changeItemIndex(d,d.index-1);else if(d instanceof TableCell){if(r)return A.selections.resizeBy(A.selections.find(d),-1,0),!0;u=d.table.getCell(d.row,d.col-1),u||(p=h.getLeft(h.getElementOf(d.table)))}else p=h.getLeft(c);break;case"ArrowRight":if(i&&e.ctrlKey&&e.metaKey&&!e.altKey&&!e.shiftKey){this.$_doAlignItems("right");break}if(n&&s&&e.metaKey&&!e.shiftKey){this.$_doAlignItems("right");break}if(!o&&s&&d instanceof ReportItem)return this.$_moveItem(c,1,0),!0;if(o&&s&&d instanceof ReportItem)l.changeItemIndex(d,d.index+1);else if(d instanceof TableCell){if(r)return A.selections.resizeBy(A.selections.find(d),1,0),!0;u=d.table.getCell(d.row,d.col+1),u||(p=h.getRight(h.getElementOf(d.table)))}else p=h.getRight(c);break;case"KeyA":if(a&&d instanceof ReportGroupItem)return A.selectAll(r?d:null),!0;break;case"Digit0":if(a)return A.incZoom(0),!0;break;case"Equal":if(a)return A.incZoom(1),!0;break;case"Minus":if(a)return A.incZoom(-1),!0}return p&&(u=u||p.model),u&&u!=d&&A.setFocused(u),super._doKeyDown(e)}_doKeyPress(e){return!1}_doKeyUp(e){return this._moveAction&&(this._moveAction.run(this.editor.reportView.model),this._moveAction=null),!1}$_getTable(e){for(;e;){if(e instanceof HTMLTableCellElement)return this._editor.findTable(e);e=e.parentElement}}_getTracker(e,t,i,r,s){var n;const o=this._editor,a=TableElement.getTable(t)||this.$_getTable(e);let A;if(s&&i)return new ItemSelectTracker(o,t,i&&s);if(t instanceof FocusHandle&&t.enabled&&!i)return new ItemResizeTracker(o,t);if(o.handMode)return new HandModeTracker(o);if(a){if(a.getCellOf(e,r))return new TableSelectTracker(o,a)}if((A=TableContainerMarquee.isColSizeTracker(e))>=0){const e=o.marquee.target;if(e)return new TableColumnResizeTracker(o,e,o.marquee,A)}if((A=TableContainerMarquee.isRowSizeTracker(e))>=0){const e=o.marquee.target;if(e)return new TableRowResizeTracker(o,e,o.marquee,A)}if((A=TableBandMarquee.isColSizeTracker(e))>=0){const e=o.marquee.target;if(e)return new TableColumnResizeTracker(o,e,o.marquee,A)}if(A=TableBandMarquee.isRowSizeTracker(e)){const e=o.marquee.target.getTableView(A.table);return new TableRowResizeTracker(o,e,o.marquee,A.row)}if(t instanceof ReportItemElement&&t.model.canMove()&&!i){const e=null===(n=t.model.parent)||void 0===n?void 0:n.getMoveType(t.model);if(e)return new ItemMoveTracker(o,t,e)}return t===o.reportView.parent||t instanceof ReportEditView||t instanceof PageBodyElement||t instanceof SectionElement||t instanceof BodyItemsElement||t instanceof PageItemContainerElement?new ItemSelectTracker(o,t,!1):void 0}$_selectMarquee(e,t,i,r){const s=this._editor,n=this._marqueeTarget=s.getEditMarqueeTarget(Utils.cast(e,HTMLElement));if(n){const o=n.target;return(i||r)&&o&&s.focusedItem&&o.constructor===s.focusedItem.constructor?s.toggleSelection(o,i)&&s.setFocused(o):o&&s.focusedItem!==o&&s.setFocused(o),0!==t||r||(o instanceof TableColumnBase?this.dragTracker=new TableColumnMarqueeSelectTracker(s,n):o instanceof TableRow?this.dragTracker=new TableRowMarqueeSelectTracker(s,n):o instanceof HichartSeries&&(this.dragTracker=new ChartSeriesMoveTracker(s,e,n))),!0}}_doEsc(e){const t=this._editor,i=t.focusedItem;if(this._marqueeTarget)return t.closeEditMarquee(),this._marqueeTarget.target===i&&t.setFocused(t.getDisplayParent(i)),this._marqueeTarget=null,!0;if(this.$_finishAdding(),!t.cancelAdd()&&!t.hideEditor(!1)&&i){let r;e&&(r=ReportItem.findFloatingAnchor(i))?t.setFocused(r):t.setFocused(t.getDisplayParent(i))}}_doEnter(e){const t=this._editor;if(t.focusedItem){if(t.isEditing()&&e&&t.canMultiLine())return!0;if(t.hideEditor(!0))return;if(t.showEditor())return}}_doTab(e){const t=this._editor,i=t.reportView.pageView;if(t.focusedItem){const r=t.focusedItemElement;let s;if(s=e?i.getPrev(r):i.getNext(r),s&&s!==r)return t.setFocused(s.model),!0}}$_moveItem(e,t,i){this._moveAction?this._moveAction.isMe(e.model)||(this._moveAction.run(this.editor.reportView.model),this.editor.selectionCount>1?this._moveAction=new ItemsMoveAction(this.editor,e):this._moveAction=new ItemMoveAction(e)):this.editor.selectionCount>1?this._moveAction=new ItemsMoveAction(this.editor,e):this._moveAction=new ItemMoveAction(e),this._moveAction.move(t,i)}$_isEditingCode(e){const t=this._editor.isEditing();return!!Object.values(EditingKeyCode).includes(e)&&t}$_doAlignItems(e){this._editor.report.alignItems(this._editor.getSelectedItems(),e)}$_finishAdding(){this._editor.setCursor(""),this._addFeedback.clearTarget(),this._addEffect.clearAddType()}}class RulerView extends LayerElement{constructor(e,t,i){super(e,t),this._unit=PrintUnit.MILLI,this._startPos=50,this._length=210,this._marginStart=12,this._marginEnd=12,this._zoom=100,this._tickPool=[],this._ticks=[],this._labelPool=[],this._labels=[],this._layoutChanged=!0,this._dimChanged=!0,this._container=i}_doDispose(){super._doDispose()}get unit(){return this._unit}set unit(e){e!=this._unit&&(this._unit=e,this._dimensionChanged())}get startPos(){return this._startPos}set startPos(e){e!=this._startPos&&(this._startPos=e,this._changed())}get length(){return this._length}set length(e){e!=this._length&&(this._length=e,this._dimensionChanged())}get marginStart(){return this._marginStart}set marginStart(e){(e=Math.max(0,e))!=this._marginStart&&(this._marginStart=e,this._dimensionChanged())}get marginEnd(){return this._marginEnd}set marginEnd(e){(e=Math.max(0,e))!=this._marginEnd&&(this._marginEnd=e,this._dimensionChanged())}get zoom(){return this._zoom}set zoom(e){e!==this._zoom&&(this._zoom=e,this._changed())}refreshView(){if(this._layoutChanged||this._dimChanged){if(this._dimChanged){const e=this._unit;this._lengthDim=new Dimension(this._length+e),this._marginStartDim=new Dimension(this._marginStart+e),this._marginEndDim=new Dimension(this._marginEnd+e),this._dimChanged=!1}this._doRefreshView(this._container),this.setFocusedElement(this._container.focusedElement),this._layoutChanged=!1}}getTick(e){return this._ticks[e]}setFocusedElement(e){}_initDom(e,t){super._initDom(e,t),t.style.boxSizing="content-box",this._contentMask=e.createElement("div"),this._contentMask.className="rr-ruler-content",this._contentMask.style.position="absolute",t.appendChild(this._contentMask),this._tickBar=e.createElement("div"),this._tickBar.style.position="absolute",t.appendChild(this._tickBar)}_changed(){this._layoutChanged=!0}_dimensionChanged(){this._dimChanged=!0}_clearTicks(){if(this._ticks.length>0){for(let e of this._ticks)Utils.remove(e),this._tickPool.push(e);this._ticks=[]}if(this._labels.length>0){for(let e of this._labels)Utils.remove(e),this._labelPool.push(e);this._labels=[]}}_addTick(e){let t=this._tickPool.pop();return t||(t=e.createElement("span"),t.style.position="absolute",t.style.width="1px",t.style.backgroundColor="#aaa"),this._tickBar.appendChild(t),this._ticks.push(t),t}_addLabel(e){let t=this._labelPool.pop();return t||(t=e.createElement("span"),t.style.position="absolute",t.style.color="#555",t.style.textAlign="center",t.style.fontFamily="Helvetica, Arial, sans-serif",t.style.fontSize="8px"),this._tickBar.appendChild(t),this._labels.push(t),t}_prepareTicks(e){this._clearTicks();let t=1+2*Math.round(this.length/10);for(let i=0;i<t;i++)this._addTick(e);t/=2;for(let i=0;i<t;i++)this._addLabel(e)}}RulerView.RULER_WIDTH=14;class HorizontalRulerView extends RulerView{constructor(e,t){super(e,"horizontalRuler",t),this.height=RulerView.RULER_WIDTH}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-ruler rr-ruler-horizontal"}_initDom(e,t){super._initDom(e,t),this._indicator=e.createElement("span"),this._indicator.className="rr-ruler-indicator rr-ruler-indicator-horz",this._indicator.style.position="absolute",this._indicator.style.boxSizing="border-box",this._contentMask.appendChild(this._indicator)}_doRefreshView(e){const t=this.zoom/100;let i=this.startPos;let r=this._lengthDim.getFixedPixel()*t;const s=this.height;Utils.setBounds(this._tickBar,i,0,r,s);const n=this._marginStartDim.getFixedPixel()*t;i+=n,r-=n+this._marginEndDim.getFixedPixel()*t,Utils.setBounds(this._contentMask,i,0,r,s),this._prepareTicks(e.doc),this.$_layoutTicks(t)}setFocusedElement(e){if(e){const t=this.container,i=this.zoom/100,r=t.reportView.getItemBoundingRect(e);Utils.setBounds(this._indicator,r.left*i,0,r.width*i,this.height),this._indicator.style.display=""}else this._indicator.style.display="none"}$_layoutTicks(e){const t=this.unit,i=this.height,r=.2*i,s=.4*i,n=i-r,o=i-s,a=this._ticks,A=this._labels;for(let i=0,l=0,h=a.length;i<h;i++){const h=a[i],d=i%2==0?r:s,c=i%2==0?n:o;let u=getPixelsByUnits(t,5*i);if(l>0&&(u*=e),Utils.setBounds(h,u,c,1,d),i%2==0){const e=A[l++];e.textContent=l+"",Utils.setBounds(e,u-50,-1,100,d)}}}}class VerticalRulerView extends RulerView{constructor(e,t){super(e,"verticalRuler",t),this.length=297,this.marginStart=15,this.marginEnd=15,this.width=RulerView.RULER_WIDTH}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-ruler rr-ruler-vertical"}_initDom(e,t){super._initDom(e,t),this._indicator=e.createElement("span"),this._indicator.className="rr-ruler-indicator rr-ruler-indicator-vert",this._indicator.style.position="absolute",this._indicator.style.boxSizing="border-box",this._contentMask.appendChild(this._indicator)}_doRefreshView(e){const t=this.zoom/100;let i=this.startPos;let r=this._lengthDim.getFixedPixel()*t;const s=this.width;Utils.setBounds(this._tickBar,0,i,s,r);const n=this._marginStartDim.getFixedPixel()*t;i+=n,r-=n+this._marginEndDim.getFixedPixel()*t,Utils.setBounds(this._contentMask,0,i,s,r),this._prepareTicks(e.doc),this.$_layoutTicks(t)}setFocusedElement(e){if(e){const t=this.container,i=this.zoom/100,r=t.reportView.getItemBoundingRect(e);Utils.setBounds(this._indicator,0,r.top*i,this.width,r.height*i),this._indicator.style.display=""}else this._indicator.style.display="none"}$_layoutTicks(e){const t=this.unit,i=this.width,r=.2*i,s=.4*i,n=i-r,o=i-s,a=this._ticks,A=this._labels;for(let i=0,l=0,h=a.length;i<h;i++){const h=a[i],d=i%2==0?r:s,c=i%2==0?n:o;let u=getPixelsByUnits(t,5*i);if(l>0&&(u*=e),Utils.setBounds(h,c,u,d,1),i%2==0){const e=A[l++];e.style.transform="rotate(-90deg)",e.textContent=l+"",Utils.setBounds(e,-46,u-4,100,10)}}}}class TextEditor extends VisualElement{constructor(e,t){super(e,"textEditor"),this._reportEditor=t}_doDispose(){super._doDispose()}get editTarget(){return this._editTarget}get isEditing(){return!!this._editTarget}show(e,t){if(e&&e.editable&&e!==this._editTarget){const t=this.container._scrollContainer,i=Utils.getBoundingRect(t.dom,e.parent.dom);return i.x+=t.scrollLeft,i.y+=t.scrollTop,this.setBounds(i.x,i.y,i.width,i.height),this._input.innerText=e.getEditText(),this.$_setInputEvent(),this.$_setInputStyle(e),this.style.display="",Utils.selectAll(this._input),e.dom.style.visibility="hidden",this._editTarget=e,this._reportEditor.reportView._editLayer.hideFocus(),this._oldValue=this._input.innerText,!0}}hide(e){const t=this._input;if(this._editTarget)return e&&t.innerText!==this._oldValue&&(this._editTarget.setEditText(this._reportEditor.reportView.model,t.innerText),this.container.invalidateLayout()),this.style.display="none",this._reportEditor.reportView._editLayer.showFocus(),this._editTarget.dom.style.visibility="",this._editTarget=null,!0}is(e){return this.dom.contains(e)}canMultiLine(){const e=this._editTarget.model;return e instanceof TextItem&&e.multiLine}_initDom(e,t){super._initDom(e,t);const i=this._input=e.createElement("span");i.className="rr-text-edit",i.contentEditable="true",t.style.display="none",t.style.zIndex=ReportEditView.ACTIVE_ZINDEX,t.appendChild(i)}_getCssSelector(){return"rr-text-editor"}$_setInputStyle(e){if(e&&this._reportEditor){const t=this._input.style;t.left=null,t.right=null,t.transform=null,t.maxWidth=null,t.top=e.y+"px";const i=TextItemBase.STYLE_PROPS.concat(["whiteSpace","wordBreak","letterSpacing"]),r=window.getComputedStyle(e.dom);for(let e=0;e<i.length;e++){const s=i[e].search(/[A-Z]/gm);t[i[e]]=-1===s?r.getPropertyValue(i[e]):r.getPropertyValue(i[e].slice(0,s)+"-"+i[e].slice(s).toLowerCase())}const s=e.parent,n=e.model;if(s instanceof TableCellElement){const e=s.model.table.getCell(s.model.row,s.model.col).styles.cellAlign;"left"===e?t.left="0px":"right"===e?t.right="0px":(t.left="50%",t.transform="translate(-50%, 0)")}else if(s instanceof RowBoxContainerElement){const i=s.model.itemsAlign;"middle"===i?(t.left=e.x+e.width/2+"px",t.transform="translate(-50%, 0)"):"end"===i?t.right=s.width-(e.x+e.width)+"px":t.left=e.x+"px"}else s instanceof ListCellElement?t.left=e.x+"px":s instanceof DiagonalBoxContainerElement?e.x&&(t.right="0px"):n.left?t.left=Utils.isNumber(n.left)?n.left+"px":n.left:n.right?t.right=Utils.isNumber(n.right)?n.right+"px":n.right:(t.left="50%",t.transform="translate(-50%, 0)");0!==e.rotation&&(t.transform=t.transform+` rotate(${e.rotation}deg)`),t.border="1px solid #000",t.position="absolute",t.minWidth=n.width?e.width+"px":null,t.minHeight=n.height?e.height+"px":null,e instanceof TextItemElement&&e.model.wrap&&e.model.width&&(t.maxWidth=e.width+"px")}}$_setInputEvent(){const e=this._input;e.addEventListener("mousedown",(e=>{e.stopPropagation()})),e.addEventListener("blur",(()=>{this.hide(!0)}))}}class TableDesignTool extends VisualTool{constructor(e,t){super(t),this._cellClicked=!1,this._titleClicked=!1,this._designer=e}_doMouseDown(e){const t=e.target;return this._cellClicked=this._titleClicked=!1,0===e.button&&t instanceof HTMLElement&&((this._cellClicked=t.className===TableDesigner.CELL_CLASS)?this._designer.setRange(0,0):(this._titleClicked=t.className===TableDesigner.TITLE_CLASS)&&(this._prevX=e.clientX,this._prevY=e.clientY)),!1}_doMouseMove(e){const t=e.target;if(this._cellClicked&&t instanceof HTMLSpanElement&&t.className===TableDesigner.CELL_CLASS){const e=+t.dataset.row,i=+t.dataset.col;this._designer.setRange(e+1,i+1)}else if(this._titleClicked){const t=e.clientX,i=e.clientY;this._designer.moveBy(t-this._prevX,i-this._prevY,!0),this._prevX=t,this._prevY=i}}_doMouseUp(e){this._cellClicked=this._titleClicked=!1}_doKeyDown(e){if("Escape"===e.key)return this._designer.$_end(!1),!0}_doKeyPress(e){if("Enter"===e.key)return this._designer.$_end(!0),!0}}class TableDesigner extends PopupElement{constructor(e){super(e,"tableDesigner"),this._row=-1,this._col=-1}run(e,t){this._callback=t,e.showPopup(this),e.activeTool=new TableDesignTool(this,e)}setRange(e,t){e===this._row&&t===this._col||(this._row=e,this._col=t,this._cells.forEach((i=>{const r=+i.dataset.row,s=+i.dataset.col;i.style.backgroundColor=r<e&&s<t?"#00eeff":"white"})),this._spanRange.textContent=`(${e} X ${t} cells)`)}_getCssSelector(){return"rr-table-designer"}_initDom(e,t){super._initDom(e,t),Object.assign(t.style,{boxShadow:"3px 3px 8px #888"}),this._spanTitle=e.createElement("span"),this._spanTitle.className=TableDesigner.TITLE_CLASS,this._spanTitle.dataset.title="1",this._spanTitle.textContent="New TableContainer",Object.assign(this._spanTitle.style,{display:"inline-block",width:"100%"}),t.appendChild(this._spanTitle),this._cellContainer=e.createElement("div"),Object.assign(this._cellContainer.style,{display:"flex",flexWrap:"wrap",gap:"2px",border:"1px solid gray",backgroundColor:"#ccc",padding:"4px",marginBottom:"12px"}),this._rowLen=TableDesigner.ROWS,this._colLen=TableDesigner.COLS,this._cells=[],this.$_prepareCells(e,this._cellContainer,this._rowLen,this._colLen),t.appendChild(this._cellContainer),this._buttonContainer=e.createElement("div"),Object.assign(this._buttonContainer.style,{textAlign:"right"}),this.$_prepareButtons(e,this._buttonContainer),t.appendChild(this._buttonContainer);const i=this._spanRange=e.createElement("span");Object.assign(i.style,{display:"inline-block",position:"absolute",bottom:"15px",marginLeft:"5px",fontSize:"1.1em",fontWeight:"bold"}),i.textContent="(0 X 0 cells)",t.appendChild(this._spanRange)}_doMeasure(e,t,i,r){return this._cellContainer.style.height="200px",new Size(310,300)}$_prepareCells(e,t,i,r){const s=this._cells;for(;s.length<i*r;){const i=e.createElement("span");Object.assign(i.style,{display:"inline-block",width:TableDesigner.CELL_WIDTH,height:TableDesigner.CELL_HEIGHT,color:"white",border:"1px solid #555",backgroundColor:"white"}),i.className=TableDesigner.CELL_CLASS,t.appendChild(i),this._cells.push(i)}for(let e=0;e<i;e++)for(let t=0;t<r;t++){const i=s[e*r+t];i.dataset.row=String(e),i.dataset.col=String(t)}}$_prepareButtons(e,t){let i=e.createElement("button");i.style.marginRight="8px",i.textContent="Create",i.onclick=()=>{this.$_end(!0)},t.appendChild(i),i=e.createElement("button"),i.textContent="Cancel",i.onclick=()=>{this.$_end(!1)},t.appendChild(i)}$_end(e){if(e&&(this._row<1||this._col<1))alert("테이블 셀 범위를 지정해야 합니다.");else if(this.container.activeTool=null,this.container.hidePopup(this),e&&this._callback){const e=new TableContainer("");e.rowCount=this._row,e.colCount=this._col,this._callback&&this._callback(e)}}}TableDesigner.CELL_CLASS="rr-table-designer-cell",TableDesigner.TITLE_CLASS="rr-table-designer-title",TableDesigner.COLS=10,TableDesigner.ROWS=10,TableDesigner.CELL_WIDTH="24px",TableDesigner.CELL_HEIGHT="16px";class BandDesignTool extends VisualTool{constructor(e,t){super(t),this._titleClicked=!1,this._sizeClicked=!1,this._designer=e}_doMouseDown(e){const t=e.target;return this._titleClicked=this._sizeClicked=!1,0===e.button&&t instanceof HTMLElement&&((this._sizeClicked=t===this._designer._sizer)||(this._titleClicked=t.className===BandDesigner.TITLE_CLASS))&&(this._prevX=e.clientX,this._prevY=e.clientY),!1}_doMouseMove(e){const t=e.clientX,i=e.clientY;this._sizeClicked?this._designer.resizeBy(t-this._prevX,i-this._prevY,!0):this._titleClicked&&this._designer.moveBy(t-this._prevX,i-this._prevY,!0),this._prevX=t,this._prevY=i}_doMouseUp(e){this._titleClicked=this._sizeClicked=!1}_doClick(e){const t=e.target;t instanceof HTMLButtonElement?this._designer.buttonClick(t):t instanceof HTMLElement&&this._designer.clickField(t)}_doKeyDown(e){if("Escape"===e.key)return this._designer._end(!1),!0}_doKeyPress(e){if("Enter"===e.key)return this._designer._end(!0),!0}}class BandDesigner extends PopupElement{clickField(e){e.className===BandDesigner.FIELD_CLASS?e.parentElement===this._fieldList?this._currSrc=e:e.parentElement===this._bandFieldList&&(this._currDst=e):e.className===BandDesigner.FIELD_LIST_CLASS&&(this._currSrc=this._currDst=null),this.$_checkArrows()}buttonClick(e){switch(e.textContent){case">>":this.$_addAll();break;case">":this.$_add();break;case"<<":this.$_removeAll();break;case"<":this.$_remove()}}$_refreshFields(){for(let e of this._fieldList.children)e===this._currSrc?e.dataset.select="1":delete e.dataset.select}_refreshBandFields(){for(let e of this._bandFieldList.children)e===this._currDst?e.dataset.select="1":delete e.dataset.select}$_checkArrows(){const e=this.dom.getElementsByClassName(BandDesigner.ARROW_CLASS);for(let t of e){const e=t;switch(e.textContent){case">>":e.disabled=0===this._fieldList.children.length;break;case">":e.disabled=!this._currSrc;break;case"<<":e.disabled=0===this._bandFieldList.children.length;break;case"<":e.disabled=!this._currDst}}this.$_refreshFields(),this._refreshBandFields(),this._ok.disabled=0===this._bandFieldList.children.length}resizeBy(e,t,i){super.resizeBy(e,t,i),this._refreshBandFields()}$_addAll(){const e=this._fieldList,t=this._bandFieldList;for(;e.firstElementChild;)t.appendChild(e.firstElementChild);this._currSrc=null,this.$_checkArrows()}$_removeAll(){const e=this._fieldList,t=this._bandFieldList;for(;t.firstElementChild;)e.appendChild(t.firstElementChild);this._currDst=null,this.$_checkArrows()}$_add(){this._bandFieldList.append(this._currSrc),this._currDst=this._currSrc,this._currSrc=null,this.$_checkArrows()}$_remove(){this._fieldList.append(this._currDst),this._currSrc=this._currDst,this._currDst=null,this.$_checkArrows()}}BandDesigner.TITLE_CLASS="rr-band-designer-title",BandDesigner.FIELD_LIST_CLASS="rr-band-designer-field-list",BandDesigner.FIELD_CLASS="rr-band-designer-field",BandDesigner.ARROW_CLASS="rr-band-designer-arrow";class TableBandDesigner extends BandDesigner{constructor(e){super(e,"tableBandDesigner")}run(e,t){this._callback=t,this._editor=e,this.$_buildDesinger(e),e.showPopup(this),e.activeTool=new BandDesignTool(this,e)}_getCssSelector(){return"rr-band-designer"}_initDom(e,t){super._initDom(e,t),Object.assign(t.style,{display:"flex",flexDirection:"column",width:"480px",height:"380px",minWidth:"300px",minHeight:"250px"}),Object.assign(t.style,{boxShadow:"3px 3px 8px #888"}),this._spanTitle=e.createElement("span"),this._spanTitle.className=BandDesigner.TITLE_CLASS,this._spanTitle.dataset.title="1",this._spanTitle.textContent="New TableBand",Object.assign(this._spanTitle.style,{display:"inline-block",flex:"0",width:"100%"}),t.appendChild(this._spanTitle),t.appendChild(this._container=e.createElement("div")),Object.assign(this._container.style,{display:"flex",gap:"8px",flex:"1 1 auto",width:"100%",overflow:"hidden"}),this._container.appendChild(this._dataContainer=e.createElement("div")),Object.assign(this._dataContainer.style,{display:"flex",flexDirection:"column",gap:"4px",flex:"1 1",height:"100%",border:"1px solid #ddd",boxSizing:"border-box"}),this.$_prepareData(e,this._dataContainer),this._container.appendChild(this._arrowContainer=e.createElement("div")),Object.assign(this._arrowContainer.style,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"10px",width:"50px",height:"100%",border:"1px solid #ddd",boxSizing:"border-box",paddingTop:"74px"}),this.$_prepareArrows(e,this._arrowContainer),this._container.appendChild(this._bandContainer=e.createElement("div")),Object.assign(this._bandContainer.style,{display:"flex",gap:"4px",flexDirection:"column",flex:"1 1",height:"100%",border:"1px solid #ddd",boxSizing:"border-box"}),this.$_prepareBand(e,this._bandContainer),t.appendChild(this._buttonContainer=e.createElement("div")),Object.assign(this._buttonContainer.style,{width:"100%",padding:"16px 0 0",textAlign:"right"}),this.$_prepareButtons(e,this._buttonContainer),t.appendChild(this._sizer=e.createElement("div")),Object.assign(this._sizer.style,{position:"absolute",right:"0",bottom:"0",width:"8px",height:"8px",background:"transparent",cursor:"nwse-resize"})}_doMeasure(e,t,i,r){return new Size(t.offsetWidth,t.offsetHeight)}_refreshBandFields(){super._refreshBandFields();const e=this._bandFieldList,t=this._currDst,i=this._upButton,r=this._downButton;if(t){i.style.display="",r.style.display="";const s=t.offsetWidth,n=0;t.appendChild(i),t.appendChild(r),Utils.move(i,s-i.offsetWidth-r.offsetWidth-4,n),Utils.move(r,s-r.offsetWidth-2,n),i.disabled=t===e.firstElementChild,r.disabled=t===e.lastElementChild}else i.remove(),r.remove(),i.style.display="none",r.style.display="none"}buttonClick(e){if(super.buttonClick(e),e===this._upButton||e===this._downButton){const t=this._bandFieldList,i=this._currDst;if(e===this._upButton){const e=Utils.getPrev(i);i.remove(),t.insertBefore(i,e)}else{const e=Utils.getNext(Utils.getNext(i));i.remove(),e?t.insertBefore(i,e):t.appendChild(i)}this._refreshBandFields()}}$_prepareData(e,t){let i=e.createElement("span");i.textContent="Band Data 선택:",t.appendChild(i);const r=this._dataList=e.createElement("select");r.style.marginBottom="12px",r.onchange=e=>{this.$_collectFields(),this._bandFieldList.innerHTML="",this._currSrc=this._currDst=null,this.$_checkArrows()},t.appendChild(r),i=e.createElement("span"),i.textContent="필드 목록:",t.appendChild(i);const s=this._fieldList=e.createElement("div");s.className=BandDesigner.FIELD_LIST_CLASS,Object.assign(s.style,{display:"flex",flexDirection:"column",gap:"4px",flex:"1 1 auto",background:"white",padding:"2px",border:"1px solid gray",overflow:"auto"}),t.appendChild(s)}$_prepareArrows(e,t){[">>",">","","<","<<"].forEach((i=>{let r=e.createElement(i?"button":"span");Object.assign(r.style,{whiteSpace:"pre",width:"32px",height:"25px"}),r.textContent=i,r instanceof HTMLButtonElement&&(r.className=BandDesigner.ARROW_CLASS,r.disabled=!0),t.appendChild(r)}))}$_prepareBand(e,t){let i=e.createElement("span");i.style.height="50px",t.appendChild(i),i=e.createElement("span"),i.textContent="Band 필드:",t.appendChild(i);const r=this._bandFieldList=e.createElement("div");this._bandFieldList.className=BandDesigner.FIELD_LIST_CLASS,t.appendChild(r),Object.assign(r.style,{flex:"1 1 auto",background:"white",border:"1px solid gray",padding:"2px",overflow:"auto"});let s=this._upButton=e.createElement("button");Object.assign(s.style,{position:"absolute",display:"none",padding:"0px 2px",fontSize:"10px"}),s.textContent="⬆",s=this._downButton=e.createElement("button"),Object.assign(s.style,{position:"absolute",display:"none",padding:"0px 2px",fontSize:"10px"}),s.textContent="⬇"}$_prepareButtons(e,t){let i=this._ok=e.createElement("button");i.disabled=!0,i.style.marginRight="8px",i.textContent="Create",i.onclick=()=>{this._end(!0)},t.appendChild(i),i=this._cancel=e.createElement("button"),i.textContent="Cancel",i.onclick=()=>{this._end(!1)},t.appendChild(i)}_end(e){if(this.container.activeTool=null,this._currDst=null,this._refreshBandFields(),this.container.hidePopup(this),e&&this._callback){const e=new TableBand(""),t=this._dataList.selectedIndex;e.data=this._dataList.options[t].text;const i=this._bandFieldList.children,r=i.length;if(r>0){e.colCount=r;for(let t=0;t<r;t++){let r=new TextItem("",i[t].textContent);r.setChildProp("col",t),e.header.add(r),r=new TextItem(""),r.value=i[t].textContent,r.setChildProp("col",t),e.dataRow.add(r)}}this._callback&&this._callback(e)}}$_buildDesinger(e){const t=e.report.designData.getNames();this._dataList.innerHTML="",t.forEach((e=>{const t=new Option(e,e);this._dataList.appendChild(t)})),this._bandFieldList.innerHTML="",this.$_collectFields()}$_collectFields(){const e=this._editor.report.designData.get(this._dataList.value);if(this._fieldList.innerHTML="",e){const t=this._editor.doc;e.getFieldNames().forEach((e=>{const i=t.createElement("div");i.className=BandDesigner.FIELD_CLASS,Object.assign(i.style,{position:"relative",padding:"1px 4px"}),i.textContent=e,this._fieldList.appendChild(i)}))}}}class SimpleBandDesigner extends BandDesigner{constructor(e){super(e,"simpleBandDesigner")}run(e,t){this._callback=t,e.showPopup(this),e.activeTool=new BandDesignTool(this,e)}_getCssSelector(){return"rr-band-designer"}_initDom(e,t){super._initDom(e,t),Object.assign(t.style,{display:"flex",flexDirection:"column",width:"600px",height:"450px",minWidth:"400px",minHeight:"250px"}),Object.assign(t.style,{boxShadow:"3px 3px 8px #888"}),this._spanTitle=e.createElement("span"),this._spanTitle.className=TableBandDesigner.TITLE_CLASS,this._spanTitle.dataset.title="1",this._spanTitle.textContent="New SimpleBand",Object.assign(this._spanTitle.style,{display:"inline-block",flex:"0",width:"100%"}),t.appendChild(this._spanTitle),t.appendChild(this._container=e.createElement("div")),Object.assign(this._container.style,{display:"flex",flex:"1 1 auto",width:"100%"}),this._container.appendChild(this._dataContainer=e.createElement("div")),Object.assign(this._dataContainer.style,{display:"flex",flex:"1 1 auto",height:"100%",border:"1px solid gray"}),this.$_prepareData(e,this._dataContainer),t.appendChild(this._buttonContainer=e.createElement("div")),Object.assign(this._buttonContainer.style,{width:"100%",padding:"16px 0 0",textAlign:"right"}),this.$_prepareButtons(e,this._buttonContainer),t.appendChild(this._sizer=e.createElement("div")),Object.assign(this._sizer.style,{position:"absolute",right:"0",bottom:"0",width:"8px",height:"8px",background:"transparent",cursor:"nwse-resize"})}_doMeasure(e,t,i,r){return new Size(t.offsetWidth,t.offsetHeight)}buttonClick(e){}$_prepareData(e,t){}$_prepareButtons(e,t){let i=e.createElement("button");i.style.marginRight="8px",i.textContent="Create",i.onclick=()=>{this._end(!0)},t.appendChild(i),i=e.createElement("button"),i.textContent="Cancel",i.onclick=()=>{this._end(!1)},t.appendChild(i)}_end(e){if(this.container.activeTool=null,this.container.hidePopup(this),e&&this._callback){const e=new SimpleBand("");this._callback&&this._callback(e)}}}var ReportAddStyle;!function(e){e.CLICK="click",e.DRAG="drag"}(ReportAddStyle||(ReportAddStyle={}));class Selections$3 extends EventAware{constructor(){super(...arguments),this._items=[]}get count(){return this._items.length}get isEmpty(){return 0===this._items.length}get items(){return this._items.length>0?this._items.slice(0):null}get pageItems(){const e=this._items;if(e.length>0){if(e[0]instanceof TableSelection){let t=[];return e.forEach((e=>{t=t.concat(e.getCells(!0))})),t}return e.slice(0)}return null}get last(){return this._items.length>0?this._items[this._items.length-1]:null}get first(){return this._items.length>0?this._items[0]:null}get isSinlge(){return this._items.length<=1}get(e){return this._items[e]}forEach(e){for(let t=0,i=this._items.length;t<i&&!0!==e(this._items[t],t);t++);}indexOf(e){const t=this._items;if(e instanceof TableCell){for(let i=t.length-1;i>=0;i--){const r=t[i];if(r instanceof TableSelection&&r.containsCell(e))return i}return-1}return t.indexOf(e)}find(e){const t=this.indexOf(e);return t>=0?this._items[t]:null}contains(e){if(this.indexOf(e)>=0)return!0;if(e instanceof TableCell)for(let t of this._items)if(t instanceof TableSelection&&t.contains(e.row,e.col))return!0;return!1}clear(){return this._items.length>0&&(this._items=[],this._changed(),!0)}$_add(e){return!!(e&&this.indexOf(e)<0)&&(e instanceof TableCell?this._items.push(e.table.getSelection(e)):this._items.push(e),!0)}add(e){return!!this.$_add(e)&&(this._changed(),!0)}addAll(e){if(e&&e.length>0){let t=!1;for(let i of e)this.$_add(i)&&(t=!0);return t&&this._changed(),t}return!1}removeAt(e){return e>=0&&e<this._items.length&&(this._items.splice(e,1),this._changed(),!0)}remove(e){if(e){const t=e instanceof TableCell?this.indexOf(e):this._items.indexOf(e);return this.removeAt(t)}return!1}removeAll(e){if(this._items.length>1){const t=this._items.indexOf(e);if(t>=0)return this._items=[this._items[t]],this._changed(),!0}return!1}replace(e){return e=e||[],!Utils.equalArrays(e,this._items)&&(this._items=e.slice(0),this._changed(),!0)}resize(e,t){e.resizeTo(t)&&(this.removeAll(e),this._changed())}resizeBy(e,t,i){e.resizeBy(t,i)&&(this.removeAll(e),this._changed())}getLinkedTableColumns(e){if(this._items.indexOf(e)>=0){const t=this._items.filter((e=>e instanceof TableColumnBase));return getLinkedSlice(t,e)}return[]}isSingleTableColumns(){const e=this._items[0];if(e instanceof TableColumnBase){return this.getLinkedTableColumns(e).length===this._items.length}}getLinkedTableRows(e){if(this._items.indexOf(e)>=0){const t=this._items.filter((e=>e instanceof TableRow));return getLinkedSlice(t,e)}return[]}isSingleTableRows(){const e=this._items[0];if(e instanceof TableRow){return this.getLinkedTableRows(e).length===this._items.length}}_changed(){this.fireEvent(Selections$3.CHANGED)}}Selections$3.CHANGED="onSelectionsChanged";class ReportEditView extends ReportView{constructor(e){super(e,!0),this._focusRequested=!1,this.addChild(this._pageHead=new SectionHeadView(e,null,"PAGE","Report Page",ReportView.PAGE_HEAD)),this.addChild(this._backHead=new SectionHeadView(e,null,"BACK ITEMS","Page Back Items",ReportView.BACK_HEAD)),this.addChild(this._frontHead=new SectionHeadView(e,null,"FRONT ITEMS","Page Front Items",ReportView.FRONT_HEAD)),this.addChild(this._editLayer=new ReportEditLayer(this.doc,this)),this._selections=new Selections$3,this._selections.addListener(this)}onSelectionsChanged(e){this.invalidateLayout(),this._fireSelectionChanged(e.pageItems)}get editor(){return this.container}get activeContainer(){return this._activeConatiner}get activeContainerView(){return this._activeConatiner===this.model.page.backContainer?this.pageView.backFloatingView:this._activeConatiner===this.model.page.frontContainer?this.pageView.frontFloatingView:void 0}get focusedItem(){return this._focusedItem}set focusedItem(e){if(e!==this._focusedItem){const t=this._focusedItem;this._focusedItem=e,this._focusRequested=!0,this.invalidateLayout(),e&&this._selections.add(e),this.container.$_focusedChanged(e,t),this._fireFocusedChanged(e,t)}else e&&!this._selections.contains(e)&&this._selections.add(e)}get focusedElement(){return this._focusedItem instanceof ReportItem&&this.getElementOf(this._focusedItem)}get focusedItemElement(){const e=this.focusedElement;return e instanceof ReportItemElement?e:null}get focusedRequested(){return this._focusRequested}get selection(){return this._selections.items}get lastSelectedItem(){return this._selections.last}get zoom(){return this.editor.zoom}get editing(){return this.editor.isEditing()}get editLayer(){return this._editLayer}getFocusedElement(){const e=this.focusedItem;if(this.model){if(e===this.model.root)return this;if(e===this.model.page)return this.pageView}if(e instanceof ReportPageItem)return this.getElementOf(e)}itemOfDom(e){const t=this.pageView;return t.isDom(e)?t.model:t.itemOfDom(e)}focusCell(e){if(e&&e.parent instanceof TableCellItem){const t=e.parent.parent.getCell(e.row,e.col);this.focusedItem=t}}getTableElementOfRow(e){return this.getElementOf(e.collection.table)}getTableElementsOfColumn(e){const t=e.collection;return t instanceof TableColumnCollection?[this.getElementOf(t.table)]:t instanceof TableBandColumnCollection?this.getElementOf(t.band).getTableViews():void 0}getTableElementOfColumn(e){return this.getElementOf(e.collection.table)}getTableBandElementOfColumn(e){return this.getElementOf(e.collection.band)}getSelectedTableColums(e){return this._selections.getLinkedTableColumns(e)}canMoveTableColumns(e,t=!0){return!0}getSelectedTableRows(e){return this._selections.getLinkedTableRows(e)}canMoveTableRows(e,t=!0){return!0}focusParent(e){e instanceof ReportItemCollectionItem&&(this.focusedItem=e.collection)}_initDom(e,t){super._initDom(e,t),t.style.transformOrigin="0 0 0",this._pageBorders=[];for(let i=0;i<4;i++){const r=e.createElement("span");this._pageBorders.push(r),r.className=i<2?"rr-page-border-horz":"rr-page-border-vert",t.appendChild(r)}}_afterLayout(e){function t(e){r===e.model?e.dom.dataset.selected="":delete e.dom.dataset.selected}super._afterLayout(e);const i=this.model.page,r=this._activeConatiner=function(e){for(;e;){if(e instanceof PageItemContainer)return e;e=e.parent}}(this.focusedItem)||i,s=this.pageView,n="0.2",o=ReportEditView.ACTIVE_ZINDEX,a=s.bounds;let A=a.x+1,l=this._pageHead;l.model=i,l.text="PAGE - "+Math.round(s.width)+" x "+Math.round(s.height)+" px",t(l),l.measure(e,a.width,a.height),l.setBounds(A,a.y-l.measuredHeight,l.measuredWidth,l.measuredHeight),A+=l.width+4,l=this._backHead,l.model=i.backContainer,t(l),l.measure(e,a.width,a.height),l.setBounds(A,a.y-l.measuredHeight,l.measuredWidth,l.measuredHeight),A+=l.width+4,l=this._frontHead,l.model=i.frontContainer,t(l),l.measure(e,a.width,a.height),l.setBounds(A,a.y-l.measuredHeight,l.measuredWidth,l.measuredHeight),s.sections.forEach((e=>e.dom.style.opacity="")),s.backFloatingView.dom.style.opacity="",s.frontFloatingView.dom.style.opacity="",s.sections.forEach((e=>e.dom.style.pointerEvents="none")),s.backFloatingView.dom.style.pointerEvents="none",s.frontFloatingView.dom.style.pointerEvents="none",s.sections.forEach((e=>e.dom.style.zIndex="")),s.backFloatingView.dom.style.zIndex="",s.frontFloatingView.dom.style.zIndex="",s.bodyView.findable=!1,s.backFloatingView.findable=!1,s.frontFloatingView.findable=!1,r===i.backContainer?(s.backFloatingView.findable=!0,s.backFloatingView.dom.style.zIndex=o,s.backFloatingView.dom.style.pointerEvents="",s.frontFloatingView.dom.style.opacity=n,s.sections.forEach((e=>e.dom.style.opacity=n))):r===i.frontContainer?(s.frontFloatingView.findable=!0,s.frontFloatingView.dom.style.zIndex=o,s.frontFloatingView.dom.style.pointerEvents="",s.backFloatingView.dom.style.opacity=n,s.sections.forEach((e=>e.dom.style.opacity=n))):(s.bodyView.findable=!0,s.sections.forEach((e=>{e.dom.style.zIndex=o,e.dom.style.pointerEvents=""})),s.backFloatingView.dom.style.opacity=n,s.frontFloatingView.dom.style.opacity=n)}onReportItemAdded(e,t,i,r){super.onReportItemAdded(e,t,i,r),r||this.editor.addMode&&0!=this.editor.addedCount||(this._selections.clear(),this.focusedItem=t instanceof CellGroup?t.item:t)}onReportItemRemoved(e,t,i){super.onReportItemRemoved(e,t,i),t instanceof CellGroup&&(t=t.item);const r=this.container,s=this.focusedItem;let n=t===s;!n&&t instanceof ReportGroupItem&&(n=t.isAncestorOf(s)),n?(this.focusedItem=null,r.clearSelection()):r.isSelected(t)&&r.removeSelection(t),n?this.focusedItem=i:s instanceof ReportItemCollection&&t instanceof ReportItemCollectionItem&&(this.focusedItem=null,this.focusedItem=s)}onReportItemsRemoved(e,t){super.onReportItemsRemoved(e,t);let i=!1;if(!(this.focusedItem instanceof TableCell&&t[0]instanceof TableCell))for(let e of t)if(i=e===this.focusedItem||e instanceof CellGroup&&e.item===this.focusedItem)break;i&&(this.focusedItem=null,this.container.clearSelection())}onReportCommandStackChanged(e,t){const i=null==t?void 0:t.source;this.editor.addMode&&0!=this.editor.addedCount||i instanceof ReportPageItem&&i.parent&&this.editor.setFocused(i)}onReportCellMerged(e,t){this._selections.clear(),this.focusedItem=t}onReportAlert(e,t,i){this._editLayer.showError(t,i)}$_layoutMask(){const e=this._editLayer;(e.visible=this.pageView.visible)&&(e.setRect(this.pageView.bounds),e.layoutContent())}_layoutPageBorders(e,t){let i=this._pageBorders[0].style;i.top=t.y+"px",i.width=e.width+"px",i=this._pageBorders[1].style,i.top=Math.floor(t.bottom)+"px",i.width=e.width+"px",i=this._pageBorders[2].style,i.left=t.x+"px",i.height=e.height+"px",i=this._pageBorders[3].style,i.left=Math.floor(t.right)+"px",i.height=e.height+"px"}_fireFocusedChanged(e,t){this.fireEvent(ReportEditView.FOCUSED_CHANGED,e,t)}_fireSelectionChanged(e){this.fireEvent(ReportEditView.SELECTION_CHANGED,e)}}ReportEditView.ACTIVE_ZINDEX="2",ReportEditView.FOCUSED_CHANGED="onReportFocusedChanged",ReportEditView.SELECTION_CHANGED="onReportSelectionChanged";class PopupLayer extends LayerElement{get popup(){return this._popup}setPopup(e,t=NaN,i=NaN){if(e!==this._popup&&(this._popup&&this.removeChild(this._popup),this._popup=e,e)){this.addChild(e),e.measure(null,this.width,this.height),e.applyMeasure();const r=this.container.width,s=this.container.height;isNaN(t)&&(t=(r-e.width)/2),isNaN(i)&&(i=(s-e.height)/2),e.move(t,i,!0)}}_initDom(e,t){}_getCssSelector(){return"rr-editor-popup-layer"}}const zoom_ranges=[50,67,75,80,90,100,110,125,150,175,200,250,300,400,500];class ReportEditor extends ReportContainer{constructor(e){super(e),this._defaultUnit=PrintUnit.PIXEL,this._guardWidth=100,this._paddingTop=35,this._paddingLeft=45,this._zoom=100,this._handMode=!1,this._addStyle=ReportAddStyle.CLICK,this._started=!1,this._addShifted=!1,this._addedCount=0}_doDispose(){super._doDispose()}getEditProps(){return ReportEditor.PROPINFOS}getStyleProps(){}getSubStyleProps(e){}isDominantProp(e){return!1}getPlaceHolder(e){}getPropDomain(e){}getProperty(e){return this[e]}setProperty(e,t){this[e]=t}setItemsProperty(e,t,i){}getStyleProperty(e){}setStyleProperty(e,t){}setItemsStyleProperty(e,t,i){}isChildProp(e){return!1}getSubStyleProperty(e,t){}setSubStyleProperty(e,t,i){}setItemsSubStyleProperty(e,t,i,r){}isReadOnlyProperty(e){return!1}canPropAdoptDragSource(e,t){return!1}adoptPropDragSource(e,t){}isCollectionProp(){return!1}isEditableCollection(){return!1}isCollectionItem(){return!1}getPropertySources(){}getCollectionLabel(){}getPopupPropLabel(e){}get displayPath(){return"editor"}get reportView(){return this._reportView}get report(){return this._reportView.model}set report(e){this._reportView.model=e}get defaultUnit(){return this._defaultUnit}set defaultUnit(e){e!==this._defaultUnit&&(this._defaultUnit=e,this.fireEvent(ReportEditor.UNIT_CHANGED,e))}get guardWidth(){return this._guardWidth}set guardWidth(e){(e=Math.max(100,e))!=this._guardWidth&&(this._guardWidth=e,this.invalidateLayout())}get topPos(){return this._scrollContainer.scrollTop}set topPos(e){const t=Math.max(1,this._zoom/100);(e=Math.max(0,Math.min(this._editContainer.height*t-this._scrollContainer.height,e)))!=this.topPos&&(this._scrollContainer.scrollDom(this.leftPos,e),this.invalidateLayout())}get leftPos(){return this._scrollContainer.scrollLeft}set leftPos(e){const t=Math.max(1,this._zoom/100);(e=Math.max(0,Math.min(this._editContainer.width*t-this._scrollContainer.width,e)))!=this.leftPos&&(this._scrollContainer.scrollDom(e,this.topPos),this.invalidateLayout())}get zoom(){return this._zoom}set zoom(e){if((e=Utils.pickNum(e,0))===ReportEditor.ZOOM_PAGE_WIDTH)e=Math.floor(100*this.$_containerWidth()/this.reportView.dom.offsetWidth);else if(e===ReportEditor.ZOOM_FULL_PAGE){const t=100*this.$_containerWidth()/this.reportView.dom.offsetWidth,i=100*this.$_containerHeight()/this.reportView.dom.offsetHeight;e=Math.floor(Math.min(t,i))}else e=Math.floor(Math.max(50,Math.min(500,e)));if(e!=this._zoom){const t=this._zoom;this._zoom=e,this._reportView._dom.style.transform="scale("+e/100+")",this.invalidateLayout(),this._feedbackLayer.clearAction(ReportEditor.ZOOM_LABEL),this._feedbackLayer.showSpan(ReportEditor.ZOOM_LABEL,e+"%",10,10),this.fireEvent(ReportEditor.ZOOM_CHANGED,e,t)}}get addStyle(){return this._addStyle}set addStyle(e){this._addStyle=e}get handMode(){return this._handMode}set handMode(e){e!=this._handMode&&(this._handMode=e,this._addShifted=!1,this.endAdd())}get selectMode(){return!this._handMode&&!this.addMode}set selectMode(e){e&&(this.handMode=!1,this._addShifted=!1,this.endAdd())}get addMode(){return!!this._addType}get addType(){return this._addType}get addShifted(){return this._addShifted}get addedCount(){return this._addedCount}get focusedItem(){return this._reportView.focusedItem}set focusedItem(e){this._reportView.focusedItem=e}get focusedElement(){return this._reportView.focusedElement}get focusedItemElement(){return this._reportView.focusedItemElement}get marquee(){return this._reportView.editLayer.editMarquee}get selections(){return this._reportView._selections}get tableDesigner(){return this._tableDesigner||(this._tableDesigner=new TableDesigner(this.doc)),this._tableDesigner}get tableBandDesigner(){return this._tableBandDesigner||(this._tableBandDesigner=new TableBandDesigner(this.doc)),this._tableBandDesigner}get simpleBandDesigner(){return this._simpleBandDesigner||(this._simpleBandDesigner=new SimpleBandDesigner(this.doc)),this._simpleBandDesigner}showAlert(e,t){t&&this._reportView.editLayer.showError(e,t)}incZoom(e=0){if(0!==e){const t=this.zoom;let i=-1;if(t>=zoom_ranges[0]){i=0;for(let e=0;e<zoom_ranges.length-1&&!(t>=zoom_ranges[e]&&t<zoom_ranges[e+1]);e++,i++);}e>0?i<zoom_ranges.length-1&&(this.zoom=zoom_ranges[i+1]):e<0&&i>0&&(this.zoom=zoom_ranges[i-1])}else this.zoom=100}isEditor(e){return this._textEditor.is(e)}isEditing(){return this._textEditor.isEditing}showEditor(e){if(!this.isEditing()&&(e=e||(this.focusedElement instanceof ReportItemElement?this.focusedElement:null)))return this._textEditor.show(e,this._zoom/100)}hideEditor(e){if(this.isEditing())return this._textEditor.hide(e),this.setFocus(),!0}canMultiLine(){return this._textEditor.canMultiLine()}setFocused(e,t=!0){e!==this.focusedItem&&(t&&this.clearSelection(e instanceof ReportItem?e:null),this.focusedItem=e)}undo(){return this.report.undo()}redo(){return this.report.redo()}copy(){return this.fireConfirmEvent(ReportEditor.COPY)}paste(){return this.fireConfirmEvent(ReportEditor.PASTE)}cut(){return this.fireConfirmEvent(ReportEditor.CUT)}findDropTarget(e,t,i){const r=this._reportView.findElementOf(t);if(r instanceof ReportItemElement){const t=r.model;if(t&&t.canAdoptDragSource(e))return t}else if(r){const e=TableElement.getTable(r);if(e){return e.getCellOf(t,!1)}}}beginAdd(e,t){if(!this.addMode&&e)return this._addType=e,this._addShifted=t,!0}$_startDesigner(e){return this._addType===TableContainer?(this.tableDesigner.run(this,(t=>{null==e||e(t)})),!0):this._addType===TableBand&&(this.tableBandDesigner.run(this,(t=>{null==e||e(t)})),!0)}endAdd(e=!1,t=null,i){if(this.addMode){const r=t.model;let s;if(e&&t){if(this.$_startDesigner((e=>{if(e.canAddTo(r))try{this.report.defaultInit(e,r,t.offsetWidth,t.offsetHeight),this.report.addItem(r,e)&&(this._addedCount++,null==i||i(e),this.focusedItem=e)}catch(e){alert(e)}})))return void this.cancelAdd();if(s=new this._addType(""),s.canAddTo(r))try{this.report.defaultInit(s,r,t.offsetWidth,t.offsetHeight),this.report.addItem(r,s)?this._addedCount++:s=null}catch(e){alert(e),s=null}else alert("Can not add to this group."),s=null}return this._addShifted||this.cancelAdd(),null==i||i(s),s}}endAddCell(e,t,i,r){if(this.addMode){const s=e.model;if(s.getCellItemAt(t,i))return alert("Only one item can exists int a cell."),null;if(this.$_startDesigner((e=>{if(e.canAddTo(s))try{e.setChildProp("row",t),e.setChildProp("col",i),this.report.defaultInit(e,s,void 0,void 0),this.report.addItem(s,e)&&(this._addedCount++,null==r||r(e))}catch(e){alert(e)}})))return void this.cancelAdd();let n=new this._addType("");if(n.canAddTo(s))try{n.setChildProp("row",t),n.setChildProp("col",i),this.report.defaultInit(n,s,void 0,void 0),this.report.addItem(s,n)?this._addedCount++:n=null}catch(e){alert(e),n=null}else alert("Can not insert in a cell."),n=null;return this._addShifted||this.cancelAdd(),null==r||r(n),n}}cancelAdd(){if(this.addMode)return this._addedCount=0,this._addType=void 0,this._addShifted=!1,this.invalidateLayout(),this.fireEvent(ReportEditor.ADD_CANCELED),!0}getDisplayParent(e){if(e instanceof ReportPageItem){let t=e.displayParent;if(t instanceof CellGroup){if(t=t.displayParent,t instanceof TableBase&&e instanceof ReportItem)return t.getCell(e.row,e.col)}else t instanceof ReportItemCollection&&(t=t.displayParent);for(;t&&!(t instanceof ReportGroupItem)&&!(t instanceof ReportItemCollection);)t=t.displayParent;return t}}findTable(e){if(e){const t=e.parentElement.parentElement.parentElement.parentElement,i=this.findElementOf(t);if(i instanceof TableElement)return i}}getEditMarquee(){return this._reportView.editLayer.editMarquee}getEditMarqueeTarget(e){var t;if(e){const i=null===(t=this._reportView.editLayer.editMarquee)||void 0===t?void 0:t.targetItem;return TableBandMarquee.getTarget(i,e)||BandGroupMarquee.getTarget(i,e)||TableContainerMarquee.getTarget(i,e)||ColumnBoxMarquee.getTarget(i,e)||RowBoxMarquee.getTarget(i,e)||HichartMarquee.getTarget(i,e)}}closeEditMarquee(){this._reportView.editLayer.closeEditMarquees()}get selectionCount(){return this.selections.count}isSelected(e){return this.selections.contains(e)}getSelection(){return this.selections.items}getSelectedItems(){return this.selections.pageItems}clearSelection(e){this.selections.clear(),e&&this.addSelection(e)}addSelection(e){const t=this.selections.first;(!t||t.canSelectedWith(e)&&e.canSelectedWith(t))&&this.selections.add(e)}addSelections(e){const t=this.selections.first;e.forEach((e=>{(!t||t.canSelectedWith(e)&&e.canSelectedWith(t))&&this.selections.add(e)}))}removeSelection(e){e&&this.selections.remove(e)}toggleSelection(e,t){if(e&&e!==this.focusedItem){const i=this.selections;if(e instanceof TableCell){if(!t)return i.clear(),this.addSelection(e),!0;if(i.isEmpty)this.addSelection(e);else{if(!(i.first instanceof TableSelection&&i.first.table===e.table))return i.clear(),this.addSelection(e),!0;i.resize(i.first,e)}}else if(i.contains(e))this.removeSelection(e);else{if(i.first instanceof TableSelection)return i.clear(),this.addSelection(e),!0;this.addSelection(e)}}}selectAll(e,t=!0){const i=this.selections,r=(e||this.reportView.pageView.model).getDescendants();r.length>0&&(r.forEach((e=>{this.addSelection(e)})),i.remove(e),this.focusedItem=r[0])}deleteSelection(){let e=this.selections.pageItems;if(e&&(e=e.filter((e=>!(e instanceof TableCell)))),e&&e.length>0)return this._reportView.model.removeItems(e),!0}copySelection(){var e;const t=null===(e=this.getSelectedItems())||void 0===e?void 0:e.filter((e=>e.selectItem instanceof ReportItem)).map((e=>e.selectItem));if(t)return this.report.saveItems(t)}findSelection(e){return this.selections.find(e)}findReportElementOf(e){return e&&this._reportView.findElementOf(e)}pasteItems(e,t){return this.report.pasteItems(e,t)}isScrollContainer(e){return e.className===ReportEditor.SCROLL_CONTAINER_CLASS}isRuler(e){return this._vruler.containsDom(e)||this._hruler.containsDom(e)}focusCell(e){!e&&this.focusedItem instanceof ReportItem&&(e=this.focusedItem),this._reportView.focusCell(e)}showPopup(e){e&&(e.dom.style.zIndex=String(ReportEditor.POPUP_ZINDEX),this._popupLayer.setPopup(e))}hidePopup(e){e&&this._popupLayer.popup===e&&this._popupLayer.setPopup(null)}_createDefaultTool(){return new ReportSelectionTool(this)}_doPrepareContainer(e){super._doPrepareContainer(e);const t=this.doc;this.addElement(this._scrollContainer=new LayerElement(t)),this._scrollContainer.dom.className=ReportEditor.SCROLL_CONTAINER_CLASS,this._scrollContainer.setStyles({overflow:"auto"}),this._scrollContainer.dom.addEventListener("scroll",(e=>this.invalidateLayout(!0))),this._scrollContainer.addChild(this._editContainer=new LayerElement(t)),this._editContainer.dom.className=ReportEditor.EDIT_CONTAINER_CLASS,this._editContainer.addChild(this._reportView=this._createEditView(t)),this._scrollContainer.addChild(this._textEditor=new TextEditor(t,this)),this.addElement(this._vruler=new VerticalRulerView(t,this)),this.addElement(this._hruler=new HorizontalRulerView(t,this)),this.addElement(this._guard=new SectionGuard(t,this)),this.addElement(this._feedbackLayer=new FeedbackLayer(t)),this.$_prepareFeedback(t,this._feedbackLayer),this.addElement(this._popupLayer=new PopupLayer(t))}_doLayout(e){if(this._hruler.zoom=this._vruler.zoom=this.zoom,this.scrolling)return this._hruler.startPos=this._vruler.width+this._paddingLeft-this.leftPos,this._hruler.refreshView(),this._vruler.startPos=this._hruler.height+this._paddingTop-this.topPos,this._vruler.refreshView(),void this._guard.layoutContent(this._context);const t=this._reportView.model,i=t?t.paper.getPageSize():new Size(500,500);let r=e.clone();this._context.assets=t&&t.assets,this._feedbackLayer.setRect(r),(this._guard.visible=this._guardWidth>0)&&(this._guard.setBounds(r.x,r.y,this._guardWidth,i.height),r.leftBy(this._guardWidth)),this._hruler.setBounds(r.x,r.y,r.width,this._hruler.height),this._vruler.setBounds(r.x,r.y,this._vruler.width,r.height),this._hruler.startPos=this._vruler.width+this._paddingLeft-this.leftPos,this._hruler.refreshView(),this._vruler.startPos=this._hruler.height+this._paddingTop-this.topPos,this._vruler.refreshView(),r.leftBy(this._vruler.width),r.topBy(this._hruler.height),this._scrollContainer.setRect(r),r.set(this._paddingLeft,this._paddingTop,i.width,i.height),this._reportView.setRect(r);const s=this._reportView.$_layout(this._context,r.move());r.set(0,0,2*this._paddingLeft+s.width,2*this._paddingTop+s.height),this._editContainer.setRect(r),this._guard.measure(this._context,e.width,e.height),this._guard.layoutContent(this._context),this._reportView.focusedRequested&&(this._reportView._focusRequested=!1,this.$_makeFocusVisible(this._reportView)),this._started||(this._started=!0,this._isTesting?this.updateNow():setTimeout((()=>{this.updateNow()})))}_doAfterRender(){this._reportView.$_afterRender(this._context),this._reportView.$_layoutMask()}findElementAt(e,t,i,r){return e>=this._guardWidth?super.findElementAt(e+this.leftPos,t+this.topPos,i,r):super.findElementAt(e,t,i,r)}_createEditView(e){return new ReportEditView(e)}$_prepareFeedback(e,t){t.addSpan(e,ReportEditor.ZOOM_LABEL,"rr-edit-feedback-span")}$_makeFocusVisible(e){const t=e.getFocusedElement();if(!t||t===e||t===e.pageView||t===e.pageView.bodyView||t===e.pageView.bodyView.itemsView)return;const i=this.getDomPosition(t),r=this._hruler.visible?this._hruler.height:0,s=(this._vruler.visible?this._vruler.width:0)+this._guardWidth;let n,o=this.leftPos,a=this.topPos;if(i.y-r<0&&(a+=n=i.y-r-10,i.y-=n),i.y+i.height>this.height-20){const e=a,t=i.y;a-=n=this.height-20-(i.y+i.height),i.y+=n,(i.y-r<0||i.y+i.height>this.height-20)&&(i.y=t,a=e)}if(this.topPos=a,i.x-s<0&&(o+=n=i.x-s-10,i.x-=n),i.x+i.width>this.width-20&&!(t instanceof CrosstabFieldsView)){const e=o,t=i.x;o-=n=this.width-20-(i.x+i.width),i.x+=n,(i.x-s<0||i.x+i.width>this.width-20)&&(i.x=t,o=e)}this.leftPos=o}$_focusedChanged(e,t){const i=this._reportView.focusedElement;if(this._hruler.setFocusedElement(i),this._vruler.setFocusedElement(i),e instanceof HichartSeries)e.chart.selectSeries(e);else if(t instanceof HichartSeries||t instanceof HichartItem){(t instanceof HichartItem?t:t.chart).selectSeries(null)}}$_containerWidth(){return this._scrollContainer.offsetWidth-20-this.reportView.dom.offsetLeft}$_containerHeight(){return this._scrollContainer.offsetHeight-20-this.reportView.dom.offsetTop}}ReportEditor.ZOOM_PAGE_WIDTH=-1,ReportEditor.ZOOM_FULL_PAGE=-2,ReportEditor.POPUP_ZINDEX=VisualContainer.FEEDBACK_ZINDEX+1,ReportEditor.PROP_DEFAULT_UNIT="defaultUnit",ReportEditor.PROP_GUARD_WIDTH="guardWidth",ReportEditor.PROPINFOS=[{name:ReportEditor.PROP_DEFAULT_UNIT,category:PropCategory.EDITOR,type:EnumProperty,domain:PrintUnit,multiple:!1,default:void 0}],ReportEditor.ZOOM_LABEL="zoomLabel",ReportEditor.ZOOM_CHANGED="onReportEditorZoomChanged",ReportEditor.COPY="onReportEditorCopy",ReportEditor.PASTE="onReportEditorPaste",ReportEditor.CUT="onReportEditorCut",ReportEditor.ADD_CANCELED="onReportEditorAddCanceled",ReportEditor.UNIT_CHANGED="onReportEditorUnitChanged",ReportEditor.SCROLL_CONTAINER_CLASS="rr-scroll-container",ReportEditor.EDIT_CONTAINER_CLASS="rr-edit-container",ReportEditor.RULER_CLASS="rr-ruler";const pxpt=72/Dimension.HTMLDPI;class PdfModel extends Base{constructor(e,t,i){super(),this._report=e,this.elementCreator=i,this._imageLoader=new ImageLoader,this._pages=this.$_build(t)}_doDispose(){super._doDispose()}get report(){return this._report}getModel(e){return this._report.models[e.dataset._m_]}getParent(e){for(;e;){if(e instanceof HTMLElement){if(this._report.models[e.dataset._m_])return e}e=e.parentElement}}addImage(e,t){this._imageLoader.add(e,t)}getImage(e){return this._imageLoader.get(e)}prepare(e){return this._imageLoader.load(e)}canExport(){return this._imageLoader.loaded}write(e,t,i){this._doc=e,this._font=t,this._fontBold=i;for(let t=0;t<this._pages.length;t++){const i=this._pages[t];this._offsetX=i.offsetX,this._offsetY=i.offsetY,i.write(this),t<this._pages.length-1&&e.addPage()}}getBounds(e){const t=e.getBoundingClientRect();return t.x-=this._offsetX,t.y-=this._offsetY,t.x*=pxpt,t.y*=pxpt,t.width*=pxpt,t.height*=pxpt,t}getTextBounds(e){const t=Utils.getTextRect(e);return t.x-=this._offsetX,t.y-=this._offsetY,t.x*=pxpt,t.y*=pxpt,t.width*=pxpt,t.height*=pxpt,t}getBox(e){const t=e.getBBox();return t.x*=pxpt,t.y*=pxpt,t.width*=pxpt,t.height*=pxpt,t}text(e,t,i,r,s){e=this.$_css(e);const n=this._doc,o=e.textDecoration,a=this.$_color(e.color),A=e.fontSize;let l=parseFloat(A);if(s={lineBreak:!1,lineGap:l<13?-1:-2,...s},"italic"===e.fontStyle&&(s.oblique=!0),isNaN(l)?l=PdfModel.FONT_SIZE:A.endsWith("px")&&(Utils.isMac?l=Math.floor(l*pxpt)-(l<13?1:0):l*=pxpt),n.save(),n.fontSize(l),parseFloat(e.fontWeight)>=700?n.font(this._fontBold):n.font(this._font),a&&n.fillColor(a.color,a.opacity),0!=r&&n.rotate(r,{origin:[t.x+t.width/2,t.y+t.height/2]}),t.y-=.15*l,n.text(i,t.x,t.y,s),o&&o.startsWith("underline")){const e=n.widthOfString(i),r=n.currentLineHeight()-1;n.underline(t.x,t.y,e,r,{color:"black"})}return n.restore(),this}save(){return this._doc.save(),this}restore(){return this._doc.restore(),this}transformSvg(e){return this._doc.transform(e.a,e.b,e.c,e.d,e.e*pxpt,e.f*pxpt),this}translate(e,t){return this._doc.translate(e,t),this}scale(e,t){return this._doc.scale(e,t),this}clip(e){const t=this.getBounds(e);return this._doc.rect(t.x,t.y,t.width,t.height).clip(),this}clipRect(e){return this._doc.rect(e.x,e.y,e.width,e.height).clip(),this}path(e,t){return this.$_render(e,((e,i)=>{const r=this.$_color(i.fill),s=this.$_color(i.stroke),n=parseFloat(i.strokeWidth);(r||s&&n>0)&&(s&&n>0&&e.path(t).lineWidth(n).strokeColor(s.color,s.opacity).stroke(),r&&e.path(t).fillColor(r.color,r.opacity).fill())})),this}dline(e,t,i,r,s){return this.$_render(e,((e,n)=>{this.$_border(n,"top")&&e.moveTo(t,i).lineTo(r,s).stroke()})),this}rect(e,t,i=!1){return this.$_render(e,((e,r)=>{const s=this.$_color(i?r.fill:r.backgroundColor);s&&(e.fillColor(s.color,s.opacity),e.rect(t.x,t.y,t.width,t.height).fill())})),this}polygon(e,t){return this.$_render(e,((e,i)=>{const r=parseFloat(i.strokeWidth),s=this.$_color(i.fill);if(s&&(e.fillColor(s.color,s.opacity),e.polygon(...t).fill()),r>0){const s=this.$_color(i.stroke);s&&(e.strokeColor(s.color,s.opacity).lineWidth(r*pxpt),e.polygon(...t).stroke())}})),this}ellipse(e,t){return this.$_render(e,((e,i)=>{const r=this.$_color(i.fill),s=t.width/2,n=t.height/2;r&&(e.fillColor(r.color,r.opacity),e.ellipse(t.x+s,t.y+n,s,n).fill());const o=parseFloat(i.strokeWidth);if(o>0){const r=this.$_color(i.stroke);r&&(e.strokeColor(r.color,r.opacity).lineWidth(o*pxpt),e.ellipse(t.x+s,t.y+n,s,n).stroke())}})),this}border(e,t){return this.$_render(e,((e,i)=>{this.$_border(i,"top")&&e.moveTo(t.x,t.y).lineTo(t.x+t.width,t.y).stroke(),this.$_border(i,"bottom")&&e.moveTo(t.x,t.y+t.height).lineTo(t.x+t.width,t.y+t.height).stroke(),this.$_border(i,"left")&&e.moveTo(t.x,t.y).lineTo(t.x,t.y+t.height).stroke(),this.$_border(i,"right")&&e.moveTo(t.x+t.width,t.y).lineTo(t.x+t.width,t.y+t.height).stroke()})),this}image(e,t,i){return this.$_render(e,((e,r)=>{e.image(t,i.x,i.y,i),this.border(r,i)})),this}$_build(e){const t=[];for(let i of e){const e=new PdfPage(this,i);t.push(e)}return t}$_render(e,t){e=this.$_css(e),this._doc.save(),t(this._doc,e),this._doc.restore()}$_css(e){return e instanceof Element&&(e=getComputedStyle(e)),e}$_color(e){let t=e,i=1;if(e.startsWith("#"));else{if(!e.startsWith("rgb"))return null;{const r=e.substring(e.startsWith("rgb(")?4:5,e.length-1).split(/\s*\,\s*/g);t="#";for(let e=0;e<3;e++)t+=Utils.pad16(parseInt(r[e]),2);r.length>3&&(i=parseFloat(r[3]))}}return i>0?{color:t,opacity:i}:null}$_border(e,t){const i="border"+Utils.capitalize(t),r=parseFloat(e[i+"Width"]);if(r>0){const t=this.$_color(e[i+"Color"]);if(t){const s=e[i+"Style"],n="dotted"===s?1:"dashed"===s?2:0;return this._doc.strokeColor(t.color,t.opacity).lineWidth(r*pxpt),n>0&&this._doc.dash(n),!0}}}}PdfModel.FONT_SIZE=10;class PdfObject{}class PdfPage extends PdfObject{constructor(e,t){super();const i=t.page.getBoundingClientRect();this.offsetX=i.x,this.offsetY=i.y,this._page=t,this._elements=this.$_build(e)}write(e){for(let t of this._elements)t.write(e)}$_build(e){const t=this._page,i=[];i.push(new PdfElement(e,t.background)),i.push(new PdfElement(e,t.pageHeader));for(let r of t.contents){const t=r instanceof HTMLElement&&e.getModel(r),s=e.elementCreator(e,t,r);s&&i.push(s)}return i.push(new PdfElement(e,t.pageFooter)),i.push(new PdfElement(e,t.foreground)),i}}class PdfElement extends PdfObject{constructor(e,t){super(),this._dom=t,this._elements=t instanceof HTMLElement?this._build(e,t):void 0}write(e){if(this._doBeginWrite(e,this._dom),this._doWrite(e,this._dom),this._elements)for(let t of this._elements)t.write(e);this._doEndWrite(e,this._dom)}_doBeginWrite(e,t){}_doEndWrite(e,t){}_doWrite(e,t){if(t instanceof HTMLElement){const i=e.getModel(t),r=e.getBounds(t),s=getComputedStyle(t);if(t instanceof HTMLSpanElement){let n=t.textContent;n&&(i instanceof TextItem&&i.wrap?e.text(s,r,n,0,{width:r.width+2,align:s.textAlign}):"right"===s.textAlign?e.text(s,r,n,0,{width:r.width,align:"right"}):e.text(s,r,n,0))}else if(t instanceof HTMLElement&&"B"===t.tagName){let i=t.textContent;i&&e.text(s,r,i,0)}else(i instanceof ReportGroupItem||i instanceof TextItem||i instanceof BarItem)&&e.rect(s,r).border(s,r)}}_build(e,t){const i=[],r=t.children;for(let t=0;t<r.length;t++){const s=r[t],n=(s instanceof HTMLElement||s instanceof SVGSVGElement)&&e.getModel(s),o=e.elementCreator(e,n,s);o&&i.push(o)}return i}}class PdfBoundedElement extends PdfElement{_needClip(){return!1}_doBeginWrite(e,t){this._needClip()&&(e.save(),e.clip(t))}_doEndWrite(e,t){this._needClip()&&e.restore()}_doWrite(e,t){const i=e.getBounds(t),r=getComputedStyle(t);e.rect(r,i),e.border(r,i)}}class PdfHtmlElement extends PdfElement{_build(e,t){const i=[],r=t.childNodes;for(let t=0;t<r.length;t++){const s=e.elementCreator(e,null,r[t]);s&&i.push(s)}return i}}class PdfTextElement extends PdfElement{_doWrite(e,t){const i=e.getTextBounds(t),r=getComputedStyle(t.parentElement);let s=t.textContent;s&&e.text(r,i,s,0)}}class PdfBarElement extends PdfElement{constructor(e,t,i){super(e,t),this._model=i}_build(e,t){}_doWrite(e,t){const i=e.getBounds(t);e.rect(t,i)}}class PdfCanvasElement extends PdfElement{constructor(e,t){super(e,t)}_build(e,t){}_doWrite(e,t){const i=t.toDataURL();if(i){const r=e.getBounds(t);e.image(t,i,r)}}}const _checked_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAP0QAAD9EBVjAapAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAACAASURBVHic7d1nmG11eb/x+7G3RFM0Go2ixt67EVRQAQFRigqCEsWKgD0kxlhjibFSLLEEe0NREEFQaQLRvwVb7ChW7Aoi0s55/i/WHnKEc6btvedZa/3uzzvxnJnvdeHlumdm72ciM5EkSW25XPUASZK09gwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIkrQGIuKKEfHX1TsWGACSJM1ZRFwdOAo4NSKuX70HIDKzeoMkSaM1+ar/aOBuk390BrBVZv6obpUBIEnS3ETEjYBjgVtc6r86ky4CzlzrTQv8EYAkSXMQEbcFTuOyD3+AzYCTIuKmazpqAwaAJEkzFhFbAJ8G/naRP3ZDugi4+dqs+lMGgCRJMxQRDwaOA661jD9+fboIuNV8V12WASBJ0oxExN7A4cBVV/DXrgucOPmRwZoxACRJmoGIeDbwVuDyq/jr1wFOiIg7znbVpvkuAEmSphARAbwGeOoMPtxvgG0y8wsz+FiLMgAkSVqliLgi8HbgETP8sL8DHpiZn53hx7wMA0CSpFWIiGsAHwK2mcOHPwfYLjNPm8PHBgwASZJWbCPX/ebhXGCHzDx5Hh/cFwFKkrQCEbEZcCrzffgDXAM4JiLuN48PbgBIkrRMEXE7uof/Wh3vuRpwVETM/McMBoAkScsQEfcGTmbx637zcFXgyIjYYZYf1ACQJGkJEfEQln/dbx6uDBw+2TETBoAkSYuIiMfRvdr/KsVTrgQcFhG7zuKDBfAfs/hAkiQB64ADM/MX1UNmISL+FXhJ9Y5LuRh4VGa+b5oPEoDvA5QkzcIFwCMz84PVQ6Y1ue53ILB/9ZZNWAc8JjPfudoPYABIkmbhHGCnzDyhesi0IuJKdNf9dq/esoT1wOMy89DV/GUDQJI0rZ/TXa07vXrItCbX/Q4Htq7eskwJPCkz37TSv2gASJKmcQawbWaeUT1kWhFxbbrrfnet3rJCCeyfma9byV/yXQCSpNU6Hdh8JA//zegO/Azt4Q/dF/OHRMTTV/KXDABJ0mqcAGyZmT+vHjKtiLg9cBpws+otU3p1RByw3D9sAEiSVuqDdD/zP6d6yLQi4j501/2uV71lRl4eEc9Zzh80ACRJK/EGYLfMvKB6yLQiYifgWOCa1Vtm7MUR8cKl/pABIElarhdk5pMzc331kGlFxOPpvpNRfd1vXp4XES9d7A/4LgBJ0lLWA/tm5hurh8zC5FvkL67esUZelZnP2th/YQBIkhZzAbBnZn6oesi0IuJydNf99qvessYOysynXvofGgCSpE05B3hIZp5YPWRak+t+7wB2q95S5A1038W55JlvAEiSNuZndK/0/1L1kGlNrvt9GHhA9ZZibwGesBABBoAk6dLOALbJzO9VD5nW5LrfMcBdqrf0xNuBvTNzvQEgSdrQF+m+8h/8r/ONiBvTvc1v6Ad+Zu09wF5XqF4hSeqN4+l+o9/vq4dMKyLuQPeV/1gO/MzSHkB6B0CSBHAY3Vf+Y3j43xc4CR/+m3Ie8B4DQJL0emD3zLywesi0ImJn4OOM77rfrPwW2DozjzYAJKltz8vMfUdy3e8JdN/JGOt1v2mdBdw3M08D8DUAktSm9cA+mfmm6iGzEBHPBV5UvaPHvkv3zo7vL/wDA0CS2nMBsEdmHl49ZFqT634HAftWb+mx04EHXvqdHQaAJLXlbLrrfidVD5nW5LrfO4GHV2/psZOAB2/sVzcbAJLUjp/RfSX45eoh04qIP6O77nf/6i09dgTdizvP39h/6YsAJakN3wXuNZKH/3WAE/Hhv5hDgV039fAHA0CSWvAFYPMNXwA2VJPrfqcCd67e0mOvyMy9M3PdYn/IAJCkcfsUsNVITvveATgN+PvqLT12QGYesJw/aABI0nh9ANh+ZNf9rlu9pafW0f2Sn1cs9y8YAJI0TocAjxjJdb9d6H6pj9f9Nu58up/3H7qSv2QASNL4PDcz9x/Jdb8n0l33u3L1lp46h+6dHUes9C/6NkBJGo91dNf93lw9ZBYi4nnAC6t39NjP6X6B0+mr+csGgCSNw/l03/L/SPWQaU2u+x0MPLl6S499n+6073dX+wEMAEkavrPprr2dXD1kWpPrfu8CHla9pce+CmybmWdN80EMAEkatrPofgb8leoh05pc9/sIcL/qLT12GvCgzPzttB/IFwFK0nB9h+663xge/gvX/Xz4b9rRwNazePiDASBJQ/V5uut+Z1YPmVZE3ITuK1uv+23au+h+idN5s/qABoAkDc8n6K77/bJ6yLQi4o50p31vWr2lxw4E9srMi2f5QQ0ASRqW99H9DPjc6iHTiogt8brfUv4tM5+WmTnrD2wASNJwHAzsMZLrfrsCHwf+vHpLT60HnpSZL5nXJzAAJGkYnpOZT5nHV4JrLSKeRPd7Crzut3EXArtl5n/N85P4NkBJ6rd1dF8JvqV6yCxExPOBF1Tv6LFzgZ0z85Pz/kQGgCT11/nA7qu58943k+t+hwD7VG/psV/R/fbGz63FJzMAJKmffkd33e/T1UOmFRFXpnsb20Ort/TYj+hO+35zrT6hASBJ/fNTuut+X60eMq2I+HO6635bVW/psW/QPfx/vJaf1ACQpH75Nt2d9zOrh0wrIv4GOAa4U/WWHvt/dN/2//Vaf2LfBSBJ/fE5xnPd76Z0B358+G/aJ4D7VTz8wQCQpL44ju5h8KvqIdOKiDvhdb+lfIDuoNMfqgYYAJJU772M57rfVnS/1Odviqf02RuAR1QfdDIAJKnWgcCemXlR9ZBpRcRD6X7m73W/Tfv3zHxyZq6vHjKGFwGeDjy5eoQkrcKFmfnF6hGzEBH70L3P3y8sNy6Bp2bmwdVDFowhAM7JzM9Uj5CkVkXEC4DnV+/osYuAR2fme6qHbGgMASBJKjC57vc64EnVW3rsPOChmXlM9ZBLMwAkSSs2ue73bmDX6i099ltgh8z8n+ohG2MASJJWZHLd7whgy+IpffZTuut+/1s9ZFMMAEnSskXEdele6X/H6i099h26h/+Z1UMW46s1JUnLssF1Px/+m/ZFYIu+P/zBAJAkLcMG1/1uUr2lx04EtsrMX1QPWQ4DQJK0qIi4H3ASXvdbzIfpfoPjOdVDlssAkCRtUkQ8jO5n/n9WvaXH3go8LDMvqB6yEgaAJGmjIuLJwPuAK1Vv6bGXZ+bjMnNd9ZCVMgAkSZcRES+kO/Ljc2LjEnhWZv5L9ZDV8m2AkqRLTK77vR54YvWWHrsYeFxmvr16yDQMAEkScMl1v/cAu1Rv6bHzgd0y88jqIdMyACRJC9f9jgTuW72lx84GHpyZJ1cPmQUDQJIaN7nu93HgDtVbeuznwLaZ+eXqIbNiAEhSwyLi74HjgBtXb+mx79Gd9j2jesgs+epOSWpURNyZ7rqfD/9N+wrdad9RPfzBAJCkJkXE/elO116neEqfnQLcNzPPqh4yDwaAJDUmIh4OHI3X/RZzFN23/X9XPWReDABJakhE7Au8F6/7LeadwM6Z+cfqIfNkAEhSIyLiRcAh+P/9i3kN8I+ZeXH1kHnzXQCSNHIRcXm6635PqN7Sc8/JzJdWj1grBoAkjVhEXIXuut/O1Vt6bD3wpMx8c/WQtWQASNJIRcQ1gSPwut9iLgD2zMwPVQ9ZawaAJI1QRFwPOAav+y3m98BOmXl89ZAKBoAkjUxE3Aw4Fg/8LOaXwPaZ+fnqIVUMAEkakYi4C917/D3ws2k/pHuP/7eqh1TyrSCSNBIR8QDgBHz4L+brwOatP/zBAJCkUYiI3YCP4XW/xXwWuHdm/rh6SB8YAJI0cBGxH91b/bzut2nHAvfPzN9UD+kLA0CSBiwi/h04GP//fDHvA3bMzD9UD+kTXwQoSQM0ue73BuDx1Vt67nXAUzJzffWQvjEAJGlgJtf93gvsVL2l516YmS+oHtFXBoAkDcjkut+RwH2qt/TYerqv+l9XPaTPDABJGojJdb+PA7ev3tJjFwF7Zeb7qof0nQEgSQMwue53HLBZ8ZQ++wOwa2YeWz1kCAwASeq5iLgr3XW/a1dv6bHfADtk5meqhwyFbxuRpB6LiK3prvv58N+0n9Ad+PHhvwIGgCT1VETsDhwFXKN6S499m+6079erhwyNASBJPRQR++N1v6V8AdgiM39QPWSIDABJ6pmIeAlwEBDVW3rseGCrzPxl9ZCh8kWAktQTk+t+bwQeV72l5w4H9sjMC6qHDJkBIEk9MLnu9z7gIdVbeu7NwD6Zua56yND5IwBJKhYR16J7j78P/8W9LDOf4MN/NvwOgCQVioi/pbvud7vqLT2WwDMz8zXVQ8bEAJCkIhFxc7rfU79Z8ZQ+uxh4bGa+o3rI2BgAklQgIu4GfAwP/Czmj8DDM/Oo6iFjZABI0hqbXPc7HA/8LOZ3wI6ZeUr1kLHyRYCStIYi4hF0X/n78N+0nwH39eE/XwaAJK2RiHgK8G7gitVbeuwMutO+X6keMnYGgCStgYh4KXAgXvdbzJfpTvt+r3pIC3wNgCTN0eS6338Bj63e0nOfpvuZ/9nVQ1phAEjSnETEVemu+z24ekvPfZTu1f7nVw9piT8CkKQ52OC6nw//xb0d2MWH/9ozACRpxibX/T4NbFG9pedeBTwmMy+uHtIiA0CSZigibgGcBty2ekvPPTszn5WZWT2kVb4GQJJmZHLd72jgr6u39Ng64EmZ+ZbqIa0zACRpBiJiG7rrflev3tJjFwCPyMwPVw+RPwKQpKlFxB7AUfjwX8zvge18+PeHASBJU4iIpwHvwut+i/klsGVmnlA9RP/HAJCkVYqIlwGvwet+i/kB3XW/L1YP0Z/yNQCStEKT635vBh5TvaXn/hfYNjN/Uj1El2UASNIKTK77vR/YsXpLz/0P8KDM/E31EG2cASBJyxQRf0F3tnbz6i0993Fg18w8r3qINs3XAEjSMkTE9YGT8eG/lPcCD/bh338GgCQtwet+y3YIsGdmXlQ9REszACRpERFxd+AU4IbVW3ru+Zm5v6d9h8PXAEjSJkTEtsCH8MDPYtYD+2fm66uHaGUMAEnaiIjYEzgUD/ws5kJgr8x8f/UQrZw/ApCkS4mIpwPvxIf/Yv4A7OjDf7j8DoAkbSAi/gP45+odPfdrYIfM/Gz1EK2eASBJQERcge6636OLp/Tdj4FtMvMb1UM0HQNAUvMm1/0+ADyoekvPfYvu4f/D6iGangEgqWmT635HAfeq3tJzn6f7db6/qh6i2fBFgJKaNbnu92l8+C/lU8BWPvzHxQCQ1KSIuCXddb/bVG/puQ8C22fmudVDNFsGgKTmRMQ98LrfcrwJ2C0zL6weotkzACQ1JSIeSPct7b+q3tJzL8nMJ2bm+uohmg8DQFIzIuKRwJF42ncxCTw9M/+teojmywCQ1ISIeAbwDrzut5iL6U77vrZ6iObPAJA0ehHxcuBVQFRv6bE/Ajtl5ruqh0wrIq5VvWEIDABJoxURV4iItwEHVG/pud8BW2fmx6qHTCsibkv3Gxy1BA8BSRqlyXW/w4Adqrf03FnAtpn51eoh04qIe9EddfpF9ZYh8DsAkkYnIv4S+CQ+/JfyXWDzkTz8twM+AfxF9ZahMAAkjUpE3ACv+y3Hl4AtMvP71UOmFRF7AEcAV6veMiQGgKTRiIhb0V33u3X1lp47GbhvZv68esi0ImI/4F347o4VMwAkjUJE3JPuK/+/q97Sc0fQ/cz/nOoh04qIFwIH47s7VsUAkDR4k5//et1vaYcCu2bm+dVDphERl4uI1wHPq94yZAaApEGLiEfRXffz57+Le2Vm7p2Z66qHTCMirgi8G3hy9ZahMwAkDVZEPBN4O76leSn/nJn/VD1iWhFxdeCjwO7VW8bAABARsWNEXKN6h7Rc0flP4JX489/FrAMem5n/WT1kWhu8tXPb6i1jYQA0LiL2pntR0DFGgIYgIq4AvA0Y/Fe0c3Y+8NDM/O/qIdOKiOvTvXPhntVbxsQAaNjk4f8Wuq+gtgA+HhF/VrtK2rSIuBpdsO5VvaXnzgG2y8yPVA+ZVkTcDDgVuE31lrExABp1qYf/gs3pvhNgBKh3NvgW8PbVW3ruF8CWmXli9ZBpRcSdgVOAG1VvGSMDoEGbePgv2By/E6Ce2eC63z9Ub+m5M+mu+51ePWRaEbElcAJwneIpo2UANGaJh/+Ce2EEqCe87rdsX6O76/+d6iHTioidgGOAP6/eMmYGQEOW+fBfcC/gWCNAlSbX/U7B635LOQ24T2b+tHrItCLiMcAHgatUbxk7A6ARK3z4L/gHugiwwrXmImJ7uut+f1m9peeOAbbOzN9WD5lWRPwT8N/A5au3tMAAaMAqH/4LjACtuYjYC3+723K8G3hIZp5XPWRaEfFyYPD3CobEABi5KR/+C+6JEaA1EhHPonufv9f9FncQ8KjMvKh6yDQi4vIR8VbggOotrTEARmxGD/8F9wSOMwI0L5Prfq8EXoHX/Zby3Mx8amZm9ZBpRMSVgcOAvau3tMgAGKkZP/wX3IMuAq45w48pLVz3ezvwzOotPbce2CczX1w9ZFqTFxgfA+xcvaVVBsAIzenhv+AedD8OMAI0E5PrfkcCj6re0nMXArtn5hurh0wrIq4NnAhsVTylaQbAyMz54b/A7wRoJibX/T4FbFe9pefOBXbIzMOqh0wrIm5E99bOO1dvaZ0BMCJr9PBfcHeMAE0hIv6O7kHgL3hZ3K+B+2XmJ6uHTCsibk131//m1VtkAIzGGj/8F9wd+IQRoJWaPAhOA25VvaXnfkR32vdz1UOmFRH3oDvnfP3qLeoYACNQ9PBfcDe6CLhWwefWAEXEP9A9CG5QvaXnvkl32veb1UOmFRHb4FGn3jEABq744b/ACNCyRMQOdL/RzwfB4j5H95X/j6qHTCsidgOOAq5evUV/ygAYsJ48/BfcFSNAi4iIfwQ+gtf9lvJJup/5/7p6yLQiYh/gPcAVq7fosgyAgerZw3+BEaCNmtx4PxSv+y3lMLpX+59bPWRaEfFc4PX4nOkt/8UMUE8f/gvuCnwyIv6ieojqTa77vYruxnsf//faJ2+ke5//hdVDpjH5d34Q8KLqLVqcATAwPX/4L7gL3XcCjICGRcQVgXcAz6jeMgAvzsx9MnN99ZBpTP6dvxPYv3qLlmYADMhAHv4L7oLfCWhWRFyd7rf5PbJ6S88l8NTMfG71kGlNLjp+BNizeouWxwAYiIE9/BfcGSOgORHxV3jdbzkuovttfgdVD5nW5HU/nwC2r96i5TMABmCgD/8FdwY+NTn5qpGLiBvSXfe7R/WWnjsPeEhmvrt6yLQi4nrAycC9qrdoZQyAnhv4w3/Bnei+E2AEjFhE3IbuzOstq7f03G+BrTPzmOoh04qIm9L9O79d9RatnAHQYyN5+C8wAkYsIu6F1/2W46fAfTLztOoh04qIO9I9/G9cvUWrYwD01Mge/gvuhD8OGJ2IeBDd8Rpf67G479Cd9v1a9ZBpRcS96X6d798UT9EUDIAeGunDf8Ed6SLgr6qHaHoR8Wjgw8BVi6f03el0p33PrB4yrYjYETgO8JeADZwB0DMjf/gvMAJGICIOwOt+y3EisGVm/qJ6yLQiYi/gcOAq1Vs0PQOgRxp5+C+4A0bAIE0uvb0aeHn1lgH4CLBdZp5TPWRaEfEM4G0YfKNhAPREYw//BXcAjo+Iv64eouXZ4NLb06u3DMB/Aw/NzPOrh0wrIl4KvIq2/v9p9AyAHoiIe9Dew3/B7em+E2AE9Nzkut+ReOltOf4zMx+bmeuqh0wjIi4XEW8Cnl29RbNnAPRAZn4WOLB6RyEjoOcmP6o5Hnhg9ZaeS+CfMvOfq4dMKyKuBHwAeHz1Fs2HAdATmfl04LXVOwrdHn8c0EsbXPe7e/WWnlsH7J2Zr6weMq2IuAZwNLBr9RbNjwHQI0YAt6OLgGtXD1Fnct3vNLzut5TzgV0y823VQ2bkKOD+1SM0XwZAzxgBRkBfRMTmdNf9rl+9pefOBrbNzCOrh8yQwdcAA6CHjABuixFQanLs5RN43W8pP6d7j//J1UOklTIAesoIMAKqRMRj8Lrfcnyf7rTvl6qHSKthAPSYEcBtgRMi4jrVQ1oREf9C9/71y1dv6bmv0j38z6geIq2WAdBzkwho+S2Ct6H7ToARMEeT636vAV5WvWUATqX7jX5nVQ+RpmEADEBmPg0jwO8EzMnkut+7gKdVbxmAjwFbZ+bvqodI0zIABsII4NZ0EeCvH52hyXW/jwJ7VG8ZgHcBO2XmH6uHSLNgAAyIEcCt6X4cYATMwOTo0vHAttVbBuC1wF6ZeXH1EGlWDICBMQL8TsAsRMSN8Lrfcj0nM5+emVk9RJolA2CAjABuhRGwahFxW7rrfreo3tJz64EnZuZLq4dI82AADJQRcEkEXLd6yJBExBZ01/3+tnpLz10I7JaZb6oeIs2LATBgRoARsBIR8WDgOOBa1Vt67lxg+8z8YPUQaZ4MgIEzArglRsCSImJv4HC87reUXwFbZeanqodI82YAjIARwC2BEyPietVD+iging28Fa/7LeWHwBaZ+fnqIdJaMABGwgjgFnTfCTACJibX/V4L+CK2pX2D7rTvt6qHSGvFABgRI8AIWDC57vdu4KnVWwbgs8C9M/PH1UOktWQAjIwRwC3ofhzQ7KvcI+IawFHAI6q3DMBxwP0z89fVQ6S1ZgCMkBHAzem+E9BcBGxw3W+b6i0D8H5gx8z8Q/UQqYIBMFJGQHsRMLnudypwt+otA/B6YI/MvLB6iFTFABgxI4Cb08iPAyLidnTX/W5evWUAXpSZ+2bm+uohUiUDYOQmEXBQ9Y5CN6OLgOtXD5mXiLg3cDJe91tKAvtn5vOrh0h9YAA0IDOfihEwygiIiIfgdb/luAjYMzMPqR4i9YUB0AgjgL9nZBEQEY8FPgRcpXpLz50HPDgz31s9ROoTA6AhRsAlEXCD6iHTioh/Bd6C1/2W8hu6t/l9vHqI1DcGQGOMgGFHwOS634HAS6q3DMBPgPtk5meqh0h9ZAA0yAjgpgwwAibX/d4DPKV6ywB8m+607/9WD5H6ygBolBFwSQT8XfWQ5Zhc9/sYsHv1lgH4It0v9flB9RCpzwyAhhkBw4iAiLg2cAKwdfWWATgB2DIzf1k9ROo7A6BxRgA3occREBGbAacAd61dMgiHA9tl5u+rh0hDYADICPi/CLhh9ZANRcTt8brfcr0FeHhmXlA9RBoKA0CAEUDPImBy3e8koPlfbbwM/5GZj8/MddVDpCExAHQJI4Ab04MIiIid8LrfciTwzMx8dvUQaYgMAP0JI+CSCLhRxSePiMcBH8Trfku5GHhMZr66eog0VAaALsMIqImAiHgO8Ga87reUPwK7ZObbq4dIQ2YAaKOMADZjjSIgIi4XEQcBL5735xqBs4FtM/Oj1UOkoTMAtElGwCURsNm8PkFEXInuut/+8/ocI/Iz4L6Z+enqIdIYGABa1CQCDq7eUWgz5hQBG1z3223WH3uEvkd32vfL1UOksTAAtKTMfAptR8CNmHEETK77nQg8YFYfc8S+Qvfw/171EGlMDAAtixHAjYCTIuLG036gycc4FbjL1KvG7xS63+j3s+oh0tgYAFo2I4Ab0n0nYNURMLnudypws5mtGq+jgG0y8+zqIdIYGQBaESNg9REQEfcBTsbrfsvxDmDnzPxj9RBprAwArZgRcEkE3GS5fyEidgaOBa45t1Xj8Wrg0Zl5cfUQacwMAK2KEbD8CIiIxwOH4XW/5fjXzHxmZmb1EGnsDACtmhHA37FEBETEvwFvwut+S1kHPD4zX1Y9RGqFAaCpGAGXRMBNN/yHk+t+BwP/XjNrUC6g+1W+b6keIrXEANDUjIA/jYDJdb/3AvuVrhqG3wPbZ+bh1UOk1hgAmgkjgBvQRcCdgKOBhxfvGYJfAltl5vHVQ6QWXaF6gMYjM58SEdDuXfsbAF8AonrIAPyA7j3+364eIrXK7wBopvxOgA//Zfg63WlfH/5SIQNAM2cEaBGfAe6dmT+pHiK1zgDQXBgB2ohjgQdk5m+qh0gyADRHRoA28F5gx8z8Q/UQSR0DQHM1iYBDqneo1CHAnpl5UfUQSf/HANDcZeb+GAGtekFm7u9pX6l/fBug1kRm7j95i6DHcdqwHtg/M19fPUTSxhkAWjNGQDMuAh6Vme+vHiJp0wwArSkjYPT+AOySmcdVD5G0OANAa84IGK3f0N31/2z1EElL80WAKuELA0fnx3QHfnz4SwNhAKiMETAa36I77fv16iGSls8AUCkjYPA+D2yRmT+sHiJpZQwAlTMCBut44H6Z+avqIZJWzgBQLxgBg/Mhuhf8/b56iKTVMQDUG0bAYLwJeHhmXlA9RNLqGQDqFSOg916amU/MzPXVQyRNxzsA6h3vBPRSAs/IzNdWD5E0GwaAeskI6JWLgb0z853VQyTNjgGg3jICeuGPwMMy82PVQyTNlgGgXptEQAD7Vm9p0O+AHTPzlOohkmbPAFDvZeZ+k+8EGAFr5yzggZn5leohkubDdwFoEDJzP+B11TsacQbdaV8f/tKIGQAaDCNgTXyJ7uH//eohkubLANCgGAFzdTKwZWb+vHqIpPkzADQ4RsBcHAlsm5lnVw+RtDYMAA2SETBTbwN2yczzq4dIWjsGgAbLCJiJV9Ed+VlXPUTS2jIANGhGwFT+JTOflZlZPUTS2vMOgAbPOwErtg54Yma+tXqIpDoGgEbBCFi2C4DdM/Mj1UMk1TIANBpGwJLOAR6SmSdWD5FUzwDQqBgBm/QLYLvM/GL1EEn94IwjvAAABmFJREFU4IsANTq+MPAyzgS28OEvaUMGgEbJCLjE1+hO+36neoikfjEANFpGAP8D3Cczf1o9RFL/GAAatUkEvL56R4FjgAdk5m+rh0jqJwNAo5eZ+9JWBLyH7tX+51UPkdRfBoCa0FAEHAw8MjMvqh4iqd8MADWjgQh4XmY+xdO+kpbDOwBqSmbuO7kT8OTqLTO0HtgvM99QPUTScBgAas7IIuBC4FGZ+YHqIZKGxQBQk0YSAecCu2TmJ6qHSBoeA0DNGngE/BrYPjP/X/UQScPkiwDVtIG+MPBHwL19+EuahgGg5g0sAr5Jd9r3G9VDJA2bASB1hnAx8HN0X/n/qHqIpOEzACRg8t75PkfAJ4H7ZeavqodIGgcDQJrocQQcBuyQmedWD5E0HgaAtIEeRsB/Abtn5oXVQySNiwEgXUqPIuDFmfmkzFxfvEPSCHkHQNqIzMyI2G/yH9f6TkACT8/MA9f480pqiAEgbcIGERDAPmv0aS8GHp2Z716jzyepUQaAtIhJBOw7+Y/zjoDzgIdl5tFz/jySZABIS1mjCPgt8KDMPG1OH1+S/oQBIC3DnCPgLGCbzPzajD+uJG2S7wKQlmny7oB9gTfM8MN+l+60rw9/SWvKAJBWYMYRcDrdw//7M/hYkrQiBoC0QjOKgJOALTPzF7NZJUkrYwBIqzBlBBwBPDAzz5ntKklaPgNAWqVVRsChwK6Zef58VknS8hgA0hRWGAGvyMy9M3PdnGdJ0pIMAGlKy4yAAzLzgDWaJElL8g6ANAOL3AlYBzw+Mw8tmCVJm2QASDOykQg4n+5X+R5ROEuSNsoAkGZogwg4D/hoZp5UvUmSNsYAkGZs8pqAZ1XvkKTF+CJASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAZdoXrADNwgIp5WPUKSRuRq1QM0fwFk9QhJkmboW5l5y+oRfeePACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBVwB2rh4hSdIM/b56wBBEZlZvkCRJa8wfAUiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBv1/W+egEDHxZx0AAAAASUVORK5CYII=",_unchecked_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAACXBIWXMAAA/XAAAP1wHWM14/AAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTAzLTMwVDE5OjA2OjQzKzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wMy0zMFQxOTowNzozMCswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wMy0zMFQxOTowNzozMCswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1ZmUyOTFjMy1iNTM0LTIwNGMtODYyNC0wMTE3MmEzYjJhZTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NWZlMjkxYzMtYjUzNC0yMDRjLTg2MjQtMDExNzJhM2IyYWUzIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NWZlMjkxYzMtYjUzNC0yMDRjLTg2MjQtMDExNzJhM2IyYWUzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1ZmUyOTFjMy1iNTM0LTIwNGMtODYyNC0wMTE3MmEzYjJhZTMiIHN0RXZ0OndoZW49IjIwMjEtMDMtMzBUMTk6MDY6NDMrMDk6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4yIChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7vzoxhAAAOmElEQVR4nO3d3+v2d0HH8dd7u9fWXKkD++Eii7DsF4QdFBvVrHApZUoHri2CgiBnRgQdhVEnUUEHY2FiURGRkVMcTHIOm2ZBsHL9PMicSgc21y83JbzV7d3B9ZXcD+/d9319v/f7e31ej8df8Dr7PK/r+rzf15hzBgDoctnqAQDApScAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACo0kv7Z6BACb8ViS2+ecD68ewrmNJHP1CAA24WySH5tz3rl6CM/szOoBAGzCo0leOee8b/UQzo8AAGBfH0vysjnnA6uHcP4EAAD7eDDJTXPOB1cP4cI4BQDAxXogyQ0e/odJAABwMe5LcuOc82Orh3BxBAAAF+rO7H7zf3T1EC6eAADgQvx2klfPOc+uHsJ+BAAA5+uX55y3zTkfXz2E/TkFAMAzeTzJa+ecb1w9hOMjAAA4l7NJbp1zvnX1EI6XAADgC3k0yQ/POd+zegjHTwAA8HQeyu5N/79bPYSTIQAAeLIHk7x0zvmh1UM4OU4BAPD53p/keg//7RMAAHzOn2d3u9/Dq4dw8gQAAEnylux+8//E6iFcGgIAgDckuXnO+enVQ7h0BABAt1+ac77W7X59nAIA6PR4ktfMOd+0eghrCACAPmeT3DLnfNvqIawjAAC6PJLd7X7vXT2EtQQAQI+HkvzAnPPvVw9hPQEA0OGD2d3u9+HVQzgdnAIA2L6/TXKDhz+fTwAAbNu7k7zE7X48mQAA2K4/TfJyt/vxdAQAwDb9VpIfdbsfX4gAANie1885X+d2P87FKQCA7Xgsu9v9fmf1EE4/AQCwDZ/K7iv/t68ewmEQAACH75Ekr5hz/sXqIRwOAQBw2P49u9v9/mH1EA6LAAA4XP+a3e1+H1k9hMPjFADAYfqb7G73+8jqIRwmAQBweO7N7na//1g9hMMlAAAOy58k+cE55ydXD+GwCQCAw3FHklvc7sdxEAAAh+EX55w/O+ecq4ewDU4BAJxujyX56Tnn764ewrYIAIDT61NJbp5z3rV6CNsjAABOp49nd7vf+1YPYZsEAMDp89Hsbvf7x9VD2C4BAHC6fCDJTS744aQ5BQBwetwft/txiQgAgNPhXUm+d875n6uH0EEAAKz35rjdj0tMAACsdXuSW+ecn1k9hC5beAnwgSS3rR4BcBE+Ped8/+oRdNpCADw65/zr1SMA4JD4CQAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAAA4pzHGWL2B43dm9QAATqfPPfjnnHP1Fo6fbwAAeIoxxpXzyOotnAwBAMATjDGePec8u3oHJ0sAAJAkGWNcPsZ4/pzzkdVbOHkCAICMMa5K8tVzzo+u3rKvMcZzVm84BAIAoNwY47lJnj/n/PDqLfsaY3xLkreu3nEInAIANmmMMbzAdm5Hb/lfl+SyOeeHVu/Z1xjj+iR3J3l49ZZD4BsAYHPGGFcned7qHQfgG5J8ds75b6uH7GuM8bIk9yZ57uoth0IAAJty9Kn2hUm+dPWW02rsvDjJw3POh1bv2dcY45YkdyW5evWWQyIAgE05+tr/n5N8fPGUU2mMcVmSG5J8YM7536v37GuM8TNJ/ijJFau3HBoBAGzOnPOzSf7r6GHHkTHGmSTfn+T+OecnV+/Z1xjjV5LckcRVxRfBS4DAJh19E+AlwCNHx/xuTHLvnPOxxXP2chR2dyS5bfWWQyYAADZujPHFSb57zvnO1Vv2Nca4IskfJrl59ZZDJwAANmyMcU2Sb59z3rN6y77GGM/K7oz/Tau3bIEAANioowfmN84537t6y77GGNcmeUeS71y9ZSsEAMAGHX3y/5o55/2rt+xrjHFdknuSfPPqLVsiAAA25uiFv6+Yc/7T6i37GmO8MLsLfl6wesvWOCIDsCFHL8ldO+f84Oot+zq6rOgv4+F/IgQAwEaMMS5Pcs1G/tHvxiT3JfmytUu2SwAAbMDR2fgr55z/s3rLvsYYr0zyZ3Gd84kSAAAH7uj/Dy6fc/7v6i37GmP8RJI7k1y1esvWCQCAwzfmnJ9ZPWJfY4xfSPJ7SS5fvaWBAAA4cHPOx1dv2NcY49eT/MbqHU0cAwRgmaMXF9+U5CdXb2kjAABYYoxxZZI3J3nV6i2NBAAAl9wY40uS3JXkJau3tBIAAFxSY4znJXlnkhev3tJMAABwyYwxXpDkXUm+fvWWdk4BAHBJjDG+KclfxcP/VBAAAJy4McZ3JHlfkutWb2FHAABwosYYL03y7iTXrt7C/xMAAJyYMcark9yd5Fmrt/BEAgCAEzHGeE2SP05yxeotPJUAAODYjTFen+QN8Zw5tRwDBODYHP0z4e1JXrd6C+cmAAA4FmOMK5L8fpJbV2/hmQkAAPY2xrg6yVuSvHz1Fs6PAABgL2OM5yR5R5LrF0/hAggAAC7aGOMrk9yT5FtXb+HCCAAALsoY4+uS3Jvka1dv4cI5ngHABRtjfFt29/p7+B8oAQDABRljfFeS9yT58sVT2IMAAOC8jTF+KLu/83326i3sRwAAcF7GGD+e5G1Jrlq9hf0JAACe0Rjj55P8Qbw8vhkCAIBzGmP8apLfTDJWb+H4KDkAntYY47Ikb0zyU6u3cPwEAABPMcb4ouz+yvdHVm/hZAgAAJ5gjHFNkrcn+b7FUzhBAgCAJ7s7yfesHsHJ8hIgAE/2otUDOHkCAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACp1ZPeAYfNUY4+dWjwDYkKtXD+DkjSRz9QgAOEb/Mud80eoRp52fAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACp1J8qrVIwDgGH1i9YBDMOacqzcAAJeYnwAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBC/wcVCcUnTpFFpAAAAABJRU5ErkJggg==",_empty_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAACXBIWXMAAA/XAAAP1wHWM14/AAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTAzLTMwVDE5OjA2OjQzKzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wMy0zMFQxOTowOTowNCswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wMy0zMFQxOTowOTowNCswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiMzI0ZTM5OS1iZmU1LTA5NDAtOGFjOS1hYzc2YWZmYTU0NWUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6YjMyNGUzOTktYmZlNS0wOTQwLThhYzktYWM3NmFmZmE1NDVlIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YjMyNGUzOTktYmZlNS0wOTQwLThhYzktYWM3NmFmZmE1NDVlIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiMzI0ZTM5OS1iZmU1LTA5NDAtOGFjOS1hYzc2YWZmYTU0NWUiIHN0RXZ0OndoZW49IjIwMjEtMDMtMzBUMTk6MDY6NDMrMDk6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4yIChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7jm/kdAAAVl0lEQVR4nO3dvY8l2VkH4LfnYwdsvDK7CBBgI2PYtu8KAYYAZAnWJBCtWJGQkRghUgKEhEREAEgkgLBwiMgcICQSCBD4T7Dlwhe0AsmkuzIIix0vM03Q0zs9PdPd9+PU+XqfJ117uvreqvP7nbfq3j45OzsLACCXO60PAACoTwEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgITubZflrPVBADCdk5Y//HSzafnjh2ACAEBpTcOf3SgAAJQk/AehAABQivAfiAIAQAnCfzAKAADHEv4DUgAAOIbwH5QCAMChhP/AFAAADiH8B3ev9QEAMBTBPwkTAAB2JfwnogAAsAvhPxkFAIDbCP8JKQAA3ET4T0oBAOA6wn9iCgAALyL8J6cAAHDV0OF/utm0PoQhKAAAXCb8k1AAALgg/BPxTYAADB38EcL/ECYAALkJ/6RMAADyGjr8Bf9xTAAAchL+ySkAAPkIfxQAgGSEPxHhGQCATIYNf8FfngkAQA7Cn2coAADzE/48RwEAmJvw54U8AwAwJ8HPjUwAAOYzbPhTjwkAwFyGDX87/7pMAADmIfzZmQIAMAfhz14UAIDxCX/2pgAAjE34cxAFAGBcwp+DKQAAYxL+HEUBABiP8OdovgcAYBzDBn+E8O+NCQDAGIQ/RSkAAP0T/hSnAAD0TfizCgUAoF/Cn9UoAAB9Ev6sSgEA6I/wZ3UKAEBfhD9VKAAA/RD+VOOLgAD6MGz4C/4xKQAAbQ0b/BHCf2SzFIChLyCAEQn/sXkGAIC9Cf/xKQAA7EX4z0EBAGBnwn8eszwDAMCKBP98TAAAICETAACuZec/LxMAAF5I+M9NAQDgOcJ/fgoAAM8Q/jkoAAB8QPjn4SFAAAR/QiYAAMkJ/5xMAACSEvy5KQAwsdsW+O2yVDoSeiP8UQBgAhZz9uF8IUIBgCFYsCnBecRlCgB0xALNWpxbXKUAAExM8HMdBQAqshhTk/ONmygAkNjlgPCJgHkIfnahAMABZlxgZ/yd9jFLAcr+PrI7BQBuYUGd2yzBH+FcZT8KAOlZNJmB85h9KQCkYYHkMjt/svPHgAAGJvw5lAkAw7HgcYiZdvwRrgOOpwDQNYscPM91QQkKAF2woMFuXCuUogBQhUWLFoz94XoKAEVZoGAdri1KUwA4mAWJ3sy247/gWmMNCgC3svhAG6491qQAYJGBDrkuWZsCkICFhNnNNvp3zVKDAtCQixy4zJpATQoA0L3ZdvgvIvypTQEAaEjw04o/BgTQiPCnJQUAoAHhT2sKAEBlwp8eeAYAoBLBT09MAAAqEP70RgEAWJnwryvDx0ZLcAsA6NboC7ngr2/0c6YmEwCAFQj/+oT/fkwAgO6MvpAL//pGP2daMAEAKEj41yf8D2MCADQ3ywIu/Oub5dxpwQQAoADhX5/wP44JAMABBH5bwv94CgDAjoR+e4K/HAUAaGaExVzo92OE82UkngEAuIbw74fwL88EAKiu98Vc8Pej93NlZCYAAJcI/34I/3WZAACrGW0BF/79GO3cGZEJAEAI/54I/zpMAIDUBH8/BH9dJgBAWsK/H8K/PhMA4CijLtzCvw+jnj8zMAEA0hH+fRD+bSkAQCrCvw/Cvz23AICDjLiAC//2RjxvZqUAADsbefEW/u2NfP7MyC0AYHrCvz3h3x8TAIpxgd9MCLXhdW/LutAvBYCjucB3c/l16jmUvJ+U4lzqmwLAQVzYjKDnojU7a0T/FAB25oIu5+K1FFDr8dq2YZ0YhwIwKBcZXE/4t2FdGosCMBgX2FxaTAJmP4eEf32zn1OzUgASuGlBdOEyE+FfnzVkXArAAA65wHZdCK/+71zMjEr412e9GJsCMJljF8GL/78Lu67tsgiwI3jt6rI+zEEB6Ng+F1npBfB0s3GRT2D291Dw1zf7OZWJAjC4NRdA0wB6Iuzbsg7MRwHo1C4XW60F0TSgjl1uA2R6HwR+PzKdd5koAIOqvTgqAdQg9Pvimp+bAjCg3hbJXY7HQrKbzA8DZv29e+R6zUEB6MxtF17LRfLyFGDf4/A8AdcR/H2Z5Bo9i4iT1gfROwVgID0slKU+ZhgxzULDEXo4p3lqkmvyrPUBjOJO6wPgqZsuvhkXyhl/pxImWYRv5f3vx3ZZTiY574T/HkwAGprkgjuKhwuv53Whhu2y3I2IR62PowDhvycTgAHMvlOa/fc7xOzh7z3vw3ZZXg7hn5YC0LksC2WW3xPvdQ+ejPw/FRH/3fpYChD+B1IAOpZtocz2+0IL22W5FxFvRsTXWx9LAcL/CApAp4QhUNp2Wb4rIn43Iv629bEc6SyE/9EUALqi+MzN+9vOdlk+GRH/ExF/0PpYjiT4C/EpgA5ZJIFStstyJyJ+PiL+qfGhlCD8CzIBAJjUdlm+MyJ+M4Q/L6AAdMbu32sAx3rylP8PRMQfRcQXWh9PAcJ/BW4BdETwMTPndx3bZTmJiJ+J83v9v9T4cEoQ/isxAQCYxJNv9fu1iPirEP7cQgHohN3Rs7we85n92w1b2y7LhyPi9yPizyPi040PpwThvzK3AAAGt12W742IP4mIX42IDzU+nBKEfwUKQAfsdoFDbZflE3H+oN8vRsRLjQ+nBOFfiQLQmPAHDvHkYb/XI+JP4/xz/jOs58K/Is8A0CX3i+fkfS3qMxHxxRD+HGiGk2ZYdv/Avp7s/H82Iv4szkvA6Bs5wd+IAgAwiCfh/9k4v+f/440PpwTh39DozXFYdv9k5TbAYZ6E/y+E8KcQBYDuCIg+nW42xYqr9/ggPxcRfxHCn0LcAmjA7p/e3XSOvui/CfR1bZflNM7v+c+weAj/TigAwAcOLacX/79di4ASvLvtsnwkIv4wIn669bEUIPw74hYAXbGTbKPUeF+wl/Xkvv+vR8RbrY+lAOHfGROAyiyQ1xP+9a1xPt42DXAN7OVH4/y7/Ucn/DtkAgCs4pqgP6l9HKPaLstLEfFvrY+jAOHfKQUAEir5RP9tP+eS7z7dbITBDp6M/r/d+jgK8H53TAGoyOjzesb/9TQ6Dz8aEd9s8YMHNUNwzvA7TM0zAHThcigpA+toVUCf/NxvNvnhA5rg/Bf8g1AA6M7VoJpgQWzO9GkME5zrwn8gCgDd2/cz5jwl+Mcxwfkt/AfjGYBKLMTH8xrux+s1DuFPCwpAJRNc4F2o9fT6yLxGY5lgbRD+g1IAKrEgU4PzjMqE/8AUAIYk6J7nNRnLdllG3/0L/8EpAAxL4J0z8h/P4MEfIfynoAAwtOzBl/33H5HwpxcKAAxK+I9H+NMTBYDhZQtCI/8xCX96owBUMsHFTwcE/3gmeNgvQvhPyTcBwiCE/3gEPz0zAWAKs4fj7L8fXRL+k1MAoHPCf0yD7/6FfwIKQEWDLwg0IPyBtSgA0CnhPy5lnxF4CBA6I/iBGkwAKrMz4CbCf3yucUahAEAnhP/4hD8jUQAasEhwlfAHavMMAOlcDtseypjwn0MP5xLsQwFoZLssFv5Kbnqdr/632ou4c2AOwp8RKQANKQHlvGgBPuS1rTkd8N7PQfgzKs8ANGbxWEeJcF0zoIU/0JoJAFMpHawX/17Joib856HAMzITgA5M8udCm7l47UbYsQv/ebhmGd3J17/2tRn+6MNJ6wMoSUj065hF3/s6jwThP3wunG42U+XCGkwAoALhP48E4U8SCkCH3BLo17GfLADohQLQsYsioAz0ZZ9AF/5zcS0yE58CGMTVheeGL7C5f7rZvF/nqLiJ8J+L8Gc2CsCgbliM3t8uy8npZjP8Qzw9O91sbgwE4Q/0zi2AOQn/hoT/fOz+mZECAAUJ//n0Hv6nm43zjoMoAJPqfdGCEfR8HQl+jqUAwIGuLr4W47n0HP5QgocAoQDhTw3OM0oyAZiYHUwdFuX5jHbtjHa89EEBmJyFYV3Cfz49XjPu97MGBSCBHhc0ANpSAJJQAuB2vV0ndv6sSQEAiP7CH9bmUwCJXCxwdhTwrN7C3zVKDQpAQooAPNVT+LsmqcktgMR6WvgAqEsBSE4JILNezv9jHvbr5XdgPAoAkJLgJDvPABDbZXHvkVR6CH/XHK2ZABARfSyIUINzHc6ZAABp9BD+dv70wgSAD/SwOAJQhwLAM5QAZtX63Pa1vvRGAeA5rRdKKK3lOS346ZUCwAspAczCuQwvpgBwLQsno7Pzh+spANxICQCYk48BAlNqVV7t+hmFCQC3MgUAmI8JADCd2qXVrp8RmQCwE1MARlHzXPWgHyNTAAAgIQWAnZkC0DvnKOxOAWAvFlh65dyE/XgIkL1tl8V9T7pSK/yd98zEBCCZUguY3Ra9WPtcvHjQT/gzGwUgoVKLmRJAa9nPwey/P8dxCyCJtXYvFwuQ3RG11dj5w8wUgInVXMA8F0ANdrxQjgKQ2NXAPnZxPXQasF2Wk4i4d7rZvH/UATAtwQ/lKQA3sKM9zIsW68uv5UXgR8RHIuJjEfHpiPjWdln+7nSzOat0mHTKH/GBOhQAPnCxAK6xAF/8m2dnZ791cnLyckR8f0R8PCJ+OCJejYh/jIi/j4hvF//hDMNOH+pRAKjq5OTkC48fP37nzp07DyLipYi4GxFnEfGpiPi+iPhGy+OjnRbhb9dPZj4GyHPW/szznTt3Xn348OH9iLgf5+fg3Yj4oYj4zGo/lK7Z+UN9CgBNPHjw4ME77777X2dnH9zyfzUi3tguy/2Gh0UDrXb+dv9kpwBwrbUXyVdfeeWjy7L8++PHjyMiviMiPhsRP7baDyQ9wQ9PKQA09frrr//IP3/5y1959OjR3Yj4ZET8ynZZPJuSwHZZjP6hIQWAW629a/rcG2/8xNtvv/2NiHg5It6MiJ9c7YfRBcEP7SkAdOG11177+KNHj07i/DsBPr9dlldaHxPrEP7QB6NWdnbly3yK//t37969FxGPI+KXI+JftsvyxdPN5n+L/yBScK8fbmYCQG/uRMQPRsRvRMRb22V50Ph4KKjG7t+DfrAbBYCDrLzI3o+I04j47Yh4c7ssH1rrB1GP0T/0xS0AjrLi1wffj/OvBf69iHhluyxfOt1s3i39Q6ij1s4f2J0CQM9eioj3I+J3IuIT22X564j419PNxt8LADiSAkARK08CHsf5MwE/FRFf2i7LP0TEf55uNo9L/zDKWnvnb9cPh1MAGMGdOP+DQZ+L848Jfiwi/jgivtXyoGhH8MPxFIAbbJfFQrOnFT8qeBLnJeB7IuLDEfF/Jf9xyvPQH/RNAWA1K9wWOImIdyLiP+L82QA6tVb4K+RQjgLAaF6NiLfifBpAh0qHv9CHdSgArK7UJOBSEPzNcUfEWoz9YRy+CIhq7OTmtkb4O2dgPQoAcDQ7fxiPAgAcRfjDmBQA4GDCH8blIcBb+C6Ask43G6ExiRLvo2sL2jEBAICEFACq8/fax2eKA+NTAHZgsYNz22VxPcAkFAAASEgBoBm3AcZi598X7wfH8ikA4FYFv8YZ6IQJAE0Jhv7ZacKcFADgWsIf5qUAAC8k/GFungGgOd8O2B/f8gfzMwEAnqGMQQ4KAF3w7YB9EP6QhwIARITwh2wUgB1ZHJmZ8xvyUQDoilsB9Ql/yEkBgMSEP+SlANAlU4D1Cf8x+YuMlKIAQEICBFAA6JbnAdYh/IEIBWAvFk5GVnN0rLhB/3wVMN0TJgDlmQBAAqZXwFUKAExO+AMvogDAxIQ/cB0FYE8WVEbQ8rPintmAMSgAMBklFdiFAgATEf7ArnwMECbROvyN/tfX+j1mLiYAMAHBAOzLBAAG1kvw2/3DeEwAYFC9hD8wJhMAGIzgB0owAYCB9Bj+xv8wJgUABtFj+APjcgsABtBj+Nv5w9hMAKBzPYY/9TkPKM0EADrV84Jv9w/jMwGADvUc/sAcFADojPAHanALADoxQvAb/cM8TACgAyOEPzAXEwDogJ01UJsJAAAkpAAAdM4tItagAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACTkjwExLF+PWp4/SgR5KACA4IeE3AIAgIRMACAxO3/ISwFgWMeEl+cHgOwUAEjIzh/wDAAAJGQCAEnY9QOXKQCkJAyB7NwCAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAOjYdllaHwKTUgAAICEFAAASutf6AABqMU6HpxQAYEjCHI6jAADdEe6wPgUAqEKoQ18UAKAIAQ9jUQCAZwhyyEEBgASEOnCVAgADEujAsRQAaECAA60pAHANIQ3MTAFgWgIc4HoKAMMQ6ADlKAB0Q8AD1KMAsCqhDtAnfw4YABIyAeAodvgAY1IAuJZwB5iXApCYgAfISwGYgCAHYF8KwAAEPAClKQCNCXcAWlAAKhL2APRCAViZ0AegRwrAnk43m2v/m7AHYBQKwJGEPgAjUgD2JPABmIG/BQAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACd1rfQCFnLU+AAAYiQkAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAAAwlYcPH561PoYRKAAATOO999575ytf/epftj6OEZycnSlKAJCNCQAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBC/w+cQjvNwRAEYgAAAABJRU5ErkJggg==";class PdfCheckElement extends PdfElement{constructor(e,t,i){super(e,t),this._model=i}_build(e,t){}_doWrite(e,t){const i=e.getBounds(t),r=this._model.getChecked(this._model.checked),s="0"===r?_unchecked_:"-1"===r?_empty_:_checked_;e.image(t,s,i)}}class PdfDBoxElement extends PdfElement{constructor(e,t){super(e,t)}_build(e,t){}_doWrite(e,t){const i=e.getModel(t),r=e.getBounds(t);i.reversed?e.dline(t,r.x+r.width,r.y,r.x,r.y+r.height):e.dline(t,r.x,r.y,r.x+r.width,r.y+r.height)}}class PdfImageElement extends PdfElement{constructor(e,t,i){super(e,t),this._model=i}_build(e,t){const i=getComputedStyle(t),r=Utils.getImageUrl(i);r&&(r.startsWith("data:image")?this._data=r:r.startsWith("http")&&e.addImage(this._url=r,i.opacity))}_doWrite(e,t){const i=this._data||e.getImage(this._url),r=e.getBounds(t),s=this._model.imagePosition;switch(s){case"top":case"bottom":r.valign=s;break;case"left":case"right":r.align=s;break;case"center":r.valign=s,r.align=s}const n=this._model.imageFit;"cover"===n?r.cover=[r.width,r.height]:"contain"===n&&(r.fit=[r.width,r.height]),e.save(),e.clip(t),e.image(t,i,r),e.restore()}}class PdfQrcodeElement extends PdfElement{constructor(e,t){super(e,t)}_build(e,t){const i=t.firstChild;i instanceof HTMLImageElement&&(this._data=i.src)}_doWrite(e,t){const i=this._data||e.getImage(this._url);if(i){const r=e.getBounds(t);e.image(t,i,r)}}}class PdfSvgElement extends PdfElement{constructor(e,t,i,r=!1){super(e,t||e.getParent(i)),this._svg=i,this._scaled=r}_build(e,t){}_doWrite(e,t){e.save();const i=e.getBounds(t);if(this._scaled){const r=t.getBoundingClientRect(),s=this._svg.getBBox(),n=r.width/s.width,o=r.height/s.height,a=Math.min(n,o),A=(r.width-s.width*a)/2*pxpt,l=(r.height-s.height*a)/2*pxpt;e.translate(i.x+A,i.y+l),e.scale(a,a)}else e.translate(i.x,i.y);this.$_write(e,this._svg),e.restore()}$_write(e,t){const i=t.children;for(let t=0;t<i.length;t++){const r=i[t];if(r instanceof SVGGraphicsElement){e.save();const t=r.transform.baseVal,i=t.length>0?t.getItem(0):null;i&&e.transformSvg(i.matrix),"g"===r.tagName?this.$_write(e,r):r instanceof SVGTextElement?this.$_text(e,r):r instanceof SVGPathElement?this.$_path(e,r):r instanceof SVGRectElement?this.$_rect(e,r):r instanceof SVGLineElement?this.$_line(e,r):r instanceof SVGPolygonElement?this.$_polygon(e,r):r instanceof SVGEllipseElement&&this.$_ellipse(e,r),e.restore()}}}$_rotation(e){const t=e.split("(")[1].split(")")[0].split(","),i=+t[0],r=+t[1];return Math.round(Math.atan2(r,i)*(180/Math.PI))}$_text(e,t){const i=t.getElementsByClassName("highcharts-text-outline").length>0?t.children[0].textContent:t.textContent;if(i){const r=getComputedStyle(t),s=e.getBox(t),n={},o=r.transform&&r.transform.startsWith("matrix(")&&this.$_rotation(r.transform)||0;e.text(r,s,i,o,n)}}$_path(e,t){const i=t.getAttribute("d");if(i){const r=getComputedStyle(t);e.scale(pxpt,pxpt),e.path(r,i)}}$_rect(e,t){const i=e.getBox(t),r=getComputedStyle(t);e.rect(r,i,!0)}$_line(e,t){}$_polygon(e,t){const i=getComputedStyle(t),r=t.points,s=[];e.scale(pxpt,pxpt);for(let e=0;e<r.length;e++){const t=r.getItem(e);s.push([t.x,t.y])}e.polygon(i,s)}$_ellipse(e,t){const i=e.getBox(t),r=getComputedStyle(t);e.ellipse(r,i)}}class PdfTableCellElement extends PdfBoundedElement{_needClip(){return!0}}class PdfTableElement extends PdfElement{constructor(e,t,i=!1){super(e,t),this._renderCell=i}_doWrite(e,t){const i=e.getBounds(t);e.getModel(t);const r=getComputedStyle(t);e.border(r,i);const s=t.rows;for(let t=0;t<s.length;t++)this.$_writeRow(e,s[t])}$_writeRow(e,t){const i=e.getBounds(t),r=t.cells,s=getComputedStyle(t);e.rect(t,i),e.border(s,i);for(let t=0;t<r.length;t++)this.$_writeCell(e,r[t])}$_writeCell(e,t){const i=getComputedStyle(t);if("none"!==i.display){const r=e.getBounds(t);if(e.rect(t,r),e.border(i,r),this._renderCell){const s=t.textContent;s&&e.text(i,r,s,0)}}}}class PdfExporter extends Base{constructor(){super(),this._elementCreator=(e,t,i)=>{let r;if(t instanceof HtmlItem)r=new PdfHtmlElement(e,i.firstChild);else if(t instanceof ImageItem)i.style.opacity=t.styles.opcaity,r=new PdfImageElement(e,i,t);else if(t instanceof SvgItem){const t=i._svg_;i.innerHTML=t.substring(t.indexOf("<svg")),this._svgs.push(i);const s=i.firstElementChild;s.style.visibility="hidden",r=new PdfSvgElement(e,i,s,!0)}else t instanceof QrcodeItem?r=new PdfQrcodeElement(e,i):i instanceof HTMLSpanElement?r=t instanceof CheckItem?new PdfCheckElement(e,i,t):t instanceof BarItem?new PdfBarElement(e,i,t):t instanceof DiagonalBoxContainer?new PdfDBoxElement(e,i):new PdfElement(e,i):i instanceof HTMLTableElement?r=new PdfTableElement(e,i,t instanceof CrosstabBand):i instanceof HTMLTableCellElement?r=new PdfTableCellElement(e,i):i instanceof SVGSVGElement?r=new PdfSvgElement(e,null,i,t instanceof DataMatrixItem):i instanceof HTMLCanvasElement?r=new PdfCanvasElement(e,i):i instanceof HTMLElement?r=new PdfElement(e,i):i instanceof Text&&(r=new PdfTextElement(e,i));return r}}_doDispose(){super._doDispose()}_base64ToArrayBuffer(e){for(var t=window.atob(e),i=t.length,r=new Uint8Array(i),s=0;s<i;s++)r[s]=t.charCodeAt(s);return r.buffer}export(e,t,i,r,s){const n=()=>{o.canExport()||o.prepare(a)?this.$_export(o,i,r,s):setTimeout((()=>{n()}),300)};this._svgs=[];const o=new PdfModel(e,t,this._elementCreator),a=5;n()}$_export(e,t,i,r){const s=new window.PDFDocument({size:e.report.paper.size,layout:e.report.paper.orientation,margin:0}),n=s.pipe(i||new window.blobStream);let o,a;if(!(t&&t.length>0))throw new Error("Pdf 출력용 폰트가 설정돼야 합니다.");for(let e of t)e.content&&s.registerFont(e.name,this._base64ToArrayBuffer(e.content));o=t[0].name,a=t[1].name||o,e.write(s,o,a);for(let e of this._svgs)e.removeChild(e.firstElementChild);s.end(),i?null==r||r(i):n.on("finish",(function(){const t=n.toBlob("application/pdf");let i=document.createElement("a"),r=window.URL.createObjectURL(t);document.body.appendChild(i),i.href=r,i.download=(e.report.info.name||"rrpt")+".pdf",i.style.position="fixed",i.target="_blank",i.click(),document.body.removeChild(i)}))}}const toHwpColor=function(e){return((255&e)<<16)+(65280&e)+((16711680&e)>>16)},toHwpAlpha=function(e){return 255*(1-e)>>0};var HWPLineType1;!function(e){e.Solid="Solid",e.Dash="Dash",e.Dot="Dot",e.DashDot="DashDot",e.DashDotDot="DashDotDot",e.LongDash="LongDash",e.Circle="Circle",e.DoubleSlim="DoubleSlim",e.SlimThick="SlimThick",e.ThickSlim="ThickSlim",e.SlimThickSlim="SlimThickSlim",e.None="None"}(HWPLineType1||(HWPLineType1={}));const toHwpLineType=function(e){switch(e){case"dot":return HWPLineType1.Dot;case"dashed":return HWPLineType1.Dash;default:return HWPLineType1.Solid}};var HWPLineType2,HWPLineType3,HWPNumberType1,HWPNumberType2,HWPAlignmentType1,HWPAlignmentType2,HWPArrowType,HWPArrowSize,HWPLangType,HWPHatchStyle,HWPInfillMode,HWPLineWrapType,HWPTextWrapType,HWPFieldType;!function(e){e.Solid="Solid",e.Dash="Dash",e.Dot="Dot",e.DashDot="DashDot",e.DashDotDot="DashDotDot",e.LongDash="LongDash",e.Circle="Circle",e.DoubleSlim="DoubleSlim",e.SlimThick="SlimThick",e.ThickSlim="ThickSlim",e.SlimThickSlim="SlimThickSlim"}(HWPLineType2||(HWPLineType2={})),function(e){e.Solid="Solid",e.Dot="Dot",e.Thick="Thick",e.Dash="Dash",e.DashDot="DashDot",e.DashDotDot="DashDotDot"}(HWPLineType3||(HWPLineType3={})),function(e){e.Digit="Digit",e.CircledDigit="CircledDigit",e.RomanCapital="RomanCapital",e.RomanSmall="RomanSmall",e.LatinCapital="LatinCapital",e.LatinSmall="LatinSmall",e.CircledLatinCapital="CircledLatinCapital",e.CircledLatinSmall="CircledLatinSmall",e.HangulSyllable="HangulSyllable",e.CircledHangulSyllable="CircledHangulSyllable",e.HangulJamo="HangulJamo",e.CircledHangulJamo="CircledHangulJamo",e.HangulPhonetic="HangulPhonetic",e.Ideograph="Ideograph",e.CircledIdeograph="CircledIdeograph"}(HWPNumberType1||(HWPNumberType1={})),function(e){e.Digit="Digit",e.CircledDigit="CircledDigit",e.RomanCapital="RomanCapital",e.RomanSmall="RomanSmall",e.LatinCapital="LatinCapital",e.LatinSmall="LatinSmall",e.CircledLatinCapital="CircledLatinCapital",e.CircledLatinSmall="CircledLatinSmall",e.HangulSyllable="HangulSyllable",e.CircledHangulSyllable="CircledHangulSyllable",e.HangulJamo="HangulJamo",e.CircledHangulJamo="CircledHangulJamo",e.HangulPhonetic="HangulPhonetic",e.Ideograph="Ideograph",e.CircledIdeograph="CircledIdeograph",e.DecagonCircle="DecagonCircle",e.DecagonCircleHanja="DecagonCircleHanja",e.Symbol="Symbol",e.UserChar="UserChar"}(HWPNumberType2||(HWPNumberType2={})),function(e){e.Justify="Justify",e.Left="Left",e.Right="Right",e.Center="Center",e.Distribute="Distribute",e.DistributeSpace="DistributeSpace"}(HWPAlignmentType1||(HWPAlignmentType1={})),function(e){e.Left="Left",e.Right="Right",e.Center="Center"}(HWPAlignmentType2||(HWPAlignmentType2={})),function(e){e.Normal="Normal",e.Arrow="Arrow",e.Spear="Spear",e.ConcaveArrow="ConcaveArrow",e.EmptyDiamond="EmptyDiamond",e.EmptyCircle="EmptyCircle",e.EmptyBox="EmptyBox",e.FilledDiamond="FilledDiamond",e.FilledCircle="FilledCircle",e.FilledBox="FilledBox"}(HWPArrowType||(HWPArrowType={})),function(e){e.SmallSmall="SmallSmall",e.SmallMedium="SmallMedium",e.SmallLarge="SmallLarge",e.MediumSmall="MediumSmall",e.MediumMedium="MediumMedium",e.MediumLarge="MediumLarge",e.LargeSmall="LargeSmall",e.LargeMedium="LargeMedium",e.LargeLarge="LargeLarge"}(HWPArrowSize||(HWPArrowSize={})),function(e){e.Hangul="Hangul",e.Latin="Latin",e.Hanja="Hanja",e.Japanese="Japanese",e.Other="Other",e.Symbol="Symbol",e.User="User"}(HWPLangType||(HWPLangType={})),function(e){e.Horizontal="Horizontal",e.Vertical="Vertical",e.BackSlash="BackSlash",e.Slash="Slash",e.Cross="Cross",e.CrossDiagonal="CrossDiagonal"}(HWPHatchStyle||(HWPHatchStyle={})),function(e){e.Tile="Tile",e.TileHorzTop="TileHorzTop",e.TileHorzBottom="TileHorzBottom",e.TileVertLeft="TileVertLeft",e.TileVertRight="TileVertRight",e.Total="Total",e.Center="Center",e.CenterTop="CenterTop",e.CenterBottom="CenterBottom",e.LeftCenter="LeftCenter",e.LeftTop="LeftTop",e.LeftBottom="LeftBottom",e.RightCenter="RightCenter",e.RightTop="RightTop",e.RightBottom="RightBottom",e.Zoom="Zoom"}(HWPInfillMode||(HWPInfillMode={})),function(e){e.Break="Break",e.Squeeze="Squeeze",e.Keep="Keep"}(HWPLineWrapType||(HWPLineWrapType={})),function(e){e.Square="Square",e.Tight="Tight",e.Through="Through",e.TopAndBottom="TopAndBottom",e.BehindText="BehindText",e.InFrontOfText="InFrontOfText"}(HWPTextWrapType||(HWPTextWrapType={})),function(e){e.Clickhere="Clickhere",e.Hyperlink="Hyperlink",e.Bookmark="Bookmark",e.Formula="Formula",e.Summery="Summery",e.UserInfo="UserInfo",e.Date="Date",e.DocDate="DocDate",e.Path="Path",e.Crossref="Crossref",e.Mailmerge="Mailmerge",e.Memo="Memo",e.RevisionChange="RevisionChange",e.RevisionSign="RevisionSign",e.RevisionDelete="RevisionDelete",e.RevisionAttach="RevisionAttach",e.RevisionClipping="RevisionClipping",e.RevisionSawtooth="RevisionSawtooth",e.RevisionThinking="RevisionThinking",e.RevisionPraise="RevisionPraise",e.RevisionLine="RevisionLine",e.RevisionSimpleChange="RevisionSimpleChange",e.RevisionHyperlink="RevisionHyperlink",e.RevisionLineAttach="RevisionLineAttach",e.RevisionLineLink="RevisionLineLink",e.RevisionLineTransfer="RevisionLineTransfer",e.RevisionRightmove="RevisionRightmove",e.RevisionLeftmove="RevisionLeftmove",e.RevisionTransfer="RevisionTransfer",e.RevisionSplit="RevisionSplit"}(HWPFieldType||(HWPFieldType={}));const _TAG_="TAG",_ORDERS_="ORDERS",_A_="A".charCodeAt(0),_Z_="Z".charCodeAt(0),UNDERLINE="_".charCodeAt(0),DOLLAR="$".charCodeAt(0);class HWPElement{constructor(e){if(e)for(let t in e)if(t in this){const i=t.charCodeAt(0);i>=_A_&&i<=_Z_&&(this[t]=e[t])}}static equals(e,t){if(e&&t&&e.constructor===t.constructor){for(let i in e){const r=i.charCodeAt(0);if(r>=_A_&&r<=_Z_&&e[i]!==t[i])return!1}for(let i in e){const r=e[i];if(r instanceof HWPElement&&!HWPElement.equals(r,t[i]))return!1}for(let i in t){if(t[i]instanceof HWPElement&&!(e[i]instanceof HWPElement))return!1}return!0}return!1}get tag(){return this.constructor.TAG}get text(){}getTagOrders(){}getContent(){let e=[];const t={};for(let i in this){const r=this[i];if(r instanceof HWPElement&&i.charCodeAt(0)!==DOLLAR)e.push(r);else{const s=i.charCodeAt(0);if(s>=_A_&&s<=_Z_)t[i]=r;else if(Utils.isArray(r)&&i.charCodeAt(0)==UNDERLINE)for(let t of r)e.push(t)}}const i=this.constructor.ORDERS;return i&&(e=e.sort(((e,t)=>(i[t.tag]||0)-(i[e.tag]||0)))),{elements:e,attrs:t}}}HWPElement.TAG="INVALID";class HWPListElement extends HWPElement{}class HWPShapeObject extends HWPElement{constructor(){super(...arguments),this._size=new HWPSize,this._position=new HWPPosition,this._outsideMargin=new HWPOutsideMargin,this.InstId=HWPShapeObject.Id++}setSize(e,t){return this._size.Width=e,this._size.Height=t,this}setPosition(e,t,i){return this._position.HorzOffset=e,this._position.VertOffset=t,this._position.TreatAsChar=i,this}}HWPShapeObject.TAG="SHAPEOBJECT",HWPShapeObject.Id=0;class HWPSize extends HWPElement{constructor(){super(...arguments),this.WidthRelTo="Absolute",this.HeightRelTo="Absolute",this.Protect=!1}}HWPSize.TAG="SIZE";class HWPPosition extends HWPElement{constructor(){super(...arguments),this.TreatAsChar=!1,this.VertRelTo="Paper",this.HorzRelTo="Paper",this.VertAlign="Top",this.HorzAlign="Left",this.VertOffset=0,this.HorzOffset=0,this.FlowWidthText=!0,this.AllowOverlap=!0}}HWPPosition.TAG="POSITION";class HWPPoint extends HWPElement{}HWPPoint.TAG="POINT";class HWPOutsideMargin extends HWPElement{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0}}HWPOutsideMargin.TAG="OUTSIDEMARGIN";class HWPInsideMargin extends HWPElement{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0}}HWPInsideMargin.TAG="INSIDEMARGIN";class HWPCaption extends HWPElement{constructor(){super(...arguments),this.Side="Left"}}HWPCaption.TAG="CAPTION";class HWPShapeComment extends HWPElement{}HWPShapeComment.TAG="SHAPECOMMENT";class HWPShadow extends HWPElement{}HWPShadow.TAG="SHADOW";class HWPParameterSet extends HWPElement{}HWPParameterSet.TAG="PARAMETERSET";class HWPImage extends HWPElement{constructor(){super(...arguments),this.Bright=0,this.Contrast=0,this.Effect="RealPic"}}HWPImage.TAG="IMAGE";class WindowBrush extends HWPElement{}WindowBrush.TAG="WINDOWBRUSH";class Gradiation extends HWPElement{constructor(){super(...arguments),this.Angle=90,this.CenterX=0,this.CenterY=0,this.Step=50,this.ColorNum=2,this.StepCenter=50}}Gradiation.TAG="GRADIATION";class Color extends HWPElement{}Color.TAG="COLOR";class ImageBrush extends HWPElement{constructor(){super(...arguments),this.Mode=HWPInfillMode.Tile}}ImageBrush.TAG="IMAGEBRUSH";class HWPFillBrush extends HWPElement{constructor(){super(...arguments),this._windowBrush=new WindowBrush,this._color=16777215,this._alpha=0}setColor(e,t){return this._windowBrush.FaceColor=toHwpColor(this._color=e),this._windowBrush.Alpha=toHwpAlpha(this._alpha=t),this}sameWithColor(e,t){return e===this._color&&t===this._alpha}}HWPFillBrush.TAG="FILLBRUSH";class RotationInfo extends HWPElement{}RotationInfo.TAG="ROTATIONINFO";class Matrix extends HWPElement{constructor(){super(...arguments),this.E1=1,this.E2=0,this.E3=0,this.E4=0,this.E5=1,this.E6=0}}class TransMatrix extends Matrix{}TransMatrix.TAG="TRANSMATRIX";class ScaMatrix extends Matrix{}ScaMatrix.TAG="SCAMATRIX";class RotMatrix extends Matrix{}RotMatrix.TAG="ROTMATRIX";class RenderingInfo extends HWPElement{constructor(){super(...arguments),this._translate=new TransMatrix,this._scale=new ScaMatrix,this._rotate=new RotMatrix}}RenderingInfo.TAG="RENDERINGINFO";class ShapeComponent extends HWPElement{constructor(){super(...arguments),this._rendering=new RenderingInfo,this.XPos=0,this.YPos=0,this.GroupLevel=0,this.HorzFlip=!1,this.VertFlip=!1}setSize(e,t){this.OriWidth=e,this.OriHeight=t}}ShapeComponent.TAG="SHAPECOMPONENT";class TextMargin extends HWPElement{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0}}TextMargin.TAG="TEXTMARGIN";class DrawText extends HWPElement{constructor(){super(...arguments),this._textMargin=new TextMargin,this._paraList=new HWPParaList,this.Editable=!1}setText(e,t){const i=this._paraList.add().addText(!1,!0),r=i.add(HWPChar);return i.CharShape=t,r.setText(e),this}}DrawText.TAG="DRAWTEXT";class HWPLineShape extends HWPElement{constructor(){super(...arguments),this.Width=33,this.Style=HWPLineType1.None,this.EndCap="Flat",this.HeadStyle=HWPArrowType.Normal,this.TailStyle=HWPArrowType.Normal,this.HeadSize=HWPArrowSize.SmallSmall,this.TailSize=HWPArrowSize.SmallSmall,this.OutlineStyle="Normal"}setStyle(e){return this.Style=toHwpLineType(e),this}setColor(e,t=1){return this.Color=toHwpColor(e),this.Alpha=toHwpAlpha(t),this}}HWPLineShape.TAG="LINESHAPE";class HWPDrawingObject extends HWPElement{constructor(e=!0,t=!0){super(),this._shapeComponent=new ShapeComponent,this._lineShape=new HWPLineShape,e&&(this._fillBrush=new HWPFillBrush),t&&(this._drawText=new DrawText)}get lineShape(){return this._lineShape}setText(e,t){return this._drawText.setText(e,t),this}setSize(e,t){return this._shapeComponent.setSize(e,t),this}setColor(e,t){return this._fillBrush||(this._fillBrush=new HWPFillBrush),this._fillBrush.setColor(e,t),this}setDebug(e){return e&&this._lineShape.Style===HWPLineType1.None&&(this._lineShape.Style=HWPLineType1.Solid,this._lineShape.Color=toHwpColor(13421772)),this}}HWPDrawingObject.TAG="DRAWINGOBJECT";class HWPText extends HWPElement{constructor(e,t,i){super(i),this._children=[],this.CharShape=0,e&&!t&&(this._secDef=new SecDef,this._colDef=new ColDef)}get secDef(){return this._secDef}get colDef(){return this._colDef}add(e){const t=new e;return this._children.push(t),t}addElement(e){e&&this._children.push(e)}addElements(e){null==e||e.forEach((e=>e&&this._children.push(e)))}}HWPText.TAG="TEXT",HWPText.ORDERS={SECDEF:10,COLDEF:9};class HWPPara extends HWPElement{constructor(){super(...arguments),this._texts=[]}addText(e=!1,t=!1){const i=new HWPText(e,t);return t&&(this.ParaShape=0),this._texts.push(i),i}get firstText(){return this._texts.length>0?this._texts[0]:void 0}}HWPPara.TAG="P";class HWPParaList extends HWPElement{constructor(){super(...arguments),this._paras=[],this.TextDirection=0,this.LineWrap=HWPLineWrapType.Keep,this.VertAlign="Center"}get count(){return this._paras.length}get first(){return this._paras.length>0?this._paras[0]:void 0}add(){const e=new HWPPara;return this._paras.push(e),e}}HWPParaList.TAG="PARALIST";class HWPTextElement extends HWPElement{static getFontSize(e){let t=parseInt(e)||10;return e.endsWith("px")&&(t=72*t/96>>0),t>>0}static getColor(e){let t=0;if(e.startsWith("#"))t=+e.substr(e.length-6),t=(255&t)<<16+(65280&t)+(16711680&t)>>16;else if(e.startsWith("rgb(")){const i=e.substring(4,e.length-1).split(/,\s*/);t=(+i[2]<<16)+(+i[1]<<8)+ +i[0]}else if(e.startsWith("rgba(")){const i=e.substring(5,e.length-1).split(/,\s*/);t=(+i[3]<<24)+(+i[2]<<16)+(+i[1]<<8)+ +i[0]}return t}static getFontBold(e){return+e>=700}_toHwpF(e){return 100*e*72/96}_toHwp(e){return Math.round(100*e*72/96)}_toColor(e){return(255&e)<<16+(65280&e)+(16711680&e)>>16}}class HWPChar extends HWPTextElement{setText(e){e=1===e.length&&160===e.charCodeAt(0)?"":Utils.escapeXML(e),this._value=e}get text(){return this._value}}HWPChar.TAG="CHAR";class StartNumber extends HWPTextElement{constructor(){super(...arguments),this.PageStartOn="Both",this.Page=0,this.Figure=0,this.Table=0,this.Equation=0}}StartNumber.TAG="STARTNUMBER";class Hide extends HWPTextElement{constructor(){super(...arguments),this.Header=!1,this.Footer=!1,this.MasterPage=!1,this.Border=!1,this.Fill=!1,this.PageNumPos=!1,this.EmptyLine=!1}}Hide.TAG="HIDE";class PageMargin extends HWPTextElement{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0,this.Header=0,this.Footer=0,this.Gutter=0}}PageMargin.TAG="PAGEMARGIN";class PageDef extends HWPTextElement{constructor(){super(...arguments),this._margin=new PageMargin,this.Landscape=0,this.Width=59528,this.Height=84188,this.GutterType="LeftOnly"}}PageDef.TAG="PAGEDEF";class AutoNumFormat extends HWPTextElement{constructor(){super(...arguments),this.Type=HWPNumberType2.Digit,this.Superscript=!1}}AutoNumFormat.TAG="AUTONUMFORMAT";class NoteLine extends HWPTextElement{constructor(){super(...arguments),this.Type=HWPLineType1.Solid,this.Width="12mm"}}NoteLine.TAG="NOTELINE";class NoteSpacing extends HWPTextElement{constructor(){super(...arguments),this.AboveLine=567,this.BelowLine=567,this.BetweenNotes=850}}NoteSpacing.TAG="NOTESPACING";class NoteNumbering extends HWPTextElement{constructor(){super(...arguments),this.Type="Continuous",this.NewNumber=1}}NoteNumbering.TAG="NOTENUMBERING";class NotePlacement extends HWPTextElement{constructor(){super(...arguments),this.Place="EachColumn",this.BeneathText=!1}}NotePlacement.TAG="NOTEPLACEMENT";class FootNoteShape extends HWPTextElement{}FootNoteShape.TAG="FOOTNOTESHAPE";class EndNoteShape extends FootNoteShape{constructor(){super(),this._placement.Place="EndOfDocument"}}EndNoteShape.TAG="ENDNOTESHAPE";class PageOffset extends HWPElement{constructor(){super(...arguments),this.Left=1417,this.Right=1417,this.Top=1417,this.Bottom=1417}}PageOffset.TAG="PAGEOFFSET";class PageBorderFill extends HWPElement{constructor(){super(...arguments),this.Type="Both",this.TextBorder=!1,this.HeaderInside=!1,this.FooterInside=!1,this.FillArea="Paper"}}PageBorderFill.TAG="PAGEBORDERFILL";class MasterPage extends HWPElement{constructor(){super(...arguments),this.Type="Both",this.HasTextRef=!1,this.HasNumRef=!1}}MasterPage.TAG="MASTERPAGE";class ExtMasterPage extends HWPElement{}ExtMasterPage.TAG="EXT_MASTERPAGE";class SecDef extends HWPTextElement{constructor(){super(...arguments),this._pageDef=new PageDef,this._pageBorderFills=[],this.TabStop=8e3}setLandscape(){this._pageDef.Landscape=1}}SecDef.TAG="SECDEF";class ColumnLine extends HWPTextElement{constructor(){super(...arguments),this.Type=HWPLineType1.Solid,this.Width="0.12mm"}}ColumnLine.TAG="COLUMNLINE";class Column extends HWPTextElement{}Column.TAG="COLUMN";class ColumnTable extends HWPTextElement{constructor(){super(...arguments),this._columns=[]}}ColumnTable.TAG="COLUMNTABLE";class ColDef extends HWPTextElement{constructor(){super(...arguments),this.Type="Newspaper",this.Count=1,this.Layout="Left",this.SameSize=!0,this.SameGap=0}}ColDef.TAG="COLDEF";class ImageRect extends HWPElement{setBounds(e,t,i,r){return this.X0=e,this.Y0=t,this.X1=e+i,this.Y1=t,this.X2=e+i,this.Y2=t+r,this.X3=e,this.Y3=t+r,this}}ImageRect.TAG="IMAGERECT";class ImageClip extends HWPElement{constructor(){super(...arguments),this.Left=0,this.Top=0,this.Right=0,this.Bottom=0}}ImageClip.TAG="IMAGECLIP";class EffectsColor extends HWPElement{}EffectsColor.TAG="EFFECTSCOLOR";class ShadowEffect extends HWPElement{}ShadowEffect.TAG="SHADOWEFFECT";class Glow extends HWPElement{}Glow.TAG="GLOW";class SoftEdge extends HWPElement{}SoftEdge.TAG="SOFTEDGE";class Reflection extends HWPElement{}Reflection.TAG="REFLECTION";class Effects extends HWPElement{}Effects.TAG="EFFECTS";class HWPPicture extends HWPTextElement{constructor(){super(...arguments),this._shapeObject=new HWPShapeObject,this._shapeComponent=new ShapeComponent,this._lineShape=new HWPLineShape,this._imageRect=new ImageRect,this._imageClip=new ImageClip,this._image=new HWPImage}init(){return this._shapeObject.ZOrder=1,this._shapeObject.NumberingType="Figure",this._shapeObject.TextWrap=HWPTextWrapType.Square,this._shapeObject.Lock=!1,this}setId(e){return this._image.BinItem=e,this}setBounds(e,t,i,r,s){return e=this._toHwp(e),t=this._toHwp(t),i=this._toHwp(i),r=this._toHwp(r),this._shapeObject.setSize(i,r).setPosition(e,t,s),this._shapeComponent.setSize(i,r),this._imageRect.setBounds(0,0,i,r),this}}HWPPicture.TAG="PICTURE";class HWPLine extends HWPTextElement{constructor(e,t,i,r,s){super(),this._shape=new HWPShapeObject,this._drawing=new HWPDrawingObject(!1,!1),this.IsReverseHV=!1;const n=this._toHwp(Math.min(e,i)),o=this._toHwp(Math.min(t,r)),a=this._toHwp(Math.max(e,i)),A=this._toHwp(Math.max(t,r)),l=Math.max(1,a-n),h=Math.max(1,A-o);this.StartX=0,this.StartY=0,this.EndX=l,this.EndY=h,this._shape.setPosition(n,o,s).setSize(l,h),this._drawing.setSize(l,h),this._drawing.lineShape.Style=HWPLineType1.Solid}setStyle(e){return this._drawing.lineShape.setStyle(e),this}setColor(e,t=1){return this._drawing.lineShape.setColor(e,t),this}}HWPLine.TAG="LINE";class HWPRectangle extends HWPTextElement{constructor(e=!0,t=!0,i){super(i),this._shape=new HWPShapeObject,this._drawing=new HWPDrawingObject(e,t)}setBounds(e,t,i,r,s){return i=this._toHwp(i),r=this._toHwp(r),this.X0=0,this.Y0=0,this.X1=0+i,this.Y1=0,this.X2=0+i,this.Y2=0+r,this.X3=0,this.Y3=0+r,this._shape.setSize(i,r).setPosition(this._toHwp(e),this._toHwp(t),s),this._drawing.setSize(i,r),this}setZOrder(e){return this._shape.ZOrder=e,this}setText(e,t){return this._drawing.setText(e,t),this}setDebug(e=!0){this._drawing.setDebug(e)}setColor(e,t){return this._drawing.setColor(e,t),this}}HWPRectangle.TAG="RECTANGLE";class Ellipse extends HWPTextElement{constructor(){super(...arguments),this.IntervalDirty=!1,this.ArcType="Normal"}}Ellipse.TAG="ELLIPSE";class Arc extends HWPTextElement{constructor(){super(...arguments),this.Type="Normal"}}Arc.TAG="ARC";class Polygon extends HWPTextElement{constructor(){super(...arguments),this._points=[]}}Polygon.TAG="POLYGON";class Segment extends HWPElement{constructor(){super(...arguments),this.Type="Curve"}}Segment.TAG="SEGMENT";class Curve extends HWPTextElement{constructor(){super(...arguments),this._segments=[]}}Curve.TAG="CURVE";class ConnectLine extends HWPTextElement{}ConnectLine.TAG="CONNECTLINE";class UnknownObject extends HWPTextElement{}UnknownObject.TAG="UNKNOWNOBJECT";class Button extends HWPTextElement{}Button.TAG="BUTTON";class RadioButton extends HWPTextElement{}RadioButton.TAG="RADIOBUTTON";class CheckButton extends HWPTextElement{}CheckButton.TAG="CHECKBUTTON";class ComboBox extends HWPTextElement{constructor(){super(...arguments),this._shape=new HWPShapeObject}}ComboBox.TAG="COMBOBOX";class Edit extends HWPTextElement{}Edit.TAG="EDIT";class ListBox extends HWPTextElement{}ListBox.TAG="LISTBOX";class ScrollBar extends HWPTextElement{}ScrollBar.TAG="SCROLLBAR";class Container extends HWPTextElement{}Container.TAG="CONTAINER";class Equation extends HWPTextElement{}Equation.TAG="EQUATION";class TextArt extends HWPTextElement{}TextArt.TAG="TEXTART";class FieldBegin extends HWPTextElement{}FieldBegin.TAG="FIELDBEGIN";class FieldEnd extends HWPTextElement{}FieldEnd.TAG="FIELDEND";class Bookmark extends HWPTextElement{}Bookmark.TAG="BOOKMARK";class Header extends HWPTextElement{}Header.TAG="HEADER";class Footer extends HWPTextElement{}Footer.TAG="FOOTER";class FootNote extends HWPTextElement{}FootNote.TAG="FOOTNOTE";class EndNote extends HWPTextElement{}EndNote.TAG="ENDNOTE";class AutoNum extends HWPTextElement{}AutoNum.TAG="AUTONUM";class NewNum extends HWPTextElement{}NewNum.TAG="NEWNUM";class PageNumCtrl extends HWPTextElement{}PageNumCtrl.TAG="PAGENUMCTRL";class PageHiding extends HWPTextElement{}PageHiding.TAG="PAGEHIDING";class PageNum extends HWPTextElement{}PageNum.TAG="PAGENUM";class IndexMark extends HWPTextElement{}IndexMark.TAG="INDEXMARK";class Compose extends HWPTextElement{}Compose.TAG="COMPOSE";class Dutmal extends HWPTextElement{constructor(){super(...arguments),this.PosType="Top",this.Align=HWPAlignmentType1.Center}}Dutmal.TAG="DUTMAL";class HiddenComment extends HWPTextElement{}HiddenComment.TAG="HIDDENCOMMENT";class CellZoneList extends HWPElement{constructor(){super(...arguments),this._cellZones=[],this.Count=0}}CellZoneList.TAG="CELLZONELIST";class CellZone extends HWPElement{}CellZone.TAG="CELLZONE";class CellMargin extends HWPElement{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0}}CellMargin.TAG="CELLMARGIN";class Cell extends HWPElement{constructor(){super(...arguments),this._paraList=new HWPParaList,this.ColAddr=0,this.RowAddr=0,this.ColSpan=1,this.RowSpan=1,this.Header=!1,this.HasMargin=!1,this.Protect=!1,this.Editable=!1,this.Dirty=!1}get textElement(){return this.$_text}add(e){const t=this.$_checkText();return this._paraList.LineWrap=HWPLineWrapType.Break,t.add(e)}addElement(e){const t=this.$_checkText();this._paraList.LineWrap=HWPLineWrapType.Break,t.addElement(e)}setAlign(e,t){return this._paraList.first.ParaShape=e.head.addParaShape(t),this}setVAlign(e){return this._paraList.VertAlign=e,this}setWrap(e){return this._paraList.first.ParaShape=e.head.addParaShapeWrap(),this}setMargin(e,t,i,r){const s=this._cellMargin||(this._cellMargin=new CellMargin);return isNaN(e)||(s.Left=e),isNaN(t)||(s.Right=t),isNaN(i)||(s.Top=i),isNaN(r)||(s.Bottom=r),this.HasMargin=!0,this}$_checkText(){if(!this.$_text){const e=this._paraList.add();this.$_text=e.addText()}return this.$_text}}Cell.TAG="CELL";class Row extends HWPElement{constructor(){super(...arguments),this._cells=[]}addCell(e){this._cells.push(e)}}Row.TAG="ROW";const _aligns={l:HWPAlignmentType1.Left,c:HWPAlignmentType1.Center,r:HWPAlignmentType1.Right};class HWPTable extends HWPTextElement{constructor(){super(...arguments),this._shapeObject=new HWPShapeObject,this._insideMargin=new HWPInsideMargin,this.PageBreak="Cell",this.RepeatHeader=!0,this.CellSpacing=0}setBounds(e,t,i,r,s){return e=this._toHwp(e),t=this._toHwp(t),i=this._toHwp(i),r=this._toHwp(r),this._shapeObject.setSize(i,r).setPosition(e,t,s),this}build(e,t,i,r){var s;function n(e,t){if(1===t)return l[e];{let i=l[e];for(let r=1;r<t;r++)i+=l[e+r];return i}}const o=r.rows,a=r.firstChild.children,A=a.length,l=new Array(A);for(let e=0;e<A;e++){const t=a[e],i=t.$_w;l[e]=this._toHwp(isNaN(i)?+t.dataset.width:i)}this.RowCount=o.length,this.ColCount=A,this._rows=[];for(let r=0,a=this.RowCount;r<a;r++){const a=o[r],l=getComputedStyle(a),h=ColorUtils.cssToColor(l.backgroundColor),d=a.cells,c=this._toHwp(a.offsetHeight),u=new Row;for(let o=0;o<A;o++){const a=d[o],A=a.style,l=getComputedStyle(a);if("none"===l.display)continue;const p=new Cell,_=ColorUtils.cssToColor(l.backgroundColor)||h,g=extractBorderStyles(A,l);p.RowAddr=r,p.ColAddr=o,p.RowSpan=a.rowSpan||1,p.ColSpan=a.colSpan||1,p.Width=n(o,p.ColSpan),p.Height=c,p.BorderFill=_&&g?e.getBorderFillByCell(ColorUtils.lighten(_.color,_.alpha),g):_?e.getBorderFillByColor(ColorUtils.lighten(_.color,_.alpha),1):g?e.getBorderFillByBorders(g):2;const m=p.add(HWPChar),f=null===(s=a.firstElementChild)||void 0===s?void 0:s.firstElementChild;if(f){const r=f instanceof HTMLElement&&t.models[f.dataset._m_];if(r instanceof DiagonalBoxContainer){const t=this.$_createDboxRun(e,r,f);p.addElement(t),p.setAlign(e,_aligns[a.dataset._align])}else if(r instanceof TextItemBase){const t=a.getElementsByClassName(TextItemElementBase.SPAN)[0];if(t){const i=p.textElement,r=getComputedStyle(t),s=e.getCharShape(r);m.setText(t.textContent),i.CharShape=s,"pre-wrap"===r.whiteSpace?p.setWrap(e):p.setAlign(e,_aligns[a.dataset._align])}}else if(f instanceof HTMLElement){const r=i.createCellElement(e,t,f);if(r){for(let e of r)p.addElement(e);p.setAlign(e,_aligns[a.dataset._align])}}}u.addCell(p)}this._rows.push(u)}return this}buildBox(e,t,i,r,s){const n=Array.from(r.firstElementChild.children),o=s instanceof ColumnBoxContainer,a=o?1:n.length,A=o?n.length:1,l=s.getItemGap(r.offsetWidth),h=s.itemsAlign,d=r.offsetWidth,c=r.offsetHeight,u=new Array(a),p=new Array(A);if(o){u[0]=this._toHwp(d);let e=0;for(let t=0;t<A;t++){const i=n[t].offsetHeight+l;p[t]=this._toHwp(i),e+=i}e<c&&h!==BoxItemsAlign.MIDDLE&&(h===BoxItemsAlign.END?(n.unshift(null),p.unshift(this._toHwp(c-e))):(n.push(null),p.push(this._toHwp(c-e))))}else{p[0]=this._toHwp(c);let e=0;for(let t=0;t<a;t++){const i=n[t].offsetWidth+l;u[t]=this._toHwp(i),e+=i}e<d&&h!==BoxItemsAlign.MIDDLE&&(h===BoxItemsAlign.END?(n.unshift(null),u.unshift(this._toHwp(d-e))):(n.push(null),u.push(this._toHwp(d-e))))}this.RowCount=p.length,this.ColCount=u.length,this._rows=[];for(let r=0;r<p.length;r++){const s=new Row;for(let A=0;A<u.length;A++){const l=new Cell;l.RowAddr=r,l.ColAddr=A,l.RowSpan=1,l.ColSpan=1,l.Width=u[A],l.Height=p[r];const h=l.add(HWPChar),_=n[r*a+A];if(_){const r=_ instanceof HTMLElement&&t.models[_.dataset._m_];if(o){const t=r.getLeft(d),i=r.getRight(d);(isNaN(t)||isNaN(i))&&isNaN(t)?isNaN(i)?l.setAlign(e,HWPAlignmentType1.Center):(l.setAlign(e,HWPAlignmentType1.Right),l.setMargin(NaN,this._toHwp(i),NaN,NaN)):l.setMargin(this._toHwp(t),NaN,NaN,NaN)}else{const e=r.getTop(c),t=r.getBottom(c);(isNaN(e)||isNaN(t))&&isNaN(e)?isNaN(t)||(l.setVAlign("Bottom"),l.setMargin(NaN,NaN,NaN,this._toHwp(t))):(l.setVAlign("Top"),l.setMargin(NaN,NaN,this._toHwp(e),NaN))}if(r instanceof DiagonalBoxContainer){const t=this.$_createDboxRun(e,r,_);l.addElement(t)}else if(r instanceof TextItemBase){const t=_.getElementsByClassName(TextItemElementBase.SPAN)[0];if(t){const i=l.textElement,r=getComputedStyle(t),s=e.getCharShape(r);h.setText(t.textContent),i.CharShape=s,"pre-wrap"===r.whiteSpace&&l.setWrap(e)}}else if(_ instanceof HTMLElement){const r=i.createCellElement(e,t,_);if(r)for(let e of r)l.addElement(e)}}s.addCell(l)}this._rows.push(s)}return this}$_createDboxRun(e,t,i){let r=dboxToImage(t,i);const s=e.addImage(r,"1"),n=new HWPPicture,o=e.getDomBounds(i);return n.init().setId(s).setBounds(o.x,o.y,o.width,o.height,!!e.inTable),n}}HWPTable.TAG="TABLE";const BORDER_TOP=0,BORDER_BOTTOM=1,BORDER_LEFT=2,BORDER_RIGHT=3,BORDER_STYLES=["borderTopStyle","borderBottomStyle","borderLeftStyle","borderRightStyle"],BORDER_COLORS=["borderTopColor","borderBottomColor","borderLeftColor","borderRightColor"];class HWPBuilder{constructor(){}createCellElement(e,t,i){const r=[];return function i(r,s,n){const o=t.models[s.dataset._m_];if(!o||o instanceof DiagonalBoxContainer||n.push(...r.$_createBounds(e,s)),o instanceof HtmlItem){const t=s.firstElementChild.childNodes;for(let s=0;s<t.length;s++){const o=t[s];o instanceof HTMLElement?i(r,o,n):o instanceof Text&&n.push(r.$_createText(e,o))}}else if(o instanceof ImageItem)n.push(r.$_createPicture(e,s));else if(o instanceof SvgItem)n.push(r.$_createSvg(e,s));else if(o instanceof QrcodeItem)n.push(r.$_createQrcode(e,s));else if(o instanceof CheckItem)n.push(...r.$_createCheck(e,s));else if(o instanceof DiagonalBoxContainer)n.push(r.$_createDiagonalLine(e,s,o.reversed));else if(o instanceof BoxContainer)n.push(r.$_createBox(e,t,s,o));else if(s instanceof HTMLTableElement)n.push(r.$_createTable(e,t,s));else if(s instanceof HTMLSpanElement)o instanceof DiagonalBoxContainer&&s.dataset.line?n.push(this.$_createDiagonalLine(e,s,o.reversed)):n.push(r.$_createText(e,s));else if(s instanceof SVGSVGElement)n.push(r.$_createSvg(e,s));else if(s instanceof HTMLCanvasElement)n.push(r.$_createCanvas(e,s));else if(s instanceof HTMLElement){const e=s.children;for(let t=0;t<e.length;t++)e[t]instanceof Element&&i(r,e[t],n)}}(this,i,r),r}build(e,t,i){t.forEach(((t,r)=>{const s=this.$_buildPage(i.setPageDiv(t.page),e,t),n=i.body.section.addPara(),o=n.addText(0===r);e.paper.orientation===PaperOrientation.LANDSCAPE&&o.secDef.setLandscape(),s.forEach((e=>{e&&o.addElement(e)})),r>0&&(n.PageBreak=!0)}))}$_createBounds(e,t){let i=e.getDomBounds(t);const r=getComputedStyle(t),s=ColorUtils.cssToColor(r.backgroundColor),n=[];if(s){const r=new HWPRectangle(!0,!1);i=e.getDomBounds(t),r.setBounds(i.x,i.y,i.width,i.height,!!e.inTable).setZOrder(0).setColor(s.color,s.alpha),n.push(r)}return BORDER_STYLES.forEach(((s,o)=>{const a=r[s];if(a&&"none"!=a){let s,A,l,h;switch(i||(i=e.getDomBounds(t)),o){case 0:s=i.x,l=i.x+i.width,A=h=i.y;break;case 1:s=i.x,l=i.x+i.width,A=h=i.y+i.height;break;case 2:s=l=i.x,A=i.y,h=i.y+i.height;break;case 3:s=l=i.x+i.width,A=i.y,h=i.y+i.height}const d=ColorUtils.cssToColor(r[BORDER_COLORS[o]]),c=new HWPLine(s,A,l,h,!!e.inTable);c.setStyle(a).setColor(d.color,d.alpha),n.push(c)}})),n}$_createText(e,t){const i=t.textContent;if(i){const r=t instanceof Text?e.getTextBounds(t):e.getDomBounds(t),s=new HWPRectangle(!1,!0),n=e.getCharShape(t instanceof Text?t.parentElement:t);return s.setBounds(r.x,r.y,r.width,r.height,!!e.inTable).setText(i,n).setDebug(HWPBuilder.DEBUG),s}}$_createPicture(e,t){const i=e.getDomBounds(t),r=getComputedStyle(t),s=Utils.getImageUrl(r),n=e.addImage(s,r.opacity),o=new HWPPicture;return o.init().setId(n).setBounds(i.x,i.y,t.clientWidth,t.clientHeight,!!e.inTable),o}$_createCheck(e,t){const i=t.getElementsByClassName(CheckItemElement.CHECK_CLASS)[0],r=this.$_createPicture(e,i),s=t.getElementsByClassName(CheckItemElement.TEXT_CLASS)[0];return[r,this.$_createText(e,s)]}$_createSvg(e,t){let i,r=t instanceof SVGSVGElement?t:null;if(r)i=(new XMLSerializer).serializeToString(r);else{const e=t._svg_;i=e.substring(e.indexOf("<svg"))}const s=new Blob([i],{type:"image/svg+xml;charset=utf-8"}),n=(window.URL||window.webkitURL).createObjectURL(s),o=e.addImage(n,"1"),a=new HWPPicture;a.init().setId(o);const A=e.getDomBounds(t);return a.setBounds(A.x,A.y,A.width,A.height,!!e.inTable),a}$_createCanvas(e,t){const i=t.toDataURL(),r=e.addImage(i,"1"),s=new HWPPicture,n=e.getDomBounds(t);return s.init().setId(r).setBounds(n.x,n.y,n.width,n.height,!!e.inTable),s}$_createQrcode(e,t){let i=null;const r=e.getDomBounds(t),s=getComputedStyle(t),n=t.querySelector("img");n&&(i=n.src);const o=e.addImage(i,s.opacity),a=new HWPPicture;return a.init().setId(o).setBounds(r.x,r.y,t.clientWidth,t.clientHeight,!!e.inTable),a}$_createTable(e,t,i){const r=new HWPTable,s=e.getDomBounds(i),n=e.inTable;r.BorderFill=2,r.setBounds(s.x,s.y,s.width,s.height,!!e.inTable),e.inTable=r;try{r.build(e,t,this,i)}finally{e.inTable=n}return r}$_createBox(e,t,i,r){const s=new HWPTable,n=e.getDomBounds(i),o=e.inTable;s.BorderFill=2,s.setBounds(n.x,n.y,n.width,n.height,!!e.inTable),e.inTable=s;try{s.buildBox(e,t,this,i,r)}finally{e.inTable=o}return s}$_createDiagonalLine(e,t,i){const r=e.getDomBounds(t);return i?new HWPLine(r.x,r.y+r.height,r.x+r.width,r.y,!!e.inTable):new HWPLine(r.x,r.y,r.x+r.width,r.y+r.height,!!e.inTable)}$_buildItem(e,t,i,r){const s=i instanceof HTMLElement&&t.models[i.dataset._m_];if(s&&!(s instanceof DiagonalBoxContainer)){const t=this.$_createBounds(e,i);Utils.push(r,t)}if(s instanceof HtmlItem){const s=i.firstElementChild.childNodes;for(let i=0;i<s.length;i++){const n=s[i];n instanceof HTMLElement?this.$_buildItem(e,t,n,r):n instanceof Text&&r.push(this.$_createText(e,n))}}else if(s instanceof ImageItem)r.push(this.$_createPicture(e,i));else if(s instanceof SvgItem)r.push(this.$_createSvg(e,i));else if(s instanceof QrcodeItem)r.push(this.$_createQrcode(e,i));else if(s instanceof CheckItem)r.push(...this.$_createCheck(e,i));else if(i instanceof HTMLTableElement)r.push(this.$_createTable(e,t,i));else if(i instanceof HTMLSpanElement)s instanceof DiagonalBoxContainer&&i.dataset.line?r.push(this.$_createDiagonalLine(e,i,s.reversed)):r.push(this.$_createText(e,i));else if(i instanceof HTMLElement&&"B"===i.tagName)r.push(this.$_createText(e,i));else if(i instanceof SVGSVGElement)r.push(this.$_createSvg(e,i));else if(i instanceof HTMLCanvasElement)r.push(this.$_createCanvas(e,i));else if(i instanceof HTMLElement){const s=i.children;for(let i=0;i<s.length;i++)s[i]instanceof Element&&this.$_buildItem(e,t,s[i],r)}}$_buildBackground(e,t,i,r){this.$_buildItem(e,t,i,r)}$_buildForeground(e,t,i,r){this.$_buildItem(e,t,i,r)}$_buildPageHeader(e,t,i,r){this.$_buildItem(e,t,i,r)}$_buildPageFooter(e,t,i,r){this.$_buildItem(e,t,i,r)}$_buildPageBody(e,t,i,r){for(let s of i)this.$_buildItem(e,t,s,r)}$_buildPage(e,t,i){const r=[];return this.$_buildBackground(e,t,i.background,r),this.$_buildPageHeader(e,t,i.pageHeader,r),this.$_buildPageBody(e,t,i.contents,r),this.$_buildPageFooter(e,t,i.pageFooter,r),this.$_buildForeground(e,t,i.foreground,r),r}}HWPBuilder.DEBUG=!1;const EOL="\r\n",$$_head='<?xml version="1.0" encoding="utf-8"?>\r\n',$$_escape=/\<|\>|\&|\"/;function escape(e){return $$_escape.test(e)?e.replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\"/g,"&quot;"):e}class XmlDoc{constructor(e){this._root=e}get root(){return this._root}addChild(e,t,i,r){const s={tag:t,attrs:i};return(e=e||this._root).children||(e.children=[]),e.children.push(s),s}setAttr(e,t,i){void 0!==i?(e.attrs||(e.attrs={}),e.attrs[t]=escape(String(i))):e.attrs&&delete e.attrs[t]}setValue(e,t){void 0!==t?e.value=t:delete e.value}toString(){let e=$$_head;return e+=`<!DOCTYPE ${this._root.tag}>\r\n`,e+=this.$_toStr(this._root),e}$_toStr(e){let t=`<${e.tag}`;for(let i in e.attrs)t+=` ${i}="${e.attrs[i]}"`;if(e.children||void 0!==e.value){if(t+=">",void 0!==e.value&&(t+=e.value),e.children){t+="\r\n";for(let i of e.children)t+=this.$_toStr(i)}t+=`</${e.tag}>`}else t+="/>";return`${t}\r\n`}}class HWPRoot extends HWPElement{constructor(){super(),this.Version="2.8",this.Style="embed",this.SubVersion="8.0.0.0",this._head=new HWPHead,this._body=new HWPBody,this._tail=new HWPTail}get head(){return this._head}get body(){return this._body}get tail(){return this._tail}addImageBin(e,t,i){this._head.addBin(e,t),this._tail.addImageBin(e,i)}get tag(){return"HWPML"}}HWPRoot.TAG="HWPML";class DocSummary extends HWPElement{}DocSummary.TAG="DOCSUMMARY";class BeginNumber extends HWPElement{constructor(){super(...arguments),this.Page=1,this.Footnote=1,this.Endnote=1,this.Picture=1,this.Table=1,this.Equation=1}}BeginNumber.TAG="BEGINNUMBER";class CaretPos extends HWPElement{}CaretPos.TAG="CARETPOS";class DocSetting extends HWPElement{constructor(){super(...arguments),this._beginNumber=new BeginNumber,this._caretPos=new CaretPos}}DocSetting.TAG="DOCSETTING";class BinItem extends HWPElement{constructor(){super(...arguments),this.Type="Embedding",this.Format="jpg"}}BinItem.TAG="BINITEM";class BinDataList extends HWPListElement{constructor(){super(...arguments),this._items=[],this.Count=0}add(e,t){const i=new BinItem;i.BinData=e,i.Format=t,this._items.push(i),this.Count++}get count(){return this.Count}}BinDataList.TAG="BINDATALIST";class TypeInfo extends HWPElement{constructor(){super(...arguments),this.FamilyType=2,this.SerifStyle=11,this.Weight=6,this.Proportion=0,this.Contrast=0,this.StrokeVariation=1,this.ArmStyle=1,this.LetterForm=1,this.MidLine=1,this.XHeight=1}}TypeInfo.TAG="TYPEINFO";class Font extends HWPElement{constructor(){super(...arguments),this._typeInfo=new TypeInfo}}Font.TAG="FONT";class FontFace extends HWPElement{constructor(){super(...arguments),this._fonts=[]}add(e){this._fonts.push(e)}}FontFace.TAG="FONTFACE";class FaceNameList extends HWPListElement{constructor(){super(),this._faces=[];const e=["맑은 고딕","굴림","바탕","돋움"];["Hangul","Latin","Hanja","Japanese","Other","Symbol","User"].forEach((t=>{const i=new FontFace;i.Lang=t,i.Count=e.length,e.forEach(((e,t)=>{const r=new Font;r.Id=t,r.Type="ttf",r.Name=e,i.add(r)})),this._faces.push(i)}))}get count(){return this._faces.length}}FaceNameList.TAG="FACENAMELIST";class Border extends HWPElement{constructor(){super(...arguments),this.Type=HWPLineType1.Solid,this.Width="0.12mm",this.Color=0}setStyles(e){const t=ColorUtils.cssToColor(e.color,!1),i=e.style;if(i)if("none"===i)this.Type=HWPLineType1.None;else this.Type=HWPLineType1.Solid;return t&&(0===t.alpha&&(this.Type=HWPLineType1.None),this.Color=toHwpColor(t.color)),this}sameWithStyles(e){const t=ColorUtils.cssToColor(e.color,!1),i=t&&0===t.alpha?"none":e.style;if(i)if("none"===i){if(this.Type!==HWPLineType1.None)return!1}else if(this.Type!==HWPLineType1.Solid)return!1;return!t||this.Color===toHwpColor(t.color)}}class BorderLeft extends Border{}BorderLeft.TAG="LEFTBORDER";class BorderRight extends Border{}BorderRight.TAG="RIGHTBORDER";class BorderTop extends Border{}BorderTop.TAG="TOPBORDER";class BorderBottom extends Border{}BorderBottom.TAG="BOTTOMBORDER";class BorderDiagonal extends Border{}BorderDiagonal.TAG="DIAGONAL";const DEF_BORDER={style:"solid",color:"rgb(0,0,0)"};class BorderFill extends HWPElement{constructor(){super(...arguments),this._leftBorder=new BorderLeft,this._rightBorder=new BorderRight,this._topBorder=new BorderTop,this._bottomBorder=new BorderBottom,this._diagonal=new BorderDiagonal,this.ThreeD=!1,this.Shadow=!1,this.Slash=0,this.BackSlash=0,this.CrookedSlash=0,this.CounterSlash=0,this.CounterBackSlash=0,this.BreakCellSeparateLine=0,this.$_borders=[this._leftBorder,this._rightBorder,this._topBorder,this._bottomBorder,this._diagonal]}setSimple(e,t="0.12mm"){return this.$_borders.forEach((i=>{i.Type=e,i.Width=t})),this}setFill(e,t){let i=this._fillBrush;return i||(i=this._fillBrush=new HWPFillBrush),i.setColor(e,t),this}sameFill(e,t){return this._fillBrush&&this._fillBrush.sameWithColor(e,t)}setBorders(e){return e.left&&this._leftBorder.setStyles(e.left),e.right&&this._rightBorder.setStyles(e.right),e.top&&this._topBorder.setStyles(e.top),e.bottom&&this._bottomBorder.setStyles(e.bottom),this}sameBorders(e){return!!this._leftBorder.sameWithStyles(e.left||DEF_BORDER)&&(!!this._rightBorder.sameWithStyles(e.right||DEF_BORDER)&&(!!this._topBorder.sameWithStyles(e.top||DEF_BORDER)&&!!this._bottomBorder.sameWithStyles(e.bottom||DEF_BORDER)))}}BorderFill.TAG="BORDERFILL";class BorderFillList extends HWPListElement{constructor(){super(),this._fills=[],this.Count=0,this.addSimple(HWPLineType1.None,"0.1mm"),this.addSimple(HWPLineType1.Solid,"0.12mm")}addSimple(e,t="0.12mm"){const i=new BorderFill;return i.setSimple(e,t),i.Id=++this.Count,this._fills.push(i),i}findByFill(e,t){for(let i of this._fills)if(i.sameFill(e,t))return i}findByBorders(e){for(let t of this._fills)if(t.sameBorders(e))return t}findByCell(e,t){for(let i of this._fills)if(i.sameFill(e,1)&&i.sameBorders(t))return i}getByFill(e,t){let i=this.findByFill(e,t);return i||(i=(new BorderFill).setFill(e,t),i.Id=++this.Count,this._fills.push(i)),i.Id}getByBorders(e){let t=this.findByBorders(e);return t||(t=(new BorderFill).setBorders(e),t.Id=++this.Count,this._fills.push(t)),t.Id}getByCell(e,t){let i=this.findByCell(e,t);return i||(i=(new BorderFill).setFill(e,1).setBorders(t),i.Id=++this.Count,this._fills.push(i)),i.Id}get count(){return this.Count}}BorderFillList.TAG="BORDERFILLLIST";class FontId extends HWPElement{constructor(){super(...arguments),this.Hangul=0,this.Latin=0,this.Hanja=0,this.Japanese=0,this.Other=0,this.Symbol=0,this.User=0}static create(e){return(new FontId).setId(e)}setId(e){return this.Hangul=this.Latin=this.Hanja=this.Japanese=this.Other=this.Symbol=this.User=e,this}}FontId.TAG="FONTID";class Ratio extends HWPElement{constructor(){super(...arguments),this.Hangul=100,this.Latin=100,this.Hanja=100,this.Japanese=100,this.Other=100,this.Symbol=100,this.User=100}static create(e){const t=new Ratio;return t.Hangul=t.Latin=t.Hanja=t.Japanese=t.Other=t.Symbol=t.User=e,t}}Ratio.TAG="RATIO";class CharSpacing extends HWPElement{constructor(){super(...arguments),this.Hangul=0,this.Latin=0,this.Hanja=0,this.Japanese=0,this.Other=0,this.Symbol=0,this.User=0}static create(e){const t=new CharSpacing;return t.Hangul=t.Latin=t.Hanja=t.Japanese=t.Other=t.Symbol=t.User=e,t}}CharSpacing.TAG="CHARSPACING";class RelSize extends HWPElement{constructor(){super(...arguments),this.Hangul=100,this.Latin=100,this.Hanja=100,this.Japanese=100,this.Other=100,this.Symbol=100,this.User=100}static create(e){const t=new RelSize;return t.Hangul=t.Latin=t.Hanja=t.Japanese=t.Other=t.Symbol=t.User=e,t}}RelSize.TAG="RELSIZE";class CharOffset extends HWPElement{constructor(){super(...arguments),this.Hangul=0,this.Latin=0,this.Hanja=0,this.Japanese=0,this.Other=0,this.Symbol=0,this.User=0}static create(e){const t=new CharOffset;return t.Hangul=t.Latin=t.Hanja=t.Japanese=t.Other=t.Symbol=t.User=e,t}}CharOffset.TAG="CHAROFFSET";class Italic extends HWPElement{}Italic.TAG="ITALIC";class Bold extends HWPElement{}Bold.TAG="BOLD";class Underline extends HWPElement{constructor(){super(...arguments),this.Type="Bottom",this.Shape=HWPLineType2.Solid,this.Color=0}}Underline.TAG="UNDERLINE";class Strikeout extends HWPElement{constructor(){super(...arguments),this.Type="Continuous",this.Shape=HWPLineType2.Solid,this.Color=0}}Strikeout.TAG="STRIKEOUT";class Outline extends HWPElement{constructor(){super(...arguments),this.Type=HWPLineType3.Solid}}Outline.TAG="OUTLINE";class Emboss extends HWPElement{}Emboss.TAG="EMBOSS";class Engrave extends HWPElement{}Engrave.TAG="ENGRAVE";class Superscript extends HWPElement{}Superscript.TAG="SUPERSCRIPT";class Subscript extends HWPElement{}Subscript.TAG="SUBSCRIPT";class CharShape extends HWPElement{constructor(){super(...arguments),this.Height=1e3,this.TextColor=0,this.ShadeColor=4294967295,this.UseFontSpace=!1,this.UseKerning=!1,this.SymMark=0}static createSimple(e,t,i,r,s,n){const o=new CharShape;return o.Height=Math.round(100*t),o.TextColor=i,o._fontId=FontId.create(e),o._ratio=Ratio.create(100),o._charSpacing=CharSpacing.create(0),o._relSize=RelSize.create(100),o._charOffset=CharOffset.create(0),r&&(o._bold=new Bold),s&&(o._italic=new Italic),n&&(o._underline=new Underline),o}same(e,t,i,r,s,n){return this._fontId.Hangul===e&&Math.round(this.Height/100)===t&&this.TextColor===i&&(!(r&&!this._bold)&&(s===!!this._italic&&n===!!this._underline))}}CharShape.TAG="CHARSHAPE";class CharShapeList extends HWPListElement{constructor(){super(...arguments),this._charShapes=[],this.Count=0}add(e,t,i,r,s,n){let o;for(let a of this._charShapes)if(a.same(e,t,i,r,s,n)){o=a;break}return o||(o=CharShape.createSimple(e,t,i,r,s,n),o.Id=this.Count++,this._charShapes.push(o)),o.Id}get(e){return this._charShapes[e]}get count(){return this.Count}}CharShapeList.TAG="CHARSHAPELIST";class TabItem extends HWPElement{constructor(){super(...arguments),this.Type="Left",this.Leader=HWPLineType2.Solid}}TabItem.TAG="TABITEM";class TabDef extends HWPElement{constructor(){super(...arguments),this.AutoTabLeft=!1,this.AutoTabRight=!1}}TabDef.TAG="TABDEF";class TabDefList extends HWPListElement{constructor(){super(...arguments),this._defs=[],this.Count=0}add(e){return this._defs.push(e),e.Id=this.Count++}addDef(e,t){const i=new TabDef;return i.AutoTabLeft=e,i.AutoTabRight=t,this.add(i),i}get(e){return this._defs[e]}get count(){return this.Count}}TabDefList.TAG="TABLELIST";class ParaHead extends HWPElement{constructor(){super(...arguments),this.Alignment="Left",this.UseInstWidth=!0,this.AutoIndent=!0,this.WidthAdjust=0,this.TextOffsetType="percent",this.TextOffset=50,this.NumFormat=HWPNumberType1.Digit}}ParaHead.TAG="PARAHEAD";class Numbering extends HWPElement{constructor(){super(...arguments),this._paraheads=[],this.Start=0}}Numbering.TAG="NUMBERING";class NumberingList extends HWPListElement{constructor(){super(...arguments),this._numberings=[],this.Count=0}get count(){return this.Count}}NumberingList.TAG="NUMBERINGLIST";class Bullet extends HWPElement{constructor(){super(...arguments),this.Image=!1}}Bullet.TAG="BULLET";class BulletList extends HWPListElement{constructor(){super(...arguments),this._bullets=[],this.Count=0}get count(){return this.Count}}BulletList.TAG="BULLETLIST";class ParaBorder extends HWPElement{constructor(){super(...arguments),this.Connect=!1,this.IgnoreMargin=!1}}ParaBorder.TAG="PARABORDER";class ParaMargin extends HWPElement{constructor(){super(...arguments),this.Indent=0,this.Left=0,this.Right=0,this.Prev=0,this.Mext=0,this.LineSpacingType="Percent",this.LineSpacing=130}}ParaMargin.TAG="PARAMARGIN";class ParaShape extends HWPElement{constructor(){super(...arguments),this.Align=HWPAlignmentType1.Justify,this.VertAlign="Baseline",this.HeadingType="None",this.Level=0,this.BreakLatinWord="KeepWord",this.BreakNonLatinWord=!0,this.Condense=0,this.WindowOrphan=!1,this.KeepWithNext=!1,this.KeepLines=!1,this.PageBreakBefore=!1,this.FontLineHeight=!1,this.SnapToGrid=!0,this.LineWrap=HWPLineWrapType.Break,this.AutoSpaceEAsianEng=!0,this.AutoSpaceEAsianNum=!0}static create(e,t,i){const r=new ParaShape(i);return r._margin=e,r._border=t,r}sameWith(){return!1}}ParaShape.TAG="PARASHAPE";class ParaShapeList extends HWPListElement{constructor(){super(),this._shapes=[],this.Count=0,this.add(HWPAlignmentType1.Left)}get(e){return this._shapes[e]}add(e){for(let t of this._shapes)if(t.Align===e)return t;const t=new ParaShape;return t.Id=this.Count++,t.Align=e,this._shapes.push(t),t}addWrap(){if(!this._wrap){const e=this._wrap=ParaShape.create(new ParaMargin,null,null);e.Id=this.Count++,e.Align=HWPAlignmentType1.Center,this._shapes.push(e)}return this._wrap}get count(){return this.Count}}ParaShapeList.TAG="PARASHAPELIST";class Style extends HWPElement{constructor(){super(...arguments),this.Id=-1,this.Type="Para"}}Style.TAG="STYLE";class StyleList extends HWPListElement{constructor(){super(...arguments),this._styles=[],this.Count=0}add(e){return this._styles.push(e),e.Id=this.Count++}get count(){return this.Count}}StyleList.TAG="STYLELIST";class Memo extends HWPElement{constructor(){super(...arguments),this.Width=0}}Memo.TAG="MEMO";class MemoShapeList extends HWPListElement{constructor(){super(...arguments),this._memos=[],this.Count=0}get count(){return this.Count}}MemoShapeList.TAG="MEMOSHAPELIST";class MappingTable extends HWPElement{constructor(){super(),this._binDataList=new BinDataList,this._faceNameList=new FaceNameList,this._borderFillList=new BorderFillList,this._charShapeList=new CharShapeList,this._tabDefList=new TabDefList,this._numberingList=new NumberingList,this._bulletList=new BulletList,this._paraShapeList=new ParaShapeList,this._styleList=new StyleList,this._memoShapeList=new MemoShapeList}get borderFillList(){return this._borderFillList}get charShapeList(){return this._charShapeList}get paraShapeList(){return this._paraShapeList}addBin(e,t){this._binDataList.add(e,t)}}MappingTable.TAG="MAPPINGTABLE";class HWPHead extends HWPElement{constructor(){super(),this._docSummary=new DocSummary,this._docSetting=new DocSetting,this._mappingTable=new MappingTable}get docSummary(){return this._docSummary}get docSetting(){return this._docSetting}get mappingTable(){return this._mappingTable}addBin(e,t){this._mappingTable.addBin(e,t)}addCharShape(e,t,i,r,s,n){return this._mappingTable.charShapeList.add(e,t,i,r,s,n)}addParaShape(e){return this._mappingTable.paraShapeList.add(e).Id}addParaShapeWrap(){return this._mappingTable.paraShapeList.addWrap().Id}}HWPHead.TAG="HEAD";class Section extends HWPElement{constructor(){super(...arguments),this._paras=[]}addPara(e=!1){const t=new HWPPara;return e&&t.addText(!1,!1),this._paras.push(t),t}}Section.TAG="SECTION";class HWPBody extends HWPElement{constructor(){super(),this._sections=[];const e=new Section;e.Id=0,this._sections.push(e)}get section(){return this._sections[0]}}HWPBody.TAG="BODY";class BinData extends HWPElement{constructor(){super(...arguments),this.Encoding="Base64"}get text(){return this._text}}BinData.TAG="BINDATA";class BinDataStorage extends HWPElement{constructor(){super(...arguments),this._data=[]}addImage(e,t){const i=new BinData;return i.Id=e,i.Size=t.length,i._text=t,this._data.push(i),i}}BinDataStorage.TAG="BINDATASTORAGE";class HWPTail extends HWPElement{constructor(){super(...arguments),this._bindDataStorage=new BinDataStorage}getBinData(e){return this._bindDataStorage[e]}addImageBin(e,t){return this._bindDataStorage.addImage(e,t)}}HWPTail.TAG="TAIL";class HWPFile{constructor(e=!1){this._imgId=1,this._imgMap={},this.debug=e,this._imageLoader=new ImageLoader,this._root=new HWPRoot}static write(e,t,i){const{elements:r,attrs:s}=t.getContent();for(let t in s)e.setAttr(i,t,s[t]);const n=t.text;n&&e.setValue(i,n);for(let t of r)if(!(t instanceof HWPListElement)||t.count>0){const r=e.addChild(i,t.tag);this.write(e,t,r)}}static toXml(e){const t=new XmlDoc({tag:e.tag});return this.write(t,e,t.root),t.toString()}get body(){return this._root.body}get head(){return this._root.head}get tail(){return this._root.tail}addImage(e,t){let i=this._imgMap[e];if(!i){e.indexOf("base64,")<0&&this._imageLoader.add(e,t),i=this._imgMap[e]=String(this._imgId++)}return+i}getBorderFillByColor(e,t){return this.head.mappingTable.borderFillList.getByFill(e,t)}getBorderFillByBorders(e){return this.head.mappingTable.borderFillList.getByBorders(e)}getBorderFillByCell(e,t){return this.head.mappingTable.borderFillList.getByCell(e,t)}getCharShape(e){const t=e instanceof HTMLElement?getComputedStyle(e):e,i=HWPTextElement.getFontSize(t.fontSize),r=HWPTextElement.getColor(t.color),s=HWPTextElement.getFontBold(t.fontWeight),n="italic"===t.fontStyle,o=t.textDecoration.indexOf("underline")>=0;return this.addCharShape(0,i,r,s,n,o)}addCharShape(e,t,i,r,s,n){return this._root.head.addCharShape(e,t,i,r,s,n)}prepare(e){return this._imageLoader.load(e)}canExport(){return this._imageLoader.loaded}toXml(){const e=this._root,t=new XmlDoc({tag:"HWPML",attrs:{Version:"2.1"}});for(let t in this._imgMap){const i=+this._imgMap[t];let r;r=this._imageLoader.get(t)||t;let s=r.indexOf("base64,");s>=0&&(r=r.substring(s+7)),e.addImageBin(i,"png",r)}return HWPFile.write(t,e,t.root),t}setPageDiv(e){return e!==this._pageDiv&&(this._pageDiv=e,this._pageRect=e.getBoundingClientRect()),this}getDomBounds(e){const t=e.getBoundingClientRect();return t.x-=this._pageRect.x,t.y-=this._pageRect.y,t}getTextBounds(e){const t=Utils.getTextRect(e);return t.x-=this._pageRect.x,t.y-=this._pageRect.y,t}}class HWPExporter{constructor(){}export(e,t,i){if("function"!=typeof i)return;const r=()=>{if(n.canExport()||n.prepare(s)){const e=n.toXml().toString(),t=(new TextEncoder).encode(e);null==i||i(t)}else setTimeout((()=>{r()}),300)},s=5,n=this.$_build(e,t);r()}$_build(e,t){const i=new HWPFile(!0);if(t){(new HWPBuilder).build(e,t,i)}return i}}class OutlineModel extends EventAware{constructor(e){super(),this._root=new OutlineRootItem(this),e&&(this.source=e)}_doDispose(){this._source&&this._source.removeListener(this),this._source=null,super._doDispose()}get source(){return this._source}set source(e){this._source=e,this.$_build(e),this._fireSourceChanged()}get root(){return this._root}get page(){return this._root.page}isRoot(e){return e===this._root}findItem(e){return e===this._root.source?this._root:this._root.itemOf(e,!0)}$_build(e){this._source&&this._source.removeListener(this),this._source=e,this._root.load(e),e.addListener(this)}onReportItemAdded(e,t,i){const r=this._root.itemOf(t.outlineParent);t instanceof CellGroup&&(t=t.item);const s=new OutlineReportItem(t);i<0&&(i=r.count),r.add(s,i),this._fireItemAdded(s,i)}onReportItemsAdded(e,t,i){const r=this._root.itemOf(t[0].outlineParent),s=[];i<0&&(i=r.count);for(let e=0;e<t.length;e++){let n=t[e];n instanceof CellGroup&&(n=n.item);const o=new OutlineReportItem(n);r.add(o,i+e),s.push(o)}this._fireItemsAdded(s,i)}onReportItemRemoved(e,t,i){t instanceof CellGroup&&(t=t.item);const r=this._root.itemOf(t);r&&(this._fireItemRemoved(r),r.delete())}onReportItemsRemoved(e,t){const i=[];for(let e=t.length-1;e>=0;e--){const r=t[e],s=this._root.itemOf(r);s&&i.push(s)}this._fireItemsRemoved(i);for(let e of i)e.delete()}onReportItemChanged(e,t,i,r,s){const n=this._root.itemOf(t);n&&this._fireItemChanged(n)}onReportCollectionChanged(e,t){const i=this._root.itemOf(t);i&&this._fireChildIndexChanged(i)}_fireSourceChanged(){this.fireEvent(OutlineModel.SOURCE_CHANGED)}_fireItemAdded(e,t){this.fireEvent(OutlineModel.ITEM_ADDED,e,t)}_fireItemsAdded(e,t){this.fireEvent(OutlineModel.ITEMS_ADDED,e,t)}_fireItemRemoved(e){this.fireEvent(OutlineModel.ITEM_REMOVED,e)}_fireItemsRemoved(e){this.fireEvent(OutlineModel.ITEMS_REMOVED,e)}_fireItemChanged(e){this.fireEvent(OutlineModel.ITEM_CHANGED,e)}_fireChildIndexChanged(e){this.fireEvent(OutlineModel.CHILDE_INDEX_CHANGED,e)}}OutlineModel.SOURCE_CHANGED="onOutlineSourceChanged",OutlineModel.ITEM_ADDED="onOutlineItemAdded",OutlineModel.ITEMS_ADDED="onOutlineItemsAdded",OutlineModel.ITEM_REMOVED="onOutlineItemRemoved",OutlineModel.ITEMS_REMOVED="onOutlineItemsRemoved",OutlineModel.ITEM_CHANGED="onOutlineItemChanged",OutlineModel.CHILDE_INDEX_CHANGED="onOutlineChildIndexChanged";class OutlineItem extends Base{constructor(){super()}get source(){}get count(){return this._children?this._children.length:0}get displayText(){return this.source.outlineLabel}get expandable(){return this.source.outlineExpandable}get removable(){return this.source.canRemoveFrom()}get(e){return this._children[e]}getSourceType(){return this.source.getSaveType()}itemOf(e,t=!0){if(this._children)for(let i of this._children){if(i.source===e)return i;if(t){const t=i.itemOf(e,!0);if(t)return t}}}add(e,t=-1){this._addItem(e,t)}clear(){this._clear()}delete(){this.removable&&this.parent._removeItem(this)}_attached(e){}_detached(){}_clear(){if(this._children){for(let e of this._children)e._detached();this._children=null}}_addItem(e,t=-1){assert(!!e);const i=this._children=this._children||[];assert(i.indexOf(e)<0),t<0?i.push(e):i.splice(t,0,e),e._attached(this)}_removeItem(e){if(e&&e.removable&&this._children){const t=this._children.indexOf(e);t>=0&&(this._children.splice(t,1),e._detached())}}_sortByOrder(){this._children&&(this._children=this._children.sort(((e,t)=>e.source.outlineOrder-t.source.outlineOrder)))}}class OutlineRootItem extends OutlineItem{constructor(e){super(),this._model=e}get page(){return this._page}load(e){this._clear(),this._addItem(this._page=new OutlineReportItem(e.page))}get outline(){return this._model}get source(){return this._page.source.outlineParent}get parent(){return null}get displayText(){return"Report"}get expandable(){return!0}getSourceType(){return"report"}_clear(){super._clear(),this._page=null}}class OutlineReportItem extends OutlineItem{constructor(e){super(),assert(!!e),this._load(this._source=e)}load(){this._load(this._source)}get outline(){return this._parent&&this._parent.outline}get parent(){return this._parent}get source(){return this._source}_attached(e){this._parent=e,super._attached(e)}_detached(){this._parent=null,super._detached()}_load(e){const t=e.outlineItems;if(t){for(let e of t){e instanceof CellGroup&&(e=e.item);const t=new OutlineReportItem(e);this._addItem(t)}this._sortByOrder()}}}class OutlineElement extends VisualElement{constructor(e,t){super(e,t)}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}measure(e,t){const i=this._doMeasure(e,t);return this._measuredWidth=i.width,this._measuredHeight=i.height,i}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(e){}_doMeasure(e,t){return new Size(e,t)}_doLayoutContent(){}}class OutlineRowElement extends OutlineElement{constructor(e,t){super(e,"outlineRowView"),this._expanded=!1,this._vindex=-1,this._focused=!1,this._selected=!1,this._model=t}_doDispose(){super._doDispose()}get model(){return this._model}set model(e){e!==this._model&&(this._model=e)}get parentRow(){return this._parentRow}get level(){return this._parentRow?this._parentRow.level+1:1}get rows(){return this._childRows&&this._childRows.slice()}get rowCount(){return this._childRows?this._childRows.length:0}get expanded(){return this._expanded}set expanded(e){e!=this._expanded&&(this._expanded=e)}get vindex(){return this._vindex}get focused(){return this._focused}get selected(){return this._selected}getChildRow(e){return this._childRows[e]}addChildRow(e,t){return this._childRows||(this._childRows=[]),t=t<0?this._childRows.length:t,this._childRows.splice(t,0,e),e._parentRow=this,t}removeChildRow(e){if(e&&this._childRows){const t=this._childRows.indexOf(e);t>=0&&(this._childRows.splice(t,1),e.clearChildRows())}}clearChildRows(){if(this._childRows){for(let e of this._childRows)e.clearChildRows();this._childRows=null}this._parentRow=null}setFocused(e){e!=this._focused&&(this._focused=e,this.invalidate())}setSelected(e){e!=this._selected&&(this._selected=e,this.invalidate())}_getCssSelector(){let e="rr-outline-row";return this._focused?e+=" rr-outline-row-focus":this._selected&&(e+=" rr-outline-row-select"),e}_getCssDisplay(){return"flex"}_isEmptySize(){return!0}_initDom(e,t){super._initDom(e,t),t.appendChild(this._spanIndent=e.createElement("span")),t.appendChild(this._spanExpander=e.createElement("span")),t.appendChild(this._spanText=e.createElement("span")),this._spanText.className="rr-outline-label"}_doDraw(e){}_doMeasure(e,t){const i=this.model.getSourceType();i?this._dom.dataset.type=i:delete this._dom.dataset.type,this._spanIndent.style.minWidth=8+OutlineRowElement.INDENT_SIZE*(this.level-1)+"px";let r="";return r=this._model.expandable&&this._childRows&&this._childRows.length>0?this.expanded?"rr-outline-expander rr-outline-expander-expanded":"rr-outline-expander rr-outline-expander-collapsed":"rr-outline-expander",this._spanExpander.className=r,this._spanExpander.$_rvu=this.vindex,this._spanText.textContent=this._model.displayText,new Size(300,25)}_doLayoutContent(){}}OutlineRowElement.INDENT_SIZE=10;class OutlineBodyView extends OutlineElement{constructor(e){super(e.doc,"outlineBodyView"),this._visibleRows=[],this._rows=[],this._rowPool=[],this._rowPoints=[0],this._viewer=e}_doDispose(){super._doDispose()}get visibleRowCount(){return this._visibleRows.length}get rowCount(){return this._rows.length}get focusedRow(){return this._focusedRow}get contentHeight(){return this._rowPoints[this._rowPoints.length-1]}get contentWidth(){return this.width}getVisible(e){return this._visibleRows[e]}getVisibleItems(e=0,t=-1){const i=this._visibleRows;if(e=Math.max(0,e),(t=t<0?i.length=1:Math.min(t,i.length-1))<e){const i=e;e=t,t=i}const r=[];for(let s=e;s<=t;s++)r.push(i[s].model);return r}findVisibleRow(e){return this.$_findRow(this._visibleRows,e)}findRow(e){return this.$_findRow(this._rows,e)}loadRows(e){if(this.clear(),!e)return;let t=this._root=this.$_borrowRow(e.root);this._rows.push(t),this._visibleRows.push(t),this.addChild(t),this.$_loadRows(t)}refreshChildren(e){this.findRow(e)&&(this.removeChildren(e),e.clear(),e.load(),this.addChildren(e))}addRow(e,t){let i=this.findRow(e.parent);if(i){const r=this.$_borrowRow(e);if(t=i.addChildRow(r,t),i=this.findVisibleRow(i.model),i&&i.expanded){const e=i.level,s=this._visibleRows,n=s.indexOf(i);let o=n+1;if(t>0)for(let r=n+1,a=s.length;r<a;r++){const n=s[r];if(n.parentRow==i){if(0==--t){for(;s[r].level>e;)r++;o=r;break}}else if(n.level<=e){o=r-1;break}}s.splice(o,0,r)}this.addChild(r),this._rows.push(r),this.invalidateLayout();for(let t=0;t<e.count;t++)this.addRow(e.get(t),t)}}addChildren(e){for(let t=0;t<e.count;t++)this.addRow(e.get(t),t)}removeChildren(e){for(let t=e.count-1;t>=0;t--)this.removeRow(e.get(t))}removeRow(e){for(let t=0;t<e.count;t++)this.removeRow(e.get(t));let t=this.findRow(e.parent);if(t){let i=this.findRow(e);if(i){t.removeChildRow(i);let r=this._rows.indexOf(i);this._rows.splice(r,1);const s=this.findVisibleRow(e);if(s){const e=this._visibleRows,t=e.indexOf(s);e.splice(t,1)}this.removeChild(i),this.$_returnRow(i),this.invalidateLayout()}}}removeRows(e){for(let t of e)this.removeRow(t)}expand(e,t=0){if((e=e||this._root)&&!e.expanded){const i=this._visibleRows,r=i.indexOf(e)+1;assert(r>0);const s=[];let n=0;e.expanded=!0,this.$_collectVisibleRows(e,s,t);for(let e of s)i.splice(r+n,0,s[n]),n++;this.invalidateLayout()}}expandAll(e){this.collapseAll(e),this.expand(e,Number.MAX_SAFE_INTEGER)}collapse(e,t=!1){if((e=e||this._root)&&e.expanded){const i=this.$_hideRows(e,t),r=this._visibleRows.indexOf(e)+1;this._visibleRows.splice(r,i),e.expanded=!1,this.invalidateLayout()}}collapseAll(e){this.collapse(e,!0)}collapseShort(){this.collapseAll(),this.expand(),this.expand(this._root.getChildRow(0))}isVisible(e){for(let t of this._visibleRows)if(t.model===e)return!0}makeVisible(e){const t=this.findRow(e);if(!t||t.vindex>=0)return;let i=t.parentRow,r=0;for(;i;){if(i.vindex>=0){this.expand(i,r);break}i=i.parentRow,r++}}isExpander(e){return e.classList.contains("rr-outline-expander")}rowByExpander(e){return this.getVisible(e.$_rvu)}rowOf(e){let t=e;for(;t;){if(t.classList.contains("rr-outline-row"))for(let e of this._visibleRows)if(e.isDom(t))return e;t=t.parentElement}}getNextVisible(e){const t=this._visibleRows;if(e){const i=e.vindex;return i<t.length-1?t[i+1]:e}return t.length>0?t[0]:null}getPrevVisible(e){const t=this._visibleRows;if(e){const i=e.vindex;return i>0?t[i-1]:e}return t.length>0?t[0]:null}getNextPageVisible(e){if(!e)return this.getNextVisible(e);const t=this._visibleRows,i=this._rowPoints;let r=this.getBoundingRect().height,s=t.length,n=e.vindex;for(;n<s&&(r-=i[n+1]-i[n],!(r<=0));)n++;return t[Math.min(s-1,n)]}getPrevPageVisible(e){if(!e)return this.getPrevVisible(e);const t=this._visibleRows,i=this._rowPoints;let r=this.getBoundingRect().height,s=e.vindex;for(;s>=0&&(r-=i[s+1]-i[s],!(r<=0));)s--;return t[Math.max(0,s)]}get isLayer(){return!0}_getCssSelector(){return"rr-outline-body"}_setSizeStyle(e){}_initDom(e,t){super._initDom(e,t);const i=t.style;i.width="100%",i.height="100%",i.overflow="auto"}clear(){if(super.clear()){for(let e of this._rows)this.$_returnRow(e,!0);return this._rows=[],this._visibleRows=[],!0}}findChildAt(e,t,i,r){return t+=this._dom.scrollTop,super.findChildAt(e,t,i,r)}_doMeasure(e,t){const i=this._viewer;var r=this._rowPoints=[0];this._focusedRow=null;for(let e of this._rows)e.visible=!1,e._vindex=-1,e.setFocused(!1);for(let s=0;s<this._visibleRows.length;s++){const n=this._visibleRows[s],o=n.model;n.visible=!0,n._vindex=s,!this._focusedRow&&i.isFocused(o)&&(n.setFocused(!0),this._focusedRow=n),n.setSelected(i.isSelected(o)),n.measure(e,t),r.push(r[s]+n.measuredHeight)}return new Size(e,r[r.length-1])}scrollToFocused(e,t){const i=this._focusedRow;if(i){const r=this._rowPoints,s=i.vindex;r[s]<e?e=r[s]+(s>0?(r[s-1]-r[s])/2:0):r[s+1]-e>=t&&(e=r[s+1]-t+(s<r.length-1?(r[s+1]-r[s])/2:0))}return e}_doLayoutContent(){const e=this._rowPoints;for(let t=0;t<this._visibleRows.length;t++){const i=this._visibleRows[t];i.move(0,e[t]-0),i.layoutContent()}}$_borrowRow(e){if(this._rowPool.length>0){const t=this._rowPool.pop();return t.model=e,t.expanded=!1,t.invalidate(),t}return new OutlineRowElement(this.doc,e)}$_returnRow(e,t=!1){e&&(t||this._rowPool.indexOf(e)<0)&&(e.clearChildRows(),this._rowPool.push(e),e.validate())}$_loadRows(e){const t=e.model;for(let i=0;i<t.count;i++){const r=t.get(i),s=this.$_borrowRow(r);this._rows.push(s),this.addChild(s),e.addChildRow(s,i),this.$_loadRows(s)}}$_findRow(e,t){if(e)for(let i of e)if(i.model===t)return i}$_collectVisibleRows(e,t,i){for(let r=0;r<e.rowCount;r++){const s=e.getChildRow(r);t.push(s),(s.expanded||i>0)&&(s.expanded=!0,this.$_collectVisibleRows(s,t,i-1))}}$_hideRows(e,t){let i=0;i+=e.rowCount;for(let r=0;r<e.rowCount;r++){const s=e.getChildRow(r);(s.expanded||t)&&(s.expanded=!1,i+=this.$_hideRows(s,t))}return i}}class OutlineSelectionTool extends VisualTool{constructor(e){super(e,"outlineSelectionTool"),this._viewer=e}_doDispose(){this._viewer=null,super._doDispose()}get viewer(){return this._viewer}_doMouseDown(e){const t=this.mouseEventTarget,i=this._viewer,r=i.bodyView,s=this._clickedRow=r.rowOf(t);return s&&r.isExpander(t)&&(s.expanded?i.collapse(s):i.expand(s)),!0}_doMouseMove(e){}_doMouseUp(e){}_doClick(e,t,i){const r=e.ctrlKey||e.metaKey,s=e.shiftKey,n=this.mouseEventTarget,o=this._viewer,a=o.bodyView,A=a.rowOf(n);if(!a.isExpander(n)&&A&&A===this._clickedRow){const e=A.model;if(r)o.toggleSelect(e),o.focusedItem||(o.focusedItem=e);else if(s){const t=o.lastSelectedItem;if(t){const e=o.bodyView.findVisibleRow(t),i=o.bodyView.getVisibleItems(e.vindex,A.vindex);o.selectAll(i)}else o.select(e);o.focusedItem||(o.focusedItem=e)}else o.clearSelection(e),o.focusedItem=e;o.focusedItem||(o.focusedItem=e)}}_doDblClick(e){const t=this.mouseEventTarget,i=this._viewer,r=i.bodyView.rowOf(t);r&&r===this._clickedRow&&(r.model.expandable?r.expanded?i.collapse(r):i.expand(r):i._fireDoubleClicked(r.model))}_doMouseWheel(e){const t=this._viewer;if(e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY))return!0;{const i=t.topPos;return t.topPos=i+e.deltaY,!0}}_doMouseEnter(e){}_doMouseLeave(e){}_doMouseOver(e){}_doContextMenu(e){return!1}_doKeyDown(e){const t=e.keyCode,i=this._viewer,r=i.bodyView,s=r.focusedRow,n=i.focusedItem;switch(t){case 40:i.setFocusedRow(r.getNextVisible(s));break;case 38:i.setFocusedRow(r.getPrevVisible(s));break;case 34:i.setFocusedRow(r.getNextPageVisible(s));break;case 33:i.setFocusedRow(r.getPrevPageVisible(s));break;case 36:i.setFocusedRow(r.getVisible(0));break;case 35:i.setFocusedRow(r.getVisible(r.visibleRowCount-1));break;case 37:s&&(s.expanded?r.collapse(s):s.parent&&r.isVisible(n.parent)&&(i.focusedItem=n.parent));break;case 39:s&&(s.expanded?n.count>0&&(i.focusedItem=n.get(0)):r.expand(s))}return super._doKeyDown(e)}_doKeyPress(e){return!1}_doKeyUp(e){return!1}$_findRowView(e){}}class Selections$2{constructor(){this._items=[]}get items(){return this._items.length>0?this._items.slice():null}get last(){return this._items.length>0?this._items[this._items.length-1]:null}contains(e){return e&&this._items.indexOf(e)>=0}clear(){if(this._items.length>0)return this._items=[],!0}add(e){if(e&&this._items.indexOf(e)<0)return this._items.push(e),!0}addAll(e){if(e&&e.length>0){let t=!1;for(let i of e)this._items.indexOf(i)<0&&(this._items.push(i),t=!0);return t}}remove(e){if(e){const t=this._items.indexOf(e);if(t>=0)return this._items.splice(t,1),!0}}}class OutlineViewer extends VisualContainer{constructor(e){super(e),this._selections=new Selections$2,this._focusRequested=!1,this.addElement(this._bodyView=new OutlineBodyView(this))}_doDispose(){super._doDispose()}onOutlineSourceChanged(e){this._bodyView.loadRows(this.model),this.invalidateLayout()}onOutlineItemAdded(e,t,i){this._bodyView.addRow(t,i),this.invalidateLayout()}onOutlineItemsAdded(e,t,i){for(let e=0;e<t.length;e++)this._bodyView.addRow(t[e],i+e);this.invalidateLayout()}onOutlineItemRemoved(e,t){this._bodyView.removeRow(t),this.invalidateLayout()}onOutlineItemsRemoved(e,t){this._bodyView.removeRows(t),this.invalidateLayout()}onOutlineItemChanged(e,t){this.invalidateLayout()}onOutlineChildIndexChanged(e,t){t instanceof OutlineReportItem&&this._bodyView.refreshChildren(t)}get model(){return this._model}set model(e){e!==this._model&&(this._model&&this._model.removeListener(this),this._model=e,this._bodyView.loadRows(e),this.invalidateLayout(),this._model&&this._model.addListener(this))}get bodyView(){return this._bodyView}get topPos(){return this._bodyView.scrollTop}set topPos(e){(e=Math.max(0,Math.min(this._bodyView.contentHeight-this.getBound().height,e)))!=this.topPos&&this._bodyView.scrollDom(this.leftPos,e)}get leftPos(){return this._bodyView.scrollLeft}set leftPos(e){(e=Math.max(0,Math.min(this._bodyView.contentWidth-this.getBound().width,e)))!=this.leftPos&&this._bodyView.scrollDom(e,this.topPos)}get focusedItem(){return this._focusedItem}set focusedItem(e){const t=this._focusedItem;this.changeFocus(e)&&this._fireFocusedChanged(e,t)}changeFocus(e){if(e!==this._focusedItem)return this._focusedItem=e,this.invalidateLayout(),this.clearSelection(),this._focusRequested=!0,this._bodyView.makeVisible(e),!0}get selection(){return this._selections.items}get lastSelectedItem(){return this._selections.last}expand(e){e&&!e.model.expandable||this._bodyView.expand(e)}expandAll(e){e&&!e.model.expandable||this._bodyView.expandAll(e)}collapse(e){e&&!e.model.expandable||this._bodyView.collapse(e)}collapseAll(e){e&&!e.model.expandable||this._bodyView.collapseAll(e)}collapseShort(){this._bodyView.collapseShort()}clearSelection(e){const t=this._selections.clear();(e&&this._selections.add(e)||t)&&this.invalidateLayout()}select(e){this._selections.add(e)&&this.invalidateLayout()}toggleSelect(e){this._selections.contains(e)?this._selections.remove(e):this._selections.add(e),this.invalidateLayout()}selectAll(e){e||(e=this._bodyView.getVisibleItems()),e&&this._selections.addAll(e)&&this.invalidateLayout()}unselect(e){this._selections.remove(e)&&this.invalidateLayout()}setFocusedRow(e){this.focusedItem=e&&e.model}isFocused(e){return this._focusedItem===e}isSelected(e){return this._selections.contains(e)}itemOfDom(e){const t=this._bodyView.rowOf(e);return t&&t.model}_createDefaultTool(){return new OutlineSelectionTool(this)}_doPrepareContainer(e){e.className="rr-outline-root rr-outline"}_doLayout(e){this._bodyView.measure(e.width,e.height),this._bodyView.layoutContent(),this._focusRequested&&(this._focusRequested=!1,this.topPos=this._bodyView.scrollToFocused(this.topPos,e.height))}_fireFocusedChanged(e,t){this.fireEvent(OutlineViewer.FOCUSED_CHANGED,e,t)}_fireDoubleClicked(e){this.fireEvent(OutlineViewer.DOUBLE_CLICKED,e)}}OutlineViewer.FOCUSED_CHANGED="onOutlineFocusedChanged",OutlineViewer.DOUBLE_CLICKED="onOutlineDoubleClicked";class PropertyElement extends VisualElement{constructor(e,t){super(e,t),this._vindex=-1}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}get vindex(){return this._vindex}measure(e,t){const i=this._doMeasure(e,t);return this._measuredWidth=i.width,this._measuredHeight=i.height,i}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(e){}_doMeasure(e,t){return new Size(e,t)}_doLayoutContent(){}}class PropertyLineElement extends PropertyElement{constructor(){super(...arguments),this._level=-1}get isCategory(){return!1}get source(){return this._source}get level(){return this._level}prepareElement(e){this._doPrepareElement(e,this._source)}_getCssDisplay(){return"flex"}_isEmptySize(){return!0}$_setLevel(e,t){this._source=e,this._level=t}}PropertyLineElement.INDENT=8;class PropertyRowElement extends PropertyLineElement{constructor(e,t,i){super(e,t||"propertyRowView"),this._labelWidth=115,this._focused=!1,this._model=i}_doDispose(){super._doDispose()}get model(){return this._model}set model(e){e!==this._model&&(this._model=e)}get labelWidth(){return this._labelWidth}set labelWidth(e){this._labelWidth=e}setFocused(e){e!=this._focused&&(this._focused=e,this.$_setIndentMark(),this.invalidate())}hasFocusEdit(){const e=this._getEdit(null);return e&&this.doc.activeElement===e}select(e,t=!0){e instanceof HTMLInputElement?this._selectEdit(this._getEdit(e),t):e&&e.focus()}clearSelection(){this._clearSelection(this._getEdit(null))}_getCssSelector(){let e="rr-property-line rr-property-row";return this._focused&&(e+=" rr-property-row-focus"),e}_initDom(e,t){super._initDom(e,t),t.appendChild(this._spanIndent=e.createElement("span")),this._spanIndent.style.color="white",t.appendChild(this._spanLabel=e.createElement("span")),this._spanLabel.className="rr-property-row rr-property-row-label",t.appendChild(this._container=e.createElement("div")),this._container.className="rr-property-row rr-property-row-content",this._setClassName(null),this._doInitContainer(e,this._container)}_doDraw(e){}_doMeasure(e,t){const i=PropertyLineElement.INDENT*(this.level-1);return this.$_setIndentMark(),this._spanIndent.style.minWidth=i+12+"px",this._model.prop.type===FunctionProperty?this._spanLabel.textContent=Utils.capitalize(this._model.label):this._spanLabel.textContent=Utils.labelize(this._model.label),this._spanLabel.style.width=this._labelWidth-i+"px",new Size(300,this.offsetHeight)}_doLayoutContent(){}_getPlaceHolder(){return this.source.getPlaceHolder(this._model.prop)||"(Not Defined)"}_getEdit(e){}_selectEdit(e,t){e&&(t||e.selectionEnd===e.selectionStart)&&e.select()}_clearSelection(e){e&&e.selectionStart!==e.selectionEnd&&e.setSelectionRange(e.selectionEnd,e.selectionEnd)}_doUpdateValue(e,t){var i,r;const s=this.container;if(s&&this.source)try{return null===(r=(i=e.prop).validate)||void 0===r||r.call(i,this.source,t),s.updateValue(this.source,e,t),!0}catch(e){this.reset(null),console.error(e),s.showError(this,e)||alert(e)}}_loadText(e){return e}_setText(e,t){const i=this.model.getValue(t);return this._loadText(i),void 0===i||Number.isNaN(i)?e.value="":e.value=this._loadText(i)||"",e.placeholder=this._getPlaceHolder(),e.readOnly=this.model.isReadOnly(t),e.value}$_setIndentMark(){this._focused?this._spanIndent.classList.add("rr-property-indent-mark"):this._spanIndent.classList.remove("rr-property-indent-mark")}}class PropertyCategoryElement extends PropertyLineElement{constructor(e,t){super(e,"propertyCategoryView"),this._expanded=!0,this._model=t}static isCollectionItemDelete(e){return e.className===this.DELETE_CLASS}static isCollectionItemUp(e){return e.className===this.UP_CLASS}static isCollectionItemRight(e){return e.className===this.RIGHT_CLASS}_doDispose(){super._doDispose()}get model(){return this._model}set model(e){e!==this._model&&(this._model=e)}get expanded(){return this._expanded}set expanded(e){e!=this._expanded&&(this._expanded=e)}get isCategory(){return!0}_getCssSelector(){return"rr-property-line rr-property-category"}_initDom(e,t){super._initDom(e,t),t.appendChild(this._spanIndent=e.createElement("span")),t.appendChild(this._spanExpander=e.createElement("span")),t.appendChild(this._spanText=e.createElement("span")),this._setClassName(null)}_doDraw(e){}_doPrepareElement(e,t){this.source.isCollectionProp()?(this._spanAdd||(this._spanAdd=e.createElement("span"),this._spanAdd.className="rr-property-category-add",this._spanAdd.textContent="+"),this.dom.appendChild(this._spanAdd)):this._spanAdd&&this._spanAdd.parentElement&&this.dom.removeChild(this._spanAdd),this.source.isCollectionItem()&&this.label.endsWith("]")?(this._spanDelete||(this._spanDelete=e.createElement("span"),this._spanDelete.className=PropertyCategoryElement.DELETE_CLASS,this._spanDelete.textContent="",this._spanDelete.style.right="0px"),this.dom.appendChild(this._spanDelete)):this._spanDelete&&this._spanDelete.parentElement&&this.dom.removeChild(this._spanDelete),this.source.isCollectionItem()&&!this.label.endsWith("]")&&0===this.level?(this._spanUp||(this._spanUp=e.createElement("span"),this._spanUp.className=PropertyCategoryElement.UP_CLASS,this._spanUp.textContent="⇧",this._spanUp.style.right="0px"),this.dom.appendChild(this._spanUp)):this._spanUp&&this._spanUp.parentElement&&this.dom.removeChild(this._spanUp),this.source.isCollectionItem()&&!this.label.endsWith("]")&&this.level>0?(this._spanRight||(this._spanRight=e.createElement("span"),this._spanRight.className=PropertyCategoryElement.RIGHT_CLASS,this._spanRight.textContent="⇨",this._spanRight.style.right="0px"),this.dom.appendChild(this._spanRight)):this._spanRight&&this._spanRight.parentElement&&this.dom.removeChild(this._spanRight)}_doMeasure(e,t){this._spanIndent.style.minWidth=PropertyLineElement.INDENT*this.level+2+"px",this._spanText.className="rp-category-text",this._spanText.textContent=Utils.labelize(this.label);const i=this.expanded?"rp-expander rp-expander-expanded":"rp-expander rp-expander-collapsed";return this._spanExpander.className=i,this._spanExpander.$_rvu=this.vindex,new Size(300,this.offsetHeight)}_doLayoutContent(){}}PropertyCategoryElement.DELETE_CLASS="rr-property-collection-delete",PropertyCategoryElement.UP_CLASS="rr-property-collection-up",PropertyCategoryElement.RIGHT_CLASS="rr-property-collection-right";class PropertyCollectionElement extends PropertyLineElement{constructor(e){super(e,"propertyCollectionView")}static isAdd(e){return e.className===this.ADD_CLASS}_doDispose(){super._doDispose()}get isCategory(){return!0}_getCssSelector(){return"rr-property-line rr-property-collection"}_initDom(e,t){super._initDom(e,t),t.appendChild(this._spanText=e.createElement("span")),this._spanText.className="rp-category-text",t.appendChild(this._spanAdd=e.createElement("span")),this._spanAdd.className=PropertyCollectionElement.ADD_CLASS,this._spanAdd.textContent="+",this._setClassName(null)}_doDraw(e){}_doPrepareElement(e,t){}_doMeasure(e,t){return this._spanText.textContent=Utils.labelize(this.source.getCollectionLabel()),new Size(300,this.offsetHeight)}_doLayoutContent(){}}PropertyCollectionElement.ADD_CLASS="rr-property-collection-add";class FontSizeStyleElement extends PropertyRowElement{constructor(e,t){super(e,"fontSizePropertyView",t)}_doDispose(){super._doDispose()}_doInitContainer(e,t){const i=this._edit=e.createElement("input");i.type="number",i.className="rr-property-dim",i.min="0",i.onkeydown=e=>{!isNaN(this._oldValue)||"ArrowDown"!==e.key&&"ArrowUp"!==e.key||(e.preventDefault(),e.stopImmediatePropagation())},i.onchange=()=>{this.$_updateValue(),this._text=this._edit.value},t.appendChild(i);const r=this._select=e.createElement("select");FontSizeStyleElement.UNITS.forEach((t=>{const i=e.createElement("option");i.value=t,i.innerHTML=t,r.appendChild(i)})),r.className="rr-property-dim-units",r.onchange=()=>{this.$_updateValue(),this._text=this._edit.value},t.appendChild(r)}_doPrepareElement(e,t){const i=this.model.getValue(t),r=this._oldValue=parseFloat(i);let s=0;isNaN(r)?(this._edit.value="",this._edit.placeholder="(Not Defined)",s=0):(this._edit.value=String(r),"string"==typeof i&&FontSizeStyleElement.UNITS.forEach(((e,t)=>{if(i.endsWith(e))return s=t,!0}))),this._select.selectedIndex=s,this._text=this._edit.value}reset(e){this._edit.value=this._text,this.select(e)}_getEdit(){return this._edit}$_updateValue(){const e=this._select.selectedIndex||0;let t=this._edit.value;t=t?t+FontSizeStyleElement.UNITS[e]:void 0,this._doUpdateValue(this.model,t)}}FontSizeStyleElement.UNITS=["px","pt"];class ColorPropElement extends PropertyRowElement{static createEdit(e){const t=e.createElement("input");return t.type="text",t.className="rr-property-edit",t.spellcheck=!1,t}static createColor(e,t){const i=e.createElement("div");i.className="rp-color-style";const r=e.createElement("span");return r.className=ColorPropElement.BOX_STYLE,r.style.backgroundColor=ColorPropElement.NULL_COLOR,i.appendChild(r),t.appendChild(i),r}static getColor(e){let t=e.value;return t&&(t=t.trim()),!t||t.startsWith("#")||t.startsWith("rgb")||isNaN(parseFloat(t))||(t="#"+t),t}}ColorPropElement.NULL_COLOR="#aaa",ColorPropElement.BOX_STYLE="rp-color-style-box";class DimensionPropertyElement extends PropertyRowElement{constructor(e,t){super(e,"dimensionPropertyView",t)}static createDimEdit(e){const t=e.createElement("input");return t.type="number",t.className="rr-property-dim",t.pattern="[0-9.]+",t.min="0",t}static createDimSelect(e){const t=e.createElement("select");return DimensionPropertyElement.UNITS.forEach((i=>{const r=e.createElement("option");r.value=i,r.innerHTML=i,t.appendChild(r)})),t.className="rr-property-dim-units",t}_doDispose(){super._doDispose()}_doInitContainer(e,t){const i=this._edit=DimensionPropertyElement.createDimEdit(e);i.onkeydown=e=>{const t={"%":"%",p:"px",t:"pt",m:"mm",c:"cm",i:"in"};for(let i in t)if(e.key===i)return this._select.value=t[i],e.preventDefault(),void e.stopImmediatePropagation();isNaN(this._oldValue)&&this.model instanceof SizeProperty&&("ArrowDown"===e.key||"ArrowUp"===e.key)&&(e.preventDefault(),e.stopImmediatePropagation())},i.onchange=()=>{this.$_updateValue()},t.appendChild(i);const r=this._select=DimensionPropertyElement.createDimSelect(e);r.onchange=()=>{this.$_updateValue()},t.appendChild(r)}_doPrepareElement(e,t){const i=this.model.getValue(t),r=this._oldValue=parseFloat(i);let s=0;isNaN(r)?(this._edit.value="",this._edit.placeholder="(Not Defined)"):(this._edit.value=String(r),"string"==typeof i&&DimensionPropertyElement.UNITS.forEach(((e,t)=>{if(i.endsWith(e))return s=t,!0}))),this._text=this._edit.value,this._select.selectedIndex=s}reset(e){this._edit.value=this._text,this.select(e)}_getEdit(){return this._edit}$_updateValue(){const e=this._select.selectedIndex||0;let t=this._edit.value;t=t?t+DimensionPropertyElement.UNITS[e]:void 0,this._doUpdateValue(this.model,t)}}var InspectorDisplayMode;DimensionPropertyElement.UNITS=["px","pt","mm","cm","in","%"],function(e){e.CATEGORY="category",e.NAME="name"}(InspectorDisplayMode||(InspectorDisplayMode={}));class JsonItem extends Base{constructor(e){super(),this._name=e}get name(){return String(this._name)}set name(e){e!=this._name&&(this._name=e)}get index(){return this._name}get parent(){return this._parent}get json(){return this._parent&&this._parent.json}get level(){return this._parent?this._parent.level+1:0}get revealed(){return!this._parent||this._parent.revealed}isGroup(){return!1}getPath(){const e=[this];let t=this._parent;for(;t;)e.push(t),t=t._parent;return e.reverse()}getUrl(e=JsonItem.URL_SEPARATOR){const t=this._parent;let i=this.name;return t&&(i=t.getUrl(e)+e+i),i}getDisplayUrl(e="."){const t=this._parent;let i=this.name;return t instanceof JsonListItem?i=t.getDisplayUrl(e)+"["+i+"]":this._parent&&(i=t.getDisplayUrl(e)+e+i),i}getDataUrl(e="."){const t=this._parent;let i=this.name;return t&&t.level>0&&(i=t.getDataUrl(e)+e+i),i}}JsonItem.URL_SEPARATOR="/",JsonItem.TAG="__tag_";class JsonGroupItem extends JsonItem{constructor(e){super(e),this._items=[],this._expanded=!0}get count(){return this._items.length}get expanded(){return this._expanded}indexOf(e){return this._items.indexOf(e)}get(e){return this._items[e]}set(e,t){const i=this._items[e];i!==t&&(this._items[e]=t,t._parent=this,i._parent=null)}contains(e){return this._items.indexOf(e)>=0}canAdd(e){return!!e}add(e){if(e&&this._items.indexOf(e)<0)return this._addItem(e),!0}canRemove(e){return!!e}remove(e){const t=this._items.indexOf(e);if(t>=0)return this._removeItem(e,t),!0}collectItems(e){for(let t of this._items)e.push(t),t instanceof JsonGroupItem&&t.collectItems(e)}collectVisibles(e){for(let t of this._items)e.push(t),t instanceof JsonGroupItem&&t.expanded&&t.collectVisibles(e)}findByTag(e){if(e===this.tag)return this;for(let t of this._items)if(t instanceof JsonGroupItem){const i=t.findByTag(e);if(i)return i}else if(t===e)return t}isGroup(){return this instanceof JsonGroupItem}_createItem(e,t){return null==t?new JsonNullItem(e):"string"==typeof t?new JsonStringItem(e,t):"number"==typeof t?new JsonNumberItem(e,t):"boolean"==typeof t?new JsonBooleanItem(e,t):Utils.isValueArray(t)?new JsonArrayItem(e,t):Utils.isArray(t)?new JsonListItem(e,t):t?new JsonObjectItem(e,t):void 0}_addItem(e){this._items.push(e),e._parent=this}_removeItem(e,t){this._items.splice(t,1),e._parent=null}$_expand(e,t){if(e!=this._expanded||t){let i=!1;if(e!=this._expanded&&(this._expanded=e,i=!0),t)for(let t of this._items)t instanceof JsonGroupItem&&t.$_expand(e,!0)&&(i=!0);return i}}}class JsonObjectItem extends JsonGroupItem{constructor(e,t){super(e),this._nameMap={},this._parse(t)}find(e){return this._nameMap[e]}isValidName(e,t){const i=this._nameMap[t];return!i||i===e}getValidName(e){let t=e,i=1;for(;;){let r=!1;for(let s in this._nameMap)if(t===s){t=e+"-"+i++,r=!0;break}if(!r)break}return t}save(){const e={};for(let t of this._items)e[t.name]=t.save();return e}canAdd(e){if(super.canAdd(e)&&e.name){if(this._nameMap[e.name])throw new Error("Already same name exisits: "+e.name);return!0}return!1}_addItem(e){super._addItem(e),this._nameMap[e.name]=e}_parse(e){for(let t in e)if(t===JsonItem.TAG)this.tag=e[t];else{const i=this._createItem(t,e[t]);i&&(this._addItem(i),this._nameMap[t]=i)}}}class JsonListItem extends JsonGroupItem{constructor(e,t){super(e),this._parse(t)}save(){const e=[];for(let t of this._items)e.push(t.save());return e}_parse(e){for(let t=0;t<e.length;t++){const i=this._createItem(t,e[t]);this._addItem(i)}}}class JsonValueItem extends JsonItem{constructor(e,t){super(e),this._value=t}get value(){return this._value}set value(e){e!=this._value&&(this._value=e)}get displayText(){return void 0===this.value?"UNDEFINED":null===this.value?"null":this._getDisplayText(this.value)}parseValue(e){if(void 0!==e){if(null===e)return null;if("null"==e)return null;if("UNDEFINED"!=e)return this._doParseValue(e)}}valueEquals(e){return this.value==e}save(){return this._value}}class JsonNullItem extends JsonValueItem{constructor(e){super(e,null)}save(){return null}_getDisplayText(e){return"null"}_doParseValue(e){return null}}class JsonStringItem extends JsonValueItem{constructor(e,t){super(e,t)}_getDisplayText(e){return e}_doParseValue(e){return e.startsWith('"')&&e.endsWith('"')?e.slice(1,e.length-1):e}}class JsonNumberItem extends JsonValueItem{constructor(e,t){super(e,t)}_getDisplayText(e){return isNaN(e)?"NaN":String(e)}_doParseValue(e){return"NaN"==e?NaN:parseFloat(e)}}class JsonBooleanItem extends JsonValueItem{constructor(e,t){super(e,t)}_getDisplayText(e){return e?"true":"false"}_doParseValue(e){const t=e.trim().toLowerCase();return"true"===t||"t"===t||"1"===t}}class JsonArrayItem extends JsonValueItem{constructor(e,t){super(e,t)}_getDisplayText(e){let t="";const i=new Array(e.length);for(let t=0;t<e.length;t++)"string"==typeof e[t]?i[t]='"'+e[t]+'"':i[t]=e[t];return t+=i.join(","),t}_doParseValue(e){const t=e.split(/\s*\,\s*/);for(let e=0;e<t.length;e++){const i=t[e];i.startsWith('"')&&i.endsWith('"')?t[e]=i.slice(1,i.length-1):t[e]=parseFloat(i)}return t}valueEquals(e){if(!Utils.isArray(e)||!Utils.isArray(this.value))return!this.value;if(e.length&&this.value.length){for(let t=0;t<e.length;t++)if(e[t]!=this.value[t])return!1;return!0}}}class JsonSetValueCommand extends EditCommand{constructor(e,t){super("Set Value"),this._item=e,this._newValue=t,this._oldValue=e.value}_doDispose(){}redo(e){this._item.value=this._newValue}undo(){this._item.value=this._oldValue}get source(){return this._item}}class JsonAddItemCommand extends EditCommand{constructor(e,t){super("Add Item"),this._model=e.json,this._parent=e,this._item=t}_doDispose(){this._model=this._parent=this._item=null}redo(e){this._model.$_addItem(this._parent,this._item)}undo(){this._model.$_removeItem(this._item)}get source(){return this._item}}class JsonRemoveItemCommand extends EditCommand{constructor(e){super("Remove Item"),this._model=e.json,this._parent=e.parent,this._item=e}_doDispose(){this._model=this._parent=this._item=null}redo(e){this._model.$_removeItem(this._item)}undo(){this._model.$_addItem(this._parent,this._item)}get source(){return this._item}}class JsonSetNameCommand extends EditCommand{constructor(e,t){super("Set Value"),this._item=e,this._newName=t,this._oldName=e.name}_doDispose(){}redo(e){this._item.name=this._newName}undo(){this._item.name=this._oldName}get source(){return this._item}}class JsonSetItemCommand extends EditCommand{constructor(e,t){super("Set Item"),this._parent=e.parent,this._index=this._parent.indexOf(e),this._oldItem=e,this._newItem=t}_doDispose(){this._parent=this._oldItem=this._newItem=null}redo(e){this._parent.set(this._index,this._newItem)}undo(){this._parent.set(this._index,this._oldItem)}get source(){return this._oldItem}}class JsonModel extends EventAware{constructor(e,t=!0,i=""){super(),this._editable=!0,this._rootName=i,t&&(this._commands=new EditCommandStack(this)),this.$_load(e)}editCommandStackChanged(e,t,i,r){this.fireEvent(JsonModel.COMMANDS_STACK_CHANGED,i,r)}editCommandStackDirtyChanged(e){this.fireEvent(JsonModel.DIRTY_CHANGED)}get dirty(){return this._commands.canUndo}get rootName(){return this._rootName}get root(){return this._root}get rootGroup(){return this._root instanceof JsonGroupItem?this._root:null}get allItems(){return this._items}get visibleItems(){return this._visibles}get firstVisible(){return this._visibles[0]}get lastVisible(){return this._visibles[this._visibles.length-1]}get editable(){return this._editable}set editable(e){e!==this._editable&&(this._editable=e,this.$_refreshVisibles())}isRoot(e){return e===this._root}load(e){this.$_load(e),this._fireReset()}save(){return this._root.save()}saveAsString(){const e=this._root.save();return JSON.stringify(e,null,2)}expand(e=null,t=!1){if(!e&&this._root instanceof JsonGroupItem&&(e=this._root),e&&e.$_expand(!0,t))return this.$_refreshVisibles(),!0}collapse(e=null,t=!1){if(!e&&this._root instanceof JsonGroupItem&&(e=this._root),e&&e.$_expand(!1,t))return this.$_refreshVisibles(),!0}reveal(e){if(e&&!e.revealed){const t=e.getPath();for(let e=0;e<t.length-1;e++)t[e].$_expanded=!0;return!0}}findItem(e,t=null){const i=JsonItem.URL_SEPARATOR;if(this._root instanceof JsonNullItem)return e==i?this._root:null;"/"==e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e.startsWith(i)&&(t=this._root,e=e.substr(1));const r=e.split(i);let s=t||this._root,n=0;for(;s&&n<r.length;)if(s instanceof JsonObjectItem){const e=r[n++];s=s.find(e)}else{if(!(s instanceof JsonListItem))return;{const e=parseInt(r[n++]);s=s.get(e)}}return s}findByTag(e){if(this._root instanceof JsonGroupItem)return this._root.findByTag(e)}getNextVisible(e){const t=Math.max(0,Math.min(this._visibles.length-1,this._visibles.indexOf(e)+1));return this._visibles[t]}getPrevVisible(e){const t=Math.max(0,Math.min(this._visibles.length-1,this._visibles.indexOf(e)-1));return this._visibles[t]}clean(){this._commands.flush()}undo(){return this._commands&&this._commands.undo()}redo(){return this._commands&&this._commands.redo()}isEditable(e){return!0}addItem(e,t){if(e&&t&&e.canAdd(t)&&!e.contains(t))return this._commands?this._commands.execute(new JsonAddItemCommand(e,t)):this.$_addItem(e,t),this.$_buildItems(),!0}canRemove(e){return e!==this._root&&e&&e.parent&&e.parent.canRemove(e)}removeItem(e){if(e!==this._root&&e&&e.parent)return this._commands?this._commands.execute(new JsonRemoveItemCommand(e)):this.$_removeItem(e),this.$_buildItems(),!0}changeName(e,t){if(e&&e.name!=t){const i=e.name;return e.parent instanceof JsonObjectItem&&!e.parent.isValidName(e,t)?(this._fireNameChanged(e,i),!1):(this._commands?this._commands.execute(new JsonSetNameCommand(e,t)):e.name=t,this._fireNameChanged(e,i),!0)}}changeValue(e,t){if(!e)return!1;const i=e.parseValue(t);if(e&&!e.valueEquals(i)){if(e instanceof JsonNumberItem){const e=Number(i);if(isNaN(e))return}const t=e.value;return this._commands?this._commands.execute(new JsonSetValueCommand(e,i)):e.value=i,this._fireValueChanged(e,t),!0}}changeType(e,t){if(!(e instanceof t)){const i=e.value;let r;if(t===JsonNullItem?r=new JsonNullItem(e.name):t===JsonStringItem?r=new JsonStringItem(e.name,String(i)):t===JsonBooleanItem?r=new JsonBooleanItem(e.name,!!i):t===JsonNumberItem&&(r=new JsonNumberItem(e.name,+i)),r){if(this._commands)this._commands.execute(new JsonSetItemCommand(e,r));else{const t=e.parent;t.set(t.indexOf(e),r)}return this.$_buildItems(),this._fireItemChanged(e,r),r}}return e}search(e,t){const i=[];t.caseSensitive||(e=e.toLowerCase());for(let r of this._items)if(r instanceof JsonValueItem){const s=r.displayText;if(s){let n=s;t.caseSensitive||(n=n.toLowerCase()),(t.wholeWord&&n===e||!t.wholeWord&&n.indexOf(e)>=0)&&i.push({item:r,prop:r.displayText})}}return i.length>0?i:null}$_load(e){null==e?this._root=new JsonNullItem("/"):Utils.isArray(e)?this._root=new JsonListItem("/",e):this._root=new JsonObjectItem("/",e);const t=this;Object.defineProperty(this._root,"json",{get:function(){return t}}),this.$_buildItems()}$_buildItems(){this._items=[this._root],this._visibles=[this._root],this._root instanceof JsonGroupItem&&(this._root.collectItems(this._items),this._root.expanded&&this._root.collectVisibles(this._visibles))}$_refreshVisibles(){this._visibles=[this._root],this._root instanceof JsonGroupItem&&this._root.expanded&&this._root.collectVisibles(this._visibles)}$_addItem(e,t){if(e&&e.add(t)){const i=this._visibles;let r=i.indexOf(e);if(r>=0){const s=e.level,n=i.length;for(;++r<n&&!(i[r].level<=s););i.splice(r,0,t)}this._items.push(t),this._fireItemAdded(e,t)}}$_removeItem(e){if(!e)return;const t=e.level,i=e.parent;if(i&&i.remove(e)){const r=this._items,s=this._visibles;let n=s.indexOf(e);if(n>=0){const e=s.length;let i=1;for(;n<e-1&&!(s[n+1].level<=t);)n++,i++;s.splice(n,i)}n=r.indexOf(e),this._items.splice(n,1),this._fireItemRemoved(i,e)}}_fireReset(){this.fireEvent(JsonModel.RESET)}_fireNameChanged(e,t){this.fireEvent(JsonModel.NAME_CHANGED,e,e.name,t)}_fireValueChanged(e,t){this.fireEvent(JsonModel.VALUE_CHANGED,e,e.value,t)}_fireItemChanged(e,t){this.fireEvent(JsonModel.ITEM_CHANGED,e,t)}_fireItemAdded(e,t){this.fireEvent(JsonModel.ITEM_ADDED,e,t)}_fireItemRemoved(e,t){this.fireEvent(JsonModel.ITEM_REMOVED,e,t)}}JsonModel.COMMANDS_STACK_CHANGED="onJsonCommandStackChanged",JsonModel.DIRTY_CHANGED="onJsonDirtyChanged",JsonModel.RESET="onJsonReset",JsonModel.NAME_CHANGED="onJsonNameChanged",JsonModel.VALUE_CHANGED="onJsonValueChanged",JsonModel.ITEM_CHANGED="onJsonItemChanged",JsonModel.ITEM_ADDED="onJsonItemAdded",JsonModel.ITEM_REMOVED="onJsonItemRemoved";class JsonElement extends VisualElement{constructor(e,t){super(e,t),this._vindex=-1}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}get vindex(){return this._vindex}measure(e,t){const i=this._doMeasure(e,t);return this._measuredWidth=i.width,this._measuredHeight=i.height,i}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(e){}_doMeasure(e,t){return new Size(e,t)}_doLayoutContent(){}}class JsonBodyView extends JsonElement{constructor(e,t){super(e.doc,"jsonBodyView"),this._rowMap=new Map,this._itemMap=new Map,this._editor=e,this._draggable=t}_doDispose(){this._tbody=this._thead=this._table=null,this._editor=null,super._doDispose()}get draggable(){return this._draggable}isExpander(e){return e&&e.classList.contains(JsonBodyView.EXPANDER)}rowOf(e){let t=e;for(;t;){if(t instanceof HTMLTableRowElement)return t;t=t.parentElement}}itemOf(e){const t=this.rowOf(e);return t&&this._rowMap.get(t)}rowOfitem(e){return this._itemMap.get(e)}getFirstValue(){const e=this._tbody.rows;for(let t=0;t<e.length;t++){const i=e[t];if(this._rowMap.get(i)instanceof JsonValueItem)return this.$_getValueDom(i)}}getLastValue(){const e=this._tbody.rows;for(let t=e.length-1;t>=0;t--){const i=e[t];if(this._rowMap.get(i)instanceof JsonValueItem)return this.$_getValueDom(i)}}getNameDom(e){return this.$_getNameDom(e)}getValueDom(e){return this.$_getValueDom(e)}getNextValue(e){const t=this._tbody.rows;let i=this.rowOf(e);if(i){for(let e=i.rowIndex;e<t.length;e++)if(i=t[e],this._rowMap.get(i)instanceof JsonValueItem)return this.$_getValueDom(i);return e}}getPrevValue(e){const t=this._tbody.rows;let i=this.rowOf(e);if(i){for(let e=i.rowIndex-2;e>=0;e--)if(i=t[e],this._rowMap.get(i)instanceof JsonValueItem)return this.$_getValueDom(i);return e}}getEditingRow(){let e=this.doc.activeElement;for(;e;){if(e instanceof HTMLTableRowElement){if(this._rowMap.get(e))return e}e=e.parentElement}}getEditingItem(){const e=this.getEditingRow();return e&&this._rowMap.get(e)}makeRowVisible(e){e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}isRowMenu(e){if(e.classList.contains(JsonBodyView.ROW_MENU)){const t=this.$_getTr(e);return this._rowMap.get(t)}}beginEdit(e){const t=this.rowOfitem(e);if(t){const e=t.children[2].lastElementChild,i=this._editor.nameEditable?e.children[1]:e.children[3];if(i instanceof HTMLElement)return this._editor.setFocus(),i.focus(),!0}}_createDom(e){const t=super._createDom(e);let i=t.style;i.overflow="auto";const r=this._table=e.createElement("table");return i=r.style,r.className="json-table",i.setProperty("table-layout","fixed","important"),i.setProperty("width","100%","important"),this._thead=e.createElement("thead"),this.$_prepareHead(e,this._thead),r.appendChild(this._thead),this._tbody=e.createElement("tbody"),r.appendChild(this._tbody),t.appendChild(r),t}_getCssSelector(){return"json-body"}_doMeasure(e,t){return this.$_prepareRows(this.doc,this._tbody),new Size(e,t)}_doLayoutContent(){}$_prepareHead(e,t){let i;i=e.createElement("tr"),t.appendChild(i),i.setAttribute("aria-hidden","true");i.style.setProperty("border","0px none","important");for(let t=0;t<2;t++){const t=e.createElement("th");t.scope="col";let r=t.style;r.setProperty("visibility","hidden","important"),r.setProperty("margin","0px","important"),r.setProperty("padding","0px","important"),r.setProperty("font-size","0px","important"),r.setProperty("line-height","0px","important"),r.height="0px",r.width="24px",i.appendChild(t)}}$_prepareRows(e,t){const i=this._editor,r=i.model,s=i.focused,n=i.model&&i.model.visibleItems||[],o=t.rows;for(;o.length<n.length;){const i=e.createElement("tr");t.appendChild(i)}for(;o.length>n.length;)t.removeChild(t.lastChild);this._rowMap.clear(),this._itemMap.clear();for(let t=0,i=o.length;t<i;t++){const i=o[t],a=n[t];i.className=a===s?"json-focused":"",this.$_prepareRow(e,r,a,i,t),this._rowMap.set(i,a),this._itemMap.set(a,i)}}$_prepareRow(e,t,i,r,s){if(0==r.childElementCount)for(let t=0;t<3;t++){const t=e.createElement("td");r.appendChild(t)}let n=r.children[0],o=n.firstElementChild;o||(o=e.createElement("button"),o.className=JsonBodyView.ROW_MOVER,this._draggable&&(o.draggable=!0,o.dataset.url=i.getDataUrl()),n.appendChild(o)),n=r.children[1],o=n.firstElementChild,o||(o=e.createElement("button"),o.className=JsonBodyView.ROW_MENU,n.appendChild(o)),n=r.children[2];let a=n.lastChild;a||(a=this.$_prepareCell(e,i),n.appendChild(a)),a.style.marginLeft=16*i.level+"px",this.$_layoutCell(e,t,i,a,0===s&&t.isRoot(i))}$_prepareCell(e,t){const i=e.createElement("div");i.className="json-content";for(let e=0;e<4;e++){const r=document.createElement("span");1==e&&this._draggable&&t instanceof JsonValueItem&&(r.dataset.url=t.getDataUrl(),r.draggable=!0),i.appendChild(r)}return i}$_layoutCell(e,t,i,r,s){const n=r.children;let o=n[0];i instanceof JsonGroupItem?(o||r.appendChild(o=e.createElement("button")),i.expanded?o.className=JsonBodyView.EXPANDER_EXPANDED:o.className=JsonBodyView.EXPANDER_COLLAPSED):o&&(o.className=JsonBodyView.EXPANDER);let a=n[1];if(a.className="json-field",a.contentEditable=this._editor.nameEditable?"true":"false",a.textContent=s&&this._editor.model.rootName||i.name,a.spellcheck=!1,i instanceof JsonGroupItem)a=n[2],a.className="json-count",i instanceof JsonObjectItem?a.textContent="{"+i.count+"}":i instanceof JsonListItem&&(a.textContent="["+i.count+"]"),a=n[3],a.contentEditable="false",a.className="json-value",a.textContent="";else if(i instanceof JsonValueItem){const e=i instanceof JsonArrayItem;a=n[2],a.className="json-separator",a.textContent=e?"["+i.value.length+"] :":":",a=n[3],t.editable?(a.contentEditable="true",a.spellcheck=!1):a.contentEditable="false",a.className="json-value",a.dataset.type=e?"array":i instanceof JsonNumberItem?"number":i instanceof JsonBooleanItem?"bool":i instanceof JsonNullItem?"null":"string",a.textContent=i.displayText}}$_getNameDom(e){return e.cells[2].firstElementChild.children[1]}$_getValueDom(e){return e.cells[2].firstElementChild.children[3]}$_focusedChanged(e,t){let i=this.rowOfitem(e);i&&i.classList.remove("json-focused"),i=this.rowOfitem(t),i&&(i.classList.add("json-focused"),this.makeRowVisible(i))}$_getTr(e){do{if(e instanceof HTMLTableRowElement)return e;e=e.parentElement}while(e)}}JsonBodyView.EXPANDER="json-expander",JsonBodyView.EXPANDER_EXPANDED="json-expander json-expander-expanded",JsonBodyView.EXPANDER_COLLAPSED="json-expander json-expander-collapsed",JsonBodyView.ROW_MOVER="json-row-mover",JsonBodyView.ROW_MENU="json-row-menu";class JsonSelectionTool extends VisualTool{constructor(e){super(e,"jsonSelectionTool"),this._editor=e}_doDispose(){this._editor=null,super._doDispose()}get viewer(){return this._editor}isMouseEventTarget(e){return super.isMouseEventTarget(e)}_doMouseDown(e){const t=this._editor,i=t.bodyView,r=this.mouseEventTarget,s=i.rowOf(r),n=i.isRowMenu(r);if(n)t.onRowMenuClick&&t.onRowMenuClick(n);else if(i.isExpander(r)){const e=i.itemOf(r);e.isGroup()&&(e.expanded?t.collapse(e):t.expand(e))}return t.focused instanceof JsonValueItem&&this.$_fireChangeEvent(t.focused),s&&(t.focused=i.itemOf(s)),!0}_doMouseMove(e){}_doMouseUp(e){}_doClick(e,t,i){this.findElementAt(t,i,!1)}_doDblClick(e){}_doMouseWheel(e){return!!(e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY))}_doMouseEnter(e){}_doMouseLeave(e){}_doMouseOver(e){}_doContextMenu(e){return!1}_doKeyDown(e){const t=e.keyCode,i=e.ctrlKey,r=Utils.isMac,s=r&&e.metaKey||!r&&e.ctrlKey,n=e.shiftKey,o=e.target instanceof HTMLElement?e.target:null,a=this._editor,A=a.focused,l=a.bodyView.itemOf(o);let h=!1;switch(t){case 13:i||s||n||(h=this.$_enter(o,l||A));break;case 27:h=this.$_esc(o,l);break;case 9:h=n?this.$_move(o,A,-1):this.$_move(o,A,1);break;case 36:s&&(h=this.$_home());break;case 35:s&&(h=this.$_end());break;case 37:h=this.$_left(o,A);break;case 39:h=this.$_right(o,A);break;case 40:h=this.$_move(o,A,1);break;case 38:h=this.$_move(o,A,-1)}return h&&(e.preventDefault(),e.stopImmediatePropagation()),h||super._doKeyDown(e)}_doKeyPress(e){return!1}_doKeyUp(e){return!1}_doFocusLeave(e){const t=this._editor;if(t.focused instanceof JsonValueItem){const e=t.bodyView.rowOfitem(t.focused),i=t.bodyView.getNameDom(e),r=t.bodyView.getValueDom(e);t._fireFocusedLeave(t.focused,i.textContent,r.textContent)}}$_enter(e,t){if(e){const i=this._editor,r=i.bodyView;if(t){const s=r.rowOfitem(t);if(t.isGroup())e=r.getNextValue(s),i.focused=r.itemOf(e);else{if(i.isEditing())return this.$_move(e,t,1);e=r.getValueDom(s)}return e&&e.focus(),Utils.selectAll(e),!0}}return!1}$_esc(e,t){const i=this._editor;if(e&&(e.blur(),t instanceof JsonValueItem))return i.isName(e)?e.textContent=t.name:e.textContent=t.value,!0}$_left(e,t){const i=this._editor;if(!i.isEditing()&&t.isGroup())return i.collapse(t),!0}$_right(e,t){const i=this._editor;if(!i.isEditing()&&t.isGroup())return i.expand(t),!0}$_move(e,t,i){if(e){const t=this._editor,r=t.bodyView.itemOf(e),s=t.model;let n=t.focused;if(r instanceof JsonValueItem&&this.$_fireChangeEvent(r),t.isEditing()&&e.blur(),n?i>0?n=s.getNextVisible(n):i<0&&(n=s.getPrevVisible(n)):n=s.firstVisible,n instanceof JsonValueItem&&s.isEditable(n)){const i=t.bodyView.rowOfitem(n);(e=t.bodyView.getValueDom(i))&&e.focus(),Utils.selectAll(e)}else t.setFocus();return t.focused=n,!0}return!1}$_home(){const e=this._editor.bodyView.getFirstValue();if(e)return e.focus(),!0}$_end(){const e=this._editor.bodyView.getLastValue();if(e)return e.focus(),!0}$_commitEdit(e,t){const i=this._editor;return t.blur(),i.isName(t)?!!i.model.changeName(e,t.textContent)||(i.invalidateLayout(),!1):!!i.model.changeValue(e,t.textContent)||(i.invalidateLayout(),!1)}$_fireChangeEvent(e){const t=this._editor,i=t.bodyView.rowOfitem(e),r=t.bodyView.getNameDom(i),s=t.bodyView.getValueDom(i),n=e;n.name!==r.textContent&&(""===r.textContent.trim()?t.model._fireNameChanged(e,e.name):t.model.changeName(n,r.textContent)||t.invalidateLayout()),n.value!==s.textContent&&(t.model.changeValue(n,s.textContent)||t.invalidateLayout())}}class JsonEditor extends VisualContainer{constructor(e,t=!1){super(e),this._nameEditable=!1,this.addElement(this._bodyView=new JsonBodyView(this,t))}_doDispose(){super._doDispose()}get model(){return this._model}set model(e){e!==this._model&&(this._model&&this._model.removeListener(this),this._model=e,this._model&&this._model.addListener(this),this.$_modelchanged())}get nameEditable(){return this._nameEditable}set nameEditable(e){e!=this._nameEditable&&(this._nameEditable=e,this.invalidateLayout())}get focused(){return this._focused}set focused(e){if(e!==this._focused){const t=this._focused;this._focused=e,this.$_focusedChanged(t,this._focused)}}get bodyView(){return this._bodyView}expand(e,t=!1){(e=e||this.model.rootGroup).$_expand(!0,t)&&(this.model.$_refreshVisibles(),this.invalidateLayout())}collapse(e,t=!1){(e=e||this.model.rootGroup).$_expand(!1,t)&&(this.model.$_refreshVisibles(),this.invalidateLayout())}expandAll(){this.expand(null,!0)}collapseAll(){this.collapse(null,!0)}isName(e){return e.classList.contains("json-field")}isValue(e){return e.classList.contains("json-value")}isEditing(){return!!this._bodyView.getEditingRow()}isEditingAt(e){return(e=e||this._focused)&&this._bodyView.getEditingItem()===e}undo(){return this._model.undo()}redo(){return this._model.redo()}beginEdit(e=null){return this._bodyView.beginEdit(e||this._focused)}getFocusedTag(e){let t=this._focused;if(t){let i=t.tag;for(;!(i instanceof e)&&(t=t.parent,t);)i=t.tag;if(i instanceof e)return i}}_createDefaultTool(){return new JsonSelectionTool(this)}_doPrepareContainer(e){e.className="json-root json-editor"}_doLayout(e){this._bodyView.measure(e.width,e.height),this._bodyView.setBounds(0,0,e.width,e.height),this._bodyView.layoutContent()}$_modelchanged(){this._focused=null}$_focusedChanged(e,t){t&&!t.revealed?(this._model.reveal(t),this.invalidateLayout()):this._bodyView.$_focusedChanged(e,t),this._fireFocusedChanged(t,e)}_fireFocusedChanged(e,t){this.fireEvent(JsonEditor.FOCUSED_CHANGED,e,t)}_fireFocusedLeave(e,t,i){this.fireEvent(JsonEditor.FOCUSED_LEAVE,e,t,i)}onJsonReset(e){this._focused=null,this.invalidateLayout()}onJsonNameChanged(e,t,i,r){this.invalidateLayout()}onJsonValueChanged(e,t,i,r){this.invalidateLayout()}onJsonItemChanged(e,t,i){this.invalidateLayout()}onJsonItemAdded(e,t,i){this.invalidateLayout()}onJsonItemRemoved(e,t,i){this.invalidateLayout()}}JsonEditor.FOCUSED_CHANGED="onJsonFocusedChanged",JsonEditor.FOCUSED_LEAVE="onJsonFocusedLeave";class FolderModel extends EventAware{constructor(e,t){super(),this._rootVisible=!0,this._visibles=[],this._inserting=!1,this._rootPath=e,this._rootDir=e&&e.endsWith("/")?e.substring(0,this.rootPath.length-1):e,this.$_setSource(t)}_doDispose(){this._source=null,super._doDispose()}get rootPath(){return this._rootPath}get source(){return this._source}set source(e){e!==this._source&&this.$_setSource(e)}get root(){return this._root}get rootVisible(){return this._rootVisible}set rootVisible(e){e!=this._rootVisible&&(this._rootVisible=e,e?this._visibles.unshift(this._root):this._visibles.shift())}get visibleCount(){return this._visibles.length}getVisible(e){return this._visibles[e]}findItem(e){return this._root.itemOf(e,!0)}getLastVisibleOf(e){if(!e||e.isRoot)return this._visibles.length-1;{const t=e.level;let i=this._visibles.indexOf(e)+1;for(;i<this._visibles.length&&!(this._visibles[i].level<=t);)i++;return i-1}}appendItems(e,t){if(e&&t&&t.length>0){const i=e.expanded;i&&this.$_collapse(e,0);const r=e._addItems(t);i&&this.$_expand(e,0),this._fireItemsAdded(e,r)}}getAbsolutePath(e){return this._rootDir+e}getItemAt(e){if("/"===e||"."===e||""===e)return this._root;const t=e.split(/[\\\/]/);let i=this._root;for(let e=t.length-1;e>=0;e--)t[e]||t.splice(e,1);for(let e=0;e<t.length-1;e++)if(i=i.find(t[e]),!i)return null;return i.find(t[t.length-1])}getVisibleItems(e=0,t=-1){const i=this._visibles;if(e=Math.max(0,e),(t=t<0?i.length-1:Math.min(t,i.length-1))>=0&&t<e){const i=e;e=t,t=i}const r=[];for(let s=e;s<=t;s++)r.push(i[s]);return r}expand(e,t=0){return!(!(e=e||this._root)||!e.expandable||e.expanded)&&(this.$_expand(e,t),this._fireExpanded(e,!0),!0)}$_expand(e,t){const i=this._visibles;let r=i.indexOf(e);if(r<0&&e!==this._root)return void e.$_setExpanded(!0);r=e!==this._root||this._rootVisible?r+1:0,e!==this._root&&this._rootVisible&&assert(r>0);const s=[];e.$_setExpanded(!0),this.$_collectVisibles(e,s,t);for(let e of s)i.splice(r++,0,e)}expandAll(e){this.collapseAll(e),this.expand(e,Number.MAX_SAFE_INTEGER)}collapse(e,t=0){return!!((e=e||this._root)&&e.expandable&&e.expanded)&&(this.$_collapse(e,t),this._fireExpanded(e,!1),!0)}$_collapse(e,t){const i=this._visibles;let r=i.indexOf(e);if(r<0&&e!==this._root)return void e.$_setExpanded(!1);r=e!==this._root||this._rootVisible?r+1:0,e!==this._root&&this._rootVisible&&assert(r>0);const s=this.$_hideVisibles(e,t);i.splice(r,s),e.$_setExpanded(!1)}collapseAll(e){this.collapse(e,Number.MAX_SAFE_INTEGER)}isVisible(e){return this._visibles.indexOf(e)>=0}makeVisible(e){if(this.isVisible(e))return;let t=e.parent,i=0;for(;t;){if(t===this._root||this.isVisible(t)){this.expand(t,i);break}t=t.parent,i++}}resetFolder(e,t){const i=e instanceof FolderItem?e:this.getItemAt(e);if(i instanceof FolderGroupItem){const e=i.isRoot&&!this._rootVisible||this.isVisible(i)&&i.expanded;e&&this.$_collapse(i,0),i.reset(t),e&&this.$_expand(i,0),this._fireFolderReset(i)}}beginAppend(e,t){if(!this._inserting){if(this._insertingItem||(this._insertingItem=new FolderEditItem),this._insertingItem.beginEdit(t),e||(e=this._root),e._addItem(this._insertingItem),!this.expand(e)){const t=this.getLastVisibleOf(e)+1;this._visibles.splice(t,0,this._insertingItem)}return this._inserting=!0,this._fireAppendStarted(e),!0}}endAppend(e){if(this._inserting){const t=this._insertingItem.parent,i=this._visibles.indexOf(this._insertingItem);this._visibles.splice(i,1),this._insertingItem.parent._removeItem(this._insertingItem),this._fireAppendEnded(t,e?this._insertingItem:null),this._inserting=!1}}isInserting(e){return this._inserting&&(!e||e===this._insertingItem)}$_setSource(e){this._source=e,this.$_build(e),this._visibles=[],this._rootVisible?this._visibles.push(this._root):this.expand(this._root),this._fireSourceChanged()}$_build(e){this._root=new FolderRootItem(this,this._source=e)}$_collectVisibles(e,t,i){for(let r=0;r<e.count;r++){const s=e.get(r);t.push(s),s instanceof FolderGroupItem&&(s.expanded||i>0)&&(s.$_setExpanded(!0),this.$_collectVisibles(s,t,i-1))}}$_hideVisibles(e,t){let i=0;i+=e.count;for(let r=0;r<e.count;r++){const s=e.get(r);s instanceof FolderGroupItem&&s.expanded&&(t>0&&s.$_setExpanded(!1),i+=this.$_hideVisibles(s,t-1))}return i}_fireSourceChanged(){this.fireEvent(FolderModel.SOURCE_CHANGED)}_fireItemAdded(e,t){this.fireEvent(FolderModel.ITEM_ADDED,e,t)}_fireItemsAdded(e,t){this.fireEvent(FolderModel.ITEMS_ADDED,e,t)}_fireItemRemoved(e){this.fireEvent(FolderModel.ITEM_REMOVED,e)}_fireItemsRemoved(e){this.fireEvent(FolderModel.ITEMS_REMOVED,e)}_fireFolderReset(e){this.fireEvent(FolderModel.FOLDER_RESET,e)}_fireExpanded(e,t){this.fireEvent(FolderModel.EXPANDED,e,t)}_fireAppendStarted(e){this.fireEvent(FolderModel.APPEND_STARTED,e)}_fireAppendEnded(e,t){this.fireEvent(FolderModel.APPEND_ENDED,e,t)}}FolderModel.SOURCE_CHANGED="onFolderRootChanged",FolderModel.ITEM_ADDED="onFolderItemAdded",FolderModel.ITEMS_ADDED="onFolderItemsAdded",FolderModel.ITEM_REMOVED="onFolderItemRemoved",FolderModel.ITEMS_REMOVED="onFolderItemsRemoved",FolderModel.FOLDER_RESET="onFolderFolderReset",FolderModel.EXPANDED="onFolderExpanded",FolderModel.APPEND_STARTED="onFolderAppendStarted",FolderModel.APPEND_ENDED="onFolderAppendEnded";class FolderItem extends Base{constructor(e){super(),this.name=e&&e.name}get folder(){return this._parent&&this._parent.folder}get parent(){return this._parent}get level(){return this._parent?this._parent.level+1:1}get name(){return this._name}set name(e){if(e!=this._name){this._name=e;const t=e?e.lastIndexOf("."):-1;this._ext=t>=0?e.substring(t+1):"",this._changed()}}get ext(){return this._ext}get path(){return(this._parent.isRoot?"":this._parent.path)+"/"+this._name}get displayText(){return this._name}get expandable(){return!1}getAbsolutePath(){const e=this.folder;return e?e.getAbsolutePath(this.path):this.path}_changed(){}}class FolderGroupItem extends FolderItem{constructor(e){super(e),this._expanded=!1,e&&this.$_load(e)}get count(){return this._children?this._children.length:0}get loaded(){return!!this._children}get isRoot(){return!1}get expanded(){return this._expanded}get collapsed(){return!this._expanded}get(e){return this._children[e]}getItems(){return this._children&&this._children.slice()}getDescendentCount(e=Number.MAX_SAFE_INTEGER){let t=0;if(e>0&&(t+=this.count,e>1&&this._children))for(let i of this._children)i instanceof FolderGroupItem&&(t+=i.getDescendentCount(e-1));return t}itemOf(e,t=!1){}find(e){if(this._children)for(let t of this._children)if(t.name===e)return t}reset(e){this._clear(),e&&this._addItems(e)}get expandable(){return!0}$_setExpanded(e){this._expanded=e}$_load(e){this._clear();const t=e.children;if(t&&t.length>0)for(let e of t)e.isDirectory||e.children?this._addItem(new FolderGroupItem(e)):this._addItem(new FolderItem(e))}_clear(){if(this._children){for(let e of this._children)e._parent=null;this._children=null}}_addItem(e,t=-1){const i=this._children=this._children||[];return t<0?i.push(e):i.splice(t,0,e),e._parent=this,e}_removeItem(e){if(e&&this._children){const t=this._children.indexOf(e);t>=0&&(this._children.splice(t,1),e._parent=null)}}_addItems(e){this._children=this._children||[];let t=0;for(let i=0;i<e.length;i++){const r=e[i];r.isDirectory||r.children?this._addItem(new FolderGroupItem(r)):this._addItem(new FolderItem(r)),t++}return t}}class FolderRootItem extends FolderGroupItem{constructor(e,t){super(t),this._model=e}get isRoot(){return!0}get folder(){return this._model}get parent(){return null}get path(){return"/"}}class FolderEditItem extends FolderGroupItem{constructor(){super(null)}beginEdit(e){this.name=e}}class FolderElement extends VisualElement{constructor(e,t){super(e,t)}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}measure(e,t){const i=this._doMeasure(e,t);return this._measuredWidth=i.width,this._measuredHeight=i.height,i}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(e){}_doMeasure(e,t){return new Size(e,t)}_doLayoutContent(){}}class FolderRowElement extends FolderElement{constructor(e,t){super(e,"FolderRowView"),this._vindex=-1,this._indents=0,this._focused=!1,this._selected=!1,this._model=t}_doDispose(){super._doDispose()}get model(){return this._model}set model(e){e!==this._model&&(this._model=e)}get vindex(){return this._vindex}get indents(){return this._spanText.getBoundingClientRect().left-this.getBoundingRect().left}get focused(){return this._focused}get selected(){return this._selected}get expandable(){return this._model instanceof FolderGroupItem&&this._model.expandable}get expanded(){return this._model instanceof FolderGroupItem&&this._model.expanded}setFocused(e){e!=this._focused&&(this._focused=e,this.invalidate())}setSelected(e){e!=this._selected&&(this._selected=e,this.invalidate())}clearText(){this._spanText.style.visibility="hidden"}_getCssSelector(){let e="rr-folder-row";return this._focused&&this._selected?e+=" rr-folder-row-focus rr-folder-row-select":this._focused?e+=" rr-folder-row-focus":this._selected&&(e+=" rr-folder-row-select"),e}_getCssDisplay(){return"flex"}_isEmptySize(){return!0}_initDom(e,t){super._initDom(e,t),t.appendChild(this._spanIndent=e.createElement("span")),t.appendChild(this._spanExpander=e.createElement("span")),t.appendChild(this._spanText=e.createElement("span")),this._spanText.className="rr-folder-label",t.draggable=!0}_doDraw(e){}_doMeasure(e,t){const i=this._model;let r="";switch(i.ext){case"r2":case"json":r=i.ext;break;case"png":case"jpg":case"jpeg":r="img";break;default:r=i.expandable?"":"file"}r?this._dom.dataset.type=r:delete this._dom.dataset.type,this._setClassName(null),this.setHint(this._model.getAbsolutePath()),this._indents=Math.max(8,FolderRowElement.INDENT_SIZE*(i.level-1)),this._spanIndent.style.minWidth=this._indents+"px";let s="";return s=i.expandable?i.expanded?"rr-folder-expander rr-folder-expander-expanded":"rr-folder-expander rr-folder-expander-collapsed":"rr-folder-expander",this._spanExpander.className=s,this._spanExpander.$_rvu=this.vindex,this._spanText.style.visibility="visible",this._spanText.textContent=i.displayText,new Size(e,this.offsetHeight)}_doLayoutContent(){}}FolderRowElement.INDENT_SIZE=8;class FolderBodyView extends FolderElement{constructor(e){super(e.doc,"FolderBodyView"),this._rows=[],this._rowPool=[],this._rowPoints=[0],this._inserting=!1,this._viewer=e}_doDispose(){super._doDispose()}get rowCount(){return this._rows.length}get focusedRow(){return this._focusedRow}get contentHeight(){return this._rowPoints[this._rowPoints.length-1]}get contentWidth(){return this.width}getRow(e){return this._rows[e]}getNext(e){if(e){const t=e.vindex;return t<this._rows.length-1?this._rows[t+1]:e}return this._rows.length>0?this._rows[0]:null}getPrev(e){if(e){const t=e.vindex;return t>0?this._rows[t-1]:e}return this._rows.length>0?this._rows[0]:null}getNextPage(e){if(!e)return this.getNext(e);const t=this._rowPoints;let i=this.getBoundingRect().height,r=this._rows.length,s=e.vindex;for(;s<r&&(i-=t[s+1]-t[s],!(i<=0));)s++;return this._rows[Math.min(r-1,s)]}getPrevPage(e){if(!e)return this.getPrev(e);const t=this._rowPoints;let i=this.getBoundingRect().height,r=e.vindex;for(;r>=0&&(i-=t[r+1]-t[r],!(i<=0));)r--;return this._rows[Math.max(0,r)]}findRow(e){return this.$_findRow(this._rows,e)}loadRows(e){if(this.clear(),!e)return;const t=e.getVisibleItems();for(let e=0;e<t.length;e++){const i=t[e],r=this.$_borrowRow(i);this._rows.push(r),this.addChild(r)}}refreshRows(e){if(!e)return void this.clear();const t=this._rows,i=e.getVisibleItems();let r;for(;t.length<i.length;)t.push(r=this.$_borrowRow(null)),this.addChild(r);for(;t.length>i.length;)this.$_returnRow(r=t.pop()),this.removeChild(r);for(let e=i.length-1;e>=0;e--)t[e].model=i[e]}isExpander(e){return e.classList.contains("rr-folder-expander")}rowByExpander(e){return this._rows[e.$_rvu]}rowOf(e){let t=e;for(;t;){if(t.classList.contains("rr-folder-row"))for(let e of this._rows)if(e.isDom(t))return e;t=t.parentElement}}get isLayer(){return!0}_getCssSelector(){return"rr-folder-body"}_setSizeStyle(e){}_initDom(e,t){super._initDom(e,t);const i=t.style;i.width="100%",i.height="100%",i.overflow="auto"}clear(){if(super.clear()){for(let e of this._rows)this.$_returnRow(e,!0);return this._rows=[],!0}}findChildAt(e,t,i,r){return t+=this._dom.scrollTop,super.findChildAt(e,t,i,r)}_doMeasure(e,t){const i=this._viewer,r=this._rows;let s=this._rowPoints=[0];this._focusedRow=null;for(let n=0;n<r.length;n++){const o=r[n],a=o.model;o.visible=!0,o._vindex=n,!this._focusedRow&&i.isFocused(a)?(o.setFocused(!0),this._focusedRow=o):o.setFocused(!1),o.setSelected(i.isSelected(a)),o.measure(e,t),s.push(s[n]+o.measuredHeight)}return new Size(e,s[s.length-1])}scrollToFocused(e,t){const i=this._focusedRow;if(i){const r=this._rowPoints,s=i.vindex;r[s]<e?e=r[s]+(s>0?(r[s-1]-r[s])/2:0):r[s+1]-e>=t&&(e=r[s+1]-t+(s<r.length-1?(r[s+1]-r[s])/2:0))}return e}_doLayoutContent(){const e=this._rows,t=this._rowPoints;for(let i=0;i<e.length;i++){const r=e[i];r.move(0,t[i]-0),r.layoutContent()}}$_borrowRow(e){if(this._rowPool.length>0){const t=this._rowPool.pop();return t.model=e,t.invalidate(),t}return new FolderRowElement(this.doc,e)}$_returnRow(e,t=!1){e&&(t||this._rowPool.indexOf(e)<0)&&(e.visible=!1,e._vindex=-1,e.setFocused(!1),e.setSelected(!1),this._rowPool.push(e),e.validate())}$_findRow(e,t){if(e)for(let i of e){if(i.model===t)return i;const e=this.$_findRow(i._children,t);if(e)return e}}}class FolderSelectionTool extends VisualTool{constructor(e){super(e,"FolderSelectionTool"),this._viewer=e}_doDispose(){this._viewer=null,super._doDispose()}get viewer(){return this._viewer}_doMouseDown(e){const t=this.mouseEventTarget,i=this.viewer.bodyView,r=this._clickedRow=i.rowOf(t);return!r||(r.model instanceof FolderItem&&this.viewer._fireMouseDown(r.model),!0)}_doMouseMove(e){}_doMouseUp(e){const t=this.mouseEventTarget,i=this._viewer,r=i.model,s=i.bodyView,n=s.rowOf(t);return!n||(s.isExpander(t)&&this.$_isClickedRow(t)&&(n.expanded?r.collapse(n.model):r.expand(n.model)),n.model instanceof FolderItem&&i._fireMouseUp(n.model),!0)}_doClick(e,t,i){var r;const s=e.ctrlKey||e.metaKey,n=e.shiftKey,o=this.mouseEventTarget,a=this._viewer,A=a.bodyView,l=A.rowOf(o);if(!l||l!==this._clickedRow)return;const h=l.model;if(a.focusedItem||(a.focusedItem=h),s)a.toggleSelect(h),a.focusedItem=h;else if(n){const e=a.focusedItem;if(e){const t=null===(r=A.findRow(e))||void 0===r?void 0:r.vindex,i=a.model.getVisibleItems(t||l.vindex,l.vindex);a.clearSelection(h),a.selectAll(i)}}else a.clearSelection(h),a.select(h),a.focusedItem=h}_doDblClick(e){const t=this._viewer,i=t.model,r=t.bodyView,s=this.mouseEventTarget,n=r.rowOf(s);if(n&&n===this._clickedRow){const e=n.model;e instanceof FolderGroupItem?e.expanded?i.collapse(e):i.expand(e):t._fireDoubleClicked(n.model)}}_doMouseWheel(e){const t=this._viewer;if(e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY))return!0;{const i=t.topPos;return t.topPos=i+e.deltaY,!0}}_doMouseEnter(e){}_doMouseLeave(e){}_doMouseOver(e){}_doContextMenu(e){return!1}_doKeyDown(e){const t=e.keyCode,i=e.shiftKey,r=this._viewer,s=r.bodyView,n=r.editing,o=s.focusedRow,a=s.getNext(o),A=s.getPrev(o),l=r.focusedItem,h=r.isSelected(l);switch(t){case 13:if(r.editing)return r.hideEdit(!0,!0),!0;if(r.showEdit())return!0;break;case 27:if(r.hideEdit(!1,!0))return!0;break;case 36:n||r.setFocusedRow(s.getRow(0));break;case 35:n||r.setFocusedRow(s.getRow(s.rowCount-1));break;case 40:if(n)break;r.setFocusedRow(a),i&&(h&&r.isSelected(a.model)?r.unselect(l):r.toggleSelect(a.model));break;case 38:if(n)break;r.setFocusedRow(A),i&&(h&&r.isSelected(A.model)?r.unselect(l):r.toggleSelect(A.model));break;case 34:n||r.setFocusedRow(s.getNextPage(o));break;case 33:n||r.setFocusedRow(s.getPrevPage(o));break;case 37:!n&&o&&(o.expanded?r.model.collapse(o.model):l.parent&&r.model.isVisible(l.parent)&&(r.focusedItem=l.parent));break;case 39:!n&&o&&(o.expandable&&!o.expanded?r.model.expand(o.model):l instanceof FolderGroupItem&&l.count>0&&(r.focusedItem=l.get(0)))}return super._doKeyDown(e)}_doKeyPress(e){return!1}_doKeyUp(e){return!1}_doDragStart(e){const t=this._clickedRow;return this.$_isRowFolderItem(t)&&this.viewer._fireDragStart(e,t.model),!0}_doDragEnd(e){const t=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(t)&&this.viewer._fireDragEnd(e,t.model),!0}_doDragEnter(e){const t=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(t)&&this.viewer._fireDragEnter(e,t.model),!0}_doDragOver(e){const t=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(t)&&this.viewer._fireDragOver(e,t.model),!0}_doDragLeave(e){const t=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(t)&&this.viewer._fireDragLeave(e,t.model),!0}_doDragDrop(e){const t=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(t)&&this.viewer._fireDragDrop(e,t.model),!0}$_findRowView(e){}$_enter(e,t){return e&&e.focus(),!1}$_esc(e,t){if(e&&(e.blur(),t instanceof FolderItem))return e.textContent=t.displayText,!0}$_getFolderRow(e){return this.viewer.bodyView.rowOf(e)}$_isClickedRow(e){const t=this._viewer.bodyView;return this._clickedRow===t.rowOf(e)}$_isRowFolderItem(e){return!!e&&e.model instanceof FolderItem}}class Selections$1{constructor(){this._items=[]}get items(){return this._items.length>0?this._items.slice():null}get last(){return this._items.length>0?this._items[this._items.length-1]:null}contains(e){return e&&this._items.indexOf(e)>=0}clear(){if(this._items.length>0)return this._items=[],!0}add(e){if(e&&this._items.indexOf(e)<0)return this._items.push(e),!0}addAll(e){if(e&&e.length>0){let t=!1;for(let i of e)this._items.indexOf(i)<0&&(this._items.push(i),t=!0);return t}}remove(e){if(e){const t=this._items.indexOf(e);if(t>=0)return this._items.splice(t,1),!0}}}class FolderEditMask extends VisualElement{show(e){if(!this.visible){this.visible=!0;const t=this._selectionCallback,i=e.getBoundingRect(),r=i.top-this.getBoundingRect().top;let s=this._row.style;if(s.top=r+"px",s.height=i.height+"px",s=this._input.style,s.marginLeft=e.indents+"px",s.marginRight="1px",e.clearText(),this._input.value=e.model.displayText,this._input.focus(),t){const i=t(e.model,this._input.value);i?this._input.setSelectionRange(i.start,i.end):this._input.select()}else this._input.select()}}hide(){this._input.blur(),this.visible=!1}layout(e){const t=e.getBoundingRect().top-this.getBoundingRect().top;this._row.style.top=t+"px"}_getCssSelector(){return"rr-folder-edit-mask"}_initDom(e,t){super._initDom(e,t),t.appendChild(this._row=e.createElement("div"));let i=this._row.style;i.position="absolute",i.left="0",i.width="100%",i.display="flex",i.background="rgba(255, 255, 255, 0.1)",this._row.appendChild(this._input=e.createElement("input")),this._input.className="rr-folder-root rr-folder-edit",this._input.type="text",this._input.spellcheck=!1,this._input.onblur=()=>{this.container.$_editorBlur(this._input.textContent)},i=this._input.style,i.boxSizing="border-box",i.flex="1 1 0",i.background="transparent",i.color="white",i.outline="none",i.height="100%",i.width="100%",i.padding="0",i.border="1px solid #0088ff",i.pointerEvents="auto"}_setSizeStyle(e){}_doDraw(e){}}class FolderViewer extends VisualContainer{constructor(e){super(e),this._selections=new Selections$1,this._focusRequested=!1,this._editHiding=!1,this.addElement(this._bodyView=new FolderBodyView(this)),this.addElement(this._editMask=new FolderEditMask(this.doc)),this._editMask.visible=!1}_doDispose(){super._doDispose()}onFolderSourceChanged(e){this._bodyView.loadRows(this.model),this.invalidateLayout()}onFolderItemAdded(e,t,i){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderItemsAdded(e,t,i){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderItemRemoved(e,t){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderItemsRemoved(e,t){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderFolderReset(e,t){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderExpanded(e,t,i){this._bodyView.refreshRows(this._model),this.invalidateLayout(),this._fireExpanded(t,i)}onFolderAppendStarted(e,t){this._bodyView.refreshRows(this._model),this.focusedItem=t.get(t.count-1),this.invalidateLayout(),setTimeout((()=>{this.showEdit()}))}onFolderAppendEnded(e,t,i){this.hideEdit(!1,!0),this._bodyView.refreshRows(this._model),this.invalidateLayout(),i&&this.onAppended&&this.onAppended(t,i)}get model(){return this._model}set model(e){e!==this._model&&(this._model&&this._model.removeListener(this),this._model=e,this._bodyView.loadRows(e),this.invalidateLayout(),this._model&&this._model.addListener(this))}get bodyView(){return this._bodyView}get topPos(){return this._bodyView.scrollTop}set topPos(e){(e=Math.max(0,Math.min(this._bodyView.contentHeight-this.getBound().height,e)))!=this.topPos&&(this._bodyView.scrollDom(this.leftPos,e),this.editing&&this._editMask.layout(this._bodyView.focusedRow))}get leftPos(){return this._bodyView.scrollLeft}set leftPos(e){(e=Math.max(0,Math.min(this._bodyView.contentWidth-this.getBound().width,e)))!=this.leftPos&&this._bodyView.scrollDom(e,this.topPos)}get focusedItem(){return this._focusedItem}set focusedItem(e){if(e!==this._focusedItem){const t=this._focusedItem;this._focusedItem=e,this.invalidateLayout(),this._focusRequested=!0,this._fireFocusedChanged(e,t)}}get selection(){return this._selections.items}get lastSelectedItem(){return this._selections.last}get editing(){return this._editMask.visible}get onEditSelect(){return this._editMask._selectionCallback}set onEditSelect(e){this._editMask._selectionCallback=e}clearSelection(e){const t=this._selections.clear();(e&&this._selections.add(e)||t)&&this.invalidateLayout()}select(e){this._selections.add(e)&&this.invalidateLayout()}toggleSelect(e){this._selections.contains(e)?this._selections.remove(e):this._selections.add(e),this.invalidateLayout()}selectAll(e){e||(e=this._model.getVisibleItems()),e&&this._selections.addAll(e)&&this.invalidateLayout()}unselect(e){this._selections.remove(e)&&this.invalidateLayout()}isFocused(e){return this._focusedItem===e}isSelected(e){return this._selections.contains(e)}itemOfDom(e){const t=this._bodyView.rowOf(e);return t&&t.model}showEdit(){if(!this._editMask.visible&&this._bodyView.focusedRow)return this._editMask.show(this._bodyView.focusedRow),!0}hideEdit(e,t){if(!this._editHiding&&this._editMask.visible){this._editHiding=!0;try{const i=this._editMask._input.value;return this._editMask.hide(),t&&this.setFocus(),e?this._model.isInserting()?(this.focusedItem.name=i,this._model.endAppend(!0)):this.$_acceptEdit(i):this._model.isInserting()&&this._model.endAppend(!1),this.invalidateLayout(),!0}finally{this._editHiding=!1}}}setFocusedRow(e){this.focusedItem=e&&e.model}_createDefaultTool(){return new FolderSelectionTool(this)}_doPrepareContainer(e){e.className="rr-folder-root rr-folder"}_doLayout(e){const t=this._bodyView,i=this.topPos;t.measure(e.width,e.height),t.layoutContent(),this._focusRequested?(this._focusRequested=!1,this.topPos=t.scrollToFocused(i,e.height)):this.topPos=i,this.editing&&this._editMask.layout(this._bodyView.focusedRow)}setFocus(){this.editing?this._editMask._input.focus():super.setFocus()}$_acceptEdit(e){const t=this.onEdit;t&&t(this.focusedItem,e)}$_editorBlur(e){this.hideEdit(!0,!0)}_fireFocusedChanged(e,t){this.fireEvent(FolderViewer.FOCUSED_CHANGED,e,t)}_fireExpanded(e,t){this.fireEvent(FolderViewer.EXPANDED,e,t)}_fireDoubleClicked(e){this.fireEvent(FolderViewer.DOUBLE_CLICKED,e)}_fireMouseDown(e){this.fireEvent(FolderViewer.MOUSE_DOWN,e)}_fireMouseUp(e){this.fireEvent(FolderViewer.MOUSE_UP,e)}_fireDragStart(e,t){this.fireEvent(FolderViewer.DRAG_START,e,t)}_fireDragEnd(e,t){this.fireEvent(FolderViewer.DRAG_END,e,t)}_fireDragOver(e,t){this.fireEvent(FolderViewer.DRAG_OVER,e,t)}_fireDragEnter(e,t){this.fireEvent(FolderViewer.DRAG_ENTER,e,t)}_fireDragLeave(e,t){this.fireEvent(FolderViewer.DRAG_LEAVE,e,t)}_fireDragDrop(e,t){this.fireEvent(FolderViewer.DRAG_DROP,e,t)}}FolderViewer.FOCUSED_CHANGED="onFolderFocusedChanged",FolderViewer.EXPANDED="onFolderExpanded",FolderViewer.DOUBLE_CLICKED="onFolderDoubleClicked",FolderViewer.MOUSE_DOWN="onFolderMouseDown",FolderViewer.MOUSE_UP="onFolderMouseUp",FolderViewer.DRAG_START="onFolderDragStart",FolderViewer.DRAG_END="onFolderDragEnd",FolderViewer.DRAG_OVER="onFolderDragOver",FolderViewer.DRAG_ENTER="onFolderDragEnter",FolderViewer.DRAG_LEAVE="onFolderDragLeave",FolderViewer.DRAG_DROP="onFolderDragDrop";class TreeModel extends EventAware{constructor(e){super(),this.$_setSource(e)}_doDispose(){this._source=null,super._doDispose()}get source(){return this._source}set source(e){e!==this._source&&this.$_setSource(e)}get root(){return this._root}findByTag(e){return this._root.findByTag(e)}addItem(e,t){if(t){const i=new TreeItem(t),r=(e=e||this._root).add(i);if(r>=0)return this._fireItemAdded(i,r),i}}removeItem(e){if(e&&e.tree){const t=e.parent;t.remove(e)&&this._fireItemRemoved(e,t)}}$_setSource(e){this._source=e,this.$_build(e),this._fireSourceChanged()}$_build(e){this._root=new TreeRootItem(this,this._source=e),this._root.tag=e&&e.tag}_fireSourceChanged(){this.fireEvent(TreeModel.SOURCE_CHANGED)}_fireItemAdded(e,t){this.fireEvent(TreeModel.ITEM_ADDED,e,t)}_fireItemRemoved(e,t){this.fireEvent(TreeModel.ITEM_REMOVED,e,t)}}TreeModel.SOURCE_CHANGED="onTreeRootChanged",TreeModel.ITEM_ADDED="onTreeItemAdded",TreeModel.ITEM_REMOVED="onTreeItemRemoved";class TreeItem extends Base{constructor(e){super(),this._editable=!0,(this._source=e)&&this.$_load(e)}get tree(){return this._parent&&this._parent.tree}get parent(){return this._parent}get count(){return this._children?this._children.length:0}get source(){return this._source}get name(){return this._name}set name(e){e!=this._name&&(this._name=e)}get editable(){return this._editable}get path(){return this._parent.path+"/"+this._name}get displayText(){return this._name}get expandable(){return this.count>0}get(e){return this._children[e]}findByTag(e){if(e===this.tag)return this;if(this._children)for(let t of this._children){const i=t.findByTag(e);if(i)return i}}add(e){return e&&!e.parent?(this._addItem(e),this._children.length-1):-1}remove(e){if(e&&e.parent===this)return this._removeItem(e),!0}$_load(e){this._name=e.name,this._editable=!1!==e.editable,this.tag=e.tag,this._clear();const t=e.children;if(t&&t.length>0)for(let e of t)this._addItem(new TreeItem(e))}_clear(){if(this._children){for(let e of this._children)e._parent=null;this._children=null}}_addItem(e,t=-1){const i=this._children=this._children||[];return t<0?i.push(e):i.splice(t,0,e),e._parent=this,e}_removeItem(e){if(e&&this._children){const t=this._children.indexOf(e);t>=0&&(this._children.splice(t,1),e._parent=null)}}}class TreeRootItem extends TreeItem{constructor(e,t){super(t),this._model=e}get tree(){return this._model}get parent(){return null}get path(){return"/"}}class TreeElement extends VisualElement{constructor(e,t){super(e,t)}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}measure(e,t){const i=this._doMeasure(e,t);return this._measuredWidth=i.width,this._measuredHeight=i.height,i}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(e){}_doMeasure(e,t){return new Size(e,t)}_doLayoutContent(){}}class TreeRowElement extends TreeElement{constructor(e,t){super(e,"TreeRowView"),this._expanded=!1,this._vindex=-1,this._focused=!1,this._selected=!1,this._model=t}_doDispose(){super._doDispose()}get model(){return this._model}set model(e){e!==this._model&&(this._model=e)}get parentRow(){return this._parentRow}get level(){return this._parentRow?this._parentRow.level+1:1}get rows(){return this._childRows&&this._childRows.slice()}get rowCount(){return this._childRows?this._childRows.length:0}get expanded(){return this._expanded}set expanded(e){e!=this._expanded&&(this._expanded=e)}get vindex(){return this._vindex}get indents(){return this._spanText.getBoundingClientRect().left-this.getBoundingRect().left}get focused(){return this._focused}get selected(){return this._selected}getRow(e){return this._childRows[e]}addRow(e,t){this._childRows||(this._childRows=[]),this._childRows.splice(t,0,e),e._parentRow=this}removeRow(e){if(e&&this._childRows){const t=this._childRows.indexOf(e);t>=0&&(this._childRows.splice(t,1),e.clearRow())}}clearRow(){if(this._childRows){for(let e of this._childRows)e.clearRow();this._childRows=null}this._parentRow=null,this.visible=!1}setFocused(e){e!=this._focused&&(this._focused=e,this.invalidate())}setSelected(e){e!=this._selected&&(this._selected=e,this.invalidate())}clearText(){this._spanText.style.visibility="hidden"}showText(){this._spanText.style.visibility=""}_getCssSelector(){let e="rr-tree-row";return this._focused?e+=" rr-tree-row-focus":this._selected&&(e+=" rr-tree-row-select"),e}_getCssDisplay(){return"flex"}_isEmptySize(){return!0}_initDom(e,t){super._initDom(e,t),t.appendChild(this._spanIndent=e.createElement("span")),t.appendChild(this._spanExpander=e.createElement("span")),t.appendChild(this._spanText=e.createElement("span")),this._spanText.className="rr-tree-label"}_doDraw(e){}_doMeasure(e,t){const i=this._model.source.type;i?this._dom.dataset.type=i:delete this._dom.dataset.type,this._setClassName(null),this._spanIndent.style.minWidth=TreeRowElement.INDENT_SIZE*this.level+"px";let r="";return r=this._model.count>0?this.expanded?"rr-tree-expander rr-tree-expander-expanded":"rr-tree-expander rr-tree-expander-collapsed":"rr-tree-expander",this._spanExpander.className=r,this._spanExpander.$_rvu=this.vindex,this._spanText.textContent=this._model.displayText,new Size(e,this.offsetHeight)}_doLayoutContent(){}}TreeRowElement.INDENT_SIZE=8;class TreeBodyView extends TreeElement{constructor(e){super(e.doc,"treeBodyView"),this._visibleRows=[],this._rows=[],this._rowPool=[],this._rowPoints=[0],this._viewer=e}_doDispose(){super._doDispose()}get visibleRowCount(){return this._visibleRows.length}get rowCount(){return this._rows.length}get focusedRow(){return this._focusedRow}get contentHeight(){return this._rowPoints[this._rowPoints.length-1]}get contentWidth(){return this.width}getVisible(e){return this._visibleRows[e]}getVisibleItems(e=0,t=-1){const i=this._visibleRows;if(e=Math.max(0,e),(t=t<0?i.length=1:Math.min(t,i.length-1))<e){const i=e;e=t,t=i}const r=[];for(let s=e;s<=t;s++)r.push(i[s].model);return r}findVisibleRow(e){return this.$_findRow(this._visibleRows,e)}findRow(e){return this.$_findRow(this._rows,e)}loadRows(e){if(this.clear(),!e)return;const t=this._root=this.$_borrowRow(e.root);this._rows.push(t),this._visibleRows.push(t),this.addChild(t),this.$_loadRows(t),this._viewer.rootVisible||this.expand(t)}addRow(e,t){let i=this.findRow(e.parent);if(i){const r=this.$_borrowRow(e);if(i.addRow(r,t),i=this.findVisibleRow(i.model),i&&i.expanded&&(this.collapse(i),this.expand(i)),this.addChild(r),this._rows.push(r),e instanceof TreeItem)for(let t=0;t<e.count;t++)this.addRow(e.get(t),t);this.invalidateLayout()}}addRows(e,t){let i=this.findRow(e);if(i){const r=[];let s=e.count-t;for(let n=0;n<t;n++){const t=this.$_borrowRow(e.get(s+n));i.addRow(t,s+n),r.push(t)}i=this.findVisibleRow(e),i.expanded&&(this.collapse(i),this.expand(i));for(let e=0;e<t;e++)this.addChild(r[e]),this._rows.push(r[e]);this.invalidateLayout()}}removeRow(e){const t=this.findRow(e);if(!t)return;const i=t.parentRow,r=i.expanded,s=this._rows.indexOf(t);r&&this.collapse(i),s>=0&&this.$_removeRow(t),r&&this.expand(i),this.invalidateLayout()}removeRows(e){for(let t of e)this.removeRow(t)}expand(e,t=!1){if((e=e||this._root)&&!e.expanded){const i=this._visibleRows,r=i.indexOf(e)+1;assert(r>0);const s=[];let n=0;e.expanded=!0,this.$_collectVisibleRows(e,s,t);for(let e of s)i.splice(r+n,0,s[n]),n++;return this.invalidateLayout(),!0}}expandAll(e){this.collapseAll(e),this.expand(e,!0)}collapse(e,t=!1){if((e=e||this._root)&&e.expanded){const i=this.$_hideRows(e,t),r=this._visibleRows.indexOf(e)+1;return this._visibleRows.splice(r,i),e.expanded=!1,this.invalidateLayout(),!0}}collapseAll(e){this.collapse(e,!0)}isVisible(e){for(let t of this._visibleRows)if(t.model===e)return!0;return!1}makeVisible(e){const t=this.findRow(e);if(t.vindex>=0)return;let i=t.parentRow;for(;i;){if(i.expanded=!0,i.vindex>=0){this.collapse(i),this.expand(i,!0);break}i=i.parentRow}}isExpander(e){return e.classList.contains("rr-tree-expander")}rowByExpander(e){return this.getVisible(e.$_rvu)}rowOf(e){let t=e;for(;t;){if(t.classList.contains("rr-tree-row"))for(let e of this._visibleRows)if(e.isDom(t))return e;t=t.parentElement}}getNextVisible(e){const t=this._visibleRows;if(e){const i=e.vindex;return i<t.length-1?t[i+1]:e}return t.length>0?t[0]:null}getPrevVisible(e){const t=this._visibleRows;if(e){const i=e.vindex;return i>0?t[i-1]:e}return t.length>0?t[0]:null}getNextPageVisible(e){if(!e)return this.getNextVisible(e);const t=this._visibleRows,i=this._rowPoints;let r=this.getBoundingRect().height,s=t.length,n=e.vindex;for(;n<s&&(r-=i[n+1]-i[n],!(r<=0));)n++;return t[Math.min(s-1,n)]}getPrevPageVisible(e){if(!e)return this.getPrevVisible(e);const t=this._visibleRows,i=this._rowPoints;let r=this.getBoundingRect().height,s=e.vindex;for(;s>=0&&(r-=i[s+1]-i[s],!(r<=0));)s--;return t[Math.max(0,s)]}get isLayer(){return!0}_getCssSelector(){return"rr-tree-body"}_setSizeStyle(e){}_initDom(e,t){super._initDom(e,t);const i=t.style;i.width="100%",i.height="100%",i.overflow="auto"}clear(){if(super.clear()){for(let e of this._rows)this.$_returnRow(e,!0);return this._rows=[],this._visibleRows=[],!0}}findChildAt(e,t,i,r){return t+=this._dom.scrollTop,super.findChildAt(e,t,i,r)}_doMeasure(e,t){const i=this._viewer;var r=this._rowPoints=[0];this._focusedRow=null;for(let e of this._rows)e.visible=!1,e._vindex=-1,e.setFocused(!1);!i.rootVisible&&this._visibleRows[0]&&this._visibleRows[0].model instanceof TreeRootItem&&this._visibleRows.splice(0,1);for(let s=0;s<this._visibleRows.length;s++){const n=this._visibleRows[s],o=n.model;n.visible=!0,n._vindex=s,!this._focusedRow&&i.isFocused(o)&&(n.setFocused(!0),this._focusedRow=n),n.setSelected(i.isSelected(o)),n.measure(e,t),r.push(r[s]+n.measuredHeight)}return new Size(e,r[r.length-1])}scrollToFocused(e,t){const i=this._focusedRow;if(i){const r=this._rowPoints,s=i.vindex;r[s]<e?e=r[s]+(s>0?(r[s-1]-r[s])/2:0):r[s+1]-e>=t&&(e=r[s+1]-t+(s<r.length-1?(r[s+1]-r[s])/2:0))}return e}_doLayoutContent(){const e=this._rowPoints;for(let t=0;t<this._visibleRows.length;t++){const i=this._visibleRows[t];i.move(0,e[t]-0),i.layoutContent()}}$_borrowRow(e){if(this._rowPool.length>0){const t=this._rowPool.pop();return t.model=e,t.expanded=!1,t.invalidate(),t}return new TreeRowElement(this.doc,e)}$_returnRow(e,t=!1){e&&(t||this._rowPool.indexOf(e)<0)&&(e.clearRow(),this._rowPool.push(e))}$_loadRows(e){const t=e.model,i=t.count;if(i>0)for(let r=0;r<i;r++){const i=t.get(r),s=this.$_borrowRow(i);this._rows.push(s),this.addChild(s),e.addRow(s,r),this.$_loadRows(s)}}$_findRow(e,t){if(e)for(let i of e){if(i.model===t)return i;const e=this.$_findRow(i._children,t);if(e)return e}}$_collectVisibleRows(e,t,i){for(let r=0;r<e.rowCount;r++){const s=e.getRow(r);t.push(s),(s.expanded||i)&&(s.expanded=!0,this.$_collectVisibleRows(s,t,i))}}$_hideRows(e,t){let i=0;i+=e.rowCount;for(let r=0;r<e.rowCount;r++){const s=e.getRow(r);(s.expanded||t)&&(i+=this.$_hideRows(s,t))}return i}$_removeRow(e){const t=this._rows.indexOf(e);if(t>=0){for(let i=0;t<e.rowCount;i++)this.$_removeRow(e.getRow(i));e.parentRow.removeRow(e),this.removeChild(e),this._rows.splice(t,1),this.$_returnRow(e)}}}class TreeSelectionTool extends VisualTool{constructor(e){super(e,"TreeSelectionTool"),this._viewer=e}_doDispose(){this._viewer=null,super._doDispose()}get viewer(){return this._viewer}_doMouseDown(e){const t=this.mouseEventTarget,i=this._viewer,r=i.bodyView,s=this._clickedRow=r.rowOf(t);return s&&r.isExpander(t)&&(s.expanded?i.collapse(s):i.expand(s)),!0}_doMouseMove(e){}_doMouseUp(e){}_doClick(e,t,i){const r=e.ctrlKey||e.metaKey,s=e.shiftKey,n=this.mouseEventTarget,o=this._viewer,a=o.bodyView.rowOf(n);if(a&&a===this._clickedRow){const e=a.model;if(r)o.toggleSelect(e),o.focusedItem||(o.focusedItem=e);else if(s){const t=o.lastSelectedItem;if(t){const e=o.bodyView.findVisibleRow(t),i=o.bodyView.getVisibleItems(e.vindex,a.vindex);o.selectAll(i)}else o.select(e);o.focusedItem||(o.focusedItem=e)}else o.clearSelection(e),o.focusedItem=e;o.focusedItem||(o.focusedItem=e)}}_doDblClick(e){const t=this._viewer,i=t.bodyView,r=this.mouseEventTarget,s=i.rowOf(r);s&&s===this._clickedRow&&(s.model.count>0?s.expanded?t.collapse(s):t.expand(s):t._fireDoubleClicked(s.model))}_doMouseWheel(e){const t=this._viewer;if(e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY))return!0;{const i=t.topPos;return t.topPos=i+e.deltaY,!0}}_doMouseEnter(e){}_doMouseLeave(e){}_doMouseOver(e){}_doContextMenu(e){return!1}_doKeyDown(e){const t=e.keyCode,i=this._viewer,r=i.bodyView,s=r.focusedRow,n=i.focusedItem,o=i.editing;switch(t){case 13:if(o)return i.hideEdit(!0,!0),!0;if(i.showEdit())return!0;break;case 27:if(i.hideEdit(!1,!0))return!0;break;case 40:!o&&i.setFocusedRow(r.getNextVisible(s));break;case 38:!o&&i.setFocusedRow(r.getPrevVisible(s));break;case 34:!o&&i.setFocusedRow(r.getNextPageVisible(s));break;case 33:!o&&i.setFocusedRow(r.getPrevPageVisible(s));break;case 36:!o&&i.setFocusedRow(r.getVisible(0));break;case 35:!o&&i.setFocusedRow(r.getVisible(r.visibleRowCount-1));break;case 37:!o&&s&&(s.expanded?r.collapse(s):s.parent&&r.isVisible(n.parent)&&(i.focusedItem=n.parent));break;case 39:!o&&s&&(s.expanded?n.count>0&&(i.focusedItem=n.get(0)):r.expand(s))}return super._doKeyDown(e)}_doKeyPress(e){return!1}_doKeyUp(e){return!1}$_findRowView(e){}}class Selections{constructor(){this._items=[]}get items(){return this._items.length>0?this._items.slice():null}get last(){return this._items.length>0?this._items[this._items.length-1]:null}contains(e){return e&&this._items.indexOf(e)>=0}clear(){if(this._items.length>0)return this._items=[],!0}add(e){if(e&&this._items.indexOf(e)<0)return this._items.push(e),!0}addAll(e){if(e&&e.length>0){let t=!1;for(let i of e)this._items.indexOf(i)<0&&(this._items.push(i),t=!0);return t}}remove(e){if(e){const t=this._items.indexOf(e);if(t>=0)return this._items.splice(t,1),!0}}}class TreeEditMask extends VisualElement{show(e){if(!this.visible){this.visible=!0;const t=this._selectionCallback,i=e.getBoundingRect(),r=i.top-this.getBoundingRect().top;let s=this._row.style;if(s.top=r+"px",s.height=i.height+"px",s=this._input.style,s.marginLeft=e.indents+"px",s.marginRight="1px",e.clearText(),this._input.value=e.model.displayText,this._input.focus(),t){const i=t(e.model,this._input.value);i?this._input.setSelectionRange(i.start,i.end):this._input.select()}else this._input.select()}}hide(){this._input.blur(),this.visible=!1}layout(e){const t=e.getBoundingRect().top-this.getBoundingRect().top;this._row.style.top=t+"px"}_getCssSelector(){return"rr-tree-edit-mask"}_initDom(e,t){super._initDom(e,t),t.appendChild(this._row=e.createElement("div"));let i=this._row.style;i.position="absolute",i.left="0",i.width="100%",i.display="flex",i.background="rgba(255, 255, 255, 0.1)",this._row.appendChild(this._input=e.createElement("input")),this._input.className="rr-tree-root rr-tree-edit",this._input.type="text",this._input.spellcheck=!1,this._input.onblur=()=>{this.container.$_editorBlur(this._input.textContent)},i=this._input.style,i.boxSizing="border-box",i.flex="1 1 0",i.background="transparent",i.color="white",i.outline="none",i.height="100%",i.width="100%",i.padding="0",i.border="1px solid #0088ff",i.pointerEvents="auto"}_setSizeStyle(e){}_doDraw(e){}}class TreeViewer extends VisualContainer{constructor(e){super(e),this._rootVisible=!0,this._selections=new Selections,this._focusRequested=!1,this._editHiding=!1,this.addElement(this._bodyView=new TreeBodyView(this)),this.addElement(this._editMask=new TreeEditMask(this.doc)),this._editMask.visible=!1}_doDispose(){super._doDispose()}onTreeSourceChanged(e){this._bodyView.loadRows(this.model),this.invalidateLayout(),this._fireModelChanged()}onTreeItemAdded(e,t,i){this._bodyView.addRow(t,i),this.invalidateLayout(),this._fireModelChanged()}onTreeItemRemoved(e,t){this._bodyView.removeRow(t),t===this.focusedItem&&(this.focusedItem=null),this.invalidateLayout(),this._fireModelChanged()}get model(){return this._model}set model(e){e!==this._model&&(this._model&&this._model.removeListener(this),this._model=e,this._bodyView.loadRows(e),this.invalidateLayout(),this._model&&this._model.addListener(this))}get rootVisible(){return this._rootVisible}set rootVisible(e){e!=this._rootVisible&&(this._rootVisible=e,this._bodyView.loadRows(this._model),this.invalidateLayout())}get bodyView(){return this._bodyView}get topPos(){return this._bodyView.scrollTop}set topPos(e){(e=Math.max(0,Math.min(this._bodyView.contentHeight-this.getBound().height,e)))!=this.topPos&&this._bodyView.scrollDom(this.leftPos,e)}get leftPos(){return this._bodyView.scrollLeft}set leftPos(e){(e=Math.max(0,Math.min(this._bodyView.contentWidth-this.getBound().width,e)))!=this.leftPos&&this._bodyView.scrollDom(e,this.topPos)}get focusedItem(){return this._focusedItem}set focusedItem(e){if(e!==this._focusedItem){const t=this._focusedItem;this._focusedItem=e,e&&this.makeVisible(e),this.invalidateLayout(),this.clearSelection(),this._focusRequested=!0,this._fireFocusedChanged(e,t)}}get selection(){return this._selections.items}get lastSelectedItem(){return this._selections.last}get editing(){return this._editMask.visible}expand(e){if((!e||e.model.expandable)&&this._bodyView.expand(e)){const t=e?e.model:this._model.root;this._fireExpanded(t,!0)}}expandAll(e){e&&!e.model.expandable||this._bodyView.expandAll(e)}collapse(e){if((!e||e.model.expandable)&&this._bodyView.collapse(e)){const t=e?e.model:this._model.root;this._fireExpanded(t,!1)}}collapseAll(e){e&&!e.model.expandable||this._bodyView.collapseAll(e)}clearSelection(e){const t=this._selections.clear();(e&&this._selections.add(e)||t)&&this.invalidateLayout()}select(e){this._selections.add(e)&&this.invalidateLayout()}toggleSelect(e){this._selections.contains(e)?this._selections.remove(e):this._selections.add(e),this.invalidateLayout()}selectAll(e){e||(e=this._bodyView.getVisibleItems()),e&&this._selections.addAll(e)&&this.invalidateLayout()}unselect(e){this._selections.remove(e)&&this.invalidateLayout()}setFocusedRow(e){this.focusedItem=e&&e.model}isFocused(e){return this._focusedItem===e}isSelected(e){return this._selections.contains(e)}itemOfDom(e){const t=this._bodyView.rowOf(e);return t&&t.model}showEdit(){if(!this._editMask.visible){const e=this._bodyView.focusedRow;if(e&&e.model.editable)return this._editMask.show(e),!0}}hideEdit(e,t){if(!this._editHiding&&this._editMask.visible){this._editHiding=!0;try{const i=this._bodyView.focusedRow,r=this._editMask._input.value;return this._editMask.hide(),t&&this.setFocus(),e&&this.$_acceptEdit(r),i.showText(),this.invalidateLayout(),!0}finally{this._editHiding=!1}}}makeVisible(e){e&&this._bodyView.makeVisible(e)}_createDefaultTool(){return new TreeSelectionTool(this)}_doPrepareContainer(e){e.className="rr-tree-root rr-tree"}_doLayout(e){const t=this.topPos;this._bodyView.measure(e.width,e.height),this._bodyView.setBounds(0,0,e.width,e.height),this._bodyView.layoutContent(),this._focusRequested?(this._focusRequested=!1,this.topPos=this._bodyView.scrollToFocused(t,e.height)):this.topPos=t}setFocus(){this.editing?this._editMask._input.focus():super.setFocus()}$_acceptEdit(e){const t=this.onEdit;t&&t(this.focusedItem,e)}$_editorBlur(e){this.hideEdit(!0,!0)}_fireFocusedChanged(e,t){this.fireEvent(TreeViewer.FOCUSED_CHANGED,e,t)}_fireExpanded(e,t){this.fireEvent(TreeViewer.EXPANDED,e,t)}_fireDoubleClicked(e){this.fireEvent(TreeViewer.DOUBLE_CLICKED,e)}_fireModelChanged(){this.fireEvent(TreeViewer.Model_CHANGED)}}TreeViewer.FOCUSED_CHANGED="onTreeFocusedChanged",TreeViewer.EXPANDED="onTreeExpanded",TreeViewer.DOUBLE_CLICKED="onTreeDoubleClicked",TreeViewer.Model_CHANGED="onTreeModelChanged";class AccordionModel extends EventAware{constructor(e){super(),this._items=[],e&&this.$_load(e)}_doDispose(){super._doDispose()}get count(){return this._items.length}getItem(e){return this._items[e]}itemOf(e){for(let t of this._items)if(t.id===e)return t}$_load(e){for(let t of e)if(t&&t.id){const e=new AccordionItem(t.id,t);this.$_addItem(e)}}$_addItem(e){e&&this._items.indexOf(e)<0&&this._items.push(e)}_fireItemAdded(e,t){this.fireEvent(AccordionModel.ITEM_ADDED,e,t)}_fireItemRemoved(e){this.fireEvent(AccordionModel.ITEM_REMOVED,e)}}AccordionModel.ITEM_ADDED="onAccordionItemAdded",AccordionModel.ITEM_REMOVED="onAccordionItemRemoved";class AccordionItem extends Base{constructor(e,t){super(),this.height=100,this._id=e,t&&(this._header=t.header)}get id(){return this._id}get header(){return this._header}set header(e){e!=this._header&&(this._header=e)}get hint(){return this._hint}set hint(e){e!=this._hint&&(this._hint=e)}get displayText(){return this._header||this._id}}class AccordionResizeTracker extends UIDragTracker{constructor(e,t){super(null,"accordionResizeTracker"),this._accordion=e,this._separator=t,this._panelsHeight=e._panelsHeight;const i=this._separator.$_idx;this._upperHeight=this._accordion.getHeader(i).model.height,this._lowerHeight=this._accordion.getHeader(i+1).model.height}_doDispose(){this._accordion=null,this._separator=null,super._doDispose()}get startWhenCreated(){return!0}_doStart(e,t,i,r,s){return this._separator.setPointerCapture(e.pointerId),!0}_doDrag(e,t,i){let r=this.startY-this.currentY;const s=this._accordion.height,n=this._panelsHeight,o=this._accordion.getVisibleHeaders(),a=this._separator.$_idx,A=this._accordion.getHeader(a),l=this._accordion.getHeader(a+1),h=A.model.height+l.model.height;let d=0;for(let e of o)d+=e.model.height;return r*=n/s,r*=d/n,l.model.height=Math.max(20,this._lowerHeight+r),A.model.height=h-l.model.height,A.model.height<20&&(r=20-A.model.height,A.model.height=20,l.model.height-=r),this._accordion.invalidateLayout(),!0}_doEnded(e){this._separator.releasePointerCapture(e.pointerId)}}class AccordionSelectionTool extends UITool{constructor(e){super(null,"accordionSelectionTool"),this._container=e}_doDispose(){this._container=null,this._clickedDom=null,super._doDispose()}get container(){return this._container}_doPointerDown(e){const t=this._clickedDom=this.pointerEventTarget;if(this._container.isSeparator(t))return this.dragTracker=new AccordionResizeTracker(this._container,t),!0}_doClick(e,t,i){const r=this.pointerEventTarget;if(!this._container.checkMenu(r)&&r===this._clickedDom){const e=this._container.headerViewOf(r);e&&(e.expanded=!e.expanded)}}}class AccordionContainer extends UIContainer{constructor(e){super(e),this._separatorPool=[],this._headerPool=[],this._panelPool=[],this._separators=[],this._headers=[],this._panels=[],this._visibleHeaders=[],this._panelsHeight=0}_doDispose(){super._doDispose()}get model(){return this._model}set model(e){e!==this._model&&(this._model&&this._model.removeListener(this),this._model=e,this.invalidateLayout(),this._model&&this._model.addListener(this))}getHeader(e){return this._headers[e]}headerViewOf(e){let t=e;for(;t;){for(let e of this._headers)if(e.isDom(t))return e;t=t.parentElement}}getVisibleHeaders(){return this._visibleHeaders}itemOf(e){const t=this.headerViewOf(e);return t&&t.model}checkMenu(e){if(this._toolbar.isMenu(e))return this.$_fireMenu(),!0}expand(e,t){if(e)for(let i of this._headers)if(i.model===e){i.expanded=t;break}}isMenu(e){return this._toolbar.isMenu(e)}isSeparator(e){return e.classList.contains("rr-accordion-separator")}_getCssSelector(){return"rr-accordion rr-accordion-root"}_createDefaultTool(){return new AccordionSelectionTool(this)}_prepareChildren(e,t){this._addElement(this._toolbar=new AccordionToolbar(e)),this._addElement(this._body=new AccordionBodyElement(e))}_doLayout(e,t){const i=this._model;i?(this.$_prepareElements(e,i,this._body),this.$_layoutElements(e,i)):this.$_clear()}$_clear(){const e=this._body;this._separatorPool=this._separatorPool.concat(this._separators),this._headerPool=this._headerPool.concat(this._headers),this._panelPool=this._panelPool.concat(this._panels),e.clear()}$_borrowSeparator(e){return this._separatorPool.pop()||new AccordionSeparator(e)}$_borrowHeader(e){return this._headerPool.pop()||new AccordionHeaderElement(e)}$_borrowPanel(e){return this._panelPool.pop()||new AccordionPanelElement(e)}$_prepareElements(e,t,i){const r=t.count;for(;this._separators.length<r-1;){const t=this.$_borrowSeparator(e);i.addChild(t),this._separators.push(t)}for(;this._separators.length>r-1;){const e=this._separators.pop();i.removeChild(e),this._separatorPool.push(e)}for(;this._headers.length<r;){const t=this.$_borrowHeader(e);i.addChild(t),this._headers.push(t)}for(;this._headers.length>r;){const e=this._headers.pop();i.removeChild(e),this._headerPool.push(e)}for(;this._panels.length<r;){const t=this.$_borrowPanel(e);i.addChild(t),this._panels.push(t)}for(;this._panels.length>r;){const e=this._panels.pop();i.removeChild(e),this._panelPool.push(e)}for(let e=0;e<this._panels.length;e++)this._panels[e].setContentId(t.getItem(e))}$_calcPanelHeights(e,t){const i=this._headers,r=this._panels;let s=0;for(let t=0;t<e.count;t++)i[t].expanded&&(s+=e.getItem(t).height);for(let n=0;n<r.length;n++)i[n].expanded&&(r[n].userData=e.getItem(n).height*t/s)}$_layoutElements(e,t){const i=this._separators,r=this._headers,s=this._panels;let n=0,o=2*(t.count-1);this._visibleHeaders=[];for(let e=0;e<t.count;e++){const i=t.getItem(e),s=r[e];s.layout(i),o+=s.height,s.expanded&&this._visibleHeaders.push(s)}this._panelsHeight=this.height-this._toolbar.height-o,this.$_calcPanelHeights(t,this._panelsHeight);for(let e=0;e<t.count;e++){const o=t.getItem(e),a=r[e],A=s[e];if(e>0){const t=i[e-1];t._dom.$_idx=e-1,t.y=n,n+=t.height,t.setStyle("cursor",a.expanded?"ns-resize":"default")}a.y=n,n+=a.height,a.expanded?(A.setStyles({display:"",height:A.userData+"px",top:n+"px"}),n+=A.userData,A.layout(o)):A.setStyle("display","none")}}$_fireMenu(){this.fireEvent(AccordionContainer.MENU)}$_fireFocusedChanged(e,t){}$_fireExpanded(e,t){this.fireEvent(AccordionContainer.EXPANDED,e,t)}}AccordionContainer.MENU="onAccordionMenu",AccordionContainer.FOCUSED_CHANGED="onAccordionFocusedChanged",AccordionContainer.EXPANDED="onAccordionExpanded";class AccordionElement extends UIElement{get accordion(){return this.container}}class AccordionToolbar extends AccordionElement{constructor(e){super(e,"rr-accordion-toolbar")}isMenu(e){return e===this._spanMenu}_prepareDom(e,t){let i=e.createElement("span");i.textContent="EXPLORER",t.appendChild(i),i=this._spanMenu=e.createElement("span"),i.className="rr-accordion-toolbar-menu",t.appendChild(i)}}class AccordionBodyElement extends AccordionElement{constructor(e){super(e,"rr-accordion-body")}}class AccordionSeparator extends AccordionElement{constructor(e){super(e,"rr-accordion-separator")}}class AccordionHeaderElement extends AccordionElement{constructor(e){super(e,"rr-accordion-header rr-accordion-root"),this._expanded=!1}get model(){return this._model}get expanded(){return this._expanded}set expanded(e){if(e!=this._expanded){const t=this.container;this._expanded=e,t&&t.invalidateLayout(),t.$_fireExpanded(this._model,e)}}layout(e){this._model=e,this.setHint(e.hint||e.displayText),this._spanText.textContent=e.displayText,this._spanExpander.className="rr-accordion-expander "+(this._expanded?"rr-accordion-expander-expanded":"rr-accordion-expander-collapsed")}_prepareDom(e,t){this._spanExpander=e.createElement("span"),t.appendChild(this._spanExpander),this._spanText=e.createElement("span"),t.appendChild(this._spanText)}}class AccordionPanelElement extends AccordionElement{constructor(e){super(e,"rr-accordion-panel")}get content(){return this._div}setContentId(e){this._div.id=e.id}layout(e){}_prepareDom(e,t){const i=this._div=e.createElement("div"),r=i.style;r.position="absolute",r.width="100%",r.height="100%",t.appendChild(i)}}class DOCFile{constructor(e,t){this.inTable=null,this.cellAlign=build.AlignmentType.CENTER,this._report=e,this._imageLoader=new ImageLoader,this._model=new DOCModel(this,e,t)}createDOCElements(e){const t=e instanceof HTMLElement&&this._report.models[e.dataset._m_];if(this.inTable&&t instanceof DiagonalBoxContainer)return new DOCCellDbox(this,e,t);if(this.inTable&&t instanceof BoxContainer)return new DOCBoxTable(this,e,t);if(t instanceof HtmlItem)return new DOCHtmlElement(this,e.firstElementChild,t);if(t instanceof ImageItem)return new DOCImage(this,e,t);if(t instanceof QrcodeItem)return new DOCQrcode(this,e,t);if(t instanceof CheckItem){const i=e.getElementsByClassName(CheckItemElement.CHECK_CLASS)[0],r=new DOCImage(this,i,t),s=e.getElementsByClassName(CheckItemElement.TEXT_CLASS)[0];return[r,new DOCText(this,s,t)]}if(t instanceof BarItem)return new DOCBar(this,e,t);if(t instanceof SvgItem){const i=e._svg_,r=i.substring(i.indexOf("<svg"));return new DOCSvg(this,e,r,t)}if(e instanceof HTMLTableElement)return new DOCTable(this,e,t);if(e instanceof HTMLSpanElement)return t instanceof DiagonalBoxContainer&&e.dataset.line?new DOCDiagonalLine(this,e,t):new DOCText(this,e,t);if(e instanceof SVGSVGElement){const i=(new XMLSerializer).serializeToString(e);return new DOCSvg(this,e,i,t)}return e instanceof HTMLCanvasElement?new DOCCanvas(this,e,t):e instanceof HTMLElement&&"B"===e.tagName?new DOCText(this,e,t):e instanceof HTMLElement?new DOCElement(this,e,t):void 0}setPageDiv(e){e!==this._pageDiv&&(this._pageDiv=e,this._pageRect=e.getBoundingClientRect())}getBounds(e){const t=e.getBoundingClientRect();return t.x-=this._pageRect.x,t.y-=this._pageRect.y,t}getTextBounds(e){const t=Utils.getTextRect(e);return t.x-=this._pageRect.x,t.y-=this._pageRect.y,t}addImage(e,t){this._imageLoader.add(e,t)}getImage(e){return this._imageLoader.get(e)}get report(){return this._report}prepare(e){return this._imageLoader.load(e)}canExport(){return this._imageLoader.loaded}toBlob(e){const t=new build.Document({sections:this.$_buildSections()});build.Packer.toBlob(t).then(e)}toBuffer(e){const t=new build.Document({sections:this.$_buildSections()});build.Packer.toBuffer(t).then(e)}$_buildSections(){const e=this,t={type:build.SectionType.NEXT_PAGE,page:{margin:{top:0,bottom:0,left:0,right:0},size:{orientation:this.report.paper.orientation}}},i=[];return this._model.pages.forEach(((r,s)=>{const n=r.write(e);i.push({properties:t,children:n})})),i}}class DOCExporter{constructor(){}exportBlob(e,t,i){if("function"!=typeof i)return;const r=()=>{n.canExport()||n.prepare(s)?n.toBlob(i):setTimeout((()=>{r()}),300)},s=5,n=new DOCFile(e,t);r()}export(e,t,i){if("function"!=typeof i)return;const r=()=>{n.canExport()||n.prepare(s)?n.toBuffer(i):setTimeout((()=>{r()}),300)},s=5,n=new DOCFile(e,t);r()}}class DocumentExporter extends Base{constructor(){super()}_doDispose(){super._doDispose()}export(e,t,i){const r=i.type||"hwp",s=i.fileName||"realreport";try{if("hwp"===r){(new HWPExporter).export(e,t,(e=>{download(e,s+".hwp")}))}else if("docx"===r){(new DOCExporter).exportBlob(e,t,(e=>{download(e,s+".docx")}))}}catch(e){console.error(e),alert("내보내기 실패: "+e)}}}var dist={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.h=e.r=void 0;class t{static SUFFIX="=";static CHARACTERS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";static encode(e){const i=t.CHARACTERS,r=[],s=e.length;var n=s%3;let o=s-n;for(let t=0;t<o;){var a=e[t++]<<16|e[t++]<<8|e[t++];r.push(i.charAt(a>>>18&63)),r.push(i.charAt(a>>>12&63)),r.push(i.charAt(a>>>6&63)),r.push(i.charAt(63&a))}switch(n){case 2:var A=e[o++]<<16|e[o++]<<8;r.push(i.charAt(A>>>18&63)),r.push(i.charAt(A>>>12&63)),r.push(i.charAt(A>>>6&63)),r.push(t.SUFFIX);break;case 1:A=e[o++]<<16,r.push(i.charAt(A>>>18&63)),r.push(i.charAt(A>>>12&63)),r.push(t.SUFFIX),r.push(t.SUFFIX)}return r.join("")}static decode(e){const i=t.CHARACTERS;var r=t.SUFFIX;const s=e.split(""),n=[];let o=s.length;for(;s[--o]===r;);for(let e=0;e<o;){let t=i.indexOf(s[e++])<<18;e<=o&&(t|=i.indexOf(s[e++])<<12),e<=o&&(t|=i.indexOf(s[e++])<<6),e<=o&&(t|=i.indexOf(s[e++])),n.push(t>>>16&255),n.push(t>>>8&255),n.push(255&t)}for(;0===n[n.length-1];)n.pop();return n}}class i{static POW2=Math.pow(2,2);static POW3=Math.pow(2,3);static POW4=Math.pow(2,4);static POW8=Math.pow(2,8);static POW16=Math.pow(2,16);static POW24=Math.pow(2,24);static kb={p:[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],s0:[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],s1:[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],s2:[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],s3:[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],k:[202,218,204,100]};static union(e,t){var i=t.s3[255&e],r=t.s2[255&(e>>=8)],s=t.s1[255&(e>>=8)];return((s=((s=((e=t.s0[255&(e>>=8)])>>16)+(s>>16)+((65535&e)+(65535&s)>>16)<<16|(65535&e)+(65535&s)&65535)>>16^r>>16)<<16|65535&(65535&s^65535&r))>>16)+(i>>16)+((65535&s)+(65535&i)>>16)<<16|(65535&s)+(65535&i)&65535}static xor(e,t){return(e>>16^t>>16)<<16|65535&(65535&e^65535&t)}static _encryptBlock(e,t){var r=e.left,s=e.right;const n=i.xor,o=i.union;r=n(r,t.p[0]),s=n(s,n(o(r,t),t.p[1])),r=n(r,n(o(s,t),t.p[2])),s=n(s,n(o(r,t),t.p[3])),r=n(r,n(o(s,t),t.p[4])),s=n(s,n(o(r,t),t.p[5])),r=n(r,n(o(s,t),t.p[6])),s=n(s,n(o(r,t),t.p[7])),r=n(r,n(o(s,t),t.p[8])),s=n(s,n(o(r,t),t.p[9])),r=n(r,n(o(s,t),t.p[10])),s=n(s,n(o(r,t),t.p[11])),r=n(r,n(o(s,t),t.p[12])),s=n(s,n(o(r,t),t.p[13])),r=n(r,n(o(s,t),t.p[14])),s=n(s,n(o(r,t),t.p[15])),r=n(r,n(o(s,t),t.p[16])),e.right=r,e.left=n(s,t.p[17])}static _decryptBlock(e,t){var r=e.left,s=e.right;const n=i.xor,o=i.union;r=n(r,t.p[17]),s=n(s,n(o(r,t),t.p[16])),r=n(r,n(o(s,t),t.p[15])),s=n(s,n(o(r,t),t.p[14])),r=n(r,n(o(s,t),t.p[13])),s=n(s,n(o(r,t),t.p[12])),r=n(r,n(o(s,t),t.p[11])),s=n(s,n(o(r,t),t.p[10])),r=n(r,n(o(s,t),t.p[9])),s=n(s,n(o(r,t),t.p[8])),r=n(r,n(o(s,t),t.p[7])),s=n(s,n(o(r,t),t.p[6])),r=n(r,n(o(s,t),t.p[5])),s=n(s,n(o(r,t),t.p[4])),r=n(r,n(o(s,t),t.p[3])),s=n(s,n(o(r,t),t.p[2])),r=n(r,n(o(s,t),t.p[1])),e.right=r,e.left=n(s,t.p[0])}static _init(e){const t=e.split("").map((function(e){return 255&e.charCodeAt(0)})),r=i.kb,s=i._encryptBlock;let n,o,a,A=0,l=0;var h={left:0,right:0};const d={p:r.p.slice(0).map((function(e){var r=t.length;let s;for(s=0;s<4;s++)l=l*i.POW8|t[A++%r];return(e>>16^l>>16)<<16|65535&(65535&e^65535&l)})),s0:r.s0.slice(0),s1:r.s1.slice(0),s2:r.s2.slice(0),s3:r.s3.slice(0)};for(n=0,a=d.p.length;n<a;)s(h,d),d.p[n++]=h.left,d.p[n++]=h.right;for(n=0;n<4;n++)for(o=0,a=d["s"+n].length;o<a;)s(h,d),d["s"+n][o++]=h.left,d["s"+n][o++]=h.right;return d}static encrypt(e,r){const s=i._encryptBlock;var n=i._init(r),o=8-(7&e.length);for(let t=0;t<o;t++)e+=String.fromCharCode(o);let a=0;const A=[],l=e.length>>3,h={left:null,right:null};for(let t=0;t<l;t++)h.left=e.charCodeAt(a)*i.POW24|e.charCodeAt(a+1)*i.POW16|e.charCodeAt(a+2)*i.POW8|e.charCodeAt(a+3),h.right=e.charCodeAt(a+4)*i.POW24|e.charCodeAt(a+5)*i.POW16|e.charCodeAt(a+6)*i.POW8|e.charCodeAt(a+7),s(h,n),A.push(h.left>>24&255),A.push(h.left>>16&255),A.push(h.left>>8&255),A.push(255&h.left),A.push(h.right>>24&255),A.push(h.right>>16&255),A.push(h.right>>8&255),A.push(255&h.right),a+=8;return t.encode(A)}static decrypt(e,r){const s=i._decryptBlock;var n=i._init(r);const o=[];var a=t.decode(e);let A=0;var l=a.length>>3;const h={left:null,right:null};for(let e=0;e<l;e++){h.left=a[A]*i.POW24|a[A+1]*i.POW16|a[A+2]*i.POW8|a[A+3],h.right=a[A+4]*i.POW24|a[A+5]*i.POW16|a[A+6]*i.POW8|a[A+7],s(h,n);var d=h.left,c=h.right;o.push(d>>24&255),o.push(d>>16&255),o.push(d>>8&255),o.push(255&d),o.push(c>>24&255),o.push(c>>16&255),o.push(c>>8&255),o.push(255&c),A+=8}return o[o.length-1]!==o[o.length-2]&&1!==o[o.length-1]||(e=o[o.length-1],o.splice(o.length-e,e)),o.map((function(e){return String.fromCharCode(e)})).join("")}}const r=String.fromCharCode(100,107,100,108);class s{_gk;constructor(e){this._gk=e??r}_ldk(e){let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]>>1);return t}get(){return this._gk+this._ldk(i.kb.k)}}e.r=class{static run(e,t){return t=new s(t).get(),i.encrypt(e,t)}};class n extends Error{}e.h=class{_gk;_code;_lic;constructor(e,t){this._gk=t,this._code=e,this._lic=this.run()}run(){const e={},t=i.decrypt(this._code,new s(this._gk).get()).split(";");for(let i=0,s=t.length;i<s;i++){var r=t[i].split("="),n=r[0];(r=r[1])&&0<r.length&&(e[n]=r)}return e}get lic(){return this._lic}is(e,t){return e in this._lic&&this._lic[e]===t}includes(e,t){return e in this._lic&&t.includes(this._lic[e])}expired(e,t){return!(e in this._lic)||!this._lic[e]||(e=this._lic[e],t=(t?new Date(new Date(e).setMonth(new Date(e).getMonth()+t)):new Date(e)).getTime(),e=Date.now(),!isNaN(t)&&t<e)}validate(e){let t=!1;try{e.forEach((e=>{const i=Object.keys(e),r=Object.values(e);i.forEach(((e,i)=>{if(i=r[i],t=Array.isArray(i)?this.includes(e,i):this.is(e,i),!t)throw new n}))}))}catch(e){if(!(e instanceof n))throw e;t=!1}return t}}}(dist);var ERR_URL="https://real-report.com/errors",error=function(e){var t=e.code,i=e.stop,r=e.msg,s="RealReport Error #".concat(t," : ").concat(ERR_URL,"/").concat(t," ").concat(null!=r?r:"");if(i)throw new Error(s);return window.console&&console.warn(s),s},licWarn=function(e){return"RealReport를 사용하려면 도움말을 참조하세요.\nhttps://real-report.com/licenses (".concat((null==e?void 0:e.message)||e,")")};const error$1=error;var matchOperatorsRe=/[|\\{}()[\]^$+*?.]/g,escapeStringRegexp=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(matchOperatorsRe,"\\$&")},escapeRegExp=escapeStringRegexp,startsWithWildcardRegExp=/^\*\./,endsWithWildcardRegExp=/\.\*$/,trailingSlashesRegExp=/\/.*$/,portRegExp=/:(\d+)$/,protocolRegExp=/^(\w+):\/\//,wildcardRegExp=/\\\.\\\*/g;function parseUrl(e){if(!e||"string"!=typeof e)return null;var t=e.match(protocolRegExp);t=t?t[1]:null;var i=(e=(e=e.replace(protocolRegExp,"")).replace(trailingSlashesRegExp,"")).match(portRegExp);return i=i?parseInt(i[1],10):null,{protocol:t,url:e=e.replace(portRegExp,""),port:i}}function prepareRule(e){var t=parseUrl(e);return t&&(t.url=t.url.replace(startsWithWildcardRegExp,"."),t.url=t.url.replace(endsWithWildcardRegExp,".")),t}function urlMatchRule(e,t){if(!e||!t)return!1;var i=!t.protocol||!e.protocol||t.protocol===e.protocol,r=!t.port||e.port===t.port,s=t.url.startsWith("."),n=t.url.endsWith("."),o="^";return s&&(o+=".+"),o+=escapeRegExp(t.url).replace(wildcardRegExp,"\\..*"),n&&(o+=".+"),o+="$",new RegExp(o).test(e.url)&&i&&r}var matchUrlWildcard=function(e,t){return Array.isArray(t)||(t=[t]),t.some((t=>urlMatchRule(parseUrl(e),prepareRule(t))))};const matchurl=matchUrlWildcard;var dom=location?location.hostname:void 0,validUrl=function(e){return Array.isArray(e)?e.every(validUrl):!(e.startsWith(".")||e.endsWith(".")||e.endsWith("*")||-1!==e.indexOf(".*.")||-1!==e.indexOf("..")||-1!==e.indexOf("*.com")||-1!==e.indexOf("*.co.kr")||-1!==e.indexOf("*.kr")||-1!==e.indexOf("*.net"))};const dm=function(e){var t=e.split(",").filter(Boolean);return!!validUrl(t)&&(dom||error$1({code:214,stop:!0,msg:"Unknown host domain"}),matchurl(dom,t))},getL=function(){return"undefined"!=typeof process&&process.env&&process.env.hasOwnProperty("realReportLic")?process.env.realReportLic:realReportLic||void 0};var name="@realgrid/realreport-viewer",version="1.4.1",description="RealReport Runtime Viewer",license="UNLICENSED",author={name:"Wooritech",url:"https://real-report.com",email:"support@realgrid.com"},homepage="https://real-report.com",main="dist/realreport.es.js",types="dist/realreport.d.ts",keywords=["reports","dataviz","visualization","realreport","realgrid"],publishConfig={registry:"https://npm.pkg.github.com"},repository={type:"git",url:"git://github.com/realgrid/realreport-viewer.git"},files=["dist/**/*"],scripts={clean:"rimraf dist dist.js/realreport .zpack/realreport-latest.tgz .npm/dist",makehash:"git rev-parse --short HEAD > .commithash",zpack:"node scripts/zpack.js",build:"npm run makehash && npm run clean && rollup -c ./scripts/rollup/rollup.product.config.js","build:webroot":"rimraf webroot/js/realreport && rollup -c ./scripts/rollup/rollup.webroot.config.js --watch","build:example":"rimraf webroot/js/realreport && rollup -c ./scripts/rollup/rollup.example.config.js","build:e2e":"rimraf e2e/js/realreport && rollup -c ./scripts/rollup/rollup.e2e.config.js --watch","build:service":"rimraf ../realreport-service/public/static/realreport/current/ && rollup -c ./scripts/rollup/rollup.service.config.js","web:e2e":"npx live-server e2e --port=6080 --host=localhost",test:"jest --config jest.config.ts",e2e:"run-p build:e2e web:e2e",cover:"c8 -o ./.coverage node .build/tests/index.js"},devDependencies={"@babel/core":"^7.16.5","@babel/preset-env":"^7.16.5","@playwright/test":"^1.22.2","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^21.0.1","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.1.1","@rollup/plugin-replace":"^3.0.0","@rollup/plugin-typescript":"^8.3.0","@types/copyfiles":"^2.4.1","@types/jest":"^27.0.3","@types/node":"^17.0.0","@types/tldjs":"^2.3.1","@typescript-eslint/eslint-plugin":"^5.8.1","@typescript-eslint/parser":"^5.8.1","@vercel/ncc":"^0.33.0","@wooritech/rockhammer":"^1.0.12",c8:"^7.10.0",copyfiles:"^2.4.1",eslint:"^8.5.0","eslint-plugin-jest":"^25.3.2",jest:"^27.4.5",jszip:"^3.7.1","match-url-wildcard":"0.0.4","npm-packlist":"^3.0.0","npm-run-all":"^4.1.5",prettier:"^2.5.1",rimraf:"^3.0.2",rollup:"^2.61.1","rollup-plugin-copy":"^3.4.0","rollup-plugin-css-bundle":"^1.0.4","rollup-plugin-dts":"^4.0.1","rollup-plugin-sizes":"^1.0.4","rollup-plugin-terser":"^7.0.2","ts-jest":"^27.1.2","ts-node":"^10.4.0",tslib:"^2.3.1",typescript:"^4.5.4"},peerDependencies={highcharts:"^10.x"},dependencies={};const _package={name:name,version:version,description:description,license:license,author:author,homepage:homepage,main:main,types:types,keywords:keywords,publishConfig:publishConfig,repository:repository,files:files,scripts:scripts,devDependencies:devDependencies,peerDependencies:peerDependencies,dependencies:dependencies},pack={__proto__:null,name:name,version:version,description:description,license:license,author:author,homepage:homepage,main:main,types:types,keywords:keywords,publishConfig:publishConfig,repository:repository,files:files,scripts:scripts,devDependencies:devDependencies,peerDependencies:peerDependencies,dependencies:dependencies,default:_package};var REPORT_OPTIONS={zoom:1},DOC_EXPORT_DEFAULT_OPTIONS={type:"hwp"},IMG_EXPORT_DEFAULT_OPTIONS={type:"png"},ReportViewBase=function(){function e(e,t){void 0===t&&(t=REPORT_OPTIONS),this._cm=!1,this._currentPage=1,this.$_checkL(),e||error$1({code:213,stop:!0}),this.containerId=e,this._container=new PrintContainer(e),this._container.zoom=t.zoom}return e.prototype._checkPrintContainer=function(e){this._container.pages||error$1({code:217,stop:!0,msg:"Page does not exist in the viewer"}),e&&Array.isArray(e)&&e.length>0&&e.map((function(e){e.is&&error$1(e.errorParams)}))},e.prototype._checkPrintContainerZoom=function(){1!==this._container.zoom&&error$1({code:219,stop:!0,msg:"페이지 배율 값이 100%인 경우만 내보내기가 가능합니다. 페이지 배율 값이 100%인지 확인해 주세요."})},Object.defineProperty(e.prototype,"containerId",{get:function(){return this._containerId},set:function(e){this._containerId="string"==typeof e?e:e.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return null==pack?void 0:version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zoom",{get:function(){return this._container.zoom},set:function(e){this._container.zoom=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageCount",{get:function(){return this._container.pageCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this._currentPage},set:function(e){e!==this.page&&(this._container.page=e-1,this._currentPage=Math.max(1,Math.min(e,this.pageCount)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reportHtml",{get:function(){return this._checkPrintContainer(),this._container.getPrintHtml()},enumerable:!1,configurable:!0}),e.prototype.getHtml=function(){return this._checkPrintContainer(),this._container.getPrintHtml()},e.prototype.first=function(){this._checkPrintContainer(),this.page=1},e.prototype.prev=function(){this._checkPrintContainer(),this.page--},e.prototype.next=function(){this._checkPrintContainer(),this.page++},e.prototype.last=function(){this._checkPrintContainer(),this.page=this._container.pageCount},e.prototype.zoomIn=function(e){void 0===e&&(e=.1),this._checkPrintContainer(),this._container.zoom+=e},e.prototype.zoomOut=function(e){void 0===e&&(e=.1),this._checkPrintContainer(),this._container.zoom-=e},e.prototype.fitToHeight=function(){this._checkPrintContainer(),this._container.fitToHeight()},e.prototype.fitToPage=function(){this._checkPrintContainer(),this._container.fitToPage()},e.prototype.fitToWidth=function(){this._checkPrintContainer(),this._container.fitToWidth()},e.prototype.$_checkL=function(){var e=null,t="";try{t="undefined"!=typeof process&&process.env&&process.env.hasOwnProperty("realReportLic")?process.env.realReportLic:realReportLic||void 0,e=new dist.h(t)}catch(e){return void error$1({code:200,stop:!0,msg:licWarn(e)})}this._cm=null!==e&&e.validate([{name:"RealReport",lic:["Enterprise"]}])&&dm(e.lic.server)||e.validate([{name:"RealReport",lic:["Subscription","Limited","Evaluation"]}])&&!e.expired("expire",1)&&dm(e.lic.server),this._cm||error$1({code:200,stop:!0,msg:licWarn()})},e}();const ReportViewBase$1=ReportViewBase;var BlobStream=function(){function e(){this._blobstream=null,this._blob=null}return Object.defineProperty(e.prototype,"stream",{get:function(){return this._blobstream||(this._blobstream=new window.blobStream),this._blobstream},enumerable:!1,configurable:!0}),e.prototype.blob=function(){return __awaiter$1(this,void 0,void 0,(function(){var e=this;return __generator$1(this,(function(t){return[2,new Promise((function(t,i){e._blobstream.on("finish",(function(){e._blob=e._blobstream.toBlob("application/pdf"),e._url=window.URL.createObjectURL(e._blob),t(e._blobstream)}))}))]}))}))},e.prototype.open=function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(e){return this._url&&window.open(this._url),[2]}))}))},e.prototype.url=function(){return this._url},e.prototype.download=function(e){return __awaiter$1(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(i){return this._url&&(t=document.createElement("a"),document.body.appendChild(t),t.href=this._url,t.download=e,t.style.position="fixed",t.target="_blank",t.click(),document.body.removeChild(t)),[2]}))}))},e}(),ZOOM_ERROR_MESSAGE="페이지 배율 값이 100%인 경우만 내보내기가 가능합니다. 페이지 배율 값이 100%인지 확인해 주세요.",ReportViewer=function(e){function t(t,i,r,s){var n=e.call(this,t,s)||this;return n.reportForm=i,n.dataSet=r,n}return __extends$1(t,e),Object.defineProperty(t.prototype,"reportForm",{get:function(){return this._reportForm},set:function(e){this._report&&(this._report=null),this._reportForm=e,this._report=(new Report).load(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSet",{get:function(){return this._dataSet},set:function(e){this._reportDataProvider&&(this._reportDataProvider=null),this._dataSet=e,this._reportDataProvider=new ReportDataProvider,"object"==typeof e&&this._reportDataProvider.load(e)},enumerable:!1,configurable:!0}),t.prototype.preview=function(e){var t;void 0===e&&(e={async:!0,pageMark:!0,noScroll:!1}),this._checkReport();var i=__assign$1({report:this._report,data:this._reportDataProvider,preview:!0,id:this.containerId},e);null===(t=this._container)||void 0===t||t.print(i)},t.prototype.exportPdf=function(e){return __awaiter$1(this,void 0,void 0,(function(){var t,i,r,s,n;return __generator$1(this,(function(o){switch(o.label){case 0:return this._checkPrintContainer([{is:1!==this._container.zoom,errorParams:{code:219,stop:!0,msg:ZOOM_ERROR_MESSAGE}}]),t=e.fonts,i=e.filename,r=e.preview,s=new BlobStream,n=s.stream,(new PdfExporter).export(this._report,this._container.pages,t,n),[4,s.blob()];case 1:return o.sent(),r?[4,s.open()]:[3,3];case 2:o.sent(),o.label=3;case 3:return i?[4,s.download(i)]:[3,5];case 4:o.sent(),o.label=5;case 5:return[2,s.stream]}}))}))},t.prototype.exportImage=function(e){void 0===e&&(e=IMG_EXPORT_DEFAULT_OPTIONS),this._checkPrintContainer([{is:1!==this._container.zoom,errorParams:{code:219,stop:!0,msg:ZOOM_ERROR_MESSAGE}}]),(new ImageExporter).export(this._report,this._container.pages,e)},t.prototype.exportDocument=function(e){void 0===e&&(e=DOC_EXPORT_DEFAULT_OPTIONS),this._checkPrintContainer([{is:1!==this._container.zoom,errorParams:{code:219,stop:!0,msg:ZOOM_ERROR_MESSAGE}}]),(new DocumentExporter).export(this._report,this._container.pages,e)},t.prototype._checkReport=function(){this._report||error$1({code:216,stop:!0,msg:"RealReport did not load"})},t}(ReportViewBase$1),GridValues=function(){function e(e){this._grid=e}return Object.defineProperty(e.prototype,"values",{get:function(){for(var e=[],t=this._grid.getItemCount(),i=0;i<t;i++)e.push(this._grid.getDisplayValues(i,!0));return e},enumerable:!1,configurable:!0}),e}(),GridReportItemLoader=function(){function e(){this._itemCreator={text:function(e){return new TextItem(e)}}}return e.prototype._setItemPositions=function(e,t){return e&&t&&(t.left&&e.setLeft(new Dimension(t.left)),t.top&&e.setTop(new Dimension(t.top)),t.right&&e.setRight(new Dimension(t.right)),t.bottom&&e.setBottom(new Dimension(t.bottom))),e},e.prototype._setItemProps=function(e,t){return this._setItemPositions(e,t),t.text&&e.setProperty("text",t.text),t.value&&e.setProperty("value",t.value),t.height&&e.setProperty("height",t.height),t.prefix&&e.setProperty("prefix",t.prefix),e},e.prototype._setItemStyles=function(e,t){if(e&&t)for(var i=0,r=Object.entries(t);i<r.length;i++){var s=r[i],n=s[0],o=s[1];e.setStyleProperty(n,o)}return e},e.prototype.createItem=function(e){var t,i="string"==typeof e?e:null!==(t=e.type)&&void 0!==t?t:"text",r=e.name,s=this._itemCreator[i],n=s&&s(r);if(this._setItemProps(n,e),e.styles&&this._setItemStyles(n,e.styles),!n)throw new Error("지원하지 않는 GridReportItem 입니다.");return n},e.prototype.createHichartSeries=function(e,t){throw new Error("지원하지 않는 GridReportItem 입니다.")},e}(),GridReportColumns=function(){function e(e,t){var i=t.getDataColumns(!0);this._columns=i.filter((function(t){var i;return!(null===(i=null==e?void 0:e.exclude)||void 0===i?void 0:i.includes(t.name))}))}return Object.defineProperty(e.prototype,"count",{get:function(){return this._columns.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this._columns},enumerable:!1,configurable:!0}),e}(),defaultOptions={zoom:1,layout:{autoWidth:!0}},itemLoader=new GridReportItemLoader,GridReportViewer=function(e){function t(t,i,r){void 0===r&&(r=defaultOptions);var s=e.call(this,t,r)||this;s._grid=i._view,s._options=r,s._gridValues=new GridValues(i),s.reportForm={},r&&r.paper&&(s._report.paper.orientation=r.paper.orientation||PaperOrientation.PORTRAIT),s.dataSet={Data1:{type:"band",values:s._gridValues.values}};return s._report.addListener({onReportItemAdded:function(e,t,i){}}),s}return __extends$1(t,e),t.prototype.preview=function(t){void 0===t&&(t={async:!1,pageMark:!1,noScroll:!0}),this._prepare(),e.prototype.preview.call(this,t)},t.prototype._addTitle=function(e){if(e){var t=itemLoader.createItem(e);this._report.page.reportHeader.add(t)}},t.prototype._addGridHeader=function(e){if(e){var t=new StackContainer("box");t.width="100%",e.items.map((function(e){var i=itemLoader.createItem(e);t.add(i)})),this._report.page.body.itemsContainer.add(t)}},t.prototype._addPageHeader=function(e){var t=this;e&&e.items.map((function(e){var i=itemLoader.createItem(e);t._report.page.pageHeader.add(i)}))},t.prototype._addGridTable=function(){var e=this,t=new TableBand("table"),i=this._grid.activeCellLayout,r=new GridReportColumns(this._options.layout,i);t.colCount=r.count,t.data="Data1";var s=0;r.columns.forEach((function(i){var r;if(i.visible){var n=i.name,o=s++,a=i.header.text,A=new TextItem("col-header-".concat(o));A.text=a,A.setChildProp("row",0),A.setChildProp("col",o),t.header.add(A),(null===(r=e._options.layout)||void 0===r?void 0:r.autoWidth)&&(t.columns.get(o).width=i.width),t.header.cells.items[o].setStyle("backgroundColor","rgb(228, 231, 235)");var l=new TextItem("col-data-item-".concat(o));l.data=t.data,l.value=n,l.setChildProp("row",0),l.setChildProp("col",o),t.dataRow.add(l)}})),r.count>0&&(t.header.cellStyles={paddingTop:"10px"},t.dataRow.cellStyles={paddingTop:"2px"}),this._report.page.body.itemsContainer.add(t)},t.prototype._prepare=function(){var e=this._options;this._addTitle(e.title),this._addTitle(e.subTitle),this._addGridHeader(e.gridHeader),this._addGridTable(),this._addPageHeader(e.pageHeader)},t}(ReportViewer),ReportCompositeViewer=function(e){function t(t,i,r){var s=e.call(this,t,r)||this;return s._reportFormSets=i,s}return __extends$1(t,e),t.prototype.preview=function(e){var t;void 0===e&&(e={async:!1,pageMark:!1,noScroll:!0}),this._checkReportFormSet(),this._reports=this._reportFormSets.map((function(e){return{report:(new Report).load(e.form),data:e.dataSet?(new ReportDataProvider).load(e.dataSet):null}}));var i=__assign$1({report:this._reports,data:null,preview:!0,id:this.containerId},e);null===(t=this._container)||void 0===t||t.print(i)},t.prototype.exportPdf=function(e){return __awaiter$1(this,void 0,void 0,(function(){return __generator$1(this,(function(e){return error$1({code:300,stop:!1,msg:"This feature is coming soon."}),[2]}))}))},t.prototype.exportImage=function(e){error$1({code:300,stop:!1,msg:"This feature is coming soon."})},t.prototype.exportDocument=function(e){error$1({code:300,stop:!1,msg:"This feature is coming soon."})},t.prototype._checkReportFormSet=function(){this._reportFormSets&&0!==this._reportFormSets.length||error$1({code:218,stop:!0,msg:"ReportForm does not exist in the viewer"})},t}(ReportViewBase$1);export{GridReportViewer,ReportCompositeViewer,ReportViewer};
