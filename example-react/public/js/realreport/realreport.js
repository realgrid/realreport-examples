var RealReport=function(t){"use strict";var e=function(t,s){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])},e(t,s)};function s(t,s){if("function"!=typeof s&&null!==s)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)}var i=function(){return i=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},i.apply(this,arguments)};function r(t,e,s,i){return new(s||(s=Promise))((function(r,n){function o(t){try{A(i.next(t))}catch(t){n(t)}}function a(t){try{A(i.throw(t))}catch(t){n(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}A((i=i.apply(t,e||[])).next())}))}function n(t,e){var s,i,r,n,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,i=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){o.label=n[1];break}if(6===n[0]&&o.label<r[1]){o.label=r[1],r=n;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(n);break}r[2]&&o.ops.pop(),o.trys.pop();continue}n=e.call(t,o)}catch(t){n=[6,t],i=0}finally{s=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}const o=function(t,e){return"object"==typeof t&&Object.prototype.toString.call(t).indexOf(e)>=0};"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});let a=0;class A{constructor(){this.$_hash=a++,this.$_disposed=!1,this.$_disposing=!1}dispose(){return this.$_disposed||this.$_disposing||(this.$_disposed=!0,this.$_disposing=!0,this._doDispose()),null}_doDispose(){}get disposing(){return this.$_disposing}get hash(){return this.$_hash}get shash(){return String(this.$_hash)}isMe(t){return t==this.$_hash}$_getters(t){const e=[],s=Object.getOwnPropertyNames(t);for(let i=0,r=s.length;i<r;i++){const r=s[i],n=Object.getOwnPropertyDescriptor(t,r);n&&n.get&&e.push(r)}return e}doAssignSimple(t){return!1}assignFrom(t){let e=Object.getPrototypeOf(this);if(t instanceof A){let s=Object.getPrototypeOf(t),i={};for(;s&&s.constructor!=A;){let r=this.$_getters(s);for(let n=0,o=r.length;n<o;n++){const o=r[n];if(!(o in i)){i[o]=null;let r=Object.getOwnPropertyDescriptor(e,o);if(r){if(r.set){const e=Object.getOwnPropertyDescriptor(s,o),i=e&&e.get;i&&r.set.call(this,i.call(t))}}else{let i=Object.getPrototypeOf(e);for(;i;){let e=Object.getOwnPropertyDescriptor(i,o);if(e){if(e.set){const i=Object.getOwnPropertyDescriptor(s,o),r=i&&i.get;r&&e.set.call(this,r.call(t))}i=null}else i=Object.getPrototypeOf(i)}}}}s=Object.getPrototypeOf(s)}}else if(!this.doAssignSimple(t))for(let s in t){let i=Object.getOwnPropertyDescriptor(e,s);if(i)i.set&&i.set.call(this,t[s]);else{let i=Object.getPrototypeOf(e);for(;i;){let e=Object.getOwnPropertyDescriptor(i,s);e?(e.set&&e.set.call(this,t[s]),i=null):i=Object.getPrototypeOf(i)}}}}extend(t){for(let e in t)e in this&&(this[e]=t[e])}toProxy(){const t={};let e=Object.getPrototypeOf(this);for(;e&&e.constructor!=A;){let s=this.$_getters(e);for(let i=0,r=s.length;i<r;i++){const r=s[i];let n=Object.getOwnPropertyDescriptor(e,r);if(n)n.get&&n.set&&(t[r]=n.get.call(this));else{let s=Object.getPrototypeOf(e);for(;s;){let e=Object.getOwnPropertyDescriptor(s,r);e?(e.get&&e.set&&(t[r]=e.get.call(this)),s=null):s=Object.getPrototypeOf(s)}}}e=Object.getPrototypeOf(e)}return t}assignProps(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=t||{},e.forEach((e=>{const i=this[e];(s||void 0!==i)&&(t[e]=i)})),t}toString(){return this.constructor.name}}class l extends A{constructor(){super(),this._listeners=[]}_doDispose(){for(let t of this._listeners)this.removeListener(t);return this._listeners=null,super._doDispose()}get listenerCount(){return this._listeners.length}addListener(t){return null!=t&&this._listeners.indexOf(t)<0&&this._listeners.push(t),this}removeListener(t){if(this._listeners&&null!=t){const e=this._listeners.indexOf(t);e>=0&&this._listeners.splice(e,1)}return this}isListener(t){return this._listeners&&this._listeners.indexOf(t)>=0}clearListener(){for(let t of this._listeners)this.removeListener(t);this._listeners.length=0}fireEvent(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];let r=Array.prototype.slice.call(arguments,0);r[0]=this;for(let e=0,s=this._listeners.length;e<s;e++){let s=this._listeners[e],i=s[t];i&&i.apply(s,r)}}fireConfirmEvent(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];let r=Array.prototype.slice.call(arguments,0);r[0]=this;for(let e=0,s=this._listeners.length;e<s;e++){let s=this._listeners[e],i=s[t];if(i){var n=i.apply(s,r);if("boolean"==typeof n&&!n)return!1}}return!0}fireMessageEvent(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];let r=Array.prototype.slice.call(arguments,0);r[0]=this;for(let e=0,s=this._listeners.length;e<s;e++){let s=this._listeners[e],i=s[t];if(i){const t=i.apply(s,r);if("string"==typeof t&&t)return t}}return null}fireObjectEvent(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];let r=Array.prototype.slice.call(arguments,0);r[0]=this;for(let e=0,s=this._listeners.length;e<s;e++){let s=this._listeners[e],i=s[t];if(i){const t=i.apply(s,r);if(null!=t)return t}}return null}}class h{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=t,this.y=e}static empty(){return new h}static create(){return new h(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}get isEmpty(){return 0===this.x||0===this.y}clone(){return new h(this.x,this.y)}equals(t){return t===this||t&&this.x===t.x&&this.y===t.y}setEmpty(){return this.x=this.y=0,this}set(t,e){return this.x=t,this.y=e,this}round(){const t=this.clone();return t.x>>>=0,t.y>>>=0,t}toString(){return"{x: "+this.x+", y: "+this.y+"}"}}class d{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.x=t,this.y=e,this.width=s,this.height=i}static create(t,e,s,i){return new d(t,e,s,i)}get left(){return this.x}set left(t){const e=t-this.x;this.x+=e,this.width-=e}get right(){return this.x+this.width}set right(t){const e=t-(this.x+this.width);this.width+=e}get top(){return this.y}set top(t){const e=t-this.y;this.y+=e,this.height-=e}get bottom(){return this.y+this.height}set bottom(t){const e=t-(this.y+this.height);this.height+=e}get isEmpty(){return 0===this.width||0===this.height}clone(){return new d(this.x,this.y,this.width,this.height)}getInner(){return new d(0,0,this.width,this.height)}equals(t){return t===this||t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}leftBy(t){return this.x+=t,this.width-=t,this}rightBy(t){return this.width+=t,this}topBy(t){return this.y+=t,this.height-=t,this}bottomBy(t){return this.height+=t,this}shrink(t,e){return this.width-=t,this.height-=e,this}expand(t,e){return this.width+=t,this.height+=e,this}contains(t,e){return t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height}setEmpty(){return this.width=this.height=0,this}move(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t,this.y=e,this}set(t,e,s,i){return this.x=t,this.y=e,this.width=s,this.height=i,this}setWidth(t){return this.width=t,this}copy(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyHorz(t){return this.x=t.x,this.width=t.width,this}copyVert(t){return this.y=t.y,this.height=t.height,this}inflate(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;return e=void 0!==e?e:t,s=void 0!==s?s:t,i=void 0!==i?i:e,t&&(this.left=this.x-t),e&&(this.top=this.y-e),s&&(this.right=this.right+s),i&&(this.bottom=this.bottom+i),this}translate(t,e){return this.x+=t,this.y+=e,this}round(){const t=this.clone();return t.x>>>=0,t.y>>>=0,t.width>>>=0,t.height>>>=0,t}union(t){const e=this.clone();return e.left=Math.min(this.x,t.x),e.right=Math.max(this.right,t.right),e.top=Math.min(this.y,t.y),e.bottom=Math.max(this.bottom,t.bottom),e}normalize(){return this.width<0&&(this.x-=this.width,this.width*=-1),this.height<0&&(this.y-=this.height,this.height*=-1),this}intersects(t){return this.x<=t.right&&t.x<=this.right&&this.y<=t.bottom&&t.y<=this.bottom}toString(){return"{x: "+this.x+", y: "+this.y+", width: "+this.width+", height: "+this.height+"}"}}d.Temp=new d;var c,u,p;!function(t){t.LEFT="left",t.CENTER="center",t.RIGHT="right"}(c||(c={})),function(t){t.TOP="top",t.MIDDLE="middle",t.BOTTOM="bottom"}(u||(u={})),function(t){t.PIXEL="px",t.POINT="pt",t.INCH="in",t.CENTCH="cm",t.MILLI="mm"}(p||(p={}));const _={px:t=>t,pt:t=>t*C.HTMLDPI/72,in:t=>t*C.HTMLDPI,mm:t=>t*C.HTMLDPI/25.4,cm:t=>t*C.HTMLDPI/2.54},g={px:t=>t,pt:t=>72*t/C.HTMLDPI,in:t=>t/C.HTMLDPI,mm:t=>25.4*t/C.HTMLDPI,cm:t=>2.54*t/C.HTMLDPI},f=function(t,e){return _[t](e)},m=function(t,e){return g[t](e)};class w extends Error{}const y=function(t,e){const s=[e],i=t.sort(((t,e)=>t.index-e.index));let r=e.index;const n=i.indexOf(e);for(let t=n+1;t<i.length&&!(i[t].index>r+1);t++,r++)s.push(i[t]);r=e.index;for(let t=n-1;t>=0&&!(i[t].index>r+1);t--,r--)s.unshift(i[t]);return s};class C{constructor(t){if(this._unit=p.PIXEL,this._value=NaN,this._fixed=!0,"number"==typeof t)this._value=t;else if("string"==typeof t){const e=t.trim();this._value=parseFloat(t),isNaN(this._value)||(e.endsWith("%")?this._fixed=!1:e.endsWith("pt")?this._unit=p.POINT:e.endsWith("in")?this._unit=p.INCH:e.endsWith("mm")?this._unit=p.MILLI:e.endsWith("cm")&&(this._unit=p.CENTCH))}}static create(t){return null==t?null:"string"!=typeof t||(t=t.trim())?new C(t):null}static createDimensions(t){if(t&&(t=t.trim())){const e=t.split(","),s=[];for(let t of e)s.push(t?new C(t):null);return s}}static equals(t,e){return t===e||t&&e&&t.equals(e)}get fixed(){return this._fixed}get unit(){return this._unit}get value(){return this._value}clone(){const t=new C(void 0);return t._fixed=this._fixed,t._unit=this._unit,t._value=this._value,t}equals(t){return t===this||t instanceof C&&(t._fixed==this._fixed&&t._unit==this._unit&&t._value==this._value)}toString(){return isNaN(this._value)?"NaN":this._fixed?this._value+this._unit:this._value+"%"}getValue(){return isNaN(this._value)?"NaN":this._fixed?this.$_getPixel():this._value+"%"}getPixel(t){if(!isNaN(this._value)){let e=this.$_getPixel();return this._fixed||(e=t*e/100),e}return NaN}getFixedPixel(){return isNaN(this._value)?NaN:this.$_getPixel()}$_getPixel(){return _[this._unit](this._value)}}C.HTMLDPI=96;class b{constructor(t){if(this._dims=[],this._relative=0,this._fixed=0,this._dirty=!1,t&&(t=t.trim())){const e=t.split(","),s=this._dims=[];for(let t=0;t<e.length;t++){const i=e[t],r=i?new C(i):null;s.push(r)}this.$_refresh()}}get count(){return this._dims.length}get relative(){return this._relative>0}get(t){return this._dims[t]}set(t,e){e!==this._dims[t]&&(this._dims[t]=e,this._dirty=!0)}getSizes(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._dirty&&this.$_refresh();const r=this._dims,n=this._values,o=[],a=s?Math.max(0,s.getPixel(e)||0):0;let A=0,l=0,h=0;for(let e=0,s=Math.min(t,r.length);e<s;e++)r[e]&&(r[e].fixed?isNaN(n[e])||(A+=Math.max(0,n[e])):l+=Math.max(0,n[e]));this._dims.forEach(((t,s)=>{const r=this._values[s];if(isNaN(r))o.push(NaN);else if(t.fixed)o.push(Math.max(a,r));else if(isNaN(e))o.push(NaN);else{let t=(e-A)*r/l,s=Math.floor(t);h+=t-s,h>=1&&(s++,h--),o.push(Math.max(a,i?s:t))}}));let d=0,c=0;for(let e=0;e<t;e++){const t=o[e];isNaN(t)?c++:d+=t}if(c>0&&!isNaN(e)){const s=Math.max(0,(e-d)/c);for(let e=0;e<t;e++)isNaN(o[e])&&(o[e]=Math.max(a,s))}return o}getSize(t,e){const s=this._dims[t];if(s){const i=this._values[t];if(!isNaN(i))return s.fixed?i:Math.max(0,(e-this._fixed)*i/this._relative)}return NaN}changeSize(t,e,s,i,r){0!==s&&(this.getSizes(t,i,r),s>0||(s-=s))}$_refresh(){const t=this._values=[];for(let e of this._dims)if(e)if(e.fixed){const s=e.$_getPixel();t.push(s),this._fixed+=s}else t.push(e.value),this._relative+=e.value;else t.push(NaN);this._dirty=!1}$_init(t){this._dims=t.slice(),this.$_refresh()}}var v,B,E,P,x;b.Empty=new b(null),function(t){t.NONE="none",t.BEFORE="before",t.AFTER="after",t.BOTH="both"}(v||(v={})),function(t){t.Z="KeyZ",t.Y="KeyY",t.C="KeyC",t.V="KeyV",t.X="KeyX",t.DELETE="Delete",t.BACK="Backspace",t.TAB="Tab",t.HOME="Home",t.END="End",t.UP="ArrowUp",t.DOWN="ArrowDown",t.LEFT="ArrowLeft",t.RIGHT="ArrowRight",t.A="KeyA",t._0="Digit0",t.EQUAL="Equal",t.MINUS="Minus"}(B||(B={})),function(t){t.LEFT="left",t.RIGHT="right",t.TOP="top",t.BOTTOM="bottom",t.TOP_LEFT="topLeft",t.BOTTOM_RIGHT="bottomRight",t.TOP_RIGHT="topRight",t.BOTTOM_LEFT="bottomLeft"}(E||(E={})),function(t){t.isLeft=function(e){return e===t.LEFT||e===t.TOP_LEFT||e===t.BOTTOM_LEFT},t.isTop=function(e){return e===t.TOP||e===t.TOP_LEFT||e===t.TOP_RIGHT},t.isEdge=function(e){return e===t.TOP_LEFT||e===t.BOTTOM_RIGHT||e===t.TOP_RIGHT||e===t.BOTTOM_LEFT},t.isIn=function(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];for(let e of s)if(e===t)return!0}}(E||(E={})),function(t){t.SIMPLE="simple",t.BAND="band"}(P||(P={})),function(t){t.DATA_FORMAT_IS_INCORRECT="데이터의 형식이 올바르지 않습니다."}(x||(x={}));const S=navigator.platform.toUpperCase().indexOf("MAC")>=0,I=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,R=!!window.whale,T=!!window.chrome&&!I,O=void 0!==window.InstallTrigger,F=Object.prototype.toString.call(HTMLElement).indexOf("Constructor")>0||!T&&!I&&navigator.userAgent.indexOf("Safari")>=0,D=F&&("Win32"==navigator.platform||navigator.userAgent.indexOf("Windows")>=0),L=!!document.documentMode,N=navigator.userAgent.toLowerCase().indexOf("edge/")>=0,H=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Q=navigator.userAgent.toLowerCase().indexOf("edg/")>=0&&navigator.userAgent.toLowerCase().indexOf("chrome/")>=0,U=function(){let t=3,e=document.createElement("div"),s=e.getElementsByTagName("i");for(;e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",s[0];);return t>4?t:undefined}(),M=void 0!==U&&U<=9,k=void 0!==U&&U<=8,V=-1!==navigator.appVersion.indexOf("MSIE 10");navigator.appVersion.indexOf("MSIE 9");const G=(new Date).getTime(),K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};let W,z;const $="&#8203";function X(t){return t&&t.ownerDocument&&(t.ownerDocument.defaultView||t.ownerDocument.parentWindow)}function j(t){return t&&t.ownerDocument}function Y(t){return t.defaultView||t.parentWindow}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){let s=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>s.length)&&(e=s.length),e-=t.length;let i=s.indexOf(t,e);return-1!==i&&i===e}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.__name||(this.__name=this.toString().split("(",1)[0].split(" ")[1]),this.__name}}),Number.isNaN=Number.isNaN||function(t){return t!=t};class J{static stopEvent(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.preventDefault?(t.preventDefault(),t.stopPropagation()):t.returnValue=!1,e&&t.stopImmediatePropagation()}static setDebugging(t,e,s){J.$$_trace=t,J.$$_debugging=e,J.$$_keyLog=s}static isDebugging(){return J.$$_debugging}static isTrace(){return this.$$_trace}static log(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];J.isDebugging()&&console.log(t,s)}static keyLog(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];J.$$_keyLog&&console.log(t,s)}static trace(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];J.isTrace()&&console.log(t,s)}static getErrorStack(t){const e=t.stack;return e?e.split("\n").map((t=>t+"<br/>")):""}static getBaseClassName(t){return Object.getPrototypeOf(t.constructor).name}static getBaseCtor(t){return Object.getPrototypeOf(t.constructor).$_ctor}static isObject(t){return t&&"object"==typeof t&&!Array.isArray(t)}static isObjectNotEmpty(t){return this.isObject(t)&&0!==Object.keys(t).length}static isArray(t){return Array.isArray(t)}static makeArray(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return null!=t?Array.isArray(t)?t:[t]:e?[]:void 0}static getIntArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=[];for(let i=e,r=e+t;i<r;i++)s.push(i);return s}static isValueArray(t){if(Array.isArray(t)){for(let e=t.length-1;e>=0;e--)if(null!=t[e]&&"object"==typeof t[e])return!1;return!0}}static toArray(t){return Array.isArray(t)?t:null!=t?[t]:null}static push(t,e){if(e&&e.length>0)for(let s=0,i=e.length;s<i;s++)t.push(e[s])}static isDefined(t){return null!=t}static isNotDefined(t){return null==t}static isNumber(t){return"number"==typeof t}static isValidNumber(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}static toNumber(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return isNaN(t)?e:+t}static toStrOrNum(t){return isNaN(t)?t:+t}static getEnumValues(t){return Object.keys(t).map((e=>t[e]))}static compareText(t,e){return t=t||"",e=e||"",arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(t=t.toLocaleLowerCase(),e=e.toLocaleLowerCase()),t>e?1:t<e?-1:0}static getTimeF(){return(new Date).getTime()/1e3}static getTimer(){return(new Date).getTime()-G}static isWhiteSpace(t){return!t||!t.trim()}static pad(t,e,s){return e=Math.max(e||2,1),s=s||"0",new Array(e-String(t).length+1).join(s)+t}static pad16(t,e,s){return e=Math.max(e||2,1),s=s||"0",new Array(e-t.toString(16).length+1).join(s)+t.toString(16)}static pick(){const t=arguments.length;let e;for(let s=0;s<t;s++)if(e=s<0||arguments.length<=s?void 0:arguments[s],null!=e)return e}static pickNum(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];const i=e.length;for(let t=0;t<i;t++)if(!isNaN(e[t])&&null!==e[t])return e[t];return NaN}static included(t){const e=arguments.length<=1?0:arguments.length-1;for(let s=0;s<e;s++)if((s+1<1||arguments.length<=s+1?void 0:arguments[s+1])==t)return!0;return!1}static compareTextValue(t,e,s,i){if(t===e)return!0;let r=String(t),n=null==e?void 0:String(e);return!r&&!n||!(!r||!n)&&(s||(r=r.toLowerCase(),n=n.toLowerCase()),i?n.indexOf(r)>=0:r==n)}static cast(t,e){return t instanceof e?t:null}static irandom(t,e){if(void 0!==e){const s=Math.floor(t),i=Math.floor(e);return Math.floor(Math.random()*(i-s)+s)}{const e=Math.floor(t);return Math.floor(Math.random()*e)}}static brandom(){return Math.random()>.5}static srandom(t,e){let s="";const i=this.irandom(t,e);for(let t=0;t<i;t++)s+=String.fromCharCode(this.irandom(97,123));return s}static erandom(t){const e=Object.values(t);return e[this.irandom(e.length)]}static arandom(t){return t[this.irandom(t.length)]}static iarandom(t,e,s){const i=[];for(let r=0;r<s;r++)i.push(J.irandom(t,e));return i}static alert(t){window.alert(t)}static throwAlert(t){throw new w(t)}static toInt(t,e){const s=parseInt(t,e||10);return isNaN(s)?0:s}static toFloat(t){const e=parseFloat(t);return isNaN(e)?0:e}static toEven(t){return 1&t?t+1:t}static hex(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";e=Math.max(e||2,1);const i=t.toString(16);return s=s||"0",new Array(e-i.length+1).join(s)+i}static toStr(t){return"number"==typeof t?isNaN(t)?"":String(t):null!=t?String(t):""}static extend(t,e){t=t||{};for(let s in e)t[s]=e[s];return t}static setBounds(t,e,s,i,r){const n=t.style;n.left=e+"px",n.top=s+"px",n.width=i+"px",n.height=r+"px"}static setRect(t,e){this.setBounds(t,e.x,e.y,e.width,e.height)}static getOffsetRect(t){return{x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}}static getClientRect(t){const e=t.getBoundingClientRect();return e.cx=t.offsetLeft,e.cy=t.offsetTop,e}static getChildIndex(t){if(t){const e=t.parentNode;if(e){const s=e.children;for(let e=s.length;e--;)if(s[e]===t)return e}}return-1}static clearChildren(t){let e;for(;e=t.lastChild;)t.removeChild(e)}static clearElements(t){let e;for(;e=t.lastChild;)J.clearElements(e),t.removeChild(e)}static addChild(t,e){return!(!t||!e||e.parentNode===t)&&(t.appendChild(e),!0)}static removeChild(t,e){return!(!t||!e||e.parentNode!==t)&&(t.removeChild(e),!0)}static remove(t){const e=t&&t.parentElement;e&&e.removeChild(t)}static getPrev(t){const e=t.parentElement.children;if(t!==e[0])for(let s=1;s<e.length;s++)if(e[s]===t)return e[s-1]}static getNext(t){const e=t.parentElement.children;if(t!==e[e.length-1])for(let s=e.length-2;s>=0;s--)if(e[s]===t)return e[s+1]}static disableSelection(t){const e=t.style;e["-moz-user-select"]="-moz-none",e["-khtml-user-select"]="none",e["-webkit-user-select"]="none",e["-o-user-select"]="none",e["-ms-user-select"]="none",e["user-select"]="none"}static selectAll(t){if(t&&window.getSelection&&document.createRange){const e=window.getSelection(),s=document.createRange();s.selectNodeContents(t),e.removeAllRanges(),e.addRange(s)}}static setMobile(t){W=t}static isMobile(){return void 0!==W?W:(void 0===z&&(z=this.$_checkMobile()),z)}static $_checkMobile(){let t=!1;return(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&(t=!0),t||function(e){if((/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),!t&&null!==e.match(/Macintosh/i)){let e=document.createElement("canvas");if(null!==e){let s=e.getContext("webgl")||e.getContext("experimental-webgl");if(s){let e=s.getExtension("WEBGL_debug_renderer_info");if(e){-1!==s.getParameter(e.UNMASKED_RENDERER_WEBGL).indexOf("Apple")&&(t=!0)}}}}}(navigator.userAgent||navigator.vendor||window.opera),t}static getBrowserSize(t){const e=t?t.ownerDocument:document,s=e.defaultView;return{width:s.innerWidth||e.documentElement.clientWidth||e.body.clientWidth,height:s.innerHeight||e.documentElement.clientHeight||e.body.clientHeight}}static move(t,e,s){t.style.left=e+"px",t.style.top=s+"px"}static htmlEncode(t){return document.createElement("a").appendChild(document.createTextNode(t)).parentNode.innerHTML}static detach(t){t&&t.parentNode&&t.parentNode.removeChild(t)}static getSize(t){const e=t.getBoundingClientRect();return{width:e.width,height:e.height}}static getScrolled(t){const e=t.body,s=Y(t),i=t.documentElement;return{sx:s.pageXOffset||i.scrollLeft||e.scrollLeft,sy:s.pageYOffset||i.scrollTop||e.scrollTop}}static getOffset(t){const e=t.ownerDocument,s=e.defaultView,i=t.getBoundingClientRect(),r=e.body,n=e.documentElement,o=s.pageYOffset||n.scrollTop||r.scrollTop,a=s.pageXOffset||n.scrollLeft||r.scrollLeft,A=n.clientTop||r.clientTop||0,l=n.clientLeft||r.clientLeft||0,h=i.left+a-l,d=i.top+o-A;return{x:Math.round(h),y:Math.round(d)}}static isAncestorOf(t,e){let s=e;for(;s;){if(s==t)return!0;s=s.parentElement}return!1}static equalNumbers(t,e){return isNaN(t)==isNaN(e)&&!isNaN(t)&&t==e}static equalArrays(t,e){if(t===e)return!0;if(null==t||null==e)return!1;const s=t.length;if(s!=e.length)return!1;for(let i=0;i<s;++i)if(t[i]!==e[i])return!1;return!0}static parseDate(t,e){const s=new Date(t);return isNaN(s.getTime())?e||new Date:s}static isLeapYear(t){return t%4==0&&t%100!=0||t%400==0}static incMonth(t,e){const s=t.getDate();return t.setDate(1),t.setMonth(t.getMonth()+e),t.setDate(Math.min(s,J.month_days[J.isLeapYear(t.getFullYear())?1:0][t.getMonth()])),t}static minDate(t,e){return null!==t?t:null!==e?e:t.getTime()<e.getTime()?t:e}static maxDate(t,e){return null!==t?e:null!==e||t.getTime()>e.getTime()?t:e}static setClassName(t,e){e!=t.className&&(t.className=e)}static addClassName(t,e){if(t.classList)t.classList.add(e);else{const s=t.className.split(" ");s.indexOf(e)<0&&s.push(e),t.className=s.join(" ")}}static removeClassName(t,e){if(t.classList)t.classList.remove(e);else{const s=t.className.split(" ");let i;(i=s.indexOf(e))>=0&&s.splice(i,1),t.className=s.join(" ")}}static getBoundingClientRect2(t){const e=t.getBoundingClientRect();return{x:e.left,y:e.top,left:e.left,right:e.right,width:e.right-e.left,top:e.top,bottom:e.bottom,height:e.bottom-e.top}}static getBoundingRect(t,e){const s=J.getBoundingClientRect2(e),i=J.getBoundingClientRect2(t);return new d(s.left-i.left,s.top-i.top,e.offsetWidth,e.offsetHeight)}static getTextLength(t){let e=0,s=0,i=0;for(;i=t.charCodeAt(s++);e+=i>>7?2:1);return e}static getClassName(t){if(t&&t.constructor)return t.constructor.name||function(t){let e=t.toString();return e=e.substr("function ".length),e=e.substr(0,e.indexOf("(")),e}(t.constructor)}static isInteger(t){return Number.isInteger?Number.isInteger(t):"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}static setTextProp(t){t.textProp=this.ieAll?"textContent":"innerText"}static isEmpty(t){if(t)for(let e in t)if(t.hasOwnProperty(e))return!1;return!0}static isNotEmpty(t){if(t)for(let e in t)if(t.hasOwnProperty(e))return!0;return!1}static capitalize(t){if("string"!=typeof t)return"";const e=t.charAt(0);return e>="A"&&e<="Z"?t:e.toUpperCase()+t.slice(1)}static uncapitalize(t){if("string"!=typeof t)return"";const e=t.charAt(0);return e>="a"&&e<="z"?t:e.toLowerCase()+t.slice(1)}static labelize(t){if("string"!=typeof t)return"";const e=t.charAt(0);let s=(t=e>="A"&&e<="Z"?t:e.toUpperCase()+t.slice(1)).charAt(0);for(let e=1;e<t.length;e++){const i=t.charAt(e);i>="A"&&i<="Z"&&(s+=" "),s+=i}return s}static escapeXML(t){return t.replace(/[&<>"']/g,(function(t){return K[t]}))}static deepClone(t){if(null===t||"object"!=typeof t)return t;const e=Array.isArray(t)?[]:{};for(let s of Object.keys(t))e[s]=J.deepClone(t[s]);return e}static getCaretOffset(t){const e=t.ownerDocument.getSelection();return e.rangeCount>0?e.focusOffset:0}static getFocused(){let t=document.getSelection().focusNode;for(;t;){if(t instanceof HTMLElement)return t;t=t.parentElement}}static getArray(t,e){const s=[];for(let i=0;i<t;i++)s.push(e);return s}static getNumArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=[];for(let i=0;i<t;i++)s.push(e);return s}static hasSetter(t,e){for(;t;){const s=Reflect.getOwnPropertyDescriptor(t,e);if(s)return s.writable||!!s.set;t=Object.getPrototypeOf(t)}}static dataUriToBinary(t){const e=";base64,",s=t.indexOf(e)+e.length,i=t.substring(s),r=window.atob(i),n=r.length,o=new Uint8Array(new ArrayBuffer(n));for(let t=0;t<n;t++)o[t]=r.charCodeAt(t);return o}static getImageUrl(t){const e=t.backgroundImage;if(e&&e.startsWith('url("'))return e.substring(5,e.length-2)}static cloneDom(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=t.parentElement,i=t.cloneNode(!0);if(e){const e=getComputedStyle(t);i.style.position="absolute",i.style.top=e.top,i.style.left=e.left}return i.style.visibility="hidden",i.style.transform="",s.insertBefore(i,t),i}static getTextRect(t){const e=document.createRange();return e.selectNodeContents(t),e.getBoundingClientRect()}}function Z(t,e){if(!t)throw new Error(e)}J.isIE=L,J.isEdge=N,J.ieAll=L||N,J.ieOld=M,J.isMac=S,J.isSafari=F,J.isWinSafari=D,J.isChrome=T,J.isFirefox=O,J.isOpera=I,J.ieLeg=k,J.ieTen=V,J.isiOS=H,J.isChromium=T||Q||R||I,J.TextProp=J.ieAll?"innerText":"textContent",J.week_days=window.RG_CONST&&window.RG_CONST.WEEKDAYS?window.RG_CONST.WEEKDAYS:["일","월","화","수","목","금","토"],J.month_days=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]],J.colonreg=/;(?=(?:[^"]*"[^"]*")*(?![^"]*"))/,J.$$_debugging=!1,J.$$_keyLog=!1,J.$$_trace=null;class q extends l{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this._positionable=!0,this._x=0,this._y=0,this._width=0,this._height=0,this._visible=!0,this._styleName="",this._elements=null,this._dirty=!0,this._hovered=!1,this._className="",this._nodraw=!1,this._name=e;let i=this._dom=this._createDom(t);i&&this._initDom(t,i),s&&s(this,i)}_doDispose(){if(this._dom&&(this._removeEventListeners(this._dom),J.detach(this._dom),this._dom=null),this._elements){for(let t of this._elements)t.dispose();this._elements.length=0}this._parent=null,super._doDispose()}get positionable(){return this._positionable}set positionable(t){t!=this._positionable&&(this._positionable=t,this.invalidate())}get name(){return this._name}get styleName(){return this._styleName}set styleName(t){t!=this._styleName&&(this._styleName=t,this.resetStyleName())}get container(){return this._parent&&this._parent.container}get parent(){return this._parent}get elements(){return this._elements?this._elements.slice(0):[]}get childCount(){return this._elements?this._elements.length:0}get isSingleton(){return this._parent&&1==this._parent.childCount&&this._parent._elements[0]===this}get x(){return this._x}set x(t){t!=this._x&&(this._x=t,this.invalidate())}get y(){return this._y}set y(t){t!=this._y&&(this._y=t,this.invalidate())}get width(){return this._width}set width(t){(t=Math.max(0,t))!=this._width&&(this._width=t,this.sizeChanged())}get height(){return this._height}set height(t){(t=Math.max(0,t))!=this._height&&(this._height=t,this.sizeChanged())}get right(){return this._x+this._width}get bottom(){return this._y+this._height}get position(){return new h(this._x,this._y)}get bounds(){return new d(this._x,this._y,this._width,this._height)}get clientRect(){return new d(0,0,this._width,this._height)}get visible(){return this._visible}set visible(t){t!=this._visible&&(this._visible=t,this._dom&&(this._dom.style.display=this._visible?this._getCssDisplay():"none"),this.invalidate(!0),this._visibleChanged())}get findable(){return!0}get hovered(){return this._hovered}set hovered(t){t!=this._hovered&&(this._hovered=t,this._hoverChanged())}get isLayer(){return!1}get blockable(){return!1}get mouseX(){const t=this.container;if(t){let e=t._currentX,s=this;for(;s&&void 0!==s;)e-=s._x,s=s._parent;return e}return NaN}get mouseY(){const t=this.container;if(t){let e=t._currentY,s=this;for(;s&&void 0!==s;)e-=s._y,s=s._parent;return e}return NaN}get dom(){return this._dom}get doc(){return j(this._dom)}get style(){return this._dom&&this._dom.style}get offsetWidth(){return this._dom.offsetWidth}get offsetHeight(){return this._dom.offsetHeight}get offsetSize(){return{width:this._dom.offsetWidth,height:this._dom.offsetHeight}}get printable(){return!0}isDom(t){return t===this._dom}containsDom(t){return this._dom.contains(t)}containsClass(t){return this._dom.classList.contains(t)}canHover(){return!0}getChildren(){return this._elements&&this._elements.slice(0)}getChild(t){return this._elements&&this._elements[t]}indexOf(t){return this._elements?this._elements.indexOf(t):-1}get firstChild(){return this._elements&&this._elements[0]}contains(t){return this._elements&&this._elements.indexOf(t)>=0}getAncestor(t){let e=this._parent;for(;e;){if(e instanceof t)return e;e=e._parent}return null}addDom(t){t&&this._dom.appendChild(t)}addChild(t){return this.insertChild(-1,t)}_getParentDom(){return this._dom}insertChild(t,e){if(e&&!this.contains(e)){const s=this._elements||[],i=e._dom,r=this._getParentDom();if(t<0||t>=s.length)r&&i&&r.appendChild(i),s.push(e);else{if(i){const e=this._elements[t]._dom;r&&e&&r.insertBefore(i,e)}s.splice(t,0,e)}return this._elements=s,e._parent=this,e.$_attached(this),this.invalidate(),!0}return!1}removeChild(t){if(t&&this._elements){const e=this._elements.indexOf(t);if(e>=0)return this.removeChildAt(e)===t}return!1}removeChildAt(t){if(t>=0&&t<this.childCount){const e=this._elements[t],s=this._getParentDom();return this._elements.splice(t,1),s&&e._dom&&s.removeChild(e._dom),e._parent=null,e._dirty=!1,e.$_detached(this),this.invalidate(),e}return null}removeLast(){return this._elements&&this._elements.length>0?this.removeChildAt(this._elements.length-1):null}clear(){const t=this._elements;if((t?t.length:0)>0){for(let e of t)e._parent=null,e.$_detached(this);this._elements=[];const e=this._getParentDom();if(e)for(;e.lastChild;)e.removeChild(e.lastChild);return this.invalidate(),!0}return!1}hideAll(){if(this._elements)for(let t of this._elements)t.visible=!1}invalidate(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t||!this._dirty){this._dirty=!0;const t=this.container;t&&t.invalidateElement(this)}if(e&&this._elements)for(let e of this._elements)e.invalidate(t,!0)}validate(){this._dirty=!1}invalidateLayout(){const t=this.container;t&&t.invalidateLayout()}getBounds(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?t.set(this._x,this._y,this._width,this._height):new d(this._x,this._y,this._width,this._height)}getClientRect(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?t.set(0,0,this._width,this._height):new d(0,0,this._width,this._height)}containsInBounds(t,e){return t>=this._x&&t<this._x+this._width&&e>=this._y&&e<this._y+this._height}containsInClient(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height}parentToElement(t,e,s){let i=this;for(;i&&i!=t;)e-=i._x,s-=i._y,i=i._parent;return new h(e,s)}translateBy(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=t;for(e||(e=new d(0,0,this._width,this._height));s&&s!==this;)e.x-=s._x,e.y-=s._y,s=s._parent;return e}topBy(t,e){let s=this._y+e,i=this._parent;for(;i&&i!==t;)s+=i._y,i=i._parent;return s}boundsBy(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this._x,i=this._y,r=this._parent;for(e&&(s+=e.x,i+=e.y);r&&r!==t;)s+=r._x,i+=r._y,r=r._parent;return e?new d(s,i,e.width,e.height):new d(s,i,this._width,this._height)}boundsByContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this._x,s=this._y;t&&(e+=t.x,s+=t.y);let i=this._parent;for(;i&&void 0!==i._x;)e+=i._x,s+=i._y,i=i._parent;return t?new d(e,s,t.width,t.height):new d(e,s,this._width,this._height)}pointByContainer(t,e){let s=this._parent;for(;s&&void 0!==s._x;)t+=s._x,e+=s._y,s=s._parent;return new h(t+this._x,e+this._y)}containerToElement(t,e){let s=this;for(;s;)t-=s._x,e-=s._y,s=s._parent;return new h(t,e)}boundsByScreen(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t=this.boundsByContainer(t),t=this.container.toScreen(t),t}offsetFrom(t){const e=t._dom,s=new h(this._dom.offsetLeft,this._dom.offsetTop);let i=this._dom.offsetParent;for(;i instanceof HTMLElement&&i!==e;)s.x+=i.offsetLeft,s.y+=i.offsetTop,i=i.offsetParent;return s}hitTest(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height}findChildAt(t,e,s,i){const r=this._elements,n=r?r.length:0;if(n>0)for(let o=n-1;o>=0;o--){const n=r[o];if(n.visible){const r=t-n._x,o=e-n._y;if((s||n.findable)&&(n.isLayer||n.hitTest(r,o))){const t=n.findChildAt(r,o,s,i);if(t)return t;if(!n.isLayer||i&&n.blockable)return n}}}return null}findChildOf(t){if(this._elements)for(let e of this._elements){if(e.isDom(t))return e;const s=e.findChildOf(t);if(s)return s}}move(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t==this._x&&e==this._y||(this._x=t,this._y=e,s?(!isNaN(t)&&(this._dom.style.left=t+"px"),!isNaN(e)&&(this._dom.style.top=e+"px")):this.invalidate())}moveBy(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.move(this._x+t,this._y+e,s)}resize(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t==this._width&&e==this._height||(this._width=t,this._height=e,s?this._setSizeStyle(this._dom.style):this.sizeChanged())}resizeBy(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.resize(this._width+t,this._height+e,s)}setBounds(t,e,s,i){return t==this._x&&e==this._y||(this._x=t,this._y=e,this.invalidate()),this.resize(s,i),this}setBoundsI(t,e,s,i){return e>>=0,s>>=0,i>>=0,(t>>=0)==this._x&&e==this._y||(this._x=t,this._y=e,this.invalidate()),this.resize(s,i),this}setRect(t){return t.x==this._x&&t.y==this._y||(this._x=t.x,this._y=t.y,this.invalidate()),this.resize(t.width,t.height),this}setRectI(t){const e=t.x>>0,s=t.y>>0,i=t.width>>0,r=t.height>>0;return e==this._x&&s==this._y||(this._x=e,this._y=s,this.invalidate()),this.resize(i,r),this}getBoundingRect(){return J.getBoundingClientRect2(this._dom)}draw(){this._dirty&&this._dom&&!this._nodraw&&(this._beforeDraw(this._dom),this._doDraw(this._dom),this._afterDraw(this._dom),this._dirty=!1)}drawRecursive(){this.draw();for(let t=0,e=this.childCount;t<e;t++){const e=this._elements[t];e.visible&&e.drawRecursive()}}resetSizeStyle(){this._dom&&this._setSizeStyle(this._dom.style)}getHtml(){return this._dom&&this._dom.outerHTML}setImportantStyle(t,e){this._dom.style.setProperty(t,e,"important")}isAncestorOf(t){let e=t&&t.parent;for(;e;){if(e===this)return!0;e=e.parent}}isAncestorDomOf(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&this._dom===t)return!0;let e=t.parentElement;for(;e;){if(e===this._dom)return!0;e=e.parentElement}}findDescendantOf(t){for(let e=this.childCount-1;e>=0;e--){let s=this.getChild(e);if(s._dom===t)return s;if(s=s.findDescendantOf(t),s)return s}}setStyles(t){if(t){const e=this._dom.style;for(let s in t)e[s]=t[s]}}get scrollTop(){return this._dom.scrollTop}get scrollLeft(){return this._dom.scrollLeft}scrollDom(t,e){J.isIE?(this._dom.scrollTop=e,this._dom.scrollLeft=t):this._dom.scroll(t,e)}setHint(t){this._dom.title=t}setRotation(t){const e=this._dom.style;isNaN(t)||0===t?e.transform="":(e.transformOrigin="center",e.transform="rotate("+t+"deg)")}_isTesting(){return q.Testing}_getElements(){return this._elements}_createDom(t){return t.createElement("div")}_getCssSelector(){return this._styleName}_initDom(t,e){const s=e.style;s.position="absolute",s.boxSizing="border-box",this._addEventListeners(e)}_addEventListeners(t){}_removeEventListeners(t){}$_attached(t){this._doAttached(t)}_doAttached(t){}$_detached(t){this._doDetached(t)}_doDetached(t){}_isEmptySize(){return!1}_setSizeStyle(t){this._isEmptySize()?(t.width="",t.height=""):(t.width=isNaN(this._width)?"":this._width+"px",t.height=isNaN(this._height)?"":this._height+"px")}setPrintStyles(){const t=this._dom.style;isNaN(this._x)||(t.left=this._x+"px"),isNaN(this._y)||(t.top=this._y+"px"),isNaN(this._width)||(t.width=this._width+"px"),isNaN(this._height)||(t.height=this._height+"px")}_getCssDisplay(){return"block"}resetStyleName(){this._setClassName(this._dom)}_setClassName(t){let e=this._getCssSelector();e!=this._className&&(this._className=e,(t||this._dom).className=e||"")}replaceDom(t){const e=this._dom,s=e.parentElement;s.removeChild(e),s.appendChild(t),this._dom=t}cloneNode(){return this._dom.cloneNode(!0)}applyBounds(){let t=this._dom.style;t.left=this._x+"px",t.top=this._y+"px",this._setSizeStyle(t)}_beforeDraw(t){this._setClassName(t);let e=t.style;this._positionable?(e.left=this._x+"px",e.top=this._y+"px"):(e.left="",e.top=""),this._setSizeStyle(e)}_doDraw(t){}_afterDraw(t){}_hoverChanged(){}_visibleChanged(){}sizeChanged(){this.invalidate(!0,!0),this._doSizeChanged()}_doSizeChanged(){}}q.Testing=!1;class tt extends q{get isLayer(){return!0}_doDraw(t){}}class et extends A{constructor(t,e){super(),this._clickX=0,this._clickY=0,this._mouseX=0,this._mouseY=0,this._owner=t,this._name=e,this._previous=null}_doDispose(){this._dragTracker=null,this._previous=null,this._owner=null,this._mouseEventTarget=null,super._doDispose()}get owner(){return this._owner}get name(){return this._name}get previous(){return this._previous}get dragTracker(){return this._dragTracker}set dragTracker(t){t!==this._dragTracker&&(this._dragTracker&&this._dragTracker.deactivate(),this._dragTracker=t,this._dragTracker&&this._dragTracker.activate())}get dragging(){return this._dragTracker&&this._dragTracker.dragging}get mouseX(){return this._mouseX}get mouseY(){return this._mouseY}get mouseEventTarget(){return this._mouseEventTarget}findElementAt(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this._owner.findElementAt(t,e,s,i)}findElementOf(t){return this._owner.findElementOf(t)}activate(t){this._doActivated(t)}deactivate(){this._doDeactivated()}keyDown(t){return this._doKeyDown(t)}keyUp(t){return this._doKeyUp(t)}keyPress(t){return this._doKeyPress(t)}mouseDown(t){const e=this._mouseX=this._clickX=t.mouseX,s=this._mouseY=this._clickY=t.mouseY;this.dragging&&this._stopDragTracker(e,s,!1);const i=this._doMouseDown(t);return this._dragTracker&&this._dragTracker.startWhenCreated&&this._startDragTracker(e,s,t.shiftKey,t.altKey),i}dragFrom(t,e){}dropFrom(t,e){}mouseMove(t){const e=this._mouseX=t.mouseX,s=this._mouseY=t.mouseY,i=this._dragTracker,r="mousemove"===t.type?t.buttons:"touchmove"===t.type?1:void 0;if(i)if(i.dragging)if(null==r||r>0||J.ieOld&&r>=0){if(!i.drag(this._mouseEventTarget,e,s)){const r=i.getNextRequest(e,s);r&&(this._stopDragTracker(e,s,!0),this.dragTracker=this._getDragTracker(r,e,s),this._startDragTracker(e,s,t.shiftKey,t.altKey))}}else this._stopDragTracker(e,s,!0);else Math.abs(e-this._clickX)>=3||Math.abs(s-this._clickY)>=3?this._startDragTracker(e,s,t.shiftKey,t.altKey):this._doMouseMove(t);else this._doMouseMove(t)}mouseUp(t){try{const e=this._mouseX=t.mouseX,s=this._mouseY=t.mouseY;this.dragging?this._stopDragTracker(e,s,!1):this._doMouseUp(t)}finally{this._dragTracker=null}}mouseEnter(t){this._doMouseEnter(t)}mouseLeave(t){this._doMouseLeave(t)}mouseOver(t){this._doMouseOver(t)}mouseOutside(){this._doMouseOutside()}mouseWheel(t){return this._doMouseWheel(t)}contextMenu(t){return this._doContextMenu(t)}click(t){this._doClick(t)}dblclick(t){this._doDblClick(t)}setFocus(t){!J.isMobile()&&this._doSetFocus(t)}focusLeave(t){this._doFocusLeave(t)}dragStart(t){this._doDragStart(t)}dragEnd(t){this._doDragEnd(t)}dragEnter(t){this._doDragEnter(t)}dragOver(t){this._doDragOver(t)}dragLeave(t){this._doDragLeave(t)}dragDrop(t){this._doDragDrop(t)}isMouseEventTarget(t){return t._dom===this._mouseEventTarget}_doActivated(t){}_doDeactivated(){}_doKeyDown(t){return!1}_doKeyUp(t){return!1}_doKeyPress(t){return!1}_doMouseDown(t){return!1}_doMouseMove(t){}_doMouseUp(t){}_doMouseEnter(t){}_doMouseLeave(t){}_doMouseOver(t){}_doMouseOutside(){}_doMouseWheel(t){return!1}_doContextMenu(t){}_doClick(t){}_doDblClick(t){}_doSetFocus(t){}_doFocusLeave(t){}_doDragStart(t){}_doDragEnd(t){}_doDragEnter(t){}_doDragOver(t){}_doDragLeave(t){}_doDragDrop(t){}_getDragTracker(t,e,s){return null}_startDragTracker(t,e,s,i){this._dragTracker&&(this._dragTracker.start(this._mouseEventTarget,t,e,s,i)?this._doDragTrackerStarted(this._dragTracker):this._dragTracker=null)}_stopDragTracker(t,e,s){if(this.dragging){const i=this._dragTracker;s?i.cancel():i.drop(this._mouseEventTarget,t,e),this.dragTracker=null,this._doDragTrackerFinished(i,s)}}_doDragTrackerStarted(t){}_doDragTrackerFinished(t,e){}_findTableCell(t){return this.owner.getTableCell(t||this.mouseEventTarget)}_doTouchStart(t){}_doTouchMove(t){}_doTouchEnd(t){}_doTouchCancel(t){}}class st extends A{constructor(t,e){super(),this._active=!1,this._completed=!1,this._dragging=!1,this._currentX=0,this._currentY=0,this._container=t,this._name=e}get container(){return this._container}get name(){return this._name}get active(){return this._active}get dragging(){return this._dragging}get startWhenCreated(){return!1}get completed(){return this._completed}get linkable(){return!1}get cursor(){}activate(){this._active||(this._doActivate(),this._active=!0)}deactivate(){this._active&&(this.cancel(),this._doDeactivate(),this._active=!1)}start(t,e,s,i,r){return this.cancel(),!(!this._active||!this._doStart(t,e,s,i,r))&&(this._currentX=this._startX=e,this._currentY=this._startY=s,this._dragging=!0,this._completed=!1,this._showFeedback(e,s),this.container.setCursor(this.cursor||""),!0)}drag(t,e,s){return!(!this._dragging||(this._currentX=e,this._currentY=s,!this._doDrag(t,e,s)))&&(this.container.setCursor(this.cursor||""),this._moveFeedback(e,s),!0)}cancel(){try{if(this._dragging)try{this._dragging=!1,this._doCanceled(this._currentX,this._currentY)}finally{this.end()}}finally{this._hideFeedback()}}drop(t,e,s){try{if(this._dragging)try{this._currentX=e,this._currentY=s,this._dragging=!1,this._canAccept(t,e,s)?(this._doCompleted(t,e,s),this._completed=!0):this._doCanceled(e,s)}finally{this.end()}}finally{this._hideFeedback()}}end(){this.container.setCursor(""),this._doEnded()}getRequest(){return null}getNextRequest(t,e){return null}get startX(){return this._startX}get startY(){return this._startY}get currentX(){return this._currentX}get currentY(){return this._currentY}_showFeedback(t,e){}_moveFeedback(t,e){}_hideFeedback(){}_doActivate(){}_doDeactivate(){}_doStart(t,e,s,i,r){return!0}_doDrag(t,e,s){return!0}_doCanceled(t,e){}_canAccept(t,e,s){return!0}_doCompleted(t,e,s){}_doEnded(){}}var it;!function(t){t.LINE="line",t.PAGE="page",t.THUMB_TRACK="thumbTrack",t.THUMB_END="thumbEnd"}(it||(it={}));class rt extends q{constructor(t,e,s){super(t,s),this._scrollBar=e}_doDispose(){this._scrollBar=null,super._doDispose()}get scrollBar(){return this._scrollBar}get vertical(){return this._scrollBar.vertical}_doDraw(t){this._doRender(t)}_doRender(t){}_changed(){this.invalidate()}}class nt extends rt{constructor(t){super(t.doc,t,"scrollTrackView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rg-scrolltrack"}}class ot extends rt{constructor(t,e){super(t.doc,t,"scrollButtonView"),this._enabled=!0,this._far=e}get enabled(){return this._enabled}set enabled(t){t!=this._enabled&&(this._enabled=t,this._changed())}get far(){return this._far}_getCssSelector(){return this.scrollBar.vertical?this._far?"rg-scroll-down":"rg-scroll-up":this._far?"rg-scroll-right":"rg-scroll-left"}}class at extends rt{constructor(t){super(t.doc,t,"scrollThumbView")}_getCssSelector(){return"rg-scrollthumb"}}class At extends q{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(t.doc,"scrollBarView"),this._lineScrollSize=1,this._pageScrollSize=1,this._minThumbSize=20,this._min=0,this._max=0,this._pos=0,this._page=0,this._maxPosition=0,this._buttonSize=20,this._needLayout=!0,this._tipView=null,this._container=t,this._vertical=e,this._track=new nt(this),this.addChild(this._track),this._thumb=new at(this),this.addChild(this._thumb),this._nearButton=new ot(this,!1),this.addChild(this._nearButton),this._farButton=new ot(this,!0),this.addChild(this._farButton)}_doDispose(){this._track=this._track.dispose(),this._thumb=this._thumb.dispose(),this._nearButton=this._nearButton.dispose(),this._farButton=this._farButton.dispose(),super._doDispose()}get container(){return this._container}get lineScrollSize(){return this._lineScrollSize}set lineScrollSize(t){(t=Math.max(1,t))!=this._lineScrollSize&&(this._lineScrollSize=t)}get pageScrollSize(){return this._pageScrollSize}set pageScrollSize(t){(t=Math.max(1,t))!=this._pageScrollSize&&(this._pageScrollSize=t)}get minThumbSize(){return this._minThumbSize}set minThumbSize(t){(t=Math.max(8,t))!=this._minThumbSize&&(this._minThumbSize=t,this.invalidateLayout())}get vertical(){return this._vertical}get pos(){return this._pos}get maxPosition(){return this._maxPosition}get buttonSize(){return this._buttonSize}set tipView(t){this._tipView=t}layoutContent(){this._needLayout&&(this._needLayout=!1,this._doLayoutContent())}setProperties(t,e,s){t=Math.max(0,t),e=Math.max(t,e),t==this._min&&e==this._max&&s==this._page||(this._min=t,this._max=e,this._page=s,this._pos=Math.min(this._max,Math.max(this._min,this._pos)),this._maxPosition=Math.max(0,this._max-this._page),this.invalidate(),this._needLayout=!0)}setPosition(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(t=Math.min(this._maxPosition,Math.max(this._min,t)))!=this._pos&&(this._pos=t,this.invalidate(),this._needLayout=!0,e&&this.layoutContent())}ptInTrack(t,e,s){const i=this.containerToElement(t,e);if(this._vertical){if(i.y>=this._nearButton.height&&i.x<this._farButton.y)return!s&&i.y<this._thumb.y||s&&i.y>=this._thumb.bottom}else if(t>=this._nearButton.width&&t<this._farButton.x)return!s&&i.x<this._thumb.x||s&&i.x>=this._thumb.right;return!1}setText(t){if(this._tipView&&t){let e,s;if(this._tipView.show(),this._tipView.setText(t),this._vertical){let t=this._tipView.width();e=this.x-t-5,s=this._thumb.y}else{let t=this._tipView.height();e=this._thumb.x,s=this.y-t-5}this._tipView.move(e,s)}}_getCssSelector(){return this._vertical?"rg-vscrollbar":"rg-hscrollbar"}draw(){super.draw()}_doDraw(t){}_doSizeChanged(){this.invalidateLayout()}invalidateLayout(){this._needLayout=!0,super.invalidateLayout()}_doLayoutContent(){const t=this._vertical,e=this._buttonSize,s=this.height,i=this.width,r=(t?s:i)-2*e,n=Math.min(r,Math.max(this._minThumbSize,Math.floor(r*this._page/(this._max-this._min+1)))),o=e+Math.min(r-n,Math.max(0,Math.floor((r-n)*this._pos/(this._maxPosition-this._min))));this._track.setBounds(0,0,i,s),t?(this._nearButton.setBounds(0,0,i,e),this._farButton.setBounds(0,s-e,i,e),n<=r&&this._thumb.setBounds(2,o,i-4,n)):(this._nearButton.setBounds(0,0,e,s),this._farButton.setBounds(i-e,0,e,s),n<=r&&this._thumb.setBounds(o,2,n,s-4))}_doScroll(t,e,s){this.fireEvent(At.SCROLLED,t,e,s)}}At.SCROLLED="onScrollBarScrolled";class lt extends st{constructor(t){super(t,"scrollThumbTracker")}_doDispose(){this._thumb=this._thumb&&this._thumb.dispose(),super._doDispose()}get thumb(){return this._thumb}set thumb(t){this._thumb=t}get startWhenCreated(){return!0}_doStart(t,e,s){const i=this._thumb.scrollBar,r=i.containerToElement(e,s);return i.vertical?this._offset=r.y-this._thumb.y:this._offset=r.x-this._thumb.x,!0}_doDrag(t,e,s){return this.$_doScroll(e,s,it.THUMB_TRACK)}_doCompleted(t,e,s){return this.$_doScroll(e,s,it.THUMB_END)}_doCanceled(t,e){}_doEnded(){}$_doScroll(t,e,s){const i=this._thumb.scrollBar,r=i._maxPosition-i._min+1,n=i._buttonSize,o=i.containerToElement(t,e);if(i.vertical){const t=i.height-2*n-this._thumb.height;if(t<=0)return!1;o.y-=this._offset,o.y=(o.y-n)*r/t,i._doScroll(s,0,Math.floor(o.y))}else{const t=i.width-2*n-this._thumb.width;if(t<=0)return!1;o.x-=this._offset,o.x=(o.x-n)*r/t,i._doScroll(s,0,Math.floor(o.x))}return!0}}class ht extends l{constructor(){super(),this._active=!1,this._timer=void 0,this._ready=!1}get active(){return void 0!==this._timer}start(t){this._button=t,this._scrollBar=t.scrollBar,this._active=!0,setTimeout(function(){this._ready&&(this._ready=!1,this._timer=setInterval(function(){this._active&&this.$_fireEvent()}.bind(this),20))}.bind(this),200),this._ready=!0,this.$_fireEvent()}move(t,e){const s=this._button.containerToElement(t,e);this._active=this._button.containsInClient(s.x,s.y)}stop(){this._ready=!1,this._timer&&(clearInterval(this._timer),this._timer=void 0)}$_fireEvent(){let t=this._button.far?1:-1,e=it.LINE;this._scrollBar._doScroll(e,this._scrollBar.lineScrollSize*t,0)}}class dt extends A{constructor(){super(),this._active=!1,this._timer=void 0,this._ready=!1,this._mouseX=0,this._mouseY=0}get active(){return this._active}start(t,e,s,i){this._scrollBar=t,this._far=e,this._active=!0,setTimeout(function(){this._ready&&(this._ready=!1,this._timer=setInterval(function(){this._active&&this.$_fireEvent()}.bind(this),50))}.bind(this),200),this._ready=!0;const r=this._scrollBar.containerToElement(s,i);this._mouseX=r.x,this._mouseY=r.y,this.$_fireEvent()}move(t,e){const s=this._scrollBar.containerToElement(t,e);this._mouseX=s.x,this._mouseY=s.y,this._active=this._scrollBar.ptInTrack(s.x,s.y,this._far)}stop(){this._ready=!1,this._timer&&clearInterval(this._timer)}$_fireEvent(){let t=null,e=0;const s=this._scrollBar._thumb;if(this._scrollBar.vertical){const i=this._mouseY;this._far&&i>s.bottom?(t=it.PAGE,e=1):!this._far&&i<s.y&&(t=it.PAGE,e=-1)}else{const i=this._mouseX;this._far&&i>s.right?(e=1,t=it.PAGE):i<s.x&&(t=it.PAGE,e=-1)}0!=e&&this._scrollBar._doScroll(t,this._scrollBar.pageScrollSize*e,0)}}class ct extends et{constructor(t){super(t,"scrollTool"),this._buttonTimer=new ht,this._trackTimer=new dt,this._thumbTracker=new lt(t)}_doDispose(){this._thumbTracker.cancel(),this._thumbTracker=this._thumbTracker.dispose(),this._buttonTimer.stop(),this._buttonTimer=this._buttonTimer.dispose(),this._trackTimer.stop(),this._trackTimer=this._trackTimer.dispose(),super._doDispose()}_doMouseDown(t){const e=t.mouseX,s=t.mouseY;this._clickElement=null,this._buttonTimer.stop(),this._trackTimer.stop();const i=this.findElementAt(e,s,!1);if(i instanceof rt){if(this._clickElement=i,i instanceof ot)this._buttonTimer.start(i);else if(i instanceof at)this._thumbTracker.thumb=i,this.dragTracker=this._thumbTracker;else if(i instanceof nt){const t=i.scrollBar.ptInTrack(e,s,!0);this._trackTimer.start(i.scrollBar,t,e,s)}return!0}}_doMouseMove(t){const e=t.mouseX,s=t.mouseY,i=this._clickElement;i instanceof ot&&this._buttonTimer.active?this._buttonTimer.move(e,s):i instanceof nt&&this._trackTimer.active&&this._trackTimer.move(e,s)}_doMouseUp(t){this._clickElement=null,this._buttonTimer.stop(),this._trackTimer.stop()}_doTouchStart(t){this.mouseDown(t),t.preventDefault()}_doTouchEnd(t){this.mouseUp(t)}_doTouchMove(t){this.mouseMove(t)}}class ut extends A{constructor(t,e){super(),this._clickX=0,this._clickY=0,this._pointerX=0,this._pointerY=0,this._owner=t,this._name=e,this._previous=null}_doDispose(){this._dragTracker=null,this._previous=null,this._owner=null,this._pointerEventTarget=null,super._doDispose()}get owner(){return this._owner}get name(){return this._name}get previous(){return this._previous}get dragTracker(){return this._dragTracker}set dragTracker(t){t!==this._dragTracker&&(this._dragTracker&&this._dragTracker.deactivate(),this._dragTracker=t,this._dragTracker&&this._dragTracker.activate())}get dragging(){return this._dragTracker&&this._dragTracker.dragging}get pointerX(){return this._pointerX}get pointerY(){return this._pointerY}activate(t){this._doActivated(t)}deactivate(){this._doDeactivated()}keyDown(t){return this._doKeyDown(t)}keyUp(t){return this._doKeyUp(t)}keyPress(t){return this._doKeyPress(t)}pointerDown(t){const e=this._pointerX=this._clickX=t.pointerX,s=this._pointerY=this._clickY=t.pointerY;return this.dragging&&this._stopDragTracker(t,e,s,!1),this._doPointerDown(t)}dragFrom(t,e){}dropFrom(t,e){}pointerMove(t){const e=this._pointerX=t.pointerX,s=this._pointerY=t.pointerY,i=this.dragTracker,r="pointermove"===t.type?t.buttons:"touchmove"===t.type?1:void 0;if(i)if(i.dragging)if(null==r||r>0||J.ieOld&&r>=0){if(!i.drag(this._pointerEventTarget,e,s)){const r=i.getNextRequest(e,s);r&&(this._stopDragTracker(t,e,s,!0),this.dragTracker=this._getUIDragTracker(r,e,s),this._startDragTracker(t,e,s,t.shiftKey,t.altKey))}}else this._stopDragTracker(t,e,s,!0);else i.startWhenCreated||Math.abs(e-this._clickX)>=3||Math.abs(s-this._clickY)>=3?this._startDragTracker(t,e,s,t.shiftKey,t.altKey):this._doPointerMove(t);else this._doPointerMove(t)}pointerUp(t){const e=this._pointerX=t.pointerX,s=this._pointerY=t.pointerY;this.dragging?this._stopDragTracker(t,e,s,!1):(this._dragTracker=null,this._doPointerUp(t))}pointerEnter(t){this._doPointerEnter(t)}pointerLeave(t){this._doPointerLeave(t)}pointerOver(t){this._doPointerOver(t)}pointerOutside(){this._doPointerOutside()}mouseWheel(t){return this._doMouseWheel(t)}contextMenu(t){return this._doContextMenu(t)}click(t){this._doClick(t)}dblclick(t){this._doDblClick(t)}setFocus(t){!J.isMobile()&&this._doSetFocus(t)}focusLeave(t){this._doFocusLeave(t)}get pointerEventTarget(){return this._pointerEventTarget}ispointerEventTarget(t){return t._dom===this._pointerEventTarget}_doActivated(t){}_doDeactivated(){}_doKeyDown(t){return!1}_doKeyUp(t){return!1}_doKeyPress(t){return!1}_doPointerDown(t){return!1}_doPointerMove(t){}_doPointerUp(t){}_doPointerEnter(t){}_doPointerLeave(t){}_doPointerOver(t){}_doPointerOutside(){}_doMouseWheel(t){return!1}_doContextMenu(t){}_doClick(t){}_doDblClick(t){}_doSetFocus(t){}_doFocusLeave(t){}_getUIDragTracker(t,e,s){return null}_startDragTracker(t,e,s,i,r){this._dragTracker&&(this._dragTracker.start(t,this._pointerEventTarget,e,s,i,r)?this._doDragTrackerStarted(this._dragTracker):this._dragTracker=null)}_stopDragTracker(t,e,s,i){if(this.dragging){const r=this._dragTracker;i?r.cancel(t):r.drop(t,this._pointerEventTarget,e,s),this.dragTracker=null,this._doDragTrackerFinished(r,i)}}_doDragTrackerStarted(t){}_doDragTrackerFinished(t,e){}}class pt extends A{constructor(t,e){super(),this._active=!1,this._completed=!1,this._dragging=!1,this._currentX=0,this._currentY=0,this._container=t,this._name=e}get container(){return this._container}get name(){return this._name}get active(){return this._active}get dragging(){return this._dragging}get startWhenCreated(){return!1}get completed(){return this._completed}get linkable(){return!1}activate(){this._active||(this._doActivate(),this._active=!0)}deactivate(){this._active&&(this.cancel(null),this._doDeactivate(),this._active=!1)}start(t,e,s,i,r,n){return this.cancel(t),!(!this._active||!this._doStart(t,e,s,i,r,n))&&(this._currentX=this._startX=s,this._currentY=this._startY=i,this._dragging=!0,this._completed=!1,this._showFeedback(s,i),!0)}drag(t,e,s){return!(!this._dragging||(this._currentX=e,this._currentY=s,!this._doDrag(t,e,s)))&&(this._moveFeedback(e,s),!0)}cancel(t){try{if(this._dragging)try{this._dragging=!1,this._doCanceled(this._currentX,this._currentY)}finally{this._doEnded(t)}}finally{this._hideFeedback()}}drop(t,e,s,i){try{if(this._dragging)try{this._currentX=s,this._currentY=i,this._dragging=!1,this._canAccept(e,s,i)?(this._doCompleted(e,s,i),this._completed=!0):this._doCanceled(s,i)}finally{this._doEnded(t)}}finally{this._hideFeedback()}}getRequest(){return null}getNextRequest(t,e){return null}get startX(){return this._startX}get startY(){return this._startY}get currentX(){return this._currentX}get currentY(){return this._currentY}_showFeedback(t,e){}_moveFeedback(t,e){}_hideFeedback(){}_doActivate(){}_doDeactivate(){}_doStart(t,e,s,i,r,n){return!0}_doDrag(t,e,s){return!0}_doCanceled(t,e){}_canAccept(t,e,s){return!0}_doCompleted(t,e,s){}_doEnded(t){}}class _t extends l{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"div";super(),this._elements=[],this._dom=s&&t.createElement(s),this._dom.className=e,this._prepareDom(t,this._dom)}get dom(){return this._dom}get parent(){return this._parent}get container(){return this._parent&&this._parent.container}get x(){return this._dom.offsetLeft}set x(t){this._dom.style.left=t+"px"}get y(){return this._dom.offsetTop}set y(t){this._dom.style.top=t+"px"}get width(){return this._dom.offsetWidth}get height(){return this._dom.offsetHeight}isDom(t){return t===this._dom}setClassName(t){this._dom.className=t}setHint(t){this._dom.title=t}setStyle(t,e){this._dom.style[t]=e}clearStyle(t){this._dom.style[t]=""}setStyles(t){if(t){const e=this._dom.style;for(let s in t){const i=t[s];e[s]=void 0===i?"":i}}}setImportantStyle(t,e){this._dom.style.setProperty(t,e,"important")}getBounds(){return this._dom.getBoundingClientRect()}setBounds(t,e,s,i){J.extend(this._dom.style,{left:t+"px",top:e+"px",width:s+"px",height:i+"px"})}setRect(t){this.setBounds(t.x,t.y,t.width,t.height)}move(t,e){return this._dom.style.left=t+"px",this._dom.style.top=e+"px",this}setXP(t){this._dom.style.left=t+"%"}setYP(t){this._dom.style.top=t+"%"}clear(){if(this._elements.length>0){for(let t of this._elements)this._dom.removeChild(t._dom),t._parent=null;this._elements=[]}}addChild(t){if(t&&!this._elements.includes(t,0))return this._addChild(t),!0}removeChild(t){return t&&this._removeChild(t)}removeLast(){if(this._elements.length>0){const t=this._elements[this._elements.length-1];return this._removeChild(t),t}}containerToLocal(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=this.container._containerDiv;let i=this._dom,r=this._dom.offsetParent;for(;r&&(t-=i.offsetLeft,e-=i.offsetTop,r!==s);)i=r,r=i.offsetParent;return{x:t,y:e}}setText(t){this._dom.textContent=t}hide(){this._dom.style.display="none"}show(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"inherit";this._dom.style.display=t}setRotation(t){const e=this._dom.style;0!==t?(e.transformOrigin="center",e.transform="rotate("+t+"deg)"):e.transform=""}_addChild(t){this._elements.push(t),this._dom.appendChild(t._dom),t._parent=this}_removeChild(t){const e=this._elements.indexOf(t);if(e>=0)return this._dom.removeChild(t._dom),t._parent=null,this._elements.splice(e,1),!0}_prepareDom(t,e){}}class gt extends ut{}class ft extends _t{constructor(t,e){super(t,null),this._container=e}get container(){return this._container}}class mt extends l{constructor(t){super(),this._layoutNeeded=!1,this._defaultCursor="default",this._eventHandlers={},this._eventNodes=[],this._containerRender=this._render.bind(this),this._saveDisplay="",this.prepareContainer(t),this._registerEventHandlers(this._containerDiv),this._root=new ft(this.doc,this),this._root._dom=this._containerDiv,this.activeTool=this._defaultTool=this._createDefaultTool(),this._prepareChildren(this.doc,this._containerDiv),this.invalidateLayout()}_doDispose(){this._activeTool=null,this._defaultTool=this._defaultTool.dispose(),this.$_removeListenerAll(null),J.clearElements(this._containerDiv),super._doDispose()}get doc(){return this._doc}get visible(){return"none"!==getComputedStyle(this._containerDiv).display}set visible(t){t!=this.visible&&(t?this._containerDiv.style.display=this._saveDisplay:(this._saveDisplay=getComputedStyle(this._containerDiv).display,this._containerDiv.style.display="none"))}get activeTool(){return this._activeTool}set activeTool(t){if((t=t||this._defaultTool)!=this._activeTool){const e=this._activeTool;e&&e.deactivate(),this._activeTool=t,t&&t.activate(e)}}get defaultTool(){return this._defaultTool}get width(){return this._containerDiv.offsetWidth}get height(){return this._containerDiv.offsetHeight}getBound(){const t=this._containerDiv.getBoundingClientRect();return new d(t.left,t.top,t.width,t.height)}getHtml(){return this._containerDiv.outerHTML}setCursor(t){this._containerDiv.style.cursor=t||this._defaultCursor}contains(t){if(t instanceof Y(this.doc).HTMLElement)return this._containerDiv.contains(t)}prepareContainer(t){if(!t)throw new Error("container is null!");if(o(t,"HTMLDivElement")?this._containerDiv=t:this._containerDiv=document.getElementById(t),!o(this._containerDiv,"HTMLDivElement"))throw new Error("Invalid grid container element: "+t);this._containerDiv.className=this._getCssSelector();const e=Y(this._doc=this._containerDiv.ownerDocument);e.requestAnimationFrame=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return e.setTimeout(t,10)}}_addElement(t){this._containerDiv.appendChild(t._dom),this._root._addChild(t)}_prepareChildren(t,e){}_createDefaultTool(){return new gt(null,"dummy")}isLayoutNeeded(){return this._layoutNeeded}invalidateLayout(){if(!this._layoutNeeded&&(this._layoutNeeded=!0,!this._requestTimer)){const t=Y(this._doc);this._requestTimer=t.requestAnimationFrame(this._containerRender)}}updateNow(){this._layoutNeeded=!0,this._render(J.getTimer())}_render(t){if(!this.disposing)try{this.$$_render(t)}finally{this._requestTimer=null}}$$_render(t){const e=this._containerDiv,s=e.clientWidth,i=e.clientHeight;this._layoutNeeded?(this._doLayout(this._doc,new d(0,0,s,i)),this._layoutNeeded=!1):this._doPrepareRender(new d(0,0,s,i)),this._doRenderHtml(new d(0,0,s,i))}_doLayout(t,e){}_doPrepareRender(t){}_doRenderHtml(t){}_registerEventHandlers(t){const e=X(t);t.style.cursor=this._defaultCursor,this.$_addListener(e,"resize",this._resizeHandler.bind(this),!1),this.$_addListener(e,"pointermove",this._pointerMoveHandler.bind(this),!1),this.$_addListener(e,"pointerup",this._pointerUpHandler.bind(this),!1),this.$_addListener(e,"focus",this._focusHandlerFireFox.bind(this),!0),this.$_addListener(e,"focusin",this._focusinHandler.bind(this),!0),this.$_addListener(e,"focusout",this._focusoutHandler.bind(this),!0),this.$_addListener(e,"pointerdown",this._globalPointerDownHandler.bind(this),!1),this.$_addListener(t,"keydown",this._keyDownHandler.bind(this),!1),this.$_addListener(t,"keyup",this._keyUpHandler.bind(this),!1),this.$_addListener(t,"keypress",this._keyPressHandler.bind(this),!1),this.$_addListener(t,"click",this._clickHandler.bind(this),!1),this.$_addListener(t,"dblclick",this._dblclickHandler.bind(this),!1),this.$_addListener(t,"pointerdown",this._pointerDownHandler.bind(this),!1),this.$_addListener(t,"pointerenter",this._pointerEnterHandler.bind(this),!1),this.$_addListener(t,"pointerleave",this._pointerLeaveHandler.bind(this),!1),this.$_addListener(t,"pointerover",this._pointerOverHandler.bind(this),!1),this.$_addListener(t,"focus",this._focusHandler.bind(this),!1),this.$_addListener(t,"contextmenu",this._contextMenuHander.bind(this),!1),this.$_addListener(t,"blur",this._blurHandler.bind(this),!1),this.$_addListener(t,"selectstart",this._selectstartHandler.bind(this),!1),this.$_addListener(t,"wheel",this._wheelHandler.bind(this),!1)}$_addListener(t,e,s,i){t in this._eventHandlers||(this._eventHandlers[t]={}),e in this._eventHandlers[t]||(this._eventHandlers[t][e]=[]),this._eventHandlers[t][e].push([s,i]),t.addEventListener(e,s,i),this._eventNodes.indexOf(t)<0&&this._eventNodes.push(t)}$_removeListener(t,e){if(t in this._eventHandlers){const s=this._eventHandlers[t];if(e in s){const i=s[e];for(let s=i.length;s--;){const r=i[s];t.removeEventListener(e,r[0],r[1])}}}}$_removeListenerAll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=t?[t]:this._eventNodes;for(let t=0,s=e.length;t<s;t++){const s=e[t];if(s in this._eventHandlers){const t=this._eventHandlers[s];for(let e in t){const i=t[e];for(let t=i.length;t--;){const r=i[t];s.removeEventListener(e,r[0],r[1])}}}}}_unloadHandler(){this.$_removeListenerAll(),this._containerDiv=null}_resizeHandler(t){this._doResized(t),this.invalidateLayout()}_doResized(t){}_isEnabled(){return!0}_keyDownHandler(t){this._isEnabled()&&this._activeTool.keyDown(t)}_keyUpHandler(t){this._isEnabled()&&this._activeTool.keyUp(t)}_keyPressHandler(t){this._isEnabled()&&this._activeTool.keyPress(t)}eventToContainer(t){const e=this._containerDiv.getBoundingClientRect();return new h(t.pageX-e.left,t.pageY-e.top)}toOffset(t){const e=this._containerDiv.getBoundingClientRect();return t.pointerX=t.clientX-e.left,t.pointerY=t.clientY-e.top,t}_clickHandler(t){this._isEnabled()?this._activeTool.click(this.toOffset(t)):t.preventDefault()}_dblclickHandler(t){this._isEnabled()?this._activeTool.dblclick(this.toOffset(t)):t.preventDefault()}$_getHtmlElement(t){return t instanceof X(this._containerDiv).HTMLElement?t:t instanceof Node?t.parentElement:void 0}_pointerDownHandler(t){this._isEnabled()?(this.toOffset(t),this.activeTool._pointerEventTarget=this.$_getHtmlElement(t.target),this.activeTool.pointerDown(t)&&t.preventDefault()):t.preventDefault()}_pointerMoveHandler(t){const e=X(this._containerDiv);if(this.toOffset(t),this._isEnabled()){const s=this._activeTool;s._pointerEventTarget=t.target instanceof e.HTMLElement?t.target:null,s.pointerMove(t)}}_pointerUpHandler(t){const e=X(this._containerDiv);try{this.toOffset(t),this._isEnabled()?(this._activeTool._pointerEventTarget=t.target instanceof e.HTMLElement?t.target:null,this._activeTool.pointerUp(t)):t.preventDefault()}finally{this._activeTool&&(this._activeTool.dragTracker=null)}}_pointerEnterHandler(t){this._isEnabled()&&this._activeTool.pointerEnter(this.toOffset(t))}_pointerLeaveHandler(t){this._isEnabled()&&this._activeTool.pointerLeave(this.toOffset(t))}_pointerOverHandler(t){this._isEnabled()&&this._activeTool.pointerOver(this.toOffset(t))}_contextMenuHander(t){const e=X(this._containerDiv);this.toOffset(t),this._isEnabled()&&(this._activeTool._pointerEventTarget=t.target instanceof e.HTMLElement?t.target:null,this._activeTool.contextMenu(this.toOffset(t)))}_wheelHandler(t){this._isEnabled()&&this._activeTool.mouseWheel(this.toOffset(t))&&J.stopEvent(t)}_focusHandler(t){}_blurHandler(t){}_selectstartHandler(t){return!1}_focusinHandler(t){}_globalPointerDownHandler(t){J.isAncestorOf(this._containerDiv,t.target)||this._isEnabled()&&this._activeTool.pointerOutside()}_focusoutHandler(t){J.isAncestorOf(this._containerDiv,t.target)&&t.relatedTarget&&!J.isAncestorOf(this._containerDiv,t.relatedTarget)&&this._isEnabled()&&this._activeTool.focusLeave(t)}_focusHandlerFireFox(t){J.isAncestorOf(this._containerDiv,t.target)&&this._isEnabled()&&(this._containerDiv.setAttribute("tabindex","0"),this._activeTool.setFocus(t.target))}}class wt extends q{constructor(t,e,s){super(t,e),this._contaner=s}get container(){return this._contaner}_getCssSelector(){return"root-element"}_initDom(t,e){super._initDom(t,e),e.style.width="100%",e.style.height="100%"}_setSizeStyle(t){}_doDraw(t){}}class yt extends l{constructor(t){super(),this._disabled=!1,this._updateRequested=!1,this._layoutNeeded=!1,this._invalidated=!1,this._scrolling=!1,this._captured=!1,this._focusing=!1,this._focusingTarget=null,this._hovered=null,this._currentX=0,this._currentY=0,this._rendered=0,this._defaultCursor="default",this._drawing=!1,this._offsetX=0,this._offsetY=0,this._eventHandlers={},this._eventNodes=[],this._contextMenu=null,this._containerRender=this._render.bind(this),this._scrollTool=new ct(this),this._cursor="default",this._testWidth=NaN,this._testHeight=NaN,this._saveDisplay="",this.$_testing=!1,this.$_prepareContainer(t),this.invalidateLayout(),this._registerEventHandlers(this._containerDom),this.activeTool=this._defaultTool=this._createDefaultTool(),yt.$_Containers[this.$_hash]=this}getMouseContainer(){return yt.$_Containers[yt.$_mouseContainer]}static getActiveGrid(){const t=yt.$_Containers[yt.$_ActiveGrid];return t&&t._gridView}static setActiveGrid(t){if(t!==yt.$_ActiveGrid){let e,s=yt.$_Containers[t];if(s=s&&s._gridView,window.RealGrid&&(e=window.RealGrid.onActiveGridChanged)){let t=yt.$_Containers[yt.$_ActiveGrid];t=t&&t._gridView,e(t&&t.handler,s&&s.handler)}s._fireGridActivated()}yt.$_ActiveGrid=t}static clearContainer(t){yt[t]&&delete yt[t],yt.$_ActiveGrid===t&&(yt.$_ActiveGrid=null)}static disposeStatic(){this.$_Containers=null,this.$_ActiveGrid=null}_doDispose(){this._activeTool=null,this._defaultTool&&(this._defaultTool=this._defaultTool.dispose()),this._scrollTool&&(this._scrollTool=this._scrollTool.dispose()),this.$_removeListenerAll(null),J.detach(this._containerDom),this._containerDom=null,this._doc=null,J.clearElements(this._containerDiv),super._doDispose(),delete yt.$_Containers[this.$_hash]}get doc(){return this._doc}get dom(){return this._containerDom}get visible(){return"none"!==getComputedStyle(this._containerDiv).display}set visible(t){t!=this.visible&&(t?this._containerDiv.style.display=this._saveDisplay:(this._saveDisplay=getComputedStyle(this._containerDiv).display,this._containerDiv.style.display="none"))}get disabled(){return this._disabled}set disabled(t){t!=this._disabled&&(this._disabled=t,this._doDisabledChanged())}get printing(){return!1}get activeTool(){return this._activeTool}set activeTool(t){if((t=t||this._defaultTool)!=this._activeTool){const e=this._activeTool;e&&e.deactivate(),this._activeTool=t,t&&t.activate(e)}}get defaultTool(){return this._defaultTool}get measurer(){return this._measurer}get width(){return this._containerDom.clientWidth}get height(){return this._containerDom.clientHeight}get scrollHeight(){return this._containerDiv.scrollHeight}get scrollTop(){return this._containerDiv.scrollTop}get scrolling(){return this._scrolling}findElementAt(t,e,s,i){return this._rootElement.findChildAt(t-this._rootElement._x,e-this._rootElement._y,s,i)}findElementOf(t){return this._rootElement.findChildOf(t)}getTableCell(t){return null}setCursor(t){t!=this._cursor&&(this._containerDom.style.cursor=this._cursor=t)}setFocus(){this._containerDom.focus()}updateNow(){this._layoutNeeded=!0,this.invalidate(!0),this._render(J.getTimer())}toScreen(t){return t.x+=this._offsetX,t.y+=this._offsetY,t}pointToScreen(t,e){return{x:t+this._offsetX,y:e+this._offsetY}}getBound(){const t=this._containerDom.getBoundingClientRect();return new d(t.left,t.top,t.width,t.height)}getHtml(){return this._containerDom.outerHTML}addElement(t){return this._rootElement.addChild(t)}removeElement(t){return this._rootElement.removeChild(t)}addFeedback(t){if(t instanceof _t)return this._feedbackElement.addChild(t);this._feedbackElement.dom.appendChild(t)}addFeedbacks(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];for(let t of e)this._feedbackElement.addChild(t)}removeFeedback(t){if(t instanceof _t)return this._feedbackElement.removeChild(t);this._feedbackElement.dom.removeChild(t)}removeFeedbacks(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];for(let t of e)this._feedbackElement.removeChild(t)}resetSize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.updateNow(),t&&setTimeout(t,0)}measureText(t,e){return this._textMeasurer.className=t,this._textMeasurer.innerHTML=e,this._textMeasurer.offsetWidth}$_refreshCheckMeasurer(){if(!this._checkRect){const t=this._checkMeasurer.getBoundingClientRect(),e=getComputedStyle(this._checkMeasurer);this._checkRect={width:t.width+parseInt(e.marginLeft)+parseInt(e.marginRight),height:t.height+parseInt(e.marginTop)+parseInt(e.marginBottom)}}return this._checkRect}measureCheckWidth(){return this.$_refreshCheckMeasurer().width}measureCheckHeight(){return this.$_refreshCheckMeasurer().height}contains(t){if(t instanceof Element)return this._containerDom.contains(t)}getDomPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.$_testing?{x:0,y:0,width:1,height:1}:(t instanceof q&&(t=t._dom),this.$_offsetDomPosition(t,{x:0,y:0},e))}$_offsetDomPosition(t,e,s){s&&(t=J.cloneDom(t));const i=Y(this._doc),r=this._containerDom,n=r.getBoundingClientRect(),o=t.getBoundingClientRect(),a=i.getComputedStyle(r);return e.x=o.left-n.left-Math.round(parseFloat(a.borderLeftWidth)),e.y=o.top-n.top-Math.round(parseFloat(a.borderTopWidth)),e.width=o.width,e.height=o.height,s&&t.remove(),e}getBoundingRect(t){const e=J.getBoundingRect(this._containerDom,t._dom);return e.x-=2,e.y-=2,e}$_setTesting(){this.$_testing=!0,q.Testing=!0}get _isTesting(){return this.$_testing}_doDisabledChanged(){}$_prepareContainer(t){if(!t)throw new Error("container is null!");if(o(t,"HTMLDivElement")?this._containerDiv=t:this._containerDiv=document.getElementById(t),!o(this._containerDiv,"HTMLDivElement"))throw new Error("Invalid visual container element: "+t);const e=this._doc=this._containerDiv.ownerDocument,s=Y(e);s.requestAnimationFrame=s.requestAnimationFrame||s.mozRequestAnimationFrame||s.webkitRequestAnimationFrame||s.msRequestAnimationFrame||function(t){return s.setTimeout(t,10)};const i=this._containerDom=e.createElement("div");let r=i.style;this._cursor=r.cursor,this._containerDiv.appendChild(i),i.className="rr-visual-container",i.setAttribute("tabindex","0"),r.position="relative",r.width="100%",r.height="100%",r.boxSizing="border-box",r.overflow="hidden",r["-webkit-touch-callout"]="none",r["-webkit-user-select"]="none",r["user-select"]="none",r["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",this._rootElement=this._createRootElement(e),i.appendChild(this._rootElement._dom),this._feedbackElement=new _t(e,"rr-feedback-container"),i.appendChild(this._feedbackElement._dom),this._feedbackElement.dom.style.zIndex=yt.FEEDBACK_ZINDEX,this._printRoot=new tt(e,"printRoot"),this._measurer=e.createElement("div"),this._containerDom.appendChild(this._measurer),this._doPrepareContainer(i)}_doPrepareContainer(t){}_createRootElement(t){return new wt(t,"root",this)}_createDefaultTool(){return null}isLayoutNeeded(){return this._layoutNeeded}invalidateLayout(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._scrolling=this._scrolling||t,this._layoutNeeded||(this._layoutNeeded=!0,this.invalidate(!0))}invalidate(t){if((!this._updateRequested||!this._invalidated)&&(t||!this._drawing)){if(!this._requestTimer&&!this.$_testing){const t=Y(this._doc);this._requestTimer=t.requestAnimationFrame(this._containerRender)}this._updateRequested=!0,this._invalidated=!0}}invalidateElement(t){const e=Y(this._doc);this._drawing||this._updateRequested||(this._requestTimer||this.$_testing||(this._requestTimer=e.requestAnimationFrame(this._containerRender)),this._updateRequested=!0)}invalidateElements(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._rootElement.invalidate(t,!0)}refresh(){this.invalidateLayout(),this.invalidateElements()}_render(t){if(!this.disposing){this._updateRequested=!1,this._offsetX=this._containerDom.offsetLeft,this._offsetY=this._containerDom.offsetTop,this._drawing=!0;try{this.$$_render(t)}finally{this._scrolling=!1,this._drawing=!1,this._invalidated=!1,this._requestTimer=null,this._doAfterRender()}}}$$_render(t){const e=this._containerDom,s=isNaN(this._testWidth)?e.clientWidth:this._testWidth,i=isNaN(this._testHeight)?e.clientHeight:this._testHeight;this._layoutChildren(new d(0,0,s,i)),this._layoutNeeded?(this._doLayout(new d(0,0,s,i)),this._layoutNeeded=!1):this._doPrepareRender(new d(0,0,s,i)),this._doRenderHtml(new d(0,0,s,i))}_layoutChildren(t){}_doLayout(t){}_doAfterRender(){}_doPrepareRender(t){}_doRenderHtml(t){this._doDrawContainer(t),this._drawElement(this._rootElement),this._validateChildren(this._rootElement)}_doDrawContainer(t){}_drawElement(t){t.draw();for(let e=0,s=t.childCount;e<s;e++){const s=t.getChild(e);s.visible&&this._drawElement(s)}}_validateChildren(t){for(let e=0,s=t.childCount;e<s;e++){t.getChild(e).validate()}}_registerEventHandlers(t){const e=X(t);t.style.cursor=this._defaultCursor,this.$_addListener(e,"resize",this._resizeHandler.bind(this),!1),this.$_addListener(e,"mousemove",this._mouseMoveHandler.bind(this),!1),this.$_addListener(e,"mouseup",this._mouseUpHandler.bind(this),!1),this.$_addListener(e,"focus",this._focusHandlerFireFox.bind(this),!0),this.$_addListener(e,"focusin",this._focusinHandler.bind(this),!0),this.$_addListener(e,"focusout",this._focusoutHandler.bind(this),!0),this.$_addListener(e,"mousedown",this._globalMouseDownHandler.bind(this),!1),this.$_addListener(t,"keydown",this._keyDownHandler.bind(this),!1),this.$_addListener(t,"keyup",this._keyUpHandler.bind(this),!1),this.$_addListener(t,"keypress",this._keyPressHandler.bind(this),!1),this.$_addListener(t,"click",this._clickHandler.bind(this),!1),this.$_addListener(t,"dblclick",this._dblclickHandler.bind(this),!1),this.$_addListener(t,"mousedown",this._mouseDownHandler.bind(this),!1),this.$_addListener(t,"mouseenter",this._mouseEnterHandler.bind(this),!1),this.$_addListener(t,"mouseleave",this._mouseLeaveHandler.bind(this),!1),this.$_addListener(t,"mouseover",this._mouseOverHandler.bind(this),!1),this.$_addListener(t,"focus",this._focusHandler.bind(this),!1),this.$_addListener(t,"contextmenu",this._contextMenuHander.bind(this),!1),this.$_addListener(t,"blur",this._blurHandler.bind(this),!1),this.$_addListener(t,"selectstart",this._selectstartHandler.bind(this),!1),this.$_addListener(t,"wheel",this._wheelHandler.bind(this),!1),this.$_addListener(t,"dragstart",this._dragStartHandler.bind(this),!1),this.$_addListener(t,"dragend",this._dragEndHandler.bind(this),!1),this.$_addListener(t,"dragover",this._dragOverHandler.bind(this),!1),this.$_addListener(t,"dragenter",this._dragEnterHandler.bind(this),!1),this.$_addListener(t,"dragleave",this._dragLeaveHandler.bind(this),!1),this.$_addListener(t,"drop",this._dragDropHandler.bind(this),!1)}$_addListener(t,e,s,i){t in this._eventHandlers||(this._eventHandlers[t]={}),e in this._eventHandlers[t]||(this._eventHandlers[t][e]=[]),this._eventHandlers[t][e].push([s,i]),t.addEventListener(e,s,i),this._eventNodes.indexOf(t)<0&&this._eventNodes.push(t)}$_removeListener(t,e){if(t in this._eventHandlers){const s=this._eventHandlers[t];if(e in s){const i=s[e];for(let s=i.length;s--;){const r=i[s];t.removeEventListener(e,r[0],r[1])}}}}$_removeListenerAll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=t?[t]:this._eventNodes;for(let t=0,s=e.length;t<s;t++){const s=e[t];if(s in this._eventHandlers){const t=this._eventHandlers[s];for(let e in t){const i=t[e];for(let t=i.length;t--;){const r=i[t];s.removeEventListener(e,r[0],r[1])}}}}}_unloadHandler(){this.$_removeListenerAll(),this._containerDiv=null,this._containerDom=null}_resizeHandler(t){this._doResized(t),this.invalidateLayout()}_doResized(t){}_isEnabled(){return this._activeTool&&!this._disabled}_keyDownHandler(t){this._isEnabled()&&this._activeTool.keyDown(t)&&(t.preventDefault(),t.stopImmediatePropagation())}_keyUpHandler(t){this._isEnabled()&&this._activeTool.keyUp(t)}_keyPressHandler(t){this._isEnabled()&&this._activeTool.keyPress(t)}eventToContainer(t){const e=this._containerDom.getBoundingClientRect();return new h(t.pageX-e.left,t.pageY-e.top)}toOffset(t){if(!this.$_testing){const e=this._containerDom.getBoundingClientRect();t.mouseX=t.clientX-e.left,t.mouseY=t.clientY-e.top}return t}toOffsetTouch(t){const e=this._containerDom.getBoundingClientRect(),s=t.touches[0]||t.changedTouches[0];return t.mouseX=s.clientX-e.left,t.mouseY=s.clientY-e.top,t}_clickHandler(t){this._isEnabled()?this._activeTool.click(this.toOffset(t)):t.preventDefault()}_dblclickHandler(t){this._isEnabled()?this._activeTool.dblclick(this.toOffset(t)):t.preventDefault()}$_getHtmlElement(t){return t instanceof X(this._containerDom).HTMLElement?t:t instanceof Node?t.parentElement:void 0}_isAutoFocus(){return!0}_mouseDownHandler(t){var e;if(this._isEnabled()){yt.$_mouseContainer=this.$_hash,this._isAutoFocus()&&this.setFocus(),this.toOffset(t),this._currentX=t.mouseX,this._currentY=t.mouseY;const s=this.findElementAt(this._currentX,this._currentY,!1,!1);s&&s.getAncestor(At)?(null===(e=this.activeTool)||void 0===e||e.setFocus(),this._scrollTool._previous=this.activeTool,this.activeTool=this._scrollTool):this.activeTool||(this._defaultTool._previous=this.activeTool,this.activeTool=this._defaultTool),this.activeTool._mouseEventTarget=this.$_getHtmlElement(t.target),this.activeTool.mouseDown(t)}else t.preventDefault()}_mouseMoveHandler(t){const e=X(this._containerDom);if(this.toOffset(t),this._currentX=t.mouseX,this._currentY=t.mouseY,this._isEnabled()){const s=this._activeTool;s._mouseEventTarget=t.target instanceof e.HTMLElement?t.target:null,s.mouseMove(t);const i=s.dragTracker;if(i&&yt.$_mouseContainer==this.$_hash)for(let e in yt.$_Containers){const s=yt.$_Containers[e];if(s!==this){const e=s._activeTool;e&&e.dragFrom(t,i)}}}}_mouseUpHandler(t){const e=yt.$_mouseContainer==this.$_hash,s=X(this._containerDom);try{if(this.toOffset(t),this._currentX=t.mouseX,this._currentY=t.mouseY,this._isEnabled()){const i=this._activeTool.dragTracker;if(this._activeTool._mouseEventTarget=t.target instanceof s.HTMLElement?t.target:null,this._activeTool.mouseUp(t),this._activeTool instanceof ct&&(this.activeTool=this._activeTool.previous),i&&i.linkable&&e)for(let e in yt.$_Containers){const s=yt.$_Containers[e];if(s!==this){const e=s._activeTool;e&&e.dropFrom(t,i)}}}else t.preventDefault()}finally{this._activeTool&&(this._activeTool.dragTracker=null),e&&(yt.$_mouseContainer=-1)}}_mouseEnterHandler(t){this._isEnabled()&&this._activeTool.mouseEnter(this.toOffset(t))}_mouseLeaveHandler(t){this._isEnabled()&&this._activeTool.mouseLeave(this.toOffset(t))}_mouseOverHandler(t){this._isEnabled()&&this._activeTool.mouseOver(this.toOffset(t))}_dragStartHandler(t){this._isEnabled()?this._activeTool.dragStart(t):t.preventDefault()}_dragEndHandler(t){this._isEnabled()?this._activeTool.dragEnd(t):t.preventDefault()}_dragOverHandler(t){this._isEnabled()?(this.activeTool._mouseEventTarget=this.$_getHtmlElement(t.target),this._activeTool.dragOver(t)):t.preventDefault()}_dragEnterHandler(t){this._isEnabled()?(this.activeTool._mouseEventTarget=this.$_getHtmlElement(t.target),this._activeTool.dragEnter(t)):t.preventDefault()}_dragLeaveHandler(t){this._isEnabled()?(this.activeTool._mouseEventTarget=this.$_getHtmlElement(t.target),this._activeTool.dragLeave(t)):t.preventDefault()}_dragDropHandler(t){this._isEnabled()?(this.activeTool._mouseEventTarget=this.$_getHtmlElement(t.target),this._activeTool.dragDrop(t)):t.preventDefault()}_contextMenuHander(t){const e=X(this._containerDom);this.toOffset(t),this._currentX=t.mouseX,this._currentY=t.mouseY,this._isEnabled()&&(this._activeTool._mouseEventTarget=t.target instanceof e.HTMLElement?t.target:null,this._activeTool.contextMenu(this.toOffset(t)))}_wheelHandler(t){this._isEnabled()&&this._activeTool.mouseWheel(this.toOffset(t))&&J.stopEvent(t)}_focusHandler(t){}_blurHandler(t){}_selectstartHandler(t){return!1}_focusinHandler(t){}_globalMouseDownHandler(t){J.isAncestorOf(this._containerDiv,t.target)||this._isEnabled()&&this._activeTool.focusLeave(t)}_focusoutHandler(t){J.isAncestorOf(this._containerDiv,t.target)&&t.relatedTarget&&!J.isAncestorOf(this._containerDiv,t.relatedTarget)&&this._isEnabled()&&this._activeTool.focusLeave(t)}_focusHandlerFireFox(t){J.isAncestorOf(this._containerDiv,t.target)&&this._isEnabled()&&(this._containerDom.setAttribute("tabindex","0"),this._activeTool.setFocus(t.target))}}yt.FEEDBACK_ZINDEX=1e3,yt.$_Containers={},yt.$_mouseContainer=-1,yt.$_ActiveGrid=null;const Ct=["yy","yyyy","M","MM","d","dd","a","H","HH","h","hh","m","mm","s","ss","S","SS","SSS"],bt=[".","/","-",":"],vt="Z".charCodeAt(0),Bt="z".charCodeAt(0),Et="A".charCodeAt(0),Pt="a".charCodeAt(0),xt="y".charCodeAt(0),St="M".charCodeAt(0),It="m".charCodeAt(0),Rt="d".charCodeAt(0),Tt="H".charCodeAt(0),Ot="h".charCodeAt(0),Ft="S".charCodeAt(0),Dt="s".charCodeAt(0),Lt=function(t){return t<10?"0"+t:String(t)},Nt=function(t){return t<10?"00"+t:t<100?"0":String(t)};class Ht{constructor(t){this._baseYear=2e3,this._preserveTime=!1,this._hasAmPm=!1,this._formatString="",this.formatString=t}static getFormatter(t){let e=Ht.Formatters[t];return e||(Ht.Formatters[t]=e=new Ht(t)),e}static get Default(){return Ht.getFormatter(Ht.DEFAULT_FORMAT)}get format(){return this._format}get formatString(){return this._formatString}set formatString(t){(t=t||Ht.DEFAULT_FORMAT)!=this._formatString&&(this._tokens=[],this.parse(t),this._formatString=t)}getText(t){if(!this._tokens)return"";const e=t instanceof Date?t:new Date(t),s=this._tokens;let i="";for(var r=0,n=s.length;r<n;r++){var o=s[r],a=o.length;switch(o.charCodeAt(0)){case xt:i+=a>2?e.getFullYear():Lt(e.getFullYear()%100);break;case St:i+=a>1?Lt(e.getMonth()+1):e.getMonth()+1;break;case Rt:i+=a>1?Lt(e.getDate()):e.getDate();break;case Tt:i+=a>1?Lt(e.getHours()):e.getHours();break;case Ot:if(this._hasAmPm){let t=e.getHours();0==t?t=12:t>12&&(t-=12),i+=a>1?Lt(t):t}else i+=a>1?Lt(e.getHours()):e.getHours();break;case It:i+=a>1?Lt(e.getMinutes()):e.getMinutes();break;case Dt:i+=a>1?Lt(e.getSeconds()):e.getSeconds();break;case Pt:case Et:e.getHours()<12?i+=this._amText:i+=this._pmText;break;case Ft:let t=e.getMilliseconds();i+=3==a?Nt(t):2==a?Lt(t):t.toString().substr(0,a);break;default:i+=o}}return i}parseDateFormatTokens(t){var e=[];if(t){const s=t.trim(),i=s.length;let r=0;for(;r<i;){let n=s.charAt(r);if(bt.indexOf(n)>=0)e.push(n),r++;else{let o=r++;for(;r<i&&s.charAt(r)==n;)r++;if(n=s.substring(o,r),Ct.indexOf(n)<0){let e=n.charCodeAt(0);if(e>=Et&&e<=vt||e>=Pt&&e<=Bt)throw new Error("Invalid datetime write format: "+t)}e.push(n)}if(r<i&&J.isWhiteSpace(n=s.charAt(r)))for(e.push(n);r<i&&J.isWhiteSpace(s.charAt(r));)r++}}return e}parse(t){if(this._amText="AM",this._pmText="PM",t){const e=t.split(";");if(this._format=e[0]||Ht.DEFAULT_FORMAT,this._tokens=this.parseDateFormatTokens(this._format),this._hasAmPm=this._tokens.indexOf("a")>=0||this._tokens.indexOf("A")>=0,e.length>1&&e[1]){const t=e[1].split(",");t.length>0&&t[0]&&(this._amText=t[0]),t.length>1&&t[1]&&(this._pmText=t[1])}}}}Ht.DEFAULT_FORMAT="yyyy/MM/dd",Ht.Formatters={};class Qt{constructor(t){this._format=null,this._baseYear=2e3,this._patterns=[],this._amText="AM",this._pmText="PM",t&&(this.format=t)}get format(){return this._format}set format(t){if(t!=this._format){if(!t)throw new Error("Invalid empty date format");this._format=t,this.parseFormat(t)}}get baseYear(){return this._baseYear}set baseYear(t){t!=this._baseYear&&(this._baseYear=t)}get amText(){return this._amText}set amText(t){t!=this._amText&&(this._amText=t)}get pmText(){return this._pmText}set pmText(t){t!=this._pmText&&(this._pmText=t)}parse(t){try{let r=0,n=1,o=1,a=0,A=0,l=0,h=0,d=0,c=0,u=this._patterns.length,p=0;const _=t.length;for(let g=0;g<u&&p<_;g++){var e=this._patterns[g],s=e.c,i=e.len;switch(s){case"y":r=parseInt(t.substr(p,i));break;case"M":n=parseInt(t.substr(p,i));break;case"d":o=parseInt(t.substr(p,i));break;case"a":if(this._amText&&t.indexOf(this._amText,p)==p)d=12,i=this._amText.length;else{if(!this._pmText||t.indexOf(this._pmText,p)!=p)return null;c=12,i=this._pmText.length}break;case"H":case"h":a=parseInt(t.substr(p,i));break;case"m":A=parseInt(t.substr(p,i));break;case"s":l=parseInt(t.substr(p,i));break;case"S":h=parseInt(t.substr(p,i));break;case".":case"/":case"-":case":":case" ":if(Qt.DATE_SEPARATORS.indexOf(t.charAt(p))<0)return null;break;default:return null}p+=i}return r<100&&(r+=this._baseYear),d>0?12==a&&(a=0):c>0&&a<12&&(a+=12),new Date(r,n-1,o,a,A,l,h)}catch(t){return null}}parseFormat(t){var e,s,i,r=t,n=r.length,o=0;for(this._patterns=[];o<n;)if(e=o,s=r.charAt(o),J.isWhiteSpace(s)){for(o++;o<n&&J.isWhiteSpace(r.charAt(o));)o++;this._patterns.push({c:" ",p:e,len:o-e})}else{switch(i=0,s){case"y":4!=(i=this.getPattern(r,o,s))&&2!=i&&this.throwInvalidFormat(r);break;case"M":case"d":case"H":case"h":case"m":case"s":2!=(i=this.getPattern(r,o,s))&&this.throwInvalidFormat(r);break;case"S":3!=(i=this.getPattern(r,o,s))&&this.throwInvalidFormat(r);break;case"a":case".":case"/":case"-":case":":1!=(i=this.getPattern(r,o,s))&&this.throwInvalidFormat(r);break;default:this.throwInvalidFormat(r)}i>0&&(this._patterns.push({c:s,p:o,len:i}),o+=i)}}throwInvalidFormat(t){throw new Error("Invalid date format: "+t)}throwInvalidValue(t){throw new Error("Invalid date format: "+t)}getPattern(t,e,s){for(var i=1;++e<t.length&&t.charAt(e)==s;)i++;return i}}Qt.DATE_SEPARATORS="./-: ";class Ut{constructor(){}static parse(t,e){var s=null;try{var i,r,n,o,a=t.indexOf("T"),A=t.substring(0,a),l=t.substring(a+1),h=A.split("-"),d=h.length,c=parseInt(h[0]),u=d>1?parseInt(h[1]):1,p=d>2?parseInt(h[2]):1;-1!=l.indexOf("Z")?(i=1,r=0,n=0,l=l.replace("Z","")):-1!=l.indexOf("+")?(i=1,o=l.substring(l.indexOf("+")+1,l.length),r=Number(o.substring(0,o.indexOf(":"))),n=Number(o.substring(o.indexOf(":")+1,o.length)),l=l.substring(0,l.indexOf("+"))):-1!=l.indexOf("-")?(i=-1,o=l.substring(l.indexOf("-")+1,l.length),r=Number(o.substring(0,o.indexOf(":"))),n=Number(o.substring(o.indexOf(":")+1,o.length)),l=l.substring(0,l.indexOf("-"))):i=0;var _=l.split(":"),g=(d=_?_.length:0)>0?parseInt(_[0]):0,f=d>1?parseInt(_[1]):0,m=d>2?String(_[2]).split("."):null,w=m&&m.length>0?parseInt(m[0]):0,y=m&&m.length>1?1e3*parseFloat("0."+m[1]):0,C=Date.UTC(c,u-1,p,g,f,w,y),b=i?(36e5*r+6e4*n)*i:Ut._zoneOffset;if(s=new Date(C-b),e&&isNaN(s.getTime()))throw"Invalidate date text: "+t}catch(s){if(e){var v="Invalid date Text: "+t;throw v+="\nError: "+s.toString(),v}}return s}}Ut._zoneOffset=60*(new Date).getTimezoneOffset()*1e3;class Mt{constructor(t){this._format="",this._type=0,this._parser=new Qt(null),this.format=t}static initialize(){Mt.Default.amText="AM",Mt.Default.pmText="PM",Mt.Default.baseYear=2e3}get format(){return this._format}set format(t){t!=this._format&&(this._format=t,this.parse(t))}get amText(){return this._parser.amText}set amText(t){this._parser.amText=t}get pmText(){return this._parser.pmText}set pmText(t){this._parser.pmText=t}get baseYear(){return this._parser.baseYear}set baseYear(t){this._parser.baseYear=t}toDate(t){if(!t)return null;var e=null;switch(this._type){case 0:e=this._parser.parse(t);break;case 1:e=Ut.parse(t,!1);break;case 2:const s=parseInt(t);e=new Date(s);break;default:e=new Date(t)}return e&&!isNaN(e.getTime())?e:null}parse(t){if(t){const e=t.toLowerCase();this._type=Math.max(0,Mt.Formats.indexOf(e)),0==this._type&&(this._parser.format=t)}}}Mt.Formats=["custom","iso","timestamp","platform"],Mt.Default=new Mt("yyyy/MM/dd HH:mm:ss"),Mt.initialize();class kt extends Error{constructor(t,e){super(t),this.message=t,this.tokenPos=e}}class Vt extends Error{constructor(t){super(t),this.message=t}}const Gt=function(t,e,s){return e=Math.max(e||2,1),s=s||"0",new Array(e-String(t).length+1).join(s)+t},Kt=function(){for(var t=[],e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];for(var r of s)t[r]=!0;return t},Wt=Kt(26,27),zt=Kt(40,45,46,47,48,49,50,51,52,53,41,42,43,44),$t=Kt(4,5,18,19),Xt=Kt(11,3,2,14,15,16,17);class jt{constructor(){this.IS_IDENT=[],this.IS_INTEGER=[],this.IS_NUMBER=[],this.IS_WHITE=[],this.IS_END=[],this.QUOTATION='"'.charCodeAt(0),this.SQUOTATION="'".charCodeAt(0),this.BACKSLASH="\\".charCodeAt(0),this.BACKTICK="`".charCodeAt(0),this.Keywords={str:20,num:21,bool:23,not:13,len:24,and:11,in:12,mod:15,or:18,div:14,shl:16,shr:17,xor:19,is:26,like:46,ilike:48,match:50,imatch:52,defined:35,null:34,empty:36,nan:37,datestr:90,year:91,month:92,day:93,hour:94,rounddown:95},this._procs=null,this._source=null,this._len=0,this._tokenId=0,this._run=0,this._runAhead=0,this._nextRun=0,this._lineNo=0,this._linePos=0,this._tokenPos=0;for(var t=0;t<256;t++)this.IS_IDENT[t]=t==="_".charCodeAt(0)||t===":".charCodeAt(0)||t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="a".charCodeAt(0)&&t<="z".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0),this.IS_INTEGER[t]=t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t>="a".charCodeAt(0)&&t<="f".charCodeAt(0)||t>="A".charCodeAt(0)&&t<="F".charCodeAt(0),this.IS_NUMBER[t]=t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)||t==".".charCodeAt(0)||t==="e".charCodeAt(0)||t==="E".charCodeAt(0),this.IS_WHITE[t]=t>=1&&t<=9||11==t||t>=14&&t<=32,this.IS_END[t]=0==t;this.initProcs()}clear(){this._source=null}next(){var t=this._source.charCodeAt(this._run);this._tokenPos=this._run,t<256?this._procs[t].call(this):this.identProc()}unkownProc(){this._tokenId=0,this._run++}commaProc(){this._tokenId=32,this._run++}crProc(){this._tokenId=33,10==this._source.charCodeAt(this._run+1)?this._run+=2:this._run++,this._lineNo++,this._linePos=this._run}lfProc(){this._tokenId=33,this._run++,this._lineNo++,this._linePos=this._run}equalProc(){this._tokenId=40,this._run++}greaterProc(){"="==this._source.charAt(this._run+1)?(this._tokenId=42,this._run+=2):(this._tokenId=41,this._run++)}lowerProc(){"="==this._source.charAt(this._run+1)?(this._tokenId=44,this._run+=2):">"==this._source.charAt(this._run+1)?(this._tokenId=45,this._run+=2):(this._tokenId=43,this._run++)}nextIdent(){for(var t=this._run;t<this._len&&!this.IS_IDENT[this._source.charCodeAt(t)];)t++;for(var e=t;t<this._len&&this.IS_IDENT[this._source.charCodeAt(t)];)t++;return t>e?(this._nextRun=t,this._source.substr(e,t-e).toLowerCase()):null}identProc(){for(var t=this._run;this._run<this._len&&(this.IS_IDENT[this._source.charCodeAt(this._run)]||this._source.charCodeAt(this._run)>255);)this._run++;var e=this._source.substr(t,this._run-t).toLowerCase();if(this.Keywords.hasOwnProperty(e))switch(this._tokenId=this.Keywords[e],this._tokenId){case 13:if(e=this.nextIdent())switch(e){case"like":this._tokenId=47,this._run=this._nextRun;break;case"ilike":this._tokenId=49,this._run=this._nextRun;break;case"match":this._tokenId=51,this._run=this._nextRun;break;case"imatch":this._tokenId=53,this._run=this._nextRun}break;case 26:"not"==(e=this.nextIdent())&&(this._tokenId=27,this._run=this._nextRun)}else this._tokenId=10}integerProc(){for(this._tokenId=64,this._run++;this._run<this._len&&this.IS_INTEGER[this._source.charCodeAt(this._run)];)this._run++}numberProc(){for(this._tokenId=64,this._run++;this._run<this._len&&this.IS_NUMBER[this._source.charCodeAt(this._run)];){if("."==this._source.charAt(this._run)){if("."==this._source.charAt(this._run+1))break;this._tokenId=63}this._run++}}minusProc(){this._tokenId=4,this._run++}plusProc(){this._tokenId=5,this._run++}pointProc(){"."==this._source.charAt(this._run+1)?(this._tokenId=68,this._run+=2):(this._tokenId=65,this._run++)}roundOpenProc(){this._tokenId=66,this._run++}roundCloseProc(){this._tokenId=67,this._run++}slashProc(){this._tokenId=2,this._run++}spaceProc(){for(this._tokenId=71,this._run++;this._run<this._len&&this.IS_WHITE[this._source.charCodeAt(this._run)];)this._run++}bracketOpenProc(){this._tokenId=69,this._run++}bracketCloseProc(){this._tokenId=70,this._run++}starProc(){this._tokenId=3,this._run++}modProc(){this._tokenId=15,this._run++}stringProc(){this._tokenId=61;do{var t=this._source.charCodeAt(this._run);if(this.IS_END[t])throw new kt("Untermintated string",t);t==this.BACKSLASH&&this._run++,this._run++}while(this._run<this._len&&this._source.charCodeAt(this._run)!=this.QUOTATION);this._run++}smallStringProc(){this._tokenId=61;do{var t=this._source.charCodeAt(this._run);if(this.IS_END[t])throw new kt("Untermintated string",t);t==this.BACKSLASH&&this._run++,this._run++}while(this._run<this._len&&this._source.charCodeAt(this._run)!=this.SQUOTATION);this._run++}backtickProc(){this._tokenId=96;do{var t=this._source.charCodeAt(this._run);if(this.IS_END[t])throw new kt("Untermintated backtick string",t);this._run++}while(this._run<this._len&&this._source.charCodeAt(this._run)!=this.BACKTICK);this._run++}initProcs(){this._procs=[];for(let t=1;t<=32;t++)this._procs[t]=this.spaceProc;this._procs[10]=this.lfProc,this._procs[13]=this.crProc,this._procs["$".charCodeAt(0)]=this.integerProc,this._procs[this.QUOTATION]=this.stringProc,this._procs[this.SQUOTATION]=this.smallStringProc,this._procs[this.BACKTICK]=this.backtickProc;for(let t=0;t<=9;t++)this._procs["0".charCodeAt(0)+t]=this.numberProc;for(let t="A".charCodeAt(0);t<="Z".charCodeAt(0);t++)this._procs[t]=this.identProc;for(let t="a".charCodeAt(0);t<="z".charCodeAt(0);t++)this._procs[t]=this.identProc;this._procs[":".charCodeAt(0)]=this.identProc,this._procs["_".charCodeAt(0)]=this.identProc,this._procs["(".charCodeAt(0)]=this.roundOpenProc,this._procs[")".charCodeAt(0)]=this.roundCloseProc,this._procs["*".charCodeAt(0)]=this.starProc,this._procs["+".charCodeAt(0)]=this.plusProc,this._procs[",".charCodeAt(0)]=this.commaProc,this._procs["-".charCodeAt(0)]=this.minusProc,this._procs[".".charCodeAt(0)]=this.pointProc,this._procs["/".charCodeAt(0)]=this.slashProc,this._procs["%".charCodeAt(0)]=this.modProc,this._procs["<".charCodeAt(0)]=this.lowerProc,this._procs["=".charCodeAt(0)]=this.equalProc,this._procs[">".charCodeAt(0)]=this.greaterProc,this._procs["[".charCodeAt(0)]=this.bracketOpenProc,this._procs["]".charCodeAt(0)]=this.bracketCloseProc}get tokenId(){return this._tokenId}get tokenLoc(){return{x:this._tokenPos-this._linePos,y:this._lineNo}}get tokenLen(){return this._run-this._tokenPos}get token(){return this._source.substr(this._tokenPos,this.tokenLen)}get isSpace(){return 71==this._tokenId}init(t){this._source=t,this._len=t.length,this._lineNo=0,this._linePos=0,this._tokenPos=0,this._runAhead=this._run=0,this._tokenId=0}charAhread(){for(this._runAhead=this._run;this._runAhead<this._len&&this._source.charCodeAt(this._runAhead)>0&&this._source.charCodeAt(this._runAhead)<=32;)this._runAhead++;return this._source.charCodeAt(this._runAhead)}nextId(t){do{this.next()}while(this._run<this._len&&this._tokenId!=t)}nextNoSpace(){if(this._run<this._len)do{this.next()}while(this._run<this._len&&this.isSpace)}isFirstInLine(){if(0==this._tokenPos)return!0;var t,e=this._tokenPos;for(e--;e>0&&this.IS_WHITE[this._source.charCodeAt(e)];)e--;return 0==e||(10==(t=this._source.charCodeAt(e))||13==t)}}class Yt extends A{constructor(){super()}isIdentifier(t){throw new Error("Token is not a valid Identifier: "+t)}evaluateIdentifier(t){throw new Error("Invalid identifier key: "+t)}evaluateIndexerI(t,e){throw new Error("Invalid identifier indexer: "+t)}evaluateIndexerS(t,e,s){throw new Error("Invalid identifier indexer: "+t)}evaluateFunc(t,e){throw new Error("Invalid identifier func: "+t)}}class Jt{constructor(){}get value(){}get asLiteral(){return null}prepareValue(){}getLiteral(){}isIdentifier(t){return!1}toString(){return String(this)}}class Zt extends Jt{}class qt extends Jt{constructor(){super()}evaluate(t){}toString(){return""}}qt.Default=new qt;class te extends Jt{constructor(){super(),this._operator=0}evaluate(t){if(this._literal)return this._literal.value;if(!this._rightExpr)return this._leftExpr.evaluate(t);var e=this._leftExpr.evaluate(t),s=this._rightExpr.evaluate(t);switch(this._operator){case 40:return e==s;case 45:return e!=s;case 41:return e>s;case 42:return e>=s;case 43:return e<s;case 44:return e<=s;case 46:return this.calcLike(e,s,!1);case 47:return!this.calcLike(e,s,!1);case 48:return this.calcLike(e,s,!0);case 49:return!this.calcLike(e,s,!0);case 50:return this.calcMatch(e,s,!1);case 51:return!this.calcMatch(e,s,!1);case 52:return this.calcMatch(e,s,!0);case 53:return!this.calcMatch(e,s,!0);default:throw new Vt("Unknown operator: "+this._operator)}}toString(){var t="";if(this._literal)t=this._literal.toString();else if(this._rightExpr){var e,s=this._leftExpr.toString(),i=this._rightExpr.toString();switch(this._operator){case 40:e="=";break;case 45:e="<>";break;case 41:e=">";break;case 42:e=">=";break;case 43:e="<";break;case 44:e="<=";break;case 46:e="like";break;case 47:e="not like";break;case 48:e="ilike";break;case 49:e="not ilike";break;case 50:e="match";break;case 51:e="not match";break;case 52:e="imatch";break;case 53:e="not imatch";break;case 32:e=",";break;default:e="<<ERROR>>"}t="("+s+" "+e+" "+i+")"}else t=this._leftExpr.toString();return t}isIdentifier(t){return this._leftExpr&&!this._rightExpr&&this._leftExpr.isIdentifier(t)}prepareValue(){this._leftExpr.prepareValue(),null==this._rightExpr?this._literal=this._leftExpr.getLiteral():this._rightExpr.prepareValue()}getLiteral(){return this._literal}calcLike(t,e,s){let i=String(t),r=String(e);if(i&&r){s&&(i=i.toLowerCase(),r=r.toLowerCase());let t=r.length;if(t>1){const e="%"==r.charAt(0),s="%"==r.charAt(t-1);return e&&s?(r=r.substr(1,t-2),i.indexOf(r,0)>=0):e?(r=r.substr(1,t-1),i.lastIndexOf(r)==i.length-r.length):s?(r=r.substr(0,t-1),0==i.indexOf(r,0)):i==r}return"%"!=r&&i==r}return!1}calcMatch(t,e,s){return new RegExp(e,"m"+(s?"i":"")).test(t)}}class ee extends Jt{get value(){}get asLiteral(){return this}evaluate(t){}}class se extends ee{toString(){return"defined"}}class ie extends ee{toString(){return"empty"}}class re extends ee{get value(){return NaN}toString(){return"null"}}class ne extends ee{toString(){return"NaN"}}class oe extends te{constructor(t,e,s){super(),this._leftExpr=t,this._operator=e,this._isNot=27==e,this._value=-1,s instanceof se?this._value=oe.DEFINED:s instanceof re?this._value=oe.NULL:s instanceof ie?this._value=oe.EMPTY:s instanceof ne&&(this._value=oe.NAN)}prepareValue(){this._leftExpr.prepareValue(),this._literal=this._leftExpr.getLiteral()}getLiteral(){return null}evaluate(t){var e,s=this._literal?this._literal.value:this._leftExpr.evaluate(t);switch(this._value){case oe.DEFINED:e=void 0!==s;break;case oe.NULL:e=null==s;break;case oe.EMPTY:e=null==s||0==String(s).length;break;case oe.NAN:e=null===s||isNaN(s);break;default:return}return this._isNot?!e:e}toString(){var t="<<ERROR>>";switch(this._value){case oe.DEFINED:t="defined";break;case oe.NULL:t="null";break;case oe.EMPTY:t="empty";break;case oe.NAN:t="NaN"}return"("+(this._isNot?"is not ":"is ")+t+")"}}oe.DEFINED=0,oe.NULL=1,oe.EMPTY=2,oe.NAN=3;class ae extends Zt{constructor(t){super(),this._value=Number(t)}get value(){return this._value}get asLiteral(){return this}evaluate(t){return this._value}toString(){return String(this._value)}}class Ae extends Zt{constructor(t){super(),this._value="string"==typeof t?parseInt(t):Math.floor(t)}get value(){return this._value}get asLiteral(){return this}evaluate(t){return this._value}toString(){return String(this._value)}}class le extends Zt{constructor(t){super(),this._value=t.substr(1,t.length-2);for(var e="",s=0,i=!1;s<this._value.length;)"\\"!=this._value[s]||i?(i=!1,e+=this._value[s++]):(i=!0,s++);this._value=e}get value(){return this._value}get asLiteral(){return this}evaluate(t){return this._value}toString(){return"'"+this._value+"'"}}class he extends Jt{constructor(t){super(),this._idKey=-651212,this._literal=t}get identifier(){return this._literal}evaluate(t){return-651212==this._idKey&&(this._idKey=t.isIdentifier(this._literal)),t.evaluateIdentifier(this._idKey)}toString(){return this._literal}}class de extends te{constructor(t,e,s){super(),this._idKey=-1490313,this._intIndex=NaN,this._strIndex=null,this._ident=t,this._indexer=e,this._capital=s}prepareValue(){let t=this._indexer.asLiteral;if(t||this._indexer instanceof te&&(this._indexer.prepareValue(),t=this._indexer.getLiteral()),t){const e=t.value;"string"==typeof e?this._strIndex=e:this._intIndex=parseInt(e),this._capital&&this._strIndex&&(this._strIndex=this._strIndex.toUpperCase())}}getLiteral(){return null}evaluate(t){if(-1490313==this._idKey&&(this._idKey=t.isIdentifier(this._ident)),this._strIndex)return t.evaluateIndexerS(this._idKey,this._strIndex,this._capital);if(isNaN(this._intIndex)){const e=this._indexer.evaluate(t);return"string"==typeof e?t.evaluateIndexerS(this._idKey,e,this._capital):t.evaluateIndexerI(this._idKey,e)}return t.evaluateIndexerI(this._idKey,this._intIndex)}toString(){return this._ident+"["+this._indexer.toString()+"]"}}class ce extends te{constructor(t,e){super(),this._idKey=-1490313,this._strIndex=null,this._ident=t,this._indexer=e}prepareValue(){let t=this._indexer.asLiteral;if(t||this._indexer instanceof te&&(this._indexer.prepareValue(),t=this._indexer.getLiteral()),t){const e=t.value;"string"==typeof e&&(this._strIndex=e)}}getLiteral(){return null}evaluate(t){if(-1490313==this._idKey&&(this._idKey=t.isIdentifier(this._ident)),this._strIndex)return t.evaluateFunc(this._idKey,this._strIndex);{const e=this._indexer.evaluate(t);return t.evaluateFunc(this._idKey,e)}}toString(){return this._ident+"("+this._indexer.toString()+")"}}class ue extends Jt{constructor(t){super(),this._factor=t}prepareValue(){this._literal=this._factor.asLiteral,!this._literal&&this._factor instanceof Jt&&(this._factor.prepareValue(),this._literal=this._factor.getLiteral())}getLiteral(){return null}}class pe extends ue{constructor(t){super(t)}evaluate(t){const e=this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t);return e?e.length:0}toString(){return"(len "+this._factor+")"}}class _e extends ue{constructor(t){super(t)}evaluate(t){return-(this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t))}toString(){return"-"+this._factor}}class ge extends ue{constructor(t){super(t)}evaluate(t){return this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t)}toString(){return"+"+this._factor}}class fe extends ue{constructor(t){super(t)}evaluate(t){return!(this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t))}toString(){return"(not "+this._factor+")"}}class me extends ue{constructor(t){super(t)}evaluate(t){var e=this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t);return Boolean(e)}toString(){return"(bool "+this._factor+")"}}class we extends ue{constructor(t){super(t)}evaluate(t){var e=this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t);return Number(e)}toString(){return"(num "+this._factor+")"}}class ye extends ue{constructor(t){super(t)}evaluate(t){var e=this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t);return String(e)}toString(){return"(str "+this._factor+")"}}class Ce extends ue{constructor(t){super(t)}evaluate(t){var e=this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t);return e instanceof Date&&(e=Gt(e.getFullYear(),4)+Gt(e.getMonth()+1,2)+Gt(e.getDate(),2)+Gt(e.getHours(),2)+Gt(e.getMinutes(),2)+Gt(e.getSeconds(),2)+Gt(e.getMilliseconds(),3)),String(e)}toString(){return"(datestr "+this._factor+")"}}class be extends ue{constructor(t){super(t)}evaluate(t){const e=this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t);return e instanceof Date?e.getFullYear():null}toString(){return"(year "+this._factor+")"}}class ve extends ue{constructor(t){super(t)}evaluate(t){const e=this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t);return e instanceof Date?e.getMonth()+1:null}toString(){return"(month "+this._factor+")"}}class Be extends ue{constructor(t){super(t)}evaluate(t){const e=this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t);return e instanceof Date?e.getDate():null}toString(){return"(day "+this._factor+")"}}class Ee extends ue{constructor(t){super(t)}evaluate(t){const e=this._literal instanceof Zt?this._literal.value:this._factor.evaluate(t);return e instanceof Date?e.getHours():null}toString(){return"(hour "+this._factor+")"}}class Pe extends ue{constructor(t){super(t)}evaluate(t){const e=this._factor,s=e.getLiteral();if(e.getLiteral())return s.value;if(e._rightExpr){const s=e._leftExpr.evaluate(t),r=e._rightExpr.evaluate(t);if(32===e._operator){var i=Math.pow(10,r);return Math.floor(s*i)/i}throw new Vt("Unknown operator: "+e._operator)}return e._leftExpr.evaluate(t)}toString(){return"(rounddown "+this._factor+")"}}class xe extends Jt{constructor(){super(),this._factors=[],this._operators=[],this._literal=null}addFactor(t){this._factors.push(t)}addOperator(t){this._operators.push(t)}isIdentifier(t){return 1==this._factors.length&&this._factors[0]instanceof he&&this._factors[0].identifier==t}prepareValue(){var t,e,s;for(t=0,e=this._factors.length;t<e;t++)this._factors[t].prepareValue();0==this._operators.length&&(s=this._factors[0],this._literal=s.asLiteral,this._literal||(this._literal=s.getLiteral()))}getLiteral(){return this._literal}evaluate(t){if(this._literal)return this._literal.value;const e=this._factors.length;let s=this._factors[0].evaluate(t);for(let i=1;i<e;i++){const e=this._factors[i].evaluate(t);switch(this._operators[i-1]){case 11:s=s&&e;break;case 3:s*=e;break;case 2:s/=e;break;case 14:s=Math.floor(Math.floor(s)/Math.floor(e));break;case 15:s%=e;break;case 16:s<<=e;break;case 17:s>>=e}}return s}toString(){var t="";if(this._literal)t=this._literal.toString();else if(1==this._factors.length)t=this._factors[0].toString();else{var e,s=this._factors.length;for(t="("+this._factors[0].toString(),e=1;e<s;e++){switch(this._operators[e-1]){case 11:t+=" and ";break;case 3:t+=" * ";break;case 2:case 14:t+=" / ";break;case 15:t+=" mod ";break;case 16:t+=" shl ";break;case 17:t+=" shr "}t+=this._factors[e].toString()}t+=")"}return t}}class Se extends Jt{constructor(){super(),this._terms=[],this._operators=[],this._literal=null}addTerm(t){this._terms.push(t)}addOperator(t){this._operators.push(t)}isIdentifier(t){return 1==this._terms.length&&this._terms[0].isIdentifier(t)}prepareValue(){for(let t=0,e=this._terms.length;t<e;t++)this._terms[t].prepareValue();0==this._operators.length&&(this._literal=this._terms[0].getLiteral())}getLiteral(){return this._literal}evaluate(t){if(this._literal)return this._literal.value;const e=this._terms.length;let s=this._terms[0].evaluate(t);for(let i=1;i<e;i++){const e=this._terms[i].evaluate(t);switch(this._operators[i-1]){case 4:s-=e;break;case 5:s+=e;break;case 18:s=s||e;break;case 19:s^=e}}return s}toString(){var t="";if(this._literal)t=this._literal.toString();else if(1==this._terms.length)t=this._terms[0].toString();else{var e,s=this._terms.length;for(t="("+this._terms[0].toString(),e=1;e<s;e++){switch(this._operators[e-1]){case 4:t+=" - ";break;case 5:t+=" + ";break;case 18:t+=" or ";break;case 19:t+=" xor ";break;default:t+=" <<ERROR>> "}t+=this._terms[e].toString()}t+=")"}return t}}class Ie{constructor(){this._node=null,this._capitalIndexers=null,this._lexer=new jt}syntaxError(t,e){throw new kt(t,e)}expected(t){if(t!=this._lexer.tokenId)throw new kt("Token is not a expected kind ["+t+"]: "+this._lexer.tokenId,this._lexer.tokenLoc);this.nextToken()}nextToken(){this._lexer.nextNoSpace()}doExpression(){let t,e=null,s=this.doSimpleExpression();if(Wt[t=this._lexer.tokenId]){this.nextToken();let i=this.doSimpleExpression();i.prepareValue();let r=i.getLiteral();if(!(r instanceof ee))throw new kt("is operator's operand must be defined, null or empty: "+this._lexer.tokenId,null);e=new oe(s,t,r)}else e=new te,e._leftExpr=s,(zt[this._lexer.tokenId]||32==this._lexer.tokenId)&&(e._operator=this._lexer.tokenId,this.nextToken(),e._rightExpr=this.doSimpleExpression());return e}doSimpleExpression(){let t=new Se;for(t.addTerm(this.doTerm());$t[this._lexer.tokenId];)t.addOperator(this._lexer.tokenId),this.nextToken(),t.addTerm(this.doTerm());return t}doTerm(){let t=new xe;for(t.addFactor(this.doFactor());Xt[this._lexer.tokenId];)t.addOperator(this._lexer.tokenId),this.nextToken(),t.addFactor(this.doFactor());return t}doFactor(){var t=this._lexer.tokenId;switch(t){case 61:return this.doCharString();case 96:return this.doBacktick();case 66:return this.doRoundOpen();case 10:return this.doIdentifier();case 64:return this.doInteger();case 63:return this.doNumber();case 4:return this.doMinus();case 5:return this.doPlus();case 13:return this.doNot();case 35:return this.doDefined();case 34:return this.doNull();case 36:return this.doEmpty();case 37:return this.doNaN();case 23:return this.doToBool();case 21:return this.doToNumber();case 20:return this.doToString();case 24:return this.doLength();case 90:return this.doToDateString();case 91:return this.doToYear();case 92:return this.doToMonth();case 93:return this.doToDay();case 94:return this.doToHour();case 95:return this.doRoundDown()}throw new kt("Unkown token: "+t,this._lexer.tokenLoc)}doCharString(){var t=this._lexer.token;return this.nextToken(),new le(t)}doBacktick(){var t=this._lexer.token;return this.nextToken(),new he(t.substring(1,t.length-1))}doRoundOpen(){this.nextToken();var t=this.doExpression();return this.expected(67),t}doIdentifier(){var t=this._lexer.token;if(this.nextToken(),69==this._lexer.tokenId){this.nextToken();var e=this.doExpression();return this.expected(70),new de(t,e,this._capitalIndexers.indexOf(t)>=0)}if(66==this._lexer.tokenId){this.nextToken();e=this.doExpression();return this.expected(67),new ce(t,e)}return new he(t)}doNumber(){var t=this._lexer.token;return this.nextToken(),new ae(t)}doInteger(){var t=this._lexer.token;return this.nextToken(),new Ae(t)}doMinus(){return this.nextToken(),new _e(this.doFactor())}doPlus(){return this.nextToken(),new ge(this.doFactor())}doNot(){return this.nextToken(),new fe(this.doFactor())}doDefined(){return this.nextToken(),new se}doNull(){return this.nextToken(),new re}doEmpty(){return this.nextToken(),new ie}doNaN(){return this.nextToken(),new ne}doToBool(){return this.nextToken(),new me(this.doFactor())}doToNumber(){return this.nextToken(),new we(this.doFactor())}doToString(){return this.nextToken(),new ye(this.doFactor())}doLength(){return this.nextToken(),new pe(this.doFactor())}doToDateString(){return this.nextToken(),new Ce(this.doFactor())}doToYear(){return this.nextToken(),new be(this.doFactor())}doToMonth(){return this.nextToken(),new ve(this.doFactor())}doToDay(){return this.nextToken(),new Be(this.doFactor())}doToHour(){return this.nextToken(),new Ee(this.doFactor())}doRoundDown(){return this.nextToken(),new Pe(this.doFactor())}parse(t,e){if(t){this._capitalIndexers=e||[],this._lexer.init(t),this.nextToken();var s=this.doExpression();return s&&s.prepareValue(),this._lexer.clear(),this._capitalIndexers=null,s}return null}evaluate(t,e,s){return this.parse(t,s).evaluate(e)}}Ie.Default=new Ie;const Re={row:0,values:1},Te=999;class Oe extends Yt{constructor(){super(),this._fieldMap={}}_doDispose(){super._doDispose()}prepare(t){const e=this._data=t,s=this._fieldMap={};if(e)for(let t=0;t<e.fieldCount;t++){const e=this._data.getField(t).fieldName;s[":"+e]=s[e]=Te+t}return this}setRow(t){return this._row=t,this}isIdentifier(t){const e=t.toLocaleLowerCase();return Re.hasOwnProperty(e)?Re[e]:this._fieldMap.hasOwnProperty(t)?this._fieldMap[t]:super.isIdentifier(t)}evaluateIdentifier(t){if(t>=Te)return this._row>=0?this._data.getRowValue(this._row,t-Te):void 0;super.evaluateIdentifier(t)}evaluateIndexerS(t,e,s){if(1==t){const t=this._fieldMap[e];return this._row>=0?this._data.getRowValue(this._row,t-Te):void 0}throw new Vt("Invalid field name: "+t)}evaluateFunc(t,e){return 0===t?this._row:super.evaluateFunc(t,e)}}class Fe{constructor(t,e){this.data=t,this.path=e}static create(t,e){return new Fe(t,e)}}class De extends A{constructor(t,e){super(),this._name=t,this._dp=e}get provider(){return this._dp}get designTime(){var t;return null===(t=this._dp)||void 0===t?void 0:t.designTime}get isBand(){return!1}get name(){return this._name}set name(t){var e;if(t!==this._name){const s=this._name;this._name=t,null===(e=this._dp)||void 0===e||e.dataNameChanged(this,s)}}preparePrint(t,e){}}class Le extends De{constructor(t){super("_context_",null),this._context=t}static isValue(t){return this.Values.hasOwnProperty(t)}static isBandValue(t){return this.BandValues.hasOwnProperty(t)}getFieldNames(){return[]}getValue(t){const e=Le.Values[t];return e&&e(this._context)}getSaveValues(){}getSaveType(){return"context"}}Le.Values={"${page}":t=>t.page+1,"%{page}":t=>t.page+1,"${pages}":t=>t.pageCount,"%{pages}":t=>t.pageCount,"${all-page}":t=>t.compositePrinting?t.compositePage+1:t.page+1,"%{all-page}":t=>t.compositePrinting?t.compositePage+1:t.page+1,"${all-pages}":t=>t.compositePrinting?t.compositePageCount:t.pageCount,"%{all-pages}":t=>t.compositePrinting?t.compositePageCount:t.pageCount,"${date}":t=>t.date,"%{date}":t=>t.date},Le.BandValues={"${dpage}":t=>t.detailPage+1,"${dpages}":t=>t.detailPageCount};class Ne extends De{constructor(t,e){super(t,null),this.setSample(e),this._isObj=J.isObject(e)}getValue(t){if(t&&this._isObj){let e=this._values;const s=t.split(".");for(let t of s)e=e[t];return e}}get sample(){return this._values}setSample(t){t!==this._values&&(this._values=t)}getFieldNames(){if(this._values){const t=[];for(let e in this._values)t.push(e);return t}}getSaveType(){return"simple"}getSaveValues(){return this._values}}var He;!function(t){t.SAMPLE="sample",t.GENERATE="generate"}(He||(He={}));class Qe extends De{constructor(t,e,s){if(super(t,s),this._calcFieldRuntime=new Oe,e){this._fields=e;for(let t of e){if(!t.fieldName)throw new Error("The fieldName must be exists.");t.dataType||(t.dataType="text"),t.dateReader=null}}}get fields(){return this._fields&&this._fields.slice()}get fieldCount(){return this._fields?this._fields.length:0}getFields(){var t;return null===(t=this._fields)||void 0===t?void 0:t.slice(0)}getField(t){return this._fields[t]}getFieldByName(t){if(this._fields)for(let e of this._fields)if(e.fieldName===t)return e}getFieldIndex(t){if(this._fields)for(let e=this._fields.length-1;e>=0;e--)if(this._fields[e].fieldName===t)return e;return-1}containsField(t){return this._fields&&this._fields.some((e=>e.fieldName===t))}indexOfField(t){return this._fields.indexOf(t)}setField(t,e){this._fields[t]={...e}}getSaveFields(){return this._fields}getNextFieldName(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"field";let e=t,s=1;for(;this._fields.some((t=>e===t.fieldName));)e=t+"-"+s++;return e}getFieldNames(){return this._fields?this._fields.map((t=>t.fieldName)).sort():[]}addField(t,e){if(e&&!this._fields.includes(e))return t=Math.max(0,Math.min(this._fields.length,t)),this._fields.splice(t,0,e),!0}removeField(t){const e=this._fields.indexOf(t);if(e>=0)return this._fields.splice(e,1),!0}groupBy(t,e){function s(e,i){if(i.push(e),e.level===t.length)for(let t=0;t<e.count;t++)i.push(t+e.row);else for(let t of e.children)s(t,i);i.push({group:e})}const i=e?e.length:this.rowCount;if(t&&t.length>0){const r=[],n={parent:null,level:0,row:0,count:i,children:[]};!function s(i,r){const n=r.row+r.count;let o=r.level+1,a=r.row;const A=t[o-1];let l={parent:r,level:o,row:a,count:1,value:i.getRowValue(a,A),children:[]};for(r.children.push(l);++a<n;){const t=i.getRowValue(e?e[a]:a,A);t!==l.value?(l={parent:r,level:o,row:a,count:1,value:t,children:[]},r.children.push(l)):l.count++}if(o<t.length)for(let t of r.children){let e=t.row;for(;e<t.row+t.count;)s(i,t),e+=t.count}}(this,n);for(let t of n.children)s(t,r);if(e)for(let t=0;t<r.length;t++){const s=r[t];"number"==typeof s?r[t]=e[s]:isNaN(s.row)||(r[t].row=e[s.row])}return r}}readValue(t,e){if(t){const s=t.dataType;if("text"===s)return J.isDefined(e)?String(e):e;if("datetime"===s)return t.dateReader||(t.dateReader=new Mt(t.format)),t.dateReader.toDate(e);if("number"===s)return"number"==typeof e?e:parseFloat(e);if("bool"===s)return"boolean"==typeof e?e:"number"==typeof e?0!==e:"True"===e||"true"===e}return e}readRow(t){if(this._fields){const e=this._fields;if(J.isArray(t))for(let s=0;s<e.length;s++)t[s]=this.readValue(e[s],t[s]);else if(t)for(let s in t){const i=this.getFieldIndex(s);i>=0&&(t[s]=this.readValue(e[i],t[s]))}}return t}dateToStr(t,e){const s=t&&t.format&&Ht.getFormatter(t.format);return s?s.getText(e):String(e)}get isBand(){return!0}preparePrint(t,e){super.preparePrint(t,e);const s=this._fields;let i=this._fields;if(!e&&!i){const e=t.designDp.get(this.name);e instanceof Qe&&(i=this._fields=e.getFields())}if(i){const t=this._fieldMap={};for(let e=0;e<i.length;e++)t[i[e].fieldName]=e;s||this._readRows(),this._calcFieldRuntime.prepare(this);for(let e=0;e<i.length;e++){const s=i[e];if(s.expression){const r=Ie.Default.parse(s.expression);this._prepareCalcField(i,t,s,e,r)}}}}_readRows(){}_prepareCalcField(t,e,s,i,r){}}class Ue extends Qe{constructor(t,e,s,i,r){super(t,e,r),this._sampleCount=-1,i>0&&(this._sampleCount=i),this.setValues(s)}get rowCount(){return this._values.length}getRowValues(t){return this._values[t]}getValue(t){return this.getRowValue(0,t)}getRowValue(t,e){const s=this._values[t];if(s)return"number"==typeof e?s[this.getField(e).fieldName]:s[e]}getFieldValues(t,e){const s=[];if("number"==typeof t&&(t=this.getField(t).fieldName),e)e.forEach((e=>s.push(this._values[e][t])));else for(let e=0;e<this._values.length;e++)s.push(this._values[e][t]);return s}equalValues(t,e,s){for(let i=e.length-1;i>=0;i--)if(this._values[t][e[i]]!==s[i])return!1;return!0}equalRows(t,e,s){const i=this._values;s=s||this._fields.map((t=>t.fieldName));for(let r=s.length-1;r>=0;r--)if(i[t][s[r]]!==i[e][s[r]])return!1;return!0}findRows(t){const e=null!=t&&Object.keys(t),s=[];return e&&e.length>0&&this._values.forEach(((i,r)=>{let n=!0;for(let s of e)if(i[s]!==t[s]){n=!1;break}n&&s.push(r)})),s}get sample(){return this._values}getValues(){const t=[];for(let e=0;e<this._values.length;e++)t.push(this.$_cloneRow(this._values[e]));return t}setValues(t){const e=this._values=[];if(t)for(let s=0,i=t.length;s<i;s++){let i=this.$_cloneRow(t[s]);i=this.readRow(i),e.push(i)}}getSaveType(){return"band"}getSaveValues(){}$_cloneRow(t){if(t){const e={};for(let s in t)e[s]=t[s];return e}return null}$_prepareSample(){const t=this._fields;if(t&&t.length>0){const e={};for(let s of t)e[s.fieldName]=this.readValue(s,s.sample);return e}return{}}_readRows(){const t=this._values;for(let e=0,s=t.length;e<s;e++)t[e]=this.readRow(t[e])}_prepareCalcField(t,e,s,i,r){const n=this._values,o=this._calcFieldRuntime;for(let t=0,e=n.length;t<e;t++){const e=n[t];o.setRow(t);const i=r.evaluate(o);e[s.fieldName]=i}}}class Me{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.width=t,this.height=e}static empty(){return new Me}static create(){return new Me(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}get isEmpty(){return 0===this.width||0===this.height}clone(){return new Me(this.width,this.height)}equals(t){return t===this||t&&this.width===t.width&&this.height===t.height}setEmpty(){return this.width=this.height=0,this}set(t,e){return this.width=t,this.height=e,this}round(){const t=this.clone();return t.width>>>=0,t.height>>>=0,t}toString(){return"{width: "+this.width+", height: "+this.height+"}"}}Me.EMPTY=new Me;const ke=/\s*\,\s*/;class Ve{static get hueCount(){return this.HUES.length}static getHue(t){return this.HUES[t]}static rbg2Hue(t){const e=(16711680&t)>>16,s=(65280&t)>>8,i=255&t,r=Math.min(e,s,i),n=Math.max(e,s,i);if(r==n)return 0;{let t=0;return t=n==e?(s-i)/(n-r):n==s?2+(i-e)/(n-r):4+(e-s)/(n-r),t*=60,t<0&&(t+=360),Math.round(t)}}static rgb2Hsl(t,e,s){if(void 0===e){const i=t;t=(16711680&i)>>16,e=(65280&i)>>8,s=255&i}t/=255,e/=255,s/=255;const i=Math.max(t,e,s),r=Math.min(t,e,s);let n,o,a=(i+r)/2;if(i==r)n=o=0;else{const A=i-r;switch(o=a>.5?A/(2-i-r):A/(i+r),i){case t:n=(e-s)/A+(e<s?6:0);break;case e:n=(s-t)/A+2;break;case s:n=(t-e)/A+4}n/=6}return{h:360*n,s:100*o,l:100*a}}static hue2rgb(t,e,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+6*(e-t)*s:s<.5?e:s<2/3?t+(e-t)*(2/3-s)*6:t}static hsl2Rgb(t,e,s){if(void 0===e){const i=t;t=(16711680&i)>>16,e=(65280&i)>>8,s=255&i}let i,r,n;if(t/=360,s/=100,0==(e/=100))i=r=n=s;else{const o=s<.5?s*(1+e):s+e-s*e,a=2*s-o;i=Ve.hue2rgb(a,o,t+1/3),r=Ve.hue2rgb(a,o,t),n=Ve.hue2rgb(a,o,t-1/3)}return Math.round(255*i)<<16|Math.round(255*r)<<8|Math.round(255*n)}static toHex(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN,s=((16711680&t)>>16).toString(16);1==s.length&&(s="0"+s);let i=((65280&t)>>8).toString(16);1==i.length&&(i="0"+i);let r=(255&t).toString(16);1==r.length&&(r="0"+r);let n="";return isNaN(e)||(e=Math.round(255*e),n=(255&e).toString(16),1==n.length&&(n="0"+n)),"#"+s+i+r+n}static toRgba(t,e){let s="rgba(";return s+=((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+e,s+")"}static interpoate(t,e,s){const i=(16711680&t)>>16,r=(65280&t)>>8,n=255&t,o=(16711680&e)>>16,a=(65280&e)>>8,A=255&e;return(Math.floor((o-i)*s+i)<<16)+(Math.floor((a-r)*s+r)<<8)+Math.floor((A-n)*s+n)}static colorToHex(t,e){return"#"+J.pad16(t,6)+J.pad16(Math.round(255*e),2)}static colorToHex2(t,e){return e<1?"#"+J.pad16(t,6)+J.pad16(Math.round(255*e),2):"#"+J.pad16(t,6)}static colorToCss(t,e){const s=Math.round(100*e)/100;if(1!==s){return"rgba("+((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+s+")"}return"#"+J.pad16(t,6)}static strToColor(t){let e=0,s=1;if(t)if((t=t.trim()).startsWith("rgba(")&&t.endsWith(")")){const i=t.substring(5,t.length-1).trim().split(ke);4===i.length&&(e=parseInt(i[0])<<16|parseInt(i[1])<<8|parseInt(i[2]),s=parseFloat(i[3]))}else if(t.startsWith("rgb(")&&t.endsWith(")")){const s=t.substring(4,t.length-1).trim().split(ke);3===s.length&&(e=parseInt(s[0])<<16|parseInt(s[1])<<8|parseInt(s[2]))}else{t.startsWith("#")&&(t=t.substr(1));const i=t.length;i>6?(e=parseInt(t.substr(0,6),16),s=parseInt(t.substring(6),16)/255):i>0&&(3===i&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)),e=parseInt(t,16))}return{color:e,alpha:s}}static cssToColor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t)if(t.startsWith("rgba(")){const s=t.substring(5,t.length-1).split(ke),i=parseFloat(s[3]);if(i>0||!e){return{color:parseInt(s[0])<<16|parseInt(s[1])<<8|parseInt(s[2]),alpha:i}}}else if(t.startsWith("rgb(")){const e=t.substring(4,t.length-1).split(ke);return{color:parseInt(e[0])<<16|parseInt(e[1])<<8|parseInt(e[2]),alpha:1}}}static lighten(t,e){if(e>=1)return t;const s=this.rgb2Hsl(t),i=s.l+s.l*(1-e);return this.hsl2Rgb(s.h,s.s,i)}}Ve.HUE_MAX=360,Ve.SATURATION_MAX=100,Ve.LIGHTNESS_MAX=100,Ve.HUES=[16711680,16776960,65280,65535,255,16711935,16711680];const Ge={position:"poistion",display:"display",marign:"margin"},Ke={color:0,backgroundColor:1,fill:2},We={};function ze(t){if(t&&"#"==t.charAt(0)&&t.length>7){const e=parseInt(t.substring(1,7),16),s=parseInt(t.substring(7),16)/255;t=Ve.colorToCss(e,s)}return t}function $e(t,e){const s=t.values;return s[e]||s.default}function Xe(t,e,s){if(e)for(let i in e){let r=e[i];r&&!t._doApplyStyle(i,r,s)&&(i in Ge||(i in Ke?r=ze(r):i in We&&(r=$e(We[i],r),i=We[i].css),s[i]=r||""))}}class je extends q{get debugging(){return je.Debugging}get debugLabel(){return this.constructor.name}get guardLabel(){return this.debugLabel}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}get lazyLayout(){return!1}get floating(){return!1}measure(t,e,s){const i=this._dom,r=t&&t.printing;r?delete i.dataset.design:i.dataset.design="",r&&this._clearDesign(),this._doPrepareMeasure(t,i);const n=this._doMeasure(t,i,e,s);return this._doAfterMeasure(t,i,e,s,n),this._measuredWidth=n.width,this._measuredHeight=n.height,n}layoutContent(t){this._doPrepareContent(t),this._doLayoutContent(t),this._doAfterLayout(t)}print(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN;const i=this._dom;return this._printWidth=s,this._setClassName(i),this._doPrint(t,e),this._setSizeStyle(i.style),this.height}findElement(t){return null}applyMeasure(){this.resize(this._measuredWidth,this._measuredHeight)}_debugBorder(){return"1px solid rgba(0, 61, 0, 0.3)"}_debugColor(){return"rgba(0, 61, 0, 0.4)"}_clearDesign(){}_afterDraw(t){if(this.debugging&&this._debuggable()){if(!this._debugView){this._debugView=t.ownerDocument.createElement("span");const e=this._debugView.style;e.display="inline-block",e.position="absolute",e.pointerEvents="none",e.left="0",e.top="0",e.right="0",e.bottom="0",e.border=this._debugBorder(),e.color=this._debugColor()}this._debugView.textContent=this.debugLabel,t.appendChild(this._debugView)}else this._debugView&&J.detach(this._debugView)}_debuggable(){return!0}_doPrepareMeasure(t,e){}_doAfterMeasure(t,e,s,i,r){}_doMeasure(t,e,s,i){return new Me(s,i)}_doPrepareContent(t){}_doLayoutContent(t){}_doAfterLayout(t){}_doSetStyles(t,e){this._setStyles(t,t.styles,e.style)}_setStyles(t,e,s){Xe(t,e,s)}_getModelWidth(t,e){return t.getWidth(e)}_getModelHeight(t,e){return t.getHeight(e)}_setModelSize(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const n=this._modelWidth=this._getModelWidth(t,s),o=this._modelHeight=this._getModelHeight(t,i);isNaN(n)?r&&(e.style.width=""):e.style.width=n+"px",isNaN(o)?r&&(e.style.height=""):e.style.height=o+"px"}_doPrint(t,e){const s=this.measure(e,e.pageWidth,e.pageHeight);this.width=s.width,this.height=s.height,this.layoutContent(e)}}je.Debugging=!1;class Ye extends je{}class Je extends je{constructor(t,e,s,i,r){super(t,null),this._model=e,this._text=s,this.dom.title=i;let n="rr-section-head";r&&(n+=" "+r),this.styleName=n}get model(){return this._model}set model(t){this._model=t}get text(){return this._text}set text(t){t!==this._text&&(this._text=t,this.invalidateLayout())}setSelected(t){this.model.isAncestorOf(t)?this.dom.dataset.selected="":delete this.dom.dataset.selected}_initDom(t,e){super._initDom(t,e),this._span=t.createElement("span"),e.appendChild(this._span)}_doMeasure(t,e,s,i){const r=this._span;return e.style.width="",e.style.height="",r.textContent=this._text,new Me(Math.ceil(e.offsetWidth),e.offsetHeight)}isDom(t){return super.isDom(t)||t===this._span}}class Ze extends je{}class qe extends A{constructor(t){super(),this._prop=t}get group(){return this._group}get prop(){return this._prop}get name(){return this._prop.name}get label(){return this._prop.label||this._prop.name}get domain(){return this._prop.domain}get parent(){return this._prop.parent}isVisible(t){return!this._prop.visible||!1!==this._prop.visible(t)}isReadOnly(t){return this._prop.readonly||t.isReadOnlyProperty(this._prop)}getValue(t){return t.getProperty(this._prop.name)}setValue(t,e){t.setProperty(this._prop.name,e)}setValues(t,e){t[0].setItemsProperty(t,this._prop.name,e)}hasColor(){return!1}}class ts extends A{constructor(t){super(),this._items=[],this._pool=[],this._label=t}get label(){return this._label}get count(){return this._items.length}get(t){return this._items[t]}borrow(t){for(let e=this._pool.length-1;e>=0;e--){const s=this._pool[e];if(s._prop===t)return this._pool.splice(e,1),s}}add(t){t._group=this,this._items.push(t)}clear(){for(let t of this._items)t._group=null,this._pool.push(t);this._items=[]}}class es extends qe{constructor(t){super(t)}get defaultValue(){return this._defaultValue}set defaultValue(t){this._defaultValue=t}}class ss extends qe{constructor(t){super(t)}}class is extends es{constructor(t){super(t)}}is.$_ctor="StringProperty";class rs extends es{constructor(t){super(t),this._minimum=NaN,this._maximum=NaN}get minimum(){return this._minimum}set minimum(t){this._minimum=t}get maximum(){return this._maximum}set maximum(t){this._maximum=t}}rs.$_ctor="NumberProperty";class ns extends is{constructor(t){super(t),this.percentable=!0}}ns.$_ctor="DimensionProperty";class os extends ns{constructor(t){super(t)}}os.$_ctor="SizeProperty";class as extends es{constructor(t){super(t)}}as.$_ctor="BooleanProperty";(class extends es{constructor(t){super(t)}}).$_ctor="DateProperty";class As extends es{constructor(t,e){super(t),this._type=e||t.domain}get domain(){const t=J.getEnumValues(this._type);return void 0===this.defaultValue&&t.unshift(void 0),t}}As.$_ctor="EnumProperty";class ls extends is{constructor(t){super(t)}}ls.$_ctor="ReportItemProperty";class hs extends is{constructor(t){super(t)}}hs.$_ctor="ListableProperty";class ds extends is{}ds.$_ctor="EditListableProperty";class cs extends is{constructor(t){super(t)}}cs.$_ctor="FunctionProperty";class us extends es{constructor(t){super(t)}}us.$_ctor="NumberArrayProperty";class ps extends es{constructor(t){super(t)}}ps.$_ctor="StringArrayProperty";class _s extends es{constructor(t){super(t)}}_s.$_ctor="ColorProperty";class gs extends es{constructor(t){super(t)}}gs.$_ctor="PopupProperty";class fs extends qe{constructor(t){super(t)}getValue(t){return this.parent?t.getSubStyleProperty(this.parent,this.name):t.getStyleProperty(this.name)}setValue(t,e){this.parent?t.setSubStyleProperty(this.parent,this.name,e):t.setStyleProperty(this.name,e)}setValues(t,e){const s=t[0];this.parent?s.setItemsSubStyleProperty(t,this.parent,this.name,e):s.setItemsStyleProperty(t,this.name,e)}}(class extends fs{constructor(t){super(t)}get styleName(){return"background"}}).$_ctor="BackgroundStyle";class ms extends fs{constructor(t){super(t)}get styleName(){return"color"}}ms.$_ctor="ColorStyle";class ws extends fs{constructor(t){super(t)}get styleName(){return"fontFamily"}}ws.VALUES=[void 0,"Arial","Helvetica","Tahoma",'"Trebuchet MS"',"Verdana",'"Courier New"','"Lusida Console"','"Times New Roman"'],ws.$_ctor="FontFamilyStyle";class ys extends fs{constructor(t){super(t)}get styleName(){return"fontSize"}}ys.$_ctor="FontSizeStyle";class Cs extends fs{constructor(t){super(t)}get styleName(){return"fontStyle"}}Cs.VALUES=[void 0,"normal","italic","oblique"],Cs.$_ctor="FontStyleStyle";class bs extends fs{constructor(t){super(t)}get styleName(){return"fontWeight"}}bs.VALUES=[void 0,"normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900"],bs.$_ctor="FontWeightStyle";class vs extends fs{constructor(t){super(t)}get styleName(){return"textAlign"}}vs.VALUES=[void 0,"left","center","right"],vs.$_ctor="TextAlignStyle";class Bs extends fs{constructor(t){super(t)}get styleName(){return"verticalAlign"}}Bs.VALUES=[void 0,"top","middle","bottom"],Bs.$_ctor="VerticalAlignStyle";class Es extends fs{constructor(t){super(t)}get styleName(){return"whiteSpace"}}Es.VALUES=[void 0,"normal","nowrap","pre","pre-wrap","pre-line"],Es.$_ctor="WhiteSpaceStyle";class Ps extends fs{constructor(t){super(t)}get styleName(){return"textDecoration"}}Ps.VALUES=[void 0,"underline","line-through","overline"],Ps.$_ctor="TextDecorationStyle";class xs extends fs{constructor(t){super(t)}get styleName(){return"line-height"}}xs.$_ctor="LineHeightStyle";class Ss extends fs{constructor(t){super(t)}get styleName(){return"border"}hasColor(){return!0}}Ss.$_ctor="BorderStyle";class Is extends fs{constructor(t){super(t)}hasColor(){return!0}}Is.$_ctor="BorderItemStyle";class Rs extends Is{constructor(t){super(t)}get styleName(){return"border-left"}}Rs.$_ctor="BorderLeftStyle";class Ts extends Is{constructor(t){super(t)}get styleName(){return"border-right"}}Ts.$_ctor="BorderRightStyle";class Os extends Is{constructor(t){super(t)}get styleName(){return"border-top"}}Os.$_ctor="BorderTopStyle";class Fs extends Is{constructor(t){super(t)}get styleName(){return"border-bottom"}}Fs.$_ctor="BorderBottomStyle";(class extends fs{constructor(t){super(t)}get styleName(){return"padding"}}).$_ctor="PaddingStyle";class Ds extends fs{constructor(t){super(t)}}Ds.$_ctor="PaddingItemStyle";class Ls extends Ds{constructor(t){super(t)}get styleName(){return"padding-left"}}Ls.$_ctor="PaddingLeftStyle";class Ns extends Ds{constructor(t){super(t)}get styleName(){return"padding-right"}}Ns.$_ctor="PaddingRightStyle";class Hs extends Ds{constructor(t){super(t)}get styleName(){return"padding-top"}}Hs.$_ctor="PaddingTopStyle";class Qs extends Ds{constructor(t){super(t)}get styleName(){return"padding-bottom"}}Qs.$_ctor="PaddingBottomStyle";class Us extends fs{constructor(t){super(t)}}(class extends Us{constructor(t){super(t)}get styleName(){return"margin-left"}}).$_ctor="MarginLeftStyle";(class extends Us{constructor(t){super(t)}get styleName(){return"margin-right"}}).$_ctor="MarginRightStyle";(class extends Us{constructor(t){super(t)}get styleName(){return"margin-top"}}).$_ctor="MarginTopStyle";(class extends Us{constructor(t){super(t)}get styleName(){return"margin-bottom"}}).$_ctor="MarginBottomStyle";class Ms extends fs{constructor(t){super(t)}get styleName(){return"opacity"}}Ms.$_ctor="OpacityStyle";class ks extends fs{constructor(t){super(t)}get styleName(){return"cellAlign"}}ks.VALUES=[void 0,"left","center","right"],ks.$_ctor="CellAlignStyle";class Vs extends fs{constructor(t){super(t)}get styleName(){return"strokeWidth"}}Vs.$_ctor="StrokeWidthStyle";class Gs extends fs{constructor(t){super(t)}get styleName(){return"strokeDasharray"}}Gs.$_ctor="StrokeDasharrayStyle";class Ks extends fs{constructor(t){super(t)}get styleName(){return"writingMode"}}var Ws;Ks.VALUES=[void 0,"horizontal-tb","vertical-rl","vertical-lr"],Ks.$_ctor="WritingModeStyle",function(t){t.DESIGN="design",t.BASIC="basic",t.TEXT="text",t.DATA="data",t.BOUND="bound",t.EVENT="event",t.EDITOR="editor",t.REPORT="report",t.PAPER="paper",t.BOX="box",t.TABLE="table",t.BARCODE="barcode",t.CELL="cell",t.BAND="band",t.BAND_GROUP="band group",t.BAND_CELL="band cell",t.FIELD="field",t.COLUMN="column",t.ROW="row",t.CHART="chart",t.TITLE="title",t.SUBTITLE="subtitle",t.AXIS="axis",t.XAXIS="x Axis",t.YAXIS="y Axis",t.SERIES="series",t.LABEL="label",t.LABELS="labels",t.DATA_LABELS="dataLabels",t.MARKER="marker",t.LEGEND="legend"}(Ws||(Ws={}));class zs extends l{constructor(t){super(),this._modelMap={},this._groupMap={},this._styleGroup=new ts("Styles"),this._childStyleMap={},this._groups=[],this._models=[],this._name=t}get name(){return this._name}get source(){return this._source}set source(t){t!==this._source&&(this._source=t,this.$_buildItems(),this._fireSourceChanged())}get sources(){return this._sources}set sources(t){this._sources=t,this.source=t&&t.length>0?t[0]:null}get groupCount(){return this._groups.length}get modelCount(){return this._models.length}getGroup(t){return this._groups[t]}getModel(t){return this._models[t]}refresh(){this.$_buildItems()}updateValue(t,e,s){const i=e._prop,r=this._sources;t=t||this.source,e.prop.multiple&&r&&r.length>1?(t=r[0],e.setValues(r,s)):t&&e.setValue(t,s),t&&t.isDominantProp(i)&&(this.refresh(),this._fireSourceChanged())}$_borrowGroup(t){let e=this._groupMap[t];return e||(this._groupMap[t]=e=new ts(t)),e.source=null,e}$_borrowModel(t){let e=this._modelMap[t];return e||(this._modelMap[t]=e=new zs),e}$_clear(){this._models=[];for(let t in this._modelMap)this._modelMap[t].$_clear();this._groups=[];for(let t in this._groupMap)this._groupMap[t].clear();for(let t in this._childStyleMap)this._childStyleMap[t].clear()}$_buildSource(t,e){let s=t.getEditProps();for(let i of s)if(i.type!==fs){let s=e;s||(s=this.$_borrowGroup(this.name||i.category),this._groups.indexOf(s)<0&&this._groups.push(s));let r=s.borrow(i);r||(r=new i.type(i)),r instanceof $s&&(r.model.source=t[i.name],i.indented&&(s.source=r.model.source),r.model.$_buildItems(i.indented?s:null)),s.add(r)}let i=t.getStyleProps();if(i&&i.length>0){const t=this._styleGroup;t.source=this.source,t.clear();for(let e of i){let s=t.borrow(e);s||(s=new e.type(e)),t.add(s)}t.count>0&&this._groups.push(t)}for(let e of s)if(e.type===ss){const s=this.$_borrowGroup(e.name);if(Z(null!=s),s.source=this.source,s.clear(),i=t.getSubStyleProps(e.name),i&&i.length>0)for(let t of i){let e=s.borrow(t);e||(e=new t.type(t)),s.add(e)}s.count>0&&this._groups.push(s)}}$_buildModels(t){for(let e=0;e<t.length;e++){const s=t[e],i=this.$_borrowModel(s.getCollectionLabel()+e);i.source=s,this._models.push(i),i.$_buildItems()}}$_buildItems(t){this.$_clear();const e=this._source;e&&e.getEditProps&&(e.isCollectionProp()?this.$_buildModels(e.getPropertySources()):this.$_buildSource(e,t))}_fireSourceChanged(){this.fireEvent(zs.SOURCE_CHANGED)}}zs.SOURCE_CHANGED="onPropertySourceChanged";class $s extends qe{constructor(t){super(t),this._model=new zs(t.name)}get model(){return this._model}}$s.$_ctor="ModelProperty";const Xs="styles",js="backgroundColor",Ys="color",Js="fontFamily",Zs="fontSize",qs="fontStyle",ti="fontWeight",ei="textAlign",si="verticalAlign",ii="writingMode",ri="textDecoration",ni="lineHeight",oi="paddingLeft",ai="paddingRight",Ai="paddingTop",li="paddingBottom",hi="border",di="borderLeft",ci="borderRight",ui="borderTop",pi="borderBottom",_i="opacity",gi="fill",fi="stroke",mi="strokeWidth",wi="strokeDasharray",yi="backFill",Ci="backStroke",bi="barColor",vi="cellAlign",Bi={};var Ei,Pi,xi;Bi.backgroundColor={name:js,category:Xs,type:ms,multiple:!0,default:void 0},Bi.color={name:Ys,category:Xs,type:ms,multiple:!0,default:void 0},Bi.fontFamily={name:Js,category:Xs,type:ws,multiple:!0,default:void 0,domain:ws.VALUES},Bi.fontSize={name:Zs,category:Xs,type:ys,multiple:!0,default:void 0},Bi.fontStyle={name:qs,category:Xs,type:Cs,multiple:!0,default:void 0,domain:Cs.VALUES},Bi.fontWeight={name:ti,category:Xs,type:bs,multiple:!0,default:void 0,domain:bs.VALUES},Bi.textAlign={name:ei,category:Xs,type:vs,multiple:!0,default:void 0,domain:vs.VALUES},Bi.verticalAlign={name:si,category:Xs,type:Bs,multiple:!0,default:void 0,domain:Bs.VALUES},Bi.writingMode={name:ii,category:Xs,type:Ks,multiple:!0,default:void 0,domain:Ks.VALUES},Bi.textDecoration={name:ri,category:Xs,type:Ps,multiple:!0,default:void 0,domain:Ps.VALUES},Bi.lineHeight={name:ni,category:Xs,type:xs,multiple:!0,default:void 0},Bi.border={name:hi,category:Xs,type:Ss,multiple:!0,default:void 0},Bi.borderLeft={name:di,category:Xs,type:Rs,multiple:!0,default:void 0},Bi.borderRight={name:ci,category:Xs,type:Ts,multiple:!0,default:void 0},Bi.borderTop={name:ui,category:Xs,type:Os,multiple:!0,default:void 0},Bi.borderBottom={name:pi,category:Xs,type:Fs,multiple:!0,default:void 0},Bi.paddingLeft={name:oi,category:Xs,type:Ls,multiple:!0,default:void 0},Bi.paddingRight={name:ai,category:Xs,type:Ns,multiple:!0,default:void 0},Bi.paddingTop={name:Ai,category:Xs,type:Hs,multiple:!0,default:void 0},Bi.paddingBottom={name:li,category:Xs,type:Qs,multiple:!0,default:void 0},Bi.fill={name:gi,category:Xs,type:ms,multiple:!0,default:void 0},Bi.stroke={name:fi,category:Xs,type:ms,multiple:!0,default:void 0},Bi.strokeWidth={name:mi,category:Xs,type:Vs,multiple:!0,default:void 0},Bi.strokeDasharray={name:wi,category:Xs,type:Gs,multiple:!0,default:void 0},Bi.backFill={name:yi,category:Xs,type:ms,multiple:!0,default:void 0},Bi.backStroke={name:Ci,category:Xs,type:ms,multiple:!0,default:void 0},Bi.barColor={name:bi,category:Xs,type:ms,multiple:!0,default:void 0},Bi.opacity={name:_i,category:Xs,type:Ms,multiple:!0,default:void 0},Bi.cellAlign={name:vi,category:Xs,type:ks,multiple:!0,default:void 0,domain:ks.VALUES},function(t){t.PROP="prop"}(Ei||(Ei={}));class Si{}Si.Shared=new Si;class Ii extends A{constructor(){super(...arguments),this.outlineOrder=0}get selectItem(){return this}canSelectedWith(t){return!0}get index(){return-1}get outlineItems(){return[]}canParentOf(t){return!1}getProperty(t){return this[t]}setProperty(t,e){const s=this.page;s?s.report.setItemProperty(this,t,e):this[t]=e}isReadOnlyProperty(t){return!1}isDominantProp(t){return!1}isCollectionProp(){return!1}isEditableCollection(){return!1}isCollectionItem(){return!1}getPropertySources(){return null}getCollectionLabel(){}setItemsStyleProperty(t,e,s){const i=t.filter((t=>t instanceof Ii)),r=this.page;if(r){this.styles[e]!==s&&r.report.setItemsStyle(i,e,s)}else i.forEach((t=>{t.setStyle(e,s)}))}getPopupPropLabel(t){}get outlineSource(){return this}get parent(){const t=this.outlineParent;return t instanceof Ti?t:null}get dataParent(){return this.parent}get displayParent(){return J.cast(this.outlineParent,Ii)}get marqueeParent(){return null}get printable(){return!0}isAncestorOf(t){return t===this}getProps(){const t={};return this.getEditProps().forEach((e=>{t[e.name]=this[e.name]})),t}setProps(t){J.isObject(t)&&this.getEditProps().forEach((e=>{if(!e.readonly){const s=e.name;t.hasOwnProperty(s)&&(this[s]=t[s])}}))}canMove(){return!0}_loadProp(t,e){t.hasOwnProperty(e)&&(this[e]=t[e])}_loadProps(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];for(let e of s)t.hasOwnProperty(e)&&(this[e]=t[e])}_loadPropOf(t,e){if(!e.readonly&&!e.calculated&&e.type!==$s){const s=e.name;this[s]instanceof Fi||t.hasOwnProperty(s)&&(this[s]=t[s])}}_loadPropsOf(t,e){for(let s of e)this._loadPropOf(t,s)}_saveProp(t,e){const s=this[e];void 0===s||Number.isNaN(s)||s instanceof Fi||(t[e]=s)}_saveProps(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];for(let e of s){const s=this[e];void 0===s||Number.isNaN(s)||s instanceof Fi||(t[e]=s)}}_savePropOf(t,e){if(e.type!==$s){const s=e.name,i=this[s];void 0===i||Number.isNaN(i)||i===e.default||i instanceof Fi||(t[s]=i)}}_savePropsOf(t,e){for(let s of e)s.calculated||this._savePropOf(t,s)}_loadObject(t,e,s){const i=t.getSaveLabel();s.hasOwnProperty(i)&&t.load(e,s[i])}_loadObjects(t,e,s){t.forEach((t=>{this._loadObject(t,e,s)}))}_saveObject(t,e){const s={};t.save(s),J.isEmpty(s)||(e[t.getSaveLabel()]=s)}_saveObjects(t,e){t.forEach((t=>{this._saveObject(t,e)}))}_arrangePaddingStyles(t){if(t.hasOwnProperty("padding")){const e=t.padding.split(/\s+/),s=e.length;t.hasOwnProperty("paddingTop")||(t.paddingTop=e[0]),t.hasOwnProperty("paddingBottom")||(t.paddingBottom=s>2?e[2]:e[0]),t.hasOwnProperty("paddingLeft")||(t.paddingLeft=s>3?e[3]:s>1?e[1]:e[0]),t.hasOwnProperty("paddingRight")||(t.paddingRight=s>1?e[1]:e[0]),delete t.padding}}_validateSize(t){if("number"==typeof t){if(!isNaN(t))return Math.max(0,t)}else if(t){const e=t.indexOf("-");if(e>=0)return t.substr(e+1)}return t}}!function(t){t.INNER="inner",t.OUTER="outer"}(Pi||(Pi={})),function(t){t.NO="${no}",t._NO="%{no}",t.ROW="${row}",t._ROW="%{row}",t.INDEX="${index}",t._INDEX="%{index}",t.INO="${ino}",t._INO="%{ino}"}(xi||(xi={}));class Ri extends Ii{constructor(t){super(),this._visible=!0,this._rotation=0,this._styles={},this._pageBreak=v.NONE,this._designOrder=Ri.DEF_DISPLAY_ORDER,this._designBorder=!0,this._index=-1,this._valueCallbackDelegate=(t,e,s,i)=>{try{return this._valueCallbackFunc(t,e,s,i)}catch(t){return console.error(t),"<ERROR>"}},this._styleCallbackDelegate=(t,e,s,i)=>{try{return this._styleCallbackFunc(t,e,s,i)}catch(t){return console.error(t),""}},this._name=t}static findFloatingAnchor(t){if(t instanceof Ri){let e=t.getFloatingContainer();if(e&&e.anchorTarget)return e.outlineParent.find(e.anchorTarget,!0)}}get outlineParent(){return this._parent}get outlineExpandable(){return!1}getEditProps(){const t=this._getEditProps();if(t){const e=[];for(let s of t)s&&s.name&&e.push(s);return e}return[]}getStyleProps(){const t=this._getStyleProps();if(t){const e=[];for(let s of t){const t=Bi[s];t&&e.push(t)}return e.length>0?e:null}}getSubStyleProps(t){if(this.isChildProp(t)){const e=this._getChildStyleProps(t);if(e){const s=[];for(let i of e){let e=Bi[i];e&&(e={...e},e.parent=t,s.push(e))}return s.length>0?s:null}}}getPlaceHolder(t){if(t.name===Ri.PROP_DATA)return this._getParentData()}getData(){var t;return null===(t=this.page)||void 0===t?void 0:t.report.designData.get(this.data||this._getParentData())}getDataFieldNames(){const t=this.getData();return t instanceof Qe||t instanceof Ne?[void 0].concat(t.getFieldNames()):[void 0]}getPropDomain(t){const e=this.page;if(e){if(t.name===Ri.PROP_DATA)return[void 0].concat(e.report.designData.getNames());if(t.name===Ri.PROP_VALUE)return this.getDataFieldNames()}}getProperty(t){return this.isChildProp(t)?this._childProps&&this._childProps[t]:this[t]}setProperty(t,e){const s=this.report;s?s.setItemProperty(this,t,e):this.isChildProp(t)?(this._childProps||(this._childProps={}),this._childProps[t]=e):this[t]=e}setItemsProperty(t,e,s){const i=t.filter((t=>t instanceof Ii)),r=this.report;r?r.setItemsProperty(i,e,s):i.forEach((t=>{t instanceof Ri&&(t.isChildProp(e)?(t._childProps||(t._childProps={}),t._childProps[e]=s):t[e]=s)}))}getProperties(t){const e={};if(J.isArray(t))for(let s of t)e[s]=this.getProperty(s);else for(let s in t)e[s]=this.getProperty(s);return e}setProperties(t){for(let e in t)if(this.isChildProp(e))this.setChildProp(e,t[e]);else{const s=Object.getOwnPropertyDescriptor(this,e);s&&(s.writable||s.set)&&(this[e]=t[e])}}getStyleProperty(t){return this._styles[t]}setStyleProperty(t,e){const s=this.page;if(s){this.styles[t]!==e&&s.report.setItemStyle(this,t,e)}else this.setStyle(t,e)}getSubStyleProperty(t,e){return this._getSubStyle(t,e)}setSubStyleProperty(t,e,s){const i=this.page;if(i){(this._childProps&&this._childProps[t]&&this._childProps[t][e])!=s&&i.report.setChildStyleProperty(this,t,e,s)}else this._setSubStyle(t,e,s)}setItemsSubStyleProperty(t,e,s,i){const r=t.filter((t=>t instanceof Ri)),n=this.page;if(n){this.styles[e]!==i&&n.report.setItemsChildStyleProperty(r,e,s,i)}else r.forEach((t=>{t._setSubStyle(e,s,i)}))}canPropAdoptDragSource(t,e){return!1}adoptPropDragSource(t,e){}dataNameChanged(t,e){this._data===e&&(this._data=t.name)}dataFieldNameChanged(t,e,s){}get parent(){return this._parent}get dataParent(){return this._parent}get index(){return this._index}get level(){return this._parent?this._parent.level+1:0}get page(){return this._parent&&this._parent.page}get report(){return this._parent&&this._parent.report}get name(){return this._name}set name(t){if(t!==this._name){const e=this.page,s=this._name;if(e&&t&&e.getItem(t))throw new Error('"'+t+'"는(은) 이미 다른 아이템의 이름으로 사용 중입니다.');this._name=t,e&&e.$_nameChanged(this,s),this._changed(Ri.PROP_NAME,t,s)}}get pathLabel(){return this.getSaveType()||J.uncapitalize(this.outlineLabel)}get displayPath(){return(this._parent?this._parent.displayPath+".":"")+this.pathLabel}get tag(){return this._tag}set tag(t){if(t!=this._tag){const e=this._tag;this._tag=t,this._changed(Ri.PROP_TAG,t,e)}}get isArray(){return!1}get isBand(){return!1}get visible(){return this._visible}set visible(t){t!=this._visible&&(this._visible=t,this._changed(Ri.PROP_VISIBLE,t,!t))}get removable(){return!0}get data(){return this._data}set data(t){if(t!=this._data){const e=this._data;this._data=t,this._changed(Ri.PROP_DATA,t,e)}}get value(){return this._value}set value(t){if(t!=this._value){const e=this._value;this._value=t,this._changed(Ri.PROP_TAG,t,e)}}get hint(){return this._hint}set hint(t){if(t!=this._hint){const e=this._hint;this._hint=t,this._changed(Ri.PROP_HINT,t,e)}}get width(){return this._width}set width(t){if((t=this._validateSize(t))!=this._width){const e=this._width;this._width=t,this._widthDim=new C(t),this._changed(Ri.PROP_WIDTH,t,e)}}get height(){return this._height}set height(t){if((t=this._validateSize(t))!=this._height){const e=this._height;this._height=t,this._heightDim=new C(t),this._changed(Ri.PROP_HEIGHT,t,e)}}get minWidth(){return this._minWidth}set minWidth(t){if(t!=this._minWidth){const e=this._minWidth;this._minWidth=t,this._minWidthDim=new C(t),this._changed(Ri.PROP_MIN_WIDTH,t,e)}}get minHeight(){return this._minHeight}set minHeight(t){if(t!=this._minHeight){const e=this._minHeight;this._minHeight=t,this._minHeightDim=new C(t),this._changed(Ri.PROP_MIN_HEIGHT,t,e)}}get rotation(){return this.canRotate()?this._rotation:void 0}set rotation(t){if((t=isNaN(t)?void 0:t%360)!==this._rotation){const e=this._rotation;this._rotation=t,this._changed(Ri.PROP_ROTATION,t,e)}}get isRotated(){return!isNaN(this.rotation)&&0!==this.rotation}get onGetValue(){return this._onGetValue}set onGetValue(t){if(t!==this._onGetValue){t?(this._valueCallbackFunc=new Function("ctx","item, row, value",t),this._valueCallback=this._valueCallbackDelegate):this._valueCallback===this._valueCallbackDelegate&&(this._valueCallback=null);const e=this._onGetValue;this._onGetValue=t,this._changed(Ri.PROP_ON_GET_VALUE,t,e)}}get valueCallback(){return this._valueCallback}set valueCallback(t){if(t!==this._valueCallback){const e=this._valueCallback;this._valueCallback=t,this._changed(Ri.PROP_ON_GET_VALUE,t,e)}}get styles(){return this._styles}set styles(t){const e=this._styles={};if(t){const s=this._getStyleProps();for(let i of s)i in t&&(e[i]=t[i])}e&&this._arrangePaddingStyles(e)}get styleCallback(){return this._styleCallback}set styleCallback(t){if(t!==this._styleCallback){const e=this._styleCallback;this._styleCallback=t,this._changed(Ri.PROP_STYLE_CALLBACK,t,e)}}get onGetStyles(){return this._onGetStyles}set onGetStyles(t){if(t!==this._onGetStyles){t?(this._styleCallbackFunc=new Function("ctx, item, row, value",t),this._styleCallback=this._styleCallbackDelegate):this._styleCallback===this._styleCallbackDelegate&&(this._styleCallback=null);const e=this._onGetStyles;this._onGetStyles=t,this._changed(Ri.PROP_ON_GET_STYLES,t,e)}}get pageBreak(){return this._pageBreak}set pageBreak(t){if(t!=this._pageBreak){const e=this._pageBreak;this._pageBreak=t,this._changed(Ri.PROP_PAGE_BREAK,t,e)}}get outlineLabel(){return this.name||this.hint}get designText(){return this.outlineLabel}get designLevel(){return 0}get childPropInfos(){return this._childPropInfos}set childPropInfos(t){this._childPropInfos=t}get floating(){return!!this.getFloatingContainer()}get designOrder(){return this._designOrder}set designOrder(t){this._designOrder=t}get designBorder(){return this._designBorder}set designBorder(t){t!==this._designBorder&&(this._designBorder=t,this._changed(Ri.PROP_DESIGN_BORDER,t,!t))}get isRelativeHeight(){return this._heightDim&&!this._heightDim.fixed}get left(){return this.getChildProp("left")}get right(){return this.getChildProp("right")}get top(){return this.getChildProp("top")}get bottom(){return this.getChildProp("bottom")}get row(){return this.getChildProp("row")||0}get col(){return this.getChildProp("col")||0}get equalBlank(){return this.getChildProp("equalBlank")}get blankFields(){return this.getChildProp("blankFields")}get mergedInGroup(){return this.getChildProp("mergedInGroup")}defaultInit(t,e,s,i){this._doDefaultInit(t,e,s,i)}getSaveType(){}getSaveLabel(){return this.getSaveType()}isContextValue(){return this._value&&Le.isValue(this._value)}setChildProp(t,e){if(this._childProps||(this._childProps={}),e!==this._childProps[t]){const s=this._childProps[t];return this.$_setChildProp(t,e),this._changed(t,e,s),!0}}$_setChildProp(t,e){switch(void 0===e?delete this._childProps[t]:this._childProps[t]=e,t){case Ri.PROP_LEFT:this._leftDim=C.create(e);break;case Ri.PROP_RIGHT:this._rightDim=C.create(e);break;case Ri.PROP_TOP:this._topDim=C.create(e);break;case Ri.PROP_BOTTOM:this._bottomDim=C.create(e)}}isChildProp(t){if(this._childPropInfos)for(let e of this._childPropInfos)if(e.name==t)return!0}getChildProp(t,e){const s=this._childProps&&this._childProps[t];return void 0===s?e:s}getChildProps(){return Object.keys(this._childProps).sort()}isStyleProp(t){const e=this._getStyleProps();return e&&e.includes(t)}canParentOf(t){return!1}canAddTo(t){return!!t}prepareLayout(t){this._doPrepareLayout(t)}preparePrint(t){this.prepareLayout(!0),this._doPreparePrint(t)}getLeft(t){return this._leftDim?this._leftDim.getPixel(t):NaN}setLeft(t){if(t!==this._leftDim){const e=this._leftDim;this._leftDim=t,this._changed(Ri.PROP_LEFT,e,t)}}getRight(t){return this._rightDim?this._rightDim.getPixel(t):NaN}setRight(t){if(t!==this._rightDim){const e=this._rightDim;this._rightDim=t,this._changed(Ri.PROP_RIGHT,e,t)}}getTop(t){return this._topDim?this._topDim.getPixel(t):NaN}setTop(t){if(t!==this._topDim){const e=this._topDim;this._topDim=t,this._changed(Ri.PROP_TOP,e,t)}}getBottom(t){return this._bottomDim?this._bottomDim.getPixel(t):NaN}setBottom(t){if(t!==this._bottomDim){const e=this._bottomDim;this._bottomDim=t,this._changed(Ri.PROP_BOTTOM,e,t)}}getWidth(t){return this._widthDim?this._widthDim.getPixel(t):NaN}getHeight(t){return this._heightDim?this._heightDim.getPixel(t):NaN}getMinWidth(t){return this._minWidthDim?this._minWidthDim.getPixel(t):NaN}getMinHeight(t){return this._minHeightDim?this._minHeightDim.getPixel(t):NaN}canSized(){return!0}canResize(t){return!0}canResizeWidth(){return this.canResize(E.LEFT)}canResizeHeight(){return this.canResize(E.TOP)}resize(t,e){return this.canResizeWidth()&&(this.width=t),this.canResizeHeight()&&(this.height=e),this}canRotate(){return!1}hasStyle(t){return this._styles.hasOwnProperty(t)}getStyle(t){return this._styles[t]}setStyle(t,e){const s=this._styles[t];e||(e=void 0),e!==s&&(void 0===e?delete this._styles[t]:this._styles[t]=e,this._changed(t,e,s))}clearStyle(t){if(this._styles.hasOwnProperty(t)){const e=this._styles[t];delete this._styles[t],this._changed(t,void 0,e)}}clearStyles(t){for(let e of this._getStyleProps())t[e]=""}load(t,e){e&&this._doLoad(t,e)}save(t){var e;const s=this.getSaveType();s&&(t.type=s),this._name&&(t.name=this._name);const i=null===(e=this.page)||void 0===e?void 0:e.saveTag;return i&&(t[i]=this),this._doSave(t),this.stylable&&(J.isEmpty(this._styles)||(this._saveProp(t,"styles"),i&&(t.styles[i]=Si.Shared)),this._saveProp(t,"styleCallback")),J.isNotEmpty(t)}getFloatingContainer(){return this instanceof Ni?this:this._parent instanceof Ni?this._parent:void 0}delete(){this._parent&&this._parent.remove(this)}isAncestor(t){let e=this._parent;for(;e;){if(e===t)return!0;e=e._parent}}$_getValue(t,e,s){if(s&&s.indexOf("::")>0)return t.getValue(s,e);if(this._data)return t.getValueAt(this._data,s,e);{const i=this._getParentData();if(i)return t.getValueAt(i,s,e)}}getValue(t,e){var s;const i=null===(s=this.page)||void 0===s?void 0:s.report.data;if(i)return this.$_getValue(i,t,e)}getPrintValue(t,e){return this.$_getValue(t,e,this._value)}_getParentData(){let t=this.dataParent;for(;t;){if(t.data)return t.data;t=t.dataParent}}canRemoveFrom(){return this._parent&&this._parent.canRemove(this)}canAdoptDragSource(t){return!1}adoptDragSource(t){}canPageBreak(){return this.level<=4}isBreakBefore(){return this.canPageBreak()&&(this.pageBreak===v.BEFORE||this.pageBreak==v.BOTH)}isBreakAfter(){return this.canPageBreak()&&(this.pageBreak===v.AFTER||this.pageBreak==v.BOTH)}getInvalids(t){if(this.data){const e=t.designData.get(this.data);if(!e)return['"'+this.data+'" is not a valid data name.'];if(this.value&&e instanceof Qe&&!e.containsField(this.value))return['"'+this.value+'" is not a valid field name.']}}get marqueeParent(){var t;return this||this._parent||(null===(t=this._parent)||void 0===t?void 0:t.marqueeParent)}get printable(){return this.visible}isReadOnlyProperty(t){var e;return!("data"!==t.name||!(null===(e=this.dataParent)||void 0===e?void 0:e.dataDominant))}_sizable(){return!0}_boundable(){return!0}_doDefaultInit(t,e,s,i){}_getSubStyle(t,e){const s=this.getChildProp(t);return s&&s[e]}_setSubStyle(t,e,s){this._childProps||(this._childProps={}),this._childProps[t]||(this._childProps[t]={});let i=this.getChildProp(t);i||(i={},this.setChildProp(t,i));const r=i[e];s!=r&&(void 0===s?delete i[e]:i[e]=s,this._changed(t,s,r))}_doApplyStyle(t,e,s){return!1}_setLeft(t){this._leftDim=new C(t)}_setRight(t){this._rightDim=new C(t)}_setTop(t){this._topDim=new C(t)}_setBottom(t){this._bottomDim=new C(t)}_getEditProps(){let t=Ri.PROPINFOS;return this._sizable()&&(t=t.concat(Ri.SIZE_PROPINFOS)),this._valueable()?t=t.concat(Ri.VALUE_PROPINFOS):this._datable()&&(t=t.concat(Ri.VALUE_PROPINFOS[0])),this._childPropInfos&&(t=t.concat(this._childPropInfos)),t}_getStyleProps(){return[]}_getChildStyleProps(t){return"cellStyles"===t?["cellAlign","backgroundColor","paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeft","borderRight","borderTop","borderBottom"]:[]}_valueable(){return!0}_datable(){return!1}$_attached(t){this._parent!==t&&(this._parent=t,t&&this._doAttached())}_doAttached(){}$_detached(){this._parent&&(this._parent=null,this._doDetached())}_doDetached(){}_isLoading(){const t=this.page;return t&&t.loading}_changed(t,e,s){const i=this.page;i&&!i.loading&&(this._parent&&this._parent.$_childChanged(this,t,e,s),i.$_itemChanged(this,t,e,s))}get stylable(){return!0}_doLoad(t,e){this._loadPropsOf(e,Ri.PROPINFOS),this._valueable()?this._loadPropsOf(e,Ri.VALUE_PROPINFOS):this._datable()&&this._loadPropOf(e,Ri.VALUE_PROPINFOS[0]),this._sizable()&&this._loadPropsOf(e,Ri.SIZE_PROPINFOS),this.stylable&&this._loadProps(e,"styles","styleCallback")}_saveChildPropsOf(t,e){const s=this._childProps;if(s)for(let i of e){const e=i.name,r=s[e];void 0===r||"number"==typeof r&&isNaN(r)||r===i.default||(t[e]=r)}}_doSave(t){this._valueable()?this._savePropsOf(t,Ri.VALUE_PROPINFOS):this._datable()&&this._savePropOf(t,Ri.VALUE_PROPINFOS[0]),this._sizable()&&this._savePropsOf(t,Ri.SIZE_PROPINFOS),this._savePropsOf(t,Ri.PROPINFOS);const e=this._childPropInfos;e&&e.length>0&&this._saveChildPropsOf(t,e)}_doPrepareLayout(t){}_doPreparePrint(t){}}Ri.DEF_DISPLAY_ORDER=99,Ri.PROP_NAME="name",Ri.PROP_TAG="tag",Ri.PROP_LEFT="left",Ri.PROP_RIGHT="right",Ri.PROP_TOP="top",Ri.PROP_BOTTOM="bottom",Ri.PROP_DESIGN_BORDER="designBorder",Ri.PROP_ON_GET_VALUE="onGetValue",Ri.PROP_STYLES="styles",Ri.PROP_ON_GET_STYLES="onGetStyles",Ri.PROP_VISIBLE="visible",Ri.PROP_DATA="data",Ri.PROP_VALUE="value",Ri.PROP_HINT="hint",Ri.PROP_WIDTH="width",Ri.PROP_HEIGHT="height",Ri.PROP_MIN_WIDTH="minWdth",Ri.PROP_MIN_HEIGHT="minHeight",Ri.PROP_LOCKED="locked",Ri.PROP_PAGE_BREAK="pageBreak",Ri.PROP_STYLE_CALLBACK="styleCallback",Ri.PROP_ROTATION="rotation",Ri.DATA_PROP={name:Ri.PROP_DATA,category:Ws.DATA,type:hs,multiple:!1,default:void 0,domain:void 0},Ri.VALUE_PROP={name:Ri.PROP_VALUE,category:Ws.DATA,type:hs,multiple:!1,default:void 0,domain:void 0,validate:(t,e)=>{if(e){if(J.getEnumValues(xi).indexOf(e)>=0)return;if(t.getData()&&t.getDataFieldNames().indexOf(e)<0)throw'"'+e+'"는(은) 타당한 출력 변수 혹은 데이터 필드명이 아닙니다.'}}},Ri.PROPINFOS=[{name:Ri.PROP_NAME,category:Ws.BASIC,type:is,multiple:!1,default:void 0},{name:Ri.PROP_TAG,category:Ws.BASIC,type:is,multiple:!1,default:void 0},{name:Ri.PROP_DESIGN_BORDER,category:Ws.DESIGN,type:as,multiple:!1,default:!0},{name:Ri.PROP_VISIBLE,category:Ws.BASIC,type:as,multiple:!0,default:!0},{name:Ri.PROP_PAGE_BREAK,category:Ws.BASIC,type:As,multiple:!0,default:v.NONE,domain:v,visible:t=>t.canPageBreak()},{name:Ri.PROP_ON_GET_VALUE,category:Ws.EVENT,type:cs,multiple:!1,default:void 0,signature:"(ctx/* PrintContext*/, item/*ReportItem*/, row/*Number*/, value/*any*/)/*any*/",visible:t=>t instanceof Ri&&!(t instanceof Ti)},{name:Ri.PROP_ON_GET_STYLES,category:Ws.EVENT,type:cs,multiple:!1,default:void 0,signature:"(ctx/* PrintContext*/, item/*ReportItem*/, row/*Number*/, value/*any*/)/*any*/"}],Ri.SIZE_PROPINFOS=[{name:Ri.PROP_WIDTH,category:Ws.BOUND,type:os,multiple:!0,default:void 0,visible:t=>t.canSized()},{name:Ri.PROP_HEIGHT,category:Ws.BOUND,type:os,multiple:!0,default:void 0,visible:t=>t.canSized()},{name:Ri.PROP_ROTATION,category:Ws.BOUND,type:rs,default:0,visible:t=>t.canRotate()}],Ri.VALUE_PROPINFOS=[Ri.DATA_PROP,Ri.VALUE_PROP];class Ti extends Ri{constructor(t){super(t),this._items=[],this.layoutChanged=!1}get outlineExpandable(){return!0}get outlineItems(){return this.items}get isChildPropContainer(){return!0}get count(){return this._items.length}get items(){return this._items.slice()}get designWidth(){return this._designWidth}set designWidth(t){if(t!==this._designWidth){const e=this._designWidth;this._designWidth=t,this._changed(Ti.PROP_DESIGN_WIDTH,t,e)}}get designHeight(){return this._designHeight}set designHeight(t){if(t!==this._designHeight){const e=this._designHeight;this._designHeight=t,this._changed(Ti.PROP_DESIGN_HEIGHT,t,e)}}get dataDominant(){return!1}get firstChild(){return this._items[0]}get lastChild(){return this._items[this._items.length-1]}get isDataRowContainer(){return!1}needDesignWidth(){return!0}needDesignHeight(){return!0}get(t){return this._items[t]}canContainsBand(){return!1}canContainsBandGroup(){return!1}contains(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t instanceof Ri){if(this._items.includes(t))return!0;if(e)for(let e of this._items)if(e instanceof Ti&&e.contains(t,!0))return!0}return!1}indexOf(t){return t instanceof Ri&&this._items.indexOf(t)}getNames(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=function(t,i){for(let r=t._items.length-1;r>=0;r--){const n=t._items[r];n.name&&i.push(n.name),e&&n instanceof Ti&&s(n,i)}};return s(this,t=t||[]),t}find(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=this._items;for(let i=s.length-1;i>=0;i--){let r=s[i];if(r.name===t)return r;if(e&&r instanceof Ti&&(r=r.find(t,!0),r))return r}}canAdd(t){return t&&this._items.length<this._maxChildCount()&&t.canAddTo(this)&&!this.contains(t)}append(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.add(t,-1,e)}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t instanceof Ri&&this.canAdd(t)){let i=t.outlineParent;i&&(i instanceof Qi&&(i=i.outlineParent),i instanceof Ti&&i.remove(t)),e<0&&(e=this._items.length);const r=this._addItem(t,e,s);return this._doItemAdded(r,e),this.$_resetIndices(),!0}}canRemove(t){return t instanceof Ri&&t.removable&&this.contains(t)}remove(t){if(t instanceof Ri&&this.canRemove(t)){const e=this._removeItem(t);e>=0&&(this._doItemRemoved(t,e),this.$_resetIndices())}}removeLast(){this.count>0&&this.remove(this.get(this.count-1))}clear(){this._clearItems()}getMoveType(t){}canResizeChild(t,e){return!0}search(t,e,s){for(let i of this._items)if(i instanceof Ti)i.search(t,e,s);else{const r=i.designText;if(r){let n=r;e.caseSensitive||(n=n.toLowerCase()),(e.wholeWord&&n===t||!e.wholeWord&&n.indexOf(t)>=0)&&s.push({item:i,prop:r})}}}canChangeChildProp(t,e,s){return!0}changeChildIndex(t,e){const s=this.indexOf(t);if(s>=0&&s!==e)return this._items.splice(s,1),this._items.splice(e,0,t),this.$_resetIndices(),t._changed("index",e,s),!0}canAlign(t){return!1}canAlignTo(t,e){return!0}filter(t){return this._items.filter(t)}getDescendants(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=[];return function s(i,r){i._items.forEach((i=>{i instanceof Ti?t&&(r.push(i),e&&s(i,r)):r.push(i)}))}(this,s),s}collectInvalids(t,e){this._items.forEach((s=>{const i=s.getInvalids(t);i&&i.forEach((t=>e.push({item:s,reason:t}))),s instanceof Ti&&s.collectInvalids(t,e)}))}collectBlankItems(t){const e=[];return(t||this._items).forEach((t=>{if(t.equalBlank){let s=t.value?[t.value]:[],i=t.blankFields;i&&(s=i.split(",").map((t=>t.trim())).filter((t=>!!t))),s.length&&(e.push(t),t.$_blankFlds=s)}})),e.length>0?e:null}_getEditProps(){return super._getEditProps().concat(Ti.PROPINFOS)}_getStyleProps(){return["paddingLeft","paddingRight","paddingTop","paddingBottom"]}_maxChildCount(){return Number.MAX_SAFE_INTEGER}isAncestorOf(t){if(t===this)return!0;if(this.contains(t))return!0;for(let e of this._items)if(e.isAncestorOf(t))return!0}canParentOf(t){return!0}prepareLayout(t){super.prepareLayout(t);for(let e of this._items)e.prepareLayout(t)}preparePrint(t){super.preparePrint(t);for(let e of this._items)e.preparePrint(t)}_getNameOfItems(){return"items"}_doLoad(t,e){super._doLoad(t,e);const s=this._getNameOfItems();!this._ignoreItems()&&e.hasOwnProperty(s)&&this._loadItems(t,e[s])}_ignoreItems(){return!1}save(t){let e=super.save(t);return!this._ignoreItems()&&this._items.length>0&&(this._saveItems(t[this._getNameOfItems()]=[]),e=!0),e}dataNameChanged(t,e){super.dataNameChanged(t,e),this._items.forEach((s=>s.dataNameChanged(t,e)))}get internalItems(){return this._items}_valueable(){return!1}_loadChildProp(t,e,s){s.hasOwnProperty(e)&&t.setChildProp(e,s[e])}_loadChildProps(t,e,s){for(let i of e)s.hasOwnProperty(i)&&t.setChildProp(i,s[i])}_loadChildPropsOf(t,e,s){for(let i of s)if(i.name in e){const s=e[i.name];t.setChildProp(i.name,s)}}_getChildPropInfos(t){return null}_loadChild(t,e,s){return e.load(t,s),this.isChildPropContainer&&(e.childPropInfos=this._getChildPropInfos(e)),this._doLoadChild(e,s),e}_loadItems(t,e){const s=J.makeArray(e);if(this.clear(),s){const e=this.page,i=[];let r=0;for(let n of s)if(n){let s=t.createItem(n);s&&(s.$_attached(this),s=this._loadChild(t,s,n),!s.parent&&s.$_attached(this),i.push(s),e&&e.$_itemAdded(s,r,!0),this._doItemAdded(s,r++))}i&&i.length>0&&(this._items=i,this.$_resetIndices())}}_doLoadChild(t,e){}_saveItems(t){this._doSaveItems(t,this._items)}_doSaveItems(t,e){for(let s of e){const e={};s.save(e),t.push(e)}}_addItem(t,e,s){const i=this.page,r=this._items;return e=Math.max(0,Math.min(r.length,e)),r.splice(e,0,t),this.isChildPropContainer&&(t.childPropInfos=this._getChildPropInfos(t)),t.$_attached(this),i&&i.$_itemAdded(t,e,s),t}_removeItem(t){const e=t?this._items.indexOf(t):-1;if(e>=0){const s=this.page,i=t.parent;return this._items.splice(e,1),t.$_detached(),s&&s.$_itemRemoved(t,i),e}return-1}_clearItems(){if(this._items.length>0){const t=this.page,e=this._items.slice();this._items=[];for(let t of e)t.$_detached();t&&t.$_itemsRemoved(e)}}_doItemAdded(t,e){}_doItemRemoved(t,e){}$_resetIndices(){for(let t=this._items.length-1;t>=0;t--)this._items[t]._index=t}$_childChanged(t,e,s,i){this._doItemChanged(t,e,s,i)}_doItemChanged(t,e,s,i){}_setOutlineOrders(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];for(let e of s)e.outlineOrder=t++}}Ti.PROP_DESIGN_WIDTH="designWidth",Ti.PROP_DESIGN_HEIGHT="designHeight",Ti.PROPINFOS=[{name:Ti.PROP_DESIGN_WIDTH,category:Ws.DESIGN,type:ns,multiple:!1,default:void 0,visible:t=>t.needDesignWidth()},{name:Ti.PROP_DESIGN_HEIGHT,category:Ws.DESIGN,type:ns,multiple:!1,default:void 0,visible:t=>t.needDesignHeight()}];class Oi extends Ii{constructor(t,e){super(),this._collection=t,e&&this.load(e),this._styles||(this._styles={})}get outlineParent(){return this._collection}get outlineExpandable(){return!1}get outlineLabel(){return"["+this.index+"] "+this.itemType}getSaveType(){return""}canRemoveFrom(){return!0}getPropDomain(t){return null}getStyleProps(){const t=this._getStyleProps(),e=[];for(let s of t)e.push(Bi[s]);return e}getStyle(t){return this._styles[t]}setStyle(t,e){const s=this._styles[t];e!==s&&(void 0===e?delete this._styles[t]:this._styles[t]=e,this._changed(t,e,s))}getStyleProperty(t){return this._styles[t]}setStyleProperty(t,e){const s=this.page;if(s){this._styles[t]!==e&&s.report.setItemStyle(this,t,e)}else this.setStyle(t,e)}getSubStyleProps(t){return null}getPlaceHolder(t){}setItemsProperty(t,e,s){}getSubStyleProperty(t,e){}isChildProp(t){return!1}setSubStyleProperty(t,e,s){}setItemsSubStyleProperty(t,e,s,i){}canPropAdoptDragSource(t,e){return!1}adoptPropDragSource(t,e){}isCollectionItem(){return!0}get styles(){return this._styles}set styles(t){const e=this._styles={};if(t){const s=this._getStyleProps();for(let i of s)i in t&&(e[i]=t[i])}e&&this._arrangePaddingStyles(e)}load(t){this._doLoad(t)}save(t){return this._doSave(t),t}get collection(){return this._collection}get level(){return this._collection?this._collection.level+1:0}_doLoad(t){t.hasOwnProperty("styles")&&(this.styles=t.styles)}_doSave(t){J.isEmpty(this._styles)||this._saveProp(t,"styles")}_changed(t,e,s){var i;null===(i=this._collection)||void 0===i||i._itemChanged(this,t,e,s)}}class Fi extends Ii{canRemoveFrom(){return!1}canParentOf(t){return!1}getEditProps(){return[]}getStyleProps(){return[]}getSubStyleProps(t){return null}getPlaceHolder(t){}getPropDomain(t){return null}getProperty(t){}setProperty(t,e){}setItemsProperty(t,e,s){}getStyleProperty(t){}getStyle(t){}setStyle(t,e){}setStyleProperty(t,e){}setItemsStyleProperty(t,e,s){}isChildProp(t){return!1}getSubStyleProperty(t,e){}setSubStyleProperty(t,e,s){}setItemsSubStyleProperty(t,e,s,i){}canPropAdoptDragSource(t,e){return!1}adoptPropDragSource(t,e){}isCollectionProp(){return!0}getPropertySources(){return this.items}preparePrint(t){this._doPreparePrint(t);for(let e=this.count-1;e>=0;e--){const s=this.get(e);s instanceof Ri&&s.preparePrint(t)}}forEach(t){for(let e=0,s=this.count;e<s;e++)t(this.get(e),e)}moveItem(t,e){if(t!==e&&t>=0&&t<this.count&&e>=0&&e<this.count&&this._doMoveItem(t,e))return this._indexChanged(),!0}get styles(){return null}_itemChanged(t,e,s,i){var r;null===(r=this.page)||void 0===r||r.$_itemChanged(t,e,s,i)}_itemAdded(t){const e=this.page;e&&e.$_itemAdded(t,t.index,!1)}_itemsAdded(t){const e=this.page;e&&e.$_itemsAdded(t,t[0].index)}_itemRemoved(t,e){const s=this.page;s&&s.$_itemRemoved(t,e)}_itemsRemoved(t){const e=this.page;e&&e.$_itemsRemoved(t)}_indexChanged(){const t=this.page;t&&t.$_collectionChanged(this)}_doPreparePrint(t){}}var Di,Li;!function(t){t.CENTER="center",t.LEFT="left",t.RIGHT="right",t.TOP="top",t.BOTTOM="bottom",t.INNER_LEFT="innerLeft",t.INNER_RIGHT="innerRight",t.INNER_TOP="innerTop",t.INNER_BOTTOM="innerBottom"}(Di||(Di={}));class Ni extends Ti{constructor(t){super(t),this._anchorPosition=Di.CENTER,this.designWidth=80,this.designHeight=80}get anchorTarget(){return this._anchorTarget}set anchorTarget(t){if(t!=this._anchorTarget){const e=this._anchorTarget;this._anchorTarget=t,this._changed(Ni.PROP_ANCHOR_TARGET,t,e)}}get anchorPosition(){return this._anchorPosition}set anchorPosition(t){if(t!=this._anchorPosition){const e=this._anchorPosition;this._anchorPosition=t,this._changed(Ni.PROP_ANCHOR_POSITION,t,e)}}getSaveType(){return"floating"}get outlineLabel(){return"[Floating]"}_maxChildCount(){return 1}_boundable(){return!1}_getEditProps(){return super._getEditProps().concat(Ni.PROPINFOS)}getPropDomain(t){return t.name===Ni.PROP_ANCHOR_TARGET?this.outlineParent.getNames([void 0],!0):super.getPropDomain(t)}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=Math.min(s||100,100),this.height=100}_doLoad(t,e){super._doLoad(t,e),!e.hasOwnProperty("items")&&e.hasOwnProperty("item")&&this._loadItems(t,e.item),this._loadPropsOf(e,Ni.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ni.PROPINFOS)}canAdd(t){return super.canAdd(t)&&!(t instanceof Ni)}}Ni.PROP_ANCHOR_TARGET="anchorTarget",Ni.PROP_ANCHOR_POSITION="anchorPosition",Ni.PROPINFOS=[{name:Ni.PROP_ANCHOR_TARGET,category:"Floating",type:ls,multiple:!1,default:void 0},{name:Ni.PROP_ANCHOR_POSITION,category:"Floating",type:As,multiple:!1,default:Di.CENTER,domain:Di}],Ni.$_ctor="FloatingContainer",Ni.ITEM_TYPE="Floating Container";class Hi extends Ti{constructor(t){super(t)}_getChildPropInfos(t){return t._boundable()?Hi.CHILD_PROPS:null}_doLoadChild(t,e){super._doLoadChild(t,e),this._loadChildPropsOf(t,e,Hi.CHILD_PROPS)}}Hi.CHILD_PROPS=[{name:Ri.PROP_LEFT,category:Ws.BOUND,type:ns,multiple:!0,default:void 0,domain:void 0},{name:Ri.PROP_RIGHT,category:Ws.BOUND,type:ns,multiple:!0,default:void 0,domain:void 0},{name:Ri.PROP_TOP,category:Ws.BOUND,type:ns,multiple:!0,default:void 0,domain:void 0},{name:Ri.PROP_BOTTOM,category:Ws.BOUND,type:ns,multiple:!0,default:void 0,domain:void 0}];class Qi extends Ti{constructor(t,e){super(e),Z(!!t),this._addItem(this._item=t,0,!0)}get item(){return this._item}get isEmpty(){return!this._item}get isChildPropContainer(){return!1}set childPropInfos(t){this._item.childPropInfos=t}get printable(){return!this._item||this._item.printable}_maxChildCount(){return 1}_doItemChanged(t,e,s,i){this.outlineParent._doItemChanged(t,e,s,i)}}class Ui extends Ti{constructor(t){super(t),this.noPrepareCell=!1}contains(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(super.contains(t))return!0;if(!(t instanceof Qi))for(let s of this._items){const i=s.item;if(i){if(i===t)return!0;if(e&&i instanceof Ti&&i.contains(t))return!0}}}indexOf(t){let e=super.indexOf(t);if(e<=0&&!(t instanceof Qi)){const s=this._items;for(let i=s.length-1;i>=0;i--)if(s[i].item===t){e=i;break}}return e}findCell(t){for(let e of this.internalItems)if(e.item===t)return e}find(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=this.internalItems;for(let i=s.length-1;i>=0;i--){let r=s[i].item;if(r.name===t)return r;if(e&&r instanceof Ti&&(r=r.find(t,!0),r))return r}}_loadChild(t,e,s){return super._loadChild(t,e,s),this.noPrepareCell||(e=this._prepareCellGroup(e)),e}_addItem(t,e,s){return t=this._prepareCellGroup(t),super._addItem(t,e,s)}_removeItem(t){const e=this._unprepareCellGroup(t);if(e){let s=super._removeItem(e);if(s>=0&&t.outlineParent===e)return e._removeItem(t),s}return-1}_unprepareCellGroup(t){return this.findCell(t)}}!function(t){t.ACROSS_DOWN="acrossDown",t.DOWN_ACROSS="downAcross"}(Li||(Li={}));class Mi extends je{constructor(t,e,s){super(t,s),this._modelChanged=!0,this._rotation=0,this._model=e,this._doModelChanged(null)}_doDispose(){this._model=null,super._doDispose()}get model(){return this._model}set model(t){if(t!==this._model){const e=this._model;this._model=t,this._modelChanged=!0,this._doModelChanged(e)}}get navigableParent(){let t=this.parent;for(;t;){if(t instanceof ki)return t.navigable?t:t.navigableParent;t=t.parent}}get modelParent(){let t=this.parent;for(;t;){if(t instanceof ki&&t.model===this._model.outlineParent)return t;t=t.parent}return null}get marqueeParent(){var t;const e=null===(t=this.model)||void 0===t?void 0:t.marqueeParent;if(e){let t=this;for(;t;){if(t instanceof Mi&&t.model===e)return t;t=t.parent}}return this}get designable(){return!0}get editable(){return!1}get isSpace(){return!1}get isRelativeHeight(){return this._model.isRelativeHeight}get rotation(){return this._rotation}setRotation(t){t!==this._rotation&&this.$_setRotation(this._rotation=t)}_clearDesign(){this._designView&&(J.remove(this._designView),this._designView=null),super._clearDesign()}getEditText(){return""}setEditText(t,e){}refreshPrintValues(t){}get printable(){return!this._model||this._model.printable}_initDom(t,e){super._initDom(t,e),this.designable&&(this._designView=t.createElement("div"),this._designView.className="rr-design-back",e.appendChild(this._designView),this._bindMarker=t.createElement("span"),this._bindMarker.className="rr-bind-marker",this._designView.appendChild(this._bindMarker))}_setBindMarker(){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?(this._bindMarker.dataset.vis="1",t?this._bindMarker.dataset.sys="1":delete this._bindMarker.dataset.sys):delete this._bindMarker.dataset.vis}_doPrepareMeasure(t,e){const s=this._model;if(s){if(s.stylable){if(!t.printing){if(this._prevStyles){const t=e.style;for(let e in this._prevStyles)t[e]=""}this._prevStyles=s.styles&&{...s.styles}}this._doSetStyles(s,e)}if(t.printing){e.dataset._m_=s.shash,t.report&&(t.report.models[s.shash]=s);const i=s.styleCallback;if(i)try{const r=this.getPrintValue(t,s),n=i(t,s,t.row,r);n&&J.extend(e.style,n)}catch(t){console.error("StyleCallback Error",t)}e.dataset.row=t.row+""}e.title=s.hint||""}}$_setRotation(t){const e=this.dom;isNaN(t)||0===t?(e.style.transform="",this._rotation=0):(e.style.transformOrigin="center",e.style.transform=0===t?"":"rotate("+t+"deg)",this._rotation=t)}_doAfterMeasure(t,e,s,i,r){const n=this._model;if(n){const t=n.getWidth(s),e=n.getHeight(i);isNaN(t)||(r.width=t),isNaN(e)||(r.height=e)}const o=n.canRotate()?n.rotation:void 0;this.$_setRotation(o)}findElement(t){return this._model&&t&&this._model.name===t?this:null}findElementOf(t){return this.isDom(t)?this:null}getPrintValue(t,e,s){let i,r=e.value;switch(r){case xi.NO:case xi._NO:if(t.row>=0)return t.row+1;break;case xi.ROW:case xi._ROW:if(t.row>=0)return t.row;break;case xi.INDEX:case xi._INDEX:return isNaN(t.band.rowIndex)?t.index:t.band.rowIndex;case xi.INO:case xi._INO:return(isNaN(t.band.rowIndex)?t.index:t.band.rowIndex)+1;default:r&&t.dp&&(i=e.getPrintValue(t.dp,t.row))}const n=this._runValueCallback(t,e,i);return void 0!==n&&(i=n),void 0!==i?i:s}_doModelChanged(t){}_setX(t,e){t.style.left=e+"px"}_setY(t,e){t.style.top=e+"px"}_setPos(t,e,s){t.style.left=e+"px",t.style.top=s+"px"}_runValueCallback(t,e,s){if(!t.noValueCallback){const i=e.valueCallback;if(i){const r=i(t,e,t.row,s);if(void 0!==r)return r}}}}class ki extends Mi{constructor(t,e,s){super(t,e,s),this._padLeft=0,this._padRight=0,this._padTop=0,this._padBottom=0,this._borderApplied=!1,this.measureFixed=!1}_doDispose(){this._floatings&&(this._floatings=null),super._doDispose()}get navigable(){return!0}get lazyLayoutChildren(){return!1}isContentDom(t){return t===this._contentBox}findElement(t){let e=super.findElement(t);if(!e){const s=this._getItemsParent();for(let i=0,r=s.childCount;i<r;i++){if(e=s.getChild(i).findElement(t),e)break}}return e}findElementOf(t){let e=super.findElementOf(t);if(!e){const s=this._getItemsParent();for(let i=0,r=s.childCount;i<r;i++){const r=s.getChild(i);if(r instanceof Mi&&(e=r.findElementOf(t),e))break}}return e||t!==this._contentBox?e:this}getElementOf(t){if(t===this.model)return this;const e=this._getItemsParent();for(let s=0,i=e.childCount;s<i;s++){const i=e.getChild(s);if(i instanceof Mi&&i.model===t)return i;if(i instanceof ki){const e=i.getElementOf(t);if(e)return e}if(i instanceof Ye&&i.isViewOf(t))return i}}indexOfElement(t){return this._getItemsParent().indexOf(t)}getLeaves(){const t=[];return function t(e,s){for(let i=0,r=e.childCount;i<r;i++){const r=e.getChild(i);r instanceof ki?t(r,s):r instanceof Mi&&s.push(r)}}(this._getItemsParent(),t),t}getFirst(){const t=this._getItemsParent();for(let e=0,s=t.childCount;e<s;e++){const s=t.getChild(e);if(s.visible&&s instanceof Mi)return s}return this}getLast(){const t=this._getItemsParent();for(let e=t.childCount-1;e>=0;e--){const s=t.getChild(e);if(s.visible&&s instanceof Mi)return s}return this}_getPrev(t){const e=this._getItemsParent(),s=e.indexOf(t);return s>0?e.getChild(s-1):t}_getNext(t){const e=this._getItemsParent(),s=e.indexOf(t);return s<e.childCount-1?e.getChild(s+1):t}getPrev(t){return this._getPrev(t)}getNext(t){return this._getNext(t)}getLeft(t){return this._getPrev(t)}getRight(t){return this._getNext(t)}getUpper(t){return this._getPrev(t)}getLower(t){return this._getNext(t)}itemOfDom(t){if(this.isDom(t))return this.model;const e=this._getElements();if(e)for(let s of e){if(s instanceof ki){const e=s.itemOfDom(t);if(e)return e}if(s instanceof Mi&&s.containsDom(t))return s.model}}setFixedSize(t){return this.width=t,this.measureFixed=!0,this}isDom(t){return super.isDom(t)||t===this._contentBox}_initDom(t,e){if(super._initDom(t,e),this._needContentBox()){const s=this._contentBox=t.createElement("div"),i=s.style;s.className="rr-content-box",i.position="absolute",i.boxSizing="border-box",i.left="0",i.top="0",i.width="100%",i.height="100%",e.appendChild(s)}}replaceDom(t){super.replaceDom(t),this._needContentBox()&&(this._contentBox=t.getElementsByClassName("rr-content-box")[0])}refreshPrintValues(t){for(let e=0;e<this.childCount;e++){const s=this.getChild(e);s instanceof Mi&&s.refreshPrintValues(t)}}_getItemViews(){const t=this._getElements(),e=[];for(let s of t)s instanceof Mi&&e.push(s);return e}_getParentDom(){return this._contentBox||this._dom}_getItemsParent(){return this}_needContentBox(){return!0}_needDesignBox(){return!1}_applyPaddings(t,e){const s=getComputedStyle(t),i=this._padTop=J.toInt(s.paddingTop)+J.toInt(s.borderTopWidth),r=this._padBottom=J.toInt(s.paddingBottom)+J.toInt(s.borderBottomWidth),n=this._padLeft=J.toInt(s.paddingLeft)+J.toInt(s.borderLeftWidth),o=this._padRight=J.toInt(s.paddingRight)+J.toInt(s.borderRightWidth);i>0&&(e.height+=i),r>0&&(e.height+=r),n>0&&(e.width+=n),o>0&&(e.width+=o),this._borderApplied=!0}_applyBorders(t,e){if(!this._borderApplied){const s=getComputedStyle(t),i=this._padTop+=J.toInt(s.borderTopWidth),r=this._padBottom+=J.toInt(s.borderBottomWidth),n=this._padLeft+=J.toInt(s.borderLeftWidth),o=this._padRight+=J.toInt(s.borderRightWidth);i>0&&(e.height+=i),r>0&&(e.height+=r),n>0&&(e.width+=n),o>0&&(e.width+=o),this._borderApplied=!0}}_isEmpty(){return this._getItemsParent().childCount<1}_isFocused(){return this.container.focusedElement===this}_isItemFocused(t){return this.container.focusedItem===t}_isItemSelected(t){return this.container._selection.contains(t)}_getFocusedItem(){return this.container.focusedItem}_doMeasure(t,e,s,i){const r=t.printing,n=this.model,o=t.reportView,a=this._getItemsParent();(this._modelChanged||o._modelDirty||n.layoutChanged)&&(a.clear(),this._buildItems(t,o,n),this._modelChanged=!1,n.layoutChanged=!1);const A=this.measureFixed?this.width:J.pickNum(this._modelWidth,s),l=a.childCount;for(let e=0;e<l;e++){const s=a.getChild(e);(s.visible=!r||s.printable)&&(this.lazyLayoutChildren||s.lazyLayout||this._doMeasureItem(t,e,s,A,i))}return new Me(this.offsetWidth,this.offsetHeight)}_doPrepareMeasure(t,e){super._doPrepareMeasure(t,e),this._borderApplied=!1,this._padTop=this._padBottom=this._padLeft=this._padRight=0}_getDesignText(){return this.model.outlineLabel}_setDesignContent(t,e){t?(e.textContent=this._getDesignText(),e.style.paddingLeft=12*this.model.designLevel+"px"):e.textContent=""}_doMeasureItem(t,e,s,i,r){t.printing&&s.resetStyleName(),s.measure(t,i,r)}_createElement(t,e,s){const i=t.$_createElement(s);return this._prepareChild(i),e.addChild(i),i}_buildItems(t,e,s){const i=s&&s.items,r=this._getItemsParent();if(i&&i.length>0)for(let t of i)this._createElement(e,r,t)}_prepareChild(t){}_doLayoutContent(t){const e=t.printing,s=this._getItemsParent(),i=this._padLeft,r=this._padTop,n=s.width-i-this._padRight,o=s.height-r-this._padBottom;this._floatings&&(this._floatings=[]);for(let a=0,A=s.childCount;a<A;a++){const A=s.getChild(a);(A.visible=!e||A.printable)&&((this.lazyLayoutChildren||A.lazyLayout)&&this._doMeasureItem(t,a,A,this.width,this.height),A.resize(A.measuredWidth,A.measuredHeight),A.floating||A.draw(),A.layoutContent(t),A instanceof Mi?A.floating?(this._floatings||(this._floatings=[]),A._nodraw=!0,this._floatings.push(A)):this._layoutItem(t,A,A.model,i,r,n,o):this._layoutChild(t,A,i,r,n,o))}}layoutFloating(t){const e=this._floatings;if(e&&e.length)for(let s=0;s<e.length;s++){const i=e[s];i.visible&&(i._nodraw=!1,this._layoutFloating(t,i,i.model),i.draw())}}_layoutItem(t,e,s,i,r,n,o){}_layoutChild(t,e,s,i,r,n){}_layoutFloating(t,e,s){const i=this.findElement(s.anchorTarget);if(i instanceof Mi){const t=this.container.getDomPosition(this),r=this.container.getDomPosition(i);let n=r.x-t.x,o=r.y-t.y;switch(s.anchorPosition){case Di.INNER_LEFT:o-=(e.height-i.height)/2;break;case Di.LEFT:n-=e.width,o-=(e.height-i.height)/2;break;case Di.INNER_RIGHT:n+=i.width-e.width,o-=(e.height-i.height)/2;break;case Di.RIGHT:n+=i.width,o-=(e.height-i.height)/2;break;case Di.INNER_TOP:n-=(e.width-i.width)/2;break;case Di.TOP:n-=(e.width-i.width)/2,o-=e.height;break;case Di.INNER_BOTTOM:n-=(e.width-i.width)/2,o+=i.height-e.height;break;case Di.BOTTOM:n-=(e.width-i.width)/2,o+=i.height;break;case Di.CENTER:default:n-=(e.width-i.width)/2,o-=(e.height-i.height)/2}return e.dom.$_anc=i.dom,e.dom.$anp=s.anchorPosition,e.move(n,o),void e.setPrintStyles()}}_doAfterLayout(t){if(!t.printing&&this._designView)if(this._needDesignBox()){const t=this._isEmpty();t?this.dom.setAttribute("data-empty","1"):this.dom.removeAttribute("data-empty"),this._setDesignContent(t,this._designView),!1===this.model.designBorder&&(this._designView.style.border="none")}else this._designView.style.display="none"}_doPrint(t,e){super._doPrint(t,e),this.layoutFloating(e)}}const Vi="r",Gi="d",Ki="gh",Wi="gf";class zi extends ki{getSibling(t,e){const s=this.getLines(),i=s.indexOf(t);if(e<0&&i>0||e>0&&i<s.length-1)return s[Math.max(0,Math.min(s.length-1,i+e))]}_getNext(t){const e=this.getLines(),s=e.indexOf(t);if(s<e.length-1)return e[s+1]}_getPrev(t){const e=this.getLines(),s=e.indexOf(t);if(s>0)return e[s-1]}}zi.END_ROW_MESSAGE_CLASS="rr-end-row-message";class $i extends A{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this._pageCount=0,this._page=0,this._detailPageCount=0,this._detailPage=0,this._compositePageCount=0,this._compositePage=0,this.noValueCallback=!1,this.headerHeight=0,this.footerHeight=0,this.reportHeaderHeight=0,this.reportFooterHeight=0,this.bodyTop=0,this.bodyBottom=0,this.bodyHeight=0,this.y=0,this.h=0,this.yBand=0,this.row=-1,this.index=-1,this.contextable=!1,this.contextValues=[],this._userData={row:0},this._tags={},this._bandSave={},this.async=!1,this.reportCount=1,this.reportIndex=0,this.prevPages=0,this._printing=t,this._compositePrinting=e}get printing(){return this._printing}get compositePrinting(){return this._compositePrinting}get dp(){return this._dp}set dp(t){this._dp=t}get designDp(){return this._desingDp}set designDp(t){this._desingDp=t}get assets(){return this._assets}set assets(t){this._assets=t}get reportView(){return this._reportView}set reportView(t){this._reportView=t}get pageWidth(){return this._pageWidth}set pageWidth(t){this._pageWidth=t}get pageHeight(){return this._pageHeight}set pageHeight(t){this._pageHeight=t}get date(){return this._date}get pageCount(){return this._pageCount}get page(){return this._page}get detailPageCount(){return this._detailPageCount}get detailPage(){return this._detailPage}get compositePageCount(){return this._compositePageCount}get compositePage(){return this._compositePage}preparePrint(t){var e;this.contextValues=[],this._date=new Date,this.report=t||(null===(e=this._reportView)||void 0===e?void 0:e.model)}preparePage(t,e){this._page=t,this._compositePage=e}setDetailPage(t,e){this._detailPageCount=t,this._detailPage=e}finishPrint(t){this._pageCount=t}setCompositePageCount(t){this._compositePageCount=t}getUserData(){return this._userData.row=this.row,this._userData}getCurrentValue(t){if("row"===t)return this.row}setTag(t,e){t&&(this._tags[t]=e)}unsetTag(t){delete this._tags[t]}getTag(t,e){const s=this._tags[t];return void 0!==s?s:e}getValue(t,e,s){if(this._dp&&t&&s){const i=this._dp.get(t);if(i)return e>=0||(e=this.row),i instanceof Qe?i.getRowValue(e,s):i.getValue(s)}}saveBand(){this._bandSave=Object.assign({},{y:this.y,h:this.h,yBand:this.yBand,row:this.row,index:this.index})}restoreBand(){Object.assign(this,this._bandSave)}}class Xi{}class ji{setMaxCount(t,e){let s=0,i=0;for(;s<t.length&&i<e;){"number"==typeof t[s++]&&i++}for(;s<t.length&&"number"!=typeof t[s];)s++;t.length=s}isRow(t){return"number"==typeof t}isBand(t){return t instanceof ji}isGroupHeader(t){return t.rowType===Ki}isGroupFooter(t){return t.rowType===Wi}_setX(t,e){t.style.left=e+"px"}_setY(t,e){t.style.top=e+"px"}_setPos(t,e,s){t.style.left=e+"px",t.style.top=s+"px"}_createPage(t,e){const s=t.createElement("div");return s.style.position="relative",e.appendChild(s),s}}class Yi{constructor(t,e){this.name=t,this.data=e,e&&this._parsetData(e)}get isGroup(){return!1}save(t){return(t=t||{}).name=this.name,this._doSave(t),t}_parsetData(t){}_doSave(t){}}class Ji extends Yi{_doSave(t){t.type="img",t.data=this.data,t.description=this.description}}class Zi extends Yi{_doSave(t){t.type="svg",t.data=this.data,t.description=this.description}}class qi extends Yi{_parsetData(t){}_doSave(t){}}class tr extends Yi{_parsetData(t){this.theme=JSON.parse(t)}_doSave(t){t.type="charitst",t.theme=JSON.stringify(this.theme)}}class er extends Yi{_parsetData(t){this.theme=JSON.parse(t)}_doSave(t){t.type="highchart",t.theme=JSON.stringify(this.theme)}}class sr extends Yi{constructor(t){super(t,void 0),this.items=[]}get count(){return this.items.length}get(t){for(let e of this.items)if(e.name==t)return e}save(t){for(let e of this.items)if(!(e instanceof sr)){let s={};e.save(s),J.isNotEmpty(s)&&t.push(s)}}indexOf(t){return this.items.indexOf(t)}get isGroup(){return!0}$_findItem(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=t.indexOf("/");s<0&&(s=t.indexOf("\\"));let i=s>=0?t.substring(0,s):t;for(let r of this.items)if(r.name==i)return!e||r instanceof sr?s>=0&&s<t.length-1&&r instanceof sr?r.$_findItem(t.substr(s+1)):r:this}}class ir extends l{constructor(){super(),this._nameMap={},this._root=new sr("_root_"),this._root.path="/"}_doDispose(){super._doDispose()}get root(){return this._root}load(t){for(let e in t){const s=this.forceGroup(e),i=t[e];for(let t of i)if(t.name&&t.type&&t.data){let e;switch(t.type){case"img":e=this.$_addImage(s,t.name,t.data);break;case"svg":e=this.$_addSvg(s,t.name,t.data);break;case"palette":e=this.$_addPalette(s,t.name,t.data);break;case"chartist":e=this.$_addChartist(s,t.name,t.data);break;case"highchart":e=this.$_addHighchart(s,t.name,t.data)}t.hasOwnProperty("description")&&(e.description=t.description)}}}$_collectGroups(t,e){e.push(t);for(let s of t.items)s instanceof sr&&this.$_collectGroups(s,e)}save(t){const e=[];this.$_collectGroups(this._root,e);for(let s of e){let e=[];s.save(e),t[s.path]=e||[]}}$_checkPath(t){return!t||"/"!=t.charAt(0)&&"\\"!=t.charAt(0)||(t=t.substr(1)),t}get(t){return this._nameMap[t]}getImage(t){const e=this._nameMap[t];if(e instanceof Ji)return e.data}getSvg(t){const e=this._nameMap[t];if(e instanceof Zi)return e.data}getPalette(t){const e=this._nameMap[t];if(e instanceof qi)return e}getChartist(t){const e=this._nameMap[t];if(e instanceof tr)return e}getHighchart(t){const e=this._nameMap[t];if(e instanceof er)return e}findGroup(t){return this.$_findGroup(t)}forceGroup(t){let e=this._root;if(t=this.$_checkPath(t)){const s=t.split(/[\/\\]/);for(let t of s){const s=e.get(t);if(s)s instanceof sr&&(e=s);else{const s=new sr(t);s.path=e.path+(e===this._root?"":"/")+t,s.parent=e,e.items.push(s),e=s}}}return e}addGroup(t,e){const s="string"==typeof t?this.$_findGroup(t):t;return this.$_addGroup(s||this._root,e)}removeGroup(t){const e="string"==typeof t?this.$_findGroup(t):t;if(e&&e!==this._root)return this.$_removeGroup(e),!0}add(t,e){e&&this.$_addItem(t,e)}remove(t){t&&this.$_removeItem(t)}addImage(t,e,s){return this.$_addImage(t,e,s)}addSvg(t,e,s){return this.$_addSvg(t,e,s)}addPalette(t,e,s){return this.$_addPalette(t,e,s)}addCharitst(t,e,s){return this.$_addChartist(t,e,s)}addHighchart(t,e,s){return this.$_addHighchart(t,e,s)}getTree(){const t={name:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Report",editable:!1,tag:this._root};return this.$_parseTree(this._root,t),t}$_parseTree(t,e){if(t.count>0){const s=[];for(let e of t.items)if(e instanceof sr){const t={name:e.name,tag:e,type:"report-asset-group"};this.$_parseTree(e,t),s.push(t)}s.length>0&&(e.children=s)}}getValidName(t){let e=t,s=1;for(;;){let i=!1;for(let r in this._nameMap)if(e===r){e=t+"-"+s++,i=!0;break}if(!i)break}return e}isValidName(t){return!this._nameMap[t]}$_findGroup(t){let e=t?this._root.$_findItem(t):this._root;return e instanceof sr?e:null}$_addGroup(t,e){const s=new sr(e);return s.parent=t,s.path=t.path+(t===this._root?"":"/")+s.name,t.items.push(s),s}$_removeGroup(t){const e=t.parent;e.items.splice(e.items.indexOf(t),1),t.parent=null}$_addItem(t,e){if(e.name in this._nameMap)throw new Error("An asset with the same name alyread exisits: "+e.name);const s=("string"==typeof t?this.$_findGroup(t):t)||this._root;s.items.push(e),e.parent=s,this._nameMap[e.name]=e}$_removeItem(t){const e=t.parent,s=e.items.indexOf(t);s>=0&&(e.items.splice(s,1),delete this._nameMap[t.name])}$_addImage(t,e,s){const i=new Ji(e,s);return this.$_addItem(t,i),i}$_addSvg(t,e,s){const i=new Zi(e,s);return this.$_addItem(t,i),i}$_addPalette(t,e,s){const i=new qi(e,s);return this.$_addItem(t,i),i}$_addChartist(t,e,s){const i=new tr(e,s);return this.$_addItem(t,i),i}$_addHighchart(t,e,s){const i=new er(e,s);return this.$_addItem(t,i),i}}class rr extends Hi{constructor(t){super(t),this._overflow=!1}get overflow(){return this._overflow}set overflow(t){t!==this._overflow&&(this._overflow=t,this._changed(rr.PROP_OVERFLOW,t,!t))}get outlineLabel(){return"[Stack]"}getSaveType(){return"stack"}_datable(){return!0}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=Math.min(s||300,300),this.height=100}_getStyleProps(){return rr.STYLE_PROPS}canAlign(t){return!0}canAdoptDragSource(t){return t instanceof Ji}getMoveType(t){return Pi.INNER}}rr.PROP_OVERFLOW="overflow",rr.PROPINFOS=[{name:rr.PROP_OVERFLOW,category:Ws.BOX,type:as,multiple:!1,default:!1}],rr.$_ctor="StackContainer",rr.ITEM_TYPE="Stack Container",rr.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"];class nr extends rr{constructor(t){super(t)}get removable(){return!1}get page(){return this.outlineParent}canMove(){return!1}getSaveType(){}canResize(t){return t===E.TOP||t===E.BOTTOM}_getStyleProps(){const t=super._getStyleProps();return[].concat(t)}}class or extends nr{constructor(t){super(t)}get spaceTop(){return this._spaceTop}set spaceTop(t){(t=J.toNumber(parseFloat(t)))!=this._spaceTop&&(this._spaceTop=t,this._changed(or.PROP_SPACE_TOP,t,!t))}get spaceBottom(){return this._spaceBottom}set spaceBottom(t){(t=J.toNumber(parseFloat(t)))!=this._spaceBottom&&(this._spaceBottom=t,this._changed(or.PROP_SPACE_BOTTOM,t,!t))}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,or.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,or.PROPINFOS)}_getEditProps(){return super._getEditProps().concat(or.PROPINFOS)}}or.PROP_SPACE_TOP="spaceTop",or.PROP_SPACE_BOTTOM="spaceBottom",or.PROPINFOS=[{name:or.PROP_SPACE_TOP,category:"Section",type:rs,multiple:!1,default:void 0},{name:or.PROP_SPACE_BOTTOM,category:"Section",type:rs,multiple:!1,default:void 0}];class ar extends or{constructor(){super("reportHeader"),this.designHeight=20}get outlineLabel(){return"Report Header"}get pathLabel(){return"reportHeader"}canResize(t){return t===E.BOTTOM}}ar.$_ctor="ReportHeader";class Ar extends or{constructor(){super("reportFooter"),this._alignToBottom=!1,this.designHeight=20}get alignToBottom(){return this._alignToBottom}set alignToBottom(t){t!=this._alignToBottom&&(this._alignToBottom=t,this._changed(Ar.PROP_ALIGN_TO_BOTTOM,t,!t))}get outlineLabel(){return"Report Footer"}get pathLabel(){return"reportFooter"}canResize(t){return t===E.TOP}_getEditProps(){return super._getEditProps().concat(Ar.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Ar.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ar.PROPINFOS)}}Ar.PROP_ALIGN_TO_BOTTOM="alignToBottom",Ar.PROPINFOS=[{name:Ar.PROP_ALIGN_TO_BOTTOM,category:Ws.BOUND,type:as,multiple:!0,default:!1,domain:void 0}],Ar.$_ctor="ReportFooter";class lr extends or{constructor(){super("pageHeader"),this.designHeight=20}get outlineLabel(){return"Page Header"}get pathLabel(){return"pageHeader"}canResize(t){return t===E.BOTTOM}}lr.$_ctor="PageHeader";class hr extends or{constructor(){super("pageFooter"),this.designHeight=20}get outlineLabel(){return"Page Footer"}get pathLabel(){return"pageFooter"}canResize(t){return t===E.TOP}}hr.$_ctor="PageFooter";class dr extends Hi{constructor(t,e){super(t),this._label=e}get outlineLabel(){return this._label}get isArray(){return!0}canResize(t){return!1}_doLoad(t,e){this._loadItems(t,e)}_doSave(t){this._saveItems(t)}}dr.$_ctor="PageItemContainer";class cr extends Ri{constructor(t){super(t),this._wrap=!1,this._multiLine=!1,this._booleanFormat="False:True",this._numberFormat="#,##0",this._dateFormat="yyyy.MM.dd"}get wrap(){return this._wrap}set wrap(t){t!=this._wrap&&(this._wrap=t,this._changed(ur.PROP_WRAP,t,!t))}get multiLine(){return this._multiLine}set multiLine(t){t!=this._multiLine&&(this._multiLine=t,this._changed(ur.PROP_MULTI_LINE,t,!t))}get booleanFormat(){return this._booleanFormat}set booleanFormat(t){if(t!=this._booleanFormat){const e=this._booleanFormat;this._booleanFormat=t,this._changed(ur.PROP_BOOLEAN_FORMAT,t,e)}}get numberFormat(){return this._numberFormat}set numberFormat(t){if(t!=this._numberFormat){const e=this._numberFormat;this._numberFormat=t,this._changed(ur.PROP_NUMBER_FORMAT,t,e)}}get dateFormat(){return this._dateFormat}set dateFormat(t){if(t!=this._dateFormat){const e=this._dateFormat;this._dateFormat=t,this._changed(ur.PROP_DATE_FORMAT,t,e)}}get textFormat(){return this._textFormat}set textFormat(t){if(t!=this._textFormat){const e=this._textFormat;this._textFormat=t,this._changed(ur.PROP_TEXT_FORMAT,t,e)}}get prefix(){return this._prefix}set prefix(t){if(t!=this._prefix){const e=this._prefix;this._prefix=t,this._changed(ur.PROP_TEXT_PREFIX,t,e)}}get suffix(){return this._suffix}set suffix(t){if(t!=this._suffix){const e=this._suffix;this._suffix=t,this._changed(ur.PROP_TEXT_SUFFIX,t,e)}}_getEditProps(){return super._getEditProps().concat(cr.PROPINFOS)}_getStyleProps(){return cr.STYLE_PROPS}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,cr.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,cr.PROPINFOS)}_doApplyStyle(t,e,s){return"verticalAlign"===t||"scale"==t&&(s[t="transform"]="scale("+e+")",!0)}canRotate(){return!0}canAdoptDragSource(t){return t instanceof Fe}adoptDragSource(t){if(t instanceof Fe)return{type:Ei.PROP,prop:"value",value:t.data+"::"+t.path}}canPropAdoptDragSource(t,e){return"value"===t.name&&e instanceof Fe}adoptPropDragSource(t,e){if("value"===t.name&&e instanceof Fe)return{type:Ei.PROP,prop:"value",value:e.data+"::"+e.path}}getPrintValue(t,e){return this.isContextValue()?t.getContextValue(this.value):super.getPrintValue(t,e)}}cr.PROP_WRAP="wrap",cr.PROP_MULTI_LINE="multiLine",cr.PROP_BOOLEAN_FORMAT="booleanFormat",cr.PROP_NUMBER_FORMAT="numberFormat",cr.PROP_DATE_FORMAT="dateFormat",cr.PROP_TEXT_FORMAT="textFormat",cr.PROP_TEXT_PREFIX="prefix",cr.PROP_TEXT_SUFFIX="suffix",cr.PROPINFOS=[{name:cr.PROP_WRAP,category:Ws.TEXT,type:as,multiple:!0,default:!1,domain:void 0},{name:cr.PROP_MULTI_LINE,category:Ws.TEXT,type:as,multiple:!0,default:!1,domain:void 0},{name:cr.PROP_BOOLEAN_FORMAT,category:Ws.TEXT,type:is,multiple:!0,default:"False:True"},{name:cr.PROP_NUMBER_FORMAT,category:Ws.TEXT,type:is,multiple:!0,default:"#,##0"},{name:cr.PROP_DATE_FORMAT,category:Ws.TEXT,type:is,multiple:!0,default:"yyyy.MM.dd"},{name:cr.PROP_TEXT_FORMAT,category:Ws.TEXT,type:is,multiple:!0,default:void 0},{name:cr.PROP_TEXT_PREFIX,category:Ws.TEXT,type:is,multiple:!0,default:void 0},{name:cr.PROP_TEXT_SUFFIX,category:Ws.TEXT,type:is,multiple:!0,default:void 0}],cr.STYLE_PROPS=["fontFamily","fontSize","fontStyle","textDecoration","fontWeight","lineHeight","color","backgroundColor","textAlign","verticalAlign","writingMode","scale","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"];class ur extends cr{constructor(t,e){super(t),this._contextValueCallbackDelegate=t=>this._contextValueCallbackFunc(t),e&&(this.text=e)}get text(){return this._text}set text(t){if(t!=this._text){const e=this._text;this._text=t,this._changed(ur.PROP_TEXT,t,e)}}get onGetContextValue(){return this._onGetContextValue}set onGetContextValue(t){if(t!==this._onGetContextValue){t?(this._contextValueCallbackFunc=new Function("ctx",t),this._contextValueCallback=this._contextValueCallbackDelegate):this._contextValueCallback===this._contextValueCallbackDelegate&&(this._contextValueCallback=null);const e=this._onGetContextValue;this._onGetContextValue=t,this._changed(ur.PROP_ON_GET_CONTEXT_VALUE,t,e)}}get contextValueCallback(){return this._contextValueCallback}set contextValueCallback(t){if(t!==this._contextValueCallback){const e=this._contextValueCallback;this._contextValueCallback=t,this._changed(ur.PROP_ON_GET_CONTEXT_VALUE,t,e)}}getSaveType(){return"text"}get outlineLabel(){const t=this.value?"["+this.value+"]":this._text;return"[Text]"+(t?" "+t:"")}get designText(){return this.value||this._text}get pathLabel(){return"text"}isContextValue(){return!!this._contextValueCallback||super.isContextValue()}_getEditProps(){return super._getEditProps().concat(ur.PROPINFOS)}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.text="Text"}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,ur.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,ur.PROPINFOS)}}ur.PROP_MULTI_LINE="multiLine",ur.PROP_TEXT="text",ur.PROP_ON_GET_CONTEXT_VALUE="onGetContextValue",ur.PROPINFOS=[{name:ur.PROP_TEXT,category:Ws.TEXT,type:is,multiple:!1,default:void 0},{name:ur.PROP_ON_GET_CONTEXT_VALUE,category:Ws.EVENT,type:cs,multiple:!1,default:void 0,signature:"(ctx/*PrintContext*/)/*any*/"}],ur.$_ctor="TextItem",ur.ITEM_TYPE="Text";class pr extends Ri{constructor(t){super(t),this.size=10}get size(){return this._size}set size(t){if((t=this._validateSize(t))!=this._size){const e=this._size;this._size=t,this._sizeDim=new C(t),this._changed(pr.PROP_SIZE,t,e)}}getSize(t){return this._sizeDim.getPixel(t)}getSaveType(){return"space"}get outlineLabel(){return"[Space] "+this.size}_sizable(){return!1}_boundable(){return!1}_getEditProps(){return super._getEditProps().concat(pr.PROPINFOS)}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.size=10}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,pr.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,pr.PROPINFOS)}canAddTo(t){return t instanceof gr}}var _r;pr.PROP_SIZE="size",pr.PROPINFOS=[{name:pr.PROP_SIZE,category:Ws.BOUND,type:ns,multiple:!1,default:void 0}],pr.$_ctor="SpaceItem",pr.ITEM_TYPE="Space",function(t){t.START="start",t.MIDDLE="middle",t.END="end"}(_r||(_r={}));class gr extends Ti{constructor(t){super(t),this._overflow=!1,this.itemGap=4}get itemsAlign(){return this._itemsAlign}set itemsAlign(t){if(t!==this._itemsAlign){const e=this._itemsAlign;this._itemsAlign=t,this._changed(gr.PROP_ITEMS_ALIGN,t,e)}}get itemGap(){return this._itemGap}set itemGap(t){if(J.isNotDefined(t)&&(t=0),t!=this._itemGap){const e=this._itemGap;this._itemGap=t,this._itemGapDim=J.isNotDefined(t)?null:new C(t),this._changed(gr.PROP_ITEM_GAP,t,e)}}get overflow(){return this._overflow}set overflow(t){t!==this._overflow&&(this._overflow=t,this._changed(gr.PROP_OVERFLOW,t,!t))}getItemGap(t){return this._itemGapDim?this._itemGapDim.getPixel(t):0}loadProps(t){this._loadPropsOf(t,gr.PROPINFOS)}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(gr.PROPINFOS)}_getStyleProps(){return gr.STYLE_PROPS}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,gr.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,gr.PROPINFOS)}canAlign(t){return!0}canAdoptDragSource(t){return t instanceof Ji}}gr.PROP_ITEMS_ALIGN="itemsAlign",gr.PROP_ITEM_GAP="itemGap",gr.PROP_OVERFLOW="overflow",gr.PROPINFOS=[{name:gr.PROP_ITEMS_ALIGN,category:Ws.BOX,type:As,multiple:!1,default:void 0,domain:_r},{name:gr.PROP_ITEM_GAP,category:Ws.BOX,type:ns,multiple:!1,default:void 0},{name:gr.PROP_OVERFLOW,category:Ws.BOX,type:as,multiple:!1,default:!1}],gr.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"];class fr extends gr{constructor(t){super(t),this._child_top=NaN,this._child_bottom=NaN,this.designHeight=50,this.designWidth=300}getTopOf(t){return t.getChildProp(Ri.PROP_TOP,this._child_top)}setTopOf(t,e){t.setChildProp(Ri.PROP_TOP,e)}getBottomOf(t){return t.getChildProp(Ri.PROP_BOTTOM,this._child_bottom)}setBottomOf(t,e){t.setChildProp(Ri.PROP_BOTTOM,e)}getSaveType(){return"rbox"}get outlineLabel(){return"[Row Box]"}_getChildPropInfos(t){return t._boundable()?fr.CHILD_PROPS:null}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=Math.min(s||300,300),this.height=50}_doLoadChild(t,e){super._doLoadChild(t,e),this._loadChildPropsOf(t,e,fr.CHILD_PROPS)}canAlignTo(t,e){return"top"===e||"bottom"===e}canResizeChild(t,e){return t instanceof pr?e===E.RIGHT:E.isIn(e,E.RIGHT,E.TOP,E.BOTTOM,E.TOP_RIGHT,E.BOTTOM_RIGHT)}}fr.CHILD_PROPS=[{name:Ri.PROP_TOP,category:Ws.BOUND,type:ns,multiple:!0,default:void 0,domain:void 0},{name:Ri.PROP_BOTTOM,category:Ws.BOUND,type:ns,multiple:!0,default:void 0,domain:void 0}],fr.$_ctor="RowBoxContainer",fr.ITEM_TYPE="Row Box";class mr extends gr{constructor(t){super(t),this._child_left=NaN,this._child_right=NaN,this.designWidth=100,this.designHeight=100}getLeftOf(t){return t.getChildProp(Ri.PROP_LEFT,this._child_left)}setLeftOf(t,e){t.setChildProp(Ri.PROP_LEFT,e)}getRightOf(t){return t.getChildProp(Ri.PROP_RIGHT,this._child_right)}setRightOf(t,e){t.setChildProp(Ri.PROP_RIGHT,e)}getSaveType(){return"cbox"}get outlineLabel(){return"[Column Box]"}get pathLabel(){return"cbox"}_getChildPropInfos(t){return t._boundable()?mr.CHILD_PROPS:null}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=Math.min(s||100,100),this.height=100}_doLoadChild(t,e){super._doLoadChild(t,e),this._loadChildPropsOf(t,e,mr.CHILD_PROPS)}canAlignTo(t,e){return"left"===e||"right"===e}canResizeChild(t,e){return t instanceof pr?e===E.BOTTOM:E.isIn(e,E.BOTTOM,E.LEFT,E.RIGHT,E.BOTTOM_LEFT,E.BOTTOM_RIGHT)}}mr.CHILD_PROPS=[{name:Ri.PROP_LEFT,category:Ws.BOUND,type:ns,multiple:!0,default:void 0,domain:void 0},{name:Ri.PROP_RIGHT,category:Ws.BOUND,type:ns,multiple:!0,default:void 0,domain:void 0}],mr.$_ctor="ColumnBoxContainer",mr.ITEM_TYPE="Column Box";class wr extends Ti{constructor(t){super(t),this._reversed=!1,this._lineStyles={},this.designWidth=60,this.designHeight=60}getSubStyleProps(t){if(t===wr.PROP_LINE_STYLES){const e=[];for(let s of wr.LINE_STYLE_PROPS){const i={...Bi[s]};i.parent=t,e.push(i)}return e}return super.getSubStyleProps(t)}_getSubStyle(t,e){return t===wr.PROP_LINE_STYLES?this._lineStyles[e]:super._getSubStyle(t,e)}_setSubStyle(t,e,s){if(t===wr.PROP_LINE_STYLES){const i=this._lineStyles[e];this._lineStyles[e]=s,this._changed(t,s,i)}else super._setSubStyle(t,e,s)}get reversed(){return this._reversed}set reversed(t){t!==this._reversed&&(this._reversed=t,this._changed(wr.PROP_REVERSED,t,!t))}get lineStyles(){return this._lineStyles}set lineStyles(t){const e=this._lineStyles={};if(t){const s=wr.LINE_STYLE_PROPS;for(let i of s)i in t&&(e[i]=t[i])}}get firstItem(){return this._firstItem}get secondItem(){return this._secondItem}getSaveType(){return"dbox"}get outlineLabel(){return"[Diagonal Box]"}_getEditProps(){return super._getEditProps().concat(wr.PROPINFOS)}_datable(){return!0}_getStyleProps(){return wr.STYLE_PROPS}_maxChildCount(){return 2}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=60,this.height=45,this.add(new ur(null,"Text1")),this.add(new ur(null,"Text2"))}_doLoad(t,e){this._firstItem=this._secondItem=null,super._doLoad(t,e),this._loadPropsOf(e,wr.PROPINFOS);const s=e.dpos;if(!isNaN(s))switch(s){case 1:this._firstItem=this.get(0),this._secondItem=null;break;case 2:this._firstItem=null,this._secondItem=this.get(0);break;case 3:this._firstItem=this.get(0),this._secondItem=this.get(1)}}_doSave(t){super._doSave(t),this._savePropsOf(t,wr.PROPINFOS);let e=0;this._firstItem&&(e+=1),this._secondItem&&(e+=2),t.dpos=e}_doItemAdded(t,e){super._doItemAdded(t,e),this._firstItem?this._secondItem||(this._secondItem=t):this._firstItem=t}_doItemRemoved(t,e){super._doItemRemoved(t,e),t===this._firstItem?this._firstItem=null:t===this._secondItem&&(this._secondItem=null)}canAlign(t){return!0}}wr.PROP_REVERSED="reversed",wr.PROP_LINE_STYLES="lineStyles",wr.PROPINFOS=[{name:wr.PROP_REVERSED,category:Ws.BOX,type:as,multiple:!0,default:!1},{name:wr.PROP_LINE_STYLES,category:Ws.BASIC,type:ss,multiple:!1,default:void 0}],wr.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"],wr.LINE_STYLE_PROPS=["borderTop"],wr.$_ctor="DiagonalBoxContainer",wr.ITEM_TYPE="Diagonal Box";class yr extends Error{constructor(t){super(t)}}class Cr extends yr{}class br extends A{constructor(t){super(),this._id=-1,this._time=new Date,this._name=t}_doDispose(){}get name(){return this._name}get id(){return this._id}get time(){return this._time}get displayLabel(){return this._name}get description(){return this._name}run(){return this.redo(!1)}}class vr extends br{constructor(t,e){super(t),Z(e&&e.length>0),this._commands=e.slice()}_doDispose(){for(let t of this._commands)t.dispose();this._commands=null,super._doDispose()}get commands(){return this._commands.slice()}undo(){for(let t=0;t<this._commands.length;t++)this._commands[t].undo()}redo(t){for(let e=this._commands.length-1;e>=0;e--)this._commands[e].redo(t)}get source(){return this._commands[0].source}}class Br extends l{constructor(t){super(),this._commands=[],this._current=-1,this._closed=-1,this._undoing=!1,this._redoing=!1,this._owner=t}_doDispose(){this._owner=null,this._commands=null,super._doDispose()}get owner(){return this._owner}get length(){return this._commands.length}get current(){return this._current}get empty(){return 0===this._commands.length}get canUndo(){return this._current>=0}get canRedo(){return this._commands.length>this._current+1}get undoing(){return this._undoing}get redoing(){return this._redoing}get dirty(){return this._closed!==this._current}get(t){return this._commands[t]}undo(){if(this.canUndo){const t=this._commands[this._current];this._undoing=!0;try{t.undo()}finally{this._undoing=!1}const e=this._current;return this._current=this._current-1,this._changed(e,t),!0}}redo(){if(this.canRedo){const t=this._current+1,e=this._commands[t];this._redoing=!0;try{e.redo(!0)}finally{this._redoing=!1}const s=this._current;return this._current=t,this._changed(s,e),!0}}execute(t){if(t)try{t.run();const e=this._current;return this._current++,this._commands[this._current]=t,t._id=this._current,this.$_shrink(this._current+1),this._changed(e,t),!0}catch(t){if(!(t instanceof Cr))throw t}}flush(){let t=this._commands.length;if(t>0){for(;t--;)this._commands[t].dispose();this._commands=[];const e=this._current;this._current=-1,this._changed(e,null)}}close(){this._closed=this._current}getHistory(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._commands.slice(0,t?void 0:this._current+1)}_changed(t,e){const s=this._owner;s&&s.editCommandStackChanged(this,e,this.canUndo,this.canRedo),(this._current<0||t<0)&&s&&s.editCommandStackDirtyChanged(this)}$_shrink(t){const e=this._commands;if(t>=0&&t<e.length){for(let s=e.length-1;s>=t;s--)e[s].dispose();e.splice(t,e.length-t)}}}class Er{}Er.E_TABLE_MOVE_MERGE_CELLS="병합된 셀의 일부를 이동할 수 없습니다.",Er.E_TABLE_MOVE_TARGET_MERGE_CELLS="병합된 셀의 중간으로 이동할 수 없습니다.";class Pr extends Qi{constructor(t){super(t,null)}get table(){return this.parent}get col(){const t=this.item.getChildProp(Or.PROP_TABLE_COL);return isNaN(t)?0:t}get row(){const t=this.item.getChildProp(Or.PROP_TABLE_ROW);return isNaN(t)?0:t}canChangeChildProp(t,e,s){return this.parent.canChangeChildProp(t,e,s)}}class xr extends Oi{constructor(t,e){super(t,e),this._index=-1}getEditProps(){return xr.PROPINFOS}getCollectionLabel(){return"tableRow"}get table(){return this.collection.table}get index(){return this._index}get height(){return this._height}set height(t){if("string"==typeof t&&(t=t.trim()),t!=this._height){const e=this._height;this._height=t,this._heightDim=new C(t),this._changed(xr.PROP_HEIGHT,t,e)}}getHeight(t){return this._heightDim?this._heightDim.getPixel(t):NaN}get itemType(){return"Row"}get page(){var t;return null===(t=this.collection)||void 0===t?void 0:t.table.page}get displayPath(){return this.collection?this.collection.table.displayPath+".rows["+this.index+"]":"row"}get collection(){return super.collection}get marqueeParent(){var t;return null===(t=this.collection)||void 0===t?void 0:t.marqueeParent}isAncestor(t){return t===this.collection.table}canRemoveFrom(){return this.collection&&this.collection.count>1}canSelectedWith(t){return t instanceof xr&&t.table===this.table}_getStyleProps(){return xr.styleProps}_doLoad(t){"string"==typeof t||"number"==typeof t?this.height=t:t&&this._loadPropsOf(t,xr.PROPINFOS),super._doLoad(t)}_doSave(t){return this._savePropsOf(t,xr.PROPINFOS),super._doSave(t),t}}xr.PROP_HEIGHT="height",xr.styleProps=["backgroundColor"],xr.PROPINFOS=[{name:xr.PROP_HEIGHT,category:Ws.ROW,type:ns,multiple:!1,default:void 0}];class Sr extends Fi{constructor(t){super(),this._rows=[],this._table=t}get outlineParent(){return this._table}get outlineLabel(){return"[Rows]"}get outlineExpandable(){return!0}get outlineItems(){return this._rows.forEach(((t,e)=>t.outlineOrder=e)),this._rows}getSaveType(){return"rows"}get owner(){return this._table}get table(){return this._table}get count(){return this._rows.length}set count(t){const e=this._rows.length;if((t=Math.max(0,J.toNumber(t)))!==e)try{if(t>e){for(let e=this._rows.length;e<t;e++)this._rows.push(new xr(this,null));this._itemsAdded(this._rows.slice(e,t))}else{const s=this._rows.slice(t,e);this._rows.length=t,this._itemsRemoved(s)}}finally{this.$_invalidateRows()}}get items(){return this._rows.slice(0)}load(t,e){if(this._heights=null,this._rows=[],t&&t.length>0)for(let s of t){const t=new xr(this,s);if(this._rows.push(t),e>0&&this._rows.length===e)break}if(e>0)for(;this._rows.length<e;)this._rows.push(new xr(this,null));return this.$_invalidateRows(),this._rows.length}save(t){this._rows.forEach((e=>t.push(e.save({}))))}get(t){return t>=0&&t<this._rows.length?this._rows[t]:null}getRange(t,e){return e>=t?this._rows.slice(t,e+1):this._rows.slice(e,t+1)}indexOf(t){return this._rows.indexOf(t)}getHeights(){if(this._heights)this._rows.forEach(((t,e)=>{this._heights.set(e,this._rows[e]._heightDim)}));else{const t=[];this._rows.forEach((e=>{t.push(e._heightDim)})),this._heights=new b(null),this._heights.$_init(t)}return this._heights}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;e=e<0?this._rows.length:e;const s=this.$_add(t,e);if(s)return this.$_invalidateRows(),this._itemAdded(s),s}remove(t){if(t>=0&&t<this._rows.length){const e=this._rows.splice(t,1)[0];return this.$_invalidateRows(),this._itemRemoved(e,this._table),!0}}move(t,e,s){this._rows.splice(t,e).forEach(((t,e)=>this._rows.splice(s+e,0,t))),this.$_invalidateRows()}adjustHeights(t,e,s){const i=e[t+1]-e[t],r=e[t+2]-e[t+1],n=(s-i)/(i+r),o=this._rows[t]._heightDim||new C(i),a=this._rows[t+1]._heightDim||new C(r),A=o.value,l=a.value,h=[];if(o.fixed&&a.fixed){let t=o.getFixedPixel(),e=a.getFixedPixel();const s=t+e;t=Math.round(t+n*s),e=s-t,t=m(o.unit,t),e=m(a.unit,e),h.push(t+o.unit,e+a.unit)}else if(o.fixed||a.fixed){const t=e[this._rows.length];let s=o.getPixel(t),i=a.getPixel(t);const r=s+i,A=o.fixed?o.unit:a.unit;s=Math.round(s+n*r),i=r-s,s=m(A,s),i=m(A,i),h.push(s+A,i+A)}else{const t=A+l,e=+(A+n*t).toFixed(1),s=+(t-e).toFixed(1);h.push(e+"%",s+"%")}return h}get page(){var t;return null===(t=this._table)||void 0===t?void 0:t.page}get displayPath(){return this._table?this._table.displayPath+".rows":"rows"}get level(){return this._table?this._table.level+1:0}get marqueeParent(){return this._table}isAncestor(t){return t===this._table}_doMoveItem(t,e){return!1}$_add(t,e){if(t instanceof xr||(t=new xr(this,t)),t instanceof xr&&this._rows.indexOf(t)<0)return this._rows.splice(Math.min(e,this._rows.length),0,t),t}$_invalidateRows(){this._rows.forEach(((t,e)=>{t._parent=this,t._index=e})),this._heights=null,this.$_rowChanged(null)}$_rowChanged(t){this._table&&this._table.$_rowChanged(t)}}class Ir extends Oi{constructor(t,e,s,i){super(t,i),this._applyEndStyles=!1,this._row=-1,this._col=-1,this._styleCallbackDelegate=(t,e,s)=>this._styleCallbackFunc(t,e,s),this._row=e,this._col=s}get outlineLabel(){const t=this.table.getCell(this._row,this._col),e=["[",this._row,",",this._col,"] Cell"];if(t){const s=t.rowspan,i=t.colspan;s>1&&e.push(" (",s+" rows)"),i>1&&e.push(" (",i+" cols)")}return e.join("")}getEditProps(){return Ir.PROPINFOS}get table(){return this.collection.table}get row(){return this._row}get col(){return this._col}get height(){return this._rowspan||1}get width(){return this._colspan||1}get bottom(){return this._row+(isNaN(this._rowspan)?0:this._rowspan-1)}get right(){return this._col+(isNaN(this._colspan)?0:this._colspan-1)}get isSingle(){return 1===this.width&&1===this.height}get colspan(){return this._colspan}set colspan(t){var e;if(t<=1&&(t=void 0),t!==this._colspan){const s=this._colspan;this._colspan=t,this._changed(Ir.PROP_COLSPAN,t,s),null===(e=this.table)||void 0===e||e._spanChanged(this)}}get rowspan(){return this._rowspan}set rowspan(t){var e;if(t<=1&&(t=void 0),t!==this._rowspan){const s=this._rowspan;this._rowspan=t,this._changed(Ir.PROP_ROWSPAN,t,s),null===(e=this.table)||void 0===e||e._spanChanged(this)}}get applyEndStyles(){return this._applyEndStyles}set applyEndStyles(t){t!==this._applyEndStyles&&(this._applyEndStyles=t,this._changed(Ir.PROP_APPLY_END_STYLES,t,!t))}get styleCallback(){return this._styleCallback}set styleCallback(t){if(t!==this._styleCallback){const e=this._styleCallback;this._styleCallback=t,this._changed(Ir.PROP_STYLE_CALLBACK,t,e)}}get onGetStyles(){return this._onGetStyles}set onGetStyles(t){if(t!==this._onGetStyles){t?(this._styleCallbackFunc=new Function("ctx, cell, row, value",t),this._styleCallback=this._styleCallbackDelegate):this._styleCallback===this._styleCallbackDelegate&&(this._styleCallback=null);const e=this._onGetStyles;this._onGetStyles=t,this._changed(Ri.PROP_ON_GET_STYLES,t,e)}}adoptDragSource(t){}get itemType(){return"cell"}get collection(){return super.collection}get page(){var t;return null===(t=this.collection)||void 0===t?void 0:t.table.page}get displayPath(){return this.collection?this.collection.table.displayPath+".cells["+this._row+", "+this._col+"]":"cell"}get marqueeParent(){return this.table}_getStyleProps(){return Ir.styleProps}setProps(t){super.setProps(t),t.hasOwnProperty("row")&&(this._row=t.row),t.hasOwnProperty("col")&&(this._col=t.col)}canSelectedWith(t){return t instanceof Ir||t instanceof Rr}_doLoad(t){this._loadPropsOf(t,Ir.PROPINFOS),this._loadProps(t,"styleCallback"),super._doLoad(t)}_doSave(t){t.r=this._row,t.c=this._col,this._savePropsOf(t,Ir.PROPINFOS),delete t.col,delete t.row,t.colspan<=1&&delete t.colspan,t.rowspan<=1&&delete t.rowspan,this._saveProp(t,"styleCallback"),super._doSave(t)}}Ir.PROP_COL="col",Ir.PROP_ROW="row",Ir.PROP_COLSPAN="colspan",Ir.PROP_ROWSPAN="rowspan",Ir.PROP_APPLY_END_STYLES="applyEndStyles",Ir.PROP_ON_GET_STYLES="onGetStyles",Ir.PROP_STYLE_CALLBACK="styleCallback",Ir.PROPINFOS=[{name:Ir.PROP_ROW,category:Ws.CELL,type:rs,multiple:!1,default:void 0,readonly:!0},{name:Ir.PROP_COL,category:Ws.CELL,type:rs,multiple:!1,default:void 0,readonly:!0},{name:Ir.PROP_ROWSPAN,category:Ws.CELL,type:rs,multiple:!1,default:void 0},{name:Ir.PROP_COLSPAN,category:Ws.CELL,type:rs,multiple:!1,default:void 0},{name:Ir.PROP_APPLY_END_STYLES,category:Ws.CELL,type:as,multiple:!1,default:!1},{name:Ri.PROP_ON_GET_STYLES,category:Ws.EVENT,type:cs,multiple:!1,default:void 0,signature:"(ctx/* PrintContext*/, cell/*TableCell*/, row/*Number*/)/*any*/"}],Ir.styleProps=["cellAlign","backgroundColor","paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeft","borderRight","borderTop","borderBottom"];class Rr{constructor(t,e,s){this.cols=1,this.rows=1,this.selectItem=this._cell=t,this.cols=e,this.rows=s}get table(){return this.selectItem.table}get cell(){return this._cell}get col(){return this._cell.col}get row(){return this._cell.row}get right(){return this._cell.col+this.cols-1}get bottom(){return this._cell.row+this.rows-1}canSelectedWith(t){return t instanceof Ir||t instanceof Rr}contains(t,e){return t>=this.row&&t<=this.bottom&&e>=this.col&&e<=this.right}containsCell(t){return t.table===this.table&&this.contains(t.row,t.col)}isSingle(t){const e=this._cell,s=e.table,i=e.row,r=e.col;if(this.rows>1||this.cols>1){if(t){let t=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.cols;n++)if(!s.isHiddenAt(i+e,r+n)&&(t++,t>1))return!1;return!0}return!1}return!0}getCells(t){const e=this._cell,s=e.table,i=e.row,r=e.col,n=[];for(let e=0;e<this.rows;e++)for(let o=0;o<this.cols;o++){const a=s.getCell(i+e,r+o);t&&s.isHiddenAt(i+e,r+o)||n.push(a)}return n}resizeTo(t){if(t){const e=this._cell.table,s=this.rows,i=this.cols,r=e.cells.getRectangle(this.selectItem,t);return this._cell=e.getCell(r.y,r.x),this.rows=r.height,this.cols=r.width,s!==this.rows||i!==this.cols}}resizeBy(t,e){const s=this.selectItem.table;let i=this.selectItem.col,r=this.selectItem.row,n=this._cell.col,o=this._cell.row;if(i===n?n=this.right+t:n+=t,r===o?o=this.bottom+e:o+=e,t>0){const t=n;for(let e=Math.min(r,o);e<=Math.max(r,o);e++){const i=s.getCell(e,n);i&&s.isHiddenCell(i)&&(n=Math.max(t,t+s.getHeadCell(i).width-1))}}if(e>0){const t=o;for(let e=Math.min(i,n);e<=Math.max(i,n);e++){const i=s.getCell(o,e);i&&s.isHiddenCell(i)&&(o=Math.max(t,t+s.getHeadCell(i).height-1))}}return n=Math.max(0,Math.min(s.colCount,n)),o=Math.max(0,Math.min(s.rowCount,o)),this.resizeTo(s.getCell(o,n))}equals(t){return this._cell===t&&this.rows===t.height&&this.cols===t.width}}class Tr extends Fi{constructor(t){super(),this._cells=[],this._table=t}get outlineParent(){return this._table}get outlineLabel(){return"[Cells]"}get outlineExpandable(){return!0}get outlineItems(){return this._vcells}getSaveType(){return"cells"}isCollectionProp(){return!1}get owner(){return this._table}get table(){return this._table}get count(){return this._vcells.length}get items(){return this._vcells}get rowCount(){return this._cells.length}get colCount(){return this._cells[0].length}getColCount(t){return this._cells[t].length}get(t){return t>=0&&t<this._vcells.length?this._vcells[t]:null}getAt(t,e){if(t>=0&&t<this._cells.length)return this._cells[t][e]}indexOf(t){return this._vcells.indexOf(t)}getRectangle(t,e){const s=this.table,i=Math.min(s.getTopRow(t),s.getTopRow(e)),r=Math.max(t.bottom,e.bottom),n=Math.min(s.getLeftCol(t),s.getLeftCol(e)),o=Math.max(t.right,e.right);return d.create(n,i,o-n+1,r-i+1)}getRectangleCells(t,e){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this.table,r=this.getRectangle(t,e),n=[];for(let t=r.y;t<r.y+r.height;t++)for(let e=r.x;e<r.x+r.width;e++)s&&i.isHiddenAt(t,e)||n.push(this._cells[t][e]);return n}prepareCells(){const t=this._table,e=this._cells,s=t.rowCount,i=t.colCount;for(;e.length<s;)e.push([]);for(let t=0;t<s;t++){const s=e[t];for(;s.length<i;)s.push(this._createCell(t,s.length))}}load(t){var e;if(this.prepareCells(),t&&t.length>0){const s=this._cells;for(let i of t){const t=i.r,r=i.c,n=null===(e=s[t])||void 0===e?void 0:e[r];null==n||n.load(i)}}}save(t){this._cells.forEach((e=>{e.forEach((e=>{const s=e.save({});let i=!1;for(let t in s)if("r"!==t&&"c"!==t){i=!0;break}i&&t.push(s)}))}))}resetVisibles(){const t=this._table,e=this._cells,s=t.rowCount,i=t.colCount,r=this._vcells,n=this._vcells=[];for(let r=0;r<s;r++)for(let s=0;s<i;s++)t.isHiddenAt(r,s)||n.push(e[r][s]);r&&!J.equalArrays(r,n)&&(r&&this._itemsRemoved(r),this._itemsAdded(n))}saveCells(){const t=this._cells,e=t.length,s=[];for(let i=0;i<e;i++){const e=[];for(let s=0,r=t[i].length;s<r;s++){const r=t[i][s];e.push({props:r.getProps(),styles:r.styles})}s.push(e)}return s}restoreCells(t){const e=t.length,s=this._cells;for(let i=0;i<e;i++)for(let e=0,r=t[i].length;e<r;e++){const r=s[i][e],n=t[i][e];r.setProps(n.props),r.styles=n.styles}}truncateRow(t){const e=this._cells,s=this.saveCells();for(let s=0;s<t;s++)for(let i=0,r=e[s].length;i<r;i++){const r=e[s][i];s+r.rowspan>t&&(r.rowspan=t-s)}return s}truncateCol(t){const e=this._cells,s=this.saveCells();for(let s=0;s<e.length;s++)for(let i=0;i<t;i++){const r=e[s][i];i+r.colspan>t&&(r.colspan=t-i)}return s}removeRow(t){const e=this._cells,s=this.saveCells();e.splice(t,1);for(let e=t;e<this._cells.length;e++)this._cells[e].forEach((t=>{t._row=t.row-1}));for(let s=0;s<t;s++)for(let i=0,r=e[s].length;i<r;i++){const r=e[s][i];s+r.rowspan>t&&r.rowspan--}return s}removeRows(t,e){const s=this._cells,i=this.saveCells();s.splice(t,e);for(let i=0;i<t;i++)for(let r=0,n=s[i].length;r<n;r++){const n=s[i][r],o=n.rowspan;i+o>t+e?n.rowspan=Math.max(1,o-e):i+o>t&&(n.rowspan=Math.max(1,i-t))}return i}addRow(t){const e=this.saveCells(),s=[],i=this._cells.length>0?this._cells[0].length:this.table.colCount;for(let e=0;e<i;e++)s.push(this._createCell(t,e));this._cells.splice(t,0,s);for(let e=t+1;e<this._cells.length;e++)this._cells[e].forEach((t=>{t._row=t.row+1}));for(let e=0;e<t;e++)this._cells[e].forEach((s=>{e+s.rowspan>t&&s.rowspan++}));return e}removeCol(t){const e=this._cells,s=e.length,i=this.saveCells();for(let i=0;i<s;i++)e[i].splice(t,1);for(let i=0;i<s;i++)for(let s=t;s<e[i].length;s++)e[i][s]._col=e[i][s].col-1;for(let i=0;i<s;i++)for(let s=0,r=e[i].length;s<r;s++){const r=e[i][s];s+r.colspan>t&&r.colspan--}return i}removeCols(t,e){}addCol(t){const e=this.saveCells(),s=this._cells,i=s.length;for(let e=0;e<i;e++)s[e].splice(t,0,this._createCell(e,t));for(let e=0;e<s.length;e++)for(let i=t+1;i<s[e].length;i++)s[e][i]._col=s[e][i].col+1;for(let e=0;e<i;e++)for(let i=0;i<t;i++)i+s[e][i].colspan>t&&s[e][i].colspan++;return e}$_resetPositions(){const t=this._cells;for(let e=0;e<t.length;e++){const s=t[e];for(let t=0;t<s.length;t++)s[t]._row=e,s[t]._col=t}}moveRows(t,e,s){const i=this.saveCells(),r=this._cells,n=this._table.rowCount;if(s!==t&&e>=1&&t>=0&&t+e<=n&&s>=0&&s<n){return r.splice(t,e).forEach(((t,e)=>r.splice(s+e,0,t))),this.$_resetPositions(),i}}moveCols(t,e,s){const i=this.saveCells(),r=this._table.rowCount,n=this._table.colCount;if(s!==t&&e>=1&&t>=0&&t+e<=n&&s>=0&&s<n){for(let i=0;i<r;i++){const r=this._cells[i];r.splice(t,e).forEach(((t,e)=>r.splice(s+e,0,t)))}return this.$_resetPositions(),i}}getMergeBounds(t,e,s,i){const r=this._cells;let n=e,o=i;for(let a=t;a<=s;a++){for(let t=e-1;t>=0;t--){if(r[a][t].colspan>e-t){n=Math.min(n,t);break}}for(let t=e;t<=i;t++){const e=r[a][t].colspan;if(t+e-1>i){o=Math.max(o,t+e-1);break}}}let a=t,A=s;for(let n=e;n<=i;n++){for(let e=t-1;e>=0;e--){if(r[e][n].rowspan>t-e){a=Math.min(a,e);break}}for(let e=t;e<=s;e++){const t=r[e][n].rowspan;if(e+t-1>s){A=Math.max(A,e+t-1);break}}}return{r1:a,c1:n,r2:A,c2:o}}mergeBoundsOf(t){return this.getMergeBounds(t.row,t.col,t.bottom,t.right)}merge(t,e,s,i){const r=this._cells,n=this.saveCells();for(let n=t;n<=s;n++)for(let t=e;t<=i;t++)r[n][t].rowspan=r[n][t].colspan=void 0;return r[t][e].rowspan=s-t+1,r[t][e].colspan=i-e+1,n}mergeSelection(t){return this.merge(t.row,t.col,t.bottom,t.right)}unmerge(t){const e=this.saveCells();return t.rowspan=t.colspan=void 0,e}get page(){var t;return null===(t=this._table)||void 0===t?void 0:t.page}get displayPath(){return this._table?this._table.displayPath+".cells":"cells"}get level(){return this._table?this._table.level+1:0}get marqueeParent(){return this._table}isAncestor(t){return t===this._table}_doMoveItem(t,e){return!1}_createCell(t,e){return new Ir(this,t,e)}}class Or extends Ui{constructor(t){super(t),this._fixed=!1,this._cellStyles={},this._cellMap=[],this._spans=[],this._spanDirty=!0,this._itemDirty=!1,this._rows=this._createRows(),this._cells=this._createCells(),this._resetCells()}_createCells(){return new Tr(this)}getSubStyleProps(t){if(t===Or.PROP_TABLE_CELL_STYLES){const e=[];for(let s of Or.CELL_STYLES){const i={...Bi[s]};i.parent=t,e.push(i)}return e}return super.getSubStyleProps(t)}_getSubStyle(t,e){return t===Or.PROP_TABLE_CELL_STYLES?this._cellStyles[e]:super._getSubStyle(t,e)}_setSubStyle(t,e,s){if(t===Or.PROP_TABLE_CELL_STYLES){const i=this._cellStyles[e];this._cellStyles[e]=s,this._changed(t,s,i)}else super._setSubStyle(t,e,s)}get outlineItems(){return[this._rows,this._cells].concat(super.outlineItems)}get rowCount(){return this._rowCount||0}set rowCount(t){if((t=Math.max(1,J.toNumber(t)))!==this._rowCount){const e=this._rowCount;this._rowCount=t,this._rows.count=t,t<e?this._removeRows(t,e-t):this._resetCells(),this._changed(Or.PROP_ROW_COUNT,t,e)}}get rows(){return this._rows}get cells(){return this._cells}get minRowHeight(){return this._minRowHeight}set minRowHeight(t){if(t!=this._minRowHeight){const e=this._minRowHeight;this._minRowHeight=t,this._minRowHeightDim=t?new C(t):null,this._changed(Or.PROP_MIN_ROW_HEIGHT,t,e)}}get cellStyles(){return this._cellStyles}set cellStyles(t){const e=this._cellStyles={};if(t){const s=Or.CELL_STYLES;for(let i of s)i in t&&(e[i]=t[i])}e&&this._arrangePaddingStyles(e)}get fixed(){return this._fixed}set fixed(t){t!==this._fixed&&(this._fixed=t,this._changed(Or.PROP_FIXED,t,!t))}getRow(t){return this._rows.get(t)}getRowHeights(){return this._rows.getHeights()}getCell(t,e){return this._cells.getAt(t,e)}getCellItemAt(t,e){return t>=0&&t<this._cellMap.length?this._cellMap[t][e]:null}getCellItem(t){return this.getCellItemAt(t.row,t.col)}isHiddenAt(t,e){const s=this._spans[t][e];return s.r*s.c==0}isHiddenCell(t){const e=t&&this._spans[t.row][t.col];return e&&e.r*e.c==0}getHeadCell(t){let e=t.row,s=t.col;if(this.isHiddenAt(e,s)){for(;e>0&&this.isHiddenAt(--e,s););for(;s>0&&this.isHiddenAt(e,--s););}return this.getCell(e,s)}getLeftCol(t){const e=t.row;let s=t.col;for(;s>0&&this.isHiddenAt(e,s);)s--;return s}getTopRow(t){const e=t.col;let s=t.row;for(;s>0&&this.isHiddenAt(s,e);)s--;return s}getMinRowHeight(){return this._minRowHeightDim?this._minRowHeightDim.getFixedPixel():NaN}getColItems(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.filter((s=>{const i=s.col;return e?i===t:i!==t})).map((t=>t.item))}getRowItems(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.filter((s=>{const i=s.row;return e?i===t:i!==t})).map((t=>t.item))}getRowItemsFrom(t){return this.filter((e=>e.row>=t)).map((t=>t.item))}getRectItems(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this.filter((s=>{const i=s.row,n=s.col;return!r||i!==t||n!==e})).map((t=>t.item))}prepareLayout(){return(this._spanDirty||this._itemDirty)&&(this.$_resetSpans(this._cells,this._spanDirty),this._spanDirty=!1,this._itemDirty=!1),this._spans}setFocus(t){this._focus=t&&{...t}}removeRow(t){const e=this._cellMap,s="number"==typeof t?t:this._rows.indexOf(t);if(s>=0&&s<this._rowCount){this._rows.remove(s);for(let t=0;t<this.colCount;t++){const i=e[s][t];i&&this.remove(i.item)}e.splice(s,1);for(let t=s;t<e.length;t++){const s=e[t];if(s)for(let t=0;t<this.colCount;t++){const e=s[t];e&&e.item&&e.item.$_setChildProp("row",e.item.row-1)}}this._rowCount--,this._resetCells(),this._changed(Or.PROP_ROW_COUNT,this._rowCount,this._rowCount+1)}}addRow(t,e){if(t>=0&&t<=this._rowCount){const s=this._rows.add(e,t);return this._rowCount++,this._addRows(t,1),this._resetCells(),this._changed(Or.PROP_ROW_COUNT,this._rowCount,this._rowCount-1),s}}canMoveRows(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=this.rowCount;if(s!==t&&t>=0&&t+e<=r&&s>=0&&s<r){let n=t;const o=this._spans,a=this.colCount;for(let t=0;t<a;t++){const e=o[n][t];if(0===e.r&&e.v.row<n){if(i)throw new w(Er.E_TABLE_MOVE_MERGE_CELLS);return!1}}n=t+e-1;for(let t=0;t<a;t++){const e=o[n][t].v;if(e&&e.row+e.rowspan>n){if(i)throw new w(Er.E_TABLE_MOVE_MERGE_CELLS);return!1}}if(s>t&&s++,s<r)for(let t=0;t<a;t++){if(0===o[s][t].r){if(i)throw new w(Er.E_TABLE_MOVE_TARGET_MERGE_CELLS);return!1}}return!0}}getNearestMovableRow(t,e,s){if(s<0)for(;t+s>=0;){if(this.canMoveRows(t,e,t+s))return t+s;s--}else if(s>0)for(;t+e-1+s<this.rowCount;){if(this.canMoveRows(t,e,t+s))return t+e-1+s;s++}return-1}moveRows(t,e,s){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]||this.canMoveRows(t,e,s))return this._rows.move(t,e,s),this._moveRows(t,e,s),this.layoutChanged=!0,this._changed(Or.PROP_CELL_LAYOUT,void 0,void 0),!0}canMoveCols(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=this.colCount;if(s!==t&&t>=0&&t+e<=r&&s>=0&&s<r){let n=t;const o=this._spans,a=this.rowCount;for(let t=0;t<a;t++){const e=o[t][n];if(0===e.c&&e.v.col<n){if(i)throw new w(Er.E_TABLE_MOVE_MERGE_CELLS);return!1}}n=t+e-1;for(let t=0;t<a;t++){const e=o[t][n].v;if(e&&e.col+e.colspan-1>n){if(i)throw new w(Er.E_TABLE_MOVE_MERGE_CELLS);return!1}}if(s>t&&s++,s<r)for(let t=0;t<a;t++){if(0===o[t][s].c){if(i)throw new w(Er.E_TABLE_MOVE_TARGET_MERGE_CELLS);return!1}}return!0}}getNearestMovableColumn(t,e,s){if(s<0)for(;t+s>=0;){if(this.canMoveCols(t,e,t+s,!1))return t+s;s--}else if(s>0)for(;t+e-1+s<this.colCount;){if(this.canMoveCols(t,e,t+e-1+s,!1))return t+s;s++}return-1}checkCounts(){const t=this.colCount,e=this.rowCount;Z(this._spans.length===e),this._spans.forEach((e=>{Z(e.length===t)}))}getSelection(t){return new Rr(t,t.width,t.height)}mergeCells(t,e,s,i){const r=this._cellMap;let n=t;t=Math.max(0,Math.min(t,s)),s=Math.min(this.rowCount-1,Math.max(n,s)),n=e,e=Math.max(0,Math.min(e,i)),i=Math.min(this.colCount-1,Math.max(n,i));for(let n=t;n<=s;n++)for(let s=e;s<=i;s++)if(n!==t||s!==e){const t=r[n][s];t&&this.remove(t.item)}this._resetCells()}_getEditProps(){return super._getEditProps().concat(Or.PROPINFOS)}_getStyleProps(){return Or.TABLE_STYLES}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.minRowHeight="24px"}_doLoad(t,e){super._doLoad(t,e),e&&(this._loadProps(e,"rowCount","base","minRowHeight","cellStyles"),e.hasOwnProperty("rows")&&(this._rowCount=this._rows.load(e.rows,this._rowCount)),this._cells.load(e.cells),this.$_resetSpans(this._cells))}_doSave(t){super._doSave(t),this._saveProps(t,"rowCount","base","minRowHeight","cellStyles"),this._rows.count&&this._rows.save(t.rows=[]),this._cells.save(t.cells=[])}_doSaveItems(t,e){for(let s of e){const e={};s.item.save(e),t.push(e)}}_getChildPropInfos(t){return Or.TABLE_CHILD_PROPS}_doLoadChild(t,e){this._loadChildProps(t,[Or.PROP_TABLE_COL,Or.PROP_TABLE_ROW],e)}_prepareCellGroup(t){try{const e=t.getChildProp(Or.PROP_TABLE_COL,this._focus?this._focus.col:0),s=t.getChildProp(Or.PROP_TABLE_ROW,this._focus?this._focus.row:0),i=this._cellMap;if(e>=0&&s>=0){let r=i[s]&&i[s][e];if(!r)return r=this._createCell(t),i[s]||(i[s]=[]),t.setChildProp(Or.PROP_TABLE_COL,e),t.setChildProp(Or.PROP_TABLE_ROW,s),i[s][e]=r;if(r.item!==t)throw Error("Only one item can exits in a table cell: "+(t.name||"")+"("+s+","+e+")")}}finally{this._focus=null}}_unprepareCellGroup(t){for(let e=0;e<this._cellMap.length;e++){const s=this._cellMap[e];if(s)for(let e=0;e<s.length;e++)if(s[e]&&s[e].item===t){const t=s[e];return s[e]=null,t}}}_doItemAdded(t,e){this._itemDirty=!0}_doItemRemoved(t,e){this._itemDirty=!0}_doItemChanged(t,e,s,i){if("col"===e||"row"===e){let s;"col"===e?(s=this._cellMap[t.row][i],this._cellMap[t.row][i]=null):(s=this._cellMap[i][t.col],this._cellMap[i][t.col]=null),this._cellMap[t.row][t.col]=s,this.onCellChanged&&this.onCellChanged(t,e,i)}}isAncestorOf(t){return super.isAncestorOf(t)||t instanceof Ir&&t.table===this}_createRows(){return new Sr(this)}_spanChanged(t){this._spanDirty=!0}_resetCells(){var t;const e=this._cellMap.length,s=[],i=this.rowCount,r=this.colCount;for(let n=0;n<i;n++){const i=[];for(let s=0;s<r;s++){const r=e>n?null===(t=this._cellMap[n])||void 0===t?void 0:t[s]:null;i.push(r)}s.push(i)}this._cellMap=s,this._cells.prepareCells(),this.$_resetSpans(this._cells)}_removeCols(t,e){let s;this._cellMap.forEach((i=>{for(let r=0;r<e;r++)s=i[r+t],s&&this.remove(s.item);for(let r=t+e;r<i.length;r++)s=i[r],s&&s.item&&s.item.$_setChildProp("col",s.item.col-e);i.splice(t,e)})),this.$_resetSpans(this._cells)}_addCols(t,e){this._cellMap.forEach((s=>{for(let i=0;i<e;i++)s.splice(t,0,null);for(let i=t+e;i<s.length;i++){let t=s[i];t&&t.item&&t.item.$_setChildProp("col",t.item.col+e)}}))}_moveCols(t,e,s){this._cellMap.forEach((i=>{i.splice(t,e).forEach(((t,e)=>{i.splice(s+e,0,t)}));for(let t=0;t<i.length;t++){const e=i[t];e&&e.item&&e.item.$_setChildProp("col",t)}})),this.$_resetSpans(this._cells)}_removeRows(t,e){const s=this._cellMap;let i;for(let r=0;r<e;r++){const e=s[r+t];if(e)for(let t=0;t<this.colCount;t++)i=e[t],i&&this.remove(i.item)}s.splice(t,e);for(let r=t;r<s.length;r++){const n=s[r+t];if(n)for(let t=0;t<this.colCount;t++)i=n[t],i&&i.item&&i.item.$_setChildProp("row",i.item.row-e)}this.$_resetSpans(this._cells)}_addRows(t,e){const s=this._cellMap;for(let i=0;i<e;i++)s.splice(t,0,[]);for(let i=t+e;i<s.length;i++){const t=s[i];t&&t.forEach((t=>{t&&t.item&&t.item.$_setChildProp("row",t.item.row+e)}))}}_moveRows(t,e,s){const i=this._cellMap;i.splice(t,e).forEach(((t,e)=>i.splice(s+e,0,t)));for(let t=0;t<i.length;t++){const e=i[t];if(e)for(let s=0;s<this.colCount;s++){const i=e[s];i&&i.item&&i.item.$_setChildProp("row",t)}}this.$_resetSpans(this._cells)}canChangeChildProp(t,e,s){if("col"===e||"row"===e){if(s!==t.getProperty(e)){const i="row"===e?s:t.getProperty("row"),r="col"===e?s:t.getProperty("col");if(i<0||i>=this._rowCount||r<0||r>=this.colCount)throw new Error("Out of bounds");if(this.getCellItemAt(i,r))throw new Error("Already a item exists at ("+i+", "+r+")")}}return!0}$_rowChanged(t){this._changed(Or.PROP_ROWS,this._rows,this._rows)}$_resetSpans(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=this._rowCount,i=this.colCount;let r=this._spans;if(e){r=this._spans=[];for(let t=0;t<s;t++){r[t]=[];for(let e=0;e<i;e++)r[t][e]={r:1,c:1,m:null,v:null}}}for(let t=0;t<s;t++){r[t]=[];for(let e=0;e<i;e++)r[t][e]={r:1,c:1,m:null,v:null}}for(let e=0;e<s;e++)for(let n=0;n<i;n++){const o=r[e][n];if(o.r>0&&o.c>0){const a=t.getAt(e,n),A=this.getCellItemAt(e,n);if(a){const t=Math.min(i-n,J.pickNum(a.colspan,1)),l=Math.min(s-e,J.pickNum(a.rowspan,1));if(t>1||l>1)for(let s=0;s<l;s++)for(let i=0;i<t;i++){const t=r[e+s][n+i];t.m=A,i>0&&(t.c=0),s>0&&(t.r=0),t.v=a}o.m=A,o.v=a,o.r=l,o.c=t}else o.m=o.v=null}}this._cells.resetVisibles()}_addColumn(t){this._addCols(t,1),this._resetCells()}_removeColumn(t){var e,s;const i=this.rowCount,r=this.colCount,n=this._cellMap;for(let o=0;o<i;o++){const i=n[o],a=null===(e=n[o][t])||void 0===e?void 0:e.item;if(a&&this.remove(a),i){i.splice(t,1);for(let e=t;e<r;e++){const t=null===(s=i[e])||void 0===s?void 0:s.item;t&&t.$_setChildProp("col",t.col-1)}}}this._resetCells()}}Or.PROP_ROW_COUNT="rowCount",Or.PROP_MIN_ROW_HEIGHT="minRowHeight",Or.PROP_ROWS="rows",Or.PROP_TABLE_CELL_STYLES="cellStyles",Or.PROP_CELL_LAYOUT="table_cell_layout",Or.PROP_FIXED="fixed",Or.PROP_TABLE_COL="col",Or.PROP_TABLE_ROW="row",Or.PROPINFOS=[{name:Or.PROP_ROW_COUNT,category:Ws.TABLE,type:rs,multiple:!1,default:0},{name:Or.PROP_MIN_ROW_HEIGHT,category:Ws.TABLE,type:ns,typeProps:{percentable:!1},multiple:!1,default:"15px"},{name:Or.PROP_TABLE_CELL_STYLES,category:Ws.BASIC,type:ss,multiple:!1,default:void 0},{name:Or.PROP_FIXED,category:Ws.TABLE,type:as,multiple:!0,default:void 0}],Or.TABLE_CHILD_PROPS=[{name:Or.PROP_TABLE_COL,category:Ws.TABLE,type:rs,multiple:!1,default:void 0,domain:void 0},{name:Or.PROP_TABLE_ROW,category:Ws.TABLE,type:rs,multiple:!1,default:void 0,domain:void 0}],Or.TABLE_STYLES=["fontFamily","fontSize","fontWeight","color","backgroundColor"],Or.CELL_STYLES=["paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeft","borderRight","borderTop","borderBottom"];class Fr extends Oi{constructor(t,e){super(t,e),this._index=-1,this._widthDim||(this.width="20%")}getEditProps(){return Fr.PROPINFOS}getCollectionLabel(){return"tableColumn"}get index(){return this._index}get width(){return this._width}set width(t){if(t!=this._width){const e=this._width;this._width=t,this._widthDim=new C(t),this._changed(Fr.PROP_WIDTH,t,e)}}getWidth(t){return this._widthDim?this._widthDim.getPixel(t):NaN}get itemType(){return"Column"}get page(){var t;return null===(t=this.collection)||void 0===t?void 0:t.page}canSelectedWith(t){return t instanceof Fr&&t.parent===this.parent}_getStyleProps(){return Fr.styleProps}_doLoad(t){"string"==typeof t||"number"==typeof t?this.width=t:t&&this._loadPropsOf(t,Fr.PROPINFOS),super._doLoad(t)}_doSave(t){return this._savePropsOf(t,Fr.PROPINFOS),super._doSave(t),t}}Fr.PROP_WIDTH="width",Fr.PROPINFOS=[{name:Fr.PROP_WIDTH,category:Ws.COLUMN,type:ns,multiple:!1,default:void 0}],Fr.styleProps=["cellAlign","backgroundColor"];class Dr extends Fi{constructor(t){super(),this._columns=[],this._owner=t}get outlineParent(){return this._owner}get outlineLabel(){return"[Columns]"}get outlineExpandable(){return!0}get outlineItems(){return this._columns.forEach(((t,e)=>t.outlineOrder=e)),this._columns}getSaveType(){return"columns"}get owner(){return this._owner}get count(){return this._columns.length}set count(t){const e=this._columns.length;if((t=Math.max(0,J.toNumber(t)))!==e)try{if(t>e){for(let e=this._columns.length;e<t;e++)this._columns.push(this._createColumn(null));this._itemsAdded(this._columns.slice(e,t))}else this._itemsRemoved(this._columns.splice(t,e))}finally{this.$_resetColumns()}}get items(){return this.columns}get columns(){return this._columns.slice(0)}load(t,e){if(this._widths=null,this._columns=[],t&&t.length>0)for(let s of t){const t=this._createColumn(s);if(this._columns.push(t),e>0&&this._columns.length===e)break}if(e>0)for(;this._columns.length<e;)this._columns.push(this._createColumn(null));return this.$_resetColumns(),this._columns.length}save(t){this._columns.forEach((e=>t.push(e.save({}))))}get(t){return t>=0&&t<this._columns.length?this._columns[t]:null}getRange(t,e){return e>=t?this._columns.slice(t,e+1):this._columns.slice(e,t+1)}indexOf(t){return this._columns.indexOf(t)}getWidths(){if(this._widths)this._columns.forEach(((t,e)=>{this._widths.set(e,t._widthDim)}));else{const t=[];this._columns.forEach((e=>{t.push(e._widthDim)})),this._widths=new b(null),this._widths.$_init(t)}return this._widths}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;e=e<0?this._columns.length:e;const s=this.$_add(t,e);if(s)return this.$_resetColumns(),this._itemAdded(s),s}remove(t){if(t>=0&&t<this._columns.length){const e=this._columns.splice(t,1)[0];return this.$_resetColumns(),this._itemRemoved(e,this._owner),!0}}clear(){if(this._columns.length>0)return this._columns=[],this.$_resetColumns(),!0}move(t,e,s){this._columns.splice(t,e).forEach(((t,e)=>this._columns.splice(s+e,0,t))),this.$_resetColumns()}adjustWidths(t,e,s){const i=this._columns[t]._widthDim,r=this._columns[t+1]._widthDim,n=i.value,o=r.value,a=e[t+1]-e[t],A=(s-a)/(a+(e[t+2]-e[t+1])),l=[];if(i.fixed&&r.fixed){let t=i.getFixedPixel(),e=r.getFixedPixel();const s=t+e;t=Math.round(t+A*s),e=s-t,t=m(i.unit,t),e=m(r.unit,e),l.push(t+i.unit,e+r.unit)}else if(i.fixed||r.fixed){const t=e[this._columns.length];let s=i.getPixel(t),n=r.getPixel(t);const o=s+n,a=i.fixed?i.unit:r.unit;s=Math.round(s+A*o),n=o-s,s=m(a,s),n=m(a,n),l.push(s+a,n+a)}else{const t=n+o,e=+(n+A*t).toFixed(1),s=+(t-e).toFixed(1);l.push(e+"%",s+"%")}return l}get page(){var t;return null===(t=this._owner)||void 0===t?void 0:t.page}get displayPath(){return this._owner?this._owner.displayPath+".columns":"columns"}get level(){return this._owner?this._owner.level+1:0}get marqueeParent(){return this._owner}isAncestor(t){return t===this._owner}_doMoveItem(t,e){return!1}$_add(t,e){if(t instanceof Fr||(t=this._createColumn(t)),t instanceof Fr&&this._columns.indexOf(t)<0)return this._columns.splice(Math.min(e,this._columns.length),0,t),t}$_resetColumns(){this._columns.forEach(((t,e)=>{t._parent=this,t._index=e})),this._widths=null,this.$_columnChanged(null)}$_columnChanged(t){this._owner&&this._owner.$_columnChanged(t)}}const Lr={sum:0,count:1,min:2,max:3,avg:4};class Nr extends Yt{constructor(t){super(),this._fieldMap={},this._idxMap={},this._masterFieldMap={},this._masterIdxMap={},this._band=t}_doDispose(){super._doDispose()}prepare(t,e){let s=this._data=t;if(this._fieldMap={},this._rowCount=NaN,s)for(let t=0;t<s.fieldCount;t++){const e=s.getField(t).fieldName;this._fieldMap[":"+e]=this._fieldMap[e]=999+t,this._idxMap[999+t]=e}if(e instanceof Qe){s=this._master=e;for(let t=0;t<s.fieldCount;t++){const e=s.getField(t).fieldName;this._masterFieldMap["master:"+e]=888+t,this._masterIdxMap[888+t]=e}}return this}setGroup(t){return this._group=t,this}setRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return this._rows=t,this._masterRow=e,this}setRowCount(t){return this._rowCount=t,this}isIdentifier(t){const e=t.toLocaleLowerCase();return Lr.hasOwnProperty(e)?Lr[e]:this._fieldMap.hasOwnProperty(t)?this._fieldMap[t]:this._masterFieldMap.hasOwnProperty(t)?this._masterFieldMap[t]:super.isIdentifier(t)}evaluateIdentifier(t){return t>=999?this._idxMap[t]:t>=888?this._master.getRowValue(this._masterRow,this._masterIdxMap[t]):void super.evaluateIdentifier(t)}evaluateFunc(t,e){const s=this.$_getRows();switch(t){case 0:return this._band.getSum(e,this._rowCount,s);case 1:return this._band.getCount(e,this._rowCount,s);case 2:return this._band.getMin(e,this._rowCount,s);case 3:return this._band.getMax(e,this._rowCount,s);case 4:return this._band.getAvg(e,this._rowCount,s)}return super.evaluateFunc(t,e)}$_getRows(){let t=this._rows;if(!t&&this._group){t=[];for(let e=0;e<this._group.count;e++)t.push(e+this._group.row)}return t}}class Hr extends Ti{constructor(t){super(t)}get outlineLabel(){return"["+this.index+"] Group"}canRemoveFrom(){return!0}getEditProps(){return Hr.PROPINFOS}get field(){return this._field}set field(t){if(t!=this._field){const e=this._field;this._field=t,this._changed(Hr.PROP_FIELD,t,e)}}get pathLabel(){return"group"}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Hr.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Hr.PROPINFOS)}getPropDomain(t){if(t.name=Hr.PROP_FIELD)return this.getDataFieldNames()}}Hr.PROP_FIELD="field",Hr.PROPINFOS=[{name:Hr.PROP_FIELD,category:Ws.BAND,type:hs,multiple:!1,default:void 0}];class Qr extends Ti{constructor(t){super(t),this._sectionCount=1,this._sectionLayout=Li.DOWN_ACROSS,this._sectionGap=10,this._repeatMastreRow=!1,this._repeatDetailHeader=!1,this._repeatDetailFooter=!1,this._alwaysHeader=!0,this.pageNo=0,this.prevHead=!1,this.prevIndex=NaN,this.rowIndex=NaN,this.detailRows=NaN,this.add(this._detail=new Ur(this,"detail")),this._summaryRuntime=new Nr(this)}get dataObj(){return this._dataObj}get designData(){return this._designData}get detail(){return this._detail}get isDetail(){return!!this._master}get master(){return this._master}get bandLevel(){return this._master?this._master.bandLevel+1:0}get sectionCount(){return this.isDetail?1:this._sectionCount}set sectionCount(t){if((t=isNaN(t)?1:Math.max(1,t))!==this._sectionCount){const e=this._sectionCount;this._sectionCount=t,this._changed(Qr.PROP_DATA_BAND_SECTION_COUNT,t,e)}}get sectionLayout(){return this._sectionLayout}set sectionLayout(t){if(t!==this._sectionLayout){const e=this._sectionLayout;this._sectionLayout=t,this._changed(Qr.PROP_DATA_BAND_SECTIONLAYOUT,t,e)}}get sectionGap(){return this._sectionGap}set sectionGap(t){if((t=J.toNumber(t,0))!=this._sectionGap){const e=this._sectionGap;this._sectionGap=t,this._changed(Qr.PROP_DATA_BAND_SECTION_GAP,t,e)}}get maxRowCount(){return this._maxRowCount}set maxRowCount(t){if(isNaN(t)?t=void 0:t>>=0,t!==this._maxRowCount){const e=this._maxRowCount;this._maxRowCount=t,this._changed(Qr.PROP_DATA_BAND_MAX_ROW_COUNT,t,e)}}get rowsPerPage(){return this._rowsPerPage}set rowsPerPage(t){if(isNaN(t)?t=void 0:t>>=0,t!==this._rowsPerPage){const e=this._rowsPerPage;this._rowsPerPage=t,this._changed(Qr.PROP_DATA_BAND_ROWS_PER_PAGE,t,e)}}get maxRowsPerPage(){return this._maxRowsPerPage}set maxRowsPerPage(t){if(isNaN(t)?t=void 0:t>>=0,t!==this._maxRowsPerPage){const e=this._maxRowsPerPage;this._maxRowsPerPage=t,this._changed(Qr.PROP_DATA_BAND_MAX_ROWS_PER_PAGE,t,e)}}get endRowCount(){return this._endRowCount}set endRowCount(t){if(isNaN(t)?t=void 0:t>>=0,t!==this._endRowCount){const e=this._endRowCount;this._endRowCount=t,this._changed(Qr.PROP_DATA_BAND_END_ROW_COUNT,t,e)}}get maxEndRowCount(){return this._maxEndRowCount}set maxEndRowCount(t){if(isNaN(t)?t=void 0:t>>=0,t!==this._maxEndRowCount){const e=this._maxEndRowCount;this._maxEndRowCount=t,this._changed(Qr.PROP_DATA_BAND_MAX_END_ROW_COUNT,t,e)}}get endRowMessage(){return this._endRowMessage}set endRowMessage(t){if(t!==this._endRowMessage){const e=this._endRowMessage;this._endRowMessage=t,this._changed(Qr.PROP_DATA_BAND_END_ROW_MESSAGE,t,e)}}get masterFields(){return this._masterFields}set masterFields(t){if(t!=this._masterFields){const e=this._masterFields;this._masterFields=t,this._changed(Qr.PROP_DATA_BAND_MASTER_FIELDS,t,e)}}get keyFields(){return this._keyFields}set keyFields(t){if(t!=this._keyFields){const e=this._keyFields;this._keyFields=t,this._changed(Qr.PROP_DATA_BAND_KEY_FIELDS,t,e)}}get rowsPerMaster(){return this._rowsPerMaster}set rowsPerMaster(t){if(isNaN(t)?t=void 0:t>>=0,t!==this._rowsPerMaster){const e=this._rowsPerMaster;this._rowsPerMaster=t,this._changed(Qr.PROP_DATA_BAND_ROWS_PER_MASTER,t,e)}}get repeatMasterRow(){return this._repeatMastreRow}set repeatMasterRow(t){t!==this._repeatMastreRow&&(this._repeatMastreRow=t,this._changed(Qr.PROP_DATA_BAND_REPEAT_MASTER_ROW,t,!t))}get repeatDetailHeader(){return this._repeatDetailHeader}set repeatDetailHeader(t){t!==this._repeatDetailHeader&&(this._repeatDetailHeader=t,this._changed(Qr.PROP_DATA_BAND_REPEAT_DETAIL_HEADER,t,!t))}get repeatDetailFooter(){return this._repeatDetailFooter}set repeatDetailFooter(t){t!==this._repeatDetailFooter&&(this._repeatDetailFooter=t,this._changed(Qr.PROP_DATA_BAND_REPEAT_DETAIL_FOOTER,t,!t))}get alwaysHeader(){return this._alwaysHeader}set alwaysHeader(t){t!==this._alwaysHeader&&(this._alwaysHeader=t,this._changed(Qr.PROP_DATA_BAND_ALWAYS_HEADER,t,!t))}get summaryRuntime(){return this._summaryRuntime}prepareIndices(t){this._doPrepareIndices(t);for(let e=0;e<this._detail.count;e++){const s=this._detail.get(e);s instanceof Qr&&s.prepareIndices(t)}}getColPoints(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=this.sectionGap,i=this.sectionCount,r=(t-s*(i-1))/i,n=[e];for(let t=0;t<i-1;t++)n.push(e+=r),n.push(e+=s);return n.push(e+=r),n}getColWidth(t){const e=this.sectionGap,s=this.sectionCount;return(t-e*(s-1))/s}getValues(t,e,s){if(s){const i=t.dp.get(this.data),r=[];for(let t=0;t<s.length;t++)r.push(i.getRowValue(e,s[t]));return r}}_selectRow(t,e,s){if(this._keyFlds){for(let s=0;s<Math.min(this._keyFlds.length,this._masterFlds.length);s++){if(t.getRowValue(e,this._keyFlds[s])!==this.masterValues[s])return!1}return!0}return s<this.detailRows}_getNextDetailRows(t,e){const s=[],i=t.dp.get(this.data);if(i){const t=i.rowCount;let r=e,n=0;for(;r<t&&this._selectRow(i,r,n);)s.push(r++),n++}return s}_skipDetailRows(t,e){if(this._keyFields){const s=t.dp.get(this.data);if(s){const t=s.rowCount;let i=e;for(;i<t&&this._selectRow(s,i,0);)i++;return i-e}}return 0}getRowsPerPage(){let t=this._rowsPerPage,e=!1;return t>0?e=!0:t=this._maxRowsPerPage>0?this._maxRowsPerPage:Number.MAX_SAFE_INTEGER,{rowsPerPage:t,breakRowsPerPage:e}}getEndRowCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._endRowCount,s=!0;return e>0?(e+=t,s=!1):e=this._maxEndRowCount>0?this._maxEndRowCount+t:0,{endRowCount:e,stopEndRow:s}}getCount(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(isNaN(e)){if(s)return s.length;return this.$_getSummary(t,e).count}return e}getVCount(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(s)return e<s.length&&(s=s.slice(0,e)),s.length?this.$_getVCount(t,s):0;return this.$_getSummary(t,e).count}getSum(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(s)return e<s.length&&(s=s.slice(0,e)),s.length?this.$_getSum(t,s):0;return this.$_getSummary(t,e).sum}getMin(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(s)return e<s.length&&(s=s.slice(0,e)),s.length?this.$_getMin(t,s):NaN;return this.$_getSummary(t,e).min}getMax(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(s)return e<s.length&&(s=s.slice(0,e)),s.length?this.$_getMax(t,s):NaN;return this.$_getSummary(t,e).max}getAvg(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(s)return e<s.length&&(s=s.slice(0,e)),s.length?this.$_getSum(t,s)/s.length:NaN;return this.$_getSummary(t,e).avg}get designLevel(){return this.bandLevel}get dataDominant(){return!0}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(Qr.PROPINFOS)}_getStyleProps(){return["fontFamily","fontSize","fontWeight","color","backgroundColor"].concat(super._getStyleProps())}canAddTo(t){return super.canAddTo(t)&&!t.isDataRowContainer}canResize(t){return!1}canPageBreak(){return!0}_doLoad(t,e){super._doLoad(t,e),e.hasOwnProperty("columnCount")&&(this.sectionCount=e.columnCount),e.hasOwnProperty("columnLayout")&&(this.sectionLayout=e.columnLayout),e.hasOwnProperty("columnCount")&&(this.sectionGap=e.columnGap),this._loadPropsOf(e,Qr.PROPINFOS),e.hasOwnProperty("detail")&&this._detail.load(t,e.detail)}_doSave(t){super._doSave(t),this._savePropsOf(t,Qr.PROPINFOS),this._detail.save(t.detail={})}_doPreparePrint(t){var e;if(super._doPreparePrint(t),this.detailRows=Number.MAX_SAFE_INTEGER,this._keyFlds=this.isDetail&&this._keyFields?this._keyFields.split(/\s*\,\s*/):null,this._keyFlds){for(let t=0;t<this._keyFlds.length;t++)this._keyFlds[t]=this._keyFlds[t].trim();if(this._masterFields){this._masterFlds=this._masterFields?this._masterFields.split(/\s*\,\s*/):null;for(let t=0;t<this._masterFlds.length;t++)this._masterFlds[t]=this._masterFlds[t].trim()}else this._masterFlds=this._keyFlds}this._dataObj=t.dp.get(this.data),this._designData=null===(e=t.designDp)||void 0===e?void 0:e.get(this.data),this._fieldSummary={},this._summaryRuntime.prepare(this._dataObj,this._master&&this._master._dataObj)}clearSummary(){this._fieldSummary={}}testPrepare(t){this._dataObj=t,this._fieldSummary={}}$_getSummary(t,e){let s=this._fieldSummary[t];return s||(this._fieldSummary[t]=s={},this.$_calcSummary(t,s,e)),s}$_calcSummary(t,e,s){const i=this._dataObj,r=isNaN(s)?i.rowCount:s;let n=0,o=0,a=r?Number.MAX_VALUE:NaN,A=r?Number.MIN_VALUE:NaN;for(let e=0;e<r;e++){const s=+i.getRowValue(e,t);isNaN(s)||(n++,o+=s,a=Math.min(a,s),A=Math.max(A,s))}e.count=r,e.vcount=n,e.sum=o,e.min=a,e.max=A,e.avg=r?o/r:NaN}$_getVCount(t,e){const s=this._dataObj;let i=0;for(let r of e){const e=+s.getRowValue(r,t);isNaN(e)||i++}return i}$_getSum(t,e){const s=this._dataObj;let i=0;for(let r of e){const e=+s.getRowValue(r,t);isNaN(e)||(i+=e)}return i}$_getMin(t,e){const s=this._dataObj;let i=Number.MAX_VALUE;for(let r of e){const e=+s.getRowValue(r,t);isNaN(e)||(i=Math.min(i,e))}return i}$_getMax(t,e){const s=this._dataObj;let i=Number.MIN_VALUE;for(let r of e){const e=+s.getRowValue(r,t);isNaN(e)||(i=Math.max(i,e))}return i}}Qr.PROP_DATA_BAND_MASTER_FIELDS="masterFields",Qr.PROP_DATA_BAND_KEY_FIELDS="keyFields",Qr.PROP_DATA_BAND_ROWS_PER_MASTER="rowsPerMaster",Qr.PROP_DATA_BAND_SECTION_COUNT="sectionCount",Qr.PROP_DATA_BAND_SECTIONLAYOUT="sectionLayout",Qr.PROP_DATA_BAND_SECTION_GAP="sectionGap",Qr.PROP_DATA_BAND_MAX_ROW_COUNT="maxRowCount",Qr.PROP_DATA_BAND_ROWS_PER_PAGE="rowsPerPage",Qr.PROP_DATA_BAND_MAX_ROWS_PER_PAGE="maxRowsPerPage",Qr.PROP_DATA_BAND_REPEAT_MASTER_ROW="repeatMasterRow",Qr.PROP_DATA_BAND_REPEAT_DETAIL_HEADER="repeatDetailHeader",Qr.PROP_DATA_BAND_REPEAT_DETAIL_FOOTER="repeatDetailFooter",Qr.PROP_DATA_BAND_END_ROW_COUNT="endRowCount",Qr.PROP_DATA_BAND_MAX_END_ROW_COUNT="maxEndRowCount",Qr.PROP_DATA_BAND_END_ROW_MESSAGE="endRowMessage",Qr.PROP_DATA_BAND_ALWAYS_HEADER="alwaysHeader",Qr.PROPINFOS=[{name:Qr.PROP_DATA_BAND_MASTER_FIELDS,category:Ws.BAND,type:is,multiple:!1,default:void 0,visible:t=>t.isDetail},{name:Qr.PROP_DATA_BAND_KEY_FIELDS,category:Ws.BAND,type:is,multiple:!1,default:void 0,visible:t=>t.isDetail},{name:Qr.PROP_DATA_BAND_ROWS_PER_MASTER,category:Ws.BAND,type:rs,multiple:!1,default:void 0,visible:t=>t.isDetail},{name:Qr.PROP_DATA_BAND_SECTION_COUNT,category:Ws.BAND,type:rs,multiple:!1,default:1},{name:Qr.PROP_DATA_BAND_SECTIONLAYOUT,category:Ws.BAND,type:As,multiple:!1,default:Li.DOWN_ACROSS,domain:Li},{name:Qr.PROP_DATA_BAND_SECTION_GAP,category:Ws.BAND,type:rs,multiple:!1,default:10},{name:Qr.PROP_DATA_BAND_MAX_ROW_COUNT,category:Ws.DATA,type:rs,multiple:!1,default:void 0},{name:Qr.PROP_DATA_BAND_ROWS_PER_PAGE,category:Ws.BAND,type:rs,multiple:!1,default:void 0},{name:Qr.PROP_DATA_BAND_MAX_ROWS_PER_PAGE,category:Ws.BAND,type:rs,multiple:!1,default:void 0},{name:Qr.PROP_DATA_BAND_REPEAT_MASTER_ROW,category:Ws.BAND,type:as,multiple:!1,default:!1,visible:t=>!t.isDetail},{name:Qr.PROP_DATA_BAND_REPEAT_DETAIL_HEADER,category:Ws.BAND,type:as,multiple:!1,default:!1,visible:t=>t.isDetail},{name:Qr.PROP_DATA_BAND_REPEAT_DETAIL_FOOTER,category:Ws.BAND,type:as,multiple:!1,default:!1,visible:t=>t.isDetail},{name:Qr.PROP_DATA_BAND_END_ROW_COUNT,category:Ws.BAND,type:rs,multiple:!1,default:void 0},{name:Qr.PROP_DATA_BAND_MAX_END_ROW_COUNT,category:Ws.BAND,type:rs,multiple:!1,default:void 0},{name:Qr.PROP_DATA_BAND_END_ROW_MESSAGE,category:Ws.BAND,type:is,multiple:!1,default:void 0},{name:Qr.PROP_DATA_BAND_ALWAYS_HEADER,category:Ws.BAND,type:as,multiple:!1,default:!0}];class Ur extends Ti{constructor(t,e){super(""),this._owner=t,this._label=e,this.width="100%",this.designHeight=24}get owner(){return this._owner}getSaveType(){return this._label}get outlineLabel(){return"["+J.capitalize(this._label)+"]"}get designLevel(){return this._owner.designLevel}get marqueeParent(){return this._owner}canAdd(t){return t instanceof Qr&&super.canAdd(t)}canContainsBand(){return!0}_doItemAdded(t,e){super._doItemAdded(t,e),t instanceof Qr&&(t._master=this._owner)}}Ur.PROPINFOS=[];class Mr extends Fr{constructor(t,e){super(t,e)}getCollectionLabel(){return"tableBandColumn"}get band(){return this.collection.band}get displayPath(){return this.collection?this.collection.band.displayPath+".columns["+this.index+"]":"column"}get collection(){return super.collection}get marqueeParent(){var t;return null===(t=this.collection)||void 0===t?void 0:t.band}isAncestor(t){return t===this.collection.band}canRemoveFrom(){return this.collection&&this.collection.count>1}_changed(t,e,s){this.collection&&this.collection.$_columnChanged(this)}}class kr extends Dr{constructor(t){super(t)}get band(){return this.owner}_createColumn(t){return new Mr(this,t)}}class Vr extends Pr{constructor(t){super(t)}}Vr.$_ctor="TableBandCellItem";class Gr extends Or{constructor(t){super(null),this._band=t,this.rowCount=Gr.DEFAULT_ROWS,this.width="100%"}get band(){return this._band}_getStyleProps(){return Gr.STYLE_PROPS}needDesignWidth(){return!1}needDesignHeight(){return!1}canResize(t){return t===E.TOP||t===E.BOTTOM}get marqueeParent(){return this._band}get colCount(){return this._band?this._band.colCount:0}getColumn(t){return this._band.columns.get(t)}getCellWidths(){var t;return null===(t=this._band)||void 0===t?void 0:t.getCellWidths()}_createCell(t){return new Vr(t)}isAncestorOf(t){return!!super.isAncestorOf(t)||(t===this.rows||(t instanceof xr&&t.collection===this.rows||(!!this.rows.isAncestorOf(t)||void 0)))}}Gr.PROP_LINES="lines",Gr.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor"],Gr.DEFAULT_ROWS=1;class Kr extends Gr{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(t),this._repeat=!0,this._pageSection=e}get repeat(){return this._repeat}set repeat(t){t!=this._repeat&&(this._repeat=t,this._changed(Kr.PROP_TABLE_BAND_HEADER_REPEAT,t,!t))}get outlineLabel(){return this._pageSection?"[Page Header]":"[Band Header]"}get pathLabel(){return"header"}}Kr.PROP_TABLE_BAND_HEADER_REPEAT="repeat",Kr.$_ctor="TableBandHeader";class Wr extends Gr{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(t),this._attachToBody=!1,this._pageSection=e}get attachToBody(){return this._attachToBody}set attachToBody(t){t!==this._attachToBody&&(this._attachToBody=t,this._changed(Wr.PROP_ATTACH_TO_BODY,t,!t))}get outlineLabel(){return this._pageSection?"[Page Footer]":"[Band Footer]"}get pathLabel(){return"footer"}_getEditProps(){return super._getEditProps().concat(Wr.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Wr.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Wr.PROPINFOS)}}Wr.PROP_ATTACH_TO_BODY="attachToBody",Wr.PROPINFOS=[{name:Wr.PROP_ATTACH_TO_BODY,category:Ws.BAND,type:as,multiple:!1,default:!1}],Wr.$_ctor="TableBandFooter";class zr extends Ir{constructor(){super(...arguments),this._autoMerge=!1}get autoMerge(){return this._autoMerge}set autoMerge(t){t!==this._autoMerge&&(this._autoMerge=t,this._changed(zr.PROP_AUTO_MERGE,t,!t))}getEditProps(){return super.getEditProps().concat(zr.PROPINFOS)}_doLoad(t){super._doLoad(t),this._loadPropsOf(t,zr.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,zr.PROPINFOS)}}zr.PROP_AUTO_MERGE="autoMerge",zr.$_ctor="TableBandCellItem",zr.PROPINFOS=[{name:zr.PROP_AUTO_MERGE,category:Ws.CELL,type:as,multiple:!0,default:!1}];class $r extends Tr{getMergedCells(){return this._vcells.filter((t=>t.autoMerge))}_createCell(t,e){return new zr(this,t,e)}}class Xr extends Gr{constructor(){super(...arguments),this.masterRow=NaN}get blankItems(){return this._blankItems}canBlank(t,e){if(this.band.dataObj.equalRows(e,e-1,t.$_blankFlds))return!0}getMergedColumns(){const t=[];return this.items.forEach((e=>{const s=e.item;if(s.mergedInGroup){const e=s.col;t.indexOf(e)<0&&t.push(e)}})),t.length?t:null}getMergedCells(){let t=1===this.rowCount?this.cells.getMergedCells():null;return t&&t.length>0&&(t=t.filter((t=>{var e;return!(null===(e=this.getCellItem(t))||void 0===e?void 0:e.isEmpty)}))),t}get outlineLabel(){return"[Data Row]"}get pathLabel(){return"dataRow"}get dataDominant(){return!0}get isDataRowContainer(){return!0}_createCells(){return new $r(this)}_getChildPropInfos(t){return Xr.CHILD_PROPS.concat(super._getChildPropInfos(t))}_doLoadChild(t,e){super._doLoadChild(t,e),this._loadChildPropsOf(t,e,Xr.CHILD_PROPS)}_doPreparePrint(t){super._doPreparePrint(t),this._blankItems=this.$_collectBlankItems()}$_collectBlankItems(){return this.collectBlankItems(this.items.map((t=>t.item)))}}Xr.PROP_EQUAL_BLANK="equalBlank",Xr.PROP_BLANK_FIELDS="blankFields",Xr.PROP_MERGED_IN_GROUP="mergedInGroup",Xr.CHILD_PROPS=[{name:Xr.PROP_EQUAL_BLANK,category:Ws.BAND,type:as,multiple:!1,default:!1},{name:Xr.PROP_BLANK_FIELDS,category:Ws.BAND,type:is,multiple:!1,default:void 0},{name:Xr.PROP_MERGED_IN_GROUP,category:Ws.BAND,type:as,multiple:!1,default:!1}],Xr.$_ctor="TableBandRow";class jr extends Or{constructor(t,e){super(e),this._group=t,this.rowCount=jr.DEFAULT_ROWS,this.width="100%"}get group(){return this._group}get band(){var t;return null===(t=this._group)||void 0===t?void 0:t.band}_getStyleProps(){return Gr.STYLE_PROPS}needDesignHeight(){return!1}needDesignWidth(){return!1}canResize(t){return t===E.TOP||t===E.BOTTOM}get marqueeParent(){return this.band}get colCount(){return this.band?this.band.colCount:0}getColumn(t){return this.band.columns.get(t)}getCellWidths(){var t;return null===(t=this.band)||void 0===t?void 0:t.getCellWidths()}_createCell(t){return new Vr(t)}isAncestorOf(t){return!!super.isAncestorOf(t)||(t===this.rows||(!!this.rows.isAncestorOf(t)||void 0))}}jr.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor"],jr.DEFAULT_ROWS=1;class Yr extends jr{constructor(t){super(t,"groupHeader")}get outlineLabel(){return"[Group Header]"}get pathLabel(){return"header"}}Yr.$_ctor="TableBandRowGroupHeader";class Jr extends jr{constructor(t){super(t,"groupFooter"),this._merged=!0}get merged(){return this._merged}set merged(t){t!=this._merged&&(this._merged=t,this._changed(Jr.PROP_MERGED,t,!t))}get outlineLabel(){return"[Group Footer]"}get pathLabel(){return"footer"}getEditProps(){return super.getEditProps().concat(Jr.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Jr.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Jr.PROPINFOS)}}Jr.PROP_MERGED="merged",Jr.PROPINFOS=[],Jr.$_ctor="TableBandRowGroupFooter";class Zr extends Hr{constructor(t){super("tableBandRowGroup"),this._merged=!0,this.add(this._header=new Yr(this)),this.add(this._footer=new Jr(this)),this._collection=t}get outlineParent(){return this._collection}get marqueeParent(){return this.band}getEditProps(){return super.getEditProps().concat(Zr.PROPINFOS)}getCollectionLabel(){return"tableBandGroup"}get header(){return this._header}get footer(){return this._footer}get band(){var t;return null===(t=this._collection)||void 0===t?void 0:t.band}get page(){var t;return null===(t=this.band)||void 0===t?void 0:t.page}get report(){var t;return null===(t=this.band)||void 0===t?void 0:t.report}get collection(){return this._collection}get dataParent(){return this.band}get outlineLabel(){return"[Group]"}get displayPath(){return this.collection?this.collection.band.displayPath+".groups["+this.index+"]":"group"}_ignoreItems(){return!0}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Zr.PROPINFOS),e.hasOwnProperty("header")&&this._header.load(t,e.header),e.hasOwnProperty("footer")&&this._footer.load(t,e.footer)}_doSave(t){super._doSave(t),this._savePropsOf(t,Zr.PROPINFOS),this._header.save(t.header={}),this._footer.save(t.footer={})}_changed(t,e,s){super._changed(t,e,s),this._collection&&this._collection.$_groupChanged(this)}}Zr.PROPINFOS=[];class qr extends Fi{constructor(t){super(),this._groups=[],this._band=t}get outlineParent(){return this._band}get outlineLabel(){return"[Groups]"}get outlineExpandable(){return!0}get outlineItems(){return this._groups}getSaveType(){return"groups"}get owner(){return this._band}get band(){return this._band}get count(){return this._groups.length}get items(){return this._groups.slice()}get visibleCount(){let t=0;for(let e of this._groups)e.visible&&t++;return t}get groups(){return this._groups.slice()}load(t,e){if(this._groups=[],e&&e.length>0){for(let s of e)if(s){const e=new Zr(this);e.load(t,s),this._groups.push(e)}this.$_invalidateGroups()}}save(t){for(let e of this._groups){const s={};e.save(s),t.push(s)}}get(t){return this._groups[t]}indexOf(t){return this._groups.indexOf(t)}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=this.$_add(t,e);if(s)return this.$_invalidateGroups(),this._itemAdded(s),s}addAll(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(!t||t.length<1)return;const s=this._groups.length;e=e<0?this._groups.length:Math.max(0,this._groups.length);for(let s of t)this.$_add(s,e)&&e++;return this._groups.length!=s?(this.$_invalidateGroups(),!0):void 0}removeAt(t){if(t>=0&&t<this._groups.length){const e=this._groups.splice(t,1)[0];return this.$_invalidateGroups(),this._itemRemoved(e,this._band),!0}}remove(t){return this.removeAt(this.indexOf(t))}clear(){if(this._groups.length>0)return this._groups=[],this.$_invalidateGroups(),!0}getValidGroups(t){if(t){const e=[];for(let s of this._groups){const i=s.field;J.isNumber(i)?i>=0&&i<t.fieldCount&&e.push(s):t.containsField(i)&&e.push(s)}return e.length?e:null}return null}get page(){var t;return null===(t=this._band)||void 0===t?void 0:t.page}get displayPath(){return this._band?this._band.displayPath+".groups":"groups"}get level(){return this._band?this._band.level+1:0}isAncestorOf(t){if(super.isAncestorOf(t))return!0;if(this._groups.indexOf(t)>=0)return!0;for(let e of this._groups)if(e.indexOf(t))return!0}_doMoveItem(t,e){return!1}$_add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(!(t instanceof Zr)){const e=t;t=new Zr(this),e&&t.extend(e),t.header.cells.prepareCells(),t.footer.cells.prepareCells()}if(t instanceof Zr&&this._groups.indexOf(t)<0)return e<0?this._groups.push(t):this._groups.splice(Math.min(e,this._groups.length),0,t),t}$_invalidateGroups(){for(let t=this._groups.length-1;t>=0;t--)this._groups[t]._index=t;this._band&&this._band.$_groupChanged(null)}$_groupChanged(t){this._band&&this._band.$_groupChanged(t)}}class tn extends Qr{constructor(t){super(t),this._columns=new kr(this),this._groups=new qr(this),this.add(this._header=new Kr(this)),this.add(this._footer=new Wr(this)),this.add(this._dataRow=new Xr(this)),this._tables=[this._header,this._footer,this._dataRow],this._setOutlineOrders(1,this._dataRow,this._footer,this.detail),this.width="100%"}get outlineItems(){return[this._columns,this._groups].concat(super.outlineItems)}get colCount(){return this._colCount||0}set colCount(t){if((t=Math.max(1,t))!==this._colCount){const e=this._colCount,s=e-t;this._colCount=t,this._columns.count=t,t<e?this._tables.forEach((e=>{e._removeCols(t,s)})):this._tables.forEach((t=>{t._resetCells()})),this._changed(tn.PROP_COL_COUNT,t,e)}}get columns(){return this._columns}get groups(){return this._groups}get header(){return this._header}get footer(){return this._footer}get dataRow(){return this._dataRow}get pr(){return this._pr}get tr(){return this._tr}get lastTrs(){return this._lastTrs}getColumn(t){return this._columns.get(t)}getGroup(t){return this._groups.get(t)}getTables(){const t=this._groups,e=[this._header,this._dataRow,this._footer];for(let s=0;s<t.count;s++){const i=t.get(s);e.push(i.header,i.footer)}return e}removeColumn(t){const e="number"==typeof t?t:this._columns.indexOf(t);e>=0&&e<this._colCount&&(this._columns.remove(e),this._colCount--,this.getTables().forEach((t=>{t._removeColumn(e)})),this._changed(tn.PROP_COL_COUNT,this._colCount,this._colCount+1))}addColumn(t,e){if(t>=0&&t<=this._colCount){const s=this._columns.add(e,t);return this._colCount++,this.getTables().forEach((e=>{e._addColumn(t)})),this._changed(tn.PROP_COL_COUNT,this._colCount,this._colCount-1),s}}canMoveColumns(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!this.getTables().some((r=>!r.canMoveCols(t,e,s,i)))}getNearestMovableColumn(t,e,s){let i=t+s;return this.getTables().forEach((r=>{const n=r.getNearestMovableColumn(t,e,s);i=s>0?Math.max(i,n):Math.min(i,n)})),i}moveColumns(t,e,s){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]||this.canMoveColumns(t,e,s))return this._columns.move(t,e,s),this.getTables().forEach((i=>{i._moveCols(t,e,s)})),this.layoutChanged=!0,this._changed(Or.PROP_CELL_LAYOUT,void 0,void 0),this._columns._indexChanged(),!0}getCellWidths(){return this._columns.getWidths()}setPrinting(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t.row=this._pr=e,this._tr+=s,this._lastTrs=s}getSaveType(){return"tableband"}get outlineLabel(){return"[Table Band]"}get isBand(){return!0}_ignoreItems(){return!0}_getEditProps(){return super._getEditProps().concat(tn.PROPINFOS)}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),isNaN(this._colCount)&&(this.colCount=tn.DEFAULT_COL_COUNT)}isAncestorOf(t){return!!super.isAncestorOf(t)||(t instanceof Mr&&t.band===this||(t===this._groups||(!!this._groups.isAncestorOf(t)||void 0)))}_doLoad(t,e){super._doLoad(t,e),e&&(this._loadProps(e,"colCount"),e.hasOwnProperty("fields")&&(this._colCount=this._columns.load(e.fields,this._colCount)),e.hasOwnProperty("columns")&&(this._colCount=this._columns.load(e.columns,this._colCount)),e.hasOwnProperty("groups")&&this._groups.load(t,e.groups),e.hasOwnProperty("header")&&this._header.load(t,e.header),e.hasOwnProperty("footer")&&this._footer.load(t,e.footer),e.hasOwnProperty("row")&&this._dataRow.load(t,e.row),e.hasOwnProperty("dataRow")&&this._dataRow.load(t,e.dataRow))}_doSave(t){super._doSave(t),this._saveProps(t,"colCount"),this._columns.count&&this._columns.save(t.columns=[]),this._groups.count&&this._groups.save(t.groups=[]),this._header.save(t.header={}),this._footer.save(t.footer={}),this._dataRow.save(t.dataRow={})}$_columnChanged(t){this._changed(tn.PROP_COLUMNS,this._columns,this._columns)}$_groupChanged(t){this._changed(tn.PROP_GROUPS,this._groups,this._groups)}_doPreparePrint(t){super._doPreparePrint(t),this._groups.preparePrint(t)}_doPrepareIndices(t){t.row=t.index=this._pr=this._tr=0,this._lastTrs=0}remove(t){}getNextDetailRows(t){return this._getNextDetailRows(t,this._pr)}skipDetailRows(t){const e=this._skipDetailRows(t,this._pr);this._pr+=e}containsInSection(t){return this._header.contains(t,!0)||this._footer.contains(t,!0)}}tn.PROP_COL_COUNT="colCount",tn.PROP_COLUMNS="columns",tn.PROP_GROUPS="groups",tn.PROPINFOS=[{name:tn.PROP_COL_COUNT,category:Ws.TABLE,type:rs,multiple:!1,default:0}],tn.DEFAULT_COL_COUNT=5,tn.$_ctor="TableBand",tn.ITEM_TYPE="Table Band";class en extends br{constructor(t,e){if(super("Change tableband cols"),Z(!!t),this._band=t,this._oldCols=t.colCount,this._cols=e,e<this._oldCols){const s=this._deleted=[[],[],[]];t.getTables().forEach((t=>{let i=[];for(let s=e;s<this._oldCols;s++)i=i.concat(t.getColItems(s));s.push(i)}));const i=this._cells=[];t.getTables().forEach((t=>{i.push(t.cells.truncateCol(e))}))}}_doDispose(){this._band=null}get band(){return this._band}get cols(){return this._cols}redo(t){this._band.colCount=this._cols}undo(){const t=this._band,e=this._deleted,s=this._cells;t.colCount=this._oldCols,e&&(t.getTables().forEach(((t,s)=>{e[s].forEach((e=>{t.add(e)}))})),t.getTables().forEach(((t,e)=>{t.cells.restoreCells(s[e])})))}get source(){return this._band}}class sn extends br{constructor(t,e,s){super("Add Band Field"),Z(!!t),this._band=t,this._index=e,this._config=s}_doDispose(){this._band=this._column=null}get band(){return this._band}get index(){return this._index}redo(t){const e=this._band,s=this._index,i=this._cells=[];e.getTables().forEach((t=>{i.push(t.cells.addCol(s))})),this._column=e.addColumn(s,this._config)}undo(){const t=this._band,e=this._index;t.getTables().forEach((t=>{t.cells.removeCol(e)})),t.removeColumn(this._column),t.getTables().forEach(((t,e)=>{t.cells.restoreCells(this._cells[e])}))}get source(){return this._column}}class rn extends br{constructor(t){super("Remove TableBandColumn"),this._deleted=[],Z(!!t);const e=this._band=t.band;Z(!!e),this._column=t;const s=this._index=e.columns.indexOf(t);e.getTables().forEach((t=>{this._deleted.push(t.getColItems(s))}))}_doDispose(){this._band=this._column=null}get band(){return this._band}get column(){return this._column}get index(){return this._index}redo(t){this._cells=[],this._band.getTables().forEach((t=>{this._cells.push(t.cells.removeCol(this._index))})),this._band.removeColumn(this._column)}undo(){const t=this._band,e=this._index;t.getTables().forEach(((t,s)=>{t.cells.addCol(e)})),t.addColumn(e,this._column),t.getTables().forEach(((t,e)=>{this._deleted[e].forEach((e=>{t.add(e)})),t.cells.restoreCells(this._cells[e])}))}get source(){return this._column}}class nn extends br{constructor(t,e,s,i,r){super("Move TableBand Columns"),this._band=t,Z(!!t),this._column=t.getColumn(this._index=e),this._count=s,this._newIndex=i,this._force=r}_doDispose(){this._band=this._column=null}get band(){return this._band}redo(t){this._cells=[],this._band.getTables().forEach((t=>{if(this._cells.push(t.cells.moveCols(this._index,this._count,this._newIndex)),!this._cells)throw new Error("TableCellCollection.moveCols failed: "+this._index+", "+this._count+", "+this._newIndex)})),this._band.moveColumns(this._index,this._count,this._newIndex,this._force)}undo(){this._band.getTables().forEach(((t,e)=>{t.cells.restoreCells(this._cells[e])})),this._band.moveColumns(this._newIndex,this._count,this._index,!0)}get source(){return this._column}}class on extends Fr{constructor(t,e){super(t,e)}get table(){return this.collection.table}get displayPath(){return this.collection?this.collection.table.displayPath+".columns["+this.index+"]":"column"}get collection(){return super.collection}get marqueeParent(){var t;return null===(t=this.collection)||void 0===t?void 0:t.table}isAncestor(t){return t===this.collection.table}canRemoveFrom(){return this.collection&&this.collection.count>1}_changed(t,e,s){this.collection&&this.collection.$_columnChanged(this)}}class an extends Dr{constructor(t){super(t)}get table(){return this.owner}_createColumn(t){return new on(this,t)}}class An extends Pr{constructor(t){super(t)}get pathLabel(){return"cell["+this.row+","+this.col+"]"}}An.$_ctor="TableCellItem";class ln extends Or{constructor(t){super(t),this._columns=new an(this)}changeColumnWidth(t,e){}getColumnWidth(t){return this._columns.get(t).width}get outlineItems(){return[this._columns].concat(super.outlineItems)}get baseTable(){return this._baseTable}set baseTable(t){if(t!=this._baseTable){const e=this._baseTable;this._baseTable=t,this._changed(ln.PROP_BASE_TABLE,t,e)}}get colCount(){return this._colCount||0}set colCount(t){if((t=Math.max(1,t))!==this._colCount){const e=this._colCount;this._colCount=t,this._columns.count=t,t<e?this._removeCols(t,e-t):this._resetCells(),this._changed(ln.PROP_COL_COUNT,t,e)}}get columns(){return this._columns}getColumn(t){return this._columns.get(t)}removeColumn(t){const e="number"==typeof t?t:this._columns.indexOf(t);e>=0&&e<this._colCount&&(this._columns.remove(e),this._colCount--,this._removeColumn(e),this._changed(ln.PROP_COL_COUNT,this._colCount,this._colCount+1))}addColumn(t,e){if(t>=0&&t<=this._colCount){const s=this._columns.add(e,t);return this._colCount++,this._addColumn(t),this._changed(ln.PROP_COL_COUNT,this._colCount,this._colCount-1),s}}canMoveColumns(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.canMoveCols(t,e,s,i)}moveColumns(t,e,s){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]||this.canMoveCols(t,e,s))return this._columns.move(t,e,s),this._moveCols(t,e,s),this.layoutChanged=!0,this._changed(Or.PROP_CELL_LAYOUT,void 0,void 0),this._columns._indexChanged(),!0}getSaveType(){return"table"}get outlineLabel(){return"[Table] ("+this.rowCount+" x "+this.colCount+")"}get pathLabel(){return"table"}needDesignWidth(){return!1}needDesignHeight(){return!1}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(ln.PROPINFOS)}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),isNaN(this._colCount)&&(this.colCount=ln.DEFAULT_COL_COUNT,this.rowCount=ln.DEFAULT_ROW_COUNT);const r=this.colCount;this.width="100%",this._columns.forEach(((t,e)=>{const s=Math.floor(100/r);t.width=s+"%"}))}_doLoad(t,e){e&&(this._loadProps(e,"data","colCount","baseTable"),e.hasOwnProperty("columns")&&(this._colCount=this._columns.load(e.columns,this._colCount)),super._doLoad(t,e))}_doLoadChild(t,e){super._doLoadChild(t,e),this._loadChildProps(t,[],e)}_doSave(t){super._doSave(t),this._saveProps(t,"data","colCount","baseTable"),this._columns.count&&this._columns.save(t.columns=[])}_createCell(t){return new An(t)}getCellWidths(){return this._baseContainer&&this._baseContainer.getCellWidths()||this._columns.getWidths()}prepareLayout(){return this._baseContainer=this._baseTable&&this.page.getItem(this._baseTable),super.prepareLayout()}isAncestorOf(t){return super.isAncestorOf(t)||t instanceof on&&t.collection.parent===this||t instanceof xr&&t.table===this}$_columnChanged(t){this._changed(ln.PROP_COLUMNS,this._columns,this._columns)}}ln.PROP_BASE_TABLE="baseTable",ln.PROP_COL_COUNT="colCount",ln.PROP_COLUMNS="columns",ln.PROPINFOS=[{name:ln.PROP_BASE_TABLE,category:Ws.TABLE,type:is,multiple:!1,default:void 0},{name:ln.PROP_COL_COUNT,category:Ws.TABLE,type:rs,multiple:!1,default:0}],ln.DEFAULT_ROW_COUNT=4,ln.DEFAULT_COL_COUNT=4,ln.$_ctor="TableContainer",ln.ITEM_TYPE="Table";class hn extends br{constructor(t,e){if(super("Change table cols"),Z(!!t),this._table=t,this._oldCols=t.colCount,this._cols=e,e<this._oldCols){this._deleted=[],this._indices=[];for(let s=0;s<t.rowCount;s++)for(let i=e;i<this._oldCols;i++){const e=t.getCellItemAt(s,i);e&&(this._deleted.push(e.item),this._indices.push(e.index))}this._deleted=this._deleted.sort(((t,e)=>t.parent.index-e.parent.index)),this._indices=this._indices.sort(((t,e)=>t-e)),this._cells=t.cells.truncateCol(e)}}_doDispose(){this._table=null}get table(){return this._table}get cols(){return this._cols}redo(t){this._table.colCount=this._cols}undo(){const t=this._table;t.colCount=this._oldCols,this._deleted&&(this._deleted.forEach(((e,s)=>{t.add(e,this._indices[s])})),t.cells.restoreCells(this._cells))}get source(){return this._table}}class dn extends br{constructor(t){super("Remove TableColumn"),this._deleted=[],Z(!!t);const e=this._table=t.table;Z(!!e),this._column=t;const s=this._index=e.columns.indexOf(t);this._deleted=e.getColItems(s)}_doDispose(){this._table=this._column=null}get table(){return this._table}get column(){return this._column}get index(){return this._index}redo(t){this._cells=this._table.cells.removeCol(this._index),this._table.removeColumn(this._column)}undo(){const t=this._table;t.cells.addCol(this._index),t.addColumn(this._index,this._column),this._deleted.forEach((e=>{t.append(e,!0)})),t.cells.restoreCells(this._cells)}get source(){return this._column}}class cn extends br{constructor(t,e){super("Add Table Column"),this._table=t,Z(!!t),this._index=e}_doDispose(){this._table=this._column=null}get table(){return this._table}get index(){return this._index}redo(t){this._cells=this._table.cells.addCol(this._index),this._column=this._table.addColumn(this._index,null)}undo(){this._table.cells.removeCol(this._index),this._table.removeColumn(this._index),this._table.cells.restoreCells(this._cells)}get source(){return this._column}}class un extends br{constructor(t,e,s,i,r){super("Move Table Columns"),this._table=t,Z(!!t),this._column=t.getColumn(this._index=e),this._count=s,this._newIndex=i,this._force=r}_doDispose(){this._table=this._column=null}get table(){return this._table}redo(t){if(this._cells=this._table.cells.moveCols(this._index,this._count,this._newIndex),!this._cells)throw new Error("TableCellCollection.moveRows failed: "+this._index+", "+this._count+", "+this._newIndex);this._table.moveColumns(this._index,this._count,this._newIndex,this._force)}undo(){this._table.cells.restoreCells(this._cells),this._table.moveColumns(this._newIndex,this._count,this._index,!0)}get source(){return this._column}}class pn extends br{constructor(t,e){super("Change table rows"),Z(!!t);const s=this._oldCount=t.rowCount,i=t.colCount;if(this._table=t,this._rows=e,e<s){this._deleted=[],this._indices=[];for(let r=e;r<s;r++)for(let e=0;e<i;e++){const s=t.getCellItemAt(r,e);s&&(this._deleted.push(s.item),this._indices.push(s.index))}this._deleted=this._deleted.sort(((t,e)=>t.parent.index-e.parent.index)),this._indices=this._indices.sort(((t,e)=>t-e)),this._cells=t.cells.truncateRow(e)}}_doDispose(){this._table=null}get table(){return this._table}get cols(){return this._rows}redo(t){this._table.rowCount=this._rows}undo(){const t=this._table;t.rowCount=this._oldCount,this._deleted&&(this._deleted.forEach(((e,s)=>{t.add(e,this._indices[s])})),t.cells.restoreCells(this._cells))}get source(){return this._table}}class _n extends br{constructor(t){super("Remove TableRow"),Z(!!t);const e=this._table=t.table;Z(!!e),this._row=t;const s=this._index=e.rows.indexOf(t);this._deleted=e.getRowItems(s)}_doDispose(){this._table=this._row=this._cells=null}get table(){return this._table}get row(){return this._row}get index(){return this._index}redo(t){this._cells=this._table.cells.removeRow(this._index),this._table.removeRow(this._row)}undo(){const t=this._table;t.cells.addRow(this._index),t.addRow(this._index,this._row),this._deleted.forEach((e=>{t.append(e,!0)})),t.cells.restoreCells(this._cells)}get source(){return this._row}}class gn extends br{constructor(t,e){super("Add TableRow"),this._table=t,Z(!!t),this._index=e}_doDispose(){this._table=this._row=null}get table(){return this._table}get index(){return this._index}redo(t){this._cells=this._table.cells.addRow(this._index),this._row=this._table.addRow(this._index,null)}undo(){this._table.cells.removeRow(this._index),this._table.removeRow(this._index),this._table.cells.restoreCells(this._cells)}get source(){return this._row}}class fn extends br{constructor(t,e,s,i,r){super("Move Table Rows"),this._table=t,Z(!!this._table),this._row=t.rows.get(this._index=e),this._count=s,this._newIndex=i,this._force=r}_doDispose(){this._table=this._row=null}get table(){return this._table}redo(t){if(this._cells=this._table.cells.moveRows(this._index,this._count,this._newIndex),!this._cells)throw new Error("TableCellCollection.moveRows failed: "+this._index+", "+this._count+", "+this._newIndex);this._table.moveRows(this._index,this._count,this._newIndex,this._force)}undo(){this._table.cells.restoreCells(this._cells),this._table.moveRows(this._newIndex,this._count,this._index,!0)}get source(){return this._row}}class mn extends br{constructor(t){super("Merge Table Selection"),this._table=t.table,Z(!!this._table),this._sel=t;const e=this._bounds=t.table.cells.mergeBoundsOf(t);this._deleted=this._table.getRectItems(e.r1,e.c1,e.r2,e.c2,!0)}_doDispose(){this._table=this._bounds=null}get table(){return this._table}get bounds(){return this._bounds}redo(t){const e=this._bounds;this._cells=this._table.cells.merge(e.r1,e.c1,e.r2,e.c2),this._table.mergeCells(e.r1,e.c1,e.r2,e.c2)}undo(){const t=this._table;this._deleted.forEach((e=>{t.append(e,!0)})),t.cells.restoreCells(this._cells)}get source(){return this._sel.selectItem}}class wn extends br{constructor(t){super("Unmerge Table Cell"),this._table=t.table,Z(!!this._table),this._cell=t}_doDispose(){this._table=this._cell=null}get table(){return this._table}redo(t){this._cells=this._table.cells.unmerge(this._cell)}undo(){this._table.cells.restoreCells(this._cells)}get source(){return this._cell}}class yn extends br{constructor(t,e,s,i){super("Adjust Table Column Widths"),this._table=t,Z(!!this._table),this._column=t.getColumn(e),Z(!!this._column),this._sibling=t.getColumn(e+1),Z(!!this._sibling),this._colPoints=s.slice(0),this._newSize=i,this._oldWidth=this._column.width,this._oldSiblingWidth=this._sibling.width}_doDispose(){this._table=this._column=this._sibling=null}redo(t){if(J.isNotDefined(this._newWidth)){const t=this._table.columns.adjustWidths(this._column.index,this._colPoints,this._newSize);this._newWidth=t[0],this._newSiblingWidth=t[1]}this._column.width=this._newWidth,this._sibling.width=this._newSiblingWidth}undo(){this._column.width=this._oldWidth,this._sibling.width=this._oldSiblingWidth}get source(){return this._column}}class Cn extends br{constructor(t,e,s,i){super("Adjust Table Row Heights"),this._table=t,Z(!!this._table),this._row=t.getRow(e),Z(!!this._row),this._sibling=t.getRow(e+1),Z(!!this._sibling),this._rowPoints=s.slice(0),this._newSize=i,this._oldHeight=this._row.height,this._oldSiblingHeight=this._sibling.height}_doDispose(){this._table=this._row=this._sibling=null}redo(t){if(J.isNotDefined(this._newHeight)){const t=this._table.rows.adjustHeights(this._row.index,this._rowPoints,this._newSize);this._newHeight=t[0],this._newSiblingHeight=t[1]}this._row.height=this._newHeight,this._sibling.height=this._newSiblingHeight}undo(){this._row.height=this._oldHeight,this._sibling.height=this._oldSiblingHeight}get source(){return this._row}}class bn extends Ri{constructor(t,e){super(e),this._chart=t,this.visible=this._isDefaultVisible()}get chart(){return this._chart}canHide(){return!0}getWrapper(){return{enabled:this.visible}}get page(){return this._chart.page}get report(){return this._chart.report}get dataParent(){return this._chart}get marqueeParent(){return this._chart}getSaveType(){return""}_getEditProps(){return bn.PROPINFOS}_doLoad(t,e){e.hasOwnProperty("visible")&&(this.visible=e.visible),this._loadProp(e,"styles")}_doSave(t){t.visible=this.visible,this._saveProp(t,"styles")}_isDefaultVisible(){return!0}_getPropsWrapper(t,e,s){const i=this.getEditProps();return i&&i.forEach((i=>{if(!e||e.indexOf(i.name)<0){const e=this[i.name],r=s&&s[i.name]||i.name;e instanceof bn||void 0!==e&&(t[r]=e)}})),t}}bn.PROPINFOS=[{name:Ri.PROP_VISIBLE,category:Ws.BASIC,type:as,multiple:!1,default:void 0,visible:t=>t.canHide()}];class vn extends bn{constructor(t){super(t),this._text="Title"}get text(){return this._text}set text(t){if(t!==this._text){const e=this._text;this._text=t,this._changed(vn.PROP_TEXT,t,e)}}_getEditProps(){return super._getEditProps().concat(vn.PROPINFOS)}_getStyleProps(){return["color","fontSize","fontWeight"]}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,vn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,vn.PROPINFOS)}getWrapper(){const t=super.getWrapper();return t.text=this.visible?this._text:"",t.style=J.extend({},this.styles),t}}vn.PROP_TEXT="text",vn.PROPINFOS=[{name:vn.PROP_TEXT,category:"",type:is,multiple:!1,default:void 0}];class Bn extends bn{constructor(t){super(t),this._designVisible=!0,this._values=J.iarandom(2,9,5)}getPropDomain(t){if(this.report){if(t.name===Bn.PROP_DATA)return[void 0].concat(this.chart.report.designData.getNames());if(t.name===Bn.PROP_VALUE_FIELD)return this.getDataFieldNames()}}get id(){return this._id}set id(t){if(t!==this._id){const e=this._id;this._id=t,this._changed(Bn.PROP_SERIES_ID,t,e)}}get designVisible(){return this._designVisible}set designVisible(t){t!=this._designVisible&&(this._designVisible=t,this._changed(Bn.PROP_DESIGN_VISIBLE,t,!t))}get valueField(){return this._valueField}set valueField(t){if(t!==this._valueField){const e=this._valueField;this._valueField=t,this._changed(Bn.PROP_VALUE_FIELD,t,e)}}get values(){return this._values}set values(t){if(t!==this._values){const e=this._values;this._values=null==t?void 0:t.slice(),this._changed(Bn.PROP_VALUES,t,e)}}hasValuesProp(){return!0}getValues(t,e){if(t.printing&&this._valueField){const t=this.data||this._getParentData();if(t)return e.getFieldValues(t,this._valueField)}return this._values}getSaveType(){return this.seriesType}get displayPath(){return this.chart.displayPath+".series["+this.index+"]"}get outlineLabel(){const t=J.capitalize(this.seriesType);return"["+this.index+"] "+(this.name?this.name+"("+t+")":t)}_getEditProps(){return super._getEditProps().concat(Bn.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Bn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Bn.PROPINFOS)}}Bn.PROP_SERIES_ID="id",Bn.PROP_DESIGN_VISIBLE="designVisible",Bn.PROP_VALUE_FIELD="valueField",Bn.PROP_VALUES="values",Bn.PROPINFOS=[{name:Bn.PROP_SERIES_ID,category:Ws.SERIES,type:is},{name:Bn.PROP_DESIGN_VISIBLE,category:Ws.DESIGN,type:as,multiple:!1,default:!0},{name:Ri.PROP_NAME,category:Ws.BASIC,type:is,multiple:!1,default:void 0},{name:Ri.PROP_DATA,category:Ws.DATA,type:hs,multiple:!1,default:void 0},{name:Bn.PROP_VALUE_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0,visible:t=>t.hasValuesProp()},{name:Bn.PROP_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0,visible:t=>t.hasValuesProp()}];class En extends Fi{constructor(t){super(),this._series=[],this._chart=t}get outlineParent(){return this._chart}get outlineLabel(){return"[Series]"}get outlineExpandable(){return!0}get outlineItems(){return this._series}get owner(){return this._chart}get chart(){return this._chart}get count(){return this._series.length}get items(){return this._series.slice()}get visibleCount(){let t=0;for(let e of this._series)e.visible&&t++;return t}load(t,e){if(this._series=[],e&&e.length>0){for(let s of e)if(s){const e=this._createSeries(t,s);e.load(t,s),this._series.push(e)}this.$_invalidateSeries()}}save(t){for(let e of this._series){const s={};e.save(s),t.push(s)}}get(t){return this._series[t]}indexOf(t){return this._series.indexOf(t)}add(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;const i=this.$_add(t,e,s);if(i)return this.$_invalidateSeries(),this._itemAdded(i),i}addAll(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(!e||e.length<1)return;const i=this._series.length;s=s<0?this._series.length:Math.max(0,this._series.length);for(let i of e)this.$_add(t,i,s)&&s++;return this._series.length!=i?(this.$_invalidateSeries(),!0):void 0}removeAt(t){if(t>=0&&t<this._series.length){const e=this._series.splice(t,1)[0];return this.$_invalidateSeries(),this._itemRemoved(e,this._chart),!0}}remove(t){return this.removeAt(this.indexOf(t))}clear(){if(this._series.length>0)return this._series=[],this.$_invalidateSeries(),!0}select(t){for(let e of this._series)e.designVisible=!t||t===e}getSaveType(){return"series"}get page(){var t;return null===(t=this._chart)||void 0===t?void 0:t.page}get displayPath(){return this._chart?this._chart.displayPath+".series":"series"}get level(){return this._chart?this._chart.level+1:0}isAncestorOf(t){return!!super.isAncestorOf(t)||(this._series.indexOf(t)>=0||void 0)}$_add(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(!(e instanceof Bn)){const s=e;e=this._createSeries(t,s),s&&e.load(t,s),e.defaultInit()}if(e instanceof Bn&&this._series.indexOf(e)<0)return s<0?this._series.push(e):this._series.splice(Math.min(s,this._series.length),0,e),e}$_invalidateSeries(){for(let t=this._series.length-1;t>=0;t--)this._series[t]._index=t;this._seriesChanged(null)}$_seriesChanged(t){this._seriesChanged(null)}_doMoveItem(t,e){const s=this._series[e];return this._series[e]=this._series[t],this._series[t]=s,this.$_invalidateSeries(),!0}}var Pn,xn,Sn,In,Rn,Tn,On,Fn;!function(t){t.CIRCLE="circle",t.SQUARE="square",t.DIAMOND="diamond",t.TRIANGLE="triangle",t.TRIANGLE_DOWN="triangle-down"}(Pn||(Pn={})),function(t){t.DASH="Dash",t.DASH_DOT="DashDot",t.DOT="Dot",t.LONG_DASH="LongDash",t.LONG_DASH_DOT="LongDashDot",t.LONG_DASH_DOT_DOT="LongDashDotDot",t.SHORT_DASH="ShortDash",t.SHORT_DASH_DOT="ShortDashDot",t.SHORT_DASH_DOT_DOT="ShortDashDotDot",t.SHORT_DOT="ShortDot",t.SOLID="Solid"}(xn||(xn={}));class Dn extends vn{constructor(t){super(t),this._x=0}get align(){return this._align}set align(t){if(t!==this._align){const e=this._align;this._align=t,this._changed(Dn.PROP_TITLE_ALIGN,t,e)}}get verticalAlign(){return this._verticalAlign}set verticalAlign(t){if(t!==this.verticalAlign){const e=this._verticalAlign;this._verticalAlign=t,this._changed(Dn.PROP_TITLE_VERTICAL_ALIGN,t,e)}}get x(){return this._x}set x(t){if(t!==this._x){const e=this._x;this._x=t,this._changed(Dn.PROP_TITLE_X,t,e)}}get y(){return this._y}set y(t){if(t!==this._y){const e=this._y;this._y=t,this._changed(Dn.PROP_TITLE_Y,t,e)}}getWrapper(){const t=super.getWrapper();return this.assignProps(t,["align","verticalAlign","x","y"]),t}getSaveLabel(){return"title"}_getEditProps(){return super._getEditProps().concat(Dn.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Dn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Dn.PROPINFOS)}_doDefaultInit(t,e,s,i){this.text="Title"}}Dn.PROP_TITLE_ALIGN="align",Dn.PROP_TITLE_VERTICAL_ALIGN="verticalAlign",Dn.PROP_TITLE_X="x",Dn.PROP_TITLE_Y="y",Dn.PROPINFOS=[{name:Dn.PROP_TITLE_ALIGN,category:Ws.TITLE,type:As,multiple:!1,default:void 0,domain:c},{name:Dn.PROP_TITLE_VERTICAL_ALIGN,category:Ws.TITLE,type:As,multiple:!1,default:void 0,domain:u},{name:Dn.PROP_TITLE_X,category:Ws.TITLE,type:rs,multiple:!0,default:void 0},{name:Dn.PROP_TITLE_Y,category:Ws.TITLE,type:rs,multiple:!0,default:void 0}];class Ln extends Dn{constructor(t){super(t),this.text="Subtitle"}getSaveLabel(){return"subtitle"}_isDefaultVisible(){return!1}_doDefaultInit(t,e,s,i){this.text="Subtitle"}}!function(t){t.NORMAL="normal",t.PERCENT="percent"}(Sn||(Sn={}));class Nn extends Ti{constructor(t){super(t),this._inverted=!1,this._plotBorderColor="#cccccc",this._title=new Dn(this),this._subtitle=new Ln(this),this._xAxis=new Wn(this),this._yAxis=new zn(this),this._legend=new qn(this),this._series=new Zn(this),this._xAxis.title.visible=!1,this._xAxis.title.text="Labels",this._yAxis.title.text="Values"}get outlineItems(){return[this._series,this._xAxis,this._yAxis].concat(super.outlineItems)}get theme(){return this._theme}set theme(t){if(t!=this._theme){const e=this._theme;this._theme=t,this._changed(Nn.PROP_HICHART_THEME,t,e)}}get inverted(){return this._inverted}set inverted(t){t!==this._inverted&&(this._inverted=t,this._changed(Nn.PROP_HICHART_INVERTED,t,!t))}get stacking(){return this._stacking}set stacking(t){if(t!==this._stacking){const e=this._stacking;this._stacking=t,this._changed(Nn.PROP_HICHART_STACKING,t,e)}}get plotBorderWidth(){return this._plotBorderWidth}set plotBorderWidth(t){if(t!==this._plotBorderWidth){const e=t;this._plotBorderWidth=t,this._changed(Nn.PROP_HICHART_PLOT_BORDER_WIDTH,t,e)}}get plotBorderColor(){return this._plotBorderColor}set plotBorderColor(t){if(t!==this._plotBorderColor){const e=t;this._plotBorderColor=t,this._changed(Nn.PROP_HICHART_PLOT_BORDER_COLOR,t,e)}}get title(){return this._title}get subtitle(){return this._subtitle}get xAxis(){return this._xAxis}get yAxis(){return this._yAxis}get legend(){return this._legend}get series(){return this._series}addSeries(t,e){const s=this.report;if(s)return this._series.add(s.loader,t,e)}removeSeries(t){this._series.remove(t)}selectSeries(t){this._series.select(t)}getParentBand(){let t=this.parent;for(;t;){if(t instanceof Qr)return t;t=t.parent}}getSaveType(){return"hichart"}get outlineLabel(){return"[High Chart]"}needDesignWidth(){return!1}needDesignHeight(){return!1}_getEditProps(){return super._getEditProps().concat(Nn.PROPINFOS)}_getStyleProps(){return Nn.STYLE_PROPS}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=340,this.height=270,this._title.defaultInit(t,this,s,i),this._subtitle.defaultInit(t,this,s,i),this._xAxis.defaultInit(t,this,s,i),this._yAxis.defaultInit(t,this,s,i),this._legend.defaultInit(t,this,s,i),this._series.add(t,{},0)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Nn.PROPINFOS),this._loadObjects([this._title,this._subtitle,this._xAxis,this._yAxis,this._legend],t,e),e.hasOwnProperty("series")&&this._series.load(t,e.series)}_doSave(t){super._doSave(t),this._savePropsOf(t,Nn.PROPINFOS),this._saveObjects([this._title,this._subtitle,this._xAxis,this._yAxis,this._legend],t),this._series.count&&this._series.save(t.series=[])}canAddTo(t){return super.canAddTo(t)&&!t.isDataRowContainer}$_seriesChanged(t){this._changed(Nn.PROP_HICHART_SERIES,this._series,this._series)}}Nn.PROP_HICHART_THEME="theme",Nn.PROP_HICHART_INVERTED="inverted",Nn.PROP_HICHART_STACKING="stacking",Nn.PROP_HICHART_PLOT_BORDER_WIDTH="plotBorderWidth",Nn.PROP_HICHART_PLOT_BORDER_COLOR="plotBorderColor",Nn.PROP_HICHART_TITLE="title",Nn.PROP_HICHART_SUBTITLE="subtitle",Nn.PROP_HICHART_XAXIS="xAxis",Nn.PROP_HICHART_YAXIS="yAxis",Nn.PROP_HICHART_LEGEND="legend",Nn.PROP_HICHART_SERIES="series",Nn.PROPINFOS=[{name:Ri.PROP_DATA,category:Ws.DATA,type:hs,multiple:!1,default:void 0,domain:void 0},{name:Nn.PROP_HICHART_INVERTED,category:Ws.CHART,type:as,multiple:!1,default:!1},{name:Nn.PROP_HICHART_THEME,category:Ws.CHART,type:is,multiple:!1,default:void 0},{name:Nn.PROP_HICHART_STACKING,category:Ws.CHART,type:As,multiple:!1,domain:Sn,default:void 0},{name:Nn.PROP_HICHART_PLOT_BORDER_WIDTH,category:Ws.CHART,type:rs,multiple:!1,default:void 0},{name:Nn.PROP_HICHART_PLOT_BORDER_COLOR,category:Ws.CHART,type:_s,multiple:!1,default:void 0},{name:Nn.PROP_HICHART_TITLE,category:Ws.TITLE,type:$s,indented:!0,multiple:!1,default:void 0},{name:Nn.PROP_HICHART_SUBTITLE,category:Ws.SUBTITLE,type:$s,indented:!0,multiple:!1,default:void 0},{name:Nn.PROP_HICHART_LEGEND,category:"legend",type:$s,indented:!0,multiple:!1,default:void 0}],Nn.STYLE_PROPS=["border","backgroundColor"],Nn.$_ctor="HichartItem",Nn.ITEM_TYPE="Highchart";class Hn extends vn{constructor(t){super(t),this.rotation=void 0}getSaveLabel(){return"title"}canRotate(){return!0}_getEditProps(){return super._getEditProps().concat(Hn.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Hn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Hn.PROPINFOS)}getWrapper(){const t=super.getWrapper();return this.assignProps(t,[Ri.PROP_ROTATION]),t}}Hn.PROPINFOS=[{name:Ri.PROP_ROTATION,category:Ws.TITLE,type:rs}];class Qn extends bn{constructor(t){super(t),this._staggerLines=0,this._step=0,this.rotation=0}get align(){return this._align}set align(t){if(t!==this._align){const e=this._align;this._align=t,this._changed(Qn.PROP_ALIGN,t,e)}}get format(){return this._format}set format(t){if(t!==this._format){const e=this._format;this._format=t,this._changed(Qn.PROP_FORMAT,t,e)}}get padding(){return this._padding}set padding(t){if(t!==this._padding){const e=this._padding;this._padding=t,this._changed(Qn.PROP_PADDING,t,e)}}get staggerLines(){return this._staggerLines}set staggerLines(t){if(t!==this._staggerLines){const e=this._staggerLines;this._staggerLines=t,this._changed(Qn.PROP_STAGGER_LINES,t,e)}}get step(){return this._step}set step(t){if(t!==this._step){const e=this._step;this._step=t,this._changed(Qn.PROP_STEP,t,e)}}canRotate(){return!0}getSaveLabel(){return"labels"}_getEditProps(){return super._getEditProps().concat(Qn.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Qn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Qn.PROPINFOS)}getWrapper(){const t=super.getWrapper();return this.assignProps(t,[Qn.PROP_ALIGN,Qn.PROP_FORMAT,Qn.PROP_PADDING,Qn.PROP_ROTATION,Qn.PROP_STAGGER_LINES,Qn.PROP_STEP])}}Qn.PROP_ALIGN="align",Qn.PROP_FORMAT="format",Qn.PROP_PADDING="padding",Qn.PROP_STAGGER_LINES="staggerLines",Qn.PROP_STEP="step",Qn.PROPINFOS=[{name:Qn.PROP_ALIGN,category:Ws.LABELS,type:As,multiple:!1,domain:c,default:void 0},{name:Qn.PROP_FORMAT,category:Ws.LABELS,type:is,multiple:!1,default:void 0},{name:Qn.PROP_PADDING,category:Ws.LABELS,type:rs,multiple:!1,default:void 0},{name:Qn.PROP_ROTATION,category:Ws.LABELS,type:rs,multiple:!1,default:void 0},{name:Qn.PROP_STAGGER_LINES,category:Ws.LABELS,type:rs,multiple:!1,default:void 0},{name:Qn.PROP_STEP,category:Ws.LABELS,type:rs,multiple:!1,default:void 0}];class Un extends bn{constructor(t){super(t)}get align(){return this._align}set align(t){if(t!==this._align){const e=this._align;this._align=t,this._changed(Un.PROP_ALIGN,t,e)}}get verticalAlign(){return this._verticalAlign}set verticalAlign(t){if(t!==this._verticalAlign){const e=this._verticalAlign;this._verticalAlign=t,this._changed(Un.PROP_VERTICAL_ALIGN,t,e)}}get text(){return this._text}set text(t){if(t!==this._text){const e=this._text;this._text=t,this._changed(Un.PROP_TEXT,t,e)}}get textAlign(){return this._textAlign}set textAlign(t){if(t!==this._textAlign){const e=this._textAlign;this._textAlign=t,this._changed(Un.PROP_TEXT_ALIGN,t,e)}}get x(){return this._x}set x(t){if(t!==this._x){const e=this._x;this._x=t,this._changed(Un.PROP_X,t,e)}}get y(){return this._y}set y(t){if(t!==this._y){const e=this._y;this._y=t,this._changed(Un.PROP_Y,t,e)}}getSaveLabel(){return"labels"}canRotate(){return!0}_getEditProps(){return super._getEditProps().concat(Un.PROPINFOS)}_getStyleProps(){return Un.styleProps}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Un.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Un.PROPINFOS)}getWrapper(){const t=this.assignProps({},[Un.PROP_ALIGN,Un.PROP_VERTICAL_ALIGN,Un.PROP_TEXT,Un.PROP_TEXT_ALIGN,Un.PROP_X,Un.PROP_Y]);return t.style=J.extend({},this.styles),t}}Un.PROP_ALIGN="align",Un.PROP_VERTICAL_ALIGN="verticalAlign",Un.PROP_TEXT="text",Un.PROP_TEXT_ALIGN="textAlign",Un.PROP_X="x",Un.PROP_Y="y",Un.PROPINFOS=[{name:Un.PROP_ALIGN,category:Ws.LABELS,type:As,multiple:!1,domain:c,default:void 0},{name:Un.PROP_VERTICAL_ALIGN,category:Ws.LABELS,type:As,multiple:!1,default:void 0,domain:u},{name:Un.PROP_ROTATION,category:Ws.LABELS,type:rs,multiple:!1,default:void 0},{name:Un.PROP_TEXT,category:Ws.LABELS,type:is,multiple:!1,default:void 0},{name:Un.PROP_TEXT_ALIGN,category:Ws.LABELS,type:As,multiple:!1,default:void 0,domain:c},{name:Un.PROP_X,category:Ws.LABELS,type:rs,multiple:!1,default:void 0},{name:Un.PROP_Y,category:Ws.LABELS,type:rs,multiple:!1,default:void 0}],Un.styleProps=["color","fontSize","fontWeight","fontFamily"];class Mn extends Oi{constructor(t,e){super(t),this._index=-1,this._label=new Un(t.axis.chart),e&&this.load(e)}get value(){return this._value}set value(t){if(t!==this._value){const e=this._value;this._value=t,this._changed(Mn.PROP_VALUE,t,e)}}get color(){return this._color}set color(t){if(t!==this._color){const e=this._color;this._color=t,this._changed(Mn.PROP_COLOR,t,e)}}get width(){return this._width}set width(t){if(t!==this._width){const e=this._width;this._width=t,this._changed(Mn.PROP_WIDTH,t,e)}}get dashStyle(){return this._dashStyle}set dashStyle(t){if(t!==this._dashStyle){const e=t;this._dashStyle=t,this._changed(Mn.PROP_DASH_STYLE,t,e)}}get zIndex(){return this._zIndex}set zIndex(t){if(t!==this._zIndex){const e=this._zIndex;this._zIndex=t,this._changed(Mn.PROP_Z_INDEX,t,e)}}get label(){return this._label}get itemType(){return"PlotLine"}get index(){return this._index}get page(){var t;return null===(t=this.collection)||void 0===t?void 0:t.page}get collection(){return super.collection}get displayPath(){return this.collection?this.collection.axis.displayPath+".plotLines["+this.index+"]":"plotLine"}get marqueeParent(){var t;return null===(t=this.collection)||void 0===t?void 0:t.owner}_getStyleProps(){return[]}getEditProps(){return Mn.PROPINFOS}_doLoad(t){this._loadPropsOf(t,Mn.PROPINFOS),this._label.load(null,t.label)}_doSave(t){this._savePropsOf(t,Mn.PROPINFOS),this._label.save(t.label={})}getWrapper(){const t={};return t.label=this._label.getWrapper(),this.assignProps(t,[Mn.PROP_VALUE,Mn.PROP_COLOR,Mn.PROP_WIDTH,Mn.PROP_DASH_STYLE,Mn.PROP_Z_INDEX]),t.label=this._label.getWrapper(),t}getCollectionLabel(){return"plotLine"}}Mn.PROP_VALUE="value",Mn.PROP_COLOR="color",Mn.PROP_WIDTH="width",Mn.PROP_DASH_STYLE="dashStyle",Mn.PROP_LABEL="label",Mn.PROP_Z_INDEX="zIndex",Mn.PROPINFOS=[{name:Mn.PROP_VALUE,category:"plotLine",type:rs},{name:Mn.PROP_COLOR,category:"plotLine",type:_s},{name:Mn.PROP_WIDTH,category:"plotLine",type:rs},{name:Mn.PROP_DASH_STYLE,category:"plotLine",type:As,domain:xn},{name:Mn.PROP_Z_INDEX,category:"plotLine",type:rs},{name:Mn.PROP_LABEL,category:Ws.LABEL,type:$s,indented:!0}];class kn extends Fi{constructor(t){super(),this._lines=[],this._owner=t}get owner(){return this._owner}get axis(){return this._owner}load(t){const e=this._lines=[];if(t&&t.length>0){for(let s of t){const t=new Mn(this,s);e.push(t)}this.$_resetLines()}}save(t){this._lines.forEach((e=>t.push(e.save({}))))}indexOf(t){return this._lines.indexOf(t)}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if((t=t instanceof Mn?t:new Mn(this,t))instanceof Mn&&this._lines.indexOf(t)<0)return e=e<0?this._lines.length:e,this._lines.splice(Math.min(e,this._lines.length),0,t),this._itemAdded(t),this.$_resetLines(),t}remove(t){const e=this._lines.indexOf(t);if(e>=0){const t=this._lines.splice(e,1)[0];this._itemRemoved(t,this._owner.chart),this.$_resetLines()}}getWrapper(){const t=[];return this._lines.forEach((e=>{t.push(e.getWrapper())})),t}get count(){return this._lines.length}get items(){return this._lines.slice(0)}get outlineParent(){return this._owner}get outlineExpandable(){return!0}get outlineLabel(){return"[PlotLines]"}get outlineItems(){return this._lines}isEditableCollection(){return!0}getCollectionLabel(){return"plotLines"}get page(){return this._owner.page}get displayPath(){return this._owner?this._owner.displayPath+".plotLines":"plotLines"}get level(){return this._owner?this._owner.level+1:0}get marqueeParent(){return this._owner}get(t){return this._lines[t]}getSaveType(){return"plotLines"}_doMoveItem(t,e){return!1}$_resetLines(){this._lines.forEach(((t,e)=>{t._parent=this,t._index=e}))}}class Vn extends Oi{constructor(t,e){super(t),this._index=-1,this._label=new Un(t.axis.chart),e&&this.load(e)}get color(){return this._color}set color(t){if(t!==this._color){const e=this._color;this._color=t,this._changed(Vn.PROP_COLOR,t,e)}}get from(){return this._from}set from(t){if(t!==this._from){const e=this._from;this._from=t,this._changed(Vn.PROP_FROM,t,e)}}get to(){return this._to}set to(t){if(t!==this._to){const e=this._to;this._to=t,this._changed(Vn.PROP_TO,t,e)}}get zIndex(){return this._zIndex}set zIndex(t){if(t!==this._zIndex){const e=this._zIndex;this._zIndex=t,this._changed(Vn.PROP_Z_INDEX,t,e)}}get label(){return this._label}get itemType(){return"PlotBand"}get index(){return this._index}get page(){var t;return null===(t=this.collection)||void 0===t?void 0:t.page}get collection(){return super.collection}get displayPath(){return this.collection?this.collection.axis.displayPath+".plotBands["+this.index+"]":"plotBand"}get marqueeParent(){var t;return null===(t=this.collection)||void 0===t?void 0:t.owner}_getStyleProps(){return[]}getEditProps(){return Vn.PROPINFOS}_doLoad(t){this._loadPropsOf(t,Vn.PROPINFOS),this._label.load(null,t.label)}_doSave(t){this._savePropsOf(t,Vn.PROPINFOS),this._label.save(t.label={})}getWrapper(){const t={};return t.label=this._label.getWrapper(),this.assignProps(t,[Vn.PROP_FROM,Vn.PROP_TO,Vn.PROP_COLOR,Vn.PROP_Z_INDEX]),t.label=this._label.getWrapper(),t}getCollectionLabel(){return"plotBand"}}Vn.PROP_FROM="from",Vn.PROP_TO="to",Vn.PROP_COLOR="color",Vn.PROP_LABEL="label",Vn.PROP_Z_INDEX="zIndex",Vn.PROPINFOS=[{name:Vn.PROP_FROM,category:"plotLine",type:rs},{name:Vn.PROP_TO,category:"plotLine",type:rs},{name:Vn.PROP_COLOR,category:"plotLine",type:_s,multiple:!1,default:void 0},{name:Vn.PROP_Z_INDEX,category:"plotBand",type:rs},{name:Vn.PROP_LABEL,category:Ws.LABEL,type:$s,indented:!0,multiple:!1,default:void 0}];class Gn extends Fi{constructor(t){super(),this._bands=[],this._owner=t}get owner(){return this._owner}get axis(){return this._owner}load(t){const e=this._bands=[];if(t&&t.length>0){for(let s of t){const t=new Vn(this,s);e.push(t)}this.$_resetBands()}}save(t){this._bands.forEach((e=>t.push(e.save({}))))}indexOf(t){return this._bands.indexOf(t)}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if((t=t instanceof Vn?t:new Vn(this,t))instanceof Vn&&this._bands.indexOf(t)<0)return e=e<0?this._bands.length:e,this._bands.splice(Math.min(e,this._bands.length),0,t),this._itemAdded(t),this.$_resetBands(),t}remove(t){const e=this._bands.indexOf(t);if(e>=0){const t=this._bands.splice(e,1)[0];this._itemRemoved(t,this._owner.chart),this.$_resetBands()}}getWrapper(){const t=[];return this._bands.forEach((e=>{t.push(e.getWrapper())})),t}get count(){return this._bands.length}get items(){return this._bands.slice(0)}get outlineParent(){return this._owner}get outlineExpandable(){return!0}get outlineLabel(){return"[PlotBands]"}get outlineItems(){return this._bands}isEditableCollection(){return!0}getCollectionLabel(){return"plotBands"}get page(){return this._owner.page}get displayPath(){return this._owner?this._owner.displayPath+".plotBands":"plotBands"}get level(){return this._owner?this._owner.level+1:0}get marqueeParent(){return this._owner}get(t){return this._bands[t]}getSaveType(){return"plotBands"}_doMoveItem(t,e){return!1}$_resetBands(){this._bands.forEach(((t,e)=>{t._parent=this,t._index=e}))}}class Kn extends bn{constructor(t){super(t),this._title=new Hn(t),this._labels=new Qn(t),this._plotLines=new kn(this),this._plotBands=new Gn(this)}getPropDomain(t){if(this.report&&t.name===Wn.PROP_CATEGORY_FIELD)return this.getDataFieldNames()}getPopupPropLabel(t){return t===Kn.PROP_PLOT_LINES?"(".concat(this._plotLines.count," lines)"):t===Kn.PROP_PLOT_BANDS?"(".concat(this._plotBands.count," bands)"):void 0}get outlineItems(){return[this._plotLines,this._plotBands].concat(super.outlineItems)}get outlineExpandable(){return!0}get title(){return this._title}get labels(){return this._labels}get categories(){return this._categories}set categories(t){if(t!==this._categories){const e=this._categories;this._categories=null==t?void 0:t.slice(),this._changed(Kn.PROP_CATEGORIES,t,e)}}get categoryField(){return this._categoryField}set categoryField(t){if(t!==this._categoryField){const e=this._categoryField;this._categoryField=t,this._changed(Kn.PROP_CATEGORY_FIELD,t,e)}}get minPadding(){return this._minPadding}set minPadding(t){if(t!==this._minPadding){const e=this._minPadding;this._minPadding=t,this._changed(Kn.PROP_MIN_PADDING,t,e)}}get maxPadding(){return this._maxPadding}set maxPadding(t){if(t!==this._maxPadding){const e=this._maxPadding;this._maxPadding=t,this._changed(Kn.PROP_MAX_PADDING,t,e)}}get plotLines(){return this._plotLines}get plotBands(){return this._plotBands}getCategories(t,e){if(!(t&&t.printing)||!this._categoryField)return this._categories;const s=this._getParentData();if(!s)return;const i=this.chart.getParentBand();return i&&i.data===s&&i.containsInSection(this.chart)&&i.isDetail?e.getFieldValues(s,this.categoryField,t.detailRows):e.getFieldValues(s,this.categoryField)}get outlineParent(){return this.chart}_getEditProps(){return super._getEditProps().concat(Kn.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Kn.PROPINFOS),this._loadObject(this._title,t,e),this._loadObject(this._labels,t,e),this._plotLines.load(e.plotLines),this._plotBands.load(e.plotBands)}_doSave(t){super._doSave(t),this._savePropsOf(t,Kn.PROPINFOS),this._saveObject(this._title,t),this._saveObject(this._labels,t),this._plotLines.count>0&&this._plotLines.save(t.plotLines=[]),this._plotBands.count>0&&this._plotBands.save(t.plotBands=[])}getWrapper(){const t=super.getWrapper();return t.visible=this.visible,t.title=this._title.getWrapper(),t.labels=this._labels.getWrapper(),this._plotLines.count>0&&(t.plotLines=this._plotLines.getWrapper()),this._plotBands.count>0&&(t.plotBands=this._plotBands.getWrapper()),this.assignProps(t,[Kn.PROP_MIN_PADDING,Kn.PROP_MAX_PADDING]),t}}Kn.PROP_TITLE="title",Kn.PROP_CATEGORIES="categories",Kn.PROP_CATEGORY_FIELD="categoryField",Kn.PROP_LABELS="labels",Kn.PROP_MIN_PADDING="minPadding",Kn.PROP_MAX_PADDING="maxPadding",Kn.PROP_PLOT_LINES="plotLines",Kn.PROP_PLOT_BANDS="plotBands",Kn.PROPINFOS=[{name:Kn.PROP_TITLE,category:Ws.TITLE,type:$s,indented:!0,multiple:!1,default:void 0},{name:Kn.PROP_CATEGORIES,category:Ws.AXIS,type:ps},{name:Kn.PROP_CATEGORY_FIELD,category:Ws.AXIS,type:hs},{name:Kn.PROP_LABELS,category:Ws.LABELS,type:$s,indented:!0},{name:Kn.PROP_MIN_PADDING,category:Ws.AXIS,type:rs},{name:Kn.PROP_MAX_PADDING,category:Ws.AXIS,type:rs},{name:Kn.PROP_PLOT_LINES,category:Ws.AXIS,type:gs,collection:!0},{name:Kn.PROP_PLOT_BANDS,category:Ws.AXIS,type:gs,collection:!0}];class Wn extends Kn{constructor(t){super(t)}getPropDomain(t){if(this.report&&t.name===Wn.PROP_CATEGORY_FIELD)return this.getDataFieldNames()}getSaveLabel(){return"xAxis"}get displayPath(){return this.chart.displayPath+".xAxis"}get outlineLabel(){return"[X Axis]"}_getEditProps(){return super._getEditProps().concat(Wn.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Wn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Wn.PROPINFOS)}getWrapper(){return super.getWrapper()}getPlotLineConfig(){}getPlotBandConfig(){}}Wn.PROPINFOS=[];class zn extends Kn{constructor(t){super(t)}get min(){return this._min}set min(t){if(t!==this._min){const e=this._min;this._min=t,this._changed(zn.PROP_MIN,t,e)}}get max(){return this._max}set max(t){if(t!==this._max){const e=this._max;this._max=t,this._changed(zn.PROP_MAX,t,e)}}getSaveLabel(){return"yAxis"}get displayPath(){return this.chart.displayPath+".yAxis"}get outlineLabel(){return"[Y Axis]"}_getEditProps(){return super._getEditProps().concat(zn.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,zn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,zn.PROPINFOS)}getWrapper(){const t=super.getWrapper();return this.assignProps(t,["min","max"]),t}getPlotLineConfig(){return{}}getPlotBandConfig(){}}zn.PROP_MIN="min",zn.PROP_MAX="max",zn.PROPINFOS=[{name:zn.PROP_MIN,category:Ws.AXIS,type:rs,multiple:!1,default:void 0},{name:zn.PROP_MAX,category:Ws.AXIS,type:rs,multiple:!1,default:void 0}],function(t){t.ARC="arc",t.CALLOUT="callout",t.CIRCLE="circle",t.DIAMOND="diamond",t.SQUARE="square",t.TRIANGLE="triangle"}(In||(In={}));class $n extends bn{constructor(){super(...arguments),this._borderRadius=0,this._borderWidth=0,this._padding=5,this._x=0,this._y=0,this._z=6}get align(){return this._align}set align(t){if(t!==this._align){const e=this._align;this._align=t,this._changed($n.PROP_DATA_LABELS_ALIGN,t,e)}}get verticalAlign(){return this._verticalAlign}set verticalAlign(t){if(t!==this._verticalAlign){const e=this._verticalAlign;this._verticalAlign=t,this._changed($n.PROP_DATA_LABELS_VERTICAL_ALIGN,t,e)}}get shape(){return this._shape}set shape(t){if(t!==this._shape){const e=this._shape;this._shape=t,this._changed($n.PROP_DATA_LABELS_SHAPE,t,e)}}get format(){return this._format}set format(t){if(t!==this._format){const e=this._format;this._format=t,this._changed($n.PROP_DATA_LABELS_FORMAT,t,e)}}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){if(t!==this._backgroundColor){const e=this._backgroundColor;this._backgroundColor=t,this._changed($n.PROP_DATA_LABELS_BACKGROUND_COLOR,t,e)}}get shadow(){return this._shadow}set shadow(t){t!==this._shadow&&(this._shadow=t,this._changed($n.PROP_DATA_LABELS_SHADOW,t,!t))}get textOutline(){return this._textOutline}set textOutline(t){if(t!==this._textOutline){const e=this._textOutline;this._textOutline=t,this._changed($n.PROP_DATA_LABELS_TEXT_OUTLINE,t,e)}}get borderColor(){return this._borderColor}set borderColor(t){if(t!==this._borderColor){const e=this._borderColor;this._borderColor=t,this._changed($n.PROP_DATA_LABELS_BORDER_COLOR,t,e)}}get borderRadius(){return this._borderRadius}set borderRadius(t){if(t!==this._borderRadius){const e=this._borderRadius;this._borderRadius=t,this._changed($n.PROP_DATA_LABELS_BORDER_RADIUS,t,e)}}get borderWidth(){return this._borderWidth}set borderWidth(t){if(t!==this._borderWidth){const e=this._borderWidth;this._borderWidth=t,this._changed($n.PROP_DATA_LABELS_BORDER_WIDTH,t,e)}}get padding(){return this._padding}set padding(t){if(t!==this._padding){const e=this._padding;this._padding=t,this._changed($n.PROP_DATA_LABELS_PADDING,t,e)}}get x(){return this._x}set x(t){if(t!==this._x){const e=this._x;this._x=t,this._changed($n.PROP_DATA_LABELS_X,t,e)}}get y(){return this._y}set y(t){if(t!==this._y){const e=this._y;this._y=t,this._changed($n.PROP_DATA_LABELS_Y,t,e)}}get z(){return this._z}set z(t){if(t!==this._z){const e=this._z;this._z=t,this._changed($n.PROP_DATA_LABELS_Z,t,e)}}get inside(){return this._inside}set inside(t){t!==this._inside&&(this._inside=t,this._changed($n.PROP_DATA_LABELS_INSIDE,t,!t))}_getEditProps(){return super._getEditProps().concat($n.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,$n.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,$n.PROPINFOS)}canRotate(){return!0}getSaveLabel(){return"dataLabels"}getWrappaer(){const t=super.getWrapper();return this.assignProps(t,[$n.PROP_DATA_LABELS_ALIGN,$n.PROP_DATA_LABELS_VERTICAL_ALIGN,$n.PROP_DATA_LABELS_SHAPE,$n.PROP_DATA_LABELS_FORMAT,$n.PROP_DATA_LABELS_BACKGROUND_COLOR,$n.PROP_DATA_LABELS_SHADOW,$n.PROP_DATA_LABELS_TEXT_OUTLINE,$n.PROP_DATA_LABELS_BORDER_COLOR,$n.PROP_DATA_LABELS_BORDER_RADIUS,$n.PROP_DATA_LABELS_BORDER_WIDTH,$n.PROP_DATA_LABELS_PADDING,$n.PROP_DATA_LABELS_X,$n.PROP_DATA_LABELS_Y,$n.PROP_DATA_LABELS_Z,$n.PROP_DATA_LABELS_INSIDE]),t.style=J.extend({},this.styles),this.assignProps(t.style,["textOutline"]),t}_getStyleProps(){return["color","fontSize","fontWeight"]}}$n.PROP_DATA_LABELS_ALIGN="align",$n.PROP_DATA_LABELS_VERTICAL_ALIGN="verticalAlign",$n.PROP_DATA_LABELS_SHAPE="shape",$n.PROP_DATA_LABELS_FORMAT="format",$n.PROP_DATA_LABELS_BACKGROUND_COLOR="backgroundColor",$n.PROP_DATA_LABELS_SHADOW="shadow",$n.PROP_DATA_LABELS_TEXT_OUTLINE="textOutline",$n.PROP_DATA_LABELS_BORDER_COLOR="borderColor",$n.PROP_DATA_LABELS_BORDER_RADIUS="borderRadius",$n.PROP_DATA_LABELS_BORDER_WIDTH="borderWidth",$n.PROP_DATA_LABELS_PADDING="padding",$n.PROP_DATA_LABELS_X="x",$n.PROP_DATA_LABELS_Y="y",$n.PROP_DATA_LABELS_Z="z",$n.PROP_DATA_LABELS_INSIDE="inside",$n.PROPINFOS=[{name:$n.PROP_DATA_LABELS_ALIGN,category:Ws.DATA_LABELS,type:As,multiple:!1,default:void 0,domain:c},{name:$n.PROP_DATA_LABELS_VERTICAL_ALIGN,category:Ws.DATA_LABELS,type:As,multiple:!1,default:void 0,domain:u},{name:$n.PROP_ROTATION,category:Ws.DATA_LABELS,type:rs,multiple:!1,default:void 0},{name:$n.PROP_DATA_LABELS_SHAPE,category:Ws.DATA_LABELS,type:As,multiple:!1,default:void 0,domain:In},{name:$n.PROP_DATA_LABELS_FORMAT,category:Ws.DATA_LABELS,type:is,multiple:!1,default:void 0},{name:$n.PROP_DATA_LABELS_BACKGROUND_COLOR,category:Ws.DATA_LABELS,type:_s,multiple:!1,default:void 0},{name:$n.PROP_DATA_LABELS_SHADOW,category:Ws.DATA_LABELS,type:as,multiple:!1,default:void 0},{name:$n.PROP_DATA_LABELS_TEXT_OUTLINE,category:Ws.DATA_LABELS,type:is,multiple:!1,default:void 0},{name:$n.PROP_DATA_LABELS_BORDER_COLOR,category:Ws.DATA_LABELS,type:_s,multiple:!1,default:void 0},{name:$n.PROP_DATA_LABELS_BORDER_RADIUS,category:Ws.DATA_LABELS,type:rs,multiple:!1,default:void 0},{name:$n.PROP_DATA_LABELS_BORDER_WIDTH,category:Ws.DATA_LABELS,type:rs,multiple:!1,default:void 0},{name:$n.PROP_DATA_LABELS_PADDING,category:Ws.DATA_LABELS,type:rs,multiple:!1,default:void 0},{name:$n.PROP_DATA_LABELS_X,category:Ws.DATA_LABELS,type:rs,multiple:!1,default:0},{name:$n.PROP_DATA_LABELS_Y,category:Ws.DATA_LABELS,type:rs,multiple:!1,default:0},{name:$n.PROP_DATA_LABELS_Z,category:Ws.DATA_LABELS,type:rs,multiple:!1,default:6},{name:$n.PROP_DATA_LABELS_INSIDE,category:Ws.DATA_LABELS,type:as,multiple:!1,default:void 0}];class Xn extends $n{}Xn.PROP_DATA_LABELS_ALIGN="align",function(t){t.CONNECTORS="connectors",t.PLOT_EDGES="plotEdges"}(Rn||(Rn={})),function(t){t.FIXED_OFFSET="fixedOffset",t.STRAIGHT="straight",t.CROOKED_LINE="crookedLine"}(Tn||(Tn={}));class jn extends $n{get alignTo(){return this._alignTo}set alignTo(t){if(t!==this._alignTo){const e=this._alignTo;this._alignTo=t,this._changed(jn.PROP_ALIGN_TO,e,t)}}get distance(){return this._distance}set distance(t){if(t!==this._distance){const e=this._distance;this._distance=t,this._changed(jn.PROP_DISTANCE,t,e)}}get connectorColor(){return this._connectorColor}set connectorColor(t){if(t!==this._connectorColor){const e=this._connectorColor;this._connectorColor=t,this._changed(jn.PROP_CONNECTOR_COLOR,t,e)}}get connectorPadding(){return this._connectorPadding}set connectorPadding(t){if(t!==this._connectorPadding){const e=this._connectorPadding;this._connectorPadding=t,this._changed(jn.PROP_CONNECTOR_PADDING,t,e)}}get connectorShape(){return this._connectorShape}set connectorShape(t){if(t!==this._connectorShape){const e=this._connectorShape;this._connectorShape=t,this._changed(jn.PROP_CONNECTOR_SHAPE,t,e)}}get connectorWidth(){return this._connectorWidth}set connectorWidth(t){if(t!==this._connectorWidth){const e=this._connectorWidth;this._connectorWidth=t,this._changed(jn.PROP_CONNECTOR_WIDTH,t,e)}}get crookDistance(){return this._crookDistance}set crookDistance(t){if(t!==this._crookDistance){const e=this._crookDistance;this._crookDistance=t,this._changed(jn.PROP_CROOK_DISTANCE,t,e)}}_getEditProps(){return super._getEditProps().concat(jn.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,jn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,jn.PROPINFOS)}getWrappaer(){const t=super.getWrappaer();return this.assignProps(t,[jn.PROP_ALIGN_TO,jn.PROP_DISTANCE,jn.PROP_CONNECTOR_COLOR,jn.PROP_CONNECTOR_PADDING,jn.PROP_CONNECTOR_SHAPE,jn.PROP_CONNECTOR_WIDTH,jn.PROP_CROOK_DISTANCE]),t}}jn.PROP_ALIGN_TO="alignTo",jn.PROP_DISTANCE="distance",jn.PROP_CONNECTOR_COLOR="connectorColor",jn.PROP_CONNECTOR_PADDING="connectorPadding",jn.PROP_CONNECTOR_SHAPE="connectorShape",jn.PROP_CONNECTOR_WIDTH="connectorWidth",jn.PROP_CROOK_DISTANCE="crookDistance",jn.PROPINFOS=[{name:jn.PROP_ALIGN_TO,category:Ws.DATA_LABELS,type:As,multiple:!1,domain:Rn,default:void 0},{name:jn.PROP_DISTANCE,category:Ws.DATA_LABELS,type:rs,multiple:!0,default:void 0},{name:jn.PROP_CONNECTOR_COLOR,category:Ws.DATA_LABELS,type:_s,multiple:!0,default:void 0},{name:jn.PROP_CONNECTOR_PADDING,category:Ws.DATA_LABELS,type:rs,multiple:!0,default:void 0},{name:jn.PROP_CONNECTOR_SHAPE,category:Ws.DATA_LABELS,type:As,multiple:!0,default:void 0,domain:Tn},{name:jn.PROP_CONNECTOR_WIDTH,category:Ws.DATA_LABELS,type:rs,multiple:!0,default:void 0},{name:jn.PROP_CROOK_DISTANCE,category:Ws.DATA_LABELS,type:is,multiple:!0,default:void 0}];class Yn extends Bn{constructor(t){super(t),this._showInLegend=!0}get color(){return this._color}set color(t){if(t!==this._color){const e=this._color;this._color=t,this._changed(Yn.PROP_SERIES_COLOR,t,e)}}get colors(){return this._colors&&this._colors.slice(0)}set colors(t){if(t!==this._colors){const e=this._colors;this._colors=t&&t.slice(0),this._changed(Yn.PROP_SERIES_COLORS,t,e)}}get colorByPoint(){return this._colorByPoint}set colorByPoint(t){t!==this._colorByPoint&&(this._colorByPoint=t,this._changed(Yn.PROP_SERIES_COLOR_BY_POINT,t,!t))}get showInLegend(){return this._showInLegend}set showInLegend(t){t!==this._showInLegend&&(this._showInLegend=t,this._changed(Yn.PROP_SERIES_SHOW_IN_LEGEND,t,!t))}canHideMarker(){return!1}wrap(t){return J.extend(t,{type:this.seriesType,name:this.name}),this.assignProps(t,[Yn.PROP_SERIES_COLOR,Yn.PROP_SERIES_COLORS,Yn.PROP_SERIES_COLOR_BY_POINT,Yn.PROP_SERIES_SHOW_IN_LEGEND]),t}get outlineParent(){return this.chart.series}_getEditProps(){return super._getEditProps().concat(Yn.PROPINFOS)}getPropDomain(t){if(this.page){const e=this._getFieldProps();if(e&&e.length>0&&e.indexOf(t.name)>=0)return this.getDataFieldNames()}return super.getPropDomain(t)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Yn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Yn.PROPINFOS)}getCollectionLabel(){return"hichartSeries"}canRemoveFrom(){return!0}getValues(t,e){const s=this.valueField;if(t.printing&&s){const i=this.data||this._getParentData();if(i){const r=this.chart.getParentBand();return r&&r.data===i&&r.containsInSection(this.chart)&&r.isDetail?e.getFieldValues(i,s,t.detailRows):e.getFieldValues(i,s)}}return this.values}_getFieldProps(){}_getValues(t,e,s){const i=this["_"+e+"Field"];if(t.printing&&i){const e=this.data||this._getParentData();if(e){const r=this.chart.getParentBand();return r&&r.containsInSection(this.chart)&&r.isDetail?s.getFieldValues(e,i,t.detailRows):s.getFieldValues(e,i)}}return this["_"+e+"Values"]}}Yn.PROP_SERIES_COLOR="color",Yn.PROP_SERIES_COLORS="colors",Yn.PROP_SERIES_COLOR_BY_POINT="colorByPoint",Yn.PROP_SERIES_SHOW_IN_LEGEND="showInLegend",Yn.PROPINFOS=[{name:Yn.PROP_SERIES_COLOR,category:Ws.SERIES,type:_s},{name:Yn.PROP_SERIES_COLORS,category:Ws.SERIES,type:ps},{name:Yn.PROP_SERIES_COLOR_BY_POINT,category:Ws.SERIES,type:as},{name:Yn.PROP_SERIES_SHOW_IN_LEGEND,category:Ws.SERIES,type:as}];class Jn extends Yn{constructor(t){super(t),this._dataLabels=new Xn(t)}get dataLabels(){return this._dataLabels}_getEditProps(){return super._getEditProps().concat(Jn.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Jn.PROPINFOS),this._loadObjects([this._dataLabels],t,e)}_doSave(t){super._doSave(t),this._savePropsOf(t,Jn.PROPINFOS),this._saveObjects([this._dataLabels],t)}wrap(t){return super.wrap(t),J.extend(t,{dataLabels:this._dataLabels.getWrappaer()})}}Jn.PROP_SERIES_DATA_LABELS="dataLabels",Jn.PROPINFOS=[{name:Jn.PROP_SERIES_DATA_LABELS,category:Ws.DATA_LABELS,type:$s,indented:!0,multiple:!1,default:void 0}];class Zn extends En{constructor(t){super(t)}getIds(t){const e=[];return this._series.forEach((s=>{s.id&&s.id!==t&&e.push(s.id)})),e}getCollectionLabel(){return"hichartSeries"}isCollectionProp(){return!1}_createSeries(t,e){return t.createHichartSeries(this.chart,e)}_seriesChanged(t){var e;null===(e=this.chart)||void 0===e||e.$_seriesChanged(t)}}!function(t){t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.PROXIMATE="proximate"}(On||(On={}));class qn extends bn{constructor(t){super(t),this._layout=On.HORIZONTAL,this._align=c.CENTER,this._verticalAlign=u.BOTTOM}get align(){return this._align}set align(t){if(t!==this._align){const e=this._align;this._align=t,this._changed(qn.PROP_HICHART_ALIGN,t,e)}}get verticalAlign(){return this._verticalAlign}set verticalAlign(t){if(t!==this._verticalAlign){const e=this._verticalAlign;this._verticalAlign=t,this._changed(qn.PROP_HICHART_VERTICAL_ALIGN,t,e)}}get layout(){return this._layout}set layout(t){if(t!==this._layout){const e=this._layout;this._layout=t,this._changed(qn.PROP_HICHART_LAYOUT,t,e)}}get floating(){return this._floating}set floating(t){t!==this._floating&&(this._floating=t,this._changed(qn.PROP_HICHART_FLOATING,t,!t))}get x(){return this._x}set x(t){if(t!==this._x){const e=this._x;this._x=t,this._changed(qn.PROP_HICHART_X,t,e)}}get y(){return this._y}set y(t){if(t!==this._y){const e=this._y;this._y=t,this._changed(qn.PROP_HICHART_Y,t,e)}}get borderWidth(){return this._borderWidth}set borderWidth(t){if(t!==this._borderWidth){const e=this._borderWidth;this._borderWidth=t,this._changed(qn.PROP_HICHART_BORDER_WIDTH,t,e)}}get shadow(){return this._shadow}set shadow(t){t!==this._shadow&&(this._shadow=t,this._changed(qn.PROP_HICHART_SHADOW,t,!t))}getSaveLabel(){return"legend"}_isDefaultVisible(){return!1}_getEditProps(){return super._getEditProps().concat(qn.PROPINFOS)}_getStyleProps(){return["backgroundColor"]}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,qn.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,qn.PROPINFOS)}getWrapper(){const t=super.getWrapper();return this.assignProps(t,[qn.PROP_HICHART_ALIGN,qn.PROP_HICHART_VERTICAL_ALIGN,qn.PROP_HICHART_LAYOUT,qn.PROP_HICHART_FLOATING,qn.PROP_HICHART_X,qn.PROP_HICHART_Y,qn.PROP_HICHART_BORDER_WIDTH,qn.PROP_HICHART_SHADOW]),t.backgroundColor=this.getStyle("backgroundColor"),t}}qn.PROP_HICHART_ALIGN="align",qn.PROP_HICHART_VERTICAL_ALIGN="verticalAlign",qn.PROP_HICHART_LAYOUT="layout",qn.PROP_HICHART_FLOATING="floating",qn.PROP_HICHART_X="x",qn.PROP_HICHART_Y="y",qn.PROP_HICHART_BORDER_WIDTH="borderWidth",qn.PROP_HICHART_SHADOW="shadow",qn.PROPINFOS=[{name:qn.PROP_HICHART_ALIGN,category:Ws.LEGEND,type:As,multiple:!1,default:void 0,domain:c},{name:qn.PROP_HICHART_VERTICAL_ALIGN,category:Ws.LEGEND,type:As,multiple:!1,default:void 0,domain:u},{name:qn.PROP_HICHART_LAYOUT,category:Ws.LEGEND,type:As,multiple:!1,default:void 0,domain:On},{name:qn.PROP_HICHART_FLOATING,category:Ws.LEGEND,type:as,multiple:!1,default:void 0},{name:qn.PROP_HICHART_X,category:Ws.LEGEND,type:rs,multiple:!1,default:void 0},{name:qn.PROP_HICHART_Y,category:Ws.LEGEND,type:rs,multiple:!1,default:void 0},{name:qn.PROP_HICHART_BORDER_WIDTH,category:Ws.LEGEND,type:rs,multiple:!1,default:void 0},{name:qn.PROP_HICHART_SHADOW,category:Ws.LEGEND,type:as,multiple:!1,default:void 0}];class to extends bn{constructor(t){super(t.chart),this._series=t}get symbol(){return this._symbol}set symbol(t){if(t!==this._symbol){const e=this._symbol;this._symbol=t,this._changed(to.PROP_SYMBOL,t,e)}}get fillColor(){return this._fillColor}set fillColor(t){if(t!==this._fillColor){const e=this._fillColor;this._fillColor=t,this._changed(to.PROP_FILL_COLOR,t,e)}}canHide(){return this._series.canHideMarker()}getWrapper(){return this._getPropsWrapper({},null,{visible:"enabled"})}_getEditProps(){return super._getEditProps().concat(to.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,to.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,to.PROPINFOS)}}to.PROP_SYMBOL="symbol",to.PROP_FILL_COLOR="fillColor",to.PROPINFOS=[{name:to.PROP_SYMBOL,category:"marker",type:As,indented:!0,multiple:!1,default:void 0,domain:Pn},{name:to.PROP_FILL_COLOR,category:"marker",type:_s,multiple:!0,default:void 0}];class eo extends br{constructor(t){super("Remove HichartSeries"),Z(!!t),this._series=t,this._chart=t.chart,Z(!!t),this._index=this._chart.series.indexOf(t)}_doDispose(){this._chart=this._series=null}get chart(){return this._chart}get series(){return this._series}get index(){return this._index}redo(t){this._chart.removeSeries(this._series)}undo(){this._chart.addSeries(this._series,this._index)}get source(){return this._series}}class so extends br{constructor(t,e){super("Remove HichartSeries"),Z(!!t),this._chart=t,this._seriesType=e}_doDispose(){this._chart=this._series=null}get chart(){return this._chart}get series(){return this._series}redo(t){this._series=this._chart.addSeries(this._seriesType)}undo(){this._chart.removeSeries(this._series)}get source(){return this._series||this._chart}}class io extends br{constructor(t){super("Remove HichartAxis PlotLine"),Z(!!t),this._axis=t.collection.axis,this._line=t,this._index=this._axis.plotLines.indexOf(t)}_doDispose(){this._axis=this._line=null}get axis(){return this._axis}get line(){return this._line}redo(t){this._axis.plotLines.remove(this._line)}undo(){this._axis.plotLines.add(this._line,this._index)}get source(){return this._axis.plotLines}}class ro extends br{constructor(t,e){super("Add HichartAxis Plot Line"),Z(!!t),this._axis=t,this._config=e}_doDispose(){this._axis=this._config=null}get axis(){return this._axis}get line(){return this._line}redo(t){this._line=this._axis.plotLines.add(this._config)}undo(){this._axis.plotLines.remove(this._line)}get source(){return this._axis.plotLines}}class no extends br{constructor(t){super("Remove HichartAxis PlotBand"),Z(!!t),this._axis=t.collection.axis,this._band=t,this._index=this._axis.plotBands.indexOf(t)}_doDispose(){this._axis=this._band=null}get axis(){return this._axis}get band(){return this._band}redo(t){this._axis.plotBands.remove(this._band)}undo(){this._axis.plotBands.add(this._band,this._index)}get source(){return this._axis.plotBands}}class oo extends br{constructor(t,e){super("Add HichartAxis Plot Band"),Z(!!t),this._axis=t,this._config=e}_doDispose(){this._axis=this._config=null}get axis(){return this._axis}get band(){return this._band}redo(t){this._band=this._axis.plotBands.add(this._config)}undo(){this._axis.plotBands.remove(this._band)}get source(){return this._axis.plotBands}}!function(t){t.SUM="sum",t.AVG="avg",t.MIN="min",t.MAX="max",t.COUNT="count",t.DISTINCT="distinct"}(Fn||(Fn={}));const ao={text:(t,e,s,i)=>J.compareText(t.getRowValue(s,e),t.getRowValue(i,e)),number:(t,e,s,i)=>J.toNumber(t.getRowValue(s,e),Number.MIN_VALUE)-J.toNumber(t.getRowValue(i,e),Number.MIN_VALUE),bool:(t,e,s,i)=>(t.getRowValue(s,e)?1:0)-(t.getRowValue(s,e)?1:0)};class Ao extends Ri{constructor(t,e){super(""),this._field=t,e&&this.load(null,e)}get field(){return this._field}get suffix(){return this._suffix}set suffix(t){if(t!==this._suffix){const e=this._suffix;this._suffix=t,this._changed(Ao.PROP_SUFFIX,t,e)}}get page(){return this._field.page}get outlineSource(){return this._field}_getEditProps(){return Ao.PROPINFOS}_getStyleProps(){return["background","backgroundColor","color","fontSize","fontWeight"]}getSaveLabel(){return"header"}_doLoad(t,e){this._loadPropsOf(e,Ao.PROPINFOS),this._loadProps(e,"styles")}_doSave(t){this._savePropsOf(t,Ao.PROPINFOS),this._saveProp(t,"styles")}}Ao.PROP_SUFFIX="suffix",Ao.PROPINFOS=[{name:Ao.PROP_SUFFIX,category:"fieldHeader",type:is}];class lo extends Ri{constructor(t,e){super(""),this._summary=t,e&&this.load(null,e)}get summary(){return this._summary}get field(){return this._summary.field}get text(){return this._text}set text(t){if(t!==this._text){const e=this._text;this._text=t,this._changed(lo.PROP_TEXT,t,e)}}get page(){return this._summary.page}get outlineSource(){return this._summary.field}_getEditProps(){return lo.PROPINFOS}_getStyleProps(){return["background","backgroundColor","color","fontSize","fontWeight"]}getSaveLabel(){return"header"}_doLoad(t,e){this._loadPropsOf(e,lo.PROPINFOS),this._loadProps(e,"styles")}_doSave(t){this._savePropsOf(t,lo.PROPINFOS),this._saveProp(t,"styles")}}lo.PROP_TEXT="text",lo.PROPINFOS=[{name:lo.PROP_TEXT,category:"fieldSummryHeader",type:is}];class ho extends Ri{constructor(t,e){super(""),this._field=t,this._header=new lo(this,e&&e.header),e&&this.load(null,e)}get field(){return this._field}get header(){return this._header}get page(){return this._field.page}get outlineSource(){return this._field}_getEditProps(){return ho.PROPINFOS}_getStyleProps(){return["background","backgroundColor","color","fontSize","fontWeight"]}getSaveLabel(){return"summary"}_doLoad(t,e){this._loadPropsOf(e,ho.PROPINFOS),this._loadProps(e,"styles")}_doSave(t){this._savePropsOf(t,ho.PROPINFOS),this._saveObject(this._header,t),this._saveProp(t,"styles")}}ho.PROPINFOS=[{name:Ri.PROP_VISIBLE,category:"fieldSummary",type:as,default:!0}];class co extends Oi{constructor(t,e){super(t,e),this._index=-1,this.fieldIndex=-1,this._header=new Ao(this,e.header),this._summary=new ho(this,e.summary)}get band(){return this.collection.band}get index(){return this._index}get field(){return this._field}set field(t){if(t!==this._field){const e=this._field;this._field=t,this._changed(co.PROP_FIELD,t,e)}}get header(){return this._header}get summary(){return this._summary}get itemType(){return"CrosstabField"}get page(){var t;return null===(t=this.collection)||void 0===t?void 0:t.page}get displayPath(){return this.collection?this.collection.displayPath+"["+this.index+"]":J.uncapitalize(this.itemType)}get collection(){return super.collection}get marqueeParent(){var t;return null===(t=this.collection)||void 0===t?void 0:t.band}isAncestor(t){return t===this.collection.band}getEditProps(){return co.PROPINFOS}_getStyleProps(){return co.styleProps}_changed(t,e,s){this.collection&&this.collection._fieldChanged(this)}_doLoad(t){this._loadPropsOf(t,co.PROPINFOS),super._doLoad(t)}_doSave(t){return this._savePropsOf(t,co.PROPINFOS),super._doSave(t),this._saveObject(this._header,t),this._saveObject(this._summary,t),t}}co.PROP_FIELD="field",co.PROPINFOS=[{name:co.PROP_FIELD,category:Ws.FIELD,type:is}],co.styleProps=[];class uo extends Fi{constructor(t,e){super(),this._fields=[],this._band=t,this._type=e}get band(){return this._band}load(t){if(this._fields=[],t&&t.length>0)for(let e of t)this.$_add(e,Number.MAX_SAFE_INTEGER);this._resetFields()}save(t){this._fields.forEach((e=>t.push(e.save({}))))}contains(t){return!!this.getField(t)}getField(t){return this._fields.find((e=>e.field===t))}slice(t){return this._fields.slice(0,t)}indexOf(t){return this._fields.indexOf(t)}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;e=e<0?this._fields.length:e;const s=this.$_add(t,e);return s&&(this._resetFields(),this._itemAdded(s)),s}removeAt(t){if(t>=0&&t<this._fields.length){const e=this._fields.splice(t,1)[0];return this._resetFields(),this._itemRemoved(e,this._band),!0}}remove(t){this.removeAt(this.indexOf(t))}get owner(){return this._band}get count(){return this._fields.length}get items(){return this._fields}get outlineLabel(){return"[".concat(J.capitalize(this._type),"]")}get outlineParent(){return this._band}get outlineExpandable(){return!0}get outlineItems(){return this._fields.forEach(((t,e)=>t.outlineOrder=e)),this._fields}get page(){var t;return null===(t=this._band)||void 0===t?void 0:t.page}get displayPath(){return this._band?this._band.displayPath+"."+this._type:this._type}get level(){return this._band?this._band.level+1:0}get(t){return this._fields[t]}getSaveType(){return this._type}$_add(t,e){const s=t instanceof co?t:this._createField(t);return this._fields.splice(Math.min(e,this._fields.length),0,s),s}_doMoveItem(t,e){return!1}_resetFields(){this._fields.forEach(((t,e)=>{t._parent=this,t._index=e})),this._fieldChanged(null)}_fieldChanged(t){this._band._fieldsChanged(t)}}class po extends co{get itemType(){return"RowField"}getCollectionLabel(){return"rowField"}}class _o extends uo{constructor(t){super(t,"rowFields")}_createField(t){return new po(this,t)}}class go extends co{constructor(t,e){super(t,e)}get itemType(){return"ColumnField"}getCollectionLabel(){return"columnField"}_doLoad(t){super._doLoad(t)}_doSave(t){return super._doSave(t),t}}class fo extends uo{constructor(t){super(t,"columnFields")}_createField(t){return new go(this,t)}}class mo extends co{constructor(t,e){super(t,e),this._value=this._value||Fn.SUM}get value(){return this._value}set value(t){if(t!==this._value){const e=this._value;this._value=t,this._changed(mo.PROP_VALUE,t,e)}}get itemType(){return"ValueField"}getCollectionLabel(){return"valueField"}getEditProps(){return super.getEditProps().concat(mo.PROPINFOS)}_doLoad(t){super._doLoad(t),this._loadPropsOf(t,mo.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,mo.PROPINFOS)}}mo.PROP_VALUE="value",mo.PROPINFOS=[{name:mo.PROP_VALUE,category:Ws.FIELD,type:As,domain:Fn,default:Fn.SUM}];class wo extends uo{constructor(t){super(t,"valueFields")}_createField(t){return new mo(this,t)}}class yo{constructor(t,e){this.sum=(t,e)=>{let s=0;for(let i of this._rows)s+=t.getRowValue(i,e);return s},this.count=(t,e)=>this._rows.length,this.min=(t,e)=>{const s=this._rows;let i=t.getRowValue(s[0],e);for(let r=s.length-1;r>0;r--)i=Math.min(i,t.getRowValue(s[r],e));return i},this.max=(t,e)=>{const s=this._rows;let i=t.getRowValue(s[0],e);for(let r=s.length-1;r>0;r--)i=Math.max(i,t.getRowValue(s[r],e));return i},this.avg=(t,e)=>{let s=0;for(let i of this._rows)s+=t.getRowValue(i,e);return s/this._rows.length},this._keys=t.slice(0),this._rows=e.slice(0)}get rowCount(){return this._rows.length}getKey(t){return this._keys[t]}getSummary(t,e,s){return this[s](t,e)}}class Co{constructor(t){this._recs=[],this._band=t}get count(){return this._recs.length}getKey(t,e){return this._recs[t].getKey(e)}getRec(t){return this._recs[t]}getRecs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;return this._recs.slice(Math.max(0,t),e)}setFilters(t){this._filters=t&&t.length>0?t.slice(0):null}build(t){const e=this._band.getGroupFields();e.forEach((e=>{e.fieldIndex=t.getFieldIndex(e.field),e.dataType=t.getField(e.fieldIndex).dataType})),this._recs=[];const s=this.$_collectRows(t);this.$_sortRows(t,s,e),this.$_buildRecs(t,s,e)}$_collectRows(t){const e=e=>{for(let s of this._filters)if(!s.select(t,e))return!1;return!0},s=[];if(this._filters)for(let i=0;i<t.rowCount;i++)e(i)&&s.push(i);else for(let e=0;e<t.rowCount;e++)s.push(e);return s}$_sortRows(t,e,s){e.sort(((e,i)=>{let r=!1,n=0;for(let o=0,a=s.length;o<a;o++){const A=s[o].fieldIndex;if(n=ao[t.getField(A).dataType](t,A,e,i),0!==n){r=a===o+1;break}}return n=0===n&&r?e-i:n,n}))}$_buildRecs(t,e,s){const i=[];let r=0,n=e[r++];const o=[n];for(let e=0;e<s.length;e++)i[e]=t.getRowValue(n,s[e].fieldIndex);for(;r<e.length;){let a=!1;n=e[r];for(let e=0;e<s.length;e++)if(i[e]!=t.getRowValue(n,s[e].fieldIndex)){a=!0;break}if(a){this._recs.push(new yo(i,o)),o.length=0;for(let e=0;e<s.length;e++)i[e]=t.getRowValue(n,s[e].fieldIndex)}o.push(n),r++}o.length>0&&this._recs.push(new yo(i,o))}}let bo=0;class vo{constructor(t,e){this.hash=bo++,this._children=[],this._field=t,this._value=e}get field(){return this._field}get value(){return this._value}get count(){return this._children.length}get children(){return this._children.slice(0)}get level(){return this.parent?this.parent.level+1:-1}get isLeaf(){return 0===this._children.length}get leafCount(){return this._children.length*this._children[0].leafCount}getChild(t){return this._children[t]}clear(){this._children=[]}add(t){t&&(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this._children.indexOf(t)<0)&&(this._children.push(t),t.parent=this)}addSummary(t){this._children.unshift(t),t.parent=this}sort(){if(this._children.length>1){const t="bool"===this._children[0].field.dataType;this._children=this._children.sort(((e,s)=>t?(e.value?1:0)-(s.value?1:0):e.value-s.value))}}getHeader(){const t=this._field.header;let e=this._value;return t.suffix&&(e+=t.suffix),e}}class Bo extends vo{constructor(){super(null,null)}}class Eo extends vo{constructor(t,e,s){super(t,s),this._valueField=e}get valueField(){return this._valueField}get leafCount(){return 1}getHeader(){const t=this._valueField.header;let e=this._valueField.field;return t.suffix&&(e+=t.suffix),e}}class Po extends vo{constructor(t){super(t.field,void 0)}get summary(){return this._summary}getHeader(){return this._field.summary.header.text||"요약"}}class xo extends Eo{constructor(t,e,s){super(t.field,e,s)}getHeader(){return this._valueField.summary.header.text||this._valueField.field}}class So{constructor(t){this._root=new Bo,this._leafs=[],this._band=t}get root(){return this._root}get count(){return this._root.count}get leafCount(){return this._leafs.length}get levels(){return this._leafs.length>0?this._leafs[0].level+1:0}build(t){this._root.clear(),this._leafs=[],this._band.columnFields.count>0&&this.$_collectColumns(t,this._root,0)}get(t){return this._root.getChild(t)}getLeaf(t){return this._leafs[t]}getColumns(t,e){e.push([])}$_collectColumns(t,e,s){const i=this._band,r=i.rowFields,n=i.columnFields,o=i.valueFields,a=i.getColumnField(s),A=r.count+s,l=s==n.count-1,h=t.count,d={};if(!(e instanceof Po))for(let s=0;s<h;s++){const i=t.getKey(s,A);let r=d[i];r||(r=new vo(a,i),e.add(r,!0),d[i]=r),e.add(r)}e.sort();const c=n.get(s);if(c.summary.visible){const t=new Po(c.summary);e.addSummary(t)}for(let i of e.children)if(l)for(let t=0;t<o.count;t++){const e=o.get(t),s=i.value,r=i instanceof Po?new xo(i.field.summary,e,s):new Eo(i.field,e,s);i.add(r,!0),this._leafs.push(r)}else this.$_collectColumns(t,i,s+1)}}class Io{}class Ro extends Io{constructor(t,e,s){if(super(),this._map={},this._values=e.slice(0),this._recs=s.slice(0),s){const e=t.rowFields.count,i=t._columns._leafs;for(let t of i){const i=s[t.hash-e],r=e+t.field.index;if(i&&i.getKey(r)===t.value)this._map[t.hash]=i;else for(let e of s)if(e.getKey(r)===t.value){this._map[t.hash]=e;break}}}}slice(t){return this._values.slice(0,t)}getRec(t){return this._recs[t]}getValue(t){return this._values[t]}getColumnRec(t){return this._map[t.hash]}getSummary(t,e,s,i){}}class To extends Io{constructor(t,e){super(),this._fields=t,this._rows=e.slice(0)}get fields(){return this._fields}slice(t){return this._rows[0].slice(t)}getValue(t){return t>=this._fields.length-1?this._rows[0].getValue(this._fields.length-1):this._rows[0].getValue(t)}getColumnRec(t){return this._rows[0].getColumnRec(t)}}class Oo extends Io{constructor(t){super(),this._rows=t}slice(t){return[]}getValue(t){return"전체 요약"}getColumnRec(t){}}class Fo{constructor(t){this._rows=[],this._band=t}get rowCount(){return this._rows.length}getRow(t){return this._rows[t]}build(t,e){this._rows=[],this._band.columnFields.count>0&&e.count>0&&(this.$_collectRows(t,e),this._rows.unshift(new Oo(this._rows)))}$_collectRows(t,e){const s=this._band,i=s.rowFields,r=e.count,n=[],o=[];let a=[],A=[],l=[],h=0;for(i.forEach(((s,i)=>{n.push(t.getFieldByName(s.field)),A.push(e.getKey(h,i))})),o.push(e.getRec(h++));h<r;){const t=e.getRec(h);let r=!1;for(let e=0;e<i.count;e++)l[e]=t.getKey(e);for(let t=0;t<i.count;t++)if(l[t]!==A[t]){r=!0;break}r&&(a.push(new Ro(s,A,o)),o.length=0,A=l.slice(0)),o.push(t),h++}a.push(new Ro(s,A,o));for(let t=i.count-2;t>=0;t--)a=this.$_collectSummaryRows(a,i.slice(t+1));this._rows=a}$_collectSummaryRows(t,e){const s=t.length,i=e.length,r=[];let n,o,a,A=0,l=0,h=t[l],d=[];for(n=t[l].slice(i);l<s;){let s=!1;h=t[l],o=h.slice(i);for(let t=0;t<i;t++)if(o[t]!==n[t]){s=!0;break}s&&(a=new To(e,d),r.push({row:a,start:A,end:l}),d.length=0,n=o,A=l),h instanceof Ro&&d.push(h),l++}a=new To(e,d),r.push({row:a,start:A,end:l});const c=[];for(let e of r){c.push(e.row);for(let s=e.start;s<e.end;s++)c.push(t[s])}return c}}class Do extends Ri{constructor(t){super(null),this._band=t}get text(){return this._text}set text(t){if(t!==this._text){const e=this._text;this._text=t,this._changed(Do.PROP_TEXT,t,e)}}_getEditProps(){return[].concat(Do.PROPINFOS)}_getStyleProps(){return Do.styleProps}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Do.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Do.PROPINFOS)}}Do.PROP_TEXT="text",Do.PROPINFOS=[{name:Do.PROP_TEXT,category:Ws.TITLE,type:is}],Do.styleProps=["background","backgroundColor","color","fontSize","fontWeight","fontFamily"];class Lo extends Ri{constructor(t){super(null),this._text="0",this._band=t}get text(){return this._text}set text(t){if(t!==this._text){const e=this._text;this._text=t,this._changed(Lo.PROP_TEXT,t,e)}}_getEditProps(){return[].concat(Lo.PROPINFOS)}_getStyleProps(){return Lo.styleProps}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Lo.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Lo.PROPINFOS)}}Lo.PROP_TEXT="text",Lo.PROPINFOS=[{name:Lo.PROP_TEXT,category:"nullValue",type:is}],Lo.styleProps=["background","backgroundColor","color","fontSize","fontWeight","fontFamily"];class No extends Ti{constructor(t){super(t),this._recs=new Co(this),this._columns=new So(this),this._rows=new Fo(this),this.pageNo=0,this.rowIndex=NaN,this._calcSummary={sum:t=>{let e=0;for(let s of t)e+=s;return e},count:t=>{let e=0;for(let s of t)e+=s;return e},avg:t=>{let e=0;for(let s of t)e+=s;return e/t.length},min:t=>{let e=t[0];for(let s=1;s<t.length;s++)e=Math.min(e,t[s]);return e},max:t=>{let e=t[0];for(let s=1;s<t.length;s++)e=Math.max(e,t[s]);return e}},this._title=new Do(this),this._nullValue=new Lo(this),this._rowFields=new _o(this),this._columnFields=new fo(this),this._valueFields=new wo(this),this.width="100%"}static isFieldCell(t){return t instanceof co||t instanceof Ao||t instanceof ho||t instanceof lo}static getFieldOf(t){return t instanceof co?t:t.field}static getBandOf(t){return this.getFieldOf(t).band}get maxRowCount(){return this._maxRowCount}set maxRowCount(t){if(isNaN(t)?t=void 0:t>>=0,t!==this._maxRowCount){const e=this._maxRowCount;this._maxRowCount=t,this._changed(No.PROP_MAX_ROW_COUNT,t,e)}}get title(){return this._title}get nullValue(){return this._nullValue}get rowFields(){return this._rowFields}get columnFields(){return this._columnFields}get valueFields(){return this._valueFields}get rows(){return this._rows}get bandData(){return this.page.report.data.get(this.data)}get columnLevels(){return this._columns.levels}containsField(t){return this._rowFields.contains(t)||this._columnFields.contains(t)||this._valueFields.contains(t)}getRowField(t){return this._rowFields.get(t)}getColumnField(t){return this._columnFields.get(t)}getGroupFields(){return[].concat(this._rowFields.items,this._columnFields.items)}build(){var t;const e=null===(t=this.page)||void 0===t?void 0:t.report.data;if(e){const t=e.get(this.data);if(!t)return;for(let t of this._rowFields.items);for(let t of this._columnFields.items);for(let e of this._valueFields.items)e.fieldIndex=t.getFieldIndex(e.field);this._recs.build(t),this._columns.build(this._recs),this._rows.build(t,this._recs)}}getCellValue(t,e,s){if(t){const i=this._rows.getRow(e),r=this._columns.getLeaf(s),n=r.valueField.fieldIndex,o=r.valueField.value;if(i instanceof Oo||i instanceof To){const e=i._rows;if(r instanceof xo){let s=[];return e.forEach((e=>{if(e instanceof Ro){e._recs.forEach((e=>{s.push(e.getSummary(t,n,o))}))}})),this._calcSummary[o](s)}{let s=[];return e.forEach((e=>{if(e instanceof Ro){const i=e.getColumnRec(r),o=r.valueField.value;s.push(i?i.getSummary(t,n,o):0)}})),this._calcSummary[o](s)}}if(i instanceof Ro){if(r instanceof xo){const e=i._recs;let s=[];return e.forEach((e=>{s.push(e.getSummary(t,n,o))})),this._calcSummary[o](s)}{const e=i.getColumnRec(r);return e?e.getSummary(t,n,o):NaN}}}}getSaveType(){return"crosstab"}get outlineLabel(){return"[Crosstab Band]"}get outlineItems(){return[this._rowFields,this._columnFields,this._valueFields].concat(super.outlineItems)}get isBand(){return!0}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(No.PROPINFOS)}isAncestorOf(t){return super.isAncestorOf(t)||t===this._rowFields||t===this._columnFields||t===this._valueFields}_doLoad(t,e){super._doLoad(t,e),e&&(["row","column","value"].forEach((t=>{const s="".concat(t,"Fields");e.hasOwnProperty(s)&&this["_".concat(s)].load(e[s])})),this._title.load(null,e.title),this._nullValue.load(null,e.nullValue))}_doSave(t){super._doSave(t),this._title.save(t.title={}),this._nullValue.save(t.nullValue={}),["row","column","value"].forEach((e=>{const s="".concat(e,"Fields");this["_".concat(s)].save(t[s]=[])}))}_fieldsChanged(t){var e;null===(e=this.page)||void 0===e||e.$_itemChanged(this,"field",t,t)}}No.PROP_TITLE="title",No.PROP_NULL_VALUE="nullValue",No.PROP_MAX_ROW_COUNT="maxRowCount",No.PROPINFOS=[{name:No.PROP_TITLE,category:Ws.TITLE,type:$s,indented:!0},{name:No.PROP_NULL_VALUE,category:"nullValue",type:$s,indented:!0},{name:No.PROP_MAX_ROW_COUNT,category:Ws.DATA,type:rs}],No.$_ctor="CrosstabBand";class Ho extends br{constructor(t,e,s){super("Add Crosstab Field"),Z(!!t),this._collection=t,this._index=e,this._config=s}_doDispose(){this._collection=this._field=null}get band(){return this._collection.band}get collection(){return this._collection}get index(){return this._index}redo(t){this._field=this._collection.add(this._config,this._index)}undo(){this._collection.remove(this._field)}get source(){return this._field}}class Qo extends br{constructor(t){super("Remove Crosstab Field"),Z(!!t),this._field=t,this._collection=t.collection,this._index=t.index}_doDispose(){this._field=null}get band(){return this._field.band}get collection(){return this._collection}get field(){return this._field}get index(){return this._index}redo(t){this._collection.removeAt(this._index)}undo(){this._collection.add(this._field,this._index)}get source(){return this._field}}class Uo extends br{constructor(t){super("Remove Item"),Z(!!t),this._parent=t.outlineParent instanceof Qi?t.outlineParent.outlineParent:t.outlineParent,Z(!!this._parent),this._item=t,this._index=this._parent.indexOf(t)}static createCommands(t){if(t&&t.length>0){const e=[];for(let s of t)if(s&&s.canRemoveFrom()){let t;s instanceof xr?t=new _n(s):s instanceof Mr?t=new rn(s):s instanceof on?t=new dn(s):s instanceof Yn?t=new eo(s):s instanceof Mn?t=new io(s):s instanceof Vn?t=new no(s):s instanceof Ri?t=new Uo(s):s instanceof co&&(t=new Qo(s)),t&&e.push(t)}return e.length>0?e:null}}_doDispose(){this._parent=this._item=null}get parent(){return this._parent}get item(){return this._item}get index(){return this._index}undo(){this._parent.add(this._item,this._index)}redo(t){this._parent.remove(this._item)}get source(){return this._item}}class Mo extends vr{constructor(t){super("Remove Items",Uo.createCommands(t))}}class ko extends Ti{constructor(t){super("reportPage"),this._events=new l,this._nameMap={},this._loading=!1,this._removing=!1,this._report=t,this.add(this._reportHeader=new ar),this.add(this._reportFooter=new Ar),this.add(this._pageHeader=new lr),this.add(this._pageFooter=new hr),this.add(this._body=new Go),this.add(this._backItems=new dr("pageBackItems","Back Items")),this.add(this._frontItems=new dr("pageFrontItems","Front Items")),this._sections=[this._pageHeader,this._reportHeader,this._body,this._backItems,this._frontItems,this._reportFooter,this._pageFooter]}addListener(t){return this._events.addListener(t)}removeListener(t){return this._events.removeListener(t)}get report(){return this._report}get reportHeader(){return this._reportHeader}get reportFooter(){return this._reportFooter}get pageHeader(){return this._pageHeader}get pageFooter(){return this._pageFooter}get body(){return this._body}get backContainer(){return this._backItems}get backItems(){return this._backItems.items}get frontContainer(){return this._frontItems}get frontItems(){return this._frontItems.items}get loading(){return this._loading}getItem(t){return this._nameMap[t]}removeItems(t,e){if(!(e=e&&e.filter((t=>t.canRemoveFrom())))||0==e.length)return 0;const s=e.sort(((t,e)=>t.level-e.level));for(let t=s.length-1;t>0;t--){const e=s[t];for(let i=t+1;i>=0;i--){const r=s[i];if(r instanceof Ti&&e instanceof Ri&&e.isAncestor(r)){s.splice(t,1);break}}}try{t?t.execute(new Mo(s)):new Mo(s).run()}finally{}}search(t,e,s){e.caseSensitive||(t=t.toLowerCase()),this._sections.forEach((i=>i.search(t,e,s)))}get outlineLabel(){return"Page"}get pathLabel(){return"page"}get page(){return this}canMove(){return!1}getEditProps(){return[]}_getStyleProps(){return["fontFamily","fontSize","fontWeight","color","backgroundColor"]}canDelete(){return!1}_doLoad(t,e){this._loading=!0;try{this._loadProps(e,"styles"),e.hasOwnProperty("reportHeader")&&this._reportHeader.load(t,e.reportHeader),e.hasOwnProperty("reportFooter")&&this._reportFooter.load(t,e.reportFooter),e.hasOwnProperty("pageHeader")&&this._pageHeader.load(t,e.pageHeader),e.hasOwnProperty("pageFooter")&&this._pageFooter.load(t,e.pageFooter),e.hasOwnProperty("body")&&this._body.load(t,e.body),e.hasOwnProperty("backItems")&&this._backItems.load(t,e.backItems),e.hasOwnProperty("frontItems")&&this._frontItems.load(t,e.frontItems)}finally{this._loading=!1}}_ignoreItems(){return!0}_doSave(t){let e;this._pageHeader.save(e={})&&(t.pageHeader=e),this._reportHeader.save(e={})&&(t.reportHeader=e),this._reportFooter.save(e={})&&(t.reportFooter=e),this._pageFooter.save(e={})&&(t.pageFooter=e),this._body.save(e={})&&(t.body=e),this._backItems.count>0&&this._backItems.save(t.backItems=[]),this._frontItems.count>0&&this._frontItems.save(t.frontItems=[])}canResize(t){return!1}getAllItems(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return t.getDescendants(e);{let t=[];return this._sections.forEach((s=>t=t.concat(s.getDescendants(e)))),t}}collectInvalids(t,e){this._sections.forEach((s=>s.collectInvalids(t,e)))}$_itemAdded(t,e,s){this.$_addItem(t),this._fireItemAdded(t,e,s)}$_addItem(t){if(t instanceof Ri&&t.name&&(this._nameMap[t.name]=t),t instanceof Ti)for(let e of t._items)this.$_addItem(e)}$_itemsAdded(t,e){t.forEach((t=>this.$_addItem(t))),this._fireItemsAdded(t,e)}$_itemRemoved(t,e){this.$_removeItem(t),this._removing||this._fireItemRemoved(t,e)}$_removeItem(t){if(t instanceof Ri&&t.name&&delete this._nameMap[t.name],t instanceof Ti)for(let e of t._items)this.$_removeItem(e)}$_itemsRemoved(t){for(let e of t)this.$_removeItem(e);this._removing||this._fireItemsRemoved(t)}$_itemChanged(t,e,s,i){this._fireItemChanged(t,e,s,i)}$_collectionChanged(t){this._fireCollectionChanged(t)}$_nameChanged(t,e){e&&delete this._nameMap[e],t.name&&(this._nameMap[t.name]=t)}$_dataNameChanged(t,e){this._sections.forEach((s=>s.dataNameChanged(t,e)))}$_dataFieldNameChanged(t,e,s){this._sections.forEach((i=>i.dataFieldNameChanged(t,e,s)))}_fireItemAdded(t,e,s){this._events.fireEvent(ko.ITEM_ADDED,t,e,s)}_fireItemsAdded(t,e){this._events.fireEvent(ko.ITEMS_ADDED,t,e)}_fireItemRemoved(t,e){this._events.fireEvent(ko.ITEM_REMOVED,t,e)}_fireItemsRemoved(t){this._events.fireEvent(ko.ITEMS_REMOVED,t)}_fireItemChanged(t,e,s,i){this._events.fireEvent(ko.ITEM_CHANGED,t,e,s,i)}_fireCollectionChanged(t){this._events.fireEvent(ko.COLLECTION_CHANGED,t)}}ko.ITEM_ADDED="onPageItemAdded",ko.ITEMS_ADDED="onPageItemsAdded",ko.ITEM_REMOVED="onPageItemRemoved",ko.ITEMS_REMOVED="onPageItemsRemoved",ko.ITEM_CHANGED="onPageItemChanged",ko.COLLECTION_CHANGED="onPageCollectionChanged",ko.$_ctor="ReportPage";class Vo extends mr{get outlineLabel(){return"Items"}canContainsBand(){return!0}canContainsBandGroup(){return!0}canResize(t){return!1}canMove(){return!1}needDesignWidth(){return!1}needDesignHeight(){return!1}_boundable(){return!1}_getStyleProps(){return Vo.STYLE_PROPS}}Vo.STYLE_PROPS=["backgroundColor"];class Go extends nr{constructor(){super("pageBody"),this.add(this._bodyItems=new Vo("bodyItems")),this.add(this._backItems=new dr("pageBackItems","Back Items")),this.add(this._frontItems=new dr("pageFrontItems","Front Items"))}get backItems(){return this._backItems.items}get backItemsContainer(){return this._backItems}get frontItems(){return this._frontItems.items}get frontItemsContainer(){return this._frontItems}get bodyItems(){return this._bodyItems.items}get itemsContainer(){return this._bodyItems}get outlineLabel(){return"Body"}canParentOf(t){return!1}canResize(t){return!1}_doLoad(t,e){e.hasOwnProperty("items")&&(this._bodyItems.load(t,{items:e.items}),this._bodyItems.loadProps(e)),e.hasOwnProperty("backItems")&&this._backItems.load(t,e.backItems),e.hasOwnProperty("frontItems")&&this._frontItems.load(t,e.frontItems)}_loadItems(t,e){}_ignoreItems(){return!0}_doSave(t){this._bodyItems.count>0&&(this._bodyItems.save(t),delete t.type,delete t.name),this._backItems.count>0&&this._backItems.save(t.backItems=[]),this._frontItems.count>0&&this._frontItems.save(t.frontItems=[])}canRemove(t){return!1}}var Ko,Wo,zo,$o,Xo;Go.$_ctor="PageBody",function(t){t.CONTAINT="contain",t.COVER="cover"}(Ko||(Ko={})),function(t){t.TOP="top",t.BOTTOM="bottom",t.LEFT="left",t.RIGHT="right",t.CENTER="center"}(Wo||(Wo={}));class jo extends Ri{constructor(t){super(t),this._imageFit=Ko.COVER,this._imagePosition=Wo.CENTER}get url(){return this._url}set url(t){if(t!=this._url){const e=this._url;this._url=t,this._changed(jo.PROP_URL,t,e)}}get image(){return this._image}set image(t){if(t!=this._image){const e=this._image;this._image=t,this._changed(jo.PROP_IMAGE,t,e)}}get imageFit(){return this._imageFit}set imageFit(t){if(t!=this._imageFit){const e=this._imageFit;this._imageFit=t,this._changed(jo.PROP_IMAGE_FIT,t,e)}}get imagePosition(){return this._imagePosition}set imagePosition(t){if(t!=this._imagePosition){const e=this._imagePosition;this._imagePosition=t,this._changed(jo.PROP_IMAGE_POSITION,t,e)}}getSaveType(){return"image"}get outlineLabel(){return"[Image]"}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=52,this.height=52}_getEditProps(){return super._getEditProps().concat(jo.PROPINFOS)}_getStyleProps(){return jo.STYLE_PROPS}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,jo.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,jo.PROPINFOS)}canRotate(){return!0}canAdoptDragSource(t){return t instanceof Ji}adoptDragSource(t){if(t instanceof Ji)return{type:Ei.PROP,prop:"image",value:t.name}}canPropAdoptDragSource(t,e){return"image"===t.name&&e instanceof Ji}adoptPropDragSource(t,e){if("image"===t.name&&e instanceof Ji)return{type:Ei.PROP,prop:"image",value:e.name}}}jo.PROP_URL="url",jo.PROP_IMAGE="image",jo.PROP_IMAGE_FIT="imageFit",jo.PROP_IMAGE_POSITION="imagePosition",jo.PROPINFOS=[{name:jo.PROP_URL,category:"Image",type:is,multiple:!1,default:void 0},{name:jo.PROP_IMAGE,category:"Image",type:is,multiple:!1,default:void 0},{name:jo.PROP_IMAGE_FIT,category:"Image",type:As,domain:Ko,default:Ko.COVER},{name:jo.PROP_IMAGE_POSITION,category:"Image",type:As,domain:Wo,default:Wo.CENTER}],jo.STYLE_PROPS=["opacity","border","borderLeft","borderRight","borderTop","borderBottom"],jo.$_ctor="ImageItem",jo.ITEM_TYPE="Image";class Yo extends Ri{constructor(t){super(t),this._threeStates=!1,this._checked=!1,this._text="Check",this._falseText="Uncheck"}get threeStates(){return this._threeStates}set threeStates(t){t!=this._threeStates&&(this._threeStates=t,this._changed(Yo.PROP_THREE_STATES,t,!t))}get checked(){return this._checked}set checked(t){if(t!=this._checked){const e=this._checked;this._checked=t,this._changed(Yo.PROP_CHECKED,t,e)}}get text(){return this._text}set text(t){if(t!=this._text){const e=this._text;this._text=t,this._changed(Yo.PROP_TEXT,t,e)}}get falseText(){return this._falseText}set falseText(t){if(t!=this._falseText){const e=this._falseText;this._falseText=t,this._changed(Yo.PROP_FALSE_TEXT,t,e)}}get emptyText(){return this._emptyText}set emptyText(t){if(t!=this._emptyText){const e=this._emptyText;this._emptyText=t,this._changed(Yo.PROP_EMPTY_TEXT,t,e)}}getChecked(t){return t?"1":!1!==t||this._threeStates?"-1":"0"}getText(t){return t?this._text:!1!==t||this._threeStates?this._emptyText:this._falseText}get outlineLabel(){return"[Check]"}getSaveType(){return"check"}_getEditProps(){return super._getEditProps().concat(Yo.PROPINFOS)}_getStyleProps(){return Yo.STYLE_PROPS}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.text="Check"}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Yo.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Yo.PROPINFOS)}}Yo.PROP_THREE_STATES="threeStates",Yo.PROP_CHECKED="checked",Yo.PROP_TEXT="text",Yo.PROP_FALSE_TEXT="falseText",Yo.PROP_EMPTY_TEXT="emptyText",Yo.PROPINFOS=[{name:Yo.PROP_THREE_STATES,category:"Check",type:as,multiple:!1,default:!1},{name:Yo.PROP_CHECKED,category:"Check",type:as,multiple:!1,default:!1},{name:Yo.PROP_TEXT,category:Ws.TEXT,type:is,multiple:!1,default:void 0},{name:Yo.PROP_FALSE_TEXT,category:Ws.TEXT,type:is,multiple:!1,default:void 0},{name:Yo.PROP_EMPTY_TEXT,category:Ws.TEXT,type:is,multiple:!1,default:void 0}],Yo.STYLE_PROPS=["fontFamily","fontSize","fontStyle","textDecoration","fontWeight","color","backgroundColor","border"],Yo.$_ctor="CheckItem",Yo.ITEM_TYPE="Check";class Jo extends Qi{constructor(t){super(t,"tableCell")}}Jo.$_ctor="ListCellItem",function(t){t.CIRCLE="circle",t.DISC="disc",t.SQUARE="square",t.DECIMAL="decimal",t.LOWER_ROMAN="lower-roman",t.UPPER_ROMAN="upper-roman",t.LOWER_ALPHA="lower-alpha",t.UPPER_ALPHA="upper-alpha",t.NONE="none"}(zo||(zo={}));class Zo extends Ui{constructor(t){super(t),this._ordered=!1,this._start=1,this._indent=void 0,this.designHeight=50,this.designWidth=160}get ordered(){return this._ordered}set ordered(t){t!=this._ordered&&(this._ordered=t,this._changed(Zo.PROP_ORDERED,t,!t))}get start(){return this._start}set start(t){if(t!==this._start){const e=this._start;this._start=t,this._changed(Zo.PROP_START,t,e)}}get marker(){return this._marker}set marker(t){if(t!==this._marker){const e=this._marker;this._marker=t,this._changed(Zo.PROP_MARKER,t,e)}}get indent(){return this._indent}set indent(t){if(t!==this._indent){const e=this._indent;this._indent=t,this._changed(Zo.PROP_INDENT,t,e)}}getSaveType(){return"list"}get outlineLabel(){return"[List]"}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(Zo.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Zo.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Zo.PROPINFOS)}_doSaveItems(t,e){for(let s of e){const e={};s.item.save(e),t.push(e)}}_prepareCellGroup(t){return new Jo(t)}}Zo.PROP_ORDERED="ordered",Zo.PROP_START="start",Zo.PROP_MARKER="marker",Zo.PROP_INDENT="indent",Zo.PROPINFOS=[{name:Zo.PROP_ORDERED,category:Ws.MARKER,type:as,multiple:!1,default:0},{name:Zo.PROP_START,category:Ws.MARKER,type:rs,multiple:!1,default:1},{name:Zo.PROP_MARKER,category:Ws.MARKER,type:As,multiple:!1,default:void 0,domain:zo},{name:Zo.PROP_INDENT,category:Ws.MARKER,type:rs,multiple:!1,default:void 0}],Zo.$_ctor="ListContainer",Zo.ITEM_TYPE="List";class qo extends rr{constructor(t){super(null),this._repeat=!0,this._child_field=null,Z(!!t),this._band=t,this.width="100%",this.designHeight=24}get band(){return this._band}get repeat(){return this._repeat}set repeat(t){t!=this._repeat&&(this._repeat=t,this._changed(qo.PROP_SIMPLE_BAND_SECTION_REPEAT,t,!t))}getFieldOf(t){return t.getChildProp(qo.PROP_FIELD,this._child_field)}setFieldOf(t,e){t.setChildProp(qo.PROP_FIELD,e)}get designLevel(){return this._band.designLevel}get marqueeParent(){return this._band}canResize(t){return t===E.BOTTOM}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Aa.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Aa.PROPINFOS)}_doLoadChild(t,e){super._doLoadChild(t,e),e.hasOwnProperty(qo.PROP_FIELD)&&this.setFieldOf(t,e.field)}}qo.PROP_SIMPLE_BAND_SECTION_REPEAT="repeat",qo.PROPINFOS=[{name:qo.PROP_SIMPLE_BAND_SECTION_REPEAT,category:"Band",type:as,multiple:!1,default:!0}],qo.PROP_FIELD="field";class ta extends qo{constructor(t){super(t)}get outlineLabel(){return"[Band Header]"}}ta.$_ctor="SimpleBandHeader";class ea extends qo{constructor(){super(...arguments),this._attachToBody=!1}get attachToBody(){return this._attachToBody}set attachToBody(t){t!==this._attachToBody&&(this._attachToBody=t,this._changed(ea.PROP_ATTACH_TO_BODY,t,!t))}get outlineLabel(){return"[Band Footer]"}_getEditProps(){return super._getEditProps().concat(ea.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,ea.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,ea.PROPINFOS)}}ea.PROP_ATTACH_TO_BODY="attachToBody",ea.PROPINFOS=[{name:ea.PROP_ATTACH_TO_BODY,category:Ws.BAND,type:as,multiple:!1,default:!1}],ea.$_ctor="SimpleBandFooter";class sa extends qo{constructor(){super(...arguments),this.masterRow=NaN}get blankItems(){return this._blankItems}canBlank(t,e){if(this.band.dataObj.equalRows(e,e-1,t.$_blankFlds))return!0}get outlineLabel(){return"[Data Row]"}get dataDominant(){return!0}get isDataRowContainer(){return!0}_getChildPropInfos(t){return sa.CHILD_PROPS.concat(super._getChildPropInfos(t))}_doLoadChild(t,e){super._doLoadChild(t,e),this._loadChildPropsOf(t,e,sa.CHILD_PROPS)}_doPreparePrint(t){super._doPreparePrint(t),this._blankItems=this.collectBlankItems()}}sa.PROP_EQUAL_BLANK="equalBlank",sa.PROP_BLANK_FIELDS="blankFields",sa.CHILD_PROPS=[{name:sa.PROP_EQUAL_BLANK,category:Ws.BAND,type:as,multiple:!1,default:!1},{name:sa.PROP_BLANK_FIELDS,category:Ws.BAND,type:is,multiple:!1,default:void 0}],sa.$_ctor="SimpleBandRow";class ia extends rr{constructor(t,e){super(e),this._group=t}get group(){return this._group}get band(){var t;return null===(t=this._group)||void 0===t?void 0:t.band}}ia.STYLE_PROPS=["backgroundColor"];class ra extends ia{constructor(t){super(t,"groupHeader")}get outlineLabel(){return"Group Header"}}ra.$_ctor="SimpleBandRowGroupHeader";class na extends ia{constructor(t){super(t,"groupFooter")}get outlineLabel(){return"Group Footer"}}na.$_ctor="SimpleBandRowGroupFooter";class oa extends Hr{constructor(t){super("simpleBandRowGroup"),this.add(this._header=new ra(this)),this.add(this._footer=new na(this)),this._collection=t}get outlineParent(){return this._collection}get marqueeParent(){return this.band}getEditProps(){return oa.PROPINFOS.concat(super.getEditProps())}get header(){return this._header}get footer(){return this._footer}get band(){var t;return null===(t=this._collection)||void 0===t?void 0:t.band}get page(){var t;return null===(t=this.band)||void 0===t?void 0:t.page}get report(){var t;return null===(t=this.band)||void 0===t?void 0:t.report}get collection(){return this._collection}get dataParent(){return this.band}_ignoreItems(){return!0}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,oa.PROPINFOS),e.hasOwnProperty("header")&&this._header.load(t,e.header),e.hasOwnProperty("footer")&&this._footer.load(t,e.footer)}_doSave(t){super._doSave(t),this._savePropsOf(t,oa.PROPINFOS),this._header.save(t.header={}),this._footer.save(t.footer={})}_changed(t,e,s){super._changed(t,e,s),this._collection&&this._collection.$_groupChanged(this)}}oa.PROPINFOS=[];class aa extends Fi{constructor(t){super(),this._groups=[],this._band=t}get outlineParent(){return this._band}get outlineLabel(){return"[Groups]"}get outlineExpandable(){return!0}get outlineItems(){return this._groups}getSaveType(){return"groups"}canRemoveFrom(){return!1}canParentOf(t){return!1}get owner(){return this._band}get band(){return this._band}get count(){return this._groups.length}get items(){return this._groups.slice()}get visibleCount(){let t=0;for(let e of this._groups)e.visible&&t++;return t}get groups(){return this._groups.slice()}load(t,e){if(this._groups=[],e&&e.length>0){for(let s of e)if(s){const e=new oa(this);e.load(t,s),this._groups.push(e)}this.$_invalidateGroups()}}save(t){for(let e of this._groups){const s={};e.save(s),t.push(s)}}get(t){return this._groups[t]}indexOf(t){return this._groups.indexOf(t)}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=this.$_add(t,e);if(s)return this.$_invalidateGroups(),this._itemAdded(s),s}addAll(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(!t||t.length<1)return;const s=this._groups.length;e=e<0?this._groups.length:Math.max(0,this._groups.length);for(let s of t)this.$_add(s,e)&&e++;return this._groups.length!=s?(this.$_invalidateGroups(),!0):void 0}removeAt(t){if(t>=0&&t<this._groups.length){const e=this._groups.splice(t,1)[0];return this.$_invalidateGroups(),this._itemRemoved(e,this._band),!0}}remove(t){return this.removeAt(this.indexOf(t))}clear(){if(this._groups.length>0)return this._groups=[],this.$_invalidateGroups(),!0}getValidGroups(t){if(t){const e=[];for(let s of this._groups){const i=s.field;J.isNumber(i)?i>=0&&i<t.fieldCount&&e.push(s):t.containsField(i)&&e.push(s)}return e.length?e:null}return null}get page(){var t;return null===(t=this._band)||void 0===t?void 0:t.page}get displayPath(){return this._band?this._band.displayPath+".groups":"groups"}get level(){return this._band?this._band.level+1:0}isAncestorOf(t){if(super.isAncestorOf(t))return!0;if(this._groups.indexOf(t)>=0)return!0;for(let e of this._groups)if(e.indexOf(t))return!0}_doMoveItem(t,e){return!1}$_add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(!(t instanceof oa)){const e=t;t=new oa(this),e&&t.extend(e)}if(t instanceof oa&&this._groups.indexOf(t)<0)return e<0?this._groups.push(t):this._groups.splice(Math.min(e,this._groups.length),0,t),t}$_invalidateGroups(){for(let t=this._groups.length-1;t>=0;t--)this._groups[t]._index=t;this._band&&this._band.$_groupChanged(null)}$_groupChanged(t){this._band&&this._band.$_groupChanged(t)}}class Aa extends Qr{constructor(t){super(t),this._groups=new aa(this),this.add(this._header=new ta(this)),this.add(this._footer=new ea(this)),this.add(this._dataRow=new sa(this)),this._setOutlineOrders(1,this._dataRow,this._footer,this.detail),this.width="100%"}get outlineItems(){return[this._groups].concat(super.outlineItems)}get groups(){return this._groups}get header(){return this._header}get footer(){return this._footer}get dataRow(){return this._dataRow}get pr(){return this._pr}setPrinting(t,e){t.row=this._pr=e}getSaveType(){return"simpleband"}get outlineLabel(){return"[Simple Band]"}get isBand(){return!0}_ignoreItems(){return!0}_getEditProps(){return super._getEditProps().concat(Aa.PROPINFOS)}isAncestorOf(t){return!!super.isAncestorOf(t)||(t===this._groups||(!!this._groups.isAncestorOf(t)||void 0))}_doLoad(t,e){super._doLoad(t,e),e.hasOwnProperty("groups")&&this._groups.load(t,e.groups),e.hasOwnProperty("header")&&this.header.load(t,e.header),e.hasOwnProperty("footer")&&this.footer.load(t,e.footer),e.hasOwnProperty("row")&&this.dataRow.load(t,e.row),e.hasOwnProperty("dataRow")&&this.dataRow.load(t,e.dataRow)}_doSave(t){super._doSave(t),this._groups.save(t.groups=[]),this._header.save(t.header={}),this._footer.save(t.footer={}),this._dataRow.save(t.dataRow={})}$_groupChanged(t){this._changed(Aa.PROP_SIMPLE_BAND_GROUPS,this._groups,this._groups)}_doPreparePrint(t){super._doPreparePrint(t),this._groups.preparePrint(t)}_doPrepareIndices(t){t.row=t.index=this._pr=0}canRemove(t){return!1}getNextDetailRows(t){return this._getNextDetailRows(t,this._pr)}skipDetailRows(t){const e=this._skipDetailRows(t,this._pr);this._pr+=e}containsInSection(t){return this._header.contains(t,!0)||this._footer.contains(t,!0)}}Aa.PROP_SIMPLE_BAND_GROUPS="groups",Aa.PROPINFOS=[],Aa.$_ctor="SimpleBand",Aa.ITEM_TYPE="Simple Band",function(t){t.CODE39="code39",t.CODE128="code128",t.CODE128A="code128a",t.CODE128B="code128b",t.CODE128C="code128c",t.EAN13="ean13",t.EAN8="ean8",t.EAN5="ean5",t.EAN2="ean2",t.UPC="upc",t.UPCE="upce",t.ITF="itf",t.ITF14="itf14",t.MSI10="msi10",t.MSI11="msi11",t.MSI1010="msi1010",t.MSI1110="msi1110",t.PHARMACODE="pharmacode",t.CODABAR="codabar"}($o||($o={}));class la extends Ri{constructor(t){super(t),this._format=$o.CODE128,this._text="",this._barWidth=1,this._showText=!1,this._textAlign=c.CENTER,this._textPosition="bottom",this._textMargin=2,this._flat=!1}get format(){return this._format}set format(t){if(t!=this._format){const e=this._format;this._format=t,this._changed(la.PROP_FORMAT,t,e)}}get text(){return this._text}set text(t){if(t!=this._text){const e=this._text;this._text=t,this._changed(la.PROP_TEXT,t,e)}}get barWidth(){return this._barWidth}set barWidth(t){if((t=J.toNumber(t,1))!==this._barWidth){const e=this._barWidth;this._barWidth=t,this._changed(la.PROP_BAR_WIDTH,t,e)}}get showText(){return this._showText}set showText(t){t!==this._showText&&(this._showText=t,this._changed(la.PROP_SHOW_TEXT,t,!t))}get textAlign(){return this._textAlign}set textAlign(t){if(t!==this._textAlign){const e=this._textAlign;this._textAlign=t,this._changed(la.PROP_TEXT_ALIGN,t,e)}}get textPosition(){return this._textPosition}set textPosition(t){if(t!==this._textPosition){const e=this._textPosition;this._textPosition=t,this._changed(la.PROP_TEXT_POSITION,t,e)}}get textMargin(){return this._textMargin}set textMargin(t){if(t!==this._textMargin){const e=this._textMargin;this._textMargin=t,this._changed(la.PROP_TEXT_MARGIN,t,e)}}get flat(){return this._flat}set flat(t){t!==this._flat&&(this._flat=t,this._changed(la.PROP_FLAT,t,!t))}get lastChar(){return this._lastChar}set lastChar(t){if(t!==this._lastChar){const e=this._lastChar;this._lastChar=t,this._changed(la.PROP_LAST_CHAR,t,e)}}convertText(t){return this._format?t.toUpperCase():t}getSaveType(){return"barcode"}get outlineLabel(){return"Barcode"}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.text="12345",this.width=120,this.height=60}_getEditProps(){return super._getEditProps().concat(la.PROPINFOS)}_getStyleProps(){return la.STYLE_PROPS}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,la.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,la.PROPINFOS)}}la.PROP_FORMAT="format",la.PROP_TEXT="text",la.PROP_BAR_WIDTH="barWidth",la.PROP_SHOW_TEXT="showText",la.PROP_TEXT_POSITION="textPosition",la.PROP_TEXT_MARGIN="textMargin",la.PROP_TEXT_ALIGN="textAlign",la.PROP_FLAT="flat",la.PROP_LAST_CHAR="lastChar",la.PROPINFOS=[{name:la.PROP_FORMAT,category:Ws.BARCODE,type:As,default:$o.CODE128,domain:$o,refresh:!0},{name:la.PROP_TEXT,category:Ws.BARCODE,type:is,default:""},{name:la.PROP_BAR_WIDTH,category:Ws.BARCODE,type:rs,default:1},{name:la.PROP_SHOW_TEXT,category:Ws.BARCODE,type:as,default:!1},{name:la.PROP_TEXT_ALIGN,category:Ws.BARCODE,type:As,domain:c},{name:la.PROP_TEXT_POSITION,category:Ws.BARCODE,type:As,domain:["top","bottom"]},{name:la.PROP_TEXT_MARGIN,category:Ws.BARCODE,type:rs,default:2},{name:la.PROP_FLAT,category:Ws.BARCODE,type:as,default:!1,visible:t=>"ean8"===t.format||"ean13"===t.format},{name:la.PROP_LAST_CHAR,category:Ws.BARCODE,type:is,visible:t=>"ean13"===t.format}],la.STYLE_PROPS=["fontFamily","fontSize","fontStyle","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border"],la.$_ctor="BarcodeItem",la.ITEM_TYPE="Barcode",function(t){t.L="L",t.M="M",t.Q="Q",t.H="H"}(Xo||(Xo={}));class ha extends Ri{constructor(t){super(t),this._text="",this._errorCorrectionLevel=Xo.Q}get text(){return this._text}set text(t){if(t!==this._text){const e=this._text;this._text=t,this._changed(ha.PROP_QRCODE_TEXT,t,e)}}get errorCorrectionLevel(){return this._errorCorrectionLevel}set errorCorrectionLevel(t){if(t!==this._errorCorrectionLevel){const e=this._errorCorrectionLevel;this._errorCorrectionLevel=t,this._changed(ha.PROP_QRCODE_ERROR_CORRECTION_LEVEL,t,e)}}getSaveType(){return"qrcode"}get outlineLabel(){return"Qrcode"}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.text="https://www.real-report.com/",this.width=100,this.height=100}_getEditProps(){return super._getEditProps().concat(ha.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,ha.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,ha.PROPINFOS)}canRotate(){return!0}}ha.QRCODE_MIN_SIZE=50,ha.PROP_QRCODE_TEXT="text",ha.PROP_QRCODE_ERROR_CORRECTION_LEVEL="errorCorrectionLevel",ha.PROPINFOS=[{name:ha.PROP_QRCODE_ERROR_CORRECTION_LEVEL,category:"qrcode",type:is,multiple:!1,default:Xo.Q,domain:[Xo.L,Xo.M,Xo.Q,Xo.H]},{name:ha.PROP_QRCODE_TEXT,category:Ws.TEXT,type:is,multiple:!1,default:""}],ha.$_ctor="QrcodeItem",ha.ITEM_TYPE="Qrcode";class da{constructor(t){this.className=t}draw(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0;return this._doDraw(t,e,s,i,r||"")}drawAt(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;const a=this._doDraw(s,i,r,n,o||"");return a.setAttribute("transform","translate("+t+","+e+")"),this.className&&a.classList.add(this.className),a}}const ca={rectangle:[0,0,1,0,1,1,0,1],triangle:[.5,0,0,1,1,1],itriangle:[0,0,.5,1,1,0],diamond:[.5,0,0,.5,.5,1,1,.5],uparrow:[.5,0,0,.5,.3,.5,.3,1,.7,1,.7,.5,1,.5],downarrow:[.3,0,.3,.5,0,.5,.5,1,1,.5,.7,.5,.7,0],leftarrow:[0,.5,.5,1,.5,.7,1,.7,1,.3,.5,.3,.5,0],rightarrow:[0,.3,0,.7,.5,.7,.5,1,1,.5,.5,0,.5,.3],plus:[.3,0,.3,.3,0,.3,0,.7,.3,.7,.3,1,.7,1,.7,.7,1,.7,1,.3,.7,.3,.7,0],minus:[0,.3,0,.7,1,.7,1,.3],star:[.5,0,.6122,.3454,.9755,.3454,.6816,.559,.7938,.9045,.5,.691,.2061,.9045,.3183,.559,.02447,.3454,.3877,.3454]},ua={equal:[[0,.2,0,.4,1,.4,1,.2],[0,.6,0,.8,1,.8,1,.6]]};class pa extends da{constructor(t,e){super(e),this._shape=t}get shape(){return this._shape}set shape(t){this._shape=t?"inverted_triangle"===t?pa.INVERTED_TRIANLGE:t.toLowerCase():null}_doDraw(t,e,s,i,r){const n=this._shape;if(e-=i,s-=i,ca.hasOwnProperty(n)){let o=ca[n];if(o){let n=i/2,a=i/2;o=o.slice();for(let t=0,i=o.length/2;t<i;t++)o[2*t]=n+o[2*t]*e,o[2*t+1]=a+o[2*t+1]*s;return o.push(o[0],o[1]),t.polygon(r,o)}}else if(ua.hasOwnProperty(n)){const o=ua[n];if(o){let n=i/2,a=i/2,A=o[0].slice();for(let t=0,i=A.length/2;t<i;t++)A[2*t]=n+A[2*t]*e,A[2*t+1]=a+A[2*t+1]*s;A.push(A[0],A[1]),t.polygon(null,A),A=o[1],A=A.slice();for(let t=0,i=A.length/2;t<i;t++)A[2*t]=n+A[2*t]*e,A[2*t+1]=a+A[2*t+1]*s;return A.push(A[0],A[1]),t.polygon(r,A)}}}}pa.RECTANGLE="rectangle",pa.TRIANLGE="triangle",pa.INVERTED_TRIANLGE="itriangle",pa.DIAMOND="diamond",pa.UP_ARROW="uparrow",pa.DOWN_ARROW="downarrow",pa.LEFT_ARROW="leftarrow",pa.RIGHT_ARROW="rightarrow",pa.PLUS="plus",pa.MINUS="minus",pa.EQUAL="equal",pa.STAR="star";class _a extends da{constructor(){super(...arguments),this.circled=!0}static isEllipse(t){return t in this.ELLIPSES}_doDraw(t,e,s,i,r){const n=i/2;if(this.circled){const i=Math.min(e,s)/2;return t.ellipse(r,e/2,s/2,i-n,i-n)}return t.ellipse(r,e/2,s/2,e/2-n,s/2-n)}}_a.CIRCLE="circle",_a.ELLIPSE="ellipse",_a.ELLIPSES={circle:"",ellipse:""};class ga extends da{static isLine(t){return t in this.LINES}_doDraw(t,e,s,i){let r,n;switch(this.shape){case ga.HLINE:return n=s/2,t.line(null,0,n,e,n);case ga.VLINE:return r=e/2,t.line(null,r,0,r,s);case ga.DIAGONAL:return t.line(null,0,0,e,s);case ga.RDIAGONAL:return t.line(null,0,s,e,0)}}}ga.HLINE="hline",ga.VLINE="vline",ga.DIAGONAL="diagonal",ga.RDIAGONAL="rdiagonal",ga.LINES={hline:"",vline:"",diagonal:"",rdiagonal:""};const fa=[pa.RECTANGLE,pa.TRIANLGE,pa.INVERTED_TRIANLGE,pa.DIAMOND,pa.UP_ARROW,pa.DOWN_ARROW,pa.LEFT_ARROW,pa.RIGHT_ARROW,pa.PLUS,pa.MINUS,pa.EQUAL,pa.STAR,_a.CIRCLE,_a.ELLIPSE],ma=fa.concat([ga.HLINE,ga.VLINE,ga.DIAGONAL,ga.RDIAGONAL]);class wa extends Ri{constructor(t){super(t),this._shape=pa.STAR}get shape(){return this._shape}set shape(t){if(t!==this._shape){const e=this._shape;this._shape=t,this._changed(wa.PROP_SHAPE,t,e)}}get shapeCallback(){return this._shapeCallback}set shapeCallback(t){if(t!==this._shapeCallback){const e=this._shapeCallback;this._shapeCallback=t,this._changed(wa.PROP_SHAPE_CALLBACK,t,e)}}_getEditProps(){return super._getEditProps().concat(wa.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,wa.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,wa.PROPINFOS)}setProperty(t,e){if(super.setProperty(t,e),"shape"===t&&ga.isLine(e)&&!this._isLoading()){let t=this.getStyle("stroke");t||(this.setStyleProperty("stroke","green"),t=this.getStyle("strokeWidth"),t||this.setStyleProperty("strokeWidth","2"))}}canRotate(){return!0}}wa.PROP_SHAPE="shape",wa.PROP_SHAPE_CALLBACK="shapeCallback",wa.PROPINFOS=[];class ya extends wa{constructor(t){super(t)}getSaveType(){return"shape"}get outlineLabel(){return"Shape"}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.shape="star",this.width=24,this.height=24}_getEditProps(){return super._getEditProps().concat(ya.PROPINFOS)}_getStyleProps(){return ya.STYLE_PROPS}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,ya.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,ya.PROPINFOS)}}ya.PROPINFOS=[{name:wa.PROP_SHAPE,category:"Shape",type:is,multiple:!1,default:void 0,domain:ma}],ya.STYLE_PROPS=["backgroundColor","fill","stroke","strokeWidth","strokeDasharray"],ya.$_ctor="ShapeItem",ya.ITEM_TYPE="Shape";class Ca extends Ri{constructor(t){super(t)}get svg(){return this._svg}set svg(t){if(t!=this._svg){const e=this._svg;this._svg=t,this._changed(Ca.PROP_SVG,t,e)}}getSaveType(){return"svg"}get outlineLabel(){return"Svg"}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=52,this.height=52}_getEditProps(){return super._getEditProps().concat(Ca.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Ca.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ca.PROPINFOS)}canAdoptDragSource(t){return t instanceof Zi}adoptDragSource(t){if(t instanceof Zi)return{type:Ei.PROP,prop:"svg",value:t.name}}canPropAdoptDragSource(t,e){return"svg"===t.name&&e instanceof Zi}adoptPropDragSource(t,e){if("svg"===t.name&&e instanceof Zi)return{type:Ei.PROP,prop:"svg",value:e.name}}canRotate(){return!0}}Ca.PROP_SVG="svg",Ca.PROPINFOS=[{name:Ca.PROP_SVG,category:"Svg",type:is,multiple:!1,default:void 0}],Ca.$_ctor="SvgItem",Ca.ITEM_TYPE="Svg";class ba extends wa{constructor(t){super(t),this._shapeCount=5,this._countinuous=!1,this._designValue=2}get shapeCount(){return this._shapeCount}set shapeCount(t){if((t=Math.max(1,J.toNumber(t)))!==this._shapeCount){const e=this._shapeCount;this._shapeCount=t,this._changed(ba.PROP_RATING_SHAPE_COUNT,t,e)}}get countinuous(){return this._countinuous}set countinuous(t){t!==this._countinuous&&(this._countinuous=t,this._changed(ba.PROP_SHAPE,t,!this._countinuous))}get minimum(){return this._minimum}set minimum(t){if((t=J.toNumber(t,NaN))!=this._minimum){const e=this._minimum;this._minimum=t,this._changed(ba.PROP_RATING_MINIMUM,t,e)}}get maximum(){return this._maximum}set maximum(t){if((t=J.toNumber(t,NaN))!=this._maximum){const e=this._maximum;this._maximum=t,this._changed(ba.PROP_RATING_MAXIMUM,t,e)}}get designValue(){return this._designValue}set designValue(t){if((t=J.toNumber(t,0))!=this._designValue){const e=this._designValue;this._designValue=t,this._changed(ba.PROP_RATING_DESIGN_VALUE,t,e)}}get outlineLabel(){return"[Rating]"}getSaveType(){return"rating"}_getEditProps(){return super._getEditProps().concat(ba.PROPINFOS)}_getStyleProps(){return ba.STYLE_PROPS}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=Math.min(100,s||100),this.height=Math.min(20,i||20)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,ba.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,ba.PROPINFOS)}}ba.PROP_RATING_SHAPE_COUNT="shapeCount",ba.PROP_RATING_CONTINUOUS="continuous",ba.PROP_RATING_MINIMUM="minimum",ba.PROP_RATING_MAXIMUM="maximum",ba.PROP_RATING_DESIGN_VALUE="designValue",ba.PROPINFOS=[{name:wa.PROP_SHAPE,category:"Shape",type:is,multiple:!1,default:void 0,domain:fa},{name:ba.PROP_RATING_SHAPE_COUNT,category:"Rating",type:rs,multiple:!1,default:5},{name:ba.PROP_RATING_MINIMUM,category:"Rating",type:rs,multiple:!1,default:0},{name:ba.PROP_RATING_MAXIMUM,category:"Rating",type:rs,multiple:!1,default:100},{name:ba.PROP_RATING_DESIGN_VALUE,category:"Rating",type:rs,multiple:!1,default:50}],ba.STYLE_PROPS=["backgroundColor","fill","stroke","backFill","backStroke"],ba.$_ctor="RatingItem",ba.ITEM_TYPE="Rating";class va extends cr{constructor(t){super(t)}get expression(){return this._expression}set expression(t){if(t!=this._expression){const e=this._expression;this._expression=t,this._exprNode=t?Ie.Default.parse(t):null,this._changed(va.PROP_EXPRESSION,t,e)}}getSummary(t){return this._exprNode?this._exprNode.evaluate(t):NaN}getSaveType(){return"summary"}get designText(){return this.value}get outlineLabel(){let t=this.expression;return"[Summary]"+(t?" "+t:"")}get pathLabel(){return"summary"}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i)}_getEditProps(){return super._getEditProps().concat(va.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,va.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,va.PROPINFOS)}}va.PROP_EXPRESSION="expression",va.PROPINFOS=[{name:va.PROP_EXPRESSION,category:Ws.DATA,type:is,multiple:!1,default:void 0}],va.$_ctor="SummaryItem",va.ITEM_TYPE="Summary";class Ba extends Ri{constructor(t){super(t),this._minimum=0,this._maximum=100,this._position=35}get minimum(){return this._minimum}set minimum(t){if(t!=this._minimum){const e=this._minimum;this._minimum=t,this._changed(Ba.PROP_BAR_MINIMUM,t,e)}}get maximum(){return this._maximum}set maximum(t){if(t!=this._maximum){const e=this._maximum;this._maximum=t,this._changed(Ba.PROP_BAR_MAXIMUM,t,e)}}get position(){return this._position}set position(t){if((t=J.toNumber(t,0))!=this._position){const e=this._position;this._position=t,this._changed(Ba.PROP_POSITION,t,e)}}get outlineLabel(){return"[Bar]"}getSaveType(){return"bar"}_getEditProps(){return super._getEditProps().concat(Ba.PROPINFOS)}_getStyleProps(){return Ba.STYLE_PROPS}canRotate(){return!0}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.width=Math.min(60,s||60),this.height=Math.min(25,i||25)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Ba.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ba.PROPINFOS)}}Ba.PROP_BAR_MINIMUM="minimum",Ba.PROP_BAR_MAXIMUM="maximum",Ba.PROP_POSITION="position",Ba.PROPINFOS=[{name:Ba.PROP_BAR_MINIMUM,category:"Bar",type:rs,multiple:!1,default:0},{name:Ba.PROP_BAR_MAXIMUM,category:"Bar",type:rs,multiple:!1,default:100},{name:Ba.PROP_POSITION,category:"Bar",type:rs,multiple:!1,default:50}],Ba.STYLE_PROPS=["border","backgroundColor","barColor"],Ba.$_ctor="BarItem",Ba.ITEM_TYPE="Bar";class Ea extends Jn{constructor(t){super(t),this._grouping=!0,this.dataLabels.visible=!1}get grouping(){return this._grouping}set grouping(t){t!==this._grouping&&(this._grouping=t,this._changed(Ea.PROP_GROUPING,t,!t))}get stack(){return this._stack}set stack(t){if(t!==this._stack){const e=this._stack;this._stack=t,this._changed(Ea.PROP_STACK,t,e)}}get pointPadding(){return this._pointPadding}set pointPadding(t){if(t!==this._pointPadding){const e=this._pointPadding;this._pointPadding=t,this._changed(Ea.PROP_POINT_PADDING,t,e)}}get pointPlacement(){return this._pointPlacement}set pointPlacement(t){const e=this._pointPlacement;this._pointPlacement=t,this._changed(Ea.PROP_POINT_PLACEMENT,t,e)}get seriesType(){return"column"}_getEditProps(){return super._getEditProps().concat(Ea.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Ea.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ea.PROPINFOS)}wrap(t){return super.wrap(t),!0!==this._grouping&&(t[Ea.PROP_GROUPING]=this._grouping),t[Ea.PROP_POINT_PLACEMENT]=J.toStrOrNum(this._pointPlacement),this.assignProps(t,[Ea.PROP_STACK,Ea.PROP_POINT_PADDING])}}Ea.PROP_GROUPING="grouping",Ea.PROP_STACK="stack",Ea.PROP_POINT_PADDING="pointPadding",Ea.PROP_POINT_PLACEMENT="pointPlacement",Ea.PROPINFOS=[{name:Ea.PROP_GROUPING,category:Ws.SERIES,type:as,multiple:!1,default:!0},{name:Ea.PROP_STACK,category:Ws.SERIES,type:is,multiple:!1,default:void 0},{name:Ea.PROP_POINT_PADDING,category:Ws.SERIES,type:rs,multiple:!1,default:void 0},{name:Ea.PROP_POINT_PLACEMENT,category:Ws.SERIES,type:is,multiple:!1,default:void 0}],Ea.$_ctor="HichartColumnSeries";(class extends Ea{constructor(t){super(t)}get seriesType(){return"columnrange"}_doLoad(t,e){super._doLoad(t,e)}_doSave(t){super._doSave(t)}}).$_ctor="HichartColumnRangeSeries";class Pa extends Jn{constructor(t){super(t),this._grouping=!0,this.dataLabels.visible=!1}get grouping(){return this._grouping}set grouping(t){t!==this._grouping&&(this._grouping=t,this._changed(Pa.PROP_GROUPING,t,!t))}get stack(){return this._stack}set stack(t){if(t!==this._stack){const e=this._stack;this._stack=t,this._changed(Pa.PROP_STACK,t,e)}}get pointPadding(){return this._pointPadding}set pointPadding(t){if(t!==this._pointPadding){const e=this._pointPadding;this._pointPadding=t,this._changed(Pa.PROP_POINT_PADDING,t,e)}}get pointPlacement(){return this._pointPlacement}set pointPlacement(t){const e=this._pointPlacement;this._pointPlacement=t,this._changed(Pa.PROP_POINT_PLACEMENT,t,e)}get seriesType(){return"bar"}_getEditProps(){return super._getEditProps().concat(Pa.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Pa.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Pa.PROPINFOS)}wrap(t){return super.wrap(t),!0!==this._grouping&&(t[Pa.PROP_GROUPING]=this._grouping),t[Pa.PROP_POINT_PLACEMENT]=J.toStrOrNum(this._pointPlacement),this.assignProps(t,[Pa.PROP_STACK,Pa.PROP_POINT_PADDING])}}Pa.PROP_GROUPING="grouping",Pa.PROP_STACK="stack",Pa.PROP_POINT_PADDING="pointPadding",Pa.PROP_POINT_PLACEMENT="pointPlacement",Pa.PROPINFOS=[{name:Pa.PROP_GROUPING,category:Ws.SERIES,type:as,multiple:!1,default:!0},{name:Pa.PROP_STACK,category:Ws.SERIES,type:is,multiple:!1,default:void 0},{name:Pa.PROP_POINT_PADDING,category:Ws.SERIES,type:rs,multiple:!1,default:void 0},{name:Pa.PROP_POINT_PLACEMENT,category:Ws.SERIES,type:is,multiple:!1,default:void 0}],Pa.$_ctor="HichartBarSeries";class xa extends to{constructor(t){super(t)}get radius(){return this._radius}set radius(t){if(t!==this._radius){const e=this._radius;this._radius=t,this._changed(xa.PROP_RADIUS,t,e)}}_getEditProps(){return super._getEditProps().concat(xa.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,xa.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,xa.PROPINFOS)}}xa.PROP_RADIUS="radius",xa.PROPINFOS=[{name:xa.PROP_RADIUS,category:Ws.MARKER,type:rs,multiple:!0,default:void 0}];class Sa extends Jn{constructor(t){super(t),this._marker=new xa(this)}get lineWidth(){return this._lineWidth}set lineWidth(t){if(t!==this._lineWidth){const e=this._lineWidth;this._lineWidth=t,this._changed(Sa.PROP_LINE_WIDTH,t,e)}}get lineColor(){return this._lineColor}set lineColor(t){if(t!==this._lineColor){const e=this._lineColor;this._lineColor=t,this._changed(Sa.PROP_LINE_COLOR,t,e)}}get marker(){return this._marker}get seriesType(){return"line"}canHideMarker(){return!0}_getEditProps(){return super._getEditProps().concat(Sa.PROPINFOS)}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this._marker.defaultInit(t,e,s,i)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Sa.PROPINFOS),this._loadObjects([this._marker],t,e)}_doSave(t){super._doSave(t),this._savePropsOf(t,Sa.PROPINFOS),this._saveObjects([this._marker],t)}wrap(t){super.wrap(t);const e=this._getPropsWrapper({});return e.marker=this._marker.getWrapper(),J.extend(t,e)}}Sa.PROP_LINE_WIDTH="lineWidth",Sa.PROP_LINE_COLOR="lineColor",Sa.PROP_MARKER="marker",Sa.PROPINFOS=[{name:Sa.PROP_LINE_WIDTH,category:Ws.SERIES,type:rs,multiple:!0,default:void 0},{name:Sa.PROP_LINE_COLOR,category:Ws.SERIES,type:_s,multiple:!0,default:void 0},{name:Sa.PROP_MARKER,category:Ws.MARKER,indented:!0,type:$s,multiple:!1,default:void 0}],Sa.$_ctor="HichartLineSeries";class Ia extends Sa{get seriesType(){return"spline"}}Ia.$_ctor="HichartSplineSeries";class Ra extends Sa{constructor(t){super(t)}get fillColor(){return this._fillColor}set fillColor(t){if(t!==this._fillColor){const e=this._fillColor;this._fillColor=t,this._changed(Ra.PROP_FILL_COLOR,t,e)}}get seriesType(){return"area"}_getEditProps(){return super._getEditProps().concat(Ra.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Ra.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ra.PROPINFOS)}wrap(t){return super.wrap(t),J.extend(t,this._getPropsWrapper({}))}}Ra.PROP_FILL_COLOR="fillColor",Ra.PROPINFOS=[{name:Ra.PROP_FILL_COLOR,category:Ws.SERIES,type:_s,multiple:!0,default:void 0}],Ra.$_ctor="HichartAreaSeries";class Ta extends Ra{get seriesType(){return"areaspline"}}Ta.$_ctor="HichartAreaSplineSeries";class Oa extends Ra{constructor(){super(...arguments),this._xValues=[1,2,3,4,5],this._lowValues=[7,5,3,8,6],this._highValues=[12,9,7,11,9]}get xField(){return this._xField}set xField(t){if(t!==this._xField){const e=this._xField;this._xField=t,this._changed(Oa.PROP_X_FIELD,t,e)}}get xValues(){return this._xValues}set xValues(t){if(t!==this._xValues){const e=this._xValues;this._xValues=null==t?void 0:t.slice(),this._changed(Oa.PROP_X_VALUES,t,e)}}get lowField(){return this._lowField}set lowField(t){if(t!==this._lowField){const e=this._lowField;this._lowField=t,this._changed(Oa.PROP_LOW_FIELD,t,e)}}get lowValues(){return this._lowValues}set lowValues(t){if(t!==this._lowValues){const e=this._lowValues;this._lowValues=null==t?void 0:t.slice(),this._changed(Oa.PROP_LOW_VALUES,t,e)}}get highField(){return this._highField}set highField(t){if(t!==this._highField){const e=this._highField;this._highField=t,this._changed(Oa.PROP_HIGH_FIELD,t,e)}}get highValues(){return this._highValues}set highValues(t){if(t!==this._highValues){const e=this._highValues;this._highValues=null==t?void 0:t.slice(),this._changed(Oa.PROP_HIGH_VALUES,t,e)}}get seriesType(){return"arearange"}hasValuesProp(){return!1}_getEditProps(){return super._getEditProps().concat(Oa.PROPINFOS)}_doDefaultInit(t,e,s,i){this._doDefaultInit(t,e,s,i)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Oa.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Oa.PROPINFOS)}getValues(t,e){const s=super.getValues(t,e),i=this._getValues(t,"x",e),r=this._getValues(t,"low",e),n=this._getValues(t,"high",e),o=[];if(s&&i&&r&&n){let t=0;for(let e of s)o.push({x:i[t],low:r[t],high:n[t]}),t++}return o}wrap(t){super.wrap(t);const e=this._getPropsWrapper({});return J.extend(t,e)}}Oa.PROP_X_FIELD="xField",Oa.PROP_X_VALUES="xValues",Oa.PROP_LOW_FIELD="lowField",Oa.PROP_LOW_VALUES="lowValues",Oa.PROP_HIGH_FIELD="highField",Oa.PROP_HIGH_VALUES="highValues",Oa.PROPINFOS=[{name:Oa.PROP_X_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:Oa.PROP_X_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:Oa.PROP_LOW_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:Oa.PROP_LOW_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:Oa.PROP_HIGH_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:Oa.PROP_HIGH_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0}],Oa.$_ctor="HichartAreaRangeSeries";class Fa extends Yn{constructor(t){super(t),this._names=["사과","배","감","귤","수박"],this._startAngle=0,this._dataLabels=new jn(t),this.size="75%",this.innerSize="0%",this.colorByPoint=!0,this.showInLegend=!1}getPropDomain(t){return this.report&&t.name===Fa.PROP_PIE_SERIES_NAME_FIELD?this.getDataFieldNames():super.getPropDomain(t)}get dataLabels(){return this._dataLabels}get nameField(){return this._nameField}set nameField(t){if(t!==this._nameField){const e=this._nameField;this._nameField=t,this._changed(Fa.PROP_PIE_SERIES_NAME_FIELD,t,e)}}get names(){return this._names}set names(t){if(t!==this._names){const e=this._names;this._names=null==t?void 0:t.slice(),this._changed(Fa.PROP_PIE_SERIES_NAMES,t,e)}}get size(){return this._size}set size(t){if((t=this._validateSize(t))!==this._size){const e=this._size;this._size=t,this._sizeDim=new C(t),this._changed(Fa.PROP_PIE_SERIES_SIZE,t,e)}}get innerSize(){return this._innerSize}set innerSize(t){if((t=this._validateSize(t))!==this._innerSize){const e=this._innerSize;this._innerSize=t,this._innerSizeDim=new C(t),this._changed(Fa.PROP_PIE_SERIES_SIZE,t,e)}}get startAngle(){return this._startAngle}set startAngle(t){if(t!==this._startAngle){const e=this._startAngle;this._startAngle=t,this._changed(Fa.PROP_PIE_SERIES_START_ANGLE,t,e)}}get endAngle(){return this._endAngle}set endAngle(t){if(t!==this._endAngle){const e=this._endAngle;this._endAngle=t,this._changed(Fa.PROP_PIE_SERIES_END_ANGLE,t,e)}}get centerX(){return this._centerX}set centerX(t){if((t=this._validateSize(t))!==this._centerX){const e=this._centerX;this._centerX=t,this._centerXDim=new C(t),this._changed(Fa.PROP_PIE_SERIES_CENTER_X,t,e)}}get centerY(){return this._centerY}set centerY(t){if((t=this._validateSize(t))!==this._centerY){const e=this._centerY;this._centerY=t,this._centerYDim=new C(t),this._changed(Fa.PROP_PIE_SERIES_CENTER_Y,t,e)}}get seriesType(){return"pie"}_getEditProps(){return super._getEditProps().concat(Fa.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Fa.PROPINFOS),this._loadObjects([this._dataLabels],t,e)}_doSave(t){super._doSave(t),this._savePropsOf(t,Fa.PROPINFOS),this._saveObjects([this._dataLabels],t)}wrap(t){var e,s,i,r;return super.wrap(t),J.extend(t,{size:null===(e=this._sizeDim)||void 0===e?void 0:e.getValue(),innerSize:null===(s=this._innerSizeDim)||void 0===s?void 0:s.getValue(),startAngle:this._startAngle,endAngle:this._endAngle,center:[null===(i=this._centerXDim)||void 0===i?void 0:i.getValue(),null===(r=this._centerYDim)||void 0===r?void 0:r.getValue()],dataLabels:this._dataLabels.getWrappaer()})}getValues(t,e){const s=this._getNames(t.printing,e),i=super.getValues(t,e),r=[];if(i){let t=0;for(let e of i)r.push({y:e,name:s&&s.length>t?s[t]:t}),t++}return r}_getNames(t,e){if(t&&this._nameField){const t=this.data||this._getParentData();if(t)return e.getFieldValues(t,this._nameField)}return this._names}}Fa.PROP_PIE_SERIES_DATA_LABELS="dataLabels",Fa.PROP_PIE_SERIES_NAME_FIELD="nameField",Fa.PROP_PIE_SERIES_NAMES="names",Fa.PROP_PIE_SERIES_SIZE="size",Fa.PROP_PIE_SERIES_INNER_SIZE="innerSize",Fa.PROP_PIE_SERIES_START_ANGLE="startAngle",Fa.PROP_PIE_SERIES_END_ANGLE="endAngle",Fa.PROP_PIE_SERIES_CENTER_X="centerX",Fa.PROP_PIE_SERIES_CENTER_Y="centerY",Fa.PROPINFOS=[{name:Fa.PROP_PIE_SERIES_DATA_LABELS,category:"data labels",type:$s,indented:!0,multiple:!1,default:void 0},{name:Fa.PROP_PIE_SERIES_NAME_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:Fa.PROP_PIE_SERIES_NAMES,category:Ws.SERIES,type:ps,multiple:!1,default:void 0},{name:Fa.PROP_PIE_SERIES_SIZE,category:Ws.SERIES,type:ns,multiple:!0,default:void 0},{name:Fa.PROP_PIE_SERIES_INNER_SIZE,category:Ws.SERIES,type:ns,multiple:!0,default:void 0},{name:Fa.PROP_PIE_SERIES_START_ANGLE,category:Ws.SERIES,type:rs,multiple:!0,default:0},{name:Fa.PROP_PIE_SERIES_END_ANGLE,category:Ws.SERIES,type:rs,multiple:!0,default:void 0},{name:Fa.PROP_PIE_SERIES_CENTER_X,category:Ws.SERIES,type:ns,multiple:!0,default:void 0},{name:Fa.PROP_PIE_SERIES_CENTER_Y,category:Ws.SERIES,type:ns,multiple:!0,default:void 0}],Fa.$_ctor="HichartPieSeries";class Da extends to{constructor(t){super(t),this._fillOpacity=.5,this._lineWidth=1}get fillOpacity(){return this._fillOpacity}set fillOpacity(t){if(t!==this._fillOpacity){const e=this._fillOpacity;this._fillOpacity=t,this._changed(Da.PROP_FILL_OPACITY,t,e)}}get lineColor(){return this._lineColor}set lineColor(t){if(t!==this._lineColor){const e=this._lineColor;this._lineColor=t,this._changed(Da.PROP_LINE_COLOR,t,e)}}get lineWidth(){return this._lineWidth}set lineWidth(t){if(t!==this._lineWidth){const e=this._lineWidth;this._lineWidth=t,this._changed(Da.PROP_LINE_WIDTH,t,e)}}_getEditProps(){return super._getEditProps().concat(Da.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Da.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Da.PROPINFOS)}}Da.PROP_FILL_OPACITY="fillOpacity",Da.PROP_LINE_COLOR="lineColor",Da.PROP_LINE_WIDTH="lineWidth",Da.PROPINFOS=[{name:Da.PROP_FILL_OPACITY,category:Ws.MARKER,type:rs,multiple:!0,default:.5},{name:Da.PROP_LINE_COLOR,category:Ws.MARKER,type:_s,multiple:!0,default:void 0},{name:Da.PROP_LINE_WIDTH,category:Ws.MARKER,type:rs,multiple:!0,default:1}];class La extends Jn{constructor(t){super(t),this._xValues=[1,2,3,4,5],this._yValues=[1,2,3,4,5],this._marker=new Da(this),this.dataLabels.visible=!1}get xField(){return this._xField}set xField(t){if(t!==this._xField){const e=this._xField;this._xField=t,this._changed(La.PROP_X_FIELD,t,e)}}get xValues(){return this._xValues}set xValues(t){if(t!==this._xValues){const e=this._xValues;this._xValues=null==t?void 0:t.slice(),this._changed(La.PROP_X_VALUES,t,e)}}get yField(){return this._yField}set yField(t){if(t!==this._yField){const e=this._yField;this._yField=t,this._changed(La.PROP_Y_FIELD,t,e)}}get yValues(){return this._yValues}set yValues(t){if(t!==this._yValues){const e=this._yValues;this._yValues=null==t?void 0:t.slice(),this._changed(La.PROP_Y_VALUES,t,e)}}get nameField(){return this._nameField}set nameField(t){if(t!==this._nameField){const e=this._nameField;this._nameField=t,this._changed(La.PROP_NAME_FIELD,t,e)}}get names(){return this._names&&this._names.slice(0)}set names(t){if(t!==this._names){const e=this._names;this._names=t&&t.slice(0),this._changed(La.PROP_NAMES,t,e)}}get marker(){return this._marker}get seriesType(){return"bubble"}_getEditProps(){return super._getEditProps().concat(La.PROPINFOS)}_getFieldProps(){return[La.PROP_X_FIELD,La.PROP_Y_FIELD]}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,La.PROPINFOS),this._loadObjects([this._marker],t,e)}_doSave(t){super._doSave(t),this._savePropsOf(t,La.PROPINFOS),this._saveObjects([this._marker],t)}getValues(t,e){const s=super.getValues(t,e),i=this._getValues(t,"x",e),r=this._getValues(t,"y",e),n=this._getValues(t,"name",e),o=[];return s&&i&&r&&s.forEach(((t,e)=>{const s={x:i[e],y:r[e],z:t};n&&(s.name=n[e]),o.push(s)})),o}wrap(t){const e=super.wrap(t);return this._getPropsWrapper(e),e.marker=this._marker.getWrapper(),J.extend(t,e)}}La.PROP_X_FIELD="xField",La.PROP_X_VALUES="xValues",La.PROP_Y_FIELD="yField",La.PROP_Y_VALUES="yValues",La.PROP_NAME_FIELD="nameField",La.PROP_NAMES="names",La.PROP_MARKER="marker",La.PROPINFOS=[{name:La.PROP_X_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:La.PROP_X_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:La.PROP_Y_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:La.PROP_Y_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:La.PROP_NAME_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:La.PROP_NAMES,category:Ws.SERIES,type:ps,multiple:!1,default:void 0},{name:La.PROP_MARKER,category:Ws.MARKER,indented:!0,type:$s,multiple:!1,default:void 0}],La.$_ctor="HichartBubbleSeries";class Na extends Ti{constructor(t){super(t),this._rowGap=Na.DEF_ROW_GAP,this._rowAlign=Na.DEF_ROW_ALIGN,this._itemAlign=Na.DEF_ITEM_ALIGN,this.designWidth=100,this.designHeight=160}get maxRows(){return this._maxRows}set maxRows(t){if(t!=this._maxRows){const e=this._maxRows;this._maxRows=t,this._changed(Na.PROP_MAX_ROWS,t,e)}}get rowGap(){return this._rowGap}set rowGap(t){if(t!=this._rowGap){const e=this._rowGap;this._rowGap=t,this._changed(Na.PROP_ROW_GAP,t,e)}}get rowAlign(){return this._rowAlign}set rowAlign(t){if(t!=this._rowAlign){const e=this._rowAlign;this._rowAlign=t,this._changed(Na.PROP_ROW_ALIGN,t,e)}}get itemAlign(){return this._itemAlign}set itemAlign(t){if(t!=this._itemAlign){const e=this._itemAlign;this._itemAlign=t,this._changed(Na.PROP_ITEM_ALIGN,t,e)}}getSaveType(){return"datalist"}get outlineLabel(){return"[DataList]"}_datable(){return!0}_getEditProps(){return super._getEditProps().concat(Na.PROPINFOS)}_getStyleProps(){return Na.STYLE_PROPS}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Na.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Na.PROPINFOS)}}Na.DEF_ROW_GAP=4,Na.DEF_ROW_ALIGN=c.LEFT,Na.DEF_ITEM_ALIGN=u.TOP,Na.PROP_MAX_ROWS="maxRows",Na.PROP_ROW_GAP="rowGap",Na.PROP_ROW_ALIGN="rowAlign",Na.PROP_ITEM_ALIGN="itemAlign",Na.PROPINFOS=[{name:Na.PROP_MAX_ROWS,category:"Data List",type:rs,multiple:!1,default:void 0},{name:Na.PROP_ROW_GAP,category:"Data List",type:rs,multiple:!1,default:Na.DEF_ROW_GAP},{name:Na.PROP_ROW_ALIGN,category:"Data List",type:As,domain:c,multiple:!1,default:Na.DEF_ROW_ALIGN},{name:Na.PROP_ITEM_ALIGN,category:"Data List",type:As,domain:u,multiple:!1,default:Na.DEF_ITEM_ALIGN},Ri.VALUE_PROP],Na.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"],Na.$_ctor="DataListContainer",Na.ITEM_TYPE="DataList";class Ha extends Ti{constructor(t){super(t),this._weight=1}get weight(){return this._weight}set weight(t){if((t=Math.max(0,J.toNumber(t,1)))!==this._weight){const e=this._weight;this._weight=t,this._changed(Ha.PROP_WEIGHT,t,e)}}loadProps(t){this._loadPropsOf(t,Ha.PROPINFOS)}getSaveType(){return"bandcell"}get displayPath(){return this.parent?this.parent.displayPath+".cells["+this.index+"]":""}get outlineLabel(){return"[Band Cell]"}get marqueeParent(){return this.parent}_getEditProps(){return super._getEditProps().concat(Ha.PROPINFOS)}_getStyleProps(){return Ha.STYLE_PROPS}canResize(t){return!1}_sizable(){return!1}_maxChildCount(){return 1}canSized(){return!1}needDesignWidth(){return!1}needDesignHeight(){return!1}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Ha.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ha.PROPINFOS)}canAdd(t){return t instanceof Qr}canContainsBand(){return!0}}Ha.PROP_WEIGHT="weight",Ha.PROPINFOS=[{name:Ha.PROP_WEIGHT,category:Ws.BAND_CELL,type:rs,multiple:!1,default:void 0}],Ha.STYLE_PROPS=["backgroundColor"],Ha.$_ctor="BandCell",Ha.ITEM_TYPE="Band Cell";class Qa extends Ti{constructor(t){super(t),this._bandGap=4,this.bandCount=2,this.width="100%",this.designHeight=160}get bandCount(){return this.count}set bandCount(t){if((t=J.toNumber(t,0))!==this.bandCount){const e=this.bandCount;this.$_resetCells(t),this._changed(Qa.PROP_BAND_COUNT,t,e)}}get bandGap(){return this._bandGap}set bandGap(t){if(J.isNotDefined(t)&&(t=0),t!=this._bandGap){const e=this._bandGap;this._bandGap=t,this._changed(Qa.PROP_BAND_GAP,t,e)}}loadProps(t){this._loadPropsOf(t,Qa.PROPINFOS)}getSaveType(){return"bandgroup"}get outlineLabel(){return"[Band Group]"}_getEditProps(){return super._getEditProps().concat(Qa.PROPINFOS)}_getStyleProps(){return Qa.STYLE_PROPS}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Qa.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Qa.PROPINFOS)}canAdd(t){return t instanceof Ha}$_resetCells(t){for(;this.count<t;){const t=new Ha;this.add(t)}for(;this.count>t;)this.removeLast()}}Qa.PROP_BAND_COUNT="bandCount",Qa.PROP_BAND_GAP="bandGap",Qa.PROPINFOS=[{name:Qa.PROP_BAND_COUNT,category:Ws.BAND_GROUP,type:rs,multiple:!1,default:void 0,calculated:!0},{name:Qa.PROP_BAND_GAP,category:Ws.BAND_GROUP,type:rs,multiple:!1,default:void 0}],Qa.STYLE_PROPS=[],Qa.$_ctor="BandGroup",Qa.ITEM_TYPE="Band Group";class Ua extends Ri{constructor(t){super(t)}get pageName(){return this._pageName}set pageName(t){if(t!==this._pageName){const e=this._pageName;this._pageName=e,this._changed(Ua.PROP_PAGE_NAME,t,e)}}get outlineLabel(){return"[Page]"}getSaveType(){return"page"}_datable(){return!0}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i)}_getStyleProps(){return Ua.STYLE_PROPS}}Ua.PROP_PAGE_NAME="pageName",Ua.PROPINFOS=[{name:Ua.PROP_PAGE_NAME,category:"page",type:is,multiple:!0,default:void 0}],Ua.$_ctor="PageItem",Ua.ITEM_TYPE="Page",Ua.STYLE_PROPS=["fontFamily","fontSize","fontWeight","color","backgroundColor","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"];class Ma extends to{constructor(t){super(t),this._lineWidth=1,this._radius=4}get lineColor(){return this._lineColor}set lineColor(t){if(t!==this._lineColor){const e=this._lineColor;this._lineColor=t,this._changed(Ma.PROP_LINE_COLOR,t,e)}}get lineWidth(){return this._lineWidth}set lineWidth(t){if(t!==this._lineWidth){const e=this._lineWidth;this._lineWidth=t,this._changed(Ma.PROP_LINE_WIDTH,t,e)}}get radius(){return this._radius}set radius(t){if(t!==this._radius){const e=this._radius;this._radius=t,this._changed(Ma.PROP_RADIUS,t,e)}}_getEditProps(){return super._getEditProps().concat(Ma.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Ma.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ma.PROPINFOS)}}Ma.PROP_LINE_COLOR="lineColor",Ma.PROP_LINE_WIDTH="lineWidth",Ma.PROP_RADIUS="radius",Ma.PROPINFOS=[{name:Ma.PROP_LINE_COLOR,category:Ws.MARKER,type:_s,multiple:!0,default:void 0},{name:Ma.PROP_LINE_WIDTH,category:Ws.MARKER,type:rs,multiple:!0,default:1},{name:Ma.PROP_RADIUS,category:Ws.MARKER,type:rs,multiple:!0,default:void 0}];class ka extends Jn{constructor(t){super(t),this._xValues=[161,170,172,147,159,174,154,162,168,167],this._yValues=[51,59,55,49,50,54,46,53,62,58],this._marker=new Ma(this),this.values=[3,4,7,9,4],this.dataLabels.visible=!1}get xField(){return this._xField}set xField(t){if(t!==this._xField){const e=this._xField;this._xField=t,this._changed(ka.PROP_X_FIELD,t,e)}}get xValues(){return this._xValues}set xValues(t){if(t!==this._xValues){const e=this._xValues;this._xValues=null==t?void 0:t.slice(),this._changed(ka.PROP_X_VALUES,t,e)}}get yField(){return this._yField}set yField(t){if(t!==this._yField){const e=this._yField;this._yField=t,this._changed(ka.PROP_Y_FIELD,t,e)}}get yValues(){return this._yValues}set yValues(t){if(t!==this._yValues){const e=this._yValues;this._yValues=null==t?void 0:t.slice(),this._changed(ka.PROP_Y_VALUES,t,e)}}get nameField(){return this._nameField}set nameField(t){if(t!==this._nameField){const e=this._nameField;this._nameField=t,this._changed(ka.PROP_NAME_FIELD,t,e)}}get names(){return this._names&&this._names.slice(0)}set names(t){if(t!==this._names){const e=this._names;this._names=t&&t.slice(0),this._changed(ka.PROP_NAMES,t,e)}}get marker(){return this._marker}get seriesType(){return"scatter"}hasValuesProp(){return!1}_getEditProps(){return super._getEditProps().concat(ka.PROPINFOS)}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this._marker.defaultInit(t,e,s,i)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,ka.PROPINFOS),this._loadObjects([this._marker],t,e)}_doSave(t){super._doSave(t),this._savePropsOf(t,ka.PROPINFOS),this._saveObjects([this._marker],t)}getValues(t,e){const s=this._getValues(t,"x",e),i=this._getValues(t,"y",e),r=this._getValues(t,"name",e),n=[];return s&&i&&s.forEach(((t,e)=>{const o={x:s[e],y:i[e]};r&&(o.name=r[e]),n.push(o)})),n}wrap(t){const e=super.wrap(t);return this._getPropsWrapper(e),e.marker=this._marker.getWrapper(),J.extend(t,e)}}ka.PROP_X_FIELD="xField",ka.PROP_X_VALUES="xValues",ka.PROP_Y_FIELD="yField",ka.PROP_Y_VALUES="yValues",ka.PROP_NAME_FIELD="nameField",ka.PROP_NAMES="names",ka.PROP_MARKER="marker",ka.PROPINFOS=[{name:ka.PROP_X_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:ka.PROP_X_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:ka.PROP_Y_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:ka.PROP_Y_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:ka.PROP_NAME_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:ka.PROP_NAMES,category:Ws.SERIES,type:ps,multiple:!1,default:void 0},{name:ka.PROP_MARKER,category:Ws.MARKER,indented:!0,type:$s,multiple:!1,default:void 0}],ka.$_ctor="HichartScatterSeries";class Va extends Ri{constructor(t){super(t),this._text=""}get text(){return this._text}set text(t){if(t!==this._text){const e=this._text;this._text=t,this._changed(Va.PROP_TEXT,t,e)}}get pad(){return this._pad}set pad(t){if(t!==this._pad){const e=this._pad;this._pad=t,this._changed(Va.PROP_PAD,t,e)}}getSaveType(){return"datamatrix"}get outlineLabel(){return"DataMatrix"}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.text="https://www.real-report.com/",this.width=100,this.height=100}_getEditProps(){return super._getEditProps().concat(Va.PROPINFOS)}_getStyleProps(){return Va.STYLE_PROPS}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Va.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Va.PROPINFOS)}}Va.MIN_SIZE=10,Va.PROP_TEXT="text",Va.PROP_PAD="pad",Va.PROPINFOS=[{name:Va.PROP_TEXT,category:Ws.BARCODE,type:is},{name:Va.PROP_PAD,category:Ws.BARCODE,type:rs}],Va.STYLE_PROPS=["color","backgroundColor","border"],Va.$_ctor="DataMatrixItem",Va.ITEM_TYPE="DataMatrix";class Ga extends Jn{constructor(t){super(t),this._lowValues=[760,733,714,724,834],this._q1Values=[801,853,762,802,836],this._medianValues=[848,939,817,806,864],this._q3Values=[895,980,870,871,882],this._highValues=[965,1080,918,950,910],this.dataLabels.visible=!1}get lowField(){return this._lowField}set lowField(t){if(t!==this._lowField){const e=this._lowField;this._lowField=t,this._changed(Ga.PROP_LOW_FIELD,t,e)}}get lowValues(){return this._lowValues}set lowValues(t){if(t!==this._lowValues){const e=this._lowValues;this._lowValues=null==t?void 0:t.slice(),this._changed(Ga.PROP_LOW_VALUES,t,e)}}get q1Field(){return this._q1Field}set q1Field(t){if(t!==this._q1Field){const e=this._q1Field;this._q1Field=t,this._changed(Ga.PROP_Q1_FIELD,t,e)}}get q1Values(){return this._q1Values}set q1Values(t){if(t!==this._q1Values){const e=this._q1Values;this._q1Values=null==t?void 0:t.slice(),this._changed(Ga.PROP_Q1_VALUES,t,e)}}get medianField(){return this._medianField}set medianField(t){if(t!==this._medianField){const e=this._medianField;this._medianField=t,this._changed(Ga.PROP_MEDIAN_FIELD,t,e)}}get medianValues(){return this._medianValues}set medianValues(t){if(t!==this._medianValues){const e=this._medianValues;this._medianValues=null==t?void 0:t.slice(),this._changed(Ga.PROP_MEDIAN_VALUES,t,e)}}get q3Field(){return this._q3Field}set q3Field(t){if(t!==this._q3Field){const e=this._q3Field;this._q3Field=t,this._changed(Ga.PROP_Q3_FIELD,t,e)}}get q3Values(){return this._q3Values}set q3Values(t){if(t!==this._q3Values){const e=this._q3Values;this._q3Values=null==t?void 0:t.slice(),this._changed(Ga.PROP_Q3_VALUES,t,e)}}get highField(){return this._highField}set highField(t){if(t!==this._highField){const e=this._highField;this._highField=t,this._changed(Ga.PROP_HIGH_FIELD,t,e)}}get highValues(){return this._highValues}set highValues(t){if(t!==this._highValues){const e=this._highValues;this._highValues=null==t?void 0:t.slice(),this._changed(Ga.PROP_HIGH_VALUES,t,e)}}get seriesType(){return"boxplot"}hasValuesProp(){return!1}_getEditProps(){return super._getEditProps().concat(Ga.PROPINFOS)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Ga.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ga.PROPINFOS)}getValues(t,e){const s=this._getValues(t,"low",e),i=this._getValues(t,"q1",e),r=this._getValues(t,"median",e),n=this._getValues(t,"q3",e),o=this._getValues(t,"high",e),a=[];return s&&i&&r&&n&&o&&s.forEach(((t,e)=>{const A={low:s[e],q1:i[e],median:r[e],q3:n[e],high:o[e]};a.push(A)})),a}wrap(t){const e=super.wrap(t);return this._getPropsWrapper(e),J.extend(t,e)}}Ga.PROP_LOW_FIELD="lowField",Ga.PROP_LOW_VALUES="lowValues",Ga.PROP_Q1_FIELD="q1Field",Ga.PROP_Q1_VALUES="q1Values",Ga.PROP_MEDIAN_FIELD="medianField",Ga.PROP_MEDIAN_VALUES="medianValues",Ga.PROP_Q3_FIELD="q3Field",Ga.PROP_Q3_VALUES="q3Values",Ga.PROP_HIGH_FIELD="highField",Ga.PROP_HIGH_VALUES="highValues",Ga.PROPINFOS=[{name:Ga.PROP_LOW_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:Ga.PROP_LOW_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:Ga.PROP_Q1_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:Ga.PROP_Q1_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:Ga.PROP_MEDIAN_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:Ga.PROP_MEDIAN_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:Ga.PROP_Q3_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:Ga.PROP_Q3_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0},{name:Ga.PROP_HIGH_FIELD,category:Ws.SERIES,type:hs,multiple:!1,default:void 0},{name:Ga.PROP_HIGH_VALUES,category:Ws.SERIES,type:us,multiple:!1,default:void 0}],Ga.$_ctor="HichartBoxplotSeries";class Ka extends Jn{constructor(t){super(t),this.dataLabels.visible=!1}get baseSeries(){return this._baseSeries}set baseSeries(t){if(t!==this._baseSeries){const e=this._baseSeries;this._baseSeries=t,this._changed(Ka.PROP_BASE_SERIES,t,e)}}get binsNumber(){const t=+this._binsNumber;return isNaN(t)?this._binsNumber:t}set binsNumber(t){if(t!==this._binsNumber){const e=this._binsNumber;this._binsNumber=t,this._changed(Ka.PROP_BINS_NUMBER,t,e)}}get binWidth(){return this._binWidth}set binWidth(t){if(t!==this._binWidth){const e=this._binWidth;this._binWidth=t,this._changed(Ka.PROP_BIN_WIDTH,t,e)}}get seriesType(){return"histogram"}_getEditProps(){return super._getEditProps().concat(Ka.PROPINFOS)}getPropDomain(t){if(t.name===Ka.PROP_BASE_SERIES)return this.chart.series.getIds(this.id)}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,Ka.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,Ka.PROPINFOS)}wrap(t){return super.wrap(t),this.assignProps(t,[Ka.PROP_BASE_SERIES,Ka.PROP_BINS_NUMBER,Ka.PROP_BIN_WIDTH])}}Ka.PROP_BASE_SERIES="baseSeries",Ka.PROP_BINS_NUMBER="binsNumber",Ka.PROP_BIN_WIDTH="binWidth",Ka.PROPINFOS=[{name:Ka.PROP_BASE_SERIES,category:Ws.SERIES,type:hs},{name:Ka.PROP_BINS_NUMBER,category:Ws.SERIES,type:ds,domain:[void 0,"square-root","sturges","rice"]},{name:Ka.PROP_BIN_WIDTH,category:Ws.SERIES,type:rs}],Ka.$_ctor="HichartHistogramSeries";const Wa=["/","br","b","i","strong","em","mark","site","dfn","span","img"];class za extends Ri{constructor(t){super(t)}get html(){return this._html}set html(t){if(t){let e=0;for(;;){const s=t.indexOf("<",e);if(!(s>=0))break;{let i=!1;for(const r of Wa)if(t.startsWith(r,s+1)){i=!0,e=s+r.length;break}if(!i){console.error("사용할 수 없는 tag입니다: "+t.substring(s));break}}}}if(t!=this._html){const e=this._html;this._html=t,this.$_parseValues(t),this._changed(za.PROP_HTML,t,e)}}getHtml(t){const e=this._tokens;let s=this._html;if(t.printing&&e&&e.length>0){const i=this.data;let r="",n=0;e.forEach((e=>{r+=s.substring(n,e.from);let o=s.substring(e.from+2,e.to-1);"value"===o&&(o=this.value);const a=t.dp.getValueAt(i,o,t.row);r+=void 0===a?"":a,n=e.to})),s=r+s.substring(n,s.length)}return s||""}getSaveType(){return"html"}get outlineLabel(){return"[Html]"}_doDefaultInit(t,e,s,i){super._doDefaultInit(t,e,s,i),this.html="${value}"}_getEditProps(){return super._getEditProps().concat(za.PROPINFOS)}_getStyleProps(){return za.STYLE_PROPS}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,za.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,za.PROPINFOS)}canRotate(){return!0}canAdoptDragSource(t){return t instanceof Fe}adoptDragSource(t){if(t instanceof Fe)return{type:Ei.PROP,prop:"value",value:t.data+"::"+t.path}}canPropAdoptDragSource(t,e){return"value"===t.name&&e instanceof Fe}adoptPropDragSource(t,e){if("value"===t.name&&e instanceof Fe)return{type:Ei.PROP,prop:"value",value:e.data+"::"+e.path}}$_parse(t,e,s){const i=t.indexOf(s,e);if(i>=0){const e=t.indexOf("}",i+s.length);if(e>=0)return{from:i,to:e+1}}}$_parseValues(t){let e=this._tokens=void 0;if(t){let s=0;for(;;){const i=this.$_parse(t,s,"${")||this.$_parse(t,s,"%{");if(!i)break;e||(e=this._tokens=[]),e.push(i),s=i.to}}}}za.PROP_HTML="html",za.PROPINFOS=[{name:za.PROP_HTML,category:Ws.TEXT,type:is,multiple:!0,default:void 0}],za.STYLE_PROPS=["fontFamily","fontSize","fontStyle","textDecoration","fontWeight","lineHeight","color","backgroundColor","textAlign","writingMode","scale","paddingLeft","paddingTop","paddingRight","paddingBottom","border","borderLeft","borderRight","borderTop","borderBottom"],za.$_ctor="HtmlItem",za.ITEM_TYPE="Html";class $a extends A{constructor(){super(),this._itemCreators={text:t=>new ur(t),summary:t=>new va(t),image:t=>new jo(t),check:t=>new Yo(t),stack:t=>new rr(t),cbox:t=>new mr(t),rbox:t=>new fr(t),dbox:t=>new wr(t),list:t=>new Zo(t),table:t=>new ln(t),space:t=>new pr(t),simpleband:t=>new Aa(t),tableband:t=>new tn(t),bandgroup:t=>new Qa(t),bandcell:t=>new Ha(t),crosstab:t=>new No(t),datalist:t=>new Na(t),floating:t=>new Ni(t),shape:t=>new ya(t),barcode:t=>new la(t),qrcode:t=>new ha(t),datamatrix:t=>new Va(t),bar:t=>new Ba(t),rating:t=>new ba(t),html:t=>new za(t),svg:t=>new Ca(t),chart:t=>new Nn(t),hichart:t=>new Nn(t),highchart:t=>new Nn(t),page:t=>new Ua(t)},this._hichartSeriesCreators={column:t=>new Ea(t),bar:t=>new Pa(t),line:t=>new Sa(t),spline:t=>new Ia(t),area:t=>new Ra(t),areaspline:t=>new Ta(t),arearange:t=>new Oa(t),pie:t=>new Fa(t),bubble:t=>new La(t),scatter:t=>new ka(t),boxplot:t=>new Ga(t),histogram:t=>new Ka(t)}}_doDispose(){super._doDispose()}createItem(t){const e="string"==typeof t?t:t.type,s=t.name,i=this._itemCreators[e];let r=i&&i(s);return!r&&(t.hasOwnProperty("text")||t.hasOwnProperty("value")||t.hasOwnProperty("title"))&&(r=new ur(s)),r}createHichartSeries(t,e){let s="string"==typeof e?e:e.type;const i=this._hichartSeriesCreators[s]||this._hichartSeriesCreators.column;return i&&i(t)}}class Xa extends br{constructor(t,e){super("Add Item"),Z(!!t),Z(!!e),Z(t!==e),this._parent=t,this._item=e}_doDispose(){this._parent=this._item=null}get parent(){return this._parent}get item(){return this._item}undo(){this._parent.remove(this._item)}redo(t){if(!this._parent.add(this._item))throw new Cr("Item is not added.")}get source(){return this._item}}class ja extends br{constructor(t,e,s){super("Set Property"),Z(!!t),Z(!!e),this._item=t,this._prop=e,this._childProp=t instanceof Ri&&t.isChildProp(e),this._newValue=s,this._oldValue=this._childProp?t.getChildProp(e):t[e]}_doDispose(){this._item=null}get item(){return this._item}get prop(){return this._prop}get childProp(){return this._childProp}get oldValue(){return this._oldValue}get newValue(){return this._newValue}undo(){this._childProp?this._item.setChildProp(this._prop,this._oldValue):this._item[this._prop]=this._oldValue}redo(t){this._childProp?this._item.setChildProp(this._prop,this._newValue):this._item[this._prop]=this._newValue}get description(){return"prop."+this._prop+": "+this._oldValue+" -> "+this._newValue}get source(){return this._item}}class Ya extends br{constructor(t,e,s){super("Update Band Field"),Z(!!t),Z(!!s),this._data=t,this._index=e,this._field=s,this._oldField={...t.getField(e)}}_doDispose(){this._data=this._field=this._oldField=null}get data(){return this._data}get index(){return this._index}get field(){return this._field}get oldField(){return this._oldField}undo(){this._data.setField(this._index,this._oldField)}redo(t){this._data.setField(this._index,this._field)}get source(){return this._data}}class Ja extends br{constructor(t,e,s){super("Add Band Field"),Z(!!t),Z(!!s),this._data=t,this._index=e,this._field=s}_doDispose(){this._data=this._field=null}get data(){return this._data}get index(){return this._index}get field(){return this._field}redo(t){this._data.addField(this._index,this._field)}undo(){this._data.removeField(this._field)}get source(){return this._data}}class Za extends br{constructor(t,e,s){super("Remove Band Field"),Z(!!t),Z(!!s),this._data=t,this._index=e,this._field=s}_doDispose(){this._data=this._field=null}get data(){return this._data}get index(){return this._index}get field(){return this._field}redo(t){this._data.removeField(this._field)}undo(){this._data.addField(this._index,this._field)}get source(){return this._data}}class qa extends A{constructor(){super(),this._dataMap={}}_doDispose(){this._dataMap=null,this._contextData=null,super._doDispose()}preparePrint(t){this._contextData=new Le(t);for(let e in this._dataMap){const s=this._dataMap[e];s instanceof De&&s.preparePrint(t,!1)}}getAll(){const t=[];for(let e in this._dataMap)t.push(this._dataMap[e]);return t}get(t){return this._dataMap[t]}getContextValue(t){return this._contextData.getValue(t)}getValue(t,e){if(t){const s=t.indexOf("::"),i=s>=0?t.substring(0,s):t,r=this._dataMap[i];if(r){if(t=s>=0?t.substr(s+2):null,!(r instanceof Qe))return r.getValue(t);if(e>=0)return r.getRowValue(e,t)}}}getValueAt(t,e,s){const i=this._dataMap[t];if(i)return i instanceof Qe?i.getRowValue(s,e):i.getValue(e)}getFieldValues(t,e,s){const i=this._dataMap[t];if(i)return i instanceof Qe?i.getFieldValues(e,s):[i.getValue(e)]}clear(){return this._dataMap={},this._contextData=null,this}register(t,e){return t||(t=e.name),sA(t,this._dataMap,e)&&(this._dataMap[t]=e),this}load(t){iA(t,this);for(let e in t){const s=t[e],i=s.values;let r=s.type;switch(r||(r=rA(e,i)),r){case"band":this.register(e,new Ue(e,null,i));break;case"simple":this.register(e,new Ne(e,i));break;default:throw new Error("데이터의 형식이 잘못되었습니다.")}}return this}}function tA(t,e){if(!e.hasOwnProperty("sample")&&!e.hasOwnProperty("fields"))throw new Error("".concat(t," ").concat(x.DATA_FORMAT_IS_INCORRECT))}function eA(t,e){if(!e.hasOwnProperty("values"))throw new Error("".concat(t," 데이터의 values 데이터가 존재하지 않습니다."));!function(t,e){e.type===P.SIMPLE&&J.isArray(e.values)&&console.warn("[".concat(t,"] 데이터의 type은 ").concat(P.SIMPLE,"로 선언됐으나 ").concat(P.BAND," 데이터로 로드됩니다.")),e.type===P.BAND&&J.isObject(e.values)&&console.warn("[".concat(t,"] 데이터의 type은 ").concat(P.BAND,"로 선언됐으나 ").concat(P.SIMPLE," 데이터로 로드됩니다."))}(t,e)}function sA(t,e,s){if(!s||!s.name)return!1;if(e[t])throw new Error("Data is already exists: ".concat(t));return!0}function iA(t,e){if(!t)throw new Error(x.DATA_FORMAT_IS_INCORRECT);for(let s in t){if(!t[s]||!J.isObjectNotEmpty(t[s]))throw new Error("".concat(s," ").concat(x.DATA_FORMAT_IS_INCORRECT));e instanceof nA&&tA(s,t[s]),e instanceof qa&&eA(s,t[s])}}function rA(t,e){if(J.isArray(e))return"band";if(J.isObject(e))return"simple";throw new Error("".concat(t," ").concat(x.DATA_FORMAT_IS_INCORRECT))}class nA extends l{constructor(t){super(),this._dataMap={},this._commands=t}_doDispose(){this._dataMap=null,this._contextData=null,super._doDispose()}get designTime(){return!0}preparePrint(t){this._contextData=new Le(t),this._contextData.preparePrint(t,!0);for(let e in this._dataMap){const s=this._dataMap[e];s instanceof De&&s.preparePrint(t,!0)}}getAll(){const t=[];for(let e in this._dataMap)t.push(this._dataMap[e]);return t}getNames(){const t=[];for(let e in this._dataMap)t.push(e);return t}get(t){return this._dataMap[t]}getContextValue(t){return this._contextData.getValue(t)}getValue(t,e){if(t){const s=t.indexOf("::"),i=s>=0?t.substring(0,s):t,r=this._dataMap[i];if(r)return t=s>=0?t.substr(s+2):null,r instanceof Qe?r.getRowValue(e,t):r.getValue(t)}}getValueAt(t,e,s){const i=this._dataMap[t];if(i)return i instanceof Qe?i.getRowValue(s,e):i.getValue(e)}getFieldValues(t,e,s){const i=this._dataMap[t];if(i)return i instanceof Qe?i.getFieldValues(e,s):[i.getValue(e)]}addData(t){if(t)return this.$_register(null,t),this.$_fireDataAdded(t),!0}removeData(t){const e="string"==typeof t?t:t.name,s=this.get(e);if(s)return this.$_unregister(s),this.$_fireDataRemoved(s),s}dataNameChanged(t,e){this.fireEvent(nA.NAME_CHANGED,t,e)}fieldNameChanged(t,e,s){this.fireEvent(nA.FIELD_NAME_CHANGED,t,e,s)}load(t){iA(t,this);for(let e in t){const s=t[e],i=s.sample,r=s.fields;let n=s.type;switch(n||(n=rA(e,i)),n){case"band":this.$_register(e,new Ue(e,r,i,s.sampleCount,this));break;case"simple":this.$_register(e,new Ne(e,i));break;default:throw new Error("데이터의 형식이 잘못되었습니다.")}}return this}save(t){for(let e in this._dataMap){const s=this._dataMap[e],i=s.getSaveValues(),r=t[e]={type:s.getSaveType()};i&&(r.sample=i),s instanceof Qe&&(r.fields=s.getSaveFields())}}getFieldIndex(t,e){const s=this._dataMap[t];return s instanceof Qe?s.getFieldIndex(e):-1}updateField(t,e,s){var i;null===(i=this._commands)||void 0===i||i.execute(new Ya(t,e,s)),this.$_fireDataUpdated(t)}addField(t,e,s){var i;s&&t.indexOfField(s)<0&&(null===(i=this._commands)||void 0===i||i.execute(new Ja(t,e,s)),this.$_fireDataUpdated(t))}removeField(t,e){var s;const i=t.indexOfField(e);i>=0&&(null===(s=this._commands)||void 0===s||s.execute(new Za(t,i,e)),this.$_fireDataUpdated(t))}renameData(t,e){delete this._dataMap[t.name],t.name=e,this._dataMap[e]=t}$_register(t,e){if(t||(t=e.name),sA(t,this._dataMap,e))return e._dp=this,this._dataMap[t]=e,e}$_unregister(t){t&&t._dp===this&&(delete this._dataMap[t.name],t._dp=null)}$_fireDataAdded(t){this.fireEvent(nA.DATA_ADDED,t)}$_fireDataRemoved(t){this.fireEvent(nA.DATA_REMOVED,t)}$_fireDataUpdated(t){this.fireEvent(nA.DATA_UPDATED,t)}}nA.DATA_ADDED="onDesignDataManagerDataAdded",nA.DATA_REMOVED="onDesignDataManagerDataRemoved",nA.DATA_UPDATED="onDesignDataManagerDataUpdated",nA.NAME_CHANGED="onDesignDataManagerNameChanged",nA.FIELD_NAME_CHANGED="onDesignDataManagerFieldNameChanged";class oA extends br{constructor(t,e,s){super("Add Asset"),Z(!!t),Z(!!s),this._manager=t,this._group=e||t.root,this._item=s}_doDispose(){this._group=this._item=null}get manager(){return this._manager}get group(){return this._group}get item(){return this._item}undo(){this._manager.remove(this._item)}redo(t){this._manager.add(this._group,this._item)}get source(){return this._item}}class aA extends br{constructor(t,e){super("Remove Asset"),Z(!!t),Z(!!e),this._manager=t,this._group=e.parent,this._item=e}_doDispose(){this._group=this._item=null}get manager(){return this._manager}get group(){return this._group}get item(){return this._item}undo(){this._manager.add(this._group,this._item)}redo(t){this._manager.remove(this._item)}get source(){return this._group}}class AA extends br{constructor(t,e,s){super("Set Property"),Z(!!t),Z(!!e),Z(!!s),this._dm=t,this._data=e,this._oldName=e.name,this._newName=s}_doDispose(){this._dm=null,this._data=null}get data(){return this._data}get oldName(){return this._oldName}get newName(){return this._newName}undo(){this._dm.renameData(this._data,this._oldName)}redo(t){this._dm.renameData(this._data,this._newName)}get description(){return"rename data: "+this._oldName+" -> "+this._newName}get source(){return this._data}}class lA extends br{constructor(t,e){super("Add Data"),Z(!!t),Z(!!e),this._dm=t,this._data=e}_doDispose(){this._dm=null,this._data=null}get data(){return this._data}undo(){this._dm.removeData(this._data)}redo(t){this._dm.addData(this._data)}get description(){return"Add data: "+this._data.name}get source(){return this._data}}class hA extends br{constructor(t,e){super("Remove Data"),Z(!!t),Z(!!e),this._dm=t,this._data=e}_doDispose(){this._dm=null,this._data=null}get data(){return this._data}undo(){this._dm.addData(this._data)}redo(t){this._dm.removeData(this._data)}get description(){return"Remove data: "+this._data.name}get source(){return this._data}}class dA extends br{constructor(t,e){super("Save Simple Data"),Z(!!t),Z(!!e),this._data=t,this._values=e}_doDispose(){this._data=null,this._values=null}get data(){return this._data}undo(){this._data.setSample(this._oldValues)}redo(t){this._data.setSample(this._values)}get description(){return"Save simple data: "+this._data.name}get source(){return this._data}}class cA extends br{constructor(t,e,s){super("Set Style"),Z(!!t),Z(!!e),this._item=t,this._style=e,this._newValue=s,this._oldValue=this._item.getStyle(e)}_doDispose(){this._item=null}get item(){return this._item}get style(){return this._style}get oldValue(){return this._oldValue}get newValue(){return this._newValue}undo(){this._item.setStyle(this._style,this._oldValue)}redo(t){this._item.setStyle(this._style,this._newValue)}get description(){return"style."+this._style+": "+this._oldValue+" -> "+this._newValue}get source(){return this._item}}class uA extends br{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super("Move Item"),Z(!!t),this._item=t,this._oldLeft=t.left,this._oldRight=t.right,this._oldTop=t.top,this._oldBottom=t.bottom,this._newLeft=e,this._newTop=s,this._persistant=i}static createCommands(t,e){if(t&&t.length>0){const s=[];return t.forEach(((t,i)=>{s.push(new uA(t,e[i].x,e[i].y))})),s.length>0?s:null}}_doDispose(){this._item=null}redo(t){this._item.setChildProp("left",this._newLeft),!this._persistant&&this._item.setChildProp("right",void 0),this._item.setChildProp("top",this._newTop),!this._persistant&&this._item.setChildProp("bottom",void 0)}undo(){this._item.setChildProp("left",this._oldLeft),!this._persistant&&this._item.setChildProp("right",this._oldRight),this._item.setChildProp("top",this._oldTop),!this._persistant&&this._item.setChildProp("bottom",this._oldBottom)}get description(){return"Move item: "+this._item.designText}get source(){return this._item}}class pA extends vr{constructor(t,e){super("Move Items",uA.createCommands(t,e))}}class _A extends br{constructor(t,e,s){super("Move Item One Way"),Z(!!t),this._item=t,this._dir=e,this._old=t[e],this._new=s}static createCommands(t,e,s){if(t&&t.length>0){const i=[];return t.forEach(((t,r)=>{i.push(new _A(t,e,s[r]))})),i.length>0?i:null}}_doDispose(){this._item=null}redo(t){this._item.setChildProp(this._dir,this._new)}undo(){this._item.setChildProp(this._dir,this._old)}get description(){return"Move item One Way: "+this._item.designText}get source(){return this._item}}class gA extends vr{constructor(t,e,s){super("Move Items One Way",_A.createCommands(t,e,s))}}class fA extends br{constructor(t,e,s){super("Move Collection Item"),Z(!!t),this._collection=t,this._from=e,this._to=s}_doDispose(){this._collection=null}redo(t){this._collection.moveItem(this._from,this._to)}undo(){this._collection.moveItem(this._to,this._from)}get description(){return"Move collection item: "+this._from+" -> "+this._to}get source(){return this._collection.get(this._to)}}class mA extends br{constructor(t,e,s,i,r,n,o){super("Resize Item"),Z(!!t),this._item=t,this._saveWidth=e,this._saveHeight=s,this._oldWidth=i,this._oldHeight=r,this._dx=n,this._dy=o}_doDispose(){this._item=null}redo(t){this._dx&&(this._item.width=this._oldWidth+this._dx),this._dy&&(this._item.height=this._oldHeight+this._dy)}undo(){this._dx&&(this._item.width=this._saveWidth),this._dy&&(this._item.height=this._saveHeight)}get description(){return"Resize item: "+this._item.designText}get source(){return this._item}}class wA extends vr{static createCommand(t,e,s,i,r,n,o,a,A){return[new mA(t,e,s,i,r,n,o),new uA(t,a,A,!0)]}constructor(t,e,s,i,r,n,o,a,A){super("Resize and Move Item",wA.createCommand(t,e,s,i,r,n,o,a,A))}}class yA extends br{constructor(t,e){super("Set Properties"),Z(!!t),Z(!!e),this._item=t,this._props={...e},this._oldProps=t.getProperties(e)}_doDispose(){this._item=null,this._props=null}get item(){return this._item}get props(){return this._props}redo(t){this._item.setProperties(this._props)}undo(){this._item.setProperties(this._oldProps)}get source(){return this._item}}class CA extends br{constructor(t,e,s,i){super("Set Child Style"),Z(!!t),Z(!!e),Z(!!s),this._item=t,this._prop=e,this._style=s,this._newValue=i,this._oldValue=this._item._getSubStyle(e,s)}_doDispose(){this._item=null}get item(){return this._item}get prop(){return this._prop}get style(){return this._style}get oldValue(){return this._oldValue}get newValue(){return this._newValue}undo(){this._item._setSubStyle(this._prop,this._style,this._oldValue)}redo(t){this._item._setSubStyle(this._prop,this._style,this._newValue)}get description(){return this._prop+".style."+this._style+": "+this._oldValue+" -> "+this._newValue}get source(){return this._item}}class bA extends br{constructor(t,e,s){super("Add Table Band Group"),Z(!!t),this._band=t,this._index=Math.max(0,t.groups.count),this._config=s}_doDispose(){this._band=null}get band(){return this._band}get index(){return this._index}redo(t){this._group=this._band.groups.add(this._config,this._index)}undo(){this._band.groups.remove(this._group)}get source(){return this._band}}class vA extends br{constructor(t,e){super("Change child index"),Z(!!t),this._item=t,this._newIndex=e,this._oldIndex=t.index}_doDispose(){this._item=null}redo(t){this._item.parent.changeChildIndex(this._item,this._newIndex)}undo(){this._item.parent.changeChildIndex(this._item,this._oldIndex)}get description(){return"Change child index: "+this._item.designText}get source(){return this._item}}class BA extends br{constructor(t,e,s){super("Set Items Property"),Z(!!t&&t.length>0),Z(!!e),this._items=t.slice(),this._prop=e,this._childProps=[],this._oldValues=[],this._newValue=s,this._items.forEach((t=>{const s=t instanceof Ri&&t.isChildProp(e);this._childProps.push(s),this._oldValues.push(s?t.getChildProp(e):t[e])}))}_doDispose(){this._items=null}get items(){return this._items.slice()}get prop(){return this._prop}get newValue(){return this._newValue}undo(){this._items.forEach(((t,e)=>{this._childProps[e]?t.setChildProp(this._prop,this._oldValues[e]):J.hasSetter(t,this._prop)&&(t[this._prop]=this._oldValues[e])}))}redo(t){this._items.forEach(((t,e)=>{this._childProps[e]?t.setChildProp(this._prop,this._newValue):J.hasSetter(t,this._prop)&&(t[this._prop]=this._newValue)}))}get description(){return"prop."+this._prop+", "+this._newValue}get source(){return this._items.slice()}}class EA extends br{constructor(t,e,s){super("Set Items Style"),Z(!!t&&t.length>0),Z(!!e),this._items=t.slice(),this._style=e,this._newValue=s,this._oldValues=[],this._items.forEach((t=>{this._oldValues.push(t.getStyle(e))}))}_doDispose(){this._items=null}get items(){return this._items.slice()}get style(){return this._style}get newValue(){return this._newValue}undo(){this._items.forEach(((t,e)=>{t.setStyle(this._style,this._oldValues[e])}))}redo(t){this._items.forEach(((t,e)=>{t.setStyle(this._style,this._newValue)}))}get description(){return"style."+this._style+": "+this._newValue}get source(){return this._items.slice()}}class PA extends br{constructor(t,e,s,i){super("Set Child Style"),Z(!!t&&t.length>0),Z(!!e),Z(!!s),this._items=t.slice(),this._prop=e,this._style=s,this._newValue=i,this._oldValues=[],this._items.forEach((t=>{this._oldValues.push(t._getSubStyle(e,s))}))}_doDispose(){this._items=null}get items(){return this._items.slice()}get prop(){return this._prop}get style(){return this._style}get newValue(){return this._newValue}undo(){this._items.forEach(((t,e)=>{t._setSubStyle(this._prop,this._style,this._oldValues[e])}))}redo(t){this._items.forEach((t=>{t._setSubStyle(this._prop,this._style,this._newValue)}))}get description(){return this._prop+".style."+this._style+": "+this._newValue}get source(){return this._items.slice()}}class xA extends br{constructor(t,e){super("Set Items Properties"),Z(!!t&&t.length),Z(!!e),this._items=t.slice(),this._props={...e},this._oldProps=[],this._items.forEach((t=>{this._oldProps.push(t.getProperties(e))}))}_doDispose(){this._items=null,this._props=null}get items(){return this._items.slice()}get props(){return this._props}redo(t){this._items.forEach(((t,e)=>{t.setProperties(this._props)}))}undo(){this._items.forEach(((t,e)=>{t.setProperties(this._oldProps[e])}))}get source(){return this._items.slice()}}class SA extends br{constructor(t,e,s){super("Add Simple Band Group"),Z(!!t),this._band=t,this._index=Math.max(0,t.groups.count),this._config=s}_doDispose(){this._band=null}get band(){return this._band}get index(){return this._index}redo(t){this._group=this._band.groups.add(this._config,this._index)}undo(){this._band.groups.remove(this._group)}get source(){return this._band}}class IA extends br{constructor(t,e,s,i){super("Resize Space Item"),Z(!!t),this._item=t,this._orgSize=e,this._oldSize=s,this._delta=i}_doDispose(){this._item=null}redo(t){this._item.size=this._oldSize+this._delta}undo(){this._item.size=this._orgSize}get description(){return"Resize space item"}get source(){return this._item}}class RA extends br{constructor(t,e){if(super("Change table cols"),Z(!!t),this._group=t,this._oldCount=t.bandCount,this._count=e,e<this._oldCount){this._deleted=[];for(let s=e;s<this._oldCount;s++){const e=t.get(s);this._deleted.push(e)}}}_doDispose(){this._group=null}get table(){return this._group}get cols(){return this._count}redo(t){this._group.bandCount=this._count}undo(){const t=this._group;this._oldCount>this._count?this._deleted.forEach(((e,s)=>{t.add(e)})):t.bandCount=this._oldCount}get source(){return this._group}}var TA;!function(t){t.A0="A0",t.A1="A1",t.A2="A2",t.A3="A3",t.A4="A4",t.A5="A5",t.A6="A6",t.A7="A7",t.A8="A8"}(TA||(TA={}));const OA={A0:{w:841,h:1189},A1:{w:594,h:841},A2:{w:420,h:594},A3:{w:297,h:420},A4:{w:210,h:297},A5:{w:148,h:210},A6:{w:105,h:148},A7:{w:74,h:105},A8:{w:52,h:74}};var FA;!function(t){t.PORTRAIT="portrait",t.LANDSCAPE="landscape"}(FA||(FA={}));class DA extends A{constructor(t){super(),this._orientation=FA.PORTRAIT,this._size=TA.A4,this._width="210mm",this._height="297mm",this._marginLeft="12mm",this._marginRight="12mm",this._marginTop="15mm",this._marginBottom="15mm",this._widthDim=new C(this._width),this._heightDim=new C(this._height),this._marginLeftDim=new C(this._marginLeft),this._marginRightDim=new C(this._marginRight),this._marginTopDim=new C(this._marginTop),this._marginBottomDim=new C(this._marginBottom),this._report=t}_doDispose(){super._doDispose()}get orientation(){return this._orientation}set orientation(t){t!==this._orientation&&(this._orientation=t,this._changed())}get size(){return this._size}set size(t){if(t!=this._size){this._size=t;const e=OA[this._size];e&&(this.width=e.w+"mm",this.height=e.h+"mm")}}get width(){return this._width}set width(t){t!=this._width&&(this._width=t,this._widthDim=new C(t),this._changed())}get height(){return this._height}set height(t){t!=this._height&&(this._height=t,this._heightDim=new C(t),this._changed())}get marginLeft(){return this._marginLeft}set marginLeft(t){t!=this._marginLeft&&(this._marginLeft=t,this._marginLeftDim=new C(t),this._changed())}get marginRight(){return this._marginRight}set marginRight(t){t!=this._marginRight&&(this._marginRight=t,this._marginRightDim=new C(t),this._changed())}get marginTop(){return this._marginTop}set marginTop(t){t!=this._marginTop&&(this._marginTop=t,this._marginTopDim=new C(t),this._changed())}get marginBottom(){return this._marginBottom}set marginBottom(t){t!=this._marginBottom&&(this._marginBottom=t,this._marginBottomDim=new C(t),this._changed())}load(t){}getPageSize(){let t=this._widthDim.getFixedPixel(),e=this._heightDim.getFixedPixel();if(isNaN(t)||isNaN(e)){const s=OA[this._size]||OA.A4;t=f(p.MILLI,s.w),e=f(p.MILLI,s.h)}return this._orientation===FA.LANDSCAPE?new Me(e,Math.floor(t)):new Me(t,Math.floor(e))}getContentRect(t){return t.topBy(this._marginTopDim.getFixedPixel()),t.bottomBy(-this._marginBottomDim.getFixedPixel()),t.leftBy(this._marginLeftDim.getFixedPixel()),t.rightBy(-this._marginRightDim.getFixedPixel()),t}getClientRect(){const t=this.getPageSize();return new d(0,0,t.width-this._marginLeftDim.getFixedPixel()-this._marginRightDim.getFixedPixel(),t.height-this._marginTopDim.getFixedPixel()-this._marginBottomDim.getFixedPixel()).round()}applyExtents(t){const e=this.getPageSize(),s=this._marginLeftDim.getFixedPixel(),i=this._marginRightDim.getFixedPixel(),r=this._marginTopDim.getFixedPixel(),n=this._marginBottomDim.getFixedPixel();t.width=e.width-s-i+"px",t.height=e.height-r-n+"px"}applyPreviewExtents(t){const e=this.getPageSize();t.width=e.width+"px",t.height=e.height+"px"}applyClient(t){const e=this.getPageSize(),s=this._marginLeftDim.getFixedPixel(),i=this._marginRightDim.getFixedPixel(),r=this._marginTopDim.getFixedPixel(),n=this._marginBottomDim.getFixedPixel();t.width=e.width-s-i+"px",t.height=e.height-r-n+"px",t.left="0",t.top="0"}applyPreviewClient(t){const e=this.getPageSize(),s=this._marginLeftDim.getFixedPixel(),i=this._marginRightDim.getFixedPixel(),r=this._marginTopDim.getFixedPixel(),n=this._marginBottomDim.getFixedPixel();t.width=e.width-s-i+"px",t.height=e.height-r-n+"px",t.left=s+"px",t.top=r+"px",J.extend(t,this._report.page.styles)}_changed(){this._report&&this._report._firePaperChanged()}}class LA extends A{constructor(t){super(),this.paper=new DA(t)}}class NA extends Ti{constructor(t){super("reportRoot"),this._report=t}get report(){return this._report}get name(){return this._report.info.name}set name(t){const e=this.name;t!=e&&(this._report.info.name=t,this._changed(NA.PROP_NAME,t,e))}get author(){return this._report.info.author}set author(t){this._report.info.author=t}get version(){return this._report.info.version}set version(t){this._report.info.version=t}get description(){return this._report.info.description}set description(t){this._report.info.description=t}get paperOrientation(){return this._report.info.paper.orientation}set paperOrientation(t){this._report.info.paper.orientation=t}get paperSize(){return this._report.info.paper.size}set paperSize(t){this._report.info.paper.size=t}get paperWidth(){return this._report.info.paper.width}set paperWidth(t){this._report.info.paper.width=t}get paperHeight(){return this._report.info.paper.height}set paperHeight(t){this._report.info.paper.height=t}get marginLeft(){return this._report.info.paper.marginLeft}set marginLeft(t){this._report.info.paper.marginLeft=t}get marginRight(){return this._report.info.paper.marginRight}set marginRight(t){this._report.info.paper.marginRight=t}get marginTop(){return this._report.info.paper.marginTop}set marginTop(t){this._report.info.paper.marginTop=t}get marginBottom(){return this._report.info.paper.marginBottom}set marginBottom(t){this._report.info.paper.marginBottom=t}get pathLabel(){return"report"}get displayPath(){return"report"}_ignoreItems(){return!0}getEditProps(){return NA.PROPINFOS}getStyleProps(){return[]}canResize(t){return!1}_doLoad(t,e){super._doLoad(t,e),this._loadPropsOf(e,NA.PROPINFOS)}_doSave(t){super._doSave(t),this._savePropsOf(t,NA.PROPINFOS)}}NA.PROP_REPORT_NAME="name",NA.PROP_REPORT_AUTHOR="author",NA.PROP_REPORT_VERSION="version",NA.PROP_REPORT_DESCRIPTION="description",NA.PROP_PAPER_ORIENTATION="paperOrientation",NA.PROP_PAPER_SIZE="paperSize",NA.PROP_PAPER_WIDTH="paperWidth",NA.PROP_PAPER_HEIGHT="paperHeight",NA.PROP_MARGIN_LEFT="marginLeft",NA.PROP_MARGIN_RIGHT="marginRight",NA.PROP_MARGIN_TOP="marginTop",NA.PROP_MARGIN_BOTTOM="marginBottom",NA.PROPINFOS=[{name:NA.PROP_REPORT_NAME,category:Ws.REPORT,type:is,multiple:!1,default:void 0},{name:NA.PROP_REPORT_AUTHOR,category:Ws.REPORT,type:is,multiple:!1,default:void 0},{name:NA.PROP_REPORT_VERSION,category:Ws.REPORT,type:is,multiple:!1,default:void 0},{name:NA.PROP_REPORT_DESCRIPTION,category:Ws.REPORT,type:is,multiple:!1,default:void 0},{name:NA.PROP_PAPER_ORIENTATION,category:Ws.PAPER,type:As,multiple:!1,default:FA.PORTRAIT,domain:FA},{name:NA.PROP_PAPER_SIZE,category:Ws.PAPER,type:As,multiple:!1,default:void 0,domain:TA},{name:NA.PROP_PAPER_WIDTH,category:Ws.PAPER,type:ns,multiple:!1,default:void 0},{name:NA.PROP_PAPER_HEIGHT,category:Ws.PAPER,type:ns,multiple:!1,default:void 0},{name:NA.PROP_MARGIN_LEFT,category:Ws.PAPER,type:ns,multiple:!1,default:void 0},{name:NA.PROP_MARGIN_RIGHT,category:Ws.PAPER,type:ns,multiple:!1,default:void 0},{name:NA.PROP_MARGIN_TOP,category:Ws.PAPER,type:ns,multiple:!1,default:void 0},{name:NA.PROP_MARGIN_BOTTOM,category:Ws.PAPER,type:ns,multiple:!1,default:void 0}],NA.$_ctor="ReportRootItem";class HA extends l{constructor(t,e){super(),this._unit=p.MILLI,this._assetRoot="",this._loader=new $a,this._loading=!1,this._invalids=[],this._designTime=t,this._commands=new Br(this),this._info=new LA(this),this._page=new ko(this),this._page.addListener(this),this._root=new NA(this),this._root.add(this._page),this._assets=new ir,this._designData=new nA(this._commands),t&&(this._data=this._designData,this._designData.addListener(this)),e&&this.load(e)}static isReportSource(t){return t&&J.isObject(t.page)}_doDispose(){this._designData.removeListener(this),this._designData=this._designData.dispose(),super._doDispose()}onDesignDataManagerDataAdded(t,e){this.fireEvent(HA.DATA_ADDED,e),this.$_refreshInvalids()}onDesignDataManagerDataRemoved(t,e){this.fireEvent(HA.DATA_REMOVED,e),this.$_refreshInvalids()}onDesignDataManagerDataUpdated(t,e){this.fireEvent(HA.DATA_UPDATED,e),this.$_refreshInvalids()}onDesignDataManagerNameChanged(t,e,s){this._page.$_dataNameChanged(e,s),this.fireEvent(HA.DATA_NAME_CHANGED,e,s),this.$_refreshInvalids()}onDesignDataManagerFieldNameChanged(t,e,s,i){this._page.$_dataFieldNameChanged(e,s,i),this.fireEvent(HA.DATA_FIELD_NAME_CHANGED,e,s,i),this.$_refreshInvalids()}editCommandStackChanged(t,e,s,i){this.fireEvent(HA.COMMANDS_STACK_CHANGED,e,s,i),this.$_refreshInvalids()}editCommandStackDirtyChanged(t){this.fireEvent(HA.DIRTY_CHANGED)}addCollectionItem(t){t instanceof kn?this.addHichartPlotLine(t.axis):t instanceof Gn&&this.addHichartPlotBand(t.axis)}get loader(){return this._loader}get info(){return this._info}get paper(){return this._info.paper}get unit(){return this._unit}set unit(t){t!=this._unit&&(this._unit=t)}get assetRoot(){return this._assetRoot}set assetRoot(t){this._assetRoot=t,this._assetRoot.endsWith("/")||(this._assetRoot+="/")}get root(){return this._root}get page(){return this._page}set page(t){this._page=t}get assets(){return this._assets}get data(){return this._data}get designData(){return this._designData}get canUndo(){return this._commands.canUndo}get canRedo(){return this._commands.canRedo}get dirty(){return this._commands.dirty}load(t){if(t){this._loading=!0;try{return this._root.load(this._loader,t),t.report&&this._root.load(this._loader,t.report),t.page&&this._page.load(this._loader,t.page),t.assets&&this._assets.load(t.assets),t.data&&this._designData.load(t.data),this._fireReset(),this}finally{this._loading=!1}}}setSaveTagging(t){return this._page.saveTag=t,this}save(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e={report:{},page:{}};return this._root.save(e.report),this._page.save(e.page),t||(this._assets.save(e.assets={}),this._data instanceof nA&&this._data.save(e.data={})),this._page.saveTag=null,e}prepareLayout(){this._page.prepareLayout(!1)}preparePrint(t){this._page.preparePrint(t),this.models={}}getImageUrl(t){if(t)return this._assetRoot.indexOf(":")>=0?this._assetRoot+t:t}clearHistory(){this._commands.flush()}closeHistory(){this._commands.close()}undo(){return this._commands.undo()}redo(){return this._commands.redo()}execute(t){return t&&this._commands.execute(t)}getEditHistory(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._commands.getHistory(t)}getCommand(t){return this._commands.get(t)}itemByName(t){return this._page.getItem(t)}defaultInit(t,e,s,i){t.defaultInit(this._loader,e,s,i)}addItem(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t&&e){if(!this._fireItemAdd(t,e,s))return!1;if(t.contains(e))throw new Error("Item is already contained in this group item.");if(e.outlineParent)throw new Error("Item is already contained in other group item.");if(e instanceof Qr&&!t.canContainsBand())throw new Error("데이터밴드를 추가할 수 없는 영역입니다.");if(e instanceof Qa&&!t.canContainsBandGroup())throw new Error("밴드그룹을 추가할 수 없는 영역입니다.");if(!(s>=0&&s<t.count))return this.execute(new Xa(t,e)),e.parent instanceof Qi?e.parent.parent===t:e.parent===t}}moveCollectionItem(t,e,s){if(t&&e!==s){const i=new fA(t,e,s);this.execute(i)}}addChartSeries(t,e){if(t&&e){const s=new so(t,e);return this.execute(s),s.series}}addHichartPlotLine(t,e){if(t){const s=new ro(t,e);return this.execute(s),s.line}}addHichartPlotBand(t,e){if(t){const s=new oo(t,e);return this.execute(s),s.band}}addTableRow(t,e){e<0&&(e=t.rowCount),this.execute(new gn(t,e))}moveTableRows(t,e,s,i){}moveTableRowsToNearest(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];try{const n=t.getNearestMovableRow(e,s,i);n>=0&&t.canMoveRows(e,s,n,r)&&this.execute(new fn(t,e,s,n,!0))}catch(e){if(!(e instanceof w))throw e;this._fireAlert(t,e.message)}}addTableColumn(t,e){t instanceof tn?this.execute(new sn(t,e)):t instanceof ln&&this.execute(new cn(t,e))}moveTableColumns(t,e,s,i){}moveTableColumnsToNearest(t,e,s,i){try{if(t instanceof tn){const r=t.getNearestMovableColumn(e,s,i);r>=0&&r!==e&&t.canMoveColumns(e,s,r,!0)&&this.execute(new nn(t,e,s,r,!0))}else if(t instanceof ln){const r=t.getNearestMovableColumn(e,s,i);r>=0&&r!==e&&t.canMoveColumns(e,s,r,!0)&&this.execute(new un(t,e,s,r,!0))}}catch(e){if(!(e instanceof w))throw e;this._fireAlert(t,e.message)}}addCrosstabField(t,e){t.band.containsField(e)?alert("이미 포함된 필드입니다: "+e):this.execute(new Ho(t,t.count,{field:e}))}removeItem(t){t&&this.removeItems([t])}removeItems(t){t&&t.length>0&&this._page.removeItems(this._commands,t)}setItemProperty(t,e,s){if(t){if(t.isChildProp(e)&&!t.parent.canChangeChildProp(t,e,s))return;t instanceof Qa&&"bandCount"===e?this.execute(new RA(t,s)):t instanceof tn&&"colCount"===e?this.execute(new en(t,s)):t instanceof ln&&"colCount"===e?this.execute(new hn(t,s)):t instanceof Or&&"rowCount"===e?this.execute(new pn(t,s)):(t instanceof Qa&&"bandCount"===e||e)&&this.execute(new ja(t,e,s))}}setItemProperties(t,e){t instanceof Ri&&e&&this.execute(new yA(t,e))}setItemsProperties(t,e){t&&t.length&&e&&this.execute(new xA(t,e))}resetItemProperty(t,e){if(t instanceof Ri&&e){let s=!1;if(t.isChildProp(e.name)?t.getChildProp(e.name)!==e.default&&(s=!0):t[e.name]!==e.default&&(s=!0),s)return this.execute(new ja(t,e.name,e.default)),!0}}setItemsProperty(t,e,s){t&&t.length&&e&&this.execute(new BA(t,e,s))}setItemStyle(t,e,s){t&&e&&this.execute(new cA(t,e,s))}setItemsStyle(t,e,s){t&&t.length&&e&&this.execute(new EA(t,e,s))}setChildStyleProperty(t,e,s,i){t&&e&&this.execute(new CA(t,e,s,i))}setItemsChildStyleProperty(t,e,s,i){t&&t.length&&e&&this.execute(new PA(t,e,s,i))}addTableBandColumn(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;t&&this.execute(new sn(t,s,e))}addTableBandGroup(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;t&&this.execute(new bA(t,s,e))}addSimpleBandGroup(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;t&&this.execute(new SA(t,s,e))}canMergeSelection(t){return t instanceof Rr&&!t.isSingle(!0)}mergeSelection(t){if(this.canMergeSelection(t)){const e=new mn(t);this.execute(e),this._fireCellMerged(t.table.getCell(e.bounds.r1,e.bounds.c1))}}canUnmergeCell(t){return!t.isSingle}unmergeCell(t){this.canUnmergeCell(t)&&this.execute(new wn(t))}search(t,e){const s=[];return this._page.search(t,e,s),s.length>0?s:null}applyDropResult(t,e){if(t&&e)return e.type===Ei.PROP?this.execute(new ja(t,e.prop,e.value)):void 0}addAsset(t,e){if(e){const s="string"==typeof t?this._assets.findGroup(t):t;this.execute(new oA(this._assets,s,e))}}removeAsset(t){t&&this.execute(new aA(this._assets,t))}renameData(t,e){if(this._data instanceof nA&&t&&e&&t.name!=e)return this.execute(new AA(this._data,t,e)),!0}addData(t){if(this._data instanceof nA)return this.execute(new lA(this._data,t)),!0}removeData(t){if(this._data instanceof nA)return"string"==typeof t&&(t=this._data.get(t)),t&&this.execute(new hA(this._data,t)),!0}saveSimpleData(t,e){t&&e&&this.execute(new dA(t,e))}saveItems(t){if(t&&t.length>0){if(t.length>1)for(let e=(t=t.sort(((t,e)=>t.level-e.level))).length-1;e>=0;e--){const s=t[e].parent;for(let i=e+1;i>=0;i--)if(t[i]===s){t.splice(i,1);break}}const e=[];for(let s of t){const t={};s.save(t)&&e.push(t)}return JSON.stringify(e)}}pasteItems(t,e){let s;e instanceof Ir&&(s=e,e=e.table);let i=(e instanceof Ti?e:null==e?void 0:e.parent)||this.page.body._bodyItems;if(i){const e=JSON.parse(t),r=[];for(let t of e){const e=this._loader.createItem(t);if(e){if(i instanceof Or){i.noPrepareCell=!0;try{i._loadChild(this._loader,e,t),e.setChildProp("row",s.row),e.setChildProp("col",s.col)}finally{i.noPrepareCell=!1}}else i._loadChild(this._loader,e,t);this.addItem(i,e)&&r.push(e)}}return r}}moveItem(t,e,s){t&&this.execute(new uA(t,e,s))}moveItemDir(t,e,s){t&&this.execute(new _A(t,e,s))}resizeItem(t,e,s,i,r,n,o){t&&this.execute(new mA(t,e,s,i,r,n,o))}resizeSpace(t,e,s,i){t&&this.execute(new IA(t,e,s,i))}resizeAndMove(t,e,s,i,r,n,o,a,A){t&&this.execute(new wA(t,e,s,i,r,n,o,a,A))}alignItem(t,e){if(t instanceof on||t instanceof Ir)this.setItemStyle(t,"cellAlign",e);else if(t instanceof Ri)if(t.parent instanceof Qi){const s=t.parent.parent.getCell(t.row,t.col);this.execute(new cA(s,"cellAlign",e))}else if(t.parent.canAlign(t))switch(e){case"left":this.setItemProperties(t,{left:0,right:void 0});break;case"right":this.setItemProperties(t,{left:void 0,right:0});break;case"top":this.setItemProperties(t,{top:0,bottom:void 0});break;case"bottom":this.setItemProperties(t,{top:void 0,bottom:0});break;case"center":this.setItemProperties(t,{left:void 0,right:void 0,top:void 0,bottom:void 0})}}alignItems(t,e){const s=[];t.forEach((t=>{if(t instanceof Ir||t instanceof on)s.push(new cA(t,"cellAlign",e));else if(t instanceof Ri)if(t.parent instanceof Qi){const i=t.parent.parent.getCell(t.row,t.col);s.push(new cA(i,"cellAlign",e))}else if(t.parent.canAlign(t))switch(e){case"left":s.push(new yA(t,{left:0,right:void 0}));break;case"right":s.push(new yA(t,{left:void 0,right:0}));break;case"top":s.push(new yA(t,{top:0,bottom:void 0}));break;case"bottom":s.push(new yA(t,{top:void 0,bottom:0}));break;case"center":s.push(new yA(t,{left:void 0,right:void 0,top:void 0,bottom:void 0}))}})),s.length>0&&this.execute(new vr("alignItems",s))}changeItemIndex(t,e){if(e=Math.max(0,Math.min(t.parent.count-1,e)),t&&t.index!==e)return this.execute(new vA(t,e)),!0}clearTexts(t){const e=[];t.forEach((t=>{(t instanceof ur&&t.text||t instanceof Yo&&t.text)&&e.push(new ja(t,"text",void 0))})),e.length&&this.execute(new vr("",e))}adjustColumnWidths(t,e,s,i){this.execute(new yn(t,e,s,i))}adjustRowHeights(t,e,s,i){this.execute(new Cn(t,e,s,i))}getInvalids(){return this._invalids}$_refreshInvalids(){this._page.collectInvalids(this,this._invalids=[])}onPageItemAdded(t,e,s,i){this._loading||this.fireEvent(HA.ITEM_ADDED,e,s,i)}onPageItemsAdded(t,e,s){this._loading||this.fireEvent(HA.ITEMS_ADDED,e,s)}onPageItemRemoved(t,e,s){this.fireEvent(HA.ITEM_REMOVED,e,s)}onPageItemsRemoved(t,e){this.fireEvent(HA.ITEMS_REMOVED,e)}onPageItemChanged(t,e,s,i,r){this.fireEvent(HA.ITEM_CHANGED,e,s,i,r)}onPageCollectionChanged(t,e){this.fireEvent(HA.COLLECTION_CHANGED,e)}_fireReset(){this.fireEvent(HA.RESET)}_firePaperChanged(){this.fireEvent(HA.PAPER_CHANGED)}_fireItemAdd(t,e,s){return this.fireConfirmEvent(HA.ITEM_ADD,t,e,s)}_fireItemMoved(t,e){this.fireEvent(HA.ITEM_MOVED,t)}_fireCollectionChanged(t){this.fireEvent(HA.COLLECTION_CHANGED,t)}_fireCellMerged(t){this.fireEvent(HA.CELL_MERGED,t)}_fireAlert(t,e){this.fireEvent(HA.ALERT,t,e)}}HA.RESET="onReportReset",HA.PAPER_CHANGED="onReportPaperChanged",HA.ITEM_ADD="onReportItemAdd",HA.ITEM_ADDED="onReportItemAdded",HA.ITEMS_ADDED="onReportItemsAdded",HA.ITEM_REMOVED="onReportItemRemoved",HA.ITEMS_REMOVED="onReportItemsRemoved",HA.ITEM_CHANGED="onReportItemChanged",HA.ITEM_MOVED="onReportItemMoved",HA.COLLECTION_CHANGED="onReportCollectionChanged",HA.COMMANDS_STACK_CHANGED="onReportCommandStackChanged",HA.DIRTY_CHANGED="onReportDirtyChanged",HA.DATA_ADDED="onReportDataAdded",HA.DATA_REMOVED="onReportDataRemoved",HA.DATA_UPDATED="onReportDataUpdated",HA.DATA_NAME_CHANGED="onReportDataNameChanged",HA.DATA_FIELD_NAME_CHANGED="onReportDataFieldNameChanged",HA.CELL_MERGED="onReportCellMerged",HA.ALERT="onReportAlert";class QA extends ki{constructor(t,e,s){super(t,e,s)}_prepareChild(t){}_doMeasure(t,e,s,i){this.measureFixed||this._setModelSize(this.model,e,s,i,!0);const r=super._doMeasure(t,e,s,i),n=this.childCount;let o=0,a=0;for(let t=0;t<n;t++){const e=this.getChild(t);if(e.visible){const t=e.model;o=Math.max(o,e.measuredWidth),a=Math.max(a,e.measuredHeight);let r=t.getTop(i);r>0&&(a+=r),r=t.getBottom(i),r>0&&(a+=r),r=t.getLeft(s),r>0&&(o+=r),r=t.getRight(s),r>0&&(o+=r)}}return r.set(o,a),this._applyPaddings(e,r),r}_layoutItem(t,e,s,i,r,n,o){const a=s.getLeft(n),A=s.getRight(n),l=s.getTop(o),h=s.getBottom(o);isNaN(a)||isNaN(A)?isNaN(a)?isNaN(A)?i+=(n-e.width)/2:i+=n-e.width-A:i+=a:(i+=a,e.width=Math.max(0,n-a-A)),isNaN(l)||isNaN(h)?isNaN(l)?isNaN(h)?r+=(o-e.height)/2:r+=o-e.height-h:r+=l:(r+=l,e.height=Math.max(0,o-l-h)),e.move(i,r),e.setPrintStyles()}_layoutChild(t,e,s,i,r,n){s+=(r-e.width)/2,i+=(n-e.height)/2,e.move(s,i),e.setPrintStyles()}}class UA extends QA{constructor(t,e,s){super(t,e,s)}get debugLabel(){return"stack"}_doSetStyles(t,e){super._doSetStyles(t,e),t&&t.overflow&&(e.style.overflow="visible")}_getPrev(t){const e=this.$_getSorted("x"),s=e.indexOf(t);return s>0?e[s-1]:null}_getNext(t){const e=this.$_getSorted("x"),s=e.indexOf(t);return s<e.length-1?e[s+1]:null}getUpper(t){const e=this.$_getSorted("y"),s=e.indexOf(t);return s>0?e[s-1]:null}getLower(t){const e=this.$_getSorted("y"),s=e.indexOf(t);return s<e.length-1?e[s+1]:null}$_getSorted(t){return this._getItemViews().sort(((e,s)=>e[t]-s[t]))}}class MA extends UA{get debugLabel(){return"stack"}_getCssSelector(){return"rr-stack-container rr-group-element"}_needDesignBox(){return!0}}class kA extends UA{constructor(t,e,s){super(t,e,s)}_doDispose(){super._doDispose()}_needDesignBox(){return!0}_isContexable(){return!1}_doPrepareMeasure(t,e){t.contextable=this._isContexable(),super._doPrepareMeasure(t,e)}_doMeasure(t,e,s,i){const r=super._doMeasure(t,e,s,i);return r.height>0||t.printing||!(this.model.designHeight>0)||(r.height=this.model.designHeight),r}measure(t,e,s){const i=super.measure(t,e,s);return t.printing&&(isNaN(this._printWidth)?isNaN(this.measuredWidth)||(this.width=this.measuredWidth):this.width=this._printWidth,isNaN(this._printHeight)?isNaN(this.measuredHeight)||(this.height=this.measuredHeight):this.height=this._printHeight,i.width=this.width,i.height=this.height),i}}class VA extends kA{constructor(t,e){super(t,e,"reportHeaderView")}_doDispose(){super._doDispose()}get debugLabel(){return"report header"}_getCssSelector(){return"rr-report-header rr-group-element"}}class GA extends kA{constructor(t,e){super(t,e,"reportFooterView")}_doDispose(){super._doDispose()}get debugLabel(){return"report footer"}_getCssSelector(){return GA.STYLE_NAME}}GA.STYLE_NAME="rr-page-header rr-group-element",GA.isFooter=function(t){return t&&t.className===GA.STYLE_NAME};class KA extends kA{constructor(t,e){super(t,e,"pageHeaderView")}_doDispose(){super._doDispose()}get debugLabel(){return"page header"}_getCssSelector(){return"rr-page-header rr-group-element"}_isContexable(){return!0}}class WA extends kA{constructor(t,e){super(t,e,"pageFooterView")}_doDispose(){super._doDispose()}get debugLabel(){return"page footer"}_getCssSelector(){return"rr-page-footer rr-group-element"}_isContexable(){return!0}}class zA extends Mi{constructor(t,e){super(t,e,"spaceItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-space rr-item-element"}get guardLabel(){return"space"}get debugLabel(){return"space"}get isSpace(){return!0}_doMeasure(t,e,s,i){return Me.create(0,0)}}class $A extends ki{constructor(t,e,s){super(t,e,s),this._gap=0,this._container=this}get gap(){return this._gap}get debugLabel(){return""}_needDesignBox(){return!0}_initDom(t,e){super._initDom(t,e)}_doSetStyles(t,e){super._doSetStyles(t,e),t&&t.overflow&&(e.style.overflow="visible")}_doMeasure(t,e,s,i){this.measureFixed||this._setModelSize(this.model,e,s,i,!0);const r=this.measureFixed?this.width:J.pickNum(this._modelWidth,s);this._gap=this.model.getItemGap(r);return super._doMeasure(t,e,r,i)}_doAfterMeasure(t,e,s,i,r){const n=this.measureFixed?this.width:s;r.height>0||t.printing||!(this.model.designHeight>0)||(r.height=this.model.designHeight),r.width>0||t.printing||!(this.model.designWidth>0)||(r.width=this.model.designWidth),this.childCount>0&&this._applyPaddings(e,r),super._doAfterMeasure(t,e,n,i,r)}}class XA extends $A{constructor(t,e){super(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rowBoxView")}_doDispose(){super._doDispose()}getColPoints(){return this._points.slice()}get debugLabel(){return"rbox"}_getCssSelector(){return"rr-box-container rr-rbox rr-group-element"}_initDom(t,e){super._initDom(t,e)}_doMeasure(t,e,s,i){const r=this.model,n=this._paddings=t.reportView.getBoxPaddings(r);super._doMeasure(t,e,s,i);const o=this,a=o.childCount;let A=0,l=this._gap*(a-1);for(let t=0;t<a;t++){const e=o.getChild(t);e.visible&&(e instanceof zA?l+=e._measuredWidth=e.model.getSize(s):e.floating||(A=Math.max(A,e.measuredHeight),l+=e.measuredWidth))}return o.width=l,o.height=A,o.resetSizeStyle(),this.invalidate(!0,!0),new Me(l+n.left+n.right,A+n.top+n.bottom)}_doLayoutContent(t){const e=this;for(let t=0,s=e.childCount;t<s;t++){const s=e.getChild(t);s.visible&&s instanceof zA&&(s._measuredHeight=this.height)}super._doLayoutContent(t);const s=e.width;let i=0;const r=this._points=[];let n=0;for(let t=0,s=e.childCount;t<s;t++){const s=e.getChild(t);s.visible&&!s.floating&&(n+=s.width+this._gap)}switch(n>0&&(n-=this._gap),this.model.itemsAlign){case _r.END:i=s-n;break;case _r.MIDDLE:i=(s-n)/2;break;default:i=0}for(let t=0,s=e.childCount;t<s;t++){const s=e.getChild(t);s.visible&&!s.floating&&(s.x=i,r.push(i),i+=s.width,r.push(i),i+=this._gap,s.setPrintStyles())}}_layoutItem(t,e,s,i,r,n,o){const a=s.getTop(o),A=s.getBottom(o);isNaN(a)?isNaN(A)?r+=(o-e.height)/2:r+=o-e.height-A:r+=a,e.move(this.x,r),e.setPrintStyles()}getUpper(t){return t}getLower(t){return t}}class jA extends $A{constructor(t,e){super(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"columnBoxView")}_doDispose(){super._doDispose()}getRowPoints(){return this._points.slice()}get debugLabel(){return"cbox"}_getCssSelector(){return"rr-box-container rr-cbox rr-group-element"}_initDom(t,e){super._initDom(t,e)}_doMeasure(t,e,s,i){const r=this.model,n=this._paddings=t.reportView.getBoxPaddings(r);super._doMeasure(t,e,s,i);const o=this,a=o.childCount;let A=this._gap*(a-1),l=0;for(let t=0;t<a;t++){const e=o.getChild(t);e.visible&&(e instanceof zA?A+=e._measuredHeight=e.model.getSize(i):e.floating||(l=Math.max(l,e.measuredWidth),A+=e.measuredHeight))}return o.width=l,o.height=A,o.resetSizeStyle(),this.invalidate(!0,!0),new Me(l+n.left+n.right,A+n.top+n.bottom)}_doLayoutContent(t){const e=this;for(let t=0,s=e.childCount;t<s;t++){const s=e.getChild(t);s.visible&&s instanceof zA&&(s._measuredWidth=this.width)}super._doLayoutContent(t);const s=e.height;let i=0;const r=this._points=[];let n=0;for(let t=0,s=e.childCount;t<s;t++){const s=e.getChild(t);s.visible&&!s.floating&&(n+=s.height+this._gap)}switch(n>0&&(n-=this._gap),this.model.itemsAlign){case _r.END:i=s-n;break;case _r.MIDDLE:i=(s-n)/2;break;default:i=0}for(let t=0,s=e.childCount;t<s;t++){const s=e.getChild(t);s.visible&&!s.floating&&(s.y=i,r.push(i),i+=s.height,r.push(i),i+=this._gap,s.setPrintStyles())}}_layoutItem(t,e,s,i,r,n,o){const a=s.getLeft(n),A=s.getRight(n);isNaN(a)?isNaN(A)?i+=(n-e.width)/2:i+=n-e.width-A:i+=a,e.move(i,e.y),e.setPrintStyles()}getLeft(t){return t}getRight(t){return t}}class YA extends ki{constructor(t,e){super(t,e,"diagonalBoxView")}_doDispose(){super._doDispose()}get debugLabel(){return"dbox"}_getCssSelector(){return"rr-box-container rr-dbox rr-group-element"}_needDesignBox(){return!0}_initDom(t,e){super._initDom(t,e),e.appendChild(this._line=t.createElement("span")),J.extend(this._line.style,{position:"absolute",boxSizing:"borderBox"}),this._line.dataset.line="1"}_doMeasure(t,e,s,i){const r=this.model,n=this._paddings=t.reportView.getBoxPaddings(r);this.measureFixed||this._setModelSize(r,e,s,i,!0),J.extend(this._line.style,r.lineStyles),super._doMeasure(t,e,s,i);const o=this.getChild(0),a=this.getChild(1);let A=0,l=0;return o&&a?(A=o.measuredWidth+a.measuredWidth,l=o.measuredHeight+a.measuredHeight):o&&(A=o.measuredWidth,l=o.measuredHeight),t.printing&&(this._line.dataset._m_=e.dataset._m_),new Me(A+n.left+n.right,l+n.top+n.bottom)}_doAfterMeasure(t,e,s,i,r){r.height>0||t.printing||!(this.model.designHeight>0)||(r.height=this.model.designHeight),r.width>0||t.printing||!(this.model.designWidth>0)||(r.width=this.model.designWidth),this.childCount>0&&this._applyPaddings(e,r),super._doAfterMeasure(t,e,s,i,r),e.style.padding="0"}_doLayoutContent(t){const e=this._line,s=this.width,i=this.height,r=Math.sqrt(Math.pow(s,2)+Math.pow(i,2));e.style.width=r+"px",this.model.reversed?(e.style.transform="translateY("+i+"px) rotate(-"+Math.atan(i/s)+"rad)",e.style.transformOrigin="0% 0%"):(e.style.transform="rotate("+Math.atan(i/s)+"rad)",e.style.transformOrigin="0% 0%"),super._doLayoutContent(t)}_layoutItem(t,e,s,i,r,n,o){const a=this.model;a.reversed?e.model===a.firstItem||(i=this.width-e.width-this._padRight,r=this.height-e.height-this._padBottom):e.model===a.firstItem?r=this.height-e.height-this._padBottom:i=this.width-e.width-this._padRight,e.move(i,r,!0)}}class JA extends QA{constructor(t,e,s){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];super(t,e,s),this._findable=!0,this._emptySize=i}_doDispose(){super._doDispose()}get isLayer(){return!0}get findable(){return this._findable}set findable(t){this._findable=t}get debugLabel(){return""}get lazyLayout(){return!0}_getCssSelector(){return"rr-item-container "+this.name}_needDesignBox(){return!1}_isEmptySize(){return this._emptySize}_initDom(t,e){super._initDom(t,e)}_prepareChild(t){}_doMeasure(t,e,s,i){t.printing&&(e.style.pointerEvents="none");return super._doMeasure(t,e,s,i).set(s,i)}}class ZA extends ki{constructor(t,e){super(t,e,"bandGroupCellView")}get debugLabel(){return"band group section"}_needDesignBox(){return!0}_getCssSelector(){return"rr-bandgroupcell rr-group-element"}_doMeasure(t,e,s,i){this.width=this._getModelWidth(this.model,s),this.measureFixed=!0;const r=super._doMeasure(t,e,s,i);return this.childCount>0&&(r.height=Math.max(r.height,this.getChild(0).measuredHeight)),r}}class qA extends ji{isEnded(){for(const t of this.bands)if(!t.isEnded())return!1;return!0}getRows(){}getNextPage(t,e,s,i){const r=t.createElement("div"),n=e.h;let o=0,a=0,A=0;return r.style.position="relative",i.appendChild(r),this.bands.forEach(((s,i)=>{const l=t.createElement("div"),h=s.wCell;Object.assign(l.style,{position:"absolute",left:A+"px",width:h+"px"}),r.appendChild(l),e.h=n;const d=s.getNextPage(t,e,h,l);d&&(a=Math.max(a,d.$_h),o++,A+=h+this.gap)})),r.style.left=this.left,r.$_h=a,o>0?r:null}}class tl extends ki{constructor(t,e){super(t,e,"bandGroupView"),this._gap=0}printGroup(t,e,s){const i=this.model.bandGap,r=[],n=[];let o=0,a=0;if(this.elements.forEach((s=>{const A=s.getChild(0),l=s.width;if(A){const s=[];e.saveBand(),A.printBand(t,e,l,s),r.push({n:s.length,y:e.y,h:e.h}),e.restoreBand(),s.forEach((t=>{t.style.width=l+"px",t.style.left=o+"px"})),n.push(s),a=Math.max(a,s.length)}else r.push(null),n.push(null);o+=l+i})),a>0){for(let e=0;e<a;e++){const i=t.createElement("div");i.className="bg-page-container",i.style.position="relative",i.style.left=this.style.left;for(let t=0;t<n.length;t++)if(n[t]){const s=n[t][e];s&&i.appendChild(s)}s.push(i)}let i=0,o=Number.MAX_SAFE_INTEGER;r.forEach((t=>{t.n===a&&(i=Math.max(i,t.y),o=Math.min(o,t.y))})),e.y=i,e.h=o}}getCellPoints(){return this._cellPts}prepareAsync(t,e,s){const i=this.model,r=this.elements,n=[];r.forEach((s=>{const i=s.getChild(0),r=s.width;if(i){const s=i.prepareAsync(t,e,r,null,-1);s.wCell=r,n.push(s)}}));const o=new qA;return o.bands=n,o.left=this.style.left,o.gap=i.bandGap,o}get debugLabel(){return"band group"}_needDesignBox(){return!0}_getCssSelector(){return"rr-bandgroup rr-group-element"}_doMeasure(t,e,s,i){const r=this.model;this._paddings=t.reportView.getBoxPaddings(r),this._setModelSize(r,e,s,i),this._gap=J.toNumber(r.bandGap,0);let n=J.pickNum(this._modelWidth,s);n-=this._paddings.left+this._paddings.right;const o=this.$_calcColWidths(n,this._gap);for(let t=0,e=r.count;t<e;t++){r.get(t).width=o[t]}const a=super._doMeasure(t,e,n,i);if(isNaN(this._modelHeight))for(let t=0;t<this.childCount;t++)a.height=Math.max(a.height,this.getChild(t).measuredHeight);return a}_doAfterMeasure(t,e,s,i,r){r.height>0||t.printing||!(this.model.designHeight>0)||(r.height=this.model.designHeight),r.width>0||t.printing||!(this.model.designWidth>0)||(r.width=this.model.designWidth),this.childCount>0&&this._applyPaddings(e,r),super._doAfterMeasure(t,e,s,i,r)}_doLayoutContent(t){const e=this;super._doLayoutContent(t);const s=this._cellPts=[];if(this.childCount>0){const t=this.height,i=this._gap;let r=this._paddings.left;s.push(r);for(let n=0,o=e.childCount;n<o;n++){const o=e.getChild(n);o.x=r,o.height=t,r+=o.width+i,o.setPrintStyles(),s.push(r)}}}_setDesignContent(t,e){super._setDesignContent(t,e),e.style.backgroundColor="#0088ff10"}$_calcColWidths(t,e){const s=this.model.items,i=s.length,r=[];if(t-=Math.max(0,e)*(s.length-1),i>1){let n=0;if(s.forEach((t=>n+=t.weight)),s.forEach((e=>{r.push(t*e.weight/n)})),e<0)for(let t=1;t<i;t++)r[t]-=e}else 1===i&&r.push(t);return r}}class el extends ki{constructor(t,e,s,i){super(t,s,i),this._table=e}_doDispose(){super._doDispose()}get table(){return this._table}get container(){return this._table.container}get debugLabel(){return""}get designable(){return!1}get navigable(){return!1}get navigableParent(){return this._table}_getCssSelector(){return el.STYLE}_needContentBox(){return!1}_initDom(t,e){super._initDom(t,e),e.className=el.STYLE}_prepareChild(t){t.dom.style.position="relative"}_doLayoutContent(t){super._doLayoutContent(t);const e=this.model,s=this._table,i=s.model.getCell(e.row,e.col),r=this.getChild(0),n=s.model.getColumn(e.col).styles,o=i.styles,a=o&&o.cellAlign||n&&n.cellAlign;let A=0;switch(a){case"left":break;case"right":A=this.offsetWidth-r.offsetWidth;break;default:A=(this.offsetWidth-r.offsetWidth)/2}if(r.x=A,r.setPrintStyles(),r.dom.style.display="table",r.dom.style.top="",r.y=NaN,t.printing){s.$_td(this._row,this._col).dataset._align=a?a.charAt(0):"c"}}}el.STYLE="rr-table-cell";class sl extends ki{constructor(t,e,s){super(t,e,s),this._tcells=[],this._ecells=[],this._spans=[]}static setTableStyle(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=t.style;s.setProperty("table-layout","fixed","important"),e&&s.setProperty("width","100%","important"),s.setProperty("border-collapse","collapse","important"),s.height="100%",t.className="rr-table"}static getTable(t){let e;if(t instanceof sl&&(e=t),!e&&t instanceof el&&(e=t.table),!e&&t&&t.parent instanceof el&&(e=t.parent.table),e instanceof sl)return e}_doDispose(){super._doDispose()}get rowCount(){return this._tbody.rows.length}get cellCount(){return this._tcells.length}get cellViews(){return this._tcells.slice(0)}get hasCells(){return this._tcells.length>0}getColPoints(){let t=0;const e=[t];if(this._cellWidths)for(let s of this._cellWidths)e.push(t+=parseFloat(s));return e}getColWidth(t){return this._colPts[t+1]-this._colPts[t]}getRowPoints(){const t=this.container.zoom,e=this._tbody.rows;let s=0;const i=[s];for(let r=0;r<e.length;r++)i.push(s+=100*e[r].getBoundingClientRect().height/t);return i}getRowRect(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const s=this._tbody.rows,i=d.create(0,0,this.width,0);for(let e=0;e<t;e++)i.y+=s[e].getBoundingClientRect().height;for(let r=0,n=Math.min(e,this.rowCount-t);r<n;r++)i.height+=s[r+t].getBoundingClientRect().height;return i}getColRect(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const s=d.create(0,0,0,this.height);return s.x=this._colPts[t],e=Math.min(e,this._colPts.length-t),s.width=this._colPts[t+e]-s.x,s}get blockable(){return!0}get debugLabel(){return"table"}_needContentBox(){return!1}getCellOf(t,e){if(!t)return null;let s;if(e){let e=t;for(;e;){if(e instanceof HTMLTableCellElement){s=e;break}e=e.parentElement}}else t.parentElement instanceof HTMLTableCellElement?s=t.parentElement:t instanceof HTMLTableCellElement&&(s=t);if(s){const t=s.parentElement.rowIndex;return this.model.getCell(t,s.cellIndex)}}findChildAt(t,e,s){const i=this.container.activeTool.mouseEventTarget;for(let t of this._tcells){if(t.isDom(i))return t;let e=t.getChild(0);if(e.isDom(i))return e;let s=e.findDescendantOf(i);if(s)return s;if(e.containsDom(i))return e}}findChildOf(t){for(let e of this._tcells){if(e.isDom(t))return e;const s=e.findChildOf(t);if(s)return s}}findElement(t){const e=super.findElement(t);if(!e)for(let e of this._tcells){const s=e.getChild(0);if(s instanceof Mi){const e=s.findElement(t);if(e)return e}}return e}findElementOf(t){const e=super.findElementOf(t);if(!e)for(let e of this._tcells){const s=e.getChild(0);if(s instanceof Mi){if(e.isDom(t))return s;const i=s.findElementOf(t);if(i)return i}}return!e&&(t instanceof HTMLTableCellElement||t.classList.contains(el.STYLE))&&this.containsDom(t)?this:e}getElementOf(t){for(let e of this._tcells){const s=e.getChild(0);if(s instanceof Mi&&s.model==t)return s;if(s instanceof ki){const e=s.getElementOf(t);if(e)return e}}}setCellDoms(t,e){const s=t.cells,i=e.cells;for(let t=i.length-1;t>=0;t--){const e=i[t].firstElementChild;e&&s[t].appendChild(e)}for(let e of this._tcells)e._row===t.rowIndex&&(e._dom=s[e._col].lastElementChild)}unsetCellDoms(t,e){const s=t.cells,i=e.cells;for(let t=i.length-1;t>=0;t--){const e=i[t].lastElementChild;e&&s[t].appendChild(e)}for(let e of this._tcells)e._row===t.rowIndex&&(e._dom=s[e._col].firstElementChild)}replaceCellDoms(t,e){const s=t.cells,i=e.cells;for(let t=i.length-1;t>=0;t--){const e=i[t].firstElementChild,r=s[t].firstElementChild;e&&r&&(i[t].removeChild(e),i[t].appendChild(r),s[t].appendChild(e))}for(let e of this._tcells)e._row===t.rowIndex&&(e._dom=s[e._col].firstElementChild)}_setTableStyles(t){sl.setTableStyle(t)}_createDom(t){const e=super._createDom(t),s=this._table=t.createElement("table");return this._setTableStyles(s),this._colgroup=t.createElement("colgroup"),s.appendChild(this._colgroup),this._tbody=t.createElement("tbody"),s.appendChild(this._tbody),e.appendChild(s),e}_doModelChanged(t){t&&(t.onCellChanged=null),this.model&&(this.model.onCellChanged=this.$_cellChanged.bind(this))}$_refreshRowCells(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=this.container;for(let n of this._tcells){i&&(n._modelChanged=!0);const o=J.pickNum(n.dom.offsetWidth,e);n.measure(t,o,s);const a=n.getChild(0);n.layoutContent(t),r?r._drawElement(a):a.drawRecursive()}const n=this.model.getMinRowHeight();if(!isNaN(n)){const t=n+"px",e=this._tbody.rows;for(let s=0;s<e.length;s++){e[s].offsetHeight<n&&(e[s].style.height=t)}}}_isEmpty(){return 0==this.model.colCount}_doMeasure(t,e,s,i){const r=this.model;return this._table.style.height="",this.$_prepareTable(r,this._tbody),this._setModelSize(r,e,s,i,!0),this.$_measureCellWidths(r,this._modelWidth||s),this.$_measureRowHeights(r,this._modelHeight||NaN),super._doMeasure(t,e,s,i),this.$_refreshRowCells(t,s,i),t.printing?this._table.dataset._m_=e.dataset._m_:this._table.dataset._m_=r.shash,new Me(this._table.offsetWidth,this._table.offsetHeight)}_doLayoutContent(t){super._doLayoutContent(t),this._table.style.height=this.height+"px"}clear(){if(this._ecells&&this._ecells.length&&(this._ecells.forEach((t=>J.remove(t))),this._ecells=null),this._tcells&&this._tcells.length)return this._tcells.forEach((t=>J.remove(t._dom))),this._tcells=null,!0}_buildItems(t,e,s){function i(t,e){let s=parseInt(h[t]);for(let i=1;i<e;i++)s+=parseInt(h[t+1]);return s>0?s+"px":""}function r(t,e){return t&&0!==e?Math.max(0,parseInt(t)-e)+"px":t}const n=this.doc,o=s.rowCount,a=s.colCount,A=this._tbody.rows,l=this._spans,h=this._rowHeights;this._tcells=[],this._ecells=[];for(let e=0;e<o;e++){const o=A[e];for(let A=0;A<a;A++){const a=o.cells[A],d=s.getCellItemAt(e,A);if(t.printing||(a.dataset.design=""),0===l[e][A].r||0===l[e][A].c)a.removeAttribute("colspan"),a.removeAttribute("rowspan"),a.style.display="none";else{this._prepareCellStyles(t,s,e,A,a);const o=l[e][A].r,c=o>1?i(e,o):h[e],u=getComputedStyle(a),p=J.toInt(u.paddingTop)+J.toInt(u.paddingBottom);if(a.colSpan=l[e][A].c,a.rowSpan=o,d){const t=this._createCellElement(n,d);t._row=e,t._col=A,t._dom.style.maxHeight=r(c,p),this._prepareChild(t),a.appendChild(t._dom),this._tcells.push(t)}else{const t=n.createElement("div");t.className=el.STYLE,t.innerHTML=$,t.style.maxHeight=r(c,0),a.appendChild(t),this._ecells.push(t)}}}}}_prepareCellStyles(t,e,s,i,r){const n=e.getCell(s,i),o=n.applyEndStyles;let a=e.cellStyles;this._setStyles(e,a,r.style),a=e.getColumn(i).styles,this._setStyles(e,a,r.style),o&&r.colSpan>1&&(a=e.getColumn(i+r.colSpan-1).styles,this._setStyles(e,a,r.style)),a=e.rows.get(s).styles,this._setStyles(e,a,r.style),o&&r.rowSpan>1&&(a=e.rows.get(s+r.rowSpan-1).styles,this._setStyles(e,a,r.style)),a=n.styles,a&&(vi in a?(a={...a},delete a.cellAlign,this._setStyles(e,a,r.style)):this._setStyles(e,a,r.style));const A=n.styleCallback;if(A)try{const s=A(t,n,t.row);s&&this._setStyles(e,s,r.style)}catch(t){console.error("StyleCallback Error",t)}}_prepareChild(t){t._dom.style.position="relative",t.positionable=!1}getFirst(){const t=this._spans;for(let e=0;e<t.length;e++){const s=t[e];for(let t=0;t<s.length;t++)if(s[t].r){const e=s[t].m;if(e)return this._findCell(e).firstChild}}}getLast(){const t=this._spans;for(let e=t.length-1;e>=0;e--){const s=t[e];for(let t=s.length-1;t>=0;t--)if(s[t].r){const e=s[t].m;if(e)return this._findCell(e).firstChild}}}_getPrev(t){const e=t.model,s=this._spans;let i=e.col;if(i>0){const t=e.row,r=s[t][i].v.rowspan||1;for(;--i>=0;)for(let n=0;n<r;n++){const r=s[t+n][i].m;if(r&&r.item!==e)return this._findCell(r).firstChild}}}_getNext(t){const e=this._spans,s=t.model,i=s.row;let r=s.col;if(r<e[i].length-1){const t=e[i][r].v.rowspan||1;for(;++r<e[i].length;)for(let n=0;n<t;n++){const t=e[i+n][r].m;if(t&&t.item!==s)return this._findCell(t).firstChild}}}getUpper(t){const e=this._spans,s=t.model;let i=s.row;if(i>0){const t=s.col,r=e[i][t].v.colspan||1;for(;--i>=0;)for(let n=0;n<r;n++){const r=e[i][t+n].m;if(r&&r.item!==s)return this._findCell(r).firstChild}}}getLower(t){const e=this._spans,s=t.model;let i=s.row;if(i<e.length-1){const t=s.col,r=e[i][t].v.colspan||1;for(;++i<e.length;)for(let n=0;n<r;n++){const r=e[i][t+n].m;if(r&&r.item!==s)return this._findCell(r).firstChild}}}get $_trows(){return this._tbody.rows}get $_trowsCopy(){return Array.from(this._tbody.rows)}$_cloneRow(t){const e=t.cloneNode(!1),s=t.cells;for(let t=0,i=s.length;t<i;t++){const i=s[t].cloneNode(!1),r=s[t].firstElementChild;r&&i.appendChild(r.cloneNode(!1)),e.appendChild(i)}return e}$_td(t,e){return this._tbody.rows[t].cells[e]}$_cellChanged(t,e,s){}$_prepareTable(t,e){const s=j(e),i=t.rowCount,r=t.colCount;for(this._spans=t.prepareLayout(),this.$_prepareColGroup(s,this._colgroup,r);e.childElementCount<i;){const t=s.createElement("tr");e.appendChild(t)}for(;e.childElementCount>i;)e.removeChild(e.lastChild);const n=e.children;for(let e=0;e<i;e++){const i=n[e];this.$_prepareTableRow(s,t,e,i,r)}}_setRowStyles(t,e){}$_prepareColGroup(t,e,s){let i=e.childElementCount;for(;i++<s;){const s=t.createElement("col");e.appendChild(s)}for(;e.childElementCount>s;)e.removeChild(e.lastElementChild)}$_prepareTableRow(t,e,s,i,r){this._setRowStyles(i,s),this.$_prepareTableRowCells(t,i,r)}$_prepareTableRowCells(t,e,s){let i=e.childElementCount;for(;i++<s;){const s=t.createElement("td");e.appendChild(s)}for(;e.childElementCount>s;)e.removeChild(e.lastChild);return e.childElementCount}$_calcCellWidths(t,e){const s=t.colCount,i=(t.getCellWidths()||b.Empty).getSizes(s,e,t._minCellWidthDim,!1),r=[],n=this._colPts=[0];let o=0;for(let t=0;t<i.length;t++)o+=i[t];const a=o<=e?"%":"px";for(let t=0;t<s;t++)r[t]=i[t]+a,n.push(n[t]+i[t]);return r}$_measureCellWidths(t,e){if(this._masterView)this._cellWidths=this._masterView._cellWidths,this._colPts=this._masterView._colPts;else{const s=t.colCount;this._tbody.rows.length>0&&s>0?this._cellWidths=this.$_calcCellWidths(t,e):this._cellWidths=[]}let s=0;if(this._cellWidths.length>0){const t=this._colgroup.children;for(let e=t.length-1;e>=0;e--){const i=t[e],r=i.style,n=parseFloat(this._cellWidths[e]);i.$_w=n,i.dataset.width=String(n),r.width=this._cellWidths[e],s+=n}}t.fixed?this._table.style.setProperty("width",J.pickNum(s,0)+"px","important"):this._table.style.setProperty("width","100%","important")}$_calcRowHeights(t,e){const s=(t.getRowHeights()||b.Empty).getSizes(t.rowCount,e,t._minRowHeightDim),i=[];for(let e=0,r=t.rowCount;e<r;e++)isNaN(s[e])?i[e]="":i[e]=s[e]+"px";return i}$_measureRowHeights(t,e){const s=this._tbody.rows,i=this._rowHeights=this.$_calcRowHeights(t,e);for(let t=0;t<s.length;t++){const e=i[t];s[t].style.height=e}}getCellBoundingRect(t,e,s,i){const r=this._tbody.rows,n=this._colPts[0]-r[0].cells[0].offsetLeft;let o=this._colPts[t]-n,a=r[e].offsetTop,A=this._colPts[t+s]-n-o-1,l=0;for(let t=0;t<i;t++)l+=r[e+t].offsetHeight;return{x:o,y:a,width:A,height:l}}$_layoutViewInCell(t,e){const s=this.model;let i=-1,r=-1;const n=e instanceof Ir&&e.table instanceof ln?1:0;if(e instanceof Ir&&e.table===s&&(i=e.row,r=e.col),t.visible=r>=0&&i<s.rowCount){const e=this._tbody.rows[i].cells[r],s=e.colSpan||1,o=e.rowSpan||1,a=this._colPts[r],A=this._colPts[r+s]-a,l=this._tbody.rows;let h=l[i].offsetHeight,d=0;for(let t=0;t<i;t++)d+=l[t].offsetHeight;for(let t=0;t<o-1;t++)h+=l[i+t+1].offsetHeight;return t.dom.dataset.focused="",t.setBounds(a,d+1,A,h+n),t.draw(),!0}}_findCell(t){for(let e of this._tcells)if(e.model===t)return e}createColGroup(t,e){const s=this.model,i=s.colCount,r=t.createElement("colgroup"),n=this.$_calcCellWidths(s,e);for(let e=0;e<i;e++){const s=t.createElement("col");r.appendChild(s),s.style.width=n[e],s.$_w=parseFloat(n[e])}return r}}class il{constructor(t){this._rows=t.tBodies[0].rows}get height(){const t=this._doms||this._rows;let e=0;for(let s=0;s<t.length;s++)e+=t[s].offsetHeight;return e}appendTo(t,e){if(!this._doms){this._doms=[];for(let t=0;t<this._rows.length;t++){const e=this._rows[t].cloneNode(!0);this._doms.push(e)}}for(let s of this._doms)s.classList.add(e),t.appendChild(s);for(let t of this._doms)t.style.height=t.offsetHeight+"px"}remove(){if(this._doms){for(let t=this._doms.length-1;t>=0;t--){const e=this._doms[t],s=e.parentElement;s&&s.removeChild(e)}this._doms=null}}}const rl=".",nl=",",ol=function(t){return J.included(t,"c","f","C","F","a","A")};class al{constructor(t){this._optDecimal=!1,this._groupPos=0,this._replacement="$&,",this._minDigits=0,this._maxDigits=0,this._minInts=0,this._maxInts=0,this.parse(this._format=t)}static getFormatter(t){let e=al.Formatters[t];return e||(al.Formatters[t]=e=new al(t)),e}static get Default(){return al.getFormatter(al.DEFAULT_FORMAT)}get format(){return this._format}get separator(){return this._seperator}get groupSep(){return this._groupSep}get minDigits(){return this._minDigits}get maxDigits(){return this._maxDigits}parse(t){this._minDigits=0,this._maxDigits=0,this._minInts=0,this._maxInts=0,this._parse(t)}getText(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=Number(t);if(isNaN(s))return"";{let t=this._minDigits,r=0;if(this._optDecimal){const e=(i=(""+s).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(i[1]?i[1].length:0)-(i[2]?+i[2]:0)):0;t=Math.min(Math.max(e,this._minDigits),this._maxDigits)}if(t>0&&this._round)switch(r=Math.pow(10,t),this._round){case"c":s=Math.ceil(r*s)/r;break;case"f":const e=s.toString().split(".");s=parseFloat(e.length>1?e[0]+"."+e[1].substr(0,t):e[0])}s="a"===this._round?Math.abs(s):s,s=Number(s.toPrecision(15));let n=s.toFixed(t);try{!e&&(r=parseFloat(n))===Math.abs(parseFloat(n))&&0===r&&(n=Math.abs(s).toFixed(t))}catch(t){}return this._seperator&&(n=n.replace(rl,this._seperator)),this._reg?t?n.replace(this._regDecimal,this._replacement):n.replace(this._reg,this._replacement):n}var i}_parse(t){if(t&&(t=t.trim()),!t)return;var e=rl,s=nl;if(t.indexOf(";")>-1){const i=t.split(";");t=i[0],i.length>1&&i[1]&&!ol(i[1])&&(e=i[1]),i.length>2&&i[2]&&!ol(i[2])&&(s=i[2]),this._round=i[3]||i[2]||i[1],this._round=ol(this._round)?this._round.toLowerCase():this._round}this._seperator=e==rl?null:e,this._groupSep=s==nl?null:s;const i=t.length,r=t.indexOf(rl);if(this._optDecimal=t.indexOf("#",r)>0,r>=0){let e=r+1;for(;e<i&&"0"==t.charAt(e);e++)this._minDigits++,this._maxDigits++;for(;e<i&&"#"==t.charAt(e);e++)this._maxDigits++;t=t.substr(0,r)}if(t){const e=t.length;t.charAt(e-1)==nl&&(this._groupPos=3,t=t.substr(0,e-1))}if(t){const e=t.length;let s=!0;for(let i=e-1;i>=0;i--){const r=t.charAt(i);if("0"==r&&s)this._minInts++,this._maxInts++;else if(0==this._groupPos&&r==nl)this._groupPos=e-i-1;else{if("#"!=r)break;s=!1}}}this._groupPos>0&&(this._replacement="$&"+s,this._reg=new RegExp("\\d(?=(\\d{"+this._groupPos+"})+($|\\"+e+"))","g"),this._regDecimal=new RegExp("\\d(?=(\\d{"+this._groupPos+"})+\\"+e+")","g"))}}al.DEFAULT_FORMAT="#,##0.0",al.Formatters={};class Al extends je{constructor(t){super(t,"fieldContainer"),this._divs=[]}setFields(t,e,s){const i=this.dom,r=this._divs,n=s?s.length:0;for(i.dataset.empty=n>0?"0":"1";r.length<n;){const e=t.createElement("div"),s=t.createElement("span"),n=t.createElement("span");s.style.flexGrow="1",s.style.whiteSpace="nowrap",e.appendChild(s),n.className=Al.ARROW_CLASS,n.textContent="‣",e.appendChild(n),e.className=Al.FIELD_CLASS,e.style.display="flex",e.style.alignItems="center",i.appendChild(e),r.push(e)}for(;r.length>n;){const t=this._divs.pop();i.removeChild(t)}r.forEach(((t,e)=>{const i=s[e].fieldName;t.firstElementChild.textContent=i,t.children[1].$_fld=i}))}_getCssSelector(){return Al.CLSS_NAME}_initDom(t,e){super._initDom(t,e),Object.assign(e.style,{display:"flex",flexDirection:"column",overflowY:"scroll",overflowX:"hidden",paddingRight:"4px",minWidth:"150px"})}_doMeasure(t,e,s,i){return Me.create(e.offsetWidth,e.offsetHeight)}_doLayoutContent(t){}}Al.CLSS_NAME="rr-crosstab-field-container",Al.FIELD_CLASS="rr-crosstab-field",Al.ARROW_CLASS="rr-crosstab-field-arrow";class ll extends Ye{constructor(t,e,s){super(t,e),this.$_createSectionTable(t,this.dom,s)}get fields(){return this._fields}setFields(t){this._fields=t}getFieldOf(t){if(t instanceof HTMLTableCellElement&&this._tbody.contains(t)&&t.cellIndex>0){const e=this._fields.get(t.cellIndex-1);return"summaryHeader"===t.dataset.type?e.summary.header:"summary"===t.dataset.type?e.summary:"header"===t.dataset.type?e.header:e}}getFieldCellRow(t){return{r:t instanceof lo?3:t instanceof ho?2:t instanceof Ao?1:0,n:1}}getFieldBoundingRect(t){const e=No.getFieldOf(t),s=this.getFieldCellRow(t),i=this._tbody.rows[s.r].cells[e.index+1];let r=i.offsetHeight;return s.n>1&&(r+=this._tbody.rows[s.r+1].cells[e.index+1].offsetHeight),{x:i.offsetLeft,y:i.offsetTop,width:i.offsetWidth,height:r}}isViewOf(t){return t===this._fields}_initDom(t,e){super._initDom(t,e),Object.assign(e.style,{backgroundColor:"#f8f8f8"})}_doMeasure(t,e,s,i){return this._doPrepareCells(this.doc,this._tbody),Me.create(e.offsetWidth,this._table.offsetHeight)}_doLayoutContent(t){}$_createSectionTable(t,e,s){this._table=t.createElement("table"),sl.setTableStyle(this._table,!1),this._table.style.position="absolute",this._table.style.backgroundColor="white",this._table.className=ll.TABLE_CLASS;const i=this._tbody=t.createElement("tbody");let r,n;for(let e=0;e<s;e++)i.appendChild(r=t.createElement("tr")),r.appendChild(n=t.createElement("td")),n.dataset.empty="1",n.style.backgroundColor="#f0f0f0";this._table.appendChild(i),e.appendChild(this._table)}_prepareRow(t,e){const s=this._fields.count+1;for(;e.cells.length<s;){const s=t.createElement("td");s.className="rr-crosstab-field-cell",e.appendChild(s)}for(;e.cells.length>s;)J.remove(e.lastElementChild)}}ll.TABLE_CLASS="rr-crosstab-section-table";class hl extends ll{constructor(t){super(t,"rowFieldsView",4)}_doPrepareCells(t,e){const s=e.rows,i=this._fields.count;for(let e=0;e<4;e++)this._prepareRow(t,s[e]);if(["Field","Header","Summary","Summary Header"].forEach(((t,e)=>{s[e].cells[0].textContent=t})),i>0)for(let t=0;t<i;t++){const e=this._fields.get(t);s[0].cells[t+1].textContent="[".concat(e.field,"]"),Object.assign(s[0].cells[t+1].style,e.styles),s[1].cells[t+1].textContent="[".concat(e.field,"]"),s[1].cells[t+1].dataset.type="header",Object.assign(s[1].cells[t+1].style,e.header.styles),s[2].cells[t+1].textContent="[".concat(e.field,"]"),s[2].cells[t+1].dataset.type="summary",Object.assign(s[2].cells[t+1].style,e.summary.styles);let i=e.summary.header.text;i||(i=0===t?"전체 요약":"[".concat(this._fields.get(t-1).field,"]")),s[3].cells[t+1].textContent=i,s[3].cells[t+1].dataset.type="summaryHeader",Object.assign(s[3].cells[t+1].style,e.summary.header.styles)}}}class dl extends ll{constructor(t){super(t,"columnFieldsView",4)}_doPrepareCells(t,e){const s=e.rows,i=this._fields.count;for(let e=0;e<4;e++)this._prepareRow(t,s[e]);if(["Field","Header","Summary","Summary Header"].forEach(((t,e)=>{s[e].cells[0].textContent=t})),i>0)for(let t=0;t<i;t++){const e=this._fields.get(t);s[0].cells[t+1].textContent="[".concat(e.field,"]"),Object.assign(s[0].cells[t+1].style,e.styles),s[1].cells[t+1].textContent="[".concat(e.field,"]"),s[1].cells[t+1].dataset.type="header",Object.assign(s[1].cells[t+1].style,e.header.styles),s[2].cells[t+1].textContent="[".concat(e.field,"]"),s[2].cells[t+1].dataset.type="summary",Object.assign(s[2].cells[t+1].style,e.summary.styles),s[3].cells[t+1].textContent=e.summary.header.text||"[".concat(e.field,"]"),s[3].cells[t+1].dataset.type="summaryHeader",Object.assign(s[3].cells[t+1].style,e.summary.header.styles)}}}class cl extends ll{constructor(t){super(t,"valueFieldsView",5)}_doPrepareCells(t,e){const s=e.rows,i=this._fields.count;for(let e=0;e<5;e++)this._prepareRow(t,s[e]);if(["Field","Value","Header","Summary","Summary Header"].forEach(((t,e)=>{s[e].cells[0].textContent=t})),i>0)for(let t=0;t<i;t++){const e=this._fields.get(t);s[0].cells[t+1].textContent="[".concat(e.field,"]"),Object.assign(s[0].cells[t+1].style,e.styles),s[1].cells[t+1].style.color="#008",s[1].cells[t+1].textContent="[ ".concat(e.value," ]"),s[2].cells[t+1].textContent="[".concat(e.field,"]"),s[2].cells[t+1].dataset.type="header",Object.assign(s[2].cells[t+1].style,e.header.styles),s[3].cells[t+1].textContent="[".concat(e.field,"]"),s[3].cells[t+1].dataset.type="summary",Object.assign(s[3].cells[t+1].style,e.summary.styles),s[4].cells[t+1].textContent=e.summary.header.text||"[".concat(e.field,"]"),s[4].cells[t+1].dataset.type="summaryHeader",Object.assign(s[4].cells[t+1].style,e.summary.header.styles)}}getFieldCellRow(t){const e=t instanceof lo?4:t instanceof ho?3:t instanceof Ao?2:0;return{r:e,n:0===e?2:1}}}class ul extends ji{isEnded(){return 0===this.trows.length}getRows(){}getNextPage(t,e,s,i){const r=e.h;let n=e.h;if(this.trows.length>0){const s=this.band,o=t.createElement("div"),a=t.createElement("table"),A=t.createElement("tbody"),l=this.headers,h=this.trows,d=[];let c=0;a.appendChild(A),o.appendChild(a),o.style.position="relative",i.appendChild(o),a.style.position="absolute",sl.setTableStyle(a);for(let t=0;t<l.length;t++)if(c+=l[t].offsetHeight,c>n)return void(e.h=0);for(let t=0;t<l.length;t++){const e=l[t].cloneNode(!0);A.appendChild(e)}for(n-=c;n>0&&h.length>0;){let t=h[0];if(A.appendChild(t),c=t.offsetHeight,c>n){t.remove(),e.h=0;break}n-=c,d.push(h.shift())}return function(t,e){for(let s=0;s<e;s++){let e,i,r=0;t.forEach((t=>{const n=t.cells[s],o=n.textContent;o!==i?(e&&(e.rowSpan=r),e=n,r=1,i=o):(n.style.display="none",r++)})),e&&(e.rowSpan=r)}t.forEach((t=>{const s=t.cells,i=t._lev;if(i>0){s[e-i].colSpan=i;for(let t=e-i+1;t<e;t++)s[t].style.display="none"}}))}(d,s.rowFields.count),o.$_h=r-n,o}}}class pl extends ki{constructor(t,e){super(t,e,"crosstabBandView"),this._nullBand=!1,this._nHeader=0,this._nRowHead=0,this._nRow=0,this._rowContainer=t.createElement("div"),this._rowContainer.className="rr-crosstab-rows",this._dom.appendChild(this._rowContainer)}static isFieldArrow(t){return t.className===Al.ARROW_CLASS}_doDispose(){super._doDispose()}getFieldOf(t){return this._rowFieldsView.getFieldOf(t)||this._columnFieldsView.getFieldOf(t)||this._valueFieldsView.getFieldOf(t)}getFieldsOf(t){for(let e of[this._rowFieldsView,this._columnFieldsView,this._valueFieldsView])if(e.containsDom(t))return e.fields}getFieldBoundingRect(t){const e=this.model,s=No.getFieldOf(t);let i,r;if(e.rowFields.indexOf(s)>=0?i=this._rowFieldsView:e.columnFields.indexOf(s)>=0?i=this._columnFieldsView:e.valueFields.indexOf(s)>=0&&(i=this._valueFieldsView),i)return r=i.getFieldBoundingRect(t),r.x+=i.x,r.y+=i.y,r}$_createTableContainer(t,e,s){const i=t.createElement("div");return J.extend(i.style,{position:"absolute",left:e+"px",top:s+"px",width:"100%"}),i}$_createTable(t){const e=t.createElement("table"),s=t.createElement("tbody");return e.appendChild(s),e.style.position="absolute",sl.setTableStyle(e),e}$_addTable(t,e,s,i){const r=this.$_createTableContainer(t,s,i),n=this.$_createTable(t);return r.dataset._m_=this.model.shash,n.dataset._m_=this.model.shash,r.appendChild(n),e.appendChild(r),n}$_createPage(t){const e=t.createElement("div");return e.className="rr-crosstab-page",e.style.position="relative",this._rowContainer.appendChild(e),e}printBand(t,e,s,i){function r(s,r){const n=s.$_createPage(t);return e.yBand=_=0,r&&(c=e.y=e.bodyTop),l=[],function(e,s){h=e.$_addTable(t,s,p,_),d=h.tBodies[0]}(s,n),i.push(n),r&&a.pageNo++,n}function n(t){let e=0;for(let t=0;t<g;t++)e+=A[t].offsetHeight;c+e>u&&r(t,!0);for(let t=0;t<g;t++){const e=A[t].cloneNode(!0);d.appendChild(e)}c+=e}function o(){const t=a.rowFields.count;for(let e=0;e<t;e++){let t,s,i=0;l.forEach((r=>{const n=r.cells[e],o=n.textContent;o!==s?(t&&(t.rowSpan=i),t=n,i=1,s=o):(n.style.display="none",i++)})),t&&(t.rowSpan=i)}l.forEach((e=>{const s=e.cells,i=e._lev;if(i>0){s[t-i].colSpan=i;for(let e=t-i+1;e<t;e++)s[e].style.display="none"}}))}if(this._nullBand)return;const a=this.model,A=this._tbody.rows;let l,h,d,c=e.y,u=e.bodyBottom,p=0,_=e.yBand,g=this._nHeader,f=this._nRow,m=this._nRowHead,w=0;for(r(this,!1),n(this);w<f;){const t=A[g],s=t.offsetHeight;c+s>u&&(o(),r(this,!0),n(this));const i=t.cells;for(let t=0;t<m;t++)i[t].colSpan=1,i[t].rowSpan=1,i[t].style.display="";d.appendChild(t),l.push(t),c+=s,e.y=c,w++}o()}prepareAsync(t,e,s){const i=this.model,r=Array.from(this._tbody.rows),n=this._nHeader,o=new ul;return o.band=i,o.headers=r.slice(0,n),o.trows=r.slice(n),o.nHeader=n,o.nRowHead=this._nRowHead,o}get debugLabel(){return"crosstab"}_getCssSelector(){return"rr-crosstab rr-group-element"}_needDesignBox(){return!0}findElementOf(t){return this.dom.contains(t)?this:super.findElementOf(t)}_doPrepareMeasure(t,e){if(super._doPrepareMeasure(t,e),t.printing){const s=this.model;if(s&&(e.dataset._m_=s.shash,t.report&&(t.report.models[s.shash]=s),s.build()),!this._table){const t=e.ownerDocument,s=this._table=t.createElement("table");sl.setTableStyle(s),this._colgroup=t.createElement("colgroup"),s.appendChild(this._colgroup),this._tbody=t.createElement("tbody"),s.appendChild(this._tbody),e.appendChild(s)}}}_doMeasure(t,e,s,i){var r;const n=this.doc,o=t.printing,a=this.model;if(o)return this._table.style.width=s+"px",this.$_prepareTable(n,a,this._tbody),new Me(this._table.offsetWidth,this._table.offsetHeight);{let e,o=0,A=0;this.$_prepareDesign(n,t,a),this.$_prepareHeads(n),e=this._fieldsView.measure(t,s,i),s-=e.width,this._rowFieldsView.setFields(a.rowFields),e=this._rowFieldsView.measure(t,s,i),A+=e.height,this._columnFieldsView.setFields(a.columnFields),e=this._columnFieldsView.measure(t,s,i),A+=e.height,this._valueFieldsView.setFields(a.valueFields),e=this._valueFieldsView.measure(t,s,i),A+=e.height;const l=null===(r=this.container)||void 0===r?void 0:r.focusedItem;for(let r in this._headViews){const n=this._headViews[r];e=n.measure(t,s,i),o=Math.max(o,e.width),A+=e.height+2,n.setSelected(l)}return A-=this._headViews[this.hash].measuredHeight+2,Me.create(o,A)}}_doLayoutContent(t){const e=this.model;let s=0,i=0;if(t.printing);else{let t,r,n=this.width;s=2;let o=this._headViews[this.hash].measuredHeight;t=this._headViews[this.hash],t.setBounds(s,i+2,t.measuredWidth,t.measuredHeight),this._fieldsView.setBounds(s,i+2+o,this._fieldsView.measuredWidth,this.height-o-2),n-=this._fieldsView.width+2+s-1,s+=this._fieldsView.width+2,t=this._headViews[e.rowFields.hash],t.setBounds(s,i+2,t.measuredWidth,t.measuredHeight),i+=t.height+2,r=this._rowFieldsView,o=r.measuredHeight,r.setBounds(s,i,n,o),i+=o,t=this._headViews[e.columnFields.hash],t.setBounds(s,i+2,t.measuredWidth,t.measuredHeight),i+=t.height+2,r=this._columnFieldsView,o=r.measuredHeight,r.setBounds(s,i,n,o),i+=o,t=this._headViews[e.valueFields.hash],t.setBounds(s,i+2,t.measuredWidth,t.measuredHeight),i+=t.height+2,r=this._valueFieldsView,o=r.measuredHeight,r.setBounds(s,i,n,o),i+=o}}$_prepareDesign(t,e,s){const i=s.getData();this._fieldsView||this.addChild(this._fieldsView=new Al(t)),this._fieldsView.setFields(t,s,i?i.fields:[]),this._rowFieldsView||this.addChild(this._rowFieldsView=new hl(t)),this._columnFieldsView||this.addChild(this._columnFieldsView=new dl(t)),this._valueFieldsView||this.addChild(this._valueFieldsView=new cl(t))}$_prepareHeads(t){if(!this._headViews){const e=this.model;this._headViews={},this.addChild(this._headViews[this.hash]=new Je(t,e,"CROSSTAB BAND","CrosstabBand","rr-band-head")),this.addChild(this._headViews[e.rowFields.hash]=new Je(t,e.rowFields,"ROW FIELDS","RowFields","rr-band-head")),this.addChild(this._headViews[e.columnFields.hash]=new Je(t,e.columnFields,"COLUMN FIELDS","ColumnFields","rr-band-head")),this.addChild(this._headViews[e.valueFields.hash]=new Je(t,e.valueFields,"VALUE FIELDS","ValueFields","rr-band-head"))}}$_prepareTable(t,e,s){const i=e._columns.levels,r=e.rowFields.count,n=e.valueFields.count,o=e._columns.leafCount,a=r+o;if(i<1||r<1||n<1)return void(this._nullBand=!0);this.$_prepareColGroup(t,this._colgroup,a);const A=[];for(let e=0;e<i;e++){const e=t.createElement("tr");for(let s=0;s<a;s++){const s=t.createElement("td");s.className="rr-crosstab-head",e.appendChild(s)}s.appendChild(e),A.push(e)}for(let t=0;t<i;t++)for(let e=0;e<r;e++)A[t].cells[e].style.display="none";const l=A[0].cells[0];l.rowSpan=i,l.colSpan=r,l.style.display="",l.textContent=e.title.text,Object.assign(l.style,e.title.styles);let h=A[i-1].cells;for(let t=r;t<h.length;t++){const s=h[t],i=e._columns.getLeaf(t-r);s.textContent=i.getHeader(),Object.assign(s.style,i.valueField.header.styles),i instanceof xo&&Object.assign(s.style,i.valueField.summary.header.styles)}!function t(s,i){const r=s.level+1,o=A[r].cells,a=s.children;let l=e.rowFields.count+r*n+i,h=0;for(let s=0;s<a.length;s++){const i=a[s],n=l,d=o[l++];let c=i.leafCount;d.textContent=i.getHeader(),d.colSpan=c;for(let t=1;t<c;t++)o[l++].style.display="none";if(Object.assign(d.style,i.field.header.styles),i instanceof Po){const t=e.columnLevels-1;Object.assign(d.style,i.field.summary.header.styles);for(let e=r+1;e<t;e++)for(let t=0;t<c;t++)A[e].cells[n+t].style.display="none";d.rowSpan=t-r}else i.children[0].isLeaf||(t(i,h),h+=c)}}(e._columns.root,0),this._nHeader=s.rows.length;const d=e.bandData,c=e.rows,u=c.rowCount,p=e.nullValue.text,_=e.nullValue.styles;for(let i=0;i<u;i++){const n=t.createElement("tr"),a=c.getRow(i);for(let s=0;s<r;s++){const i=e.getRowField(s),r=t.createElement("td"),o=a.getValue(s)+(i.header.suffix||"");r.className="rr-crosstab-head",r.textContent=o,Object.assign(r.style,i.header.styles),n.appendChild(r)}if(0===i){const t=e.rowFields.get(0).summary.header,s=n.cells[0];t.text&&(s.textContent=t.text),Object.assign(s.style,t.styles),n._lev=r}else if(a instanceof To){const t=a.fields.length,s=e.rowFields.get(t).summary.header,i=n.cells[t];s.text&&(i.textContent=s.text),Object.assign(i.style,s.styles),n._lev=r-t}const A=new al("#,##0");for(let s=0;s<o;s++){const r=t.createElement("td"),o=e.getCellValue(d,i,s);r.className="rr-crosstab-value",isNaN(o)&&(r.classList.add("rr-crosstab-null"),Object.assign(r.style,_)),r.textContent=isNaN(o)?p:A.getText(o);const l=e._columns.getLeaf(s);if(l instanceof xo&&Object.assign(r.style,l.valueField.summary.styles),0===i)Object.assign(r.style,e.rowFields.get(0).summary.styles);else if(a instanceof To){const t=a.fields.length;Object.assign(r.style,e.rowFields.get(t).summary.styles)}n.appendChild(r)}s.appendChild(n)}this._nRow=s.rows.length-this._nHeader,this._nRowHead=e.rowFields.count}$_prepareColGroup(t,e,s){let i=e.childElementCount;for(;i++<s;){const s=t.createElement("col");e.appendChild(s)}for(;e.childElementCount>s;)e.removeChild(e.lastElementChild)}}class _l extends jA{getLines(){const t=[];for(let e=0;e<this._container.childCount;e++){const s=this._container.getChild(e);s instanceof Mi&&!s.isSpace&&!s.floating&&t.push(s)}return t}getLine(t){const e=this._container.childCount;if(e>0)if(t>=0)for(let s=0,i=0;s<e;s++){const e=this._container.getChild(s);if(e instanceof Mi&&!e.isSpace&&!e.floating){if(i==t)return e;i++}}else for(let s=e-1,i=-1;s>=0;s--){const e=this._container.getChild(s);if(e instanceof Mi&&!e.isSpace&&!e.floating){if(i==t)return e;i--}}}isLine(t){return!t.isSpace&&!t.floating&&this._container.contains(t)}getLineOf(t){if(this.isLine(t))return t;let e=t;for(;e;){const t=e.navigableParent;if(t===this._container||t instanceof zi)return e;e=t}}getSiblingLine(t,e){let s=t.navigableParent;if(s instanceof zi){const i=s.getSibling(t,e);if(i)return i;t=s}s=this._container;let i=s.indexOf(t);if(i>=0)if(e>0)for(let t=i+1;t<s.childCount;t++){const e=s.getChild(t);if(e instanceof Mi&&!e.isSpace&&!e.floating)return e}else if(e<0)for(let t=i-1;t>=0;t--){const e=s.getChild(t);if(e instanceof Mi&&!e.isSpace&&!e.floating)return e}}get isLayer(){return!0}get debugLabel(){return""}get designable(){return!1}_debugBorder(){return"none"}_doMeasure(t,e,s,i){const r=t.printing?Math.ceil(t.bodyHeight)-Math.ceil(t.reportHeaderHeight)-Math.ceil(t.reportFooterHeight)-Math.ceil(t.headerHeight)-Math.ceil(t.footerHeight):i;return super._doMeasure(t,e,s,r)}}class gl extends je{constructor(t,e){super(t,"pageBody"),this._findable=!0,this._modelChanged=!1,this._model=e,this.addChild(this._backContainerView=new JA(t,null,"backView")),this.addChild(this._itemsView=new _l(t,null)),this.addChild(this._frontContainerView=new JA(t,null,"frontView"))}_doDispose(){super._doDispose()}get model(){return this._model}set model(t){t!==this._model&&(this._model=t,this._modelChanged=!0,t&&(this._backContainerView.model=t.backItemsContainer,this._frontContainerView.model=t.frontItemsContainer,this._itemsView.model=t.itemsContainer))}get empty(){return 0==this._itemsView.childCount&&0==this._backContainerView.childCount&&0==this._frontContainerView.childCount}get itemsView(){return this._itemsView}isPageDom(t){return this.isDom(t)||this._itemsView.isDom(t)||this._itemsView.isContentDom(t)}findElement(t){return this._itemsView.findElement(t)||this._backContainerView.findElement(t)||this._frontContainerView.findElement(t)}findElementOf(t){return this._itemsView.findElementOf(t)||this._backContainerView.findElementOf(t)||this._frontContainerView.findElementOf(t)}getElementOf(t){return this._itemsView.getElementOf(t)||this._backContainerView.getElementOf(t)||this._frontContainerView.getElementOf(t)}isLine(t){return this._itemsView.isLine(t)}getLineOf(t){return this._itemsView.getLineOf(t)}getSiblingLine(t,e){return this._itemsView.getSiblingLine(t,e)}getLine(t){return this._itemsView.getLine(t)}getLines(){return this._itemsView.getLines()}printAll(t,e){const s={pages:new Array};return this.print(t,e),this.empty||(this.layoutFloating(e),this.$_buildPages(t,e,s)),s}prepareAsync(t,e){return this.print(t,e),this.empty?[]:(this.layoutFloating(e),this.$_prepareAsync(t,e))}itemOfDom(t){let e;return(e=this._frontContainerView.itemOfDom(t))||(e=this._itemsView.itemOfDom(t))||(e=this._backContainerView.itemOfDom(t))?e:void 0}_getCssSelector(){return"rr-page-body"}get debugLabel(){return"page body"}get findable(){return this._findable}set findable(t){this._findable=t}_debugBorder(){return"1px solid rgba(0, 0, 255, 0.3)"}_debugColor(){return"rgba(0, 0, 255, 0.4)"}_doMeasure(t,e,s,i){this._modelChanged&&(this._modelChanged=!1),this._backContainerView.setFixedSize(s).measure(t,s,i),this._itemsView.setFixedSize(s).measure(t,s,i),this._frontContainerView.setFixedSize(s).measure(t,s,i);const r=Math.max(this.itemsView.measuredHeight,i);return new Me(s,r)}_doLayoutContent(t){const e=this.width,s=this.height;let i;i=this._backContainerView,i.setBounds(0,0,e,s),i.layoutContent(t),i=this._itemsView,i.setBounds(0,0,e,s),i.layoutContent(t),i=this._frontContainerView,i.setBounds(0,0,e,s),i.layoutContent(t)}layoutFloating(t){this._backContainerView.layoutFloating(t),this._itemsView.layoutFloating(t),this._frontContainerView.layoutContent(t)}$_buildPages(t,e,s){function i(){const t=[];o.push(t);let s=e.bodyTop;return e.h=e.bodyHeight,0==d&&(e.h-=e.reportHeaderHeight,s+=e.reportHeaderHeight),e.y=s,l=!0,t}const r=this._itemsView,n=r.childCount;if(n<1)return;const o=s.pages,a=e.pageWidth,A=r.gap;let l,h,d=0;for(e.h=0;d<n;){l=!1,e.h<=0&&(h=i());const s=d<n-1;let c,u,p=r.getChild(d++);if(p.printable){if(p instanceof Mi&&p.model.isBreakBefore()&&(h=i()),p instanceof zi||p instanceof tl){let i=e.y;const r=[];p instanceof zi?p.printBand(t,e,a,r):p.printGroup(t,e,r);for(let t=0;t<r.length;t++)t>0&&(o.push(h=[]),i=e.bodyTop),c=r[t],c.style.top=i+"px",c.$_h=e.y-i+(s&&t===r.length-1?A:0),h.push(c);e.h-=A}else if(p instanceof pl){let i=e.y;const r=[];p.printBand(t,e,a,r);for(let t=0;t<r.length;t++)t>0&&(o.push(h=[]),i=e.bodyTop),c=r[t],c.style.top=i+"px",c.$_h=e.y-i+(s&&t===r.length-1?A:0),h.push(c);e.h-=A}else u=p.height,u>e.h&&p instanceof zA&&(u=e.h),c=p._dom,p instanceof Mi&&p.floating?(h.push(c),p=null):u<=e.h?(c.style.top=e.y+"px",c.$_h=u+=s?A:0,h.push(c),e.h-=u,e.y+=u):l?(c.style.top=e.y+"px",c.$_h=u+=s?A:0,h.push(c),e.h=0):(e.h=0,d--,p=null);p instanceof Mi&&p.model.isBreakAfter()&&d<n&&(h=i())}else p.visible=!1}e.h<e.reportFooterHeight&&i()}$_prepareAsync(t,e){const s=this._itemsView,i=s.childCount;if(i<1)return[];const r=[];let n=0;for(;n<i;){let o=s.getChild(n++);o.printable?(o instanceof Mi&&o.model.isBreakBefore()&&r.push(new Xi),o instanceof zi||o instanceof tl||o instanceof pl?r.push(o.prepareAsync(t,e,e.pageWidth,null,-1)):(o.dom.$_h=o.height,r.push(o.dom)),o instanceof Mi&&o.model.isBreakAfter()&&n<i&&r.push(new Xi)):o.visible=!1}return r}}class fl extends Mi{get guardLabel(){return"[page]"}}class ml extends tt{constructor(t){super(t,"pageView"),this.addChild(this._backView=new JA(t,null,"rr-back-container",!1)),this.addChild(this._reportHeaderView=new VA(t)),this.addChild(this._reportFooterView=new GA(t)),this.addChild(this._pageHeaderView=new KA(t)),this.addChild(this._pageFooterView=new WA(t)),this.addChild(this._bodyView=new gl(t)),this.addChild(this._frontView=new JA(t,null,"rr-front-container",!1)),this._sections=[this._pageHeaderView,this._reportHeaderView,this._bodyView,this._reportFooterView,this._pageFooterView],this._sectionGuard=new fl(t)}_doDispose(){super._doDispose()}get model(){return this._model}get reportHeaderView(){return this._reportHeaderView}get reportFooterView(){return this._reportFooterView}get pageHeaderView(){return this._pageHeaderView}get pageFooterView(){return this._pageFooterView}get bodyView(){return this._bodyView}get backFloatingView(){return this._backView}get frontFloatingView(){return this._frontView}get sections(){return this._sections}isPageDom(t){return this.isDom(t)||this.bodyView.isPageDom(t)}measure(t,e){const s=e.width-2,i=e.height-2;let r=0;this._sectionGuard.model=this._model,this._model.clearStyles(this.dom.style),Xe(this._model,this._model.styles,this.dom.style);let n=this._backView;n.measureFixed=!0,n.measure(t,s,i),n.setBounds(0,0,s,i);const o=this._pageHeaderView.model;let a=this._pageHeaderView,A=a.setFixedSize(s).measure(t,s,i);r+=J.toNumber(o.spaceTop),a.setBounds(0,r,s,A.height),r+=A.height+J.toNumber(o.spaceBottom);const l=this._reportHeaderView.model;a=this._reportHeaderView,A=a.setFixedSize(s).measure(t,s,i),r+=J.toNumber(l.spaceTop),a.setBounds(0,r,s,A.height),r+=A.height+J.toNumber(l.spaceBottom);let h=i;const d=this._pageFooterView.model;a=this._pageFooterView,A=a.setFixedSize(s).measure(t,s,i),h-=A.height-J.toNumber(d.spaceBottom),a.setBounds(0,h,s,A.height),h-=J.toNumber(d.spaceTop);const c=this._reportFooterView.model;a=this._reportFooterView,A=a.setFixedSize(s).measure(t,s,i),h-=A.height-J.toNumber(c.spaceBottom),a.setBounds(0,h,s,A.height),h-=J.toNumber(c.spaceTop);const u=this._bodyView;A=u.measure(t,s,h-r),u.setBounds(0,r,s,A.height);const p=A.height-(h-r);p>0&&(this.pageFooterView.y+=p,this._reportFooterView.y+=p),n=this._frontView,n.setFixedSize(s).measure(t,s,i),n.setBounds(0,0,s,i);return{width:s,height:this._pageHeaderView.measuredHeight+this._reportHeaderView.measuredHeight+this._bodyView.measuredHeight+this._pageFooterView.measuredHeight+this._reportFooterView.measuredHeight}}layout(t,e){let s=this._pageHeaderView;s.layoutContent(t),s=this._reportHeaderView,s.layoutContent(t),s=this._reportFooterView,s.layoutContent(t),s=this._pageFooterView,s.layoutContent(t),this._bodyView.layoutContent(t),this._backView.layoutContent(t),this._frontView.layoutContent(t)}layoutFloating(t){this._pageHeaderView.layoutFloating(t),this._reportHeaderView.layoutFloating(t),this._reportFooterView.layoutFloating(t),this._pageFooterView.layoutFloating(t),this._bodyView.layoutFloating(t),this._backView.layoutFloating(t),this._frontView.layoutFloating(t)}afterRender(t){const e=this._backView.width,s=this._backView.height;this._backView.measure(t,e,s),this._backView.layoutContent(t),this._frontView.measure(t,e,s),this._frontView.layoutContent(t)}findElement(t){return this._bodyView.findElement(t)||this._backView.findElement(t)||this._frontView.findElement(t)||this._pageHeaderView.findElement(t)||this._pageFooterView.findElement(t)||this._reportHeaderView.findElement(t)||this._reportFooterView.findElement(t)}findElementOf(t){return this._pageHeaderView.findElementOf(t)||this._pageFooterView.findElementOf(t)||this._reportHeaderView.findElementOf(t)||this._reportFooterView.findElementOf(t)||this._bodyView.findElementOf(t)||this._backView.findElementOf(t)||this._frontView.findElementOf(t)}getElementOf(t){if(t===this._bodyView.model)return this._bodyView;for(let e of this._sections)if(e instanceof Mi&&e.model===t)return e;return this._bodyView.getElementOf(t)||this._backView.getElementOf(t)||this._frontView.getElementOf(t)||this._pageHeaderView.getElementOf(t)||this._pageFooterView.getElementOf(t)||this._reportHeaderView.getElementOf(t)||this._reportFooterView.getElementOf(t)}getAllElements(t,e){function s(t,e){(t instanceof sl?t.cellViews:t.elements).forEach((t=>{t instanceof el?t.getChild(0)instanceof Mi&&e.push(t.getChild(0)):t instanceof ki?s(t,e):t instanceof Mi&&e.push(t)}))}const i=[];t?(e.translate(-t.dom.offsetLeft,-t.dom.offsetTop),s(t,i),e.translate(t.dom.offsetLeft,t.dom.offsetTop)):this.sections.forEach((t=>{e.translate(-t.dom.offsetLeft,-t.dom.offsetTop),s(t,i),e.translate(t.dom.offsetLeft,t.dom.offsetTop)}));const r=this.getBoundingRect();return e.translate(r.x,r.y),i.filter((t=>{const s=t.getBoundingRect();return e.intersects(s)}))}prepareAsync(t,e){const s=this.dom,i=this.width;this._model.clearStyles(s.style),Xe(this._model,this._model.styles,s.style),this.setPrintStyles(),this._backView.setBounds(0,0,i,this.height),this._backView.print(t,e,i),this._frontView.setBounds(0,0,i,this.height),this._frontView.print(t,e,i),[[this._pageHeaderView,"header"],[this._pageFooterView,"footer"],[this._reportHeaderView,"reportHeader"],[this._reportFooterView,"reportFooter"]].forEach((s=>{!function(s,r){const n=s.model;n.visible?e[r+"Height"]=s.$_h=s.print(t,e,i)+J.toNumber(n.spaceTop)+J.toNumber(n.spaceBottom):e[r+"Height"]=s.$_h=0}(s[0],s[1])})),e.bodyTop=e.headerHeight,e.bodyBottom=e.pageHeight-e.footerHeight,e.bodyHeight=e.bodyBottom-e.bodyTop,e.pages=[];return this._bodyView.prepareAsync(t,e)}refreshPageHeader(t,e){this.pageHeaderView.print(t,e,this.width);return this._pageHeaderView.cloneNode()}getSections(){let t=[this._sectionGuard];return this._pageHeaderView.visible&&t.push(this._pageHeaderView),this._reportHeaderView.visible&&t.push(this._reportHeaderView),t=t.concat(this._bodyView.getLines()),this._reportFooterView.visible&&t.push(this._reportFooterView),this._pageFooterView.visible&&t.push(this._pageFooterView),t}isLine(t){return t instanceof kA||this._bodyView.isLine(t)}getFirst(){if(this._pageHeaderView.visible)return this._pageHeaderView.getFirst()}getLast(){if(this._pageFooterView.visible)return this._pageFooterView.getLast()}getFirstInGroup(t){return null==t?void 0:t.getFirst()}getLastInGroup(t){return null==t?void 0:t.getLast()}getPrev(t){var e;if(t instanceof kA);else if(t){let s=null===(e=t.navigableParent)||void 0===e?void 0:e.getPrev(t);if(s&&s!==t)return s}}getNext(t){if(t instanceof kA);else if(t){let e=t.navigableParent;if(e){let s=e.getNext(t);if(s&&s!==t)return s;for(e=e.navigableParent;e;)e.getLeaves(),e=e.navigableParent}}}getLeft(t){var e;if(t instanceof kA);else if(t){let s=null===(e=t.navigableParent)||void 0===e?void 0:e.getLeft(t);if(s&&s!==t)return s;if(this._bodyView.isLine(t))return}}getRight(t){var e;if(t instanceof kA);else if(t){let s=null===(e=t.navigableParent)||void 0===e?void 0:e.getRight(t);if(s&&s!==t)return s;if(this._bodyView.isLine(t))return}}getUpper(t){var e;if(t instanceof kA){const e=this._sections.indexOf(t);if(e>0){const t=this._sections[e-1];return t instanceof Mi?t:this._bodyView.getLine(-1)}}else if(t){let s=null===(e=t.navigableParent)||void 0===e?void 0:e.getUpper(t);if(s&&s!==t)return s;if(t.navigableParent===this._reportHeaderView)return this._pageHeaderView;if(s=this._bodyView.getLineOf(t),s&&(s=this._bodyView.getSiblingLine(s,-1),s))return s}return this.getFirst()}getLower(t){var e;if(t instanceof kA){const e=this._sections.indexOf(t);if(e<this._sections.length-1){const t=this._sections[e+1];return t instanceof Mi?t:this._bodyView.getLine(0)}}else if(t){let s=null===(e=t.navigableParent)||void 0===e?void 0:e.getLower(t);if(s&&s!==t)return s;if(t.navigableParent===this._pageHeaderView)return this._reportHeaderView;if(t.navigableParent===this._reportHeaderView)return this._bodyView.getLine(0);if(s=this._bodyView.getLineOf(t),s)return s=this._bodyView.getSiblingLine(s,1),s||(s=this._reportFooterView,s.visible?s:(s=this._pageFooterView,s.visible?s:void 0))}return this.getFirst()}itemOfDom(t){let e;if(e=this._frontView.itemOfDom(t))return e;for(let s of this._sections)if(s instanceof ki&&(e=s.itemOfDom(t)))return e;return(e=this._bodyView.itemOfDom(t))||(e=this._backView.itemOfDom(t))?e:void 0}_getCssSelector(){return this.container.printing?"":"rr-page"}$_setModel(t){this._model=t,t?(this._reportHeaderView.model=t.reportHeader,this._reportFooterView.model=t.reportFooter,this._pageHeaderView.model=t.pageHeader,this._pageFooterView.model=t.pageFooter,this._bodyView.model=t.body,this._backView.model=t._backItems,this._frontView.model=t._frontItems):(this._reportHeaderView.model=null,this._reportFooterView.model=null,this._pageHeaderView.model=null,this._pageFooterView.model=null,this._bodyView.model=null,this._backView.model=null,this._frontView.model=null)}}class wl{constructor(){this.contents=[]}}class yl{constructor(t){this.$_parse(this._format=t)}static getFormatter(t){let e=yl.Formatters[t];return e||(yl.Formatters[t]=e=new yl(t)),e}get format(){return this._format}getText(t){return void 0===t?this._nullText:t?this._trueText:this._falseText}$_parse(t){if(this._falseText=this._trueText=null,t){var e=t.split(/[;\:]/);this._falseText=e[0],e.length>0&&(this._trueText=e[1]),e.length>1&&(this._nullText=e[2])}}}yl.Formatters={};const Cl=/(.*)/;class bl{constructor(t){this._pattern=Cl,this._replace="$1",this.$_parse(this._format=t)}static getFormatter(t){let e=bl.Formatters[t];return e||(bl.Formatters[t]=e=new bl(t)),e}get format(){return this._format}getText(t){return t&&t.replace(this._pattern,this._replace)}$_parse(t){if(t){const e=t.trim().split(J.colonreg);if(e.length>1){let t=e[0].trim(),s=e[1].trim();t&&s&&('"'==t.charAt(0)&&(t=t.substr(1,t.length-2)),t&&('"'==s.charAt(0)&&(s=t.substr(1,s.length-2)),s&&(this._pattern=new RegExp(t,e[2]||""),this._replace=s)))}}}}bl.Formatters={};class vl extends Mi{constructor(t,e,s){super(t,e,s)}_doDispose(){super._doDispose()}get debugLabel(){return""}_initDom(t,e){super._initDom(t,e),e.style.overflow="hidden",this._span=t.createElement("span"),this._span.style.display="table-cell",e.appendChild(this._span)}_doPrepareMeasure(t,e){super._doPrepareMeasure(t,e),t.contextable&&this.model.isContextValue()&&(t.contextValues.push(this),this._span.dataset.rr_ctx_val=this.model.value),t.printing&&(this._span.dataset._m_=e.dataset._m_||String(this.model.hash),this._span.classList.add(Bl.SPAN))}_doMeasure(t,e,s,i){const r=this.model,n=this._span,o=e.style;let a;if(e.style.display="inline-table",a=r.getStyle("verticalAlign"),!a){const t=r.getStyle("writingMode");t&&t.startsWith("vertical")||(a="middle")}if(this._span.style.verticalAlign=a,this._span.style.textDecoration=r.getStyle("textDecoration"),e.style.width="",e.style.height="",this._setModelSize(r,e,s,i),o.whiteSpace=r.wrap&&r.width?"pre-wrap":"pre",o.wordBreak=r.wrap&&r.width?"break-all":"keep-all",t.printing)a=this._getPrintText(t,r),this._setBindMarker(!1);else{const t=r.value,e=t&&t.startsWith("${");a=this._getDesignText(r,e),t?this._setBindMarker(!0,e):this._setBindMarker(!1)}if(this._text=a=a||"",r.multiLine){const t=/(\r|\n|\r\n|\<br\>|\<br\/\>)/gm;n.innerHTML=a.replace(t,"<br/>")}else n.textContent=a;t.printing&&!a&&(n.innerHTML=$),!t.printing&&a&&(e.title=a);let A=this._modelWidth,l=this._modelHeight;return isNaN(A)?(n.style.maxWidth="",A=e.offsetWidth,"italic"===r.getStyle("fontStyle")&&(A+=Math.max(1,.04*n.offsetWidth)),A=Math.ceil(A)+1):n.style.maxWidth=A+"px",isNaN(l)&&(n.style.maxHeight="",l=Math.round(e.offsetHeight)),new Me(A,l)}_doLayoutContent(t){}refreshPrintValues(t){this._span.textContent=this._getPrintText(t,this.model)}isDom(t){return t===this._span||super.isDom(t)}_getText(t,e){const s=typeof e;let i=e;if("string"===s){if(e){const s=t.textFormat;if(s){const t=bl.getFormatter(s);t&&(i=t.getText(e))}}}else if("number"===s){const s=t.numberFormat;if(s){const t=al.getFormatter(s);t&&(i=t.getText(e))}}else if(e instanceof Date){const s=t.dateFormat;if(s){const t=Ht.getFormatter(s);t&&(i=t.getText(e))}}else if("boolean"===s){const s=t.booleanFormat;if(s){const t=yl.getFormatter(s);t&&(i=t.getText(e))}}return J.isDefined(i)&&""!==i?t.prefix||t.suffix?(t.prefix||"")+i+(t.suffix||""):String(i):i}}vl.CLASS_NAME="rr-text",vl.CLASS_LIST=vl.CLASS_NAME+" rr-item-element",vl.SPAN="_rr_span_";class Bl extends vl{constructor(t,e){super(t,e,"textItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return vl.CLASS_LIST}get guardLabel(){return"text"}get editable(){return!0}getEditText(){return this.model.text}setEditText(t,e){t.setItemProperty(this.model,"text",e)}_getPrintText(t,e){const s=e.contextValueCallback;if(s){t.contextElements&&(this._span.dataset.rr_ctx_call=t.page+"",this._span.dataset.rr_ctx_all_call=t.compositePage+"",this._span.dataset.rr_ctx_view=this.shash,t.contextElements[this.shash]=this);const i=s(t);return this._getText(e,i)}if(e.value){const s=this.getPrintValue(t,e);return this._getText(e,s)}{const s=this._runValueCallback(t,e,void 0);return void 0!==s?this._getText(e,s):e.text}}_getDesignText(t,e){return t.value?e?t.value:"["+t.value+"]":t.text||"[text]"}_doMeasure(t,e,s,i){const r=this.model;if(!t.printing){r.value||r.text?delete e.dataset.empty:e.dataset.empty=""}return super._doMeasure(t,e,s,i)}isDom(t){return!!super.isDom(t)||this._spans&&this._spans.indexOf(t)>=0}}class El extends Mi{constructor(t,e){super(t,e,"imageItemView")}get debugLabel(){return"image"}_getCssSelector(){return"rr-image rr-item-element"}_doMeasure(t,e,s,i){const r=this.model,n=r.image&&t.assets.getImage(r.image),o=e.style;let a=n||r.url;return t.printing&&!this._image&&(this._image=new Image),t.printing&&!a&&(a=this.getPrintValue(t,r)),this._setModelSize(r,e,s,i),a?(o.overflow=o.overflow||"hidden",o.backgroundImage="url("+a+")",o.backgroundRepeat="no-repeat",o.backgroundSize=r.imageFit,o.backgroundPosition=r.imagePosition,o["-webkit-print-color-adjust"]="exact",delete e.dataset.empty,e.innerHTML="",this._image&&(this._image.src=a)):(e.dataset.empty="true",e.innerHTML="<span></span>"),new Me(e.offsetWidth,e.offsetHeight)}}class Pl extends Mi{constructor(t,e){super(t,e,"checkItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-check rr-item-element"}get debugLabel(){return""}isDom(t){return t===this._check||t===this._text||t===this._text.parentElement||super.isDom(t)}_initDom(t,e){super._initDom(t,e),e.style.overflow="hidden",e.style.whiteSpace="nowrap";const s=t.createElement("div");s.style.display="table-cell",s.style.verticalAlign="middle",e.appendChild(s),this._check=t.createElement("span"),this._check.className=Pl.CHECK_CLASS,this._check.style.display="inline-block",this._check.style.verticalAlign="middle",s.appendChild(this._check),this._text=t.createElement("span"),this._text.className=Pl.TEXT_CLASS,s.appendChild(this._text)}_doMeasure(t,e,s,i){const r=this.model,n=t.printing?J.pick(this.getPrintValue(t,r),r.checked):r.checked,o=this._check,a=this._text;this._setModelSize(r,e,s,i,!0),o.dataset.checked=r.getChecked(n),a.textContent=r.getText(n);let A=Math.ceil(Math.max(o.offsetHeight,a.offsetHeight)),l=Math.ceil(o.offsetWidth)+Math.ceil(a.offsetWidth)+1;return"italic"===r.getStyle("fontStyle")&&(l+=Math.max(1,.04*a.offsetWidth)),l=Math.ceil(l),t.printing&&(this._check.dataset._m_=e.dataset._m_),Me.create(l,A)}}Pl.CHECK_CLASS="rr-check-check",Pl.TEXT_CLASS="rr-check-text";class xl extends ki{constructor(t,e,s){super(t,s,"listCellView"),this._list=e}_doDispose(){super._doDispose()}get debugLabel(){return""}get navigable(){return!1}get navigableParent(){return this._list}_needContentBox(){return!1}_isEmptySize(){return!0}_getParentDom(){return this._div}_createDom(t){const e=t.createElement("li"),s=this._div=t.createElement("div");return e.appendChild(s),s.className="rr-list-cell",s.style.position="relative",s.style.display="inline-flex",s.style.verticalAlign="text-top",e}_prepareChild(t){t._dom.style.position="relative",t.positionable=!1}_doMeasure(t,e,s,i){return super._doMeasure(t,e,s,i)}}class Sl extends ki{constructor(t,e){super(t,e,(e&&e.ordered?"o":"u")+"listContainerView")}_doDispose(){super._doDispose()}get debugLabel(){return"list"}_getCssSelector(){return"rr-list-container rr-group-element"}_needDesignBox(){return!0}_needContentBox(){return!1}_getParentDom(){return this._list}_createDom(t){const e=super._createDom(t);e.style.overflow="hidden";const s=this._list=t.createElement(this.name.startsWith("o")?"ol":"ul");return e.appendChild(s),e}_initDom(t,e){super._initDom(t,e);const s=this._list.style;s.marginBlockStart="0",s.marginBlockEnd="0"}_createElement(t,e,s){const i=new xl(this.doc,this,s);if(s.item instanceof Zo){i.dom.style.listStyleType="none"}return this._prepareChild(i),e.addChild(i),i}_prepareChild(t){t._dom.style.position="relative",t.positionable=!1}_doMeasure(t,e,s,i){const r=this.model;this.measureFixed?(e.style.width="",e.style.height=""):this._setModelSize(r,e,s,i,!0);const n=this._list;switch(r.marker){case zo.CIRCLE:case zo.DISC:case zo.SQUARE:n instanceof HTMLUListElement&&(n.style.listStyleType=r.marker);break;case zo.DECIMAL:case zo.LOWER_ROMAN:case zo.UPPER_ROMAN:case zo.LOWER_ALPHA:case zo.UPPER_ALPHA:n instanceof HTMLOListElement&&(n.style.listStyleType=r.marker);break;case zo.NONE:n.style.listStyleType=r.marker}return n instanceof HTMLOListElement&&r.start&&(n.start=r.start),void 0!==r.indent&&(n.style.paddingInlineStart=r.indent+"px"),super._doMeasure(t,e,s,i)}_doAfterMeasure(t,e,s,i,r){this.childCount>0?this._applyBorders(e,r):t.printing||(!this.model.height&&this.model.designHeight>0&&(r.height=this.model.designHeight),!this.model.width&&this.model.designWidth>0&&(r.width=this.model.designWidth)),super._doAfterMeasure(t,e,s,i,r)}_doLayout(t){}getLower(t){for(let e=0,s=this.childCount;e<s;e++)if(this.getChild(e).firstChild===t&&e<s-1)return this.getChild(e+1).firstChild}getUpper(t){for(let e=0,s=this.childCount;e<s;e++)if(this.getChild(e).firstChild===t&&e>0)return this.getChild(e-1).firstChild}}class Il extends el{constructor(t,e,s){super(t,e,s,"tableCellView")}_getCssSelector(){return"rr-table-cell"}}class Rl extends sl{constructor(t,e){super(t,e,"tableContainerView")}get columns(){return this.model.columns}get colCount(){return this.model.colCount}getColumn(t){return this.model.getColumn(t)}_getCssSelector(){return"rr-table-container rr-group-element"}_createCellElement(t,e){return new Il(t,this,e)}_prepareCellStyles(t,e,s,i,r){if(super._prepareCellStyles(t,e,s,i,r),t.printing){const n=e.getCell(s,i),o=n.styleCallback;if(o)try{const e=o(t,n,t.row);e&&J.extend(r.style,e)}catch(t){console.error("CellStyleCallback Error",t)}}}}class Tl extends ki{constructor(t,e){super(t,e,"bandCollectionView")}_doDispose(){super._doDispose()}get debugLabel(){return""}_getCssSelector(){return"rr-band-collection rr-group-element"}_needDesignBox(){return!0}_initDom(t,e){super._initDom(t,e)}_doMeasure(t,e,s,i){const r=super._doMeasure(t,e,s,i);r.height=0;for(let t=0;t<this.childCount;t++)r.height+=this.getChild(t).measuredHeight;return r}_doAfterMeasure(t,e,s,i,r){this.childCount>0?this._applyBorders(e,r):t.printing||(!this.model.height&&this.model.designHeight>0&&(r.height=this.model.designHeight),!this.model.width&&this.model.designWidth>0&&(r.width=this.model.designWidth)),super._doAfterMeasure(t,e,s,i,r)}_doLayoutContent(t){super._doLayoutContent(t);const e=this,s=e.width;let i=0;for(let t=0,r=e.childCount;t<r;t++){const r=e.getChild(t);r.floating||(r.y=i,r.x=0+(s-r.width)/2,i+=r.height,i+=0,r.setPrintStyles())}}}class Ol extends UA{constructor(t,e,s,i){super(t,e,s),this.styleName=i}_doDispose(){super._doDispose()}get debugLabel(){return""}_getCssSelector(){return this.styleName+" rr-group-element"}_needDesignBox(){return!0}_doAfterMeasure(t,e,s,i,r){this.childCount>0||t.printing||(!this.model.height&&this.model.designHeight>0&&(r.height=this.model.designHeight),!this.model.width&&this.model.designWidth>0&&(r.width=this.model.designWidth)),super._doAfterMeasure(t,e,s,i,r)}}class Fl extends UA{constructor(t,e,s){super(t,e,s)}applyGroupStyles(t){J.extend(t.style,this.model.styles)}_needDesignBox(){return!0}_doMeasure(t,e,s,i){const r=super._doMeasure(t,e,s,i);return r.width=s,r.height=Math.max(24,r.height),r}_doAfterMeasure(t,e,s,i,r){this.childCount>0?this._applyBorders(e,r):t.printing||(!this.model.height&&this.model.designHeight>0&&(r.height=Math.max(r.height,this.model.designHeight)),!this.model.width&&this.model.designWidth>0&&(r.width=Math.max(r.width,this.model.designWidth))),super._doAfterMeasure(t,e,s,i,r)}}class Dl extends Fl{constructor(t,e){super(t,e,"simpleBandGroupHeader")}_getCssSelector(){return"rr-simpleband-group-header  rr-group-element"}measure(t,e,s){return super.measure(t,e,s)}}class Ll extends Fl{constructor(t,e){super(t,e,"simpleBandGroupFooter")}_getCssSelector(){return"rr-simpleband-group-footer  rr-group-element"}}class Nl extends ki{constructor(t,e){super(t,e,"simpleBandGroupView")}_doDispose(){super._doDispose()}get header(){return this._header}get footer(){return this._footer}_getCssSelector(){return"rr-simpleband-group rr-group-element"}_needDesignBox(){return!0}_doMeasure(t,e,s,i){super._doMeasure(t,e,s,i);const r=this.container.focusedItem;this._header=this.getChild(0),this._footer=this.getChild(1),t.printing||this._headerHead||(this._headerHead=new Je(this.doc,this.model.header,"GROUP HEADER","SimpleBand Group Header"),this._footerHead=new Je(this.doc,this.model.footer,"GROUP FOOTER","SimpleBand Group FOOTER"),this.addChild(this._headerHead),this.addChild(this._footerHead));let n=this._header.measuredHeight+this._footer.measuredHeight;if(!t.printing){let e=this._headerHead,o=e.measure(t,s,i);e.setSelected(r),n+=o.height+2,e=this._footerHead,o=e.measure(t,s,i),e.setSelected(r),n+=o.height+2}return Me.create(Math.max(this._header.measuredWidth,this._footer.measuredWidth),n)}_doLayoutContent(t){if(super._doLayoutContent(t),!t.printing){let t=0,e=this._headerHead;e.applyMeasure(),e.x=0,e.y=t+2,t+=e.height+2,this._header.y=t,t+=this._header.height,e=this._footerHead,e.applyMeasure(),e.x=0,e.y=t+2,t+=e.height+2,this._footer.y=t}}}class Hl extends ji{isEnded(){return 0===this.rows.length}getRows(){return this.rows}getNextPage(t,e,s,i){function r(){n.rpp=p,n.erc=g>0?g:NaN}const n=this,o=this.bandView.model,a=o.bandLevel,A=this.rows,l=this.footerView,h=e.h,{endRowCount:d,stopEndRow:c}=o.getEndRowCount(0),u=!o.prevHead&&(isNaN(o.rowIndex)||0===a&&!(A[0]instanceof ji)||a>0&&o.repeatDetailHeader);let p,_=e.h,g=this.erc;if(isNaN(g)&&(g=d||0),o.maxRowCount>0&&this.setMaxCount(A,o.maxRowCount),u||A.length>0||g>0){const n=o.sectionCount;if(n>1){const r=this.ptsBand,a=this._createPage(t,i);let A;if(s=r[1]-r[0],A=o.sectionLayout==Li.ACROSS_DOWN?this.$_getAcrossPages(t,e,n,s,a):this.$_getDownPages(t,e,n,s,a),A.length>=n)for(let t=0;t<n;t++)this._setX(A[t],r[2*t]);return a.$_h=A.$_h,a}const{rowsPerPage:d,breakRowsPerPage:f}=o.getRowsPerPage();let m,w,y,C=0,b=0;const v=this._createPage(t,i);if(p=this.rpp,(isNaN(p)||!f||p<=0)&&(p=d),u&&(isNaN(o.rowIndex)||0===a&&!(A[0]instanceof ji)||a>0&&o.repeatDetailHeader)&&(y=this.$_addHeader(v),_-=y,C+=y,o.prevHead=!0),_>0&&this.prevGroup&&A.length>0&&(this.isRow(A[0])||!this.isGroupHeader(A[0]))){const t=this.prevGroup.cloneNode(!0);v.appendChild(t),t.style.top=C+"px",y=t.offsetHeight,y<=_?(_-=y,C+=y,o.prevHead=!1):(v.removeChild(t),_=0)}for(isNaN(o.rowIndex)&&(o.rowIndex=0);_>0&&A.length>0;){const r=A.shift();if(p<=0&&!(r instanceof ji)){A.unshift(r),e.h=0;break}let n;if("number"==typeof r)n=this.bandView.printRow(e,r),n&&(y=n.$_h,w=r,isNaN(m)?m=r:r>m&&Ql.checkBlanks(o,r,n));else if(r instanceof ji){const o=e.index;e.h=_,n=r.getNextPage(t,e,s,i),e.index=o,e.h=h,y=n.$_h}else{if(this.isGroupFooter(r)&&this.prevRow)n=this.prevRow;else{const t=this.$_addGroup(e,o,r,s);n=t.div,n.$_h=t.height}y=n.$_h}if(!(_>=y)){A.unshift(r),n&&this.isGroupFooter(r)&&(this.prevRow=n);break}if(n&&(v.appendChild(n),n.style.top=C+"px"),_-=y,C+=y,"number"==typeof r)o.rowIndex++,e.index++,p--,b++;else if(r instanceof ji){if(0!==r.getRows().length||!isNaN(r.erc)){r.band.prevIndex=e.index,A.unshift(r),o.repeatMasterRow&&(A.unshift(w),this.rpp=NaN,o.rowIndex--),e.h=0;break}r.band.rowIndex=NaN,r.band.prevIndex=0}o.prevHead=!1}if(0===A.length){for(g-=b;_>0&&g>0;){let t=this.endMessageView;t&&(v.appendChild(t),t.$_h=t.offsetHeight);const e=(this.endMessageView||this.endRowView).$_h;if(!(_>e)){this.endMessageView&&this.endMessageView.remove();break}t=t||this.endRowView.cloneNode(!0),t.style.top=C+"px",t.$_brt=Gi,!this.endMessageView&&v.append(t),_-=e,C+=e,g--,this.endMessageView=null}c&&(g=0),0==g?l&&(y=l.height,_>=y&&(this.$_addFooter(e,v,this.wBand,C),_-=y)):e.h=0}else if(a>0&&o.repeatDetailFooter){if(l){const t=_,s=[];for(y=l.height;_<y;){const t=v.lastElementChild;if(!t||!t.classList.contains(Ql.ROW_CLASS))break;_+=t.offsetHeight,t.remove(),A.unshift(--w),s.push({div:t,row:w}),e.index--,o.rowIndex--}if(_>=y)C-=_-t,this.$_addFooter(e,v,this.wBand,C),this.footerView=l,_-=y;else for(;s.length>0;){const{div:t,row:i}=s.pop();A.push(i),v.appendChild(t),_-=t.offsetHeight,e.index++}}}else e.h=0;return v.$_h=h-_,r(),v}if(l){const s=t.createElement("div");return _-=this.$_addFooter(e,s,this.wBand,0),s.$_h=h-_,r(),s}return null}$_addHeader(t){if(this.headerView){const e=this.headerView.height,s=this.headerView.dom.cloneNode(!0);return t.appendChild(s),e}return 0}$_addFooter(t,e,s,i){const r=this.band,n=this.footerView;r.bandLevel>0&&(r.clearSummary(),t.bandSummaryRuntime=r.summaryRuntime.setRows(this.detailRows,this.masterRow).setRowCount(this.detailRows.length),n.measure(t,s,t.pageHeight),n.resize(n.measuredWidth,n.measuredHeight),n.setPrintStyles(),n.layoutContent(t));const o=n.dom.cloneNode(!0);return o.style.top=i+"px",e.appendChild(o),this.footerView=void 0,n.height}$_addGroup(t,e,s,i){const r=s.view,n=r.dom,o=n.cloneNode(!1);e.summaryRuntime.setRows(null,-1),o.$_brt=s.rowType,t.bandSummaryRuntime=e.summaryRuntime,t.bandSummaryRuntime.setGroup(s.group),e.setPrinting(t,s.row),r.replaceDom(o),r._modelChanged=!0,r.measure(t,i,t.pageHeight),r.resize(r.measuredWidth,r.measuredHeight),r.setPrintStyles(),r.layoutContent(t);const a=r.height;return r.replaceDom(n),s.rowType===Ki&&(this.prevGroup=o),{div:o,height:a}}$_getAcrossPages(t,e,s,i,r){const n=this.rows,o=[];if(n.length>0){const i=this.bandView.model,a=this.footerView,A=e.h;let l=e.h;const h=[];let d=0,c=0;for(let e=0;e<s;e++)o.push(this._createPage(t,r)),c=Math.max(c,this.$_addHeader(o[e])),h.push(c);for(l-=c,d+=c;l>0&&n.length>0;){let t=[],i=0;for(let r=0;r<s&&n.length>r;r++){const s=n[r],o=this.bandView.printRow(e,s);o&&(t.push(o),i=Math.max(i,o.$_h),h[r]+=i)}if(!(l>=i)){e.h=0;break}for(let e=0;e<t.length;e++)o[e].appendChild(t[e]),t[e].style.top=d+"px";l-=i,d+=i,e.index+=t.length,n.splice(0,t.length)}if(0===n.length){if(a){const t=a.height;if(l>=t){const s=o.length-1,r=i.footer.attachToBody;d=r?h[s]:d,this.$_addFooter(e,o[s],this.wBand,d),r?l=A-(d+t):l-=t}}}else e.h=0;o.$_h=A-l}return o}$_getDownPages(t,e,s,i,r){function n(t){let e=A;return t.forEach((t=>{t.style.top=e+"px",e+=t.$_h})),e-A}const o=this.rows,a=[];let A=0;if(o.length>0){const i=this.bandView.model,l=this.footerView,h=e.h;let d=e.h;const c=[],u=[];let p=0,_=0;for(let e=0;e<s;e++)a.push(this._createPage(t,r)),_=A=Math.max(_,this.$_addHeader(a[e])),c.push(0),u.push([]);d-=_,p+=_;const g=p,f=d;for(let t=0;t<s&&o.length>0;t++){const i=a[t];for(;d>0&&o.length>0;){const s=o.shift(),r=this.bandView.printRow(e,s);if(r){if(_=r.$_h,!(d>=_)){o.unshift(s);break}i.appendChild(r),u[t].push(r),d-=_,c[t]+=_,r.style.top=p+"px",p+=_,e.index++}}t<s-1&&(p=g,d=f)}if(0===o.length){const t=c.reduce(((t,e)=>t+e)),e=Math.round(t/s);for(let t=0;t<s-1;t++){const s=u[t];let i,r=0,o=0;for(;o<s.length;){if(r+=i=s[o].$_h,r>e){o--,r-=i;break}o++}c[t]=r;const A=a[t+1],l=u[t+1];for(;s.length>o;){const t=s.pop();A.insertBefore(t,l[0]),l.unshift(t)}c[t+1]=n(l)}for(let t=0;t<2;t++)(()=>{for(let t=s-1;t>0;t--)for(;c[t]>c[t-1];){const e=a[t-1],s=u[t-1],i=u[t],r=i.shift();s.push(r),e.appendChild(r),c[t-1]=n(s),c[t]=n(i)}})()}if(0===o.length){let t=0;if(l&&(t=l.height,d>=t)){const s=a.length-1,r=i.footer.attachToBody;p=r?c[s]+A:p,this.$_addFooter(e,a[s],this.wBand,p),r&&(c[s]+=t,t=0)}const s=c.reduce(((t,e)=>Math.max(t,e)));a.$_h=A+s+t}else a.$_h=h-d,e.h=0}return a}}class Ql extends zi{constructor(t,e){super(t,e,"simpleBandView"),this._groupViews=[],this._colSpans=[],this._grouped=!1,this._masterRow=-1,this._printedRows=NaN,this.addChild(this._headerView=new Ol(t,e&&e.header,"bandHeaderView",Ql.HEADER_CLASS)),this.addChild(this._footerView=new Ol(t,e&&e.footer,"bandFooterView",Ql.FOOTER_CLASS)),this.addChild(this._rowView=new Ol(t,e&&e.dataRow,"bandRowTemplateView",Ql.ROW_CLASS)),this.addChild(this._detailView=new Tl(t,e&&e.detail)),this._rowContainer=t.createElement("div"),this._dom.appendChild(this._rowContainer)}static isRow(t){return t.classList.contains(Ql.ROW_CLASS)&&t.$_brt===Vi}static checkBlanks(t,e,s){const i=t.dataRow.blankItems;i&&i.forEach((i=>{if(t.dataRow.canBlank(i,e)){const t=s.children;for(let e=t.length-1;e>=0;e--){const r=t[e];if(r.dataset._m_===i.shash){s.removeChild(r);break}}}}))}_doDispose(){super._doDispose()}printBand(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1;const o=this.model,a=o.dataObj,A=o.getWidth(s),l=o.getLeft(s);let h=l||0;isNaN(A)||(isNaN(l)&&(h=Math.floor((s-A)/2)),s=A);const d=o.sectionCount,c=d<2;let u=this._rowDivs;const p=c?null:o.getColPoints(s,h),_=e.pageHeight;if(r||o.prepareIndices(e),this._masterRow=n,o.dataRow.masterRow=n>=0?n:NaN,o.summaryRuntime.setRows(r,n),p&&(s=p[1]-p[0]),e.band=o,isNaN(this._rowView.measuredHeight)){let t=this._headerView;if((t.visible=t.model.visible)&&(t.measure(e,s,_),t.resize(t.measuredWidth,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e)),t=this._rowView,!u&&((t.visible=t.model.visible)&&(t.measure(e,s,_),t.resize(t.measuredWidth,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e)),c)){e.bandSummaryRuntime=o.summaryRuntime;const i=o.designData,n=this.$_getGroupViews(e,o.groups.getValidGroups(i),s,_);u=this._rowDivs=this.$_printRows(e,a,n,t,s,r)}t=this._footerView,(t.visible=t.model.visible)&&(e.bandSummaryRuntime=o.summaryRuntime,t.measure(e,s,_),t.resize(t.measuredWidth,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e))}else if(!u){let t=this._headerView;if((t.visible=t.model.visible)&&(t.measure(e,s,_),t.resize(t.measuredWidth,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e)),c){e.bandSummaryRuntime=o.summaryRuntime;const t=o.designData,i=this.$_getGroupViews(e,o.groups.getValidGroups(t),s,_);u=this._rowDivs=this.$_printRows(e,a,i,this._rowView,s,r)}t=this._footerView,(t.visible=t.model.visible)&&(e.bandSummaryRuntime=o.summaryRuntime,t.measure(e,s,_),t.resize(t.measuredWidth,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e))}c?this.$_printLinear(t,e,o,a,s,u,i):o.sectionLayout==Li.ACROSS_DOWN?this.$_printAcross(t,e,p,o,d,a,i):this.$_printDown(t,e,p,o,d,a,i),r&&(this._rowDivs=null)}prepareAsync(t,e,s,i,r){function n(i,r){for(let n=0;n<A.count;n++){const a=A.get(n),h=l.getChild(n);a.masterValues=o.getValues(e,i,a._masterFlds),a.detailRows=a.rowsPerMaster;const d=a.getNextDetailRows(e);if(d.length>0){const n=h.prepareAsync(t,e,s,d,i);a._pr+=d.length,n.masterValues=o.getValues(e,i,a._masterFlds),r.push(n)}}}const o=this.model,a=o.bandLevel,A=o.detail&&o.detail.count>0?o.detail:null,l=this._detailView,h=o.dataObj;let d;const c=o.getWidth(s),u=o.getLeft(s);let p=u||0;if(A)for(let t=0;t<A.count;t++){A.get(t)._pr=0}isNaN(c)||(isNaN(u)&&(p=Math.floor((s-c)/2)),s=c);const _=o.sectionCount<2;let g=this._rowDivs;const f=_?null:o.getColPoints(s,p);if(this._masterRow=r,o.dataRow.masterRow=r>=0?r:NaN,o.summaryRuntime.setRows(i,r),f&&(s=f[1]-f[0]),e.band=o,0===a&&o.prepareIndices(e),isNaN(this._rowView.measuredHeight)){const t=e.pageHeight;e.detailRows=i?i.slice(0):void 0;let r=this._headerView;(r.visible=r.model.visible)&&(r.measure(e,s,t),r.resize(r.measuredWidth,r.measuredHeight),r.x=p,r.setPrintStyles(),r.layoutContent(e)),r=this._rowView,g||((r.visible=r.model.visible)&&(r.measure(e,s,t),r.resize(r.measuredWidth,r.measuredHeight),r.x=p,r.setPrintStyles(),r.layoutContent(e)),_&&(d=this.$_getGroupViews(e,o.groups.getValidGroups(o.designData),s,t))),r=this._footerView,(r.visible=r.model.visible)&&(e.bandSummaryRuntime=o.summaryRuntime,r.measure(e,s,t),r.resize(r.measuredWidth,r.measuredHeight),r.x=p,r.setPrintStyles(),r.layoutContent(e))}const m=new Hl;if(m.band=o,m.bandView=this,m.headerView=this._headerView.visible?this._headerView:null,m.footerView=this._footerView.visible?this._footerView:null,m.rowView=this._rowView,m.groupViews=d,m.rows=function(){const t=i?i.length:h?h.rowCount:0,e=[];if(d){const t=d.map((t=>t.visible&&t.model.field)).filter((t=>!!t));h.groupBy(t,i).forEach((t=>{if(J.isNumber(t))e.push(t),A&&n(t,e);else if(t.parent){const s=d[t.level-1];s.header&&s.header.visible&&e.push({view:s.header,row:t.row,rowType:Ki,group:t})}else{const s=d[t.group.level-1];s.footer&&s.footer.visible&&e.push({view:s.footer,row:t.row,rowType:Wi,group:t.group})}}))}else if(i)for(const t of i)e.push(t),A&&n(t,e);else for(let s=0;s<t;s++)e.push(s),A&&n(s,e);return e}()||[],m.xBand=p,m.wBand=s,m.ptsBand=f,m.masterRow=r,m.detailRows=i?i.slice(0):null,!d&&o.getEndRowCount().endRowCount>0){const t=o._pr,s=this.printRow(e,0);s&&(m.endRowView=s,s.classList.add("rr-simpleband-end-row"),J.clearChildren(s),o.endRowMessage&&(m.endMessageView=this.$_addEndRowMessage())),o._pr=t}return m}addMasterRow(t,e,s,i,r){const n=e.cloneNode(!0),o=s.cloneNode(!0);t.appendChild(n),n.style.top=r+"px";const a=n.offsetHeight;return r+=a,t.appendChild(o),o.style.top=r+"px",a+o.offsetHeight}printRow(t,e){const s=this._rowView;if(!s.visible)return;const i=this.model,r=i.dataRow.styleCallback,n=s.dom,o=s,a=e,A=o.dom.cloneNode(!1);if(o.replaceDom(A),A.$_brt=Vi,i.setPrinting(t,a),r){const e=r(t,i.dataRow,a,void 0);e&&J.extend(A.style,e)}return t.bandSummaryRuntime=i.summaryRuntime,t.bandSummaryRuntime.setGroup(null),o._modelChanged=!0,o.measure(t,o.measuredWidth,o.measuredHeight),o.resize(o.measuredWidth,o.measuredHeight),o.setPrintStyles(),o.layoutContent(t),o.replaceDom(n),A.$_h=o.height,A}get headerView(){return this._headerView}get footerView(){return this._footerView}get rowTemplateView(){return this._rowView}get groupCount(){return this._groupViews.length}get detailView(){return this._detailView}getGroupView(t){return this._groupViews[t]}indexOfGroup(t){let e=-1;for(let s of this._groupViews)if(s.visible&&(e++,s.model===t))return e;return e}getRowPoints(){const t=[];this.headerView.visible&&t.push(this._headerView.y,this.headerView.height),t.push(this._rowView.y,this._rowView.height),this._footerView.visible&&t.push(this._footerView.y,this._footerView.height);for(let e of this._groupViews)e.visible&&t.push(e.y,e.height);return this.detailView.visible&&t.push(this._detailView.y,this._detailView.height),t}get debugLabel(){return"simple band"}_getCssSelector(){return"rr-band rr-group-element"}_needDesignBox(){return!0}get rowView(){return this._rowView}_isEmpty(){return this.model.sectionCount<2&&super._isEmpty()}$_prepareHeads(t){if(!this._headViews){const e=this.model;this._headViews={},this.addChild(this._headViews[this.shash]=new Je(t,e,"SIMPLE BAND","SimpleBand","rr-band-head")),this.addChild(this._headViews[this._headerView.shash]=new Je(t,e.header,"HEADER","SimpleBand Header")),this.addChild(this._headViews[this._footerView.shash]=new Je(t,e.footer,"FOOTER","SimpleBand Footer")),this.addChild(this._headViews[this._rowView.shash]=new Je(t,e.dataRow,"DATA ROW","SimpleBand Row Template"));for(let e of this._groupViews)this.addChild(this._headViews[e.shash]=new Je(t,e.model,"GROUP-"+(e.model.index+1),"SimpleBand Group"));this.addChild(this._headViews[this._detailView.shash]=new Je(t,e.detail,"DETAILS","SimpleBand Details"))}}_doMeasure(t,e,s,i){const r=t.printing,n=this.model;let o,a=0,A=0;const l=n.getWidth(s);isNaN(l)||(s=l),s=n.getColWidth(s);let h=this._headerView;if(!r&&(h.visible=h.model.visible)&&(o=h.measure(t,s,i),a=Math.max(a,o.width),A+=o.height),h=this._rowView,!r&&(h.visible=h.model.visible)&&(o=h.measure(t,s,i),a=Math.max(a,o.width),A+=o.height),h=this._footerView,!r&&(h.visible=h.model.visible)&&(t.bandSummaryRuntime=n.summaryRuntime,o=h.measure(t,s,i),a=Math.max(a,o.width),A+=o.height),this.$_prepareGroupViews(n,this.doc)>0&&(t.printing||(A+=this.$_measureGroupViews(n,t,s,i))),h=this._detailView,(h.visible=h.model.visible)&&(o=h.measure(t,s,i),a=Math.max(a,o.width),A+=o.height),!r&&(this.$_prepareHeads(this.doc),this._headViews)){const e=this.container,r=null==e?void 0:e.focusedItem;for(let e in this._headViews){const n=this._headViews[e],l=n.model;o=n.measure(t,s,i),a=Math.max(a,o.width),A+=o.height+2,l.isAncestorOf(r)?n.dom.dataset.selected="":delete n.dom.dataset.selected}}return new Me(a,A)}_doLayoutContent(t){const e=this.model,s=!!this._headViews,i=e.sectionCount,r=e.getColWidth(this.width),n=2+8*e.bandLevel;let o,a,A=0;const l=t.printing?null:this._lines=[];s&&(a=this._headViews[this.shash],a.setBounds(n,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o=this._headerView,s&&(a=this._headViews[o.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((r-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),A+=o.height,o.setPrintStyles(),o.layoutContent(t)),null==l||l.push(o),o=this._rowView,s&&(a=this._headViews[o.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((r-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),A+=o.height,o.setPrintStyles(),o.layoutContent(t)),null==l||l.push(o),o=this._footerView,s&&(a=this._headViews[o.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((r-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),o.setPrintStyles(),o.layoutContent(t),A+=o.height),null==l||l.push(o);for(let e of this._groupViews)s&&(a=this._headViews[e.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),e.setBounds((r-e.measuredWidth)/2,A,r,e.measuredHeight),e.setPrintStyles(),e.layoutContent(t),A+=e.height,null==l||l.push(e);o=this._detailView,s&&(a=this._headViews[o.shash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((r-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),A+=o.height,o.setPrintStyles(),o.layoutContent(t)),null==l||l.push(o),this._designView&&this.$_layoutCols(this.doc,i)}$_getHeadHeight(){return this._headViews[this.shash].height+1}_setDesignContent(t,e){const s=this.$_getHeadHeight();this._designView.style.top=s+"px",this._designView.style.height=this.height-s+"px",t&&super._setDesignContent(t,e),e.style.backgroundColor="white"}getLines(){return this._lines}$_addEndRowMessage(){const t=this.model,e=this._rowView,s=e.cloneNode(),i=e.doc.createElement("span");return s.classList.add("rr-simpleband-end-row"),s.$_brt=Gi,s.$_h=s.offsetHeight,J.clearChildren(s),i.textContent=t.endRowMessage,i.className=zi.END_ROW_MESSAGE_CLASS,s.append(i),Object.assign(s.style,{display:"flex",alignItems:"center",justifyContent:"center",width:e.measuredWidth+"px",height:e.measuredHeight+"px"}),s}$_printRows(t,e,s,i,r,n){function o(e,s,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const a=i.dom,l=!0,h=a.cloneNode(!l);if(i.replaceDom(h),h.$_brb=o,h.$_brt=Vi,A.setPrinting(t,e),n){const i=n(t,s,e,void 0);i&&J.extend(h.style,i)}return t.bandSummaryRuntime=A.summaryRuntime,t.bandSummaryRuntime.setGroup(null),i._modelChanged=!0,i.measure(t,r,t.pageHeight),i.resize(i.measuredWidth,i.measuredHeight),i.setPrintStyles(),i.layoutContent(t),i.replaceDom(a),isNaN(s.masterRow)||(h.dataset.master=String(s.masterRow)),o&&h.classList.add("rr-simpleband-end-row"),t.index++,h}function a(e,s,i,n){const o=s.dom,a=o.cloneNode(!1);return a.$_brt=n,t.bandSummaryRuntime=A.summaryRuntime,t.bandSummaryRuntime.setGroup(i),A.setPrinting(t,e),s.replaceDom(a),s._modelChanged=!0,s.measure(t,r,t.pageHeight),s.resize(s.measuredWidth,s.measuredHeight),s.setPrintStyles(),s.layoutContent(t),s.replaceDom(o),a}const A=this.model,l=A.dataRow,h=l.styleCallback,d=[];let c=n?n.length:e?e.rowCount:0;const u=c;A.maxRowCount>0&&(c=Math.min(c,A.maxRowCount));const p=A.getEndRowCount();if(!s&&p.endRowCount>0&&(this._endRowView||(this._endRowView=o(0,l,h,!1,1),J.clearChildren(this._endRowView)),A.endRowMessage&&(this._endMessageView=function(){const t=i.cloneNode(),e=i.doc.createElement("span");return t.classList.add("rr-simpleband-end-row"),t.$_brt=Gi,J.clearChildren(t),e.textContent=A.endRowMessage,e.className=zi.END_ROW_MESSAGE_CLASS,t.append(e),Object.assign(t.style,{display:"flex",alignItems:"center",justifyContent:"center",width:i.measuredWidth+"px",height:i.measuredHeight+"px"}),t}())),0===c&&!this._endRowView)return d;this._printedRows=c!==u?c:NaN;const _=A.pr;if(t.index=0,s&&c>0){const t=s.map((t=>t.visible&&t.model.field)).filter((t=>!!t)),i=e.groupBy(t,n);for(let t=0;t<i.length;t++){const e=i[t];if(J.isNumber(e))d.push(o(e,l,h));else if(e.parent){const t=s[e.level-1];t.header&&t.header.visible&&d.push(a(e.row,t.header,e,Ki))}else{const t=s[e.group.level-1];t.footer&&t.footer.visible&&d.push(a(t.row,t.footer,e.group,Wi))}}this._grouped=!0}else if(n)for(let t=0;t<c;t++)d.push(o(n[t],l,h,!0));else for(let t=0;t<c;t++)d.push(o(t,l,h));return A.setPrinting(t,_),d}$_prepareGroupViews(t,e){const s=t.groups.count,i=this._groupViews;for(;i.length>s;){const t=i.pop();t.dispose(),this.removeChild(t)}for(;i.length<s;){const t=new Nl(e,null);this.addChild(t),i.push(t)}return i.length}$_measureGroupViews(t,e,s,i){const r=t.groups,n=this._groupViews;let o=0;for(let t=0;t<r.count;t++)n[t].model=r.get(t),o+=n[t].measure(e,s,i).height;return o}$_getGroupViews(t,e,s,i){if(e){const r=[];for(let n of e){const e=this._groupViews[n.index];e.model=n,t.noValueCallback=!0;try{e.measure(t,s,i)}finally{t.noValueCallback=!1}r.push(e)}return r.length?r:null}}$_layoutCols(t,e){const s=this._colSpans;for(;s.length<e-1;){const e=t.createElement("span");e.className="rr-band-col",s.push(e),this._designView.appendChild(e)}const i=this.model.sectionGap,r=this.model.getColWidth(this.width),n=this.height-this.$_getHeadHeight();let o=r+i;for(let t=0;t<e-1;t++){const e=s[t];delete e.dataset.hidden,e.textContent=t+2+"",J.setBounds(e,o,0,r,n),o+=r+i}for(let t=e-1;t<s.length;t++)s[t].dataset.hidden="1"}$_createPage(t){const e=t.createElement("div");return e.dataset._m_=this.model.shash,e.dataset._page_="1",e.style.position="relative",this._rowContainer.appendChild(e),e}$_cloneRow(t,e,s,i){const r=this._rowView,n=r.dom,o=r.cloneNode();return t.bandSummaryRuntime=e.summaryRuntime,r.replaceDom(o),r.measure(t,i,t.pageHeight),r.resize(r.measuredWidth,r.measuredHeight),r.setPrintStyles(),r.layoutContent(t),r.replaceDom(n),o}$_printLinear(t,e,s,i,r,n,o){function a(i,r){const n=i.$_createPage(t);return e.yBand=F=0,r&&(T=e.y=e.bodyTop,Z(s.pr>=0)),(isNaN(P)||!_||P<=0)&&(P=p),b.length||(R=0),d>0&&s.pageNo>0&&(s.master.repeatMasterRow&&!R&&function(t,e){const s=t.rowView.masterBandView,i=t.rowView.masterHeaderView,r=t.rowView.masterRowView,n=s.addMasterRow(e,i,r,r.x,F);F+=n,T+=n}(i,n),s.repeatDetailHeader&&A(i,n)),o.push(n),r&&s.pageNo++,n}function A(t,e){if(t._headerView.visible){E=t._headerView.dom.cloneNode(!0),e.appendChild(E);const i=E.offsetHeight;i>0&&(t._setY(E,F),F+=i,T+=i,s.prevHead=!0)}}function l(t){const i=t._footerView;!f&&isNaN(t._printedRows)||(s.clearSummary(),e.bandSummaryRuntime=s.summaryRuntime.setRows(f,t._masterRow).setRowCount(t._printedRows),i.measure(e,r,e.pageHeight),i.resize(i.measuredWidth,i.measuredHeight),i.setPrintStyles(),i.layoutContent(e));let n=i.cloneNode();if(t._setY(n,F),B.appendChild(n),F+=D=n.offsetHeight,T+=D,T>O&&b.length&&C){let e=T,s=b.length-1;for(;s>=0&&e>O;)e-=b[s--].offsetHeight;if(e<=O){F-=T-e,t._setY(n,F-D),T=e;for(let t=b.length-1;t>s;t--)B.removeChild(b[t])}}T>O&&(B.removeChild(n),B=a(t,!0),T+=D,t._setY(n,F),B.appendChild(n)),e.yBand=F,e.y=T,e.h=e.bodyHeight-(T-e.bodyTop)}const h=i?i.rowCount:0,d=s.bandLevel,c=s.detail,u=this._grouped,{rowsPerPage:p,breakRowsPerPage:_}=s.getRowsPerPage(),g=s.pr,f=d>0?[]:null,m=this._endRowView;let w=this._endMessageView;const{endRowCount:y,stopEndRow:C}=s.getEndRowCount(w?1:0),b=[];let v,B,E,P,x,S,I,R=0,T=e.y,O=e.bodyBottom,F=e.yBand,D=0,L=!1;for(0==d?B=a(this,!1):(B=o[o.length-1],s.pageNo++,P=p),A(this,B);n.length>0||y>0&&R<y;){const i=s.pr,p=!s.prevHead&&F===e.yBand&&(0===d||0===s.pageNo);if(p&&(T+D>O&&F>0&&(B=a(this,!0)),T!==e.bodyTop||0!==d&&0!==R||A(this,B)),x=S,x||(n.length>0?x=n[0]:w?(x=w,b.push(x)):(x=v=m.cloneNode(!0),x.$_brt=Gi,b.push(x))),p&&I&&x.$_brt!==Ki)x=I.cloneNode(!0),this._setY(x,F),B.appendChild(x),x.$_h=x.offsetHeight,F+=D=x.$_h,T+=D,I=x,s.prevHead=!1;else if(this._setY(x,F),B.appendChild(x),x.$_h=D=x.offsetHeight,F+=D,T+=D,S=null,T>O&&(s.prevHead||d>0||i>0))B.removeChild(x),b.pop(),S=x,R>0&&(s.prevHead=!1),b.length&&C?R=y:B=a(this,!0);else{const A=n.shift()||w||v,p=A.$_brt===Vi;f&&p&&f.push(i),i>0&&!u&&p&&Ql.checkBlanks(s,i,A),!A.$_brb&&p&&s.setPrinting(e,i+1),u&&A.$_brt===Ki&&(I=A),(p||A===w||A===v)&&(P--,R++,A===w&&(w=null));const _=o.length;if(p&&c.count>0){e.row=0,e.y=T,e.h=e.bodyHeight-(T-e.bodyTop),e.yBand=F;for(let n=0;n<c.count;n++){const a=this._detailView.getChild(n),A=a.model;a.rowView.masterBandView=this,a.rowView.masterHeaderView=this._headerView.dom,a.rowView.masterRowView=x,A.pageNo=0,A.masterValues=s.getValues(e,i,A._masterFlds),A.detailRows=A.rowsPerMaster;const l=e.detailRows=A.getNextDetailRows(e)||[];a.printBand(t,e,r,o,l,i)}B=o[o.length-1],T=e.y,F=e.yBand}L=!1,P<=0&&(n.length>0||y<=0||R===y)&&s.pr<h&&(d>0&&s.repeatDetailFooter&&(l(this),L=!0),(n.length>0||L)&&i<h&&(o.length===_||L)&&(B=a(this,!0)))}}if(0==d||s.pr>g){if(!L&&(l(this),L=!1,d>0&&p<Number.MAX_SAFE_INTEGER&&s.pr<h)){const s=this.$_createPage(t);e.yBand=F=0,e.y=e.bodyTop,T=e.bodyTop,o.push(s)}}else if(E){const t=E.offsetHeight;J.remove(E),F-=t,T-=t}L||(e.yBand=F,e.y=T,e.h=e.bodyHeight-(T-e.bodyTop))}$_printAcross(t,e,s,i,r,n,o){function a(t){if(t._headerView.visible){let e=0;for(let i=0;i<r;i++){const r=t._headerView.cloneNode();t._setPos(r,s[2*i],p),w.appendChild(r),e=Math.max(e,r.offsetHeight)}p+=e,c=h+=e}}const A=Math.min(i.endRowCount>=0?i.endRowCount:Number.MAX_SAFE_INTEGER,n?n.rowCount:0),l=this._headerView.offsetHeight;let h=e.y,d=e.bodyBottom,c=h,u=h,p=0,_=Math.min(r,A);const g=new Array(r),f=new Array,m=new Array;let w;w=this.$_createPage(t),o.push(w),l&&a(this);for(let t=0;t<_;t++)g[t]=[];for(;i.pr<A;){0===p&&l&&a(this);let n=-1,y=0;f.length=0;for(let t=0;t<_&&i.pr<A;t++){const o=s[2*t],a=s[2*t+1]-o,A=m.pop()||this.$_cloneRow(e,i,i.pr,a);f.push(A),this._setPos(A,o,p),w.appendChild(A);const l=A.$_h=A.offsetHeight;if(h+l>d){n=t;break}g[t].push(A),i.setPrinting(e,i.pr+1),t===r-1&&(c+=l),y=Math.max(y,l)}if(n>=0){for(let t of f)w.removeChild(t),m.push(t);c=h=e.bodyTop,p=0,n=-1,u=e.bodyTop,w=this.$_createPage(t),o.push(w)}else h+=y,p+=y,m.length=0}let y=0;if(A>0)for(let t=0;t<_;t++)g[t].length&&y++;const C=this._footerView.cloneNode(),b=i.footer.attachToBody,v=b?Math.min(y,r-1):r-1;this._setPos(C,s[2*v],(b?c:h)-u),w.appendChild(C);const B=C.offsetHeight;b?h=Math.max(h,c+B):h+=B,h>d&&(w.removeChild(C),w=this.$_createPage(t),o.push(w),this._setY(C,0),w.appendChild(C),h=e.bodyTop+B),e.y=h,e.h=e.bodyHeight-(h-e.bodyTop)}$_printDown(t,e,s,i,r,n,o){function a(t){for(let t=0;t<r;t++)p[t]=A,_[t]=[];if(m=0,t._headerView.visible){for(let e=0;e<r;e++){const i=t._headerView.cloneNode();t._setPos(i,s[2*e],d),f.appendChild(i),m=Math.max(m,i.offsetHeight)}d+=m,A+=m}}let A=e.y,l=e.bodyBottom,h=A,d=0;const c=Math.min(i.endRowCount>=0?i.endRowCount:Number.MAX_SAFE_INTEGER,n?n.rowCount:0);let u=Math.min(r,c);const p=new Array(r),_=new Array(r);let g,f,m=0;f=this.$_createPage(t),o.push(f),a(this);do{for(let n=0;n<r;n++){const u=s[2*n],w=s[2*n+1]-u;for(0===d&&(0===n?a(this):(d+=m,A+=m));i.pr<c;){const s=g||this.$_cloneRow(e,i,i.pr,w);g=null,this._setPos(s,u,d),f.appendChild(s),s.$_h=s.offsetHeight;const a=s.$_h;if(d+=a,A+=a,p[n]=A,_[n].push(s),A>l){f.removeChild(s),g=s,_[n].pop(),d=0,n==r-1?(f=this.$_createPage(t),o.push(f),h=e.bodyTop):h=o.length>1?e.bodyTop:e.y,A=h;break}i.setPrinting(e,i.pr+1)}}}while(i.pr<c);let w=0;if(c>1){let t=0;for(let e=0;e<_.length;e++)for(let s=0;s<_[e].length;s++)t+=_[e][s].$_h;const e=new Array(u);let i=Math.round(t/u);for(let t=0;t<u-1;t++){let r,n=_[t],o=0,a=0;for(;o<n.length;){if(a+=r=n[o].$_h,a>i){a-=r;break}o++}e[t]=a;const A=_[t+1];let l=0;for(;o<n.length;){const t=n.splice(o,1)[0];A.splice(l++,0,t)}let h=m;for(let e=0;e<A.length;e++)this._setPos(A[e],s[2*(t+1)],h),h+=A[e].$_h}e[r-1]=0;for(let t=0;t<_[r-1].length;t++)e[r-1]+=_[r-1][t].$_h;for(let t=0;t<2;t++)(()=>{for(let t=u-1;t>0;t--)for(;e[t]>e[t-1];){const i=_[t],r=_[t-1],n=i.shift(),o=n.$_h;let a=m;for(let t=0;t<i.length;t++)this._setY(i[t],a),a+=i[t].$_h;e[t]-=o,r.push(n),this._setX(n,s[2*(t-1)]),this._setY(n,e[t-1]+m),e[t-1]+=o}})();for(let t=0;t<u;t++){let e=_[t];if(p[t]=h+m,e.length>0){w=t+1;for(let s=0;s<e.length;s++)p[t]+=e[s].$_h}}}else{for(let t=0;t<r;t++)p[t]=h+m;w=c,w&&(p[0]+=_[0][0].$_h)}const y=this._footerView.cloneNode(),C=i.footer.attachToBody,b=C?Math.min(w,r-1):r-1,v=C?p[b]:0;A=p[0];for(let t=1;t<u;t++)A=Math.max(A,p[t]);this._setPos(y,s[2*b],(C?v:A)-h),f.appendChild(y);const B=y.offsetHeight;C?A=Math.max(A,v+B):A+=B,A>l&&(f.removeChild(y),f=this.$_createPage(t),o.push(f),this._setY(y,d=0),f.appendChild(y),A=e.bodyTop+B),e.y=A,e.h=e.bodyHeight-(A-e.bodyTop)}}Ql.HEADER_CLASS="rr-band-header",Ql.FOOTER_CLASS="rr-band-footer",Ql.ROW_CLASS="rr-band-rowtemplate";class Ul{constructor(t,e,s){this._rows=[];for(let i=0;i<s;i++)this._rows.push(t[e+i])}get count(){return this._rows.length}get height(){if(isNaN(this._height)){this._height=0;for(let t of this._rows)this._height+=t.offsetHeight}return this._height}get group(){return this._rows[0].$_grp}get isGroup(){return!!this._rows[0].$_grp}get row(){return this._rows[0].$_bri}get isRow(){return this._rows[0].$_brt===Vi}get isGroupHeader(){return this._rows[0].$_brt===Ki}get isGroupFooter(){return this._rows[0].$_brt===Wi}get first(){return this._rows[0]}get(t){return this._rows[t]}getCell(t,e){return this._rows[t].cells[e]}appendTo(t){for(let e of this._rows){const s=parseFloat(e.style.height);t.appendChild(e),isNaN(s)?e.style.height=e.offsetHeight+"px":e.style.height=s+"px"}}insertTo(t){const e=this._rows;let s=t.children[0];for(let i=e.length-1;i>=0;i--){const r=e[i],n=parseFloat(r.style.height);isNaN(n)?r.style.height=r.offsetHeight+"px":r.style.height=n+"px",t.insertBefore(r,s),s=r}}detach(){for(let t=this._rows.length-1;t>=0;t--)J.detach(this._rows[t])}makeBlank(t,e){const s=this._rows[t].cells[e];J.remove(s.firstChild.firstChild)}hide(t,e){this._rows[t].cells[e].style.display="none"}clone(){const t=this._rows.map((t=>t.cloneNode(!0)));return new Ul(t,0,t.length)}}class Ml extends Ul{constructor(t,e,s){super(t,e,s),this._rows.forEach((t=>{t.$_brt=Gi;const e=t.cells,s=e.length;if(s>0){for(let t=0;t<s;t++)J.clearChildren(e[t]);e[0].innerHTML="&#160;"}}))}}class kl extends el{constructor(t,e,s){super(t,e,s,"tableBandCellView")}}class Vl extends sl{constructor(t,e,s,i){super(t,e,s),this.styleName=i}get debugLabel(){return""}_getCssSelector(){return this.styleName+" rr-group-element"}_needDesignBox(){return!0}_createCellElement(t,e){return new kl(t,this,e)}_doMeasure(t,e,s,i){return super._doMeasure(t,e,s,i)}_doAfterMeasure(t,e,s,i,r){this.childCount>0?this._applyBorders(e,r):t.printing||(!this.model.height&&this.model.designHeight>0&&(r.height=Math.max(r.height,this.model.designHeight)),!this.model.width&&this.model.designWidth>0&&(r.width=Math.max(r.width,this.model.designWidth))),super._doAfterMeasure(t,e,s,i,r)}}class Gl extends Vl{_setTableStyles(t){super._setTableStyles(t),t.style.setProperty("height","100%","important")}_setRowStyles(t,e){super._setRowStyles(t,e),J.extend(t.style,this.model.styles)}}class Kl extends Vl{_setTableStyles(t){super._setTableStyles(t),t.style.setProperty("height","100%","important")}_setRowStyles(t,e){super._setRowStyles(t,e),J.extend(t.style,this.model.styles)}}class Wl extends Vl{applyCellStyles(t,e,s,i,r){function n(t,e,s){Object.assign(t,e);for(const t in e)s.push(t)}const o=this.model,a=s.cells;for(let e=0;e<a.length;e++){const s=a[e],A=o.getCell(i,s.cellIndex),l=s.style;let h=A.$_prevStyles;if(h)for(let t of h)l[t]="";else h=A.$_prevStyles=[];this._styles&&n(l,this._styles,h),r&&n(l,r,h);const d=A.styleCallback;let c=A.styles;if(c&&n(l,c,h),d)try{const e=d(t,A,t.row);e&&n(l,e,h)}catch(t){console.error("CellStyleCallback Error",t)}}}_setTableStyles(t){super._setTableStyles(t),t.style.setProperty("height","100%","important")}_setRowStyles(t,e){super._setRowStyles(t,e),this._styles={...this.model.styles}}}class zl extends Vl{constructor(t,e){super(t,e,"tableBandBodyView","rr-tableband-body"),this._bandRowCount=0}get bandRowCount(){return this._bandRowCount}get endMessageView(){return this._endMessageView}get endRowView(){return this._endRowView}addEndRowMessage(t,e){const s=e.$_trows[0].cloneNode(!0),i=new Ml([s],0,1),r=s.cells[0];return r.colSpan=s.cells.length,r.textContent=t.endRowMessage,r.className=zi.END_ROW_MESSAGE_CLASS,r.style.textAlign="center",s.classList.add(th.ROW_CLASS),i}printRows(t,e,s,i,r,n){function o(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=s||e>0,a=i.$_trows,h=a.length,p=[];l.setPrinting(t,e);for(let s=0;s<h;s++){const r=a[s],h=o?i.$_cloneRow(r):r.cloneNode(!0);let d;c&&(d=c(t,A,e,void 0)),h.$_brt=Vi,h.$_bri=e,h.$_brb=n,i.setCellDoms(r,h),i.applyCellStyles(t,l,h,s,d),p.push(h)}t.bandSummaryRuntime=l.summaryRuntime,t.bandSummaryRuntime.setGroup(null),i.$_refreshRowCells(t,r,u,!0);for(let t=0;t<h;t++){const e=p[t];i.unsetCellDoms(e,a[t]),e.classList.add(th.ROW_CLASS),isNaN(A.masterRow)||(e.dataset.master=String(A.masterRow)),0==n&&d.appendChild(e)}return t.index++,p}function a(e,s,i,n){const o=s.$_trows,a=o.length,A=[];for(let t=0;t<a;t++){const e=o[t],i=s.$_cloneRow(e);i.$_brt=n,s.replaceCellDoms(e,i),s.applyGroupStyles(i),A.push(i)}t.bandSummaryRuntime=l.summaryRuntime,t.bandSummaryRuntime.setGroup(i),l.setPrinting(t,e),s.$_refreshRowCells(t,r,u,!0),i.trows=a;for(let t=0;t<a;t++)A[t].$_grp=i,s.replaceCellDoms(A[t],o[t]),d.appendChild(A[t])}if(n)this._bandRowCount=0;else if(this._bandRowCount>0)return;const A=this.model,l=A.band,h=!!n,d=this._tbody,c=A.styleCallback,u=t.pageHeight;let p=h?n.length:e?e.rowCount:0;const _=p;l.maxRowCount>0&&(p=Math.min(p,l.maxRowCount));const g=l.getEndRowCount();if(!s&&g.endRowCount>0){if(!this._endRowView){const t=o(0,!1,1);this._endRowView=new Ml(t,0,t.length)}l.endRowMessage&&(this._endMessageView=this.addEndRowMessage(l,i))}if(0===p&&!this._endRowView)return;const f=p!==_?p:NaN,m=l.pr;if(t.index=0,s){const t=s.map((t=>t.visible&&t.model.field)).filter((t=>!!t)),i=e.groupBy(t,n);for(let t=0;t<i.length;t++){const e=i[t];if(J.isNumber(e))o(e),this._bandRowCount++;else if(e.parent){const t=s[e.level-1];t.header&&t.header.visible&&(a(e.row,t.header,e,Ki),this._bandRowCount++)}else{const t=s[e.group.level-1];if(t.footer)if(t.footer.visible)a(t.row,t.footer,e.group,Wi),this._bandRowCount++;else if(!t.header.visible){const t=this.doc.createElement("tr");t.className=th.DUMMY_GROUP_FOOTER,d.appendChild(t)}}}}else if(n)for(let t=0;t<p;t++)o(n[t],!0),this._bandRowCount++;else for(let t=0;t<p;t++)o(t),this._bandRowCount++;return l.setPrinting(t,m),f}}class $l extends sl{constructor(t,e,s){super(t,e,s)}applyGroupStyles(t){J.extend(t.style,this.model.styles)}_needDesignBox(){return!0}_createCellElement(t,e){return new kl(t,this,e)}_doMeasure(t,e,s,i){const r=super._doMeasure(t,e,s,i);return r.height=Math.max(10,r.height),r}_doAfterMeasure(t,e,s,i,r){this.childCount>0?this._applyBorders(e,r):t.printing||(!this.model.height&&this.model.designHeight>0&&(r.height=Math.max(r.height,this.model.designHeight)),!this.model.width&&this.model.designWidth>0&&(r.width=Math.max(r.width,this.model.designWidth))),super._doAfterMeasure(t,e,s,i,r)}}class Xl extends $l{constructor(t,e){super(t,e,"tableBandGroupHeader")}_getCssSelector(){return"rr-tableband-group-header  rr-group-element"}_setTableStyles(t){super._setTableStyles(t),t.style.setProperty("height","100%","important")}}class jl extends $l{constructor(t,e){super(t,e,"tableBandGroupFooter")}_getCssSelector(){return"rr-tableband-group-footer  rr-group-element"}_setTableStyles(t){super._setTableStyles(t),t.style.setProperty("height","100%","important")}}class Yl extends ki{constructor(t,e){super(t,e,"tableBandGroupView"),this.headIndent=0}_doDispose(){super._doDispose()}get header(){return this._header}get footer(){return this._footer}_getCssSelector(){return"rr-tableband-group rr-group-element"}_needDesignBox(){return!0}_doMeasure(t,e,s,i){super._doMeasure(t,e,s,i);const r=this.container.focusedItem;this._header=this.getChild(0),!t.printing&&(this._header._masterView=this._masterView),this._footer=this.getChild(1),!t.printing&&(this._footer._masterView=this._masterView),t.printing||this._headerHead||(this.addChild(this._headerHead=new Je(this.doc,this.model.header,"GROUP HEADER","TableBand RowGroup Header")),this.addChild(this._footerHead=new Je(this.doc,this.model.footer,"GROUP FOOTER","TableBand RowGroup Footer")));let n=this._header.measuredHeight+this._footer.measuredHeight;if(!t.printing){let e=this._headerHead,o=e.measure(t,s,i);e.setSelected(r),n+=o.height+2,e=this._footerHead,o=e.measure(t,s,i),e.setSelected(r),n+=o.height+2}return Me.create(Math.max(this._header.measuredWidth,this._footer.measuredWidth),n)}_doLayoutContent(t){if(super._doLayoutContent(t),!t.printing){let t=0,e=this._headerHead;e.applyMeasure(),e.x=this.headIndent,e.y=t+2,t+=e.height+2,this._header.y=t,t+=this._header.height,e=this._footerHead,e.applyMeasure(),e.x=this.headIndent,e.y=t+2,t+=e.height+2,this._footer.y=t}}$_setMasterView(t){this._masterView=t}}class Jl{constructor(t,e){this._lines=[],this._band=t,this._cells=e}static create(t,e){if(e&&e.length>0)return new Jl(t,e)}pushLine(t){t instanceof Ul?this._lines.push(t):this.merge()}popLine(){this._lines.pop()}merge(){function t(t,e,i){const r=i-e;if(r>1){const n=s[e].getCell(0,t);n.rowSpan=r;const o=n.firstChild,a=o.style.maxHeight.replace("px","");o.style.maxHeight=Number(a)*r+"px";for(let r=e+1;r<i;r++)s[r].getCell(0,t).style.display="none"}}const e=this._cells,s=this._lines.length>1?this._lines:null;if(s){let i=this._band.dataObj,r=this._band.dataRow;e.forEach((e=>{var n;const o=r.getCellItem(e),a=o&&o.item,A=a&&a.value;if(A){const r=e.col,o="datetime"===(null===(n=i.getFieldByName(A))||void 0===n?void 0:n.dataType);let a=0,l=s[0],h=l.row,d=i.getRowValue(h,A),c=1;o&&(d=+d);for(const e=s.length;c<e;c++){l=s[c],h=l.row;let e=i.getRowValue(h,A);o&&(e=+e),e!==d&&(t(r,a,c),a=c),d=e}t(r,a,c)}})),this._lines=[]}}}class Zl extends ji{isEnded(){return 0===this.rows.length}getRows(){return this.rows}getNextPage(t,e,s,i){function r(e,i){if(d){const r=o.$_createContainer(t,e,i);l=t.createElement("table"),h=t.createElement("tbody"),l.style.position="absolute",sl.setTableStyle(l),l.appendChild(a._bodyView.createColGroup(t,s)),l.appendChild(h),r.appendChild(l),A.appendChild(r),d=!1}}function n(){v&&(m.forEach((t=>{const e=[];v.forEach((s=>{for(let i=0;i<s.count;i++)e.push(s.getCell(i,t))})),e[0].rowSpan=e.length;for(let t=1;t<e.length;t++)e[t].style.display="none"})),v=null)}const o=this,a=this.bandView;let A,l,h,d=!0;const c=a.model,u=c.bandLevel,p=this.rows,_=e.h;let g=e.h;const f=c.dataRow.rowCount,m=this.groupViews&&c.dataRow.getMergedColumns(),{endRowCount:w,stopEndRow:y}=c.getEndRowCount(0),C=!c.prevHead&&(isNaN(c.rowIndex)||0===u&&!this.isBand(p[0])||u>0&&c.repeatDetailHeader);let b,v,B=this.erc;if(isNaN(B)&&(B=w||0),c.maxRowCount>0&&this.setMaxCount(p,c.maxRowCount),C||p.length>0||B>0){const a=c.sectionCount;if(a>1){const r=this.ptsBand,n=this._createPage(t,i);let o;s=r[1]-r[0],o=c.sectionLayout==Li.ACROSS_DOWN?this.$_getAcrossPages(t,e,a,s,n):this.$_getDownPages(t,e,a,s,n);for(let t=0;t<a;t++)this._setX(o[t],r[2*t]);return n.$_h=o.$_h,n}const w=!this.groupViews&&Jl.create(c,c.dataRow.getMergedCells()),E=this.rowView,P=this.footerView,{rowsPerPage:x,breakRowsPerPage:S}=c.getRowsPerPage();let I,R=!1;const T=E.measuredWidth;let O,F,D,L=0,N=0;if(A=this._createPage(t,i),A.style.left=Math.floor((s-T)/2)+"px",A.style.width=T+"px",s=T,b=this.rpp,(isNaN(b)||!S||b<=0)&&(b=x),r(L,T),C&&(isNaN(c.rowIndex)||0===u&&!this.isBand(p[0])||u>0&&c.repeatDetailHeader)){if(D=this.$_addHeader(h,g),isNaN(D))return e.h=0,null;g-=D,L+=D,c.prevHead=!0}for(g>0&&this.prevGroup&&p.length>0&&(this.isRow(p[0])||!this.isGroupHeader(p[0]))&&(I=this.prevGroup.clone(),I.appendTo(h),g>=I.height?(g-=I.height,c.prevHead=!1):(I.detach(),g=0)),isNaN(c.rowIndex)&&(c.rowIndex=0);g>0&&p.length>0;){const i=p.shift();if(i===ql){n();continue}if(b<=0&&!this.isBand(i)){p.unshift(i),e.h=0;break}const o=E.$_trows.length;let a;if(I=null,r(L,T),this.isRow(i))isNaN(O)&&(O=i),I=this.bandView.printRow(e,i),I&&(a=I._rows,F=i,i>O&&th.checkBlanks(c,i,I),m&&(v||(v=[]),v.push(I)),w&&w.pushLine(I));else if(this.isBand(i)){const r=t.createElement("div");J.extend(r.style,{position:"absolute",top:L+"px",width:T+"px"}),A.appendChild(r);const n=e.index;if(e.h=g,i.getNextPage(t,e,s,r),e.index=n,e.h=_,D=0,i instanceof Zl){const t=r.getElementsByClassName("rr-table")[0];t&&(D=t.offsetHeight)}else{const t=r.firstElementChild.children;for(let e=0;e<t.length;e++)D+=t[e].offsetHeight}d=!0,l=null}else{const t=i,r=t.group,o=t.view,A=o.$_trows,l=A.length;if(o.parent||this.groupViews[0].addChild(o),this.isGroupFooter(t)&&this.prevLine)a=this.prevLine,this.prevLine=null;else{a=[],n();for(let e=0;e<l;e++){const s=A[e],i=o.$_cloneRow(s);i.$_brt=t.rowType,o.replaceCellDoms(s,i),o.applyGroupStyles(i),a.push(i)}c.summaryRuntime.setRows(null,-1),e.bandSummaryRuntime=c.summaryRuntime,e.bandSummaryRuntime.setGroup(r),c.setPrinting(e,t.row),o.$_refreshRowCells(e,s,D,!0),r.trows=l;for(let t=0;t<l;t++)a[t].$_grp=r,o.replaceCellDoms(a[t],A[t])}I=new Ul(a,0,l),t.rowType===Ki&&(this.prevGroup=I)}if(i instanceof ji||(I?(I.appendTo(h),D=I.height):D=0),g>=D){if(R=!0,g-=D,L+=D,"number"==typeof i)c.rowIndex++,e.index++,b--,N++;else if(i instanceof ji){if(0!==i.getRows().length||!isNaN(i.erc)){i.band.prevIndex=e.index,p.unshift(i),c.repeatMasterRow&&(p.unshift(F),this.rpp=NaN,c.rowIndex--),e.h=0;break}i.band.prevIndex=0,i.band.rowIndex=NaN}c.prevHead=!1}else if(a){for(let t=0;t<o;t++)h.removeChild(a[t]);p.unshift(i),this.isGroupFooter(i)&&(this.prevLine=a);break}}if(!l||R||0!==B||C&&(c.alwaysHeader&&P&&P.height>0)){if(N>0&&(n(),w&&w.merge()),0===p.length){for(B-=N;g>0&&B>0;){let t,e=this.endMessageView;if(e){if(e.appendTo(h),t=e.height,!(g>t)){e.detach();break}g-=t,B--,this.endMessageView=null}else{if(e=this.endRowView.clone(),e.appendTo(h),t=e.height,!(g>t)){e.detach();break}g-=t,B--}}y&&(B=0),0===B&&P&&g>=P.height&&(r(L,T),g-=this.$_addFooter(e,h,T))}else if(u>0&&c.repeatDetailFooter&&P){const t=h.rows,s=[];for(D=P.height;g<D&&t.length>0&&t[t.length-1].classList.contains(th.ROW_CLASS);){const i=[];for(let e=0;e<f;e++){const e=t[t.length-1];g+=e.offsetHeight,e.remove(),i.push(e)}p.unshift(--F),s.push({trs:i,row:F}),e.index--,c.rowIndex--}if(g>=D)g-=this.$_addFooter(e,h,T),this.footerView=P;else for(;s.length>0;){const{trs:t,row:i}=s.pop();p.push(i),t.forEach((t=>{h.appendChild(t),g-=t.offsetHeight})),e.index++}}}else A.firstElementChild.removeChild(l),g=_;return(p.length>0||B>0)&&(e.h=0),A.$_h=_-g,o.rpp=b,o.erc=B>0?B:NaN,A}return null}$_createContainer(t,e,s){const i=t.createElement("div");return J.extend(i.style,{position:"absolute",top:e+"px",width:s+"px"}),i}$_createTable(t,e,s,i){const r=this.$_createContainer(t,s,i),n=t.createElement("table"),o=t.createElement("tbody");return n.style.position="absolute",sl.setTableStyle(n),n.appendChild(this.bandView._bodyView.createColGroup(t,i)),n.appendChild(o),r.appendChild(n),e.appendChild(r),n}$_addFooter(t,e,s){const i=this.band,r=this.footerView;i.bandLevel>0&&(r.visible=r.model.visible)&&(r.resetStyleName(),this.band.clearSummary(),t.bandSummaryRuntime=this.band.summaryRuntime.setGroup(null).setRows(this.detailRows,this.masterRow).setRowCount(this.detailRows.length),r.measure(t,s,t.pageHeight),r.resize(r.measuredWidth,r.measuredHeight),r.setPrintStyles(),r.layoutContent(t));const n=new il(r.dom.firstChild);return n.appendTo(e,th.HEADER_CLASS),n.height}$_addHeader(t,e){if(this.headerView){const s=new il(this.headerView.dom.firstChild);s.appendTo(t,th.HEADER_CLASS);const i=s.height;return e>=i?i:(s.remove(),NaN)}return 0}$_getAcrossPages(t,e,s,i,r){const n=this.rows,o=[],a=[];if(n.length>0){const A=e.h;let l=e.h,h=0,d=0;for(let n=0;n<s;n++){const s=this._createPage(t,r),n=this.$_createTable(t,s,h,i).tBodies[0];o.push(s),a.push(n);const A=this.$_addHeader(n,l);if(isNaN(A))return e.h=0,null;d=Math.max(d,A)}for(l-=d,h+=d;l>0&&n.length>0;){const t=[],i=[];let r,o=0;for(let A=0;A<s&&n.length>0;A++){const s=n.shift();if(i.push(s),r=this.bandView.printRow(e,s),r){r.appendTo(a[A]),t.push(r);const e=r.height;o=Math.max(o,e)}}if(!(l>=o)){for(let e=0;e<s&&n.length>0;e++)n.unshift(i.pop()),t.pop().detach();break}l-=o,h+=o}0===n.length?this.footerView&&l>=this.footerView.height&&(l-=this.$_addFooter(e,a[s-1],0)):e.h=0,o.$_h=A-l}return o}$_getDownPages(t,e,s,i,r){const n=this.rows,o=[],a=[];if(n.length>0){const A=e.h;let l=e.h;const h=[],d=[];let c=0,u=0;for(let n=0;n<s;n++){const s=this._createPage(t,r),n=this.$_createTable(t,s,c,i).tBodies[0];o.push(s),a.push(n);const A=this.$_addHeader(n,l);if(isNaN(A))return e.h=0,null;u=Math.max(u,A)}l-=u,c+=u;const p=c,_=l;for(let t=0;t<s;t++){const s=[];let i,r=0;for(;l>0&&n.length>0;){const o=n.shift();if(i=this.bandView.printRow(e,o),i){if(i.appendTo(a[t]),s.push(i),r=i.height,!(l>=r)){i.detach(),n.unshift(o);break}l-=r,c+=r}}h.push(_-l),d.push(s),c=p,l=_}if(0==n.length){const t=h.reduce(((t,e)=>t+e)),e=Math.round(t/s);for(let t=0;t<s-1;t++){const s=d[t];let i,r=0,n=0;for(;r<s.length;){if(n+=i=s[r].height,n>e){n-=i;break}r++}h[t]=n;const o=d[t+1];for(;r<s.length;){const e=s.splice(r,1)[0];e.insertTo(a[t+1]),o.unshift(e),h[t+1]+=e.height}}}l=_-h[s-1],0===n.length?this.footerView&&l>=this.footerView.height&&(l-=this.$_addFooter(e,a[s-1],0)):e.h=0,o.$_h=A-l}return o}}const ql=-999;class th extends zi{constructor(t,e){super(t,e,"TableBandView"),this._groupViews=[],this._rowGap=2,this._colSpans=[],this._colWidth=0,this._grouped=!1,this._masterRow=-1,this._printedRowCount=NaN,this._headers=0,this.addChild(this._headerView=new Gl(t,e&&e.header,"bandHeaderView","rr-tableband-header")),this.addChild(this._rowView=new Wl(t,e&&e.dataRow,"bandRowTemplateView","rr-tableband-row-template")),this.addChild(this._bodyView=new zl(t,e&&e.dataRow)),this._bodyView.visible=!1,this.addChild(this._footerView=new Kl(t,e&&e.footer,"bandFooterView","rr-tableband-footer")),this.addChild(this._detailView=new Tl(t,e&&e.detail)),this._lines=[this._headerView,this._rowView,this._footerView,this._detailView],this._rowContainer=t.createElement("div"),this._dom.appendChild(this._rowContainer)}static checkBlanks(t,e,s){const i=t.dataRow.blankItems;i&&i.forEach((i=>{t.dataRow.canBlank(i,e)&&s.makeBlank(i.row,i.col)}))}_doDispose(){super._doDispose()}get columns(){return this.model.columns}get colCount(){return this.model.colCount}getColumn(t){return this.model.getColumn(t)}printBand(t,e,s,i,r){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1;const o=this.model,a=o.dataObj,A=o.getWidth(s),l=o.getLeft(s);let h=l||0;isNaN(A)||(isNaN(l)&&(h=Math.floor((s-A)/2)),s=A);const d=o.sectionCount,c=d<2,u=c?null:o.getColPoints(s,h);if(r||o.prepareIndices(e),this._masterRow=n,o.dataRow.masterRow=n>=0?n:NaN,o.summaryRuntime.setRows(r,n),this._colWidth=o.getColWidth(s),u&&(s=this._colWidth),e.band=o,isNaN(this._rowView.measuredHeight)){let t=this._headerView;if((t.visible=t.model.visible)&&(t.resetStyleName(),t.measure(e,s,e.pageHeight),t.resize(s,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e)),t=this._rowView,t.visible=t.model.visible,!this._printingRows){t.resetStyleName(),t.measure(e,s,e.pageHeight),t.resize(s,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e),this._bodyView.visible=!0,e.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(null,this._masterRow);const i=o.designData,n=this.$_getGroupViews(e,o.groups.getValidGroups(i),s,e.pageHeight);this._printedRowCount=this._bodyView.printRows(e,a,n,this._rowView,s,r),this._printingRows=this._bodyView.$_trowsCopy,this._grouped=!!n}t=this._footerView,(t.visible=t.model.visible)&&(t.resetStyleName(),e.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(null,this._masterRow),t.measure(e,s,e.pageHeight),t.resize(t.measuredWidth,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e))}else if(!this._printingRows){let t=this._headerView;(t.visible=t.model.visible)&&(t.resetStyleName(),t.measure(e,s,e.pageHeight),t.resize(s,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e)),e.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(null,this._masterRow);const i=o.designData,n=this.$_getGroupViews(e,o.groups.getValidGroups(i),s,e.pageHeight);this._printedRowCount=this._bodyView.printRows(e,a,n,this._rowView,s,r),this._printingRows=this._bodyView.$_trowsCopy,t=this._footerView,(t.visible=t.model.visible)&&(t.resetStyleName(),e.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(null,this._masterRow),t.measure(e,s,e.pageHeight),t.resize(t.measuredWidth,t.measuredHeight),t.x=h,t.setPrintStyles(),t.layoutContent(e))}const p=this._printingRows,_=this._bodyView.bandRowCount;return this._tempRow||(this._tempRow=p[0]),c?this.$_printLinear(t,e,o,a,h,s,p,i):o.sectionLayout==Li.ACROSS_DOWN?this.$_printAcross(t,e,o,u,d,s,p,_,i):this.$_printDown(t,e,o,u,d,s,p,_,i),r&&(this._printingRows=null),_}prepareAsync(t,e,s,i,r){function n(i,r){for(let n=0;n<A.count;n++){const a=A.get(n),h=l.getChild(n);a.masterValues=o.getValues(e,i,a._masterFlds),a.detailRows=a.rowsPerMaster;const d=a.getNextDetailRows(e)||[];if(d.length>0){const n=h.prepareAsync(t,e,s,d,i);a._pr+=d.length,n.masterValues=o.getValues(e,i,a._masterFlds),r.push(n)}}}const o=this.model,a=o.bandLevel,A=o.detail&&o.detail.count>0?o.detail:null,l=this._detailView,h=o.dataObj,d=o.designData,c=this.$_getGroupViews(e,o.groups.getValidGroups(d),s,e.pageHeight),u=o.getWidth(s),p=o.getLeft(s);let _,g=p||0;if(A)for(let t=0;t<A.count;t++){A.get(t)._pr=0}isNaN(u)||(isNaN(p)&&(g=Math.floor((s-u)/2)),s=u);const f=o.sectionCount<2?null:o.getColPoints(s,g);this._colWidth=o.getColWidth(s),f&&(s=this._colWidth),e.band=o,0===a&&o.prepareIndices(e),isNaN(this._rowView.measuredHeight)&&(e.detailRows=i?i.slice(0):void 0,_=this._headerView,(_.visible=_.model.visible)&&(_.resetStyleName(),_.measure(e,s,e.pageHeight),_.resize(s,_.measuredHeight),_.x=g,_.setPrintStyles(),_.layoutContent(e)),_=this._rowView,_.visible=_.model.visible,this._printingRows||(_.resetStyleName(),_.measure(e,s,e.pageHeight),_.resize(s,_.measuredHeight),_.x=g,_.setPrintStyles(),_.layoutContent(e)),_=this._footerView,(_.visible=_.model.visible)&&(_.resetStyleName(),e.bandSummaryRuntime=o.summaryRuntime.setGroup(null).setRows(i,this._masterRow),_.measure(e,s,e.pageHeight),_.resize(_.measuredWidth,_.measuredHeight),_.x=g,_.setPrintStyles(),_.layoutContent(e)));const m=new Zl;if(m.band=o,m.bandView=this,m.headerView=this._headerView.visible?this._headerView:null,m.footerView=this._footerView.visible?this._footerView:null,m.rowView=this._rowView,m.groupViews=c,m.rows=function(){const t=h?h.rowCount:0,e=[];if(c){const t=c.map((t=>t.visible&&t.model.field)).filter((t=>!!t));h.groupBy(t,i).forEach((t=>{if(J.isNumber(t))e.push(t),A&&n(t,e);else if(t.parent){const s=c[t.level-1];s.header&&s.header.visible&&e.push({view:s.header,row:t.row,rowType:Ki,group:t})}else{const s=c[t.group.level-1];s.footer&&(s.footer.visible?e.push({view:s.footer,row:t.row,rowType:Wi,group:t.group}):s.header.visible||e.push(ql))}}))}else if(i)for(const t of i)e.push(t),A&&n(t,e);else for(let s=0;s<t;s++)e.push(s),A&&n(s,e);return e}()||[],m.xBand=g,m.wBand=s,m.ptsBand=f,m.masterRow=r,m.detailRows=i?i.slice(0):null,!c&&o.getEndRowCount().endRowCount>0){const t=o._pr,s=this.printRow(e,0);if(s){const t=s._rows;m.endRowView=new Ml(t,0,t.length),o.endRowMessage&&(m.endMessageView=this._bodyView.addEndRowMessage(o,this._rowView))}o._pr=t}return m}addMasterRow(t,e,s,i,r){const n=this.$_addTable(this.doc,t,i,r),o=new il(e);o.appendTo(n.tBodies[0],th.HEADER_CLASS);const a=o.height,A=s.clone();return A.appendTo(n.tBodies[0]),a+A.height}printRow(t,e){const s=this._rowView;if(!s.visible)return;const i=this.model,r=i.dataRow.styleCallback,n=i.dataRow.rowCount,o=s.measuredWidth,a=s.$_trows,A=a.length,l=[];i.setPrinting(t,e);for(let n=0;n<A;n++){const o=a[n],A=s.$_cloneRow(o);let h;r&&(h=r(t,i.dataRow,e,void 0)),A.$_brt=Vi,A.$_bri=t.row,s.setCellDoms(o,A),s.applyCellStyles(t,i,A,n,h),l.push(A)}t.bandSummaryRuntime=i.summaryRuntime,t.bandSummaryRuntime.setGroup(null),s.$_refreshRowCells(t,o,1e5,!0);for(let t=0;t<A;t++){const e=l[t];s.unsetCellDoms(e,a[t]),e.classList.add(th.ROW_CLASS)}let h;return l.length>0&&(h=new Ul(l,0,n)),h}get headerView(){return this._headerView}get footerView(){return this._footerView}get dataRowView(){return this._rowView}get groupCount(){return this._groupViews.length}getGroupView(t){return this._groupViews[t]}indexOfGroup(t){let e=-1;for(let s of this._groupViews)if(s.visible&&(e++,s.model===t))return e;return e}getRowPoints(){const t=[];t.push(this._headerView.y,this.headerView.height),t.push(this._rowView.y,this._rowView.height),t.push(this._footerView.y,this._footerView.height);for(let e of this._groupViews)e.visible&&t.push(e.y,e.height);return t}getColPoints(){return this._rowView.getColPoints()}getColRect(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const s=this._rowView.getColRect(t,e);return s.height=this.height,s}getTableView(t){for(let e of[this._headerView,this._footerView,this._rowView])if(e.model===t)return e;for(let e of this._groupViews){if(e.header.model===t)return e.header;if(e.footer.model===t)return e.footer}}getTableViews(){const t=[this._headerView,this._footerView,this._rowView];for(let e of this._groupViews)t.push(e.header,e.footer);return t}get debugLabel(){return"table band"}_getCssSelector(){return"rr-table-band rr-group-element"}_needDesignBox(){return!0}get rowView(){return this._rowView}$_prepareHeads(t){if(!this._headViews){const e=this.model;this._headViews={},this.addChild(this._headViews[this.hash]=new Je(t,e,"TABLE BAND","TableBand","rr-band-head")),this.addChild(this._headViews[this._headerView.hash]=new Je(t,e.header,"HEADER","SimpleBand Header")),this.addChild(this._headViews[this._footerView.hash]=new Je(t,e.footer,"FOOTER","TableBand Footer")),this.addChild(this._headViews[this._rowView.hash]=new Je(t,e.dataRow,"DATA ROW","TableBand Data Row"));for(let e of this._groupViews)this.addChild(this._headViews[e.hash]=new Je(t,e.model,"GROUP-"+(e.model.index+1),"TableBand RowGroup"));this.addChild(this._headViews[this._detailView.hash]=new Je(t,e.detail,"DETAILS","TableBand Details"))}}_doMeasure(t,e,s,i){var r;const n=t.printing,o=this.model;let a,A=0,l=0;n||(this._headerView._masterView=this._bodyView._masterView=this._footerView._masterView=this._rowView);const h=o.getWidth(s);isNaN(h)||(s=h),s=o.getColWidth(s);let d=this._rowView;if(n||(a=d.measure(t,s,i),d.visible=d.model.visible,d.visible&&(A=Math.max(A,a.width),l+=a.height+this._rowGap)),d=this._headerView,!n&&(d.visible=d.model.visible)&&(a=d.measure(t,s,i),A=Math.max(A,a.width),l+=a.height+this._rowGap),d=this._footerView,!n&&(d.visible=d.model.visible)&&(t.bandSummaryRuntime=o.summaryRuntime,a=d.measure(t,s,i),A=Math.max(A,a.width),l+=a.height),this.$_prepareGroupViews(o,this.doc),n||(l+=this.$_measureGroupViews(o,t,s,i)),d=this._detailView,(d.visible=d.model.visible)&&(a=d.measure(t,s,i),A=Math.max(A,a.width),l+=a.height),!n&&(this.$_prepareHeads(this.doc),this._headViews)){const e=null===(r=this.container)||void 0===r?void 0:r.focusedItem;for(let r in this._headViews){const n=this._headViews[r];a=n.measure(t,s,i),A=Math.max(A,a.width),l+=a.height+2,n.setSelected(e)}}return new Me(A,l)}_doLayoutContent(t){const e=this.model,s=!!this._headViews,i=e.sectionCount,r=e.getColWidth(this.width),n=2+8*e.bandLevel;let o,a,A=0,l=t.printing?null:this._lines=[];s&&(a=this._headViews[this.hash],a.setBounds(n,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o=this._headerView,s&&(a=this._headViews[o.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((r-o.measuredWidth)/2,A,r,o.measuredHeight),o.setPrintStyles(),A+=o.height+this._rowGap,o.layoutContent(t)),null==l||l.push(o),o=this._rowView,s&&(a=this._headViews[o.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((r-o.measuredWidth)/2,A,r,o.measuredHeight),o.setPrintStyles(),A+=o.height+this._rowGap,o.layoutContent(t)),null==l||l.push(o),o=this._footerView,s&&(a=this._headViews[o.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((r-o.measuredWidth)/2,A,r,o.measuredHeight),o.setPrintStyles(),o.layoutContent(t),A+=o.height),null==l||l.push(o);for(let e of this._groupViews)s&&(a=this._headViews[e.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),e.setBounds((r-e.measuredWidth)/2,A,r,e.measuredHeight),e.setPrintStyles(),e.headIndent=n+16,e.layoutContent(t),A+=e.height,null==l||l.push(e);o=this._detailView,s&&(a=this._headViews[o.hash],a.setBounds(n+8,A+2,a.measuredWidth,a.measuredHeight),A+=a.height+2),o.visible&&(o.setBounds((r-o.measuredWidth)/2,A,o.measuredWidth,o.measuredHeight),A+=o.height,o.setPrintStyles(),o.layoutContent(t)),null==l||l.push(o),this._designView&&this.$_layoutCols(this.doc,i)}$_getHeadHeight(){return this._headViews[this.hash].height+1}_setDesignContent(t,e){const s=this.$_getHeadHeight();e.style.top=s+"px",e.style.height=this.height-s+"px",t&&super._setDesignContent(t,e),e.style.backgroundColor="white"}getLines(){return this._lines}_isPrintDataRow(){return this.model.pr<this._bodyView.bandRowCount}_isPrintEndRow(){return this.model.endRowCount>0}$_prepareGroupViews(t,e){const s=t.groups.count,i=this._groupViews;for(;i.length>s;){const t=i.pop();t.dispose(),this.removeChild(t)}for(;i.length<s;){const t=new Yl(e,null);this.addChild(t),i.push(t),t.$_setMasterView(this._rowView)}}$_measureGroupViews(t,e,s,i){const r=t.groups,n=this._groupViews;let o=0;for(let t=0;t<r.count;t++)n[t].model=r.get(t),o+=n[t].measure(e,s,i).height;return o}$_getGroupViews(t,e,s,i){if(e){const r=[];for(let n of e){const e=this._groupViews[n.index];e.model=n,t.noValueCallback=!0;try{e.measure(t,s,i)}finally{t.noValueCallback=!1}r.push(e)}return r.length?r:[]}}$_layoutCols(t,e){const s=this._colSpans;for(;s.length<e-1;){const e=t.createElement("span");e.className="rr-band-col",s.push(e),this._designView.appendChild(e)}const i=this.model.sectionGap,r=this.model.getColWidth(this.width),n=this.height-this.$_getHeadHeight();let o=r+i;for(let t=0;t<e-1;t++){const e=s[t];delete e.dataset.hidden,e.textContent=t+2+"",J.setBounds(e,o,0,r,n),o+=r+i}for(let t=e-1;t<s.length;t++)s[t].dataset.hidden="1"}$_createPage(t){const e=t.createElement("div");return e.style.position="relative",this._rowContainer.appendChild(e),e}$_createTableContainer(t,e,s){const i=t.createElement("div");return J.extend(i.style,{position:"absolute",left:e+"px",top:s+"px",width:this._colWidth+"px"}),i}$_createTable(t){const e=t.createElement("table"),s=t.createElement("tbody");return e.appendChild(this._bodyView.createColGroup(t,this._colWidth)),e.appendChild(s),e.style.position="absolute",sl.setTableStyle(e),e}$_cloneEmptyRow(t){const e=t.cloneNode(!0),s=e.cells;e.style.height="0px";for(let t=0;t<s.length;t++){const e=s[t],i=e.style;e.colSpan=1,e.rowSpan=1,e.innerHTML="",i.height="0",i.border="none",i.borderRight="1px solid black",i.margin="0",i.padding="0"}return e}$_addTable(t,e,s,i){const r=this.$_createTableContainer(t,s,i),n=this.$_createTable(t);return r.dataset._m_=this.model.shash,r.appendChild(n),e.appendChild(r),n}$_printLinear(t,e,s,i,r,n,o,a){function A(){U&&(m.forEach((t=>{const e=[];U.forEach((s=>{for(let i=0;i<s.count;i++)e.push(s.getCell(i,t))})),e[0].rowSpan=e.length;for(let t=1;t<e.length;t++)e[t].style.display="none"})),U=null)}function l(e,s){F=e.$_addTable(t,s,r,G),D=F.tBodies[0],K=!1}function h(i,r){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];w&&w.merge(),A();const o=i.$_createPage(t);return e.yBand=G=0,r&&(k=e.y=e.bodyTop),(isNaN(L)||!C||L<=0)&&(L=y),I.length||(M=0),_>0&&s.pageNo>0&&s.master.repeatMasterRow&&!M&&d(i,o),l(i,o),_>0&&s.pageNo>0&&!n&&s.repeatDetailHeader&&c(i),a.push(o),r&&s.pageNo++,o}function d(t,e){const s=t.rowView.masterBandView,i=t.rowView.masterHeaderView,r=t.rowView.masterRowView,n=s.addMasterRow(e,i,r,r.x,G);G+=n,k+=n}function c(t){if(_>0&&t._headers++,t._headerView.visible){O=new il(t._headerView._dom.firstChild);const e=O.height;e>0&&(O.appendTo(D,th.HEADER_CLASS),G+=e,k+=e,s.prevHead=!0)}}function u(i){if(w&&w.merge(),B||!isNaN(i._printedRowCount)){const t=i._footerView;t.resetStyleName(),s.clearSummary(),e.bandSummaryRuntime=s.summaryRuntime.setRows(B,i._masterRow).setRowCount(i._printedRowCount),t.measure(e,n,e.pageHeight),t.resize(t.measuredWidth,t.measuredHeight),t.setPrintStyles(),t.layoutContent(e)}const r=new il(i._footerView._dom.firstChild),o=r.height;o&&(k+o>V?(T=h(i,!0,!s.alwaysHeader),D.appendChild(i.$_cloneEmptyRow(i._tempRow))):K&&(F=i.$_addTable(t,T,0,G),D=F.tBodies[0],K=!1),r.appendTo(D,th.FOOTER_CLASS),G+=o,k+=o,k>V&&I.length,k>V&&(r.remove(),0===D.rows.length&&T.removeChild(F),T=h(i,!0),D.appendChild(i.$_cloneEmptyRow(i._tempRow)),r.appendTo(D,th.FOOTER_CLASS),G+=o,k+=o)),e.yBand=G,e.y=k,e.h=e.bodyHeight-(k-e.bodyTop)}const p=i?i.rowCount:0,_=s.bandLevel,g=s.detail,f=this._grouped,m=f&&s.dataRow.getMergedColumns(),w=!f&&Jl.create(s,s.dataRow.getMergedCells()),{rowsPerPage:y,breakRowsPerPage:C}=s.getRowsPerPage(),b=s.dataRow.rowCount,v=s.pr,B=_>0?[]:null,E=this._bodyView.endRowView;let P=this._bodyView.endMessageView;const{endRowCount:x,stopEndRow:S}=s.getEndRowCount(P?1:0),I=[];let R,T,O,F,D,L,N,H,Q,U,M=0,k=e.y,V=e.bodyBottom,G=e.yBand,K=!1,W=0,z=!1;for(0===_?T=h(this,!1):(T=a[a.length-1],s.pageNo++,L=y,l(this,T)),c(this);o.length>0||x>0&&M<x;){const i=o[0]&&o[0].$_grp,r=s.pr,d=!s.prevHead&&G===e.yBand&&(0===_||0===s.pageNo);if(d?(k+W>V&&G>0?T=h(this,!0):K&&l(this,T),k!==e.bodyTop||0!==_&&0!==M||c(this)):K&&l(this,T),o.length>0&&o[0].className===th.DUMMY_GROUP_FOOTER)o.splice(0,1),A();else if(N=H,N||(o.length>0?N=new Ul(o,0,i?i.trows:b):P?N=P:(N=R=E.clone(),I.push(N))),d&&Q&&N.first.$_brt!==Ki)N=Q.clone(),N.appendTo(D),G+=W=N.height,k+=W,L--,s.prevHead=!1;else if(this.rowView.visible&&(N.appendTo(D),W=N.height,G+=W,k+=W,H=null),k>V&&(s.prevHead||_>0||r>0))N.detach(),I.pop(),H=N,M>0&&(s.prevHead=!1),I.length&&S?M=x:T=h(this,!0);else{const i=!1;let l;N.isGroup&&!i&&A(),l=o.length?o.splice(0,N.count)[0]:P?P.first:R.first;const d=l.$_brt===Vi;if(B&&d&&B.push(r),r>0&&!N.isGroup&&d&&th.checkBlanks(s,r,N),!l.$_brb&&d){const t=N.isGroup?r:r+1;s.setPrinting(e,t,N.count)}f&&l.$_brt===Ki&&(Q=N),m&&(N.isGroup&&!i||(U||(U=[]),U.push(N))),(d||P&&l===P.first||R&&l===R.first)&&(L--,M++,P&&l===P.first&&(P=null)),w&&w.pushLine(N);const c=a.length;if(d&&g.count>0){e.row=0,e.y=k,e.h=e.bodyHeight-(k-e.bodyTop),e.yBand=G;for(let i=0;i<g.count;i++){const o=this._detailView.getChild(i),A=o.model;o.rowView.masterBandView=this,o.rowView.masterHeaderView=this._headerView.dom.firstChild,o.rowView.masterRowView=N,A.pageNo=0,A.masterValues=s.getValues(e,r,A._masterFlds),A.detailRows=A.rowsPerMaster;const l=e.detailRows=A.getNextDetailRows(e)||[];o.printBand(t,e,n,a,l,r)}T=a[a.length-1],K=e.y!==k,k=e.y,G=e.yBand}z=!1,L<=0&&(o.length>0||x<=0||M===x)&&s.pr<p&&(_>0&&s.repeatDetailFooter&&(u(this),z=!0),(o.length>0||z)&&r<p&&(a.length===c||z)&&(T=h(this,!0,0===o.length))),N.isGroupFooter&&i&&A()}}if(0==_||s.pr>v){if(!z&&(A(),u(this),z=!0,_>0&&y<Number.MAX_SAFE_INTEGER&&s.pr<p)){const s=this.$_createPage(t);e.yBand=G=0,e.y=e.bodyTop,k=e.bodyTop,a.push(s),l(this,s)}}else if(O){const t=O.height;O.remove(),G-=t,k-=t}z||(e.yBand=G,e.y=k,e.h=e.bodyHeight-(k-e.bodyTop))}$_printAcross(t,e,s,i,r,n,o,a,A){function l(e){P.length=0;for(let s=0;s<r;s++)B=e.$_addTable(t,v,i[2*s],w),P.push(B.tBodies[0])}function h(t){let e=0;for(let s=0;s<r;s++){const i=new il(t._headerView._dom.firstChild);e=Math.max(e,i.height),e&&i.appendTo(P[s],th.HEADER_CLASS)}w+=e,f=_+=e}const d=new il(this._footerView._dom.firstChild),c=d.height,u=s.dataRow.rowCount;let p=0===a?r:Math.min(r,a),_=e.y,g=e.bodyBottom,f=_,m=_,w=0;const y=new Array(r),C=new Array,b=new Array;let v,B,E;const P=[];let x;const S=this._bodyView.endRowView;let I=this._bodyView.endMessageView;const{endRowCount:R}=s.getEndRowCount(0),T=[];let O,F=0;const D=a<R?R:a;v=this.$_createPage(t),A.push(v),l(this),h(this);for(let t=0;t<p;t++)y[t]=[];for(;(this._isPrintDataRow()||this._isPrintEndRow())&&!(F>=D);){0===w&&h(this);let i=-1,n=0;C.length=0;for(let t=0;t<p&&!(F>=D);t++){s.pr<a?x=b.pop()||new Ul(o,s.tr,u):I&&0===T.length?(O=I,T.push(O),x=O):(O=S.clone(),T.push(O),x=O),x.appendTo(P[t]),C.push(x);const A=x.height;if(_+A>g){i=t;break}F++,y[t].push(x),s.setPrinting(e,s.pr+1,x.count),t===r-1&&(f+=A),n=Math.max(n,A)}if(i>=0){for(let t of C)t.detach(),b.push(t);T.pop(),0===T.length&&(F=0),f=_=e.bodyTop,w=0,i=-1,m=e.bodyTop,v=this.$_createPage(t),A.push(v),l(this)}else _+=n,w+=n,b.length=0}let L=0;if(a>0)for(let t=0;t<p;t++)y[t].length&&L++;const N=s.footer.attachToBody,H=N?Math.min(L,r-1):r-1;N&&(E=P[H]),E||(E=this.$_addTable(t,v,i[2*H],_-m).tBodies[0]),c&&d.appendTo(E,th.FOOTER_CLASS),N?_=Math.max(_,f+c):_+=c,_>g&&(d.remove(),v=this.$_createPage(t),A.push(v),l(this),E=P[H],c&&d.appendTo(E,th.FOOTER_CLASS),_=e.bodyTop+c),e.y=_,e.h=e.bodyHeight-(_-e.bodyTop)}$_printDown(t,e,s,i,r,n,o,a,A){function l(e){v=0;for(let s=0;s<r;s++){f[s]=u,m[s]=[],b=e.$_addTable(t,C,i[2*s],g).tBodies[0],B[s]=b;const r=new il(e._headerView._dom.firstChild);v=Math.max(v,r.height),v&&r.appendTo(b,th.HEADER_CLASS)}g+=v,u+=v}const h=new il(this._footerView._dom.firstChild),d=h.height;let c=0===a?r:Math.min(r,a),u=e.y,p=e.bodyBottom,_=u,g=0;const f=new Array(r),m=new Array(r);let w,y,C,b,v=0;const B=new Array(r),E=s.dataRow.rowCount,P=this._bodyView.endRowView;let x=this._bodyView.endMessageView;const{endRowCount:S}=s.getEndRowCount(0),I=[];let R,T=0;const O=a<S?S:a;C=this.$_createPage(t),A.push(C),l(this);do{if(T>=O)break;for(let i=0;i<r;i++)for(0===g&&(0===i?l(this):(g+=v,u+=v));(this._isPrintDataRow()||this._isPrintEndRow())&&!(T>=O);){w=y,s.pr<a?w=new Ul(o,s.tr,E):x&&0===I.length?(R=x,I.push(R),w=R):(R=P.clone(),I.push(R),w=R),y=null,b=B[i],w.appendTo(b);const n=w.height;if(g+=n,u+=n,f[i]=u,m[i].push(w),u>p){w.detach(),y=w,m[i].pop(),I.pop(),g=0,i===r-1?(0===I.length&&(T=0),C=this.$_createPage(t),A.push(C),_=e.bodyTop):_=A.length>1?e.bodyTop:e.y,u=_;break}T++,s.setPrinting(e,s.pr+1,w.count)}}while(this._isPrintDataRow()||this._isPrintEndRow());let F=0;if(a>1){let t=0;for(let e=0;e<f.length;e++)for(let s=0;s<m[e].length;s++)t+=m[e][s].height;const e=new Array(c);let s=Math.round(t/c);for(let t=0;t<c-1;t++){let i,r=m[t],n=0,o=0;for(;n<r.length;){if(o+=i=r[n].height,o>s){o-=i;break}n++}e[t]=o;const a=m[t+1];let A=0;for(;n<r.length;){const t=r[n];r.splice(n,1),a.splice(A++,0,t)}g=v;for(let e=0;e<a.length;e++)a[e].detach(),a[e].appendTo(B[t+1])}e[r-1]=0;for(let t=0;t<m[r-1].length;t++)e[r-1]+=m[r-1][t].height;for(let t=0;t<2;t++)(()=>{for(let t=c-1;t>0;t--)for(;e[t]>e[t-1];){const s=m[t],i=m[t-1],r=s.shift(),n=r.height;r.detach(),e[t]-=n,i.push(r),r.appendTo(B[t-1]),e[t-1]+=n}})();for(let t=0;t<r;t++){let e=m[t];if(f[t]=_+v,e.length>0){F=t+1;for(let s=0;s<e.length;s++)f[t]+=e[s].height}}}else{for(let t=0;t<r;t++)f[t]=_+v;F=a,F&&(f[0]+=m[0][0].height)}const D=s.footer.attachToBody,L=D?Math.min(F,r-1):r-1,N=D?f[L]:0;u=f[0];for(let t=1;t<c;t++)u=Math.max(u,f[t]);b=D?B[L]:this.$_addTable(t,C,i[2*L],u-_).tBodies[0],d&&h.appendTo(b,th.FOOTER_CLASS),D?u=Math.max(u,N+d):u+=d,u>p&&(h.remove(),C=this.$_createPage(t),A.push(C),b=this.$_addTable(t,C,i[2*L],g=0).tBodies[0],d&&h.appendTo(b,th.FOOTER_CLASS),u=e.bodyTop+d),e.y=u,e.h=e.bodyHeight-(u-e.bodyTop)}$_printMulti(t,e,s,i,r,n,o,a,A){let l,h,d=Math.min(r,a);const c=[],u=new Array(r);let p=0;l=this.$_createPage(t),A.push(l);for(let e=0;e<r;e++)h=this.$_addTable(t,l,i[2*e],p),c.push(h.tBodies[0]);!function(t){let e=0;for(let s=0;s<r;s++){const i=new il(t._headerView._dom.firstChild);e=Math.max(e,i.height),e&&i.appendTo(c[s],th.HEADER_CLASS)}p+=e}(this);for(let t=0;t<d;t++)u[t]=[]}}th.HEADER_CLASS="-rrp-tableband-header",th.FOOTER_CLASS="-rrp-tableband-footer",th.ROW_CLASS="-rrp-tableband-row",th.DUMMY_GROUP_FOOTER="_dummy_group_footer_";class eh extends ki{constructor(t,e){super(t,e,"floatingContainerView")}_getCssSelector(){return"rr-floating-container rr-group-element"}get debugLabel(){return"floating"}get floating(){return!0}_needDesignBox(){return!0}_doMeasure(t,e,s,i){if(this.measureFixed||this._setModelSize(this.model,e,s,i,!0),super._doMeasure(t,e,s,i),this.childCount>0){const t=this.getChild(0);return new Me(t.measuredWidth,t.measuredHeight)}return new Me}_doAfterMeasure(t,e,s,i,r){!t.printing&&this.model.designHeight>0&&(r.height=this.model.designHeight),!t.printing&&this.model.designWidth>0&&(r.width=this.model.designWidth),super._doAfterMeasure(t,e,s,i,r),t.printing||(this._isEmpty()?this.dom.style.background="":(this.dom.style.background="#ff880010",this.dom.style.border=t.reportView.focusedElement===this.getChild(0)?"1px dashed #000":"1px dashed #55000080"))}_setDesignContent(t,e){super._setDesignContent(!0,e)}_layoutItem(t,e,s,i,r,n,o){i=(n-e.width)/2,r=(o-e.height)/2,e.move(i,r),e.setPrintStyles()}}const sh="http://www.w3.org/2000/svg";let ih=0;class rh extends A{constructor(t,e){super(),this._transforms=[],this._defs=t,this._element=e}_doDispose(){this.clear(),super._doDispose()}get doc(){return j(this._element)||document}get element(){return this._element}init(t,e){return this._defs=t,this._element=e,this}clear(){this._defs=null,this._element=null,this._transforms=null}save(){this._transforms.push(this._trans),this._trans=""}restore(){this._trans=this._transforms.pop()}translate(t,e){this._trans+="translate("+t+","+e+")"}rotate(t){this._trans+="rotate("+180*t/Math.PI+")"}rotateAt(t,e,s){this._trans+="rotate("+180*t/Math.PI+","+e+",)"}scale(t,e){this._trans+="scale("+t+","+e+")"}clipRect(t){this.clip(t.x,t.y,t.width,t.height)}clip(t,e,s,i){const r=this.doc,n=ih++,o=r.createElementNS(sh,"clipPath");o.setAttributeNS(null,"id","clip"+n);const a=r.createElementNS(sh,"rect");a.x.baseVal.value=t,a.y.baseVal.value=e,a.width.baseVal.value=s,a.height.baseVal.value=i,o.appendChild(a),this._defs.appendChild(o)}line(t,e,s,i,r){const n=this.doc.createElementNS(sh,"line");return this._element.appendChild(n),n.x1.baseVal.value=e,n.y1.baseVal.value=s,n.x2.baseVal.value=i,n.y2.baseVal.value=r,this.$_setStyles(n,t),n}sline(t,e,s,i,r){const n=this.doc.createElementNS(sh,"line");return this._element.appendChild(n),n.x1.baseVal.valueAsString=e,n.y1.baseVal.valueAsString=s,n.x2.baseVal.valueAsString=i,n.y2.baseVal.valueAsString=r,this.$_setStyles(n,t),n}lines(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];if(null==s||s.length<4)return;const r=this.doc.createElementNS(sh,"polyline"),n=[];n.push(s[0]+","+s[1]);for(let t=2;t<s.length;t+=2)n.push(s[t]+","+s[t+1]);r.setAttributeNS(null,"points",n.join(" ")),this.$_setStyles(r,t),this._element.appendChild(r)}polygon(t,e){if(null==e||e.length<4)return;const s=this.doc.createElementNS(sh,"polygon"),i=[];i.push(e[0]+","+e[1]);for(let t=2;t<e.length;t+=2)i.push(e[t]+","+e[t+1]);return this._trans&&s.setAttributeNS(null,"transform",this._trans),s.setAttributeNS(null,"points",i.join(" ")),this.$_setStyles(s,t),this._element.appendChild(s),s}quadratic(t,e,s,i,r,n,o){const a=this.doc.createElementNS(sh,"path");a.setAttributeNS(null,"d",["M",e,s,"Q",i,r,n,o].join(" ")),this.$_setStyles(a,t),this._element.appendChild(a)}squadratic(t,e,s,i,r,n,o){const a=this.doc.createElementNS(sh,"path");a.setAttributeNS(null,"d",["M",e+"%",s+"%","Q",i+"%",r+"%",n+"%",o+"%"].join(" ")),this.$_setStyles(a,t),this._element.appendChild(a)}curve(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];const r=this.$_getCurvedLinePath(s,0,s.length-1);if(r){const e=this.doc.createElementNS(sh,"path");e.setAttributeNS(null,"d",r.join(" ")),this.$_setStyles(e,t),this._element.appendChild(e)}}scurve(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];const r=this.$_getCurvedLinePath(s,0,s.length-1);if(r){const e=this.doc.createElementNS(sh,"path");for(let t=0;t<r.length;t++)"number"==typeof r[t]&&(r[t]=r[t]+"%");e.setAttributeNS(null,"d",r.join(" ")),this.$_setStyles(e,t),this._element.appendChild(e)}}curveRange(t,e,s,i,r){if(i&&i.length>1&&r&&r.length>1&&(t||e)){let n=this.$_getCurvedLinePath(i,0,i.length/2-1,!0);if(n){n.push("L",r[r.length-2],[r.length-1]);const o=this.$_getCurvedLinePath(r,r.length/2-1,0,!1);o&&(n=n.concat(o)),n.push("L",i[0],i[1]);const a=this.doc.createElementNS(sh,"path");a.setAttributeNS(null,"d",n.join(" ")),this.$_fillOrStroke(a,t,e,s),this._element.appendChild(a)}}}rect(t,e){const s=this.doc.createElementNS(sh,"rect");s.x.baseVal.value=e.x,s.y.baseVal.value=e.y,s.width.baseVal.value=e.width,s.height.baseVal.value=e.height,this.$_setStyles(s,t),this._element.appendChild(s)}srect(t,e){const s=this.doc.createElementNS(sh,"rect");s.x.baseVal.valueAsString=e.x+"%",s.y.baseVal.valueAsString=e.y+"%",s.width.baseVal.valueAsString=e.width+"%",s.height.baseVal.valueAsString=e.height+"%",this.$_setStyles(s,t),this._element.appendChild(s)}bounds(t,e,s,i,r){const n=this.doc.createElementNS(sh,"rect");n.x.baseVal.value=e,n.y.baseVal.value=r<0?s+r:s,n.width.baseVal.value=i,n.height.baseVal.value=Math.abs(r),this.$_setStyles(n,t),this._element.appendChild(n)}pbounds(t,e,s,i,r){const n=this.doc.createElementNS(sh,"rect");n.x.baseVal.valueAsString=e+"%",n.y.baseVal.valueAsString=(r<0?s+r:s)+"%",n.width.baseVal.valueAsString=i+"%",n.height.baseVal.valueAsString=Math.abs(r)+"%",this.$_setStyles(n,t),this._element.appendChild(n)}sbounds(t,e,s,i,r){const n=this.doc.createElementNS(sh,"rect");n.x.baseVal.valueAsString=e,n.y.baseVal.valueAsString=s,n.width.baseVal.valueAsString=i,n.height.baseVal.valueAsString=r,this.$_setStyles(n,t),this._element.appendChild(n)}circle(t,e,s,i){const r=this.doc.createElementNS(sh,"circle");r.cx.baseVal.value=e,r.cy.baseVal.value=s,r.r.baseVal.value=i,this.$_setStyles(r,t),this._element.appendChild(r)}scircle(t,e,s,i){const r=this.doc.createElementNS(sh,"circle");r.cx.baseVal.valueAsString=e,r.cy.baseVal.valueAsString=s,r.r.baseVal.valueAsString=i,this.$_setStyles(r,t),this._element.appendChild(r)}circleRect(t,e,s,i,r,n){const o=this.doc.createElementNS(sh,"circle"),a=s+r/2,A=i+n/2,l=Math.min(r,n)/2;o.cx.baseVal.value=a,o.cy.baseVal.value=A,o.r.baseVal.value=l,this.$_setStyles(o,t),this._element.appendChild(o)}scircleRect(t,e,s,i,r){const n=this.doc.createElementNS(sh,"circle"),o=e+i/2,a=s+r/2,A=Math.min(i,r)/2;n.cx.baseVal.valueAsString=o+"%",n.cy.baseVal.valueAsString=a+"%",n.r.baseVal.valueAsString=A+"%",this.$_setStyles(n,t),this._element.appendChild(n)}ellipse(t,e,s,i,r){const n=this.doc.createElementNS(sh,"ellipse");return n.cx.baseVal.value=e,n.cy.baseVal.value=s,n.rx.baseVal.value=i,n.ry.baseVal.value=r,this.$_setStyles(n,t),this._element.appendChild(n),n}sellipse(t,e,s,i,r){const n=this.doc.createElementNS(sh,"ellipse");n.cx.baseVal.valueAsString=e+"%",n.cy.baseVal.valueAsString=s+"%",n.rx.baseVal.valueAsString=i+"%",n.ry.baseVal.valueAsString=r+"%",this.$_setStyles(n,t),this._element.appendChild(n)}ellipseRect(t,e,s,i,r){const n=this.doc.createElementNS(sh,"ellipse"),o=i/2,a=r/2;return n.cx.baseVal.value=e+o,n.cy.baseVal.value=s+a,n.rx.baseVal.value=o,n.ry.baseVal.value=a,this.$_setStyles(n,t),this._element.appendChild(n),n}sellipseRect(t,e,s,i,r){const n=this.doc.createElementNS(sh,"ellipse"),o=i/2,a=r/2;n.cx.baseVal.valueAsString=e+o+"%",n.cy.baseVal.valueAsString=s+a+"%",n.rx.baseVal.valueAsString=o+"%",n.ry.baseVal.valueAsString=a+"%",this.$_setStyles(n,t),this._element.appendChild(n)}text(t,e,s,i,r,n,o,a,A){const l=this.doc.createElementNS(sh,"text");e=e||"Verdana",l.setAttributeNS(null,"y",a+""),l.setAttributeNS(null,"dy","top"),l.setAttributeNS(null,"x",o+""),l.setAttributeNS(null,"text-anchor",A),l.setAttributeNS(null,"font-family",e),l.setAttributeNS(null,"font-size",s+""),r&&l.setAttributeNS(null,"text-decoration",r),l[J.TextProp]=n,this.$_setStyles(l,t),this._element.appendChild(l)}stext(t,e,s,i,r){const n=this.doc.createElementNS(sh,"text");n.setAttributeNS(null,"y",i+"%"),n.setAttributeNS(null,"dy","top"),n.setAttributeNS(null,"x",s+"%"),n[J.TextProp]=e,this.$_setStyles(n,t),this._element.appendChild(n)}$_setStyles(t,e){"string"==typeof e?t.setAttribute("class",e):e&&J.extend(t.style,e)}$_stroke(t,e,s){t.style.fill="none",t.style.stroke=e,isNaN(s)||(t.style.strokeWidth=s+"")}$_fill(t,e){t.style.fill=e}$_fillOrStroke(t,e,s,i){s&&(t.style.stroke=s,isNaN(i)||(t.style.strokeWidth=i+"")),t.style.fill=e||"none"}$_getCurvedLinePath(t,e,s){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t&&s!=e&&t.length/2>s){const r=[],n=e>s?-1:1;let o=e;if(i&&r.push("M",t[2*o],t[2*o+1]),2==Math.abs(s-e))return r.push("L",t[2*(o+n)],t[2*(o+n)+1]),r;const a=.25,A={x:0,y:0},l={x:0,y:0},h={x:0,y:0},d={x:t[2*(o+n)]-t[2*o],y:t[2*(o+n)+1]-t[2*o+1]};let c={x:0,y:0};const u={x:0,y:0},p={x:0,y:0},_={x:0,y:0};let g=Math.sqrt(d.x*d.x+d.y*d.y);d.x/=g,d.y/=g;let f=t[2*(o+n)]-t[2*o],m=t[2*o],w=t[2*o+1];for(o+=n;o!=s;o+=n){h.x=-d.x,h.y=-d.y,d.x=t[2*(o+n)]-t[2*o],d.y=t[2*(o+n)]-t[2*o+1],g=Math.sqrt(d.x*d.x+d.y*d.y),d.x/=g,d.y/=g,d.x<h.x?(c.x=h.x-d.x,c.y=h.y-d.y):(c.x=d.x-h.x,c.y=d.y-h.y);const s=Math.sqrt(c.x*c.x+c.y*c.y);c.x/=s,c.y/=s,h.y*d.y>=0&&(c={x:1,y:0}),A.x=-c.x*f*a,A.y=-c.y*f*a,o==n+e?r.push("Q",t[2*o]+A.x,t[2*o+1]+A.y,t[2*o],t[2*o+1]):(u.x=m+l.x,u.y=w+l.y,p.x=t[2*o]+A.x,p.y=t[2*o+1]+A.y,_.x=(u.x+p.x)/2,_.y=(u.y+p.y)/2,r.push("Q",u.x,u.y,_.x,_.y),r.push("Q",p.x,p.y,t[2*o],t[2*o+1])),f=t[2*(o+n)]-t[2*o],l.x=c.x*f*a,l.y=c.y*f*a,m=t[2*o],w=t[2*o+1]}return r.push("Q",m+l.x,w+l.y,t[2*o],t[2*o+1]),r}return null}}class nh extends A{constructor(t){super();const e=j(t),s=this._element=e.createElementNS(sh,"svg"),i=s.style,r=this._defs=e.createElementNS(sh,"defs");s.appendChild(r),i.background="",i.border="none",i.pointerEvents="none",t.appendChild(s),this._renderer=new rh(this._defs)}static createSVG(t,e,s){const i=j(t),r=i.createElementNS(sh,"svg");return r.appendChild(i.createElementNS(sh,"defs")),r.appendChild(i.createElementNS(sh,"g")),e&&r.setAttribute("class","rr-rating-shape"),J.extend(r.style,{background:"",border:"none",pointerEvents:"none"}),s&&J.extend(r.style,s),t.appendChild(r),r}static renderSVG(t,e,s,i){const r=s.lastElementChild,n=this._renderer.init(s.firstChild,r);J.clearChildren(r),i.call(t,e,n,s.clientWidth,s.clientHeight),n.clear()}static setAttr(t,e,s){t.setAttribute(e,s)}static setStyle(t,e,s){t.style[e]=s}static prepareExport(t,e,s){t.attributes.viewBox||t.setAttribute("viewBox",[0,0,e,s].join(" "));const i=t.style;if(!i.fill||!i.stroke){const e=getComputedStyle(t);i.fill||(i.fill=e.fill),i.stroke||(i.stroke=e.stroke)}}_doDispose(){this._renderer=this._renderer.dispose(),this._element.parentElement.removeChild(this._element),this._element=this._defs=null,super._doDispose()}get element(){return this._element}render(t){this._clear(),t?t.call(this,this._renderer,this._element.clientWidth,this._element.clientHeight):this._doRender(this._renderer,this._element.clientWidth,this._element.clientHeight)}_clear(){this._element.childElementCount>1&&this._element.removeChild(this._element.lastElementChild);const t=j(this._element).createElementNS(sh,"g");this._element.appendChild(t),this._renderer._element=t}_doRender(t,e,s){}}nh._renderer=new rh;var oh="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ah(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ah(t){var e={exports:{}};return t(e,e.exports),e.exports}var lh,hh=function t(e,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.text=s.text||e,this.options=s},dh=Object.defineProperty({default:hh},"__esModule",{value:!0}),ch=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.CODE39=void 0;var s,i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}();var r=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=t.toUpperCase(),s.mod43&&(t+=function(t){return n[t]}(function(t){for(var e=0,s=0;s<t.length;s++)e+=A(t[s]);return e%=43}(t))),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"encode",value:function(){for(var t=a("*"),e=0;e<this.data.length;e++)t+=a(this.data[e])+"0";return{data:t+=a("*"),text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)}}]),e}(((s=dh)&&s.__esModule?s:{default:s}).default),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],o=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function a(t){return function(t){return o[t].toString(2)}(A(t))}function A(t){return n.indexOf(t)}e.CODE39=r})),uh=Ah((function(t,e){var s;function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}Object.defineProperty(e,"__esModule",{value:!0});var r=e.SET_A=0,n=e.SET_B=1,o=e.SET_C=2;e.SHIFT=98;var a=e.START_A=103,A=e.START_B=104,l=e.START_C=105;e.MODULO=103,e.STOP=106,e.FNC1=207,e.SET_BY_CODE=(i(s={},a,r),i(s,A,n),i(s,l,o),s),e.SWAP={101:r,100:n,99:o},e.A_START_CHAR=String.fromCharCode(208),e.B_START_CHAR=String.fromCharCode(209),e.C_START_CHAR=String.fromCharCode(210),e.A_CHARS="[\0-_È-Ï]",e.B_CHARS="[ -È-Ï]",e.C_CHARS="(Ï*[0-9]{2}Ï*)",e.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]})),ph=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}();var _h=function(t){function e(t,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.substring(1),s));return i.bytes=t.split("").map((function(t){return t.charCodeAt(0)})),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),ph(e,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var t=this.bytes,s=t.shift()-105,i=uh.SET_BY_CODE[s];if(void 0===i)throw new RangeError("The encoding does not start with a start character.");!0===this.shouldEncodeAsEan128()&&t.unshift(uh.FNC1);var r=e.next(t,1,i);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:e.getBar(s)+r.result+e.getBar((r.checksum+s)%uh.MODULO)+e.getBar(uh.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var t=this.options.ean128||!1;return"string"==typeof t&&(t="true"===t.toLowerCase()),t}}],[{key:"getBar",value:function(t){return uh.BARS[t]?uh.BARS[t].toString():""}},{key:"correctIndex",value:function(t,e){if(e===uh.SET_A){var s=t.shift();return s<32?s+64:s-32}return e===uh.SET_B?t.shift()-32:10*(t.shift()-48)+t.shift()-48}},{key:"next",value:function(t,s,i){if(!t.length)return{result:"",checksum:0};var r=void 0,n=void 0;if(t[0]>=200){n=t.shift()-105;var o=uh.SWAP[n];void 0!==o?r=e.next(t,s+1,o):(i!==uh.SET_A&&i!==uh.SET_B||n!==uh.SHIFT||(t[0]=i===uh.SET_A?t[0]>95?t[0]-96:t[0]:t[0]<32?t[0]+96:t[0]),r=e.next(t,s+1,i))}else n=e.correctIndex(t,i),r=e.next(t,s+1,i);var a=n*s;return{result:e.getBar(n)+r.result,checksum:a+r.checksum}}}]),e}(((lh=dh)&&lh.__esModule?lh:{default:lh}).default),gh=_h,fh=Object.defineProperty({default:gh},"__esModule",{value:!0}),mh=function(t){return t.match(new RegExp("^"+uh.A_CHARS+"*"))[0].length},wh=function(t){return t.match(new RegExp("^"+uh.B_CHARS+"*"))[0].length},yh=function(t){return t.match(new RegExp("^"+uh.C_CHARS+"*"))[0]};function Ch(t,e){var s=e?uh.A_CHARS:uh.B_CHARS,i=t.match(new RegExp("^("+s+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(i)return i[1]+String.fromCharCode(204)+bh(t.substring(i[1].length));var r=t.match(new RegExp("^"+s+"+"))[0];return r.length===t.length?t:r+String.fromCharCode(e?205:206)+Ch(t.substring(r.length),!e)}function bh(t){var e=yh(t),s=e.length;if(s===t.length)return t;t=t.substring(s);var i=mh(t)>=wh(t);return e+String.fromCharCode(i?206:205)+Ch(t,i)}var vh=Object.defineProperty({default:function(t){var e=void 0;if(yh(t).length>=2)e=uh.C_START_CHAR+bh(t);else{var s=mh(t)>wh(t);e=(s?uh.A_START_CHAR:uh.B_START_CHAR)+Ch(t,s)}return e.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,(function(t,e){return String.fromCharCode(203)+e}))}},"__esModule",{value:!0}),Bh=Ph(fh),Eh=Ph(vh);function Ph(t){return t&&t.__esModule?t:{default:t}}function xh(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var Sh=function(t){function e(t,s){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),/^[\x00-\x7F\xC8-\xD3]+$/.test(t))var i=xh(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,(0,Eh.default)(t),s));else i=xh(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s));return xh(i)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(Bh.default),Ih=Object.defineProperty({default:Sh},"__esModule",{value:!0}),Rh=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),Th=function(t){return t&&t.__esModule?t:{default:t}}(fh);var Oh=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,uh.A_START_CHAR+t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Rh(e,[{key:"valid",value:function(){return new RegExp("^"+uh.A_CHARS+"+$").test(this.data)}}]),e}(Th.default),Fh=Object.defineProperty({default:Oh},"__esModule",{value:!0}),Dh=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),Lh=function(t){return t&&t.__esModule?t:{default:t}}(fh);var Nh=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,uh.B_START_CHAR+t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Dh(e,[{key:"valid",value:function(){return new RegExp("^"+uh.B_CHARS+"+$").test(this.data)}}]),e}(Lh.default),Hh=Object.defineProperty({default:Nh},"__esModule",{value:!0}),Qh=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),Uh=function(t){return t&&t.__esModule?t:{default:t}}(fh);var Mh=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,uh.C_START_CHAR+t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Qh(e,[{key:"valid",value:function(){return new RegExp("^"+uh.C_CHARS+"+$").test(this.data)}}]),e}(Uh.default),kh=Object.defineProperty({default:Mh},"__esModule",{value:!0}),Vh=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.CODE128C=e.CODE128B=e.CODE128A=e.CODE128=void 0;var s=o(Ih),i=o(Fh),r=o(Hh),n=o(kh);function o(t){return t&&t.__esModule?t:{default:t}}e.CODE128=s.default,e.CODE128A=i.default,e.CODE128B=r.default,e.CODE128C=n.default})),Gh=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.SIDE_BIN="101",e.MIDDLE_BIN="01010",e.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},e.EAN2_STRUCTURE=["LL","LG","GL","GG"],e.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],e.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]})),Kh=function(t,e,s){var i=t.split("").map((function(t,s){return Gh.BINARIES[e[s]]})).map((function(e,s){return e?e[t[s]]:""}));if(s){var r=t.length-1;i=i.map((function(t,e){return e<r?t+s:t}))}return i.join("")},Wh=Object.defineProperty({default:Kh},"__esModule",{value:!0}),zh=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),$h=Xh(Wh);function Xh(t){return t&&t.__esModule?t:{default:t}}var jh=function(t){function e(t,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s));return i.fontSize=!s.flat&&s.fontSize>10*s.width?10*s.width:s.fontSize,i.guardHeight=s.height+i.fontSize/2+s.textMargin,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),zh(e,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(t,e){return this.text.substr(t,e)}},{key:"leftEncode",value:function(t,e){return(0,$h.default)(t,e)}},{key:"rightText",value:function(t,e){return this.text.substr(t,e)}},{key:"rightEncode",value:function(t,e){return(0,$h.default)(t,e)}},{key:"encodeGuarded",value:function(){var t={fontSize:this.fontSize},e={height:this.guardHeight};return[{data:Gh.SIDE_BIN,options:e},{data:this.leftEncode(),text:this.leftText(),options:t},{data:Gh.MIDDLE_BIN,options:e},{data:this.rightEncode(),text:this.rightText(),options:t},{data:Gh.SIDE_BIN,options:e}]}},{key:"encodeFlat",value:function(){return{data:[Gh.SIDE_BIN,this.leftEncode(),Gh.MIDDLE_BIN,this.rightEncode(),Gh.SIDE_BIN].join(""),text:this.text}}}]),e}(Xh(dh).default),Yh=Object.defineProperty({default:jh},"__esModule",{value:!0}),Jh=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),Zh=function t(e,s,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,s);if(void 0===r){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,s,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0},qh=function(t){return t&&t.__esModule?t:{default:t}}(Yh);var td=function(t){var e=t.substr(0,12).split("").map((function(t){return+t})).reduce((function(t,e,s){return s%2?t+3*e:t+e}),0);return(10-e%10)%10},ed=function(t){function e(t,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{12}$/)&&(t+=td(t));var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s));return i.lastChar=s.lastChar,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Jh(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{13}$/)&&+this.data[12]===td(this.data)}},{key:"leftText",value:function(){return Zh(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var t=this.data.substr(1,6),s=Gh.EAN13_STRUCTURE[this.data[0]];return Zh(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,s)}},{key:"rightText",value:function(){return Zh(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var t=this.data.substr(7,6);return Zh(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRRRR")}},{key:"encodeGuarded",value:function(){var t=Zh(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(t.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(t.push({data:"00"}),t.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),t}}]),e}(qh.default),sd=Object.defineProperty({default:ed},"__esModule",{value:!0}),id=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),rd=function t(e,s,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,s);if(void 0===r){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,s,i)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(i):void 0},nd=function(t){return t&&t.__esModule?t:{default:t}}(Yh);var od=function(t){var e=t.substr(0,7).split("").map((function(t){return+t})).reduce((function(t,e,s){return s%2?t+e:t+3*e}),0);return(10-e%10)%10},ad=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{7}$/)&&(t+=od(t)),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),id(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{8}$/)&&+this.data[7]===od(this.data)}},{key:"leftText",value:function(){return rd(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var t=this.data.substr(0,4);return rd(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,"LLLL")}},{key:"rightText",value:function(){return rd(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var t=this.data.substr(4,4);return rd(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRR")}}]),e}(nd.default),Ad=Object.defineProperty({default:ad},"__esModule",{value:!0}),ld=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),hd=cd(Wh),dd=cd(dh);function cd(t){return t&&t.__esModule?t:{default:t}}var ud=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),ld(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{5}$/)}},{key:"encode",value:function(){var t,e,s=Gh.EAN5_STRUCTURE[(t=this.data,e=t.split("").map((function(t){return+t})).reduce((function(t,e,s){return s%2?t+9*e:t+3*e}),0),e%10)];return{data:"1011"+(0,hd.default)(this.data,s,"01"),text:this.text}}}]),e}(dd.default),pd=ud,_d=Object.defineProperty({default:pd},"__esModule",{value:!0}),gd=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),fd=md(Wh);function md(t){return t&&t.__esModule?t:{default:t}}var wd=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),gd(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{2}$/)}},{key:"encode",value:function(){var t=Gh.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,fd.default)(this.data,t,"01"),text:this.text}}}]),e}(md(dh).default),yd=Object.defineProperty({default:wd},"__esModule",{value:!0}),Cd=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),bd=Ed,vd=Bd(Wh);function Bd(t){return t&&t.__esModule?t:{default:t}}function Ed(t){var e,s=0;for(e=1;e<11;e+=2)s+=parseInt(t[e]);for(e=0;e<11;e+=2)s+=3*parseInt(t[e]);return(10-s%10)%10}var Pd=function(t){function e(t,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{11}$/)&&(t+=Ed(t));var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s));return i.displayValue=s.displayValue,s.fontSize>10*s.width?i.fontSize=10*s.width:i.fontSize=s.fontSize,i.guardHeight=s.height+i.fontSize/2+s.textMargin,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Cd(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{12}$/)&&this.data[11]==Ed(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var t="";return t+="101",t+=(0,vd.default)(this.data.substr(0,6),"LLLLLL"),t+="01010",t+=(0,vd.default)(this.data.substr(6,6),"RRRRRR"),{data:t+="101",text:this.text}}},{key:"guardedEncoding",value:function(){var t=[];return this.displayValue&&t.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),t.push({data:"101"+(0,vd.default)(this.data[0],"L"),options:{height:this.guardHeight}}),t.push({data:(0,vd.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),t.push({data:"01010",options:{height:this.guardHeight}}),t.push({data:(0,vd.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),t.push({data:(0,vd.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&t.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),t}}]),e}(Bd(dh).default),xd=Object.defineProperty({checksum:bd,default:Pd},"__esModule",{value:!0}),Sd=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),Id=Td(Wh),Rd=Td(dh);function Td(t){return t&&t.__esModule?t:{default:t}}function Od(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var Fd=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],Dd=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]];function Ld(t,e){for(var s=parseInt(t[t.length-1]),i=Fd[s],r="",n=0,o=0;o<i.length;o++){var a=i[o];r+="X"===a?t[n++]:a}return""+(r=""+e+r)+(0,xd.checksum)(r)}var Nd=function(t){function e(t,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=Od(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s));if(i.isValid=!1,-1!==t.search(/^[0-9]{6}$/))i.middleDigits=t,i.upcA=Ld(t,"0"),i.text=s.text||""+i.upcA[0]+t+i.upcA[i.upcA.length-1],i.isValid=!0;else{if(-1===t.search(/^[01][0-9]{7}$/))return Od(i);if(i.middleDigits=t.substring(1,t.length-1),i.upcA=Ld(i.middleDigits,t[0]),i.upcA[i.upcA.length-1]!==t[t.length-1])return Od(i);i.isValid=!0}return i.displayValue=s.displayValue,s.fontSize>10*s.width?i.fontSize=10*s.width:i.fontSize=s.fontSize,i.guardHeight=s.height+i.fontSize/2+s.textMargin,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Sd(e,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var t="";return t+="101",t+=this.encodeMiddleDigits(),{data:t+="010101",text:this.text}}},{key:"guardedEncoding",value:function(){var t=[];return this.displayValue&&t.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),t.push({data:"101",options:{height:this.guardHeight}}),t.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),t.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&t.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),t}},{key:"encodeMiddleDigits",value:function(){var t=this.upcA[0],e=this.upcA[this.upcA.length-1],s=Dd[parseInt(e)][parseInt(t)];return(0,Id.default)(this.middleDigits,s)}}]),e}(Rd.default),Hd=Object.defineProperty({default:Nd},"__esModule",{value:!0}),Qd=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.UPCE=e.UPC=e.EAN2=e.EAN5=e.EAN8=e.EAN13=void 0;var s=A(sd),i=A(Ad),r=A(_d),n=A(yd),o=A(xd),a=A(Hd);function A(t){return t&&t.__esModule?t:{default:t}}e.EAN13=s.default,e.EAN8=i.default,e.EAN5=r.default,e.EAN2=n.default,e.UPC=o.default,e.UPCE=a.default})),Ud=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.START_BIN="1010",e.END_BIN="11101",e.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]})),Md=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),kd=function(t){return t&&t.__esModule?t:{default:t}}(dh);function Vd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gd(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var Kd=function(t){function e(){return Vd(this,e),Gd(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Md(e,[{key:"valid",value:function(){return-1!==this.data.search(/^([0-9]{2})+$/)}},{key:"encode",value:function(){var t=this,e=this.data.match(/.{2}/g).map((function(e){return t.encodePair(e)})).join("");return{data:Ud.START_BIN+e+Ud.END_BIN,text:this.text}}},{key:"encodePair",value:function(t){var e=Ud.BINARIES[t[1]];return Ud.BINARIES[t[0]].split("").map((function(t,s){return("1"===t?"111":"1")+("1"===e[s]?"000":"0")})).join("")}}]),e}(kd.default),Wd=Kd,zd=Object.defineProperty({default:Wd},"__esModule",{value:!0}),$d=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),Xd=function(t){return t&&t.__esModule?t:{default:t}}(zd);var jd=function(t){var e=t.substr(0,13).split("").map((function(t){return parseInt(t,10)})).reduce((function(t,e,s){return t+e*(3-s%2*2)}),0);return 10*Math.ceil(e/10)-e},Yd=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{13}$/)&&(t+=jd(t)),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),$d(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{14}$/)&&+this.data[13]===jd(this.data)}}]),e}(Xd.default),Jd=Object.defineProperty({default:Yd},"__esModule",{value:!0}),Zd=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ITF14=e.ITF=void 0;var s=r(zd),i=r(Jd);function r(t){return t&&t.__esModule?t:{default:t}}e.ITF=s.default,e.ITF14=i.default})),qd=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),tc=function(t){return t&&t.__esModule?t:{default:t}}(dh);var ec=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),qd(e,[{key:"encode",value:function(){for(var t="110",e=0;e<this.data.length;e++){var s=parseInt(this.data[e]).toString(2);s=sc(s,4-s.length);for(var i=0;i<s.length;i++)t+="0"==s[i]?"100":"110"}return{data:t+="1001",text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]+$/)}}]),e}(tc.default);function sc(t,e){for(var s=0;s<e;s++)t="0"+t;return t}var ic=ec,rc=Object.defineProperty({default:ic},"__esModule",{value:!0}),nc=function(t){for(var e=0,s=0;s<t.length;s++){var i=parseInt(t[s]);(s+t.length)%2==0?e+=i:e+=2*i%10+Math.floor(2*i/10)}return(10-e%10)%10},oc=function(t){for(var e=0,s=[2,3,4,5,6,7],i=0;i<t.length;i++){var r=parseInt(t[t.length-1-i]);e+=s[i%s.length]*r}return(11-e%11)%11};var ac=Object.defineProperty({mod10:nc,mod11:oc},"__esModule",{value:!0}),Ac=function(t){return t&&t.__esModule?t:{default:t}}(rc);var lc=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,ac.mod10)(t),s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(Ac.default),hc=Object.defineProperty({default:lc},"__esModule",{value:!0}),dc=function(t){return t&&t.__esModule?t:{default:t}}(rc);var cc=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,ac.mod11)(t),s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(dc.default),uc=Object.defineProperty({default:cc},"__esModule",{value:!0}),pc=function(t){return t&&t.__esModule?t:{default:t}}(rc);var _c=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t+=(0,ac.mod10)(t),t+=(0,ac.mod10)(t),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(pc.default),gc=Object.defineProperty({default:_c},"__esModule",{value:!0}),fc=function(t){return t&&t.__esModule?t:{default:t}}(rc);var mc=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t+=(0,ac.mod11)(t),t+=(0,ac.mod10)(t),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(fc.default),wc=Object.defineProperty({default:mc},"__esModule",{value:!0}),yc=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MSI1110=e.MSI1010=e.MSI11=e.MSI10=e.MSI=void 0;var s=a(rc),i=a(hc),r=a(uc),n=a(gc),o=a(wc);function a(t){return t&&t.__esModule?t:{default:t}}e.MSI=s.default,e.MSI10=i.default,e.MSI11=r.default,e.MSI1010=n.default,e.MSI1110=o.default})),Cc=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.pharmacode=void 0;var s=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(dh);var r=function(t){function e(t,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s));return i.number=parseInt(t,10),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"encode",value:function(){for(var t=this.number,e="";!isNaN(t)&&0!=t;)t%2==0?(e="11100"+e,t=(t-2)/2):(e="100"+e,t=(t-1)/2);return{data:e=e.slice(0,-2),text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),e}(i.default);e.pharmacode=r})),bc=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.codabar=void 0;var s=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(dh);var r=function(t){function e(t,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),0===t.search(/^[0-9\-\$\:\.\+\/]+$/)&&(t="A"+t+"A");var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.toUpperCase(),s));return i.text=i.options.text||i.text.replace(/[A-D]/g,""),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)}},{key:"encode",value:function(){for(var t=[],e=this.getEncodings(),s=0;s<this.data.length;s++)t.push(e[this.data.charAt(s)]),s!==this.data.length-1&&t.push("0");return{text:this.text,data:t.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),e}(i.default);e.codabar=r})),vc=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.GenericBarcode=void 0;var s=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),i=function(t){return t&&t.__esModule?t:{default:t}}(dh);var r=function(t){function e(t,s){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),e}(i.default);e.GenericBarcode=r})),Bc={CODE39:ch.CODE39,CODE128:Vh.CODE128,CODE128A:Vh.CODE128A,CODE128B:Vh.CODE128B,CODE128C:Vh.CODE128C,EAN13:Qd.EAN13,EAN8:Qd.EAN8,EAN5:Qd.EAN5,EAN2:Qd.EAN2,UPC:Qd.UPC,UPCE:Qd.UPCE,ITF14:Zd.ITF14,ITF:Zd.ITF,MSI:yc.MSI,MSI10:yc.MSI10,MSI11:yc.MSI11,MSI1010:yc.MSI1010,MSI1110:yc.MSI1110,pharmacode:Cc.pharmacode,codabar:bc.codabar,GenericBarcode:vc.GenericBarcode},Ec=Object.defineProperty({default:Bc},"__esModule",{value:!0}),Pc=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t[i]=s[i])}return t},xc=Object.defineProperty({default:function(t,e){return Pc({},t,e)}},"__esModule",{value:!0}),Sc=function(t){var e=[];return function t(s){if(Array.isArray(s))for(var i=0;i<s.length;i++)t(s[i]);else s.text=s.text||"",s.data=s.data||"",e.push(s)}(t),e};var Ic=Object.defineProperty({default:Sc},"__esModule",{value:!0}),Rc=function(t){return t.marginTop=t.marginTop||t.margin,t.marginBottom=t.marginBottom||t.margin,t.marginRight=t.marginRight||t.margin,t.marginLeft=t.marginLeft||t.margin,t};var Tc=Object.defineProperty({default:Rc},"__esModule",{value:!0}),Oc=function(t){var e=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var s in e)e.hasOwnProperty(s)&&(s=e[s],"string"==typeof t[s]&&(t[s]=parseInt(t[s],10)));"string"==typeof t.displayValue&&(t.displayValue="false"!=t.displayValue);return t};var Fc=Object.defineProperty({default:Oc},"__esModule",{value:!0}),Dc={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}},Lc=Object.defineProperty({default:Dc},"__esModule",{value:!0}),Nc=Qc(Fc),Hc=Qc(Lc);function Qc(t){return t&&t.__esModule?t:{default:t}}var Uc=function(t){var e={};for(var s in Hc.default)Hc.default.hasOwnProperty(s)&&(t.hasAttribute("jsbarcode-"+s.toLowerCase())&&(e[s]=t.getAttribute("jsbarcode-"+s.toLowerCase())),t.hasAttribute("data-"+s.toLowerCase())&&(e[s]=t.getAttribute("data-"+s.toLowerCase())));return e.value=t.getAttribute("jsbarcode-value")||t.getAttribute("data-value"),e=(0,Nc.default)(e)},Mc=Object.defineProperty({default:Uc},"__esModule",{value:!0}),kc=Ah((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getTotalWidthOfEncodings=e.calculateEncodingAttributes=e.getBarcodePadding=e.getEncodingHeight=e.getMaximumHeightOfEncodings=void 0;var s=function(t){return t&&t.__esModule?t:{default:t}}(xc);function i(t,e){return e.height+(e.displayValue&&t.text.length>0?e.fontSize+e.textMargin:0)+e.marginTop+e.marginBottom}function r(t,e,s){if(s.displayValue&&e<t){if("center"==s.textAlign)return Math.floor((t-e)/2);if("left"==s.textAlign)return 0;if("right"==s.textAlign)return Math.floor(t-e)}return 0}function n(t,e,s){var i;if(s)i=s;else{if("undefined"==typeof document)return 0;i=document.createElement("canvas").getContext("2d")}i.font=e.fontOptions+" "+e.fontSize+"px "+e.font;var r=i.measureText(t);return r?r.width:0}e.getMaximumHeightOfEncodings=function(t){for(var e=0,s=0;s<t.length;s++)t[s].height>e&&(e=t[s].height);return e},e.getEncodingHeight=i,e.getBarcodePadding=r,e.calculateEncodingAttributes=function(t,e,o){for(var a=0;a<t.length;a++){var A,l=t[a],h=(0,s.default)(e,l.options);A=h.displayValue?n(l.text,h,o):0;var d=l.data.length*h.width;l.width=Math.ceil(Math.max(A,d)),l.height=i(l,h),l.barcodePadding=r(A,d,h)}},e.getTotalWidthOfEncodings=function(t){for(var e=0,s=0;s<t.length;s++)e+=t[s].width;return e}})),Vc=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),Gc=function(t){return t&&t.__esModule?t:{default:t}}(xc);var Kc=function(){function t(e,s,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.encodings=s,this.options=i}return Vc(t,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var e=(0,Gc.default)(this.options,this.encodings[t].options);this.drawCanvasBarcode(e,this.encodings[t]),this.drawCanvasText(e,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,kc.calculateEncodingAttributes)(this.encodings,this.options,t);var e=(0,kc.getTotalWidthOfEncodings)(this.encodings),s=(0,kc.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=e+this.options.marginLeft+this.options.marginRight,this.canvas.height=s,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,e){var s,i=this.canvas.getContext("2d"),r=e.data;s="top"==t.textPosition?t.marginTop+t.fontSize+t.textMargin:t.marginTop,i.fillStyle=t.lineColor;for(var n=0;n<r.length;n++){var o=n*t.width+e.barcodePadding;"1"===r[n]?i.fillRect(o,s,t.width,t.height):r[n]&&i.fillRect(o,s,t.width,t.height*r[n])}}},{key:"drawCanvasText",value:function(t,e){var s,i,r=this.canvas.getContext("2d"),n=t.fontOptions+" "+t.fontSize+"px "+t.font;t.displayValue&&(i="top"==t.textPosition?t.marginTop+t.fontSize-t.textMargin:t.height+t.textMargin+t.marginTop+t.fontSize,r.font=n,"left"==t.textAlign||e.barcodePadding>0?(s=0,r.textAlign="left"):"right"==t.textAlign?(s=e.width-1,r.textAlign="right"):(s=e.width/2,r.textAlign="center"),r.fillText(e.text,s,i))}},{key:"moveCanvasDrawing",value:function(t){this.canvas.getContext("2d").translate(t.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),t}(),Wc=Kc,zc=Object.defineProperty({default:Wc},"__esModule",{value:!0}),$c=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),Xc=function(t){return t&&t.__esModule?t:{default:t}}(xc);var jc="http://www.w3.org/2000/svg",Yc=function(){function t(e,s,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.svg=e,this.encodings=s,this.options=i,this.document=i.xmlDocument||document}return $c(t,[{key:"render",value:function(){var t=this.options.marginLeft;this.prepareSVG();for(var e=0;e<this.encodings.length;e++){var s=this.encodings[e],i=(0,Xc.default)(this.options,s.options),r=this.createGroup(t,i.marginTop,this.svg);this.setGroupOptions(r,i),this.drawSvgBarcode(r,i,s),this.drawSVGText(r,i,s),t+=s.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,kc.calculateEncodingAttributes)(this.encodings,this.options);var t=(0,kc.getTotalWidthOfEncodings)(this.encodings),e=(0,kc.getMaximumHeightOfEncodings)(this.encodings),s=t+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(s,e),this.options.background&&this.drawRect(0,0,s,e,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(t,e,s){var i,r=s.data;i="top"==e.textPosition?e.fontSize+e.textMargin:0;for(var n=0,o=0,a=0;a<r.length;a++)o=a*e.width+s.barcodePadding,"1"===r[a]?n++:n>0&&(this.drawRect(o-e.width*n,i,e.width*n,e.height,t),n=0);n>0&&this.drawRect(o-e.width*(n-1),i,e.width*n,e.height,t)}},{key:"drawSVGText",value:function(t,e,s){var i,r,n=this.document.createElementNS(jc,"text");e.displayValue&&(n.setAttribute("style","font:"+e.fontOptions+" "+e.fontSize+"px "+e.font),r="top"==e.textPosition?e.fontSize-e.textMargin:e.height+e.textMargin+e.fontSize,"left"==e.textAlign||s.barcodePadding>0?(i=0,n.setAttribute("text-anchor","start")):"right"==e.textAlign?(i=s.width-1,n.setAttribute("text-anchor","end")):(i=s.width/2,n.setAttribute("text-anchor","middle")),n.setAttribute("x",i),n.setAttribute("y",r),n.appendChild(this.document.createTextNode(s.text)),t.appendChild(n))}},{key:"setSvgAttributes",value:function(t,e){var s=this.svg;s.setAttribute("width",t+"px"),s.setAttribute("height",e+"px"),s.setAttribute("x","0px"),s.setAttribute("y","0px"),s.setAttribute("viewBox","0 0 "+t+" "+e),s.setAttribute("xmlns",jc),s.setAttribute("version","1.1"),s.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(t,e,s){var i=this.document.createElementNS(jc,"g");return i.setAttribute("transform","translate("+t+", "+e+")"),s.appendChild(i),i}},{key:"setGroupOptions",value:function(t,e){t.setAttribute("style","fill:"+e.lineColor+";")}},{key:"drawRect",value:function(t,e,s,i,r){var n=this.document.createElementNS(jc,"rect");return n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",s),n.setAttribute("height",i),r.appendChild(n),n}}]),t}(),Jc=Yc,Zc=Object.defineProperty({default:Jc},"__esModule",{value:!0}),qc=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}();var tu=function(){function t(e,s,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.object=e,this.encodings=s,this.options=i}return qc(t,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),t}(),eu=tu,su=Object.defineProperty({default:eu},"__esModule",{value:!0}),iu=ou(zc),ru=ou(Zc),nu=ou(su);function ou(t){return t&&t.__esModule?t:{default:t}}var au={CanvasRenderer:iu.default,SVGRenderer:ru.default,ObjectRenderer:nu.default},Au=Object.defineProperty({default:au},"__esModule",{value:!0});function lu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hu(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function du(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var cu=function(t){function e(t,s){lu(this,e);var i=hu(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.name="InvalidInputException",i.symbology=t,i.input=s,i.message='"'+i.input+'" is not a valid input for '+i.symbology,i}return du(e,Error),e}(),uu=function(t){function e(){lu(this,e);var t=hu(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return du(e,Error),e}(),pu=function(t){function e(){lu(this,e);var t=hu(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}return du(e,Error),e}(),_u=Object.defineProperty({InvalidInputException:cu,InvalidElementException:uu,NoElementException:pu},"__esModule",{value:!0}),gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu=wu(Mc),mu=wu(Au);function wu(t){return t&&t.__esModule?t:{default:t}}function yu(t){if("string"==typeof t)return function(t){var e=document.querySelectorAll(t);if(0===e.length)return;for(var s=[],i=0;i<e.length;i++)s.push(yu(e[i]));return s}(t);if(Array.isArray(t)){for(var e=[],s=0;s<t.length;s++)e.push(yu(t[s]));return e}if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLImageElement)return function(t){var e=document.createElement("canvas");return{element:e,options:(0,fu.default)(t),renderer:mu.default.CanvasRenderer,afterRender:function(){t.setAttribute("src",e.toDataURL())}}}(t);if(t&&t.nodeName&&"svg"===t.nodeName.toLowerCase()||"undefined"!=typeof SVGElement&&t instanceof SVGElement)return{element:t,options:(0,fu.default)(t),renderer:mu.default.SVGRenderer};if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement)return{element:t,options:(0,fu.default)(t),renderer:mu.default.CanvasRenderer};if(t&&t.getContext)return{element:t,renderer:mu.default.CanvasRenderer};if(t&&"object"===(void 0===t?"undefined":gu(t))&&!t.nodeName)return{element:t,renderer:mu.default.ObjectRenderer};throw new _u.InvalidElementException}var Cu=yu,bu=Object.defineProperty({default:Cu},"__esModule",{value:!0}),vu=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}();var Bu=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.api=e}return vu(t,[{key:"handleCatch",value:function(t){if("InvalidInputException"!==t.name)throw t;if(this.api._options.valid===this.api._defaults.valid)throw t.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(t){try{var e=t.apply(void 0,arguments);return this.api._options.valid(!0),e}catch(t){return this.handleCatch(t),this.api}}}]),t}(),Eu=Bu,Pu=Object.defineProperty({default:Eu},"__esModule",{value:!0}),xu=Lu(Ec),Su=Lu(xc),Iu=Lu(Ic),Ru=Lu(Tc),Tu=Lu(bu),Ou=Lu(Fc),Fu=Lu(Pu),Du=Lu(Lc);function Lu(t){return t&&t.__esModule?t:{default:t}}var Nu=function(){},Hu=function(t,e,s){var i=new Nu;if(void 0===t)throw Error("No element to render on was provided.");return i._renderProperties=(0,Tu.default)(t),i._encodings=[],i._options=Du.default,i._errorHandler=new Fu.default(i),void 0!==e&&((s=s||{}).format||(s.format=ku()),i.options(s)[s.format](e,s).render()),i};for(var Qu in Hu.getModule=function(t){return xu.default[t]},xu.default)xu.default.hasOwnProperty(Qu)&&Uu(xu.default,Qu);function Uu(t,e){Nu.prototype[e]=Nu.prototype[e.toUpperCase()]=Nu.prototype[e.toLowerCase()]=function(s,i){var r=this;return r._errorHandler.wrapBarcodeCall((function(){i.text=void 0===i.text?void 0:""+i.text;var n=(0,Su.default)(r._options,i);n=(0,Ou.default)(n);var o=t[e],a=Mu(s,o,n);return r._encodings.push(a),r}))}}function Mu(t,e,s){var i=new e(t=""+t,s);if(!i.valid())throw new _u.InvalidInputException(i.constructor.name,t);var r=i.encode();r=(0,Iu.default)(r);for(var n=0;n<r.length;n++)r[n].options=(0,Su.default)(s,r[n].options);return r}function ku(){return xu.default.CODE128?"CODE128":Object.keys(xu.default)[0]}function Vu(t,e,s){e=(0,Iu.default)(e);for(var i=0;i<e.length;i++)e[i].options=(0,Su.default)(s,e[i].options),(0,Ru.default)(e[i].options);(0,Ru.default)(s),new(0,t.renderer)(t.element,e,s).render(),t.afterRender&&t.afterRender()}Nu.prototype.options=function(t){return this._options=(0,Su.default)(this._options,t),this},Nu.prototype.blank=function(t){var e=new Array(t+1).join("0");return this._encodings.push({data:e}),this},Nu.prototype.init=function(){var t;if(this._renderProperties)for(var e in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){t=this._renderProperties[e];var s=(0,Su.default)(this._options,t.options);"auto"==s.format&&(s.format=ku()),this._errorHandler.wrapBarcodeCall((function(){var e=Mu(s.value,xu.default[s.format.toUpperCase()],s);Vu(t,e,s)}))}},Nu.prototype.render=function(){if(!this._renderProperties)throw new _u.NoElementException;if(Array.isArray(this._renderProperties))for(var t=0;t<this._renderProperties.length;t++)Vu(this._renderProperties[t],this._encodings,this._options);else Vu(this._renderProperties,this._encodings,this._options);return this},Nu.prototype._defaults=Du.default,"undefined"!=typeof window&&(window.JsBarcode=Hu),"undefined"!=typeof jQuery&&(jQuery.fn.JsBarcode=function(t,e){var s=[];return jQuery(this).each((function(){s.push(this)})),Hu(s,t,e)});var Gu=Hu;class Ku extends Mi{constructor(t,e){super(t,e,"barcodeItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-barcode rr-item-element"}get debugLabel(){return""}isDom(t){return super.isDom(t)||this.dom.contains(t)}_initDom(t,e){super._initDom(t,e),e.style.textAlign="center",e.appendChild(this._svg=t.createElementNS(sh,"svg")),Object.assign(this._svg.style,{height:"100%",background:"",border:"none",pointerEvents:"none"})}_doMeasure(t,e,s,i){const r=this.model,n=getComputedStyle(e),o=this._svg,a=this.$_getText(t,r);let A="",l=0,h=0;this._setModelSize(r,e,s,i,!0),r.showText&&(A=n.fontFamily,l=parseFloat(n.fontSize),h=l+r.textMargin+1);const d=e.style,c=e.offsetWidth,u=(r.height?e.offsetHeight:60)-J.toInt(n.paddingTop)-J.toInt(n.paddingBottom);try{const t={format:r.format||$o.CODE128,displayValue:r.showText,margin:0,width:r.barWidth,height:u-h,font:A,fontSize:l,background:"transparent",textAlign:r.textAlign,textPosition:r.textPosition};d.color&&(t.lineColor=d.color),Gu(o,a,t)}catch(t){console.error(t),e.style.backgroundColor="#ff000010",e.style.color="red",e.textContent=t}return t.printing&&nh.prepareExport(this._svg,c,u),Me.create(e.offsetWidth,u)}$_getText(t,e){let s="";return e.value?(s=t.printing?this.getPrintValue(t,e):e.value,s=J.toStr(s)):e.text&&(s=e.text),s&&e.convertText(s)}}var Wu=Ah((function(t,e){self,t.exports=(()=>{var t={192:(t,e)=>{var s,i,r=function(){var t=function(t,e){var s=t,i=o[e],r=null,n=0,A=null,g=[],f={},w=function(t,e){r=function(t){for(var e=new Array(t),s=0;s<t;s+=1){e[s]=new Array(t);for(var i=0;i<t;i+=1)e[s][i]=null}return e}(n=4*s+17),y(0,0),y(n-7,0),y(0,n-7),b(),C(),B(t,e),s>=7&&v(t),null==A&&(A=P(s,i,g)),E(A,e)},y=function(t,e){for(var s=-1;s<=7;s+=1)if(!(t+s<=-1||n<=t+s))for(var i=-1;i<=7;i+=1)e+i<=-1||n<=e+i||(r[t+s][e+i]=0<=s&&s<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==s||6==s)||2<=s&&s<=4&&2<=i&&i<=4)},C=function(){for(var t=8;t<n-8;t+=1)null==r[t][6]&&(r[t][6]=t%2==0);for(var e=8;e<n-8;e+=1)null==r[6][e]&&(r[6][e]=e%2==0)},b=function(){for(var t=a.getPatternPosition(s),e=0;e<t.length;e+=1)for(var i=0;i<t.length;i+=1){var n=t[e],o=t[i];if(null==r[n][o])for(var A=-2;A<=2;A+=1)for(var l=-2;l<=2;l+=1)r[n+A][o+l]=-2==A||2==A||-2==l||2==l||0==A&&0==l}},v=function(t){for(var e=a.getBCHTypeNumber(s),i=0;i<18;i+=1){var o=!t&&1==(e>>i&1);r[Math.floor(i/3)][i%3+n-8-3]=o}for(i=0;i<18;i+=1)o=!t&&1==(e>>i&1),r[i%3+n-8-3][Math.floor(i/3)]=o},B=function(t,e){for(var s=i<<3|e,o=a.getBCHTypeInfo(s),A=0;A<15;A+=1){var l=!t&&1==(o>>A&1);A<6?r[A][8]=l:A<8?r[A+1][8]=l:r[n-15+A][8]=l}for(A=0;A<15;A+=1)l=!t&&1==(o>>A&1),A<8?r[8][n-A-1]=l:A<9?r[8][15-A-1+1]=l:r[8][15-A-1]=l;r[n-8][8]=!t},E=function(t,e){for(var s=-1,i=n-1,o=7,A=0,l=a.getMaskFunction(e),h=n-1;h>0;h-=2)for(6==h&&(h-=1);;){for(var d=0;d<2;d+=1)if(null==r[i][h-d]){var c=!1;A<t.length&&(c=1==(t[A]>>>o&1)),l(i,h-d)&&(c=!c),r[i][h-d]=c,-1==(o-=1)&&(A+=1,o=7)}if((i+=s)<0||n<=i){i-=s,s=-s;break}}},P=function(t,e,s){for(var i=h.getRSBlocks(t,e),r=d(),n=0;n<s.length;n+=1){var o=s[n];r.put(o.getMode(),4),r.put(o.getLength(),a.getLengthInBits(o.getMode(),t)),o.write(r)}var A=0;for(n=0;n<i.length;n+=1)A+=i[n].dataCount;if(r.getLengthInBits()>8*A)throw"code length overflow. ("+r.getLengthInBits()+">"+8*A+")";for(r.getLengthInBits()+4<=8*A&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(!1);for(;!(r.getLengthInBits()>=8*A||(r.put(236,8),r.getLengthInBits()>=8*A));)r.put(17,8);return function(t,e){for(var s=0,i=0,r=0,n=new Array(e.length),o=new Array(e.length),A=0;A<e.length;A+=1){var h=e[A].dataCount,d=e[A].totalCount-h;i=Math.max(i,h),r=Math.max(r,d),n[A]=new Array(h);for(var c=0;c<n[A].length;c+=1)n[A][c]=255&t.getBuffer()[c+s];s+=h;var u=a.getErrorCorrectPolynomial(d),p=l(n[A],u.getLength()-1).mod(u);for(o[A]=new Array(u.getLength()-1),c=0;c<o[A].length;c+=1){var _=c+p.getLength()-o[A].length;o[A][c]=_>=0?p.getAt(_):0}}var g=0;for(c=0;c<e.length;c+=1)g+=e[c].totalCount;var f=new Array(g),m=0;for(c=0;c<i;c+=1)for(A=0;A<e.length;A+=1)c<n[A].length&&(f[m]=n[A][c],m+=1);for(c=0;c<r;c+=1)for(A=0;A<e.length;A+=1)c<o[A].length&&(f[m]=o[A][c],m+=1);return f}(r,i)};f.addData=function(t,e){var s=null;switch(e=e||"Byte"){case"Numeric":s=c(t);break;case"Alphanumeric":s=u(t);break;case"Byte":s=p(t);break;case"Kanji":s=_(t);break;default:throw"mode:"+e}g.push(s),A=null},f.isDark=function(t,e){if(t<0||n<=t||e<0||n<=e)throw t+","+e;return r[t][e]},f.getModuleCount=function(){return n},f.make=function(){if(s<1){for(var t=1;t<40;t++){for(var e=h.getRSBlocks(t,i),r=d(),n=0;n<g.length;n++){var o=g[n];r.put(o.getMode(),4),r.put(o.getLength(),a.getLengthInBits(o.getMode(),t)),o.write(r)}var A=0;for(n=0;n<e.length;n++)A+=e[n].dataCount;if(r.getLengthInBits()<=8*A)break}s=t}w(!1,function(){for(var t=0,e=0,s=0;s<8;s+=1){w(!0,s);var i=a.getLostPoint(f);(0==s||t>i)&&(t=i,e=s)}return e}())},f.createTableTag=function(t,e){t=t||2;var s="";s+='<table style="',s+=" border-width: 0px; border-style: none;",s+=" border-collapse: collapse;",s+=" padding: 0px; margin: "+(e=void 0===e?4*t:e)+"px;",s+='">',s+="<tbody>";for(var i=0;i<f.getModuleCount();i+=1){s+="<tr>";for(var r=0;r<f.getModuleCount();r+=1)s+='<td style="',s+=" border-width: 0px; border-style: none;",s+=" border-collapse: collapse;",s+=" padding: 0px; margin: 0px;",s+=" width: "+t+"px;",s+=" height: "+t+"px;",s+=" background-color: ",s+=f.isDark(i,r)?"#000000":"#ffffff",s+=";",s+='"/>';s+="</tr>"}return(s+="</tbody>")+"</table>"},f.createSvgTag=function(t,e,s,i){var r={};"object"==typeof arguments[0]&&(t=(r=arguments[0]).cellSize,e=r.margin,s=r.alt,i=r.title),t=t||2,e=void 0===e?4*t:e,(s="string"==typeof s?{text:s}:s||{}).text=s.text||null,s.id=s.text?s.id||"qrcode-description":null,(i="string"==typeof i?{text:i}:i||{}).text=i.text||null,i.id=i.text?i.id||"qrcode-title":null;var n,o,a,A,l=f.getModuleCount()*t+2*e,h="";for(A="l"+t+",0 0,"+t+" -"+t+",0 0,-"+t+"z ",h+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',h+=r.scalable?"":' width="'+l+'px" height="'+l+'px"',h+=' viewBox="0 0 '+l+" "+l+'" ',h+=' preserveAspectRatio="xMinYMin meet"',h+=i.text||s.text?' role="img" aria-labelledby="'+x([i.id,s.id].join(" ").trim())+'"':"",h+=">",h+=i.text?'<title id="'+x(i.id)+'">'+x(i.text)+"</title>":"",h+=s.text?'<description id="'+x(s.id)+'">'+x(s.text)+"</description>":"",h+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',h+='<path d="',o=0;o<f.getModuleCount();o+=1)for(a=o*t+e,n=0;n<f.getModuleCount();n+=1)f.isDark(o,n)&&(h+="M"+(n*t+e)+","+a+A);return(h+='" stroke="transparent" fill="black"/>')+"</svg>"},f.createDataURL=function(t,e){t=t||2,e=void 0===e?4*t:e;var s=f.getModuleCount()*t+2*e,i=e,r=s-e;return m(s,s,(function(e,s){if(i<=e&&e<r&&i<=s&&s<r){var n=Math.floor((e-i)/t),o=Math.floor((s-i)/t);return f.isDark(o,n)?0:1}return 1}))},f.createImgTag=function(t,e,s){t=t||2,e=void 0===e?4*t:e;var i=f.getModuleCount()*t+2*e,r="";return r+="<img",r+=' src="',r+=f.createDataURL(t,e),r+='"',r+=' width="',r+=i,r+='"',r+=' height="',r+=i,r+='"',s&&(r+=' alt="',r+=x(s),r+='"'),r+"/>"};var x=function(t){for(var e="",s=0;s<t.length;s+=1){var i=t.charAt(s);switch(i){case"<":e+="&lt;";break;case">":e+="&gt;";break;case"&":e+="&amp;";break;case'"':e+="&quot;";break;default:e+=i}}return e};return f.createASCII=function(t,e){if((t=t||1)<2)return function(t){t=void 0===t?2:t;var e,s,i,r,n,o=1*f.getModuleCount()+2*t,a=t,A=o-t,l={"██":"█","█ ":"▀"," █":"▄","  ":" "},h={"██":"▀","█ ":"▀"," █":" ","  ":" "},d="";for(e=0;e<o;e+=2){for(i=Math.floor((e-a)/1),r=Math.floor((e+1-a)/1),s=0;s<o;s+=1)n="█",a<=s&&s<A&&a<=e&&e<A&&f.isDark(i,Math.floor((s-a)/1))&&(n=" "),a<=s&&s<A&&a<=e+1&&e+1<A&&f.isDark(r,Math.floor((s-a)/1))?n+=" ":n+="█",d+=t<1&&e+1>=A?h[n]:l[n];d+="\n"}return o%2&&t>0?d.substring(0,d.length-o-1)+Array(o+1).join("▀"):d.substring(0,d.length-1)}(e);t-=1,e=void 0===e?2*t:e;var s,i,r,n,o=f.getModuleCount()*t+2*e,a=e,A=o-e,l=Array(t+1).join("██"),h=Array(t+1).join("  "),d="",c="";for(s=0;s<o;s+=1){for(r=Math.floor((s-a)/t),c="",i=0;i<o;i+=1)n=1,a<=i&&i<A&&a<=s&&s<A&&f.isDark(r,Math.floor((i-a)/t))&&(n=0),c+=n?l:h;for(r=0;r<t;r+=1)d+=c+"\n"}return d.substring(0,d.length-1)},f.renderTo2dContext=function(t,e){e=e||2;for(var s=f.getModuleCount(),i=0;i<s;i++)for(var r=0;r<s;r++)t.fillStyle=f.isDark(i,r)?"black":"white",t.fillRect(i*e,r*e,e,e)},f};t.stringToBytes=(t.stringToBytesFuncs={default:function(t){for(var e=[],s=0;s<t.length;s+=1){var i=t.charCodeAt(s);e.push(255&i)}return e}}).default,t.createStringToBytes=function(t,e){var s=function(){for(var s=f(t),i=function(){var t=s.read();if(-1==t)throw"eof";return t},r=0,n={};;){var o=s.read();if(-1==o)break;var a=i(),A=i()<<8|i();n[String.fromCharCode(o<<8|a)]=A,r+=1}if(r!=e)throw r+" != "+e;return n}(),i="?".charCodeAt(0);return function(t){for(var e=[],r=0;r<t.length;r+=1){var n=t.charCodeAt(r);if(n<128)e.push(n);else{var o=s[t.charAt(r)];"number"==typeof o?(255&o)==o?e.push(o):(e.push(o>>>8),e.push(255&o)):e.push(i)}}return e}};var e,s,i,r,n,o={L:1,M:0,Q:3,H:2},a=(e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],s=1335,i=7973,n=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e},(r={}).getBCHTypeInfo=function(t){for(var e=t<<10;n(e)-n(s)>=0;)e^=s<<n(e)-n(s);return 21522^(t<<10|e)},r.getBCHTypeNumber=function(t){for(var e=t<<12;n(e)-n(i)>=0;)e^=i<<n(e)-n(i);return t<<12|e},r.getPatternPosition=function(t){return e[t-1]},r.getMaskFunction=function(t){switch(t){case 0:return function(t,e){return(t+e)%2==0};case 1:return function(t,e){return t%2==0};case 2:return function(t,e){return e%3==0};case 3:return function(t,e){return(t+e)%3==0};case 4:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case 5:return function(t,e){return t*e%2+t*e%3==0};case 6:return function(t,e){return(t*e%2+t*e%3)%2==0};case 7:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw"bad maskPattern:"+t}},r.getErrorCorrectPolynomial=function(t){for(var e=l([1],0),s=0;s<t;s+=1)e=e.multiply(l([1,A.gexp(s)],0));return e},r.getLengthInBits=function(t,e){if(1<=e&&e<10)switch(t){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+t}else if(e<27)switch(t){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+t}else{if(!(e<41))throw"type:"+e;switch(t){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+t}}},r.getLostPoint=function(t){for(var e=t.getModuleCount(),s=0,i=0;i<e;i+=1)for(var r=0;r<e;r+=1){for(var n=0,o=t.isDark(i,r),a=-1;a<=1;a+=1)if(!(i+a<0||e<=i+a))for(var A=-1;A<=1;A+=1)r+A<0||e<=r+A||0==a&&0==A||o==t.isDark(i+a,r+A)&&(n+=1);n>5&&(s+=3+n-5)}for(i=0;i<e-1;i+=1)for(r=0;r<e-1;r+=1){var l=0;t.isDark(i,r)&&(l+=1),t.isDark(i+1,r)&&(l+=1),t.isDark(i,r+1)&&(l+=1),t.isDark(i+1,r+1)&&(l+=1),0!=l&&4!=l||(s+=3)}for(i=0;i<e;i+=1)for(r=0;r<e-6;r+=1)t.isDark(i,r)&&!t.isDark(i,r+1)&&t.isDark(i,r+2)&&t.isDark(i,r+3)&&t.isDark(i,r+4)&&!t.isDark(i,r+5)&&t.isDark(i,r+6)&&(s+=40);for(r=0;r<e;r+=1)for(i=0;i<e-6;i+=1)t.isDark(i,r)&&!t.isDark(i+1,r)&&t.isDark(i+2,r)&&t.isDark(i+3,r)&&t.isDark(i+4,r)&&!t.isDark(i+5,r)&&t.isDark(i+6,r)&&(s+=40);var h=0;for(r=0;r<e;r+=1)for(i=0;i<e;i+=1)t.isDark(i,r)&&(h+=1);return s+Math.abs(100*h/e/e-50)/5*10},r),A=function(){for(var t=new Array(256),e=new Array(256),s=0;s<8;s+=1)t[s]=1<<s;for(s=8;s<256;s+=1)t[s]=t[s-4]^t[s-5]^t[s-6]^t[s-8];for(s=0;s<255;s+=1)e[t[s]]=s;return{glog:function(t){if(t<1)throw"glog("+t+")";return e[t]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return t[e]}}}();function l(t,e){if(void 0===t.length)throw t.length+"/"+e;var s=function(){for(var s=0;s<t.length&&0==t[s];)s+=1;for(var i=new Array(t.length-s+e),r=0;r<t.length-s;r+=1)i[r]=t[r+s];return i}(),i={getAt:function(t){return s[t]},getLength:function(){return s.length},multiply:function(t){for(var e=new Array(i.getLength()+t.getLength()-1),s=0;s<i.getLength();s+=1)for(var r=0;r<t.getLength();r+=1)e[s+r]^=A.gexp(A.glog(i.getAt(s))+A.glog(t.getAt(r)));return l(e,0)},mod:function(t){if(i.getLength()-t.getLength()<0)return i;for(var e=A.glog(i.getAt(0))-A.glog(t.getAt(0)),s=new Array(i.getLength()),r=0;r<i.getLength();r+=1)s[r]=i.getAt(r);for(r=0;r<t.getLength();r+=1)s[r]^=A.gexp(A.glog(t.getAt(r))+e);return l(s,0).mod(t)}};return i}var h=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var s={};return s.totalCount=t,s.dataCount=e,s},s={getRSBlocks:function(s,i){var r=function(e,s){switch(s){case o.L:return t[4*(e-1)+0];case o.M:return t[4*(e-1)+1];case o.Q:return t[4*(e-1)+2];case o.H:return t[4*(e-1)+3];default:return}}(s,i);if(void 0===r)throw"bad rs block @ typeNumber:"+s+"/errorCorrectionLevel:"+i;for(var n=r.length/3,a=[],A=0;A<n;A+=1)for(var l=r[3*A+0],h=r[3*A+1],d=r[3*A+2],c=0;c<l;c+=1)a.push(e(h,d));return a}};return s}(),d=function(){var t=[],e=0,s={getBuffer:function(){return t},getAt:function(e){var s=Math.floor(e/8);return 1==(t[s]>>>7-e%8&1)},put:function(t,e){for(var i=0;i<e;i+=1)s.putBit(1==(t>>>e-i-1&1))},getLengthInBits:function(){return e},putBit:function(s){var i=Math.floor(e/8);t.length<=i&&t.push(0),s&&(t[i]|=128>>>e%8),e+=1}};return s},c=function(t){var e=t,s={getMode:function(){return 1},getLength:function(t){return e.length},write:function(t){for(var s=e,r=0;r+2<s.length;)t.put(i(s.substring(r,r+3)),10),r+=3;r<s.length&&(s.length-r==1?t.put(i(s.substring(r,r+1)),4):s.length-r==2&&t.put(i(s.substring(r,r+2)),7))}},i=function(t){for(var e=0,s=0;s<t.length;s+=1)e=10*e+r(t.charAt(s));return e},r=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+t};return s},u=function(t){var e=t,s={getMode:function(){return 2},getLength:function(t){return e.length},write:function(t){for(var s=e,r=0;r+1<s.length;)t.put(45*i(s.charAt(r))+i(s.charAt(r+1)),11),r+=2;r<s.length&&t.put(i(s.charAt(r)),6)}},i=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);if("A"<=t&&t<="Z")return t.charCodeAt(0)-"A".charCodeAt(0)+10;switch(t){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+t}};return s},p=function(e){var s=t.stringToBytes(e);return{getMode:function(){return 4},getLength:function(t){return s.length},write:function(t){for(var e=0;e<s.length;e+=1)t.put(s[e],8)}}},_=function(e){var s=t.stringToBytesFuncs.SJIS;if(!s)throw"sjis not supported.";!function(t,e){var i=s("友");if(2!=i.length||38726!=(i[0]<<8|i[1]))throw"sjis not supported."}();var i=s(e);return{getMode:function(){return 8},getLength:function(t){return~~(i.length/2)},write:function(t){for(var e=i,s=0;s+1<e.length;){var r=(255&e[s])<<8|255&e[s+1];if(33088<=r&&r<=40956)r-=33088;else{if(!(57408<=r&&r<=60351))throw"illegal char at "+(s+1)+"/"+r;r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13),s+=2}if(s<e.length)throw"illegal char at "+(s+1)}}},g=function(){var t=[],e={writeByte:function(e){t.push(255&e)},writeShort:function(t){e.writeByte(t),e.writeByte(t>>>8)},writeBytes:function(t,s,i){s=s||0,i=i||t.length;for(var r=0;r<i;r+=1)e.writeByte(t[r+s])},writeString:function(t){for(var s=0;s<t.length;s+=1)e.writeByte(t.charCodeAt(s))},toByteArray:function(){return t},toString:function(){var e="";e+="[";for(var s=0;s<t.length;s+=1)s>0&&(e+=","),e+=t[s];return e+"]"}};return e},f=function(t){var e=t,s=0,i=0,r=0,n={read:function(){for(;r<8;){if(s>=e.length){if(0==r)return-1;throw"unexpected end of file./"+r}var t=e.charAt(s);if(s+=1,"="==t)return r=0,-1;t.match(/^\s$/)||(i=i<<6|o(t.charCodeAt(0)),r+=6)}var n=i>>>r-8&255;return r-=8,n}},o=function(t){if(65<=t&&t<=90)return t-65;if(97<=t&&t<=122)return t-97+26;if(48<=t&&t<=57)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw"c:"+t};return n},m=function(t,e,s){for(var i=function(t,e){var s=t,i=e,r=new Array(t*e),n={setPixel:function(t,e,i){r[e*s+t]=i},write:function(t){t.writeString("GIF87a"),t.writeShort(s),t.writeShort(i),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(","),t.writeShort(0),t.writeShort(0),t.writeShort(s),t.writeShort(i),t.writeByte(0);var e=o(2);t.writeByte(2);for(var r=0;e.length-r>255;)t.writeByte(255),t.writeBytes(e,r,255),r+=255;t.writeByte(e.length-r),t.writeBytes(e,r,e.length-r),t.writeByte(0),t.writeString(";")}},o=function(t){for(var e=1<<t,s=1+(1<<t),i=t+1,n=a(),o=0;o<e;o+=1)n.add(String.fromCharCode(o));n.add(String.fromCharCode(e)),n.add(String.fromCharCode(s));var A,l,h,d=g(),c=(A=d,l=0,h=0,{write:function(t,e){if(t>>>e!=0)throw"length over";for(;l+e>=8;)A.writeByte(255&(t<<l|h)),e-=8-l,t>>>=8-l,h=0,l=0;h|=t<<l,l+=e},flush:function(){l>0&&A.writeByte(h)}});c.write(e,i);var u=0,p=String.fromCharCode(r[u]);for(u+=1;u<r.length;){var _=String.fromCharCode(r[u]);u+=1,n.contains(p+_)?p+=_:(c.write(n.indexOf(p),i),n.size()<4095&&(n.size()==1<<i&&(i+=1),n.add(p+_)),p=_)}return c.write(n.indexOf(p),i),c.write(s,i),c.flush(),d.toByteArray()},a=function(){var t={},e=0,s={add:function(i){if(s.contains(i))throw"dup key:"+i;t[i]=e,e+=1},size:function(){return e},indexOf:function(e){return t[e]},contains:function(e){return void 0!==t[e]}};return s};return n}(t,e),r=0;r<e;r+=1)for(var n=0;n<t;n+=1)i.setPixel(n,r,s(n,r));var o=g();i.write(o);for(var a=function(){var t=0,e=0,s=0,i="",r={},n=function(t){i+=String.fromCharCode(o(63&t))},o=function(t){if(t<0);else{if(t<26)return 65+t;if(t<52)return t-26+97;if(t<62)return t-52+48;if(62==t)return 43;if(63==t)return 47}throw"n:"+t};return r.writeByte=function(i){for(t=t<<8|255&i,e+=8,s+=1;e>=6;)n(t>>>e-6),e-=6},r.flush=function(){if(e>0&&(n(t<<6-e),t=0,e=0),s%3!=0)for(var r=3-s%3,o=0;o<r;o+=1)i+="="},r.toString=function(){return i},r}(),A=o.toByteArray(),l=0;l<A.length;l+=1)a.writeByte(A[l]);return a.flush(),"data:image/gif;base64,"+a};return t}();r.stringToBytesFuncs["UTF-8"]=function(t){return function(t){for(var e=[],s=0;s<t.length;s++){var i=t.charCodeAt(s);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(s++,i=65536+((1023&i)<<10|1023&t.charCodeAt(s)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e}(t)},void 0===(i="function"==typeof(s=function(){return r})?s.apply(e,[]):s)||(t.exports=i)},796:(t,e,s)=>{s.d(e,{default:()=>X});var i=function(){return(i=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},r=function(){for(var t=0,e=0,s=arguments.length;e<s;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<s;e++)for(var n=arguments[e],o=0,a=n.length;o<a;o++,r++)i[r]=n[o];return i},n=function(t){return!!t&&"object"==typeof t&&!Array.isArray(t)};function o(t){for(var e=[],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(!e.length)return t;var a=e.shift();return void 0!==a&&n(t)&&n(a)?(t=i({},t),Object.keys(a).forEach((function(e){var s=t[e],i=a[e];Array.isArray(s)&&Array.isArray(i)?t[e]=i:n(s)&&n(i)?t[e]=o(Object.assign({},s),i):t[e]=i})),o.apply(void 0,r([t],e))):t}function a(t,e){var s=document.createElement("a");s.download=e,s.href=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}function A(t){var e=t.originalHeight,s=t.originalWidth,i=t.maxHiddenDots,r=t.maxHiddenAxisDots,n=t.dotSize,o={x:0,y:0},a={x:0,y:0};if(e<=0||s<=0||i<=0||n<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};var A=e/s;return o.x=Math.floor(Math.sqrt(i/A)),o.x<=0&&(o.x=1),r&&r<o.x&&(o.x=r),o.x%2==0&&o.x--,a.x=o.x*n,o.y=1+2*Math.ceil((o.x*A-1)/2),a.y=Math.round(a.x*A),(o.y*o.x>i||r&&r<o.y)&&(r&&r<o.y?(o.y=r,o.y%2==0&&o.x--):o.y-=2,a.y=o.y*n,o.x=1+2*Math.ceil((o.y/A-1)/2),a.x=Math.round(a.y/A)),{height:a.y,width:a.x,hideYDots:o.y,hideXDots:o.x}}const l={L:.07,M:.15,Q:.25,H:.3},h="dots",d="rounded",c="classy",u="classy-rounded",p="extra-rounded";var _=function(){return(_=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};const g=function(){function t(t){var e=t.context,s=t.type;this._context=e,this._type=s}return t.prototype.draw=function(t,e,s,i){var r,n=this._context;switch(this._type){case h:r=this._drawDot;break;case c:r=this._drawClassy;break;case u:r=this._drawClassyRounded;break;case d:r=this._drawRounded;break;case p:r=this._drawExtraRounded;break;default:r=this._drawSquare}r.call(this,{x:t,y:e,size:s,context:n,getNeighbor:i})},t.prototype._rotateFigure=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.rotation,o=void 0===n?0:n,a=t.draw,A=e+i/2,l=s+i/2;r.translate(A,l),o&&r.rotate(o),a(),r.closePath(),o&&r.rotate(-o),r.translate(-A,-l)},t.prototype._basicDot=function(t){var e=t.size,s=t.context;this._rotateFigure(_(_({},t),{draw:function(){s.arc(0,0,e/2,0,2*Math.PI)}}))},t.prototype._basicSquare=function(t){var e=t.size,s=t.context;this._rotateFigure(_(_({},t),{draw:function(){s.rect(-e/2,-e/2,e,e)}}))},t.prototype._basicSideRounded=function(t){var e=t.size,s=t.context;this._rotateFigure(_(_({},t),{draw:function(){s.arc(0,0,e/2,-Math.PI/2,Math.PI/2),s.lineTo(-e/2,e/2),s.lineTo(-e/2,-e/2),s.lineTo(0,-e/2)}}))},t.prototype._basicCornerRounded=function(t){var e=t.size,s=t.context;this._rotateFigure(_(_({},t),{draw:function(){s.arc(0,0,e/2,-Math.PI/2,0),s.lineTo(e/2,e/2),s.lineTo(-e/2,e/2),s.lineTo(-e/2,-e/2),s.lineTo(0,-e/2)}}))},t.prototype._basicCornerExtraRounded=function(t){var e=t.size,s=t.context;this._rotateFigure(_(_({},t),{draw:function(){s.arc(-e/2,e/2,e,-Math.PI/2,0),s.lineTo(-e/2,e/2),s.lineTo(-e/2,-e/2)}}))},t.prototype._basicCornersRounded=function(t){var e=t.size,s=t.context;this._rotateFigure(_(_({},t),{draw:function(){s.arc(0,0,e/2,-Math.PI/2,0),s.lineTo(e/2,e/2),s.lineTo(0,e/2),s.arc(0,0,e/2,Math.PI/2,Math.PI),s.lineTo(-e/2,-e/2),s.lineTo(0,-e/2)}}))},t.prototype._basicCornersExtraRounded=function(t){var e=t.size,s=t.context;this._rotateFigure(_(_({},t),{draw:function(){s.arc(-e/2,e/2,e,-Math.PI/2,0),s.arc(e/2,-e/2,e,Math.PI/2,Math.PI)}}))},t.prototype._drawDot=function(t){var e=t.x,s=t.y,i=t.size,r=t.context;this._basicDot({x:e,y:s,size:i,context:r,rotation:0})},t.prototype._drawSquare=function(t){var e=t.x,s=t.y,i=t.size,r=t.context;this._basicSquare({x:e,y:s,size:i,context:r,rotation:0})},t.prototype._drawRounded=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.getNeighbor,o=n?+n(-1,0):0,a=n?+n(1,0):0,A=n?+n(0,-1):0,l=n?+n(0,1):0,h=o+a+A+l;if(0!==h)if(h>2||o&&a||A&&l)this._basicSquare({x:e,y:s,size:i,context:r,rotation:0});else{if(2===h){var d=0;return o&&A?d=Math.PI/2:A&&a?d=Math.PI:a&&l&&(d=-Math.PI/2),void this._basicCornerRounded({x:e,y:s,size:i,context:r,rotation:d})}if(1===h)return d=0,A?d=Math.PI/2:a?d=Math.PI:l&&(d=-Math.PI/2),void this._basicSideRounded({x:e,y:s,size:i,context:r,rotation:d})}else this._basicDot({x:e,y:s,size:i,context:r,rotation:0})},t.prototype._drawExtraRounded=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.getNeighbor,o=n?+n(-1,0):0,a=n?+n(1,0):0,A=n?+n(0,-1):0,l=n?+n(0,1):0,h=o+a+A+l;if(0!==h)if(h>2||o&&a||A&&l)this._basicSquare({x:e,y:s,size:i,context:r,rotation:0});else{if(2===h){var d=0;return o&&A?d=Math.PI/2:A&&a?d=Math.PI:a&&l&&(d=-Math.PI/2),void this._basicCornerExtraRounded({x:e,y:s,size:i,context:r,rotation:d})}if(1===h)return d=0,A?d=Math.PI/2:a?d=Math.PI:l&&(d=-Math.PI/2),void this._basicSideRounded({x:e,y:s,size:i,context:r,rotation:d})}else this._basicDot({x:e,y:s,size:i,context:r,rotation:0})},t.prototype._drawClassy=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.getNeighbor,o=n?+n(-1,0):0,a=n?+n(1,0):0,A=n?+n(0,-1):0,l=n?+n(0,1):0;0!==o+a+A+l?o||A?a||l?this._basicSquare({x:e,y:s,size:i,context:r,rotation:0}):this._basicCornerRounded({x:e,y:s,size:i,context:r,rotation:Math.PI/2}):this._basicCornerRounded({x:e,y:s,size:i,context:r,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:s,size:i,context:r,rotation:Math.PI/2})},t.prototype._drawClassyRounded=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.getNeighbor,o=n?+n(-1,0):0,a=n?+n(1,0):0,A=n?+n(0,-1):0,l=n?+n(0,1):0;0!==o+a+A+l?o||A?a||l?this._basicSquare({x:e,y:s,size:i,context:r,rotation:0}):this._basicCornerExtraRounded({x:e,y:s,size:i,context:r,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:e,y:s,size:i,context:r,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:s,size:i,context:r,rotation:Math.PI/2})},t}(),f="square",m="extra-rounded";var w=function(){return(w=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};const y=function(){function t(t){var e=t.context,s=t.type;this._context=e,this._type=s}return t.prototype.draw=function(t,e,s,i){var r,n=this._context;switch(this._type){case f:r=this._drawSquare;break;case m:r=this._drawExtraRounded;break;default:r=this._drawDot}r.call(this,{x:t,y:e,size:s,context:n,rotation:i})},t.prototype._rotateFigure=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.rotation,o=void 0===n?0:n,a=t.draw,A=e+i/2,l=s+i/2;r.translate(A,l),o&&r.rotate(o),a(),r.closePath(),o&&r.rotate(-o),r.translate(-A,-l)},t.prototype._basicDot=function(t){var e=t.size,s=t.context,i=e/7;this._rotateFigure(w(w({},t),{draw:function(){s.arc(0,0,e/2,0,2*Math.PI),s.arc(0,0,e/2-i,0,2*Math.PI)}}))},t.prototype._basicSquare=function(t){var e=t.size,s=t.context,i=e/7;this._rotateFigure(w(w({},t),{draw:function(){s.rect(-e/2,-e/2,e,e),s.rect(-e/2+i,-e/2+i,e-2*i,e-2*i)}}))},t.prototype._basicExtraRounded=function(t){var e=t.size,s=t.context,i=e/7;this._rotateFigure(w(w({},t),{draw:function(){s.arc(-i,-i,2.5*i,Math.PI,-Math.PI/2),s.lineTo(i,-3.5*i),s.arc(i,-i,2.5*i,-Math.PI/2,0),s.lineTo(3.5*i,-i),s.arc(i,i,2.5*i,0,Math.PI/2),s.lineTo(-i,3.5*i),s.arc(-i,i,2.5*i,Math.PI/2,Math.PI),s.lineTo(-3.5*i,-i),s.arc(-i,-i,1.5*i,Math.PI,-Math.PI/2),s.lineTo(i,-2.5*i),s.arc(i,-i,1.5*i,-Math.PI/2,0),s.lineTo(2.5*i,-i),s.arc(i,i,1.5*i,0,Math.PI/2),s.lineTo(-i,2.5*i),s.arc(-i,i,1.5*i,Math.PI/2,Math.PI),s.lineTo(-2.5*i,-i)}}))},t.prototype._drawDot=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.rotation;this._basicDot({x:e,y:s,size:i,context:r,rotation:n})},t.prototype._drawSquare=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.rotation;this._basicSquare({x:e,y:s,size:i,context:r,rotation:n})},t.prototype._drawExtraRounded=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.rotation;this._basicExtraRounded({x:e,y:s,size:i,context:r,rotation:n})},t}(),C="square";var b=function(){return(b=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};const v=function(){function t(t){var e=t.context,s=t.type;this._context=e,this._type=s}return t.prototype.draw=function(t,e,s,i){var r=this._context;(this._type===C?this._drawSquare:this._drawDot).call(this,{x:t,y:e,size:s,context:r,rotation:i})},t.prototype._rotateFigure=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.rotation,o=void 0===n?0:n,a=t.draw,A=e+i/2,l=s+i/2;r.translate(A,l),o&&r.rotate(o),a(),r.closePath(),o&&r.rotate(-o),r.translate(-A,-l)},t.prototype._basicDot=function(t){var e=t.size,s=t.context;this._rotateFigure(b(b({},t),{draw:function(){s.arc(0,0,e/2,0,2*Math.PI)}}))},t.prototype._basicSquare=function(t){var e=t.size,s=t.context;this._rotateFigure(b(b({},t),{draw:function(){s.rect(-e/2,-e/2,e,e)}}))},t.prototype._drawDot=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.rotation;this._basicDot({x:e,y:s,size:i,context:r,rotation:n})},t.prototype._drawSquare=function(t){var e=t.x,s=t.y,i=t.size,r=t.context,n=t.rotation;this._basicSquare({x:e,y:s,size:i,context:r,rotation:n})},t}(),B="radial";var E=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],P=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];const x=function(){function t(t){this._canvas=document.createElement("canvas"),this._canvas.width=t.width,this._canvas.height=t.height,this._options=t}return Object.defineProperty(t.prototype,"context",{get:function(){return this._canvas.getContext("2d")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._canvas.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._canvas.height},enumerable:!1,configurable:!0}),t.prototype.getCanvas=function(){return this._canvas},t.prototype.clear=function(){var t=this.context;t&&t.clearRect(0,0,this._canvas.width,this._canvas.height)},t.prototype.drawQR=function(t){return e=this,s=void 0,r=function(){var e,s,i,r,n,o,a,h,d,c=this;return function(t,e){var s,i,r,n,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,i=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){o.label=n[1];break}if(6===n[0]&&o.label<r[1]){o.label=r[1],r=n;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(n);break}r[2]&&o.ops.pop(),o.trys.pop();continue}n=e.call(t,o)}catch(t){n=[6,t],i=0}finally{s=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}(this,(function(u){switch(u.label){case 0:return e=t.getModuleCount(),s=Math.min(this._options.width,this._options.height)-2*this._options.margin,i=Math.floor(s/e),r={hideXDots:0,hideYDots:0,width:0,height:0},this._qr=t,this._options.image?[4,this.loadImage()]:[3,2];case 1:if(u.sent(),!this._image)return[2];n=this._options,o=n.imageOptions,a=n.qrOptions,h=o.imageSize*l[a.errorCorrectionLevel],d=Math.floor(h*e*e),r=A({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:d,maxHiddenAxisDots:e-14,dotSize:i}),u.label=2;case 2:return this.clear(),this.drawBackground(),this.drawDots((function(t,s){var i,n,o,a,A,l;return!(c._options.imageOptions.hideBackgroundDots&&t>=(e-r.hideXDots)/2&&t<(e+r.hideXDots)/2&&s>=(e-r.hideYDots)/2&&s<(e+r.hideYDots)/2||(null===(i=E[t])||void 0===i?void 0:i[s])||(null===(n=E[t-e+7])||void 0===n?void 0:n[s])||(null===(o=E[t])||void 0===o?void 0:o[s-e+7])||(null===(a=P[t])||void 0===a?void 0:a[s])||(null===(A=P[t-e+7])||void 0===A?void 0:A[s])||(null===(l=P[t])||void 0===l?void 0:l[s-e+7]))})),this.drawCorners(),this._options.image&&this.drawImage({width:r.width,height:r.height,count:e,dotSize:i}),[2]}}))},new((i=void 0)||(i=Promise))((function(t,n){function o(t){try{A(r.next(t))}catch(t){n(t)}}function a(t){try{A(r.throw(t))}catch(t){n(t)}}function A(e){var s;e.done?t(e.value):(s=e.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,a)}A((r=r.apply(e,s||[])).next())}));var e,s,i,r},t.prototype.drawBackground=function(){var t=this.context,e=this._options;if(t){if(e.backgroundOptions.gradient){var s=e.backgroundOptions.gradient,i=this._createGradient({context:t,options:s,additionalRotation:0,x:0,y:0,size:this._canvas.width>this._canvas.height?this._canvas.width:this._canvas.height});s.colorStops.forEach((function(t){var e=t.offset,s=t.color;i.addColorStop(e,s)})),t.fillStyle=i}else e.backgroundOptions.color&&(t.fillStyle=e.backgroundOptions.color);t.fillRect(0,0,this._canvas.width,this._canvas.height)}},t.prototype.drawDots=function(t){var e=this;if(!this._qr)throw"QR code is not defined";var s=this.context;if(!s)throw"QR code is not defined";var i=this._options,r=this._qr.getModuleCount();if(r>i.width||r>i.height)throw"The canvas is too small.";var n=Math.min(i.width,i.height)-2*i.margin,o=Math.floor(n/r),a=Math.floor((i.width-r*o)/2),A=Math.floor((i.height-r*o)/2),l=new g({context:s,type:i.dotsOptions.type});s.beginPath();for(var h=function(s){for(var i=function(i){return t&&!t(s,i)?"continue":d._qr.isDark(s,i)?void l.draw(a+s*o,A+i*o,o,(function(n,o){return!(s+n<0||i+o<0||s+n>=r||i+o>=r)&&!(t&&!t(s+n,i+o))&&!!e._qr&&e._qr.isDark(s+n,i+o)})):"continue"},n=0;n<r;n++)i(n)},d=this,c=0;c<r;c++)h(c);if(i.dotsOptions.gradient){var u=i.dotsOptions.gradient,p=this._createGradient({context:s,options:u,additionalRotation:0,x:a,y:A,size:r*o});u.colorStops.forEach((function(t){var e=t.offset,s=t.color;p.addColorStop(e,s)})),s.fillStyle=s.strokeStyle=p}else i.dotsOptions.color&&(s.fillStyle=s.strokeStyle=i.dotsOptions.color);s.fill("evenodd")},t.prototype.drawCorners=function(t){var e=this;if(!this._qr)throw"QR code is not defined";var s=this.context;if(!s)throw"QR code is not defined";var i=this._options,r=this._qr.getModuleCount(),n=Math.min(i.width,i.height)-2*i.margin,o=Math.floor(n/r),a=7*o,A=3*o,l=Math.floor((i.width-r*o)/2),h=Math.floor((i.height-r*o)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach((function(n){var d,c,u,p,_,f,m,w,C,b,B=n[0],x=n[1],S=n[2];if(!t||t(B,x)){var I=l+B*o*(r-7),R=h+x*o*(r-7);if(null===(d=i.cornersSquareOptions)||void 0===d?void 0:d.type){var T=new y({context:s,type:null===(c=i.cornersSquareOptions)||void 0===c?void 0:c.type});s.beginPath(),T.draw(I,R,a,S)}else{var O=new g({context:s,type:i.dotsOptions.type});s.beginPath();for(var F=function(t){for(var e=function(e){if(!(null===(u=E[t])||void 0===u?void 0:u[e]))return"continue";O.draw(I+t*o,R+e*o,o,(function(s,i){var r;return!!(null===(r=E[t+s])||void 0===r?void 0:r[e+i])}))},s=0;s<E[t].length;s++)e(s)},D=0;D<E.length;D++)F(D)}if(null===(p=i.cornersSquareOptions)||void 0===p?void 0:p.gradient){var L=i.cornersSquareOptions.gradient,N=e._createGradient({context:s,options:L,additionalRotation:S,x:I,y:R,size:a});L.colorStops.forEach((function(t){var e=t.offset,s=t.color;N.addColorStop(e,s)})),s.fillStyle=s.strokeStyle=N}else(null===(_=i.cornersSquareOptions)||void 0===_?void 0:_.color)&&(s.fillStyle=s.strokeStyle=i.cornersSquareOptions.color);if(s.fill("evenodd"),null===(f=i.cornersDotOptions)||void 0===f?void 0:f.type){var H=new v({context:s,type:null===(m=i.cornersDotOptions)||void 0===m?void 0:m.type});s.beginPath(),H.draw(I+2*o,R+2*o,A,S)}else{O=new g({context:s,type:i.dotsOptions.type}),s.beginPath();var Q=function(t){for(var e=function(e){if(!(null===(w=P[t])||void 0===w?void 0:w[e]))return"continue";O.draw(I+t*o,R+e*o,o,(function(s,i){var r;return!!(null===(r=P[t+s])||void 0===r?void 0:r[e+i])}))},s=0;s<P[t].length;s++)e(s)};for(D=0;D<P.length;D++)Q(D)}if(null===(C=i.cornersDotOptions)||void 0===C?void 0:C.gradient){L=i.cornersDotOptions.gradient;var U=e._createGradient({context:s,options:L,additionalRotation:S,x:I+2*o,y:R+2*o,size:A});L.colorStops.forEach((function(t){var e=t.offset,s=t.color;U.addColorStop(e,s)})),s.fillStyle=s.strokeStyle=U}else(null===(b=i.cornersDotOptions)||void 0===b?void 0:b.color)&&(s.fillStyle=s.strokeStyle=i.cornersDotOptions.color);s.fill("evenodd")}}))},t.prototype.loadImage=function(){var t=this;return new Promise((function(e,s){var i=t._options,r=new Image;if(!i.image)return s("Image is not defined");"string"==typeof i.imageOptions.crossOrigin&&(r.crossOrigin=i.imageOptions.crossOrigin),t._image=r,r.onload=function(){e()},r.src=i.image}))},t.prototype.drawImage=function(t){var e=t.width,s=t.height,i=t.count,r=t.dotSize,n=this.context;if(!n)throw"canvasContext is not defined";if(!this._image)throw"image is not defined";var o=this._options,a=Math.floor((o.width-i*r)/2),A=Math.floor((o.height-i*r)/2),l=a+o.imageOptions.margin+(i*r-e)/2,h=A+o.imageOptions.margin+(i*r-s)/2,d=e-2*o.imageOptions.margin,c=s-2*o.imageOptions.margin;n.drawImage(this._image,l,h,d<0?0:d,c<0?0:c)},t.prototype._createGradient=function(t){var e,s=t.context,i=t.options,r=t.additionalRotation,n=t.x,o=t.y,a=t.size;if(i.type===B)e=s.createRadialGradient(n+a/2,o+a/2,0,n+a/2,o+a/2,a/2);else{var A=((i.rotation||0)+r)%(2*Math.PI),l=(A+2*Math.PI)%(2*Math.PI),h=n+a/2,d=o+a/2,c=n+a/2,u=o+a/2;l>=0&&l<=.25*Math.PI||l>1.75*Math.PI&&l<=2*Math.PI?(h-=a/2,d-=a/2*Math.tan(A),c+=a/2,u+=a/2*Math.tan(A)):l>.25*Math.PI&&l<=.75*Math.PI?(d-=a/2,h-=a/2/Math.tan(A),u+=a/2,c+=a/2/Math.tan(A)):l>.75*Math.PI&&l<=1.25*Math.PI?(h+=a/2,d+=a/2*Math.tan(A),c-=a/2,u-=a/2*Math.tan(A)):l>1.25*Math.PI&&l<=1.75*Math.PI&&(d+=a/2,h+=a/2/Math.tan(A),u-=a/2,c-=a/2/Math.tan(A)),e=s.createLinearGradient(Math.round(h),Math.round(d),Math.round(c),Math.round(u))}return e},t}();var S=function(){return(S=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};const I=function(){function t(t){var e=t.svg,s=t.type;this._svg=e,this._type=s}return t.prototype.draw=function(t,e,s,i){var r;switch(this._type){case h:r=this._drawDot;break;case c:r=this._drawClassy;break;case u:r=this._drawClassyRounded;break;case d:r=this._drawRounded;break;case p:r=this._drawExtraRounded;break;default:r=this._drawSquare}r.call(this,{x:t,y:e,size:s,getNeighbor:i})},t.prototype._rotateFigure=function(t){var e,s=t.x,i=t.y,r=t.size,n=t.rotation,o=void 0===n?0:n,a=s+r/2,A=i+r/2;(0,t.draw)(),null===(e=this._element)||void 0===e||e.setAttribute("transform","rotate("+180*o/Math.PI+","+a+","+A+")")},t.prototype._basicDot=function(t){var e=this,s=t.size,i=t.x,r=t.y;this._rotateFigure(S(S({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),e._element.setAttribute("cx",String(i+s/2)),e._element.setAttribute("cy",String(r+s/2)),e._element.setAttribute("r",String(s/2))}}))},t.prototype._basicSquare=function(t){var e=this,s=t.size,i=t.x,r=t.y;this._rotateFigure(S(S({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),e._element.setAttribute("x",String(i)),e._element.setAttribute("y",String(r)),e._element.setAttribute("width",String(s)),e._element.setAttribute("height",String(s))}}))},t.prototype._basicSideRounded=function(t){var e=this,s=t.size,i=t.x,r=t.y;this._rotateFigure(S(S({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","path"),e._element.setAttribute("d","M "+i+" "+r+"v "+s+"h "+s/2+"a "+s/2+" "+s/2+", 0, 0, 0, 0 "+-s)}}))},t.prototype._basicCornerRounded=function(t){var e=this,s=t.size,i=t.x,r=t.y;this._rotateFigure(S(S({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","path"),e._element.setAttribute("d","M "+i+" "+r+"v "+s+"h "+s+"v "+-s/2+"a "+s/2+" "+s/2+", 0, 0, 0, "+-s/2+" "+-s/2)}}))},t.prototype._basicCornerExtraRounded=function(t){var e=this,s=t.size,i=t.x,r=t.y;this._rotateFigure(S(S({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","path"),e._element.setAttribute("d","M "+i+" "+r+"v "+s+"h "+s+"a "+s+" "+s+", 0, 0, 0, "+-s+" "+-s)}}))},t.prototype._basicCornersRounded=function(t){var e=this,s=t.size,i=t.x,r=t.y;this._rotateFigure(S(S({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","path"),e._element.setAttribute("d","M "+i+" "+r+"v "+s/2+"a "+s/2+" "+s/2+", 0, 0, 0, "+s/2+" "+s/2+"h "+s/2+"v "+-s/2+"a "+s/2+" "+s/2+", 0, 0, 0, "+-s/2+" "+-s/2)}}))},t.prototype._drawDot=function(t){var e=t.x,s=t.y,i=t.size;this._basicDot({x:e,y:s,size:i,rotation:0})},t.prototype._drawSquare=function(t){var e=t.x,s=t.y,i=t.size;this._basicSquare({x:e,y:s,size:i,rotation:0})},t.prototype._drawRounded=function(t){var e=t.x,s=t.y,i=t.size,r=t.getNeighbor,n=r?+r(-1,0):0,o=r?+r(1,0):0,a=r?+r(0,-1):0,A=r?+r(0,1):0,l=n+o+a+A;if(0!==l)if(l>2||n&&o||a&&A)this._basicSquare({x:e,y:s,size:i,rotation:0});else{if(2===l){var h=0;return n&&a?h=Math.PI/2:a&&o?h=Math.PI:o&&A&&(h=-Math.PI/2),void this._basicCornerRounded({x:e,y:s,size:i,rotation:h})}if(1===l)return h=0,a?h=Math.PI/2:o?h=Math.PI:A&&(h=-Math.PI/2),void this._basicSideRounded({x:e,y:s,size:i,rotation:h})}else this._basicDot({x:e,y:s,size:i,rotation:0})},t.prototype._drawExtraRounded=function(t){var e=t.x,s=t.y,i=t.size,r=t.getNeighbor,n=r?+r(-1,0):0,o=r?+r(1,0):0,a=r?+r(0,-1):0,A=r?+r(0,1):0,l=n+o+a+A;if(0!==l)if(l>2||n&&o||a&&A)this._basicSquare({x:e,y:s,size:i,rotation:0});else{if(2===l){var h=0;return n&&a?h=Math.PI/2:a&&o?h=Math.PI:o&&A&&(h=-Math.PI/2),void this._basicCornerExtraRounded({x:e,y:s,size:i,rotation:h})}if(1===l)return h=0,a?h=Math.PI/2:o?h=Math.PI:A&&(h=-Math.PI/2),void this._basicSideRounded({x:e,y:s,size:i,rotation:h})}else this._basicDot({x:e,y:s,size:i,rotation:0})},t.prototype._drawClassy=function(t){var e=t.x,s=t.y,i=t.size,r=t.getNeighbor,n=r?+r(-1,0):0,o=r?+r(1,0):0,a=r?+r(0,-1):0,A=r?+r(0,1):0;0!==n+o+a+A?n||a?o||A?this._basicSquare({x:e,y:s,size:i,rotation:0}):this._basicCornerRounded({x:e,y:s,size:i,rotation:Math.PI/2}):this._basicCornerRounded({x:e,y:s,size:i,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:s,size:i,rotation:Math.PI/2})},t.prototype._drawClassyRounded=function(t){var e=t.x,s=t.y,i=t.size,r=t.getNeighbor,n=r?+r(-1,0):0,o=r?+r(1,0):0,a=r?+r(0,-1):0,A=r?+r(0,1):0;0!==n+o+a+A?n||a?o||A?this._basicSquare({x:e,y:s,size:i,rotation:0}):this._basicCornerExtraRounded({x:e,y:s,size:i,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:e,y:s,size:i,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:s,size:i,rotation:Math.PI/2})},t}();var R=function(){return(R=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};const T=function(){function t(t){var e=t.svg,s=t.type;this._svg=e,this._type=s}return t.prototype.draw=function(t,e,s,i){var r;switch(this._type){case f:r=this._drawSquare;break;case m:r=this._drawExtraRounded;break;default:r=this._drawDot}r.call(this,{x:t,y:e,size:s,rotation:i})},t.prototype._rotateFigure=function(t){var e,s=t.x,i=t.y,r=t.size,n=t.rotation,o=void 0===n?0:n,a=s+r/2,A=i+r/2;(0,t.draw)(),null===(e=this._element)||void 0===e||e.setAttribute("transform","rotate("+180*o/Math.PI+","+a+","+A+")")},t.prototype._basicDot=function(t){var e=this,s=t.size,i=t.x,r=t.y,n=s/7;this._rotateFigure(R(R({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","path"),e._element.setAttribute("clip-rule","evenodd"),e._element.setAttribute("d","M "+(i+s/2)+" "+r+"a "+s/2+" "+s/2+" 0 1 0 0.1 0zm 0 "+n+"a "+(s/2-n)+" "+(s/2-n)+" 0 1 1 -0.1 0Z")}}))},t.prototype._basicSquare=function(t){var e=this,s=t.size,i=t.x,r=t.y,n=s/7;this._rotateFigure(R(R({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","path"),e._element.setAttribute("clip-rule","evenodd"),e._element.setAttribute("d","M "+i+" "+r+"v "+s+"h "+s+"v "+-s+"zM "+(i+n)+" "+(r+n)+"h "+(s-2*n)+"v "+(s-2*n)+"h "+(2*n-s)+"z")}}))},t.prototype._basicExtraRounded=function(t){var e=this,s=t.size,i=t.x,r=t.y,n=s/7;this._rotateFigure(R(R({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","path"),e._element.setAttribute("clip-rule","evenodd"),e._element.setAttribute("d","M "+i+" "+(r+2.5*n)+"v "+2*n+"a "+2.5*n+" "+2.5*n+", 0, 0, 0, "+2.5*n+" "+2.5*n+"h "+2*n+"a "+2.5*n+" "+2.5*n+", 0, 0, 0, "+2.5*n+" "+2.5*-n+"v "+-2*n+"a "+2.5*n+" "+2.5*n+", 0, 0, 0, "+2.5*-n+" "+2.5*-n+"h "+-2*n+"a "+2.5*n+" "+2.5*n+", 0, 0, 0, "+2.5*-n+" "+2.5*n+"M "+(i+2.5*n)+" "+(r+n)+"h "+2*n+"a "+1.5*n+" "+1.5*n+", 0, 0, 1, "+1.5*n+" "+1.5*n+"v "+2*n+"a "+1.5*n+" "+1.5*n+", 0, 0, 1, "+1.5*-n+" "+1.5*n+"h "+-2*n+"a "+1.5*n+" "+1.5*n+", 0, 0, 1, "+1.5*-n+" "+1.5*-n+"v "+-2*n+"a "+1.5*n+" "+1.5*n+", 0, 0, 1, "+1.5*n+" "+1.5*-n)}}))},t.prototype._drawDot=function(t){var e=t.x,s=t.y,i=t.size,r=t.rotation;this._basicDot({x:e,y:s,size:i,rotation:r})},t.prototype._drawSquare=function(t){var e=t.x,s=t.y,i=t.size,r=t.rotation;this._basicSquare({x:e,y:s,size:i,rotation:r})},t.prototype._drawExtraRounded=function(t){var e=t.x,s=t.y,i=t.size,r=t.rotation;this._basicExtraRounded({x:e,y:s,size:i,rotation:r})},t}();var O=function(){return(O=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};const F=function(){function t(t){var e=t.svg,s=t.type;this._svg=e,this._type=s}return t.prototype.draw=function(t,e,s,i){(this._type===C?this._drawSquare:this._drawDot).call(this,{x:t,y:e,size:s,rotation:i})},t.prototype._rotateFigure=function(t){var e,s=t.x,i=t.y,r=t.size,n=t.rotation,o=void 0===n?0:n,a=s+r/2,A=i+r/2;(0,t.draw)(),null===(e=this._element)||void 0===e||e.setAttribute("transform","rotate("+180*o/Math.PI+","+a+","+A+")")},t.prototype._basicDot=function(t){var e=this,s=t.size,i=t.x,r=t.y;this._rotateFigure(O(O({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),e._element.setAttribute("cx",String(i+s/2)),e._element.setAttribute("cy",String(r+s/2)),e._element.setAttribute("r",String(s/2))}}))},t.prototype._basicSquare=function(t){var e=this,s=t.size,i=t.x,r=t.y;this._rotateFigure(O(O({},t),{draw:function(){e._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),e._element.setAttribute("x",String(i)),e._element.setAttribute("y",String(r)),e._element.setAttribute("width",String(s)),e._element.setAttribute("height",String(s))}}))},t.prototype._drawDot=function(t){var e=t.x,s=t.y,i=t.size,r=t.rotation;this._basicDot({x:e,y:s,size:i,rotation:r})},t.prototype._drawSquare=function(t){var e=t.x,s=t.y,i=t.size,r=t.rotation;this._basicSquare({x:e,y:s,size:i,rotation:r})},t}();var D=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],L=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];const N=function(){function t(t){this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(t.width)),this._element.setAttribute("height",String(t.height)),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._options=t}return Object.defineProperty(t.prototype,"width",{get:function(){return this._options.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._options.height},enumerable:!1,configurable:!0}),t.prototype.getElement=function(){return this._element},t.prototype.clear=function(){var t,e=this._element;this._element=e.cloneNode(!1),null===(t=null==e?void 0:e.parentNode)||void 0===t||t.replaceChild(this._element,e),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs)},t.prototype.drawQR=function(t){return e=this,s=void 0,r=function(){var e,s,i,r,n,o,a,h,d,c=this;return function(t,e){var s,i,r,n,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,i=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){o.label=n[1];break}if(6===n[0]&&o.label<r[1]){o.label=r[1],r=n;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(n);break}r[2]&&o.ops.pop(),o.trys.pop();continue}n=e.call(t,o)}catch(t){n=[6,t],i=0}finally{s=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}(this,(function(u){switch(u.label){case 0:return e=t.getModuleCount(),s=Math.min(this._options.width,this._options.height)-2*this._options.margin,i=Math.floor(s/e),r={hideXDots:0,hideYDots:0,width:0,height:0},this._qr=t,this._options.image?[4,this.loadImage()]:[3,2];case 1:if(u.sent(),!this._image)return[2];n=this._options,o=n.imageOptions,a=n.qrOptions,h=o.imageSize*l[a.errorCorrectionLevel],d=Math.floor(h*e*e),r=A({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:d,maxHiddenAxisDots:e-14,dotSize:i}),u.label=2;case 2:return this.clear(),this.drawBackground(),this.drawDots((function(t,s){var i,n,o,a,A,l;return!(c._options.imageOptions.hideBackgroundDots&&t>=(e-r.hideXDots)/2&&t<(e+r.hideXDots)/2&&s>=(e-r.hideYDots)/2&&s<(e+r.hideYDots)/2||(null===(i=D[t])||void 0===i?void 0:i[s])||(null===(n=D[t-e+7])||void 0===n?void 0:n[s])||(null===(o=D[t])||void 0===o?void 0:o[s-e+7])||(null===(a=L[t])||void 0===a?void 0:a[s])||(null===(A=L[t-e+7])||void 0===A?void 0:A[s])||(null===(l=L[t])||void 0===l?void 0:l[s-e+7]))})),this.drawCorners(),this._options.image&&this.drawImage({width:r.width,height:r.height,count:e,dotSize:i}),[2]}}))},new((i=void 0)||(i=Promise))((function(t,n){function o(t){try{A(r.next(t))}catch(t){n(t)}}function a(t){try{A(r.throw(t))}catch(t){n(t)}}function A(e){var s;e.done?t(e.value):(s=e.value,s instanceof i?s:new i((function(t){t(s)}))).then(o,a)}A((r=r.apply(e,s||[])).next())}));var e,s,i,r},t.prototype.drawBackground=function(){var t,e,s=this._element,i=this._options;if(s){var r=null===(t=i.backgroundOptions)||void 0===t?void 0:t.gradient,n=null===(e=i.backgroundOptions)||void 0===e?void 0:e.color;(r||n)&&this._createColor({options:r,color:n,additionalRotation:0,x:0,y:0,height:i.height,width:i.width,name:"background-color"})}},t.prototype.drawDots=function(t){var e,s,i=this;if(!this._qr)throw"QR code is not defined";var r=this._options,n=this._qr.getModuleCount();if(n>r.width||n>r.height)throw"The canvas is too small.";var o=Math.min(r.width,r.height)-2*r.margin,a=Math.floor(o/n),A=Math.floor((r.width-n*a)/2),l=Math.floor((r.height-n*a)/2),h=new I({svg:this._element,type:r.dotsOptions.type});this._dotsClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id","clip-path-dot-color"),this._defs.appendChild(this._dotsClipPath),this._createColor({options:null===(e=r.dotsOptions)||void 0===e?void 0:e.gradient,color:r.dotsOptions.color,additionalRotation:0,x:A,y:l,height:n*a,width:n*a,name:"dot-color"});for(var d=function(e){for(var r=function(r){return t&&!t(e,r)?"continue":(null===(s=c._qr)||void 0===s?void 0:s.isDark(e,r))?(h.draw(A+e*a,l+r*a,a,(function(s,o){return!(e+s<0||r+o<0||e+s>=n||r+o>=n)&&!(t&&!t(e+s,r+o))&&!!i._qr&&i._qr.isDark(e+s,r+o)})),void(h._element&&c._dotsClipPath&&c._dotsClipPath.appendChild(h._element))):"continue"},o=0;o<n;o++)r(o)},c=this,u=0;u<n;u++)d(u)},t.prototype.drawCorners=function(){var t=this;if(!this._qr)throw"QR code is not defined";var e=this._element,s=this._options;if(!e)throw"Element code is not defined";var i=this._qr.getModuleCount(),r=Math.min(s.width,s.height)-2*s.margin,n=Math.floor(r/i),o=7*n,a=3*n,A=Math.floor((s.width-i*n)/2),l=Math.floor((s.height-i*n)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach((function(e){var r,h,d,c,u,p,_,g,f,m,w,y,C=e[0],b=e[1],v=e[2],B=A+C*n*(i-7),E=l+b*n*(i-7),P=t._dotsClipPath,x=t._dotsClipPath;if(((null===(r=s.cornersSquareOptions)||void 0===r?void 0:r.gradient)||(null===(h=s.cornersSquareOptions)||void 0===h?void 0:h.color))&&((P=document.createElementNS("http://www.w3.org/2000/svg","clipPath")).setAttribute("id","clip-path-corners-square-color-"+C+"-"+b),t._defs.appendChild(P),t._cornersSquareClipPath=t._cornersDotClipPath=x=P,t._createColor({options:null===(d=s.cornersSquareOptions)||void 0===d?void 0:d.gradient,color:null===(c=s.cornersSquareOptions)||void 0===c?void 0:c.color,additionalRotation:v,x:B,y:E,height:o,width:o,name:"corners-square-color-"+C+"-"+b})),null===(u=s.cornersSquareOptions)||void 0===u?void 0:u.type){var S=new T({svg:t._element,type:s.cornersSquareOptions.type});S.draw(B,E,o,v),S._element&&P&&P.appendChild(S._element)}else for(var R=new I({svg:t._element,type:s.dotsOptions.type}),O=function(t){for(var e=function(e){if(!(null===(p=D[t])||void 0===p?void 0:p[e]))return"continue";R.draw(B+t*n,E+e*n,n,(function(s,i){var r;return!!(null===(r=D[t+s])||void 0===r?void 0:r[e+i])})),R._element&&P&&P.appendChild(R._element)},s=0;s<D[t].length;s++)e(s)},N=0;N<D.length;N++)O(N);if(((null===(_=s.cornersDotOptions)||void 0===_?void 0:_.gradient)||(null===(g=s.cornersDotOptions)||void 0===g?void 0:g.color))&&((x=document.createElementNS("http://www.w3.org/2000/svg","clipPath")).setAttribute("id","clip-path-corners-dot-color-"+C+"-"+b),t._defs.appendChild(x),t._cornersDotClipPath=x,t._createColor({options:null===(f=s.cornersDotOptions)||void 0===f?void 0:f.gradient,color:null===(m=s.cornersDotOptions)||void 0===m?void 0:m.color,additionalRotation:v,x:B+2*n,y:E+2*n,height:a,width:a,name:"corners-dot-color-"+C+"-"+b})),null===(w=s.cornersDotOptions)||void 0===w?void 0:w.type){var H=new F({svg:t._element,type:s.cornersDotOptions.type});H.draw(B+2*n,E+2*n,a,v),H._element&&x&&x.appendChild(H._element)}else{R=new I({svg:t._element,type:s.dotsOptions.type});var Q=function(t){for(var e=function(e){if(!(null===(y=L[t])||void 0===y?void 0:y[e]))return"continue";R.draw(B+t*n,E+e*n,n,(function(s,i){var r;return!!(null===(r=L[t+s])||void 0===r?void 0:r[e+i])})),R._element&&x&&x.appendChild(R._element)},s=0;s<L[t].length;s++)e(s)};for(N=0;N<L.length;N++)Q(N)}}))},t.prototype.loadImage=function(){var t=this;return new Promise((function(e,s){var i=t._options,r=new Image;if(!i.image)return s("Image is not defined");"string"==typeof i.imageOptions.crossOrigin&&(r.crossOrigin=i.imageOptions.crossOrigin),t._image=r,r.onload=function(){e()},r.src=i.image}))},t.prototype.drawImage=function(t){var e=t.width,s=t.height,i=t.count,r=t.dotSize,n=this._options,o=Math.floor((n.width-i*r)/2),a=Math.floor((n.height-i*r)/2),A=o+n.imageOptions.margin+(i*r-e)/2,l=a+n.imageOptions.margin+(i*r-s)/2,h=e-2*n.imageOptions.margin,d=s-2*n.imageOptions.margin,c=document.createElementNS("http://www.w3.org/2000/svg","image");c.setAttribute("href",n.image||""),c.setAttribute("x",String(A)),c.setAttribute("y",String(l)),c.setAttribute("width",h+"px"),c.setAttribute("height",d+"px"),this._element.appendChild(c)},t.prototype._createColor=function(t){var e=t.options,s=t.color,i=t.additionalRotation,r=t.x,n=t.y,o=t.height,a=t.width,A=t.name,l=a>o?a:o,h=document.createElementNS("http://www.w3.org/2000/svg","rect");if(h.setAttribute("x",String(r)),h.setAttribute("y",String(n)),h.setAttribute("height",String(o)),h.setAttribute("width",String(a)),h.setAttribute("clip-path","url('#clip-path-"+A+"')"),e){var d;if(e.type===B)(d=document.createElementNS("http://www.w3.org/2000/svg","radialGradient")).setAttribute("id",A),d.setAttribute("gradientUnits","userSpaceOnUse"),d.setAttribute("fx",String(r+a/2)),d.setAttribute("fy",String(n+o/2)),d.setAttribute("cx",String(r+a/2)),d.setAttribute("cy",String(n+o/2)),d.setAttribute("r",String(l/2));else{var c=((e.rotation||0)+i)%(2*Math.PI),u=(c+2*Math.PI)%(2*Math.PI),p=r+a/2,_=n+o/2,g=r+a/2,f=n+o/2;u>=0&&u<=.25*Math.PI||u>1.75*Math.PI&&u<=2*Math.PI?(p-=a/2,_-=o/2*Math.tan(c),g+=a/2,f+=o/2*Math.tan(c)):u>.25*Math.PI&&u<=.75*Math.PI?(_-=o/2,p-=a/2/Math.tan(c),f+=o/2,g+=a/2/Math.tan(c)):u>.75*Math.PI&&u<=1.25*Math.PI?(p+=a/2,_+=o/2*Math.tan(c),g-=a/2,f-=o/2*Math.tan(c)):u>1.25*Math.PI&&u<=1.75*Math.PI&&(_+=o/2,p+=a/2/Math.tan(c),f-=o/2,g-=a/2/Math.tan(c)),(d=document.createElementNS("http://www.w3.org/2000/svg","linearGradient")).setAttribute("id",A),d.setAttribute("gradientUnits","userSpaceOnUse"),d.setAttribute("x1",String(Math.round(p))),d.setAttribute("y1",String(Math.round(_))),d.setAttribute("x2",String(Math.round(g))),d.setAttribute("y2",String(Math.round(f)))}e.colorStops.forEach((function(t){var e=t.offset,s=t.color,i=document.createElementNS("http://www.w3.org/2000/svg","stop");i.setAttribute("offset",100*e+"%"),i.setAttribute("stop-color",s),d.appendChild(i)})),h.setAttribute("fill","url('#"+A+"')"),this._defs.appendChild(d)}else s&&h.setAttribute("fill",s);this._element.appendChild(h)},t}(),H="canvas";for(var Q={},U=0;U<=40;U++)Q[U]=U;const M={type:H,width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:Q[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000"},backgroundOptions:{color:"#fff"}};var k=function(){return(k=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function V(t){var e=k({},t);if(!e.colorStops||!e.colorStops.length)throw"Field 'colorStops' is required in gradient";return e.rotation?e.rotation=Number(e.rotation):e.rotation=0,e.colorStops=e.colorStops.map((function(t){return k(k({},t),{offset:Number(t.offset)})})),e}function G(t){var e=k({},t);return e.width=Number(e.width),e.height=Number(e.height),e.margin=Number(e.margin),e.imageOptions=k(k({},e.imageOptions),{hideBackgroundDots:Boolean(e.imageOptions.hideBackgroundDots),imageSize:Number(e.imageOptions.imageSize),margin:Number(e.imageOptions.margin)}),e.margin>Math.min(e.width,e.height)&&(e.margin=Math.min(e.width,e.height)),e.dotsOptions=k({},e.dotsOptions),e.dotsOptions.gradient&&(e.dotsOptions.gradient=V(e.dotsOptions.gradient)),e.cornersSquareOptions&&(e.cornersSquareOptions=k({},e.cornersSquareOptions),e.cornersSquareOptions.gradient&&(e.cornersSquareOptions.gradient=V(e.cornersSquareOptions.gradient))),e.cornersDotOptions&&(e.cornersDotOptions=k({},e.cornersDotOptions),e.cornersDotOptions.gradient&&(e.cornersDotOptions.gradient=V(e.cornersDotOptions.gradient))),e.backgroundOptions&&(e.backgroundOptions=k({},e.backgroundOptions),e.backgroundOptions.gradient&&(e.backgroundOptions.gradient=V(e.backgroundOptions.gradient))),e}var K=s(192),W=s.n(K),z=function(t,e,s,i){return new(s||(s=Promise))((function(r,n){function o(t){try{A(i.next(t))}catch(t){n(t)}}function a(t){try{A(i.throw(t))}catch(t){n(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}A((i=i.apply(t,e||[])).next())}))},$=function(t,e){var s,i,r,n,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,i=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){o.label=n[1];break}if(6===n[0]&&o.label<r[1]){o.label=r[1],r=n;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(n);break}r[2]&&o.ops.pop(),o.trys.pop();continue}n=e.call(t,o)}catch(t){n=[6,t],i=0}finally{s=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};const X=function(){function t(t){this._options=t?G(o(M,t)):M,this.update()}return t._clearContainer=function(t){t&&(t.innerHTML="")},t.prototype._getQRStylingElement=function(t){return void 0===t&&(t="png"),z(this,void 0,void 0,(function(){var e,s,i;return $(this,(function(r){switch(r.label){case 0:if(!this._qr)throw"QR code is empty";return"svg"!==t.toLowerCase()?[3,2]:(s=void 0,e=void 0,this._svg&&this._svgDrawingPromise?(e=this._svg,s=this._svgDrawingPromise):(e=new N(this._options),s=e.drawQR(this._qr)),[4,s]);case 1:return r.sent(),[2,e];case 2:return s=void 0,i=void 0,this._canvas&&this._canvasDrawingPromise?(i=this._canvas,s=this._canvasDrawingPromise):(i=new x(this._options),s=i.drawQR(this._qr)),[4,s];case 3:return r.sent(),[2,i]}}))}))},t.prototype.update=function(e){t._clearContainer(this._container),this._options=e?G(o(this._options,e)):this._options,this._options.data&&(this._qr=W()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(t){switch(!0){case/^[0-9]*$/.test(t):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(t):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===H?(this._canvas=new x(this._options),this._canvasDrawingPromise=this._canvas.drawQR(this._qr),this._svgDrawingPromise=void 0,this._svg=void 0):(this._svg=new N(this._options),this._svgDrawingPromise=this._svg.drawQR(this._qr),this._canvasDrawingPromise=void 0,this._canvas=void 0),this.append(this._container))},t.prototype.append=function(t){if(t){if("function"!=typeof t.appendChild)throw"Container should be a single DOM node";this._options.type===H?this._canvas&&t.appendChild(this._canvas.getCanvas()):this._svg&&t.appendChild(this._svg.getElement()),this._container=t}},t.prototype.getRawData=function(t){return void 0===t&&(t="png"),z(this,void 0,void 0,(function(){var e,s,i;return $(this,(function(r){switch(r.label){case 0:if(!this._qr)throw"QR code is empty";return[4,this._getQRStylingElement(t)];case 1:return e=r.sent(),"svg"===t.toLowerCase()?(s=new XMLSerializer,i=s.serializeToString(e.getElement()),[2,new Blob(['<?xml version="1.0" standalone="no"?>\r\n'+i],{type:"image/svg+xml"})]):[2,new Promise((function(s){return e.getCanvas().toBlob(s,"image/"+t,1)}))]}}))}))},t.prototype.download=function(t){return z(this,void 0,void 0,(function(){var e,s,i,r,n;return $(this,(function(o){switch(o.label){case 0:if(!this._qr)throw"QR code is empty";return e="png",s="qr","string"==typeof t?(e=t,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):"object"==typeof t&&null!==t&&(t.name&&(s=t.name),t.extension&&(e=t.extension)),[4,this._getQRStylingElement(e)];case 1:return i=o.sent(),"svg"===e.toLowerCase()?(r=new XMLSerializer,n='<?xml version="1.0" standalone="no"?>\r\n'+(n=r.serializeToString(i.getElement())),a("data:image/svg+xml;charset=utf-8,"+encodeURIComponent(n),s+".svg")):a(i.getCanvas().toDataURL("image/"+e),s+"."+e),[2]}}))}))},t}()}},e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i](r,r.exports,s),r.exports}return s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s(796)})().default})),zu=ah(Wu);class $u extends Mi{constructor(t,e){super(t,e,"qrcodeItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-qrcode rr-item-element"}get guardLabel(){return"qrcode"}get debugLabel(){return"qrcode"}_doMeasure(t,e,s,i){const r=this.model;return this._setModelSize(r,e,s,i),this._isTesting()||this.$_render(t,r,e),Me.create(e.offsetWidth,e.offsetHeight)}isDom(t){return t.parentElement===this.dom||super.isDom(t)}$_getText(t,e){let s="";return e.value?(s=t.printing?this.getPrintValue(t,e):e.value,s=J.toStr(s)):e.text&&(s=e.text),s}$_render(t,e,s){const i=this._modelWidth||0,r=this._modelHeight||0,n=ha.QRCODE_MIN_SIZE;if(i<n||r<n)return;const o=this.$_getText(t,e);if(this._qrcode){const{width:t,height:e}=this._qrcode._options;i===t&&r===e||this._qrcode.update({width:i,height:r})}else{this._qrcode=new zu({width:i,height:r,data:o,qrOptions:{errorCorrectionLevel:e.errorCorrectionLevel}}),this._qrcode.append(s);const t=s.querySelector("canvas");s.removeChild(t);const n=t.toDataURL(),a=document.createElement("img");a.src=n,a.alt="QR코드",s.appendChild(a)}}}class Xu extends Mi{_getShape(t,e){const s=e.shapeCallback;let i=e.shape;if(e.value&&s){let r;r=t.printing?this.getPrintValue(t,e):e.value,i=s(t.getUserData(),e,r)||i}return i}_getDrawing(t,e){let s;return t&&(t=t.toLowerCase(),_a.isEllipse(t)?(s=this._ellipse?this._ellipse:this._ellipse=new _a,this._ellipse.circled=t===_a.CIRCLE):ga.isLine(t)?(s=this._line?this._line:this._line=new ga,this._line.shape=t):(s=this._polygon?this._polygon:this._polygon=new pa(t),this._polygon.shape=t)),s.className=e,s}}class ju extends Xu{constructor(t,e){super(t,e,"shapeItemView"),this.$_render=(t,e,s,i)=>{const r=this._getShape(t,this.model);if(r){const t=this._getDrawing(r);if(t){const n=getComputedStyle(this._svg),o=parseFloat(n.strokeWidth)||0,a="star"!==r?1:0;this._isTesting()||t.drawAt(a,a,e,s-2*a,i-2*a,o)}}}}_doDispose(){super._doDispose()}prepareExport(){const t=this.dom;this._svg.setAttribute("viewBox",[0,0,t.offsetWidth,t.offsetHeight].join(" "))}_getCssSelector(){return"rr-shape rr-item-element"}get debugLabel(){return""}_initDom(t,e){super._initDom(t,e),this._svg=nh.createSVG(e,"rr-shape-shape",{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"})}_setStyles(t,e,s){super._setStyles(t,e,s),ya.STYLE_PROPS.forEach((t=>{t in e&&(this._svg.style[t]=e[t])}))}_doMeasure(t,e,s,i){const r=this.model;this._setModelSize(r,e,s,i),nh.renderSVG(null,t,this._svg,this.$_render);const n=e.offsetWidth,o=e.offsetHeight;return t.printing&&nh.prepareExport(this._svg,n,o),Me.create(n,o)}}class Yu extends Mi{constructor(t,e){super(t,e,"svgItemView"),Yu.SVG||(Yu.SVG=t.createElement("div"))}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-svg rr-item-element"}get debugLabel(){return""}_doMeasure(t,e,s,i){const r=this.model,n=e.style;let o=r.svg&&t.assets.getSvg(r.svg);if(t.printing&&!o&&(o=this.getPrintValue(t,r)),this._setModelSize(r,e,s,i),J.isIE){const t=Yu.SVG;t.innerHTML=o.substring(o.indexOf("<svg"));const s=t.lastChild;s instanceof SVGSVGElement?(s.setAttribute("viewbox","0 0 "+s.getAttribute("width")+" "+s.getAttribute("height")),s.setAttribute("width","100%"),s.setAttribute("height","100%"),e.innerHTML=t.innerHTML,delete e.dataset.empty):(e.dataset.empty="true",e.innerHTML="<span></span>")}else o?(e.innerHTML="",n.background="no-repeat center/contain url('"+o+"')",delete e.dataset.empty):(e.dataset.empty="true",e.innerHTML="<span></span>"),t.printing&&(e._svg_=o);return Me.create(e.offsetWidth,e.offsetHeight)}}class Ju extends A{constructor(t,e){super(),Ju.Highcharts||(Ju.Highcharts=window.Highcharts),Ju.Highcharts&&Ju.Highcharts.setOptions(Ju.hichart_options),this._container=t,this._model=e}_doDispose(){super._doDispose()}refreshChart(t,e,s){if(!Ju.Highcharts)return;const i=t.assets,r=this._model,n=r.theme?i.getHighchart(r.theme):null,o=n&&n.theme?J.deepClone(n.theme):{};o.chart={inverted:r.inverted,styledMode:!1,backgroundColor:null,plotBorderWidth:r.plotBorderWidth,plotBorderColor:r.plotBorderColor},o.plotOptions=o.plotOptions||{},o.plotOptions.series=o.plotOptions.series||{},Object.assign(o.plotOptions.series,{stacking:r.stacking}),o.credits={enabled:!1},o.title=r.title.getWrapper(),o.subtitle=r.subtitle.getWrapper(),this._buildConfig(t,r,o);const a=Ju.Highcharts.chart(this._container,o);this._doRefreshChart(a,r,o)}_buildConfig(t,e,s){this.$_buildXAxis(t,e.xAxis,s.xAxis=e.xAxis.getWrapper()),this.$_buildYAxis(t,e.yAxis,s.yAxis=e.yAxis.getWrapper()),this.$_buildLegend(e.legend,s.legend=e.legend.getWrapper());const i=s.series=[];for(let s=0;s<e.series.count;s++){const r=e.series.get(s),n={};n.id=r.id,n.data=r.getValues(t,t.dp),r.wrap(n),n.visible=r.visible&&(t.printing||r.designVisible),i.push(n)}}_doRefreshChart(t,e,s){}$_buildXAxis(t,e,s){s.categories=e.getCategories(t,t.dp)}$_buildYAxis(t,e,s){s.categories=e.getCategories(t,t.dp)}$_buildLegend(t,e){}}Ju.hichart_options={lang:{thousandsSep:","},plotOptions:{series:{animation:!1,enableMouseTracking:!1}}};class Zu extends Mi{constructor(t,e){super(t,e,"hichartItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-hichart rr-item-element"}get debugLabel(){return"Hichart"}_initDom(t,e){super._initDom(t,e);const s=this._chartDiv=t.createElement("div");s.className="rr-hichart-wrapper",e.appendChild(s)}_doMeasure(t,e,s,i){const r=this.model,n=e.style;return t.printing||(e.style.border="1px solid rgba(55, 55, 55, 0.1)"),this.$_prepareWrapper(r,this._chartDiv),this._setModelSize(r,e,s,i),n.overflow="hidden",new Me(e.offsetWidth,e.offsetHeight)}_doLayoutContent(t){this._wrapper&&(this._chartDiv.style.width=this.width+"px",this._chartDiv.style.height=this.height+"px",this._isTesting()||this.$_layoutWrapper(t,this._wrapper))}isDom(t){return this.containsDom(t)||super.isDom(t)}$_createWrapper(t,e){return new Ju(t,e)}$_prepareWrapper(t,e){this._wrapper||(this._wrapper=this.$_createWrapper(e,t))}$_layoutWrapper(t,e){e.refreshChart(t,this.width,this.height)}}class qu extends vl{constructor(t,e){super(t,e,"SummaryItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-summary rr-item-element"}get guardLabel(){return"summary"}get editable(){return!1}_getPrintText(t,e){this._error=null;try{const s=e.expression&&t.bandSummaryRuntime;let i=s?e.getSummary(s):this.getPrintValue(t,e);return this._getText(e,i)}catch(t){return this._error=t,console.error(t),"<<ERROR>>"}}_getDesignText(t,e){let s="";return t.expression?s="["+t.expression+"]":t.value&&(s=e?t.value:"["+t.value+"]"),s||"[summary]"}_doMeasure(t,e,s,i){const r=super._doMeasure(t,e,s,i);return e.dataset.error=this._error?"1":"0",this._error&&(e.title=this._error),r}}class tp extends Mi{constructor(t,e){super(t,e,"barItemView")}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-bar rr-item-element"}get debugLabel(){return""}_initDom(t,e){super._initDom(t,e),this._bar=t.createElement("span"),this._bar.className="rr-bar-bar",J.extend(this._bar.style,{position:"absolute",textAlign:"center",color:"gray"}),e.appendChild(this._bar)}_doMeasure(t,e,s,i){const r=this.model,n=100*((t.printing?this.getPrintValue(t,r,r.position):r.position)-r.minimum)/(r.maximum-r.minimum);return n<=0&&!t.printing?(J.extend(this._bar.style,{width:"100%",height:"",top:"50%",transform:"translateY(-50%)"}),this._bar.textContent="[ BAR ]",this._bar.dataset.design=""):(J.extend(this._bar.style,{width:n+"%",height:"100%",top:"",transform:""}),this._bar.textContent="",delete this._bar.dataset.design),t.printing&&(this._bar.dataset._m_=e.dataset._m_),Me.create(e.offsetWidth,e.offsetHeight)}_setStyles(t,e,s){super._setStyles(t,e,s),"barColor"in e&&(this._bar.style.backgroundColor=e.barColor)}isDom(t){return t===this._bar||super.isDom(t)}}class ep extends Xu{constructor(t,e){super(t,e,"ratingItemView"),this.$_render=(t,e,s,i)=>{const r=this.model,n=this._getShape(t,r);if(n){const o="star"!==n?1:0,a=this._getDrawing(n,ep.SVG_CLASS);if(a){const n=r.shapeCount,A=Math.min(s/n,i),l=t.printing?this.getPrintValue(t,r):r.designValue,h=J.toNumber(r.minimum,0),d=J.toNumber(r.maximum,n),c=Math.min(n,Math.round((l-h)*n/(d-h))),u=0,p=(s-A*n)/2,_=A-2*o,g=i-2*o;for(let t=0;t<c;t++){const s=p+t*A+o,i=u+o;a.drawAt(s,i,e,_,g)}for(let t=c;t<n;t++){const s=p+t*A+o,i=u+o,r=a.drawAt(s,i,e,_,g,0,ep.BACK_CLASS);let n;this._backFill?nh.setStyle(r,"fill",this._backFill):(n=getComputedStyle(r),n.fill&&nh.setStyle(r,"fill",n.fill)),this._backStroke?nh.setStyle(r,"stroke",this._backStroke):(n=n||getComputedStyle(r),n.stroke&&nh.setStyle(r,"stroke",n.stroke))}}}}}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-rating rr-item-element"}get debugLabel(){return""}_initDom(t,e){super._initDom(t,e);this._svg=nh.createSVG(e,"rr-rating-shape",{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"})}_doMeasure(t,e,s,i){this._setModelSize(this.model,e,s,i),nh.renderSVG(null,t,this._svg,this.$_render);const r=e.offsetWidth,n=e.offsetHeight;return t.printing&&nh.prepareExport(this._svg,r,n),Me.create(r,n)}_setStyles(t,e,s){super._setStyles(t,e,s),["fill","stroke"].forEach((t=>{t in e&&(this._svg.style[t]=e[t])})),this._backFill=e.backFill,this._backStroke=e.backStroke}}ep.SVG_CLASS="rr-rating-shape-svg",ep.BACK_CLASS="rr-rating-shape-back";class sp extends ki{constructor(t,e){super(t,e,"dataListBoxView"),this._gap=0}get debugLabel(){return"datalist"}_getCssSelector(){return"rr-datalist rr-group-element"}_needDesignBox(){return!0}_buildItems(t,e,s){if(t.printing){const t=e.model.data,i=t&&t.get(s.data),r=s.value;let n=i instanceof Qe?i.rowCount:i?1:0;isNaN(s.maxRows)||(n=Math.min(n,s.maxRows));const o=this.dom,a=this.doc;for(let t=0;t<n;t++){const e=a.createElement("span"),s=i instanceof Qe?i.getRowValue(t,r):i.getValue(r);Object.assign(e.style,{position:"absolute"}),e.textContent=s,o.appendChild(e)}}}_doMeasure(t,e,s,i){const r=this.model;this._paddings=t.reportView.getBoxPaddings(r),this.measureFixed||this._setModelSize(r,e,s,i,!0),super._doMeasure(t,e,s,i);const n=this.dom.children;let o=0,a=0,A=0;for(let t=0;t<n.length;t++){const e=n[t];e instanceof HTMLSpanElement&&(a+=e.offsetHeight,o=Math.max(o,e.offsetWidth),A++)}return a+=(A-1)*J.toNumber(this.model.rowGap,0),new Me(o,a)}_doAfterMeasure(t,e,s,i,r){r.height>0||t.printing||!(this.model.designHeight>0)||(r.height=this.model.designHeight),r.width>0||t.printing||!(this.model.designWidth>0)||(r.width=this.model.designWidth),this._applyPaddings(e,r),super._doAfterMeasure(t,e,s,i,r),e.style.padding="0"}_doLayoutContent(t){const e=this.model,s=this.dom.children,i=J.toNumber(e.rowGap,0),r=this.width,n=this.height,o=e.itemAlign,a=e.rowAlign,A=this._paddings;let l,h=0,d=A.top;switch(a){case c.RIGHT:l=r-A.right;break;case c.CENTER:l=(r-A.left-A.right)/2;break;default:l=A.left}if("middle"===o||"bottom"===o){let t=0;for(let e=0;e<s.length;e++){const i=s[e];i instanceof HTMLSpanElement&&(h+=i.offsetHeight,t++)}0!==t&&(h+=(t-1)*i),d="bottom"===o?Math.max(d,n-A.bottom-h):Math.max(d,(n-A.top-A.bottom-h)/2)}for(let t=0;t<s.length;t++){const e=s[t];if(e instanceof HTMLSpanElement){switch(e.style.top=d+"px",a){case c.RIGHT:e.style.left=l-e.offsetWidth+"px";break;case c.CENTER:e.style.left=l-e.offsetWidth/2+"px";break;default:e.style.left=l+"px"}d+=e.offsetHeight+i}}}}class ip extends Mi{constructor(t,e,s){super(t,e,s)}_doDispose(){super._doDispose()}_getCssSelector(){return ip.CLASS_LIST}get guardLabel(){return"page"}get debugLabel(){return"page"}_initDom(t,e){super._initDom(t,e);const s=this._span=t.createElement("span");s.className=ip.SPAN,s.style.display="table-cell",s.style.verticalAlign="middle",e.appendChild(s)}_doPrepareMeasure(t,e){super._doPrepareMeasure(t,e),t.printing&&(this._span.style.display="none")}_doMeasure(t,e,s,i){const r=this.model,n=this._span;this._setModelSize(r,e,s,i),n.textContent=r.pageName||"PAGE";let o=s,a=this._modelHeight;return isNaN(a)&&(a=Math.round(n.offsetHeight)),new Me(o,a)}_doLayoutContent(t){}isDom(t){return t===this._span||super.isDom(t)}}function rp(t,e,s){var i=[],r=0,n=0,o=function(t,e){i[e]=i[e]||[],i[e][t]=1},a=function(t){for(var e=[],s=t.length,i=0;i<s;i++){var r=t.charCodeAt(i),n=i+1<s?t.charCodeAt(i+1):0;r>47&&r<58&&n>47&&n<58?(e.push(10*(r-48)+n+82),i++):r>127?(e.push(235),e.push(r-127&255)):e.push(r+1)}return e},A=function(t,e){var s,i,r=0,n=0,o=t.length,A=[e[0]],l=function(t){n=40*n+t,2==r++&&(A.push(++n>>8),A.push(255&n),r=n=0)};for(s=0;s<o&&(0!=r||s!=o-1);s++){var h=t.charCodeAt(s);for(h>127&&238!=A[0]&&(l(1),l(30),h-=128),i=1;h>e[i];i+=3);var d=e[i+1];if(8==d||9==d&&0==r&&s==o-1)return[];if(d<5&&2==r&&s==o-1)break;d<5&&l(d),l(h-e[i+2])}return 2==r&&238!==A[0]&&l(0),A.push(254),(r>0||s<o)&&(A=A.concat(a(t.substr(s-r)))),A},l=function(t,e){t=unescape(encodeURI(t));var s=a(t),i=s.length,l=A(t,[230,31,0,0,32,9,29,47,1,33,57,9,44,64,1,43,90,9,51,95,1,69,127,2,96,255,1,0]),h=l.length;h>0&&h<i&&(s=l,i=h),(h=(l=A(t,[239,31,0,0,32,9,29,47,1,33,57,9,44,64,1,43,90,2,64,95,1,69,122,9,83,127,2,96,255,1,0])).length)>0&&h<i&&(s=l,i=h),(h=(l=A(t,[238,12,8,0,13,9,13,31,8,0,32,9,29,41,8,0,42,9,41,47,8,0,57,9,44,64,8,0,90,9,51,255,8,0])).length)>0&&h<i&&(s=l,i=h),l=function(t){for(var e,s=t.length,i=s+1&-4,r=0,n=i>0?[240]:[],o=0;o<i;o++){if(o<i-1){if((e=t.charCodeAt(o))<32||e>94)return[]}else e=31;r=64*r+(63&e),3==(3&o)&&(n.push(r>>16),n.push(r>>8&255),n.push(255&r),r=0)}return i>s?n:n.concat(a(t.substr(0==i?0:i-1)))}(t),(h=l.length)>0&&h<i&&(s=l,i=h),l=function(t){var e=[231],s=t.length;250<s&&e.push(37+(s/250|0)&255),e.push(s%250+149*(e.length+1)%255+1&255);for(var i=0;i<s;i++)e.push(t.charCodeAt(i)+149*(e.length+1)%255+1&255);return e}(t),(h=l.length)>0&&h<i&&(s=l,i=h);var d,c,u,p,_,g,f,m,w=1,y=1,C=-1,b=1,v=new Array(70),B=new Array(70),E=new Array(256),P=new Array(255);if(e&&i<50){l=[16,7,28,11,24,14,32,18,32,24,44,28];do{h=(c=l[++C])*(d=6+(12&C))/8}while(h-l[++C]<i);c>25&&(w=2)}else{c=d=6,_=2,l=[5,7,10,12,14,18,20,24,28,36,42,48,56,68,84,112,144,192,224,272,336,408,496,620];do{if(++C==l.length)return[0,0];c>11*_&&(_=4+_&12),h=(c=d+=_)*d>>3}while(h-l[C]<i);c>27&&(y=w=2*(c/54|0)+2),h>255&&(b=2*(h>>9)+2)}for(u=c/w,p=d/y,i<h-(m=l[C])&&(s[i++]=129);i<h-m;)s[i++]=(149*i%253+130)%254;for(m/=b,C=1,_=0;_<255;_++)P[_]=C,E[C]=_,(C+=C)>255&&(C^=301);for(v[m]=0,_=1;_<=m;_++)for(v[C=m-_]=1;C<m;C++)v[C]=v[C+1]^P[(E[v[C]]+_)%255];for(g=0;g<b;g++){for(_=0;_<=m;_++)B[_]=0;for(_=g;_<i;_+=b)for(C=0,x=B[0]^s[_];C<m;C++)B[C]=B[C+1]^(x?P[(E[v[C]]+E[x])%255]:0);for(_=0;_<m;_++)s[i+g+_*b]=B[_]}for(_=0;_<d+2*y;_+=p+2)for(C=0;C<c+2*w;C++)o(C,_+p+1),0==(1&C)&&o(C,_);for(_=0;_<c+2*w;_+=u+2)for(C=0;C<d;C++)o(_,C+2*(C/p|0)+1),1==(1&C)&&o(_+u+1,C+2*(C/p|0));for(m=2,g=0,f=4,b=[0,0,-1,0,-2,0,0,-1,-1,-1,-2,-1,-1,-2,-2,-2],_=0;_<h;f-=m,g+=m){if(f==d-3&&-1==g)l=[c,6-d,c,5-d,c,4-d,c,3-d,c-1,3-d,3,2,2,2,1,2];else if(f==d+1&&1==g&&0==(7&c)&&6==(7&d))l=[c-2,-d,c-3,-d,c-4,-d,c-2,-1-d,c-3,-1-d,c-4,-1-d,c-2,-2,-1,-2];else{if(0==f&&g==c-2&&3&c)continue;if(f<0||g>=c||f>=d||g<0)for(f+=2+(m=-m)/2,g+=2-m/2;f<0||g>=c||f>=d||g<0;)f-=m,g+=m;if(f==d-2&&0==g&&3&c)l=[c-1,3-d,c-1,2-d,c-2,2-d,c-3,2-d,c-4,2-d,0,1,0,0,0,-1];else if(f==d-2&&0==g&&4==(7&c))l=[c-1,5-d,c-1,4-d,c-1,3-d,c-1,2-d,c-2,2-d,0,1,0,0,0,-1];else{if(1==f&&g==c-1&&0==(7&c)&&6==(7&d))continue;l=b}}for(i=s[_++],C=0;i>0;C+=2,i>>=1)if(1&i){var x=g+l[C],S=f+l[C+1];x<0&&(x+=c,S+=4-(c+4&7)),S<0&&(S+=d,x+=4-(d+4&7)),o(x+2*(x/u|0)+1,S+2*(S/p|0)+1)}}for(_=c;3&_;_--)o(_,_);r=c+2*w,n=d+2*y};return function(){function o(e,s){for(var i in e=e instanceof SVGSVGElement?e:t.createElementNS(g,e),s||{})e.setAttribute(i,s[i]);return e}var a,A,h,d,c,u,p,_=Math.abs,g="http://www.w3.org/2000/svg",f="",m="string"==typeof s?{msg:s}:s||{},w=m.pal||["#000"],y=_(m.dim)||256,C=[1,0,0,1,p=(p=_(m.pad))>-1?p:2,p],b=w[0]||"#000",v=w[1]||"transparent",B=m.vrb?0:1;for(l(m.msg||"",m.rct),c=r+2*p,u=n+2*p,h=n;h--;)for(d=0,A=r;A--;)i[h][A]&&(B?(d++,i[h][A-1]||(f+="M"+A+","+h+"h"+d+"v1h-"+d+"v-1z",d=0)):f+="M"+A+","+h+"h1v1h-1v-1z");return a=o(e,{viewBox:[0,0,c,u].join(" "),width:y/u*c|0,height:y,fill:b,"shape-rendering":"crispEdges",xmlns:g,version:"1.1"}),v&&a.appendChild(o("path",{fill:v,d:"M0,0v"+u+"h"+c+"V0H0Z"})),a.appendChild(o("path",{transform:"matrix("+C+")",d:f})),a}()}ip.CLASS_NAME="rr-pageitem",ip.CLASS_LIST=ip.CLASS_NAME+" rr-item-element",ip.SPAN="_rr_span_";class np extends Mi{constructor(t,e){super(t,e,"dataMatrixItemView")}_doDispose(){super._doDispose(),this._svg=null}_getCssSelector(){return"rr-datamatrix rr-item-element"}get guardLabel(){return"dataMatrix"}get debugLabel(){return"dataMatrix"}_initDom(t,e){super._initDom(t,e),Object.assign(e.style,{display:"flex",justifyContent:"center",alignItems:"center"})}_doMeasure(t,e,s,i){const r=this.model;return this._setModelSize(r,e,s,i),this._isTesting()||(this._svg||(this._svg=e.ownerDocument.createElementNS(sh,"svg"),e.appendChild(this._svg)),this._svg.dataset._m_=r.shash,this.$_render(t,r,e)),Me.create(e.offsetWidth,e.offsetHeight)}isDom(t){return this.dom.contains(t)||super.isDom(t)}$_getText(t,e){let s="";return e.value?(s=t.printing?this.getPrintValue(t,e):e.value,s=J.toStr(s)):e.text&&(s=e.text),s}$_render(t,e,s){const i=this._modelWidth||0,r=this._modelHeight||0,n=Va.MIN_SIZE;if(i<n||r<n)return;const o={msg:this.$_getText(t,e),dim:Math.min(i,r),pad:J.pickNum(this.model.pad,2)};s.style.color&&(o.pal=[s.style.color]),rp(s.ownerDocument,this._svg,o)}}class op extends Mi{constructor(t,e){super(t,e,"HtmlItemView")}_doDispose(){super._doDispose()}get debugLabel(){return"html"}_getCssSelector(){return"rr-html rr-item-element"}_initDom(t,e){super._initDom(t,e),this._content=t.createElement("div"),Object.assign(this._content.style,{pointerEvents:"none",display:"inline-block"}),e.appendChild(this._content)}_doMeasure(t,e,s,i){const r=this.model;let n=r.getHtml(t);if(e.style.width="",e.style.height="",this._setModelSize(r,e,s,i),isNaN(this._modelWidth)&&(e.style.width="100000px"),this._content.innerHTML=n,t.printing)this._setBindMarker(!1);else{r.value?this._setBindMarker(!0,!1):this._setBindMarker(!1)}let o=this._content.offsetWidth+1,a=this._content.offsetHeight;return isNaN(this._modelWidth)&&(e.style.width=""),new Me(o,a)}}class ap extends tt{constructor(t){super(t,"emptyView"),this._error=""}get error(){return this._error}set error(t){this._error=t}layoutContent(t){const e=this._errorView,s=t.loadError;if(this.error=s){e.style.visibility="",e.textContent=s;const t=Math.round((this.height-e.offsetHeight)/2);e.style.top=t+"px",e.style.width=this.width+"px"}else e.style.visibility="hidden"}_getCssSelector(){return"rr-empty"}_initDom(t,e){super._initDom(t,e);const s=t.createElement("span"),i=s.style;i.position="absolute",i.left="20px",i.top="20px",s.className="rr-empty-view rr-empty-message",s.textContent="Report model is not set.",e.appendChild(s);const r=t.createElement("span"),n=r.style;n.position="absolute",n.left="20px",n.bottom="10px",r.className="rr-empty-view rr-empty-bottom",r.textContent="RealReport v1.0",e.appendChild(r);const o=this._errorView=t.createElement("span");o.style.position="absolute",o.className="rr-empty-view rr-empty-error",e.appendChild(o)}}class Ap extends tt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t,"reportView"),this._loadError="",this._nameMap={},this._modelDirty=!1,this._editable=e,this.addChild(this._activePage=this._pageView=new ml(t)),s||this.addChild(this._emptyView=this._createEmptyView(t))}_doDispose(){super._doDispose()}addImage(t){this._images[t]=1}imageLoaded(t){delete this._images[t]}imagesAllLoaded(){return J.isEmpty(this._images)}get editable(){return this._editable}get model(){return this._model}set model(t){t!==this._model&&(this._model&&this._model.removeListener(this),this._model=t,this._pageView.$_setModel(t&&t.page),this._nameMap={},this._model&&this._model.addListener(this),this._modelDirty=!0,this.invalidateLayout())}get pageView(){return this._pageView}get loadError(){return this._loadError}set loadError(t){this._loadError=t}get zoom(){return 100}getBoxPaddings(t){const e=this._boxMeasurer.style,s=t.styles;if(e.padding="0",e.paddingLeft="0",e.paddingTop="0",s)for(let t in s)"p"==t.charAt(0)&&"a"==t.charAt(1)&&(e[t]=s[t]);e.margin="0",e.border="none";const i=this._boxMeasurer.offsetWidth,r=this._boxMeasurer.offsetHeight,n=this._boxInner.offsetLeft-this._boxMeasurer.offsetLeft,o=this._boxInner.offsetTop-this._boxMeasurer.offsetTop;return{left:n,top:o,right:i-n-1,bottom:r-o-1}}findElement(t){let e=this._nameMap[t];return e||(e=this._activePage.findElement(t),e&&(this._nameMap[t]=e),e)}findElementOf(t){return this._activePage.findElementOf(t)}getElementOf(t){return this._activePage.getElementOf(t)}getItemBoundingRect(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=e?J.cloneDom(t.dom,e&&t.parent instanceof Il):t.dom,i=J.getBoundingClientRect2(s),r=J.getBoundingClientRect2(this._activePage.dom),n=t.offsetSize,o=100/this.zoom;return e&&s.remove(),new d((i.left-r.left)*o-2,(i.top-r.top)*o-2,n.width,n.height)}_getCssSelector(){return"rr-report-view"}_initDom(t,e){super._initDom(t,e),this._boxMeasurer=t.createElement("div"),this._boxMeasurer.className="box-measurer";let s=this._boxMeasurer.style;s.display="inline-block",s.position="abolute",s.left="0",s.top="0",s.visibility="hidden",s.pointerEvents="none",this._boxInner=t.createElement("div"),this._boxInner.className="box-measurer-inner",s=this._boxInner.style,s.width="1px",s.height="1px",this._boxMeasurer.appendChild(this._boxInner),e.appendChild(this._boxMeasurer)}_createEmptyView(t){return new ap(t)}_layoutPageBorders(t,e){}$_layout(t,e){let s=e.clone();const i=this._model&&this._model.paper;if(!i)return Me.create(s.x,s.y);const r=this._activePage,n=this._emptyView;t.reportView=this,r.visible=!!this._model,this._emptyView.visible=!r.visible;try{if(this._activePage.visible){this._nameMap={},this._model.prepareLayout(),s=i.getContentRect(s.move(0,0));const n=r.measure(t,s.clone());r.layout(t,s.clone()),r.setRect(s),this._layoutPageBorders(e,s);const o=Me.create(e.width,e.height);return n.height>s.height&&(o.height+=n.height-s.height),n.width>s.width&&(o.width+=n.width-s.width),o}return n.setRect(s),n.layoutContent&&n.layoutContent(this),Me.create(s.x,s.y)}finally{this._modelDirty=!1,this._afterLayout(t)}}_afterLayout(t){}$_afterRender(t){const e=this._activePage;t&&t.reportView&&e.visible&&(e.layoutFloating(t),e.afterRender(t))}$_createElement(t){return Ap.ViewCreators[t.constructor.$_ctor](this.doc,t)}$_preparePrint(t){const e=this._model&&this._model.paper;this._nameMap={},this._model.preparePrint(t),this._model.prepareLayout();const s=e.getClientRect();this._activePage.setRect(s),this.setPrintStyles(),this._images={}}$_endPrint(t){J.detach(this._boxMeasurer)}_modelChanged(){this._modelDirty=!0}onReportReset(t){this._modelChanged(),this.invalidateLayout()}onReportPaperChanged(t){this._modelChanged(),this.invalidateLayout()}onReportItemAdded(t,e,s,i){this._modelChanged(),this.invalidateLayout()}onReportItemRemoved(t,e,s){this._modelChanged(),this.invalidateLayout()}onReportItemsRemoved(t,e){this._modelChanged(),this.invalidateLayout()}onReportItemChanged(t,e,s,i,r){this._modelChanged(),this.invalidateLayout()}onReportCommandStackChanged(t,e){}}Ap.PAGE_HEAD="rr-page-head",Ap.BACK_HEAD="rr-back-head",Ap.FRONT_HEAD="rr-front-head",Ap.ViewCreators={TextItem:(t,e)=>new Bl(t,e),SummaryItem:(t,e)=>new qu(t,e),ImageItem:(t,e)=>new El(t,e),CheckItem:(t,e)=>new Pl(t,e),SimpleBand:(t,e)=>new Ql(t,e),SimpleBandRowGroupHeader:(t,e)=>new Dl(t,e),SimpleBandRowGroupFooter:(t,e)=>new Ll(t,e),TableBand:(t,e)=>new th(t,e),TableBandRowGroupHeader:(t,e)=>new Xl(t,e),TableBandRowGroupFooter:(t,e)=>new jl(t,e),BandGroup:(t,e)=>new tl(t,e),BandCell:(t,e)=>new ZA(t,e),CrosstabBand:(t,e)=>new pl(t,e),RowBoxContainer:(t,e)=>new XA(t,e),ColumnBoxContainer:(t,e)=>new jA(t,e),DiagonalBoxContainer:(t,e)=>new YA(t,e),ListContainer:(t,e)=>new Sl(t,e),TableContainer:(t,e)=>new Rl(t,e),DataListContainer:(t,e)=>new sp(t,e),SpaceItem:(t,e)=>new zA(t,e),FloatingContainer:(t,e)=>new eh(t,e),StackContainer:(t,e)=>new MA(t,e),ShapeItem:(t,e)=>new ju(t,e),BarItem:(t,e)=>new tp(t,e),RatingItem:(t,e)=>new ep(t,e),BarcodeItem:(t,e)=>new Ku(t,e),QrcodeItem:(t,e)=>new $u(t,e),DataMatrixItem:(t,e)=>new np(t,e),SvgItem:(t,e)=>new Yu(t,e),HtmlItem:(t,e)=>new op(t,e),HichartItem:(t,e)=>new Zu(t,e),PageItem:(t,e)=>new ip(t,e)};class lp extends q{_initDom(t,e){super._initDom(t,e),e.className="rr-print-error",J.extend(e.style,{display:"flex",alignItems:"center",top:"0px",width:"90%",height:"90%",background:"rgb(238, 238, 238, 0.95)",border:"2px dashed red",paddingTop:"8px",paddingLeft:"12px",zIndex:10}),e.appendChild(this._title=t.createElement("div")),J.extend(this._title.style,{color:"#333",fontWeight:"bold",fontSize:"1.3em",marginBottom:"8px",textDecoration:"underline"}),this._title.innerHTML="Print Error",e.appendChild(this._span=t.createElement("div")),J.extend(this._span.style,{color:"#333"}),this.visible=!1}setError(t){this._span.innerHTML=t}}class hp extends yt{constructor(t){super(t),this._pageGap=20,this._zoom=1,this._align=c.CENTER,this._styles={},this.traceMode=!1,this._preview=!1,this._errorView=new lp(this.doc),this._containerDiv.appendChild(this._errorView.dom)}_doDispose(){super._doDispose()}get pageCount(){return this._pages.length}get page(){const t=this._pages,e=this.scrollTop;for(let s=0;s<t.length;s++){const i=t[s].page.offsetTop,r=i+t[s].page.offsetHeight;if(i>=e&&i<e+this.scrollHeight||r>=e&&r<e+this.scrollHeight)return s}return t.length}set page(t){t=Math.max(0,Math.min(this._pages.length-1,t));this._pages[t].page.scrollIntoView({behavior:"smooth"})}get zoom(){return this._zoom}set zoom(t){var e;(t=Math.max(.1,J.toNumber(t)))!==this._zoom&&(this._zoom=t,this.$_resetPreviewer(),null===(e=this.onZoomed)||void 0===e||e.call(this,this._zoom))}get pages(){var t;return null===(t=this._pages)||void 0===t?void 0:t.slice(0)}print(t){J.isObject(t)&&(t=this._options=Object.assign({},{id:"",async:!1,pageMark:!0,noScroll:!1},t),this._pages=[],J.isArray(t.report)?this.printAll(t):t.report instanceof HA&&this.printSingle(t))}printSingle(t){if(!(t&&t.report instanceof HA))return;const e=t.report,s=t.data,i=t.async,r=t.preview,n=t.id,o=t.callback,a=t.endCallback;try{this._previewId=t.id,(this._preview=t.preview)&&(this._indicator=this.$_createIndicator(this.doc),this._containerDiv.appendChild(this._indicator)),this._reportView&&this.removeElement(this._reportView),this.addElement(this._reportView=new Ap(this.doc,!1,!0));const i=this._context=new $i(!0),r=this._reportView,n=t.report.info.paper.getClientRect();e._data=s,r.model=e,i.dp=s,i.designDp=e.designData,i.assets=e.assets,i.reportView=r,i.pageWidth=n.width,i.pageHeight=n.height,i.firstReport=i,i.preparePrint()}catch(t){const e=this.$_getPreviewer(n);return e&&(e.style.display="none"),J.remove(this._indicator),void this.$_showError(null,t)}r?this._isTesting?this.$_printSingle2(this.doc,this._context,!0,n,i,o,a):setTimeout((()=>{this.$_printSingle2(this.doc,this._context,!0,n,i,o,a)}),0):this.$_printSingle2(this.doc,this._context,!1,n,i,o,a)}$_printSingle2(t,e,s,i,r,n,o){r?this.$_printAsync(this.doc,this._context,s,i,!0,n,o):this.$_printAsync(this.doc,this._context,s,i,!1)}printAll(t){if(!t||!Array.isArray(t.report)||0===t.report.length)return;const e=t.report,s=t.data,i=t.id,r=t.preview,n=t.async,o=t.callback,a=t.endCallback,A=e.length;for(let t=0;t<A;t++)e[t]instanceof HA?e[t]={report:e[t],data:s}:e[t]._data=e[t].data||s;if(1===A){const s=e[0];return this.printSingle({report:s.report,data:s.data,preview:r,id:i,async:n}),void this.printSingle(t)}try{this._previewId=i,(this._preview=r)&&(this._indicator=this.$_createIndicator(this.doc),this._containerDiv.appendChild(this._indicator)),this._reportViews&&this._reportViews.forEach((t=>this.removeElement(t))),this._reportViews=[],this._contexts=[];for(let t=0;t<A;t++){const t=new $i(!0,!0),e=new Ap(this.doc,!1,!0);this._contexts.push(t),this.addElement(e),this._reportViews.push(e),t.reportView=e}e.forEach(((t,e)=>{const s=t.report,i=t.data,r=this._contexts[e],n=this._reportViews[e],o=s.info.paper.getClientRect();s._data=i,n.model=s,r.dp=i,r.designDp=s.designData,r.assets=s.assets,r.reportView=n,r.pageWidth=o.width,r.pageHeight=o.height,r.preparePrint()}))}catch(t){const e=this.$_getPreviewer(i);return e&&(e.style.display="none"),J.remove(this._indicator),void this.$_showError(null,t)}r?this._isTesting?this.$_printAll2(this.doc,this._contexts,!0,i,n,o,a):setTimeout((()=>{this.$_printAll2(this.doc,this._contexts,!0,i,n,o,a)}),0):this.$_printAll2(this.doc,this._contexts,!1,i,n,o,a)}$_printAll2(t,e,s,i,r,n,o){r?this.$_print2Async(t,e,s,i,!0,n,o):this.$_print2Async(t,e,s,i,!1,n,o)}isAllRendered(){return!!this.$_getContainer().getElementsByClassName(hp.CONFIRM_CLASS)}getPrintHtml(){const t=this.$_getPreviewer(this._previewId),e=t?parseFloat(t.style.left):0,s=this.zoom;try{return this.zoom=1,t&&(t.style.left="0px"),this.$_getContainer().innerHTML}finally{this.zoom=s,t&&(t.style.left=e+"px")}}setStyles(t){this._styles=t,this.$_resetPreviewer()}fitToWidth(){const t=this.$_getContainer().offsetWidth,e=this.$_getPreviewer(this._previewId).offsetWidth;this.zoom=t/e}fitToHeight(){const t=this._pages.length,e=this.$_getContainer().offsetHeight,s=(this.$_getPreviewer(this._previewId).offsetHeight-this._pageGap*(t-1))/t;this.zoom=e/s}fitToPage(){const t=this._pages.length,e=this.$_getContainer().offsetWidth,s=this.$_getPreviewer(this._previewId).offsetWidth,i=this.$_getContainer().offsetHeight,r=(this.$_getPreviewer(this._previewId).offsetHeight-this._pageGap*(t-1))/t;this.zoom=Math.min(e/s,i/r)}get printing(){return!0}_doPrepareContainer(t){super._doPrepareContainer(t),t.dataset.print="1",t.classList.add("rr-report-root"),t.classList.add(hp.CLASS_NAME)}_render(t){}_doResized(){if(this._preview){const t=this.$_getPreviewer(this._previewId);t&&t.parentElement&&this.$_resetPreviewer()}}$_showError(t,e){if(this._errorView.visible=!0,this._errorView.setError('<span class="rr-print-error-title">'+(e.message||e)+"</span><br/><br/>"+J.getErrorStack(e)),J.detach(t),this.traceMode)throw e}$_createIndicator(t){const e=this._containerDiv.getBoundingClientRect(),s=this.doc.createElement("div");return s.className="rr-print-indicator",J.extend(s.style,{position:"fixed",width:e.width+"px",height:e.height+"px",top:"0px",zIndex:1e3,pointerEvents:"none"}),s}$_refreshContextValues(t){let e=t.pages.length;if(t.pages.forEach(((s,i)=>{let r=s.pageFooter.querySelectorAll('[data-rr_ctx_val="${pages}"]');r.forEach((t=>t.textContent="".concat(e))),r=s.pageHeader.querySelectorAll('[data-rr_ctx_val="${pages}"]'),r.forEach((t=>t.textContent="".concat(e))),r=s.pageFooter.querySelectorAll("[data-rr_ctx_call]"),r.forEach((e=>{const s=t.contextElements[e.dataset.rr_ctx_view];t._page=+e.dataset.rr_ctx_call,s._span=e,s.refreshPrintValues(t)}))})),t.reportIndex===t.reportCount-1){let s=t.firstReport;for(e+=t.prevPages;s;)s.pages.forEach(((s,i)=>{let r=s.pageFooter.querySelectorAll('[data-rr_ctx_val="${all-pages}"]');r.forEach((t=>t.textContent="".concat(e))),r=s.pageHeader.querySelectorAll('[data-rr_ctx_val="${all-pages}"]'),r.forEach((t=>t.textContent="".concat(e))),r=s.pageFooter.querySelectorAll("[data-rr_ctx_all_call]"),r.forEach((e=>{const s=t.contextElements[e.dataset.rr_ctx_view];s&&(t._page=+e.dataset.rr_ctx_call,t._compositePage=+e.dataset.rr_ctx_all_call,s._span=e,s.refreshPrintValues(t))}))})),s=s.nextReport}}$_printAsync(t,e,s,i,r,n,o){function a(t,s){const i=e.floatings;if(i.length>0){const e=[];for(let t of i){const i=t.$_anc;for(let r of s){const s=r.page;if(s.contains(i)){e.push(s),r.contents.push(t);break}}}t.$_layoutFloatings(e,i)}}function A(a){if(e.reportIndex===e.reportCount-1){if(e.setCompositePageCount(e.prevPages+e.pages.length),e.async&&l.pageMark){const t=a._containerDiv.getElementsByClassName("rr-report-page-marker")[0];t&&(t.textContent=t.textContent+"(s) printed.",t.animate([{opacity:"1"},{opacity:"0"}],{duration:2e3}),setTimeout((()=>{a._containerDiv&&a._containerDiv.removeChild(t)})))}c.$_endPrint(e),J.remove(a._indicator),J.detach(a._containerDom),console.log("Printed in "+(+new Date-d)+"ms.")}else s&&a.$_addPageSpace(t,e.container),e.nextReport.prevPages=e.prevPages+e.pages.length,a.$_printAsync(t,e.nextReport,s,i,r,n,o)}const l=this._options,h=t.getElementById(hp.PREVIEW_CLASS+i);let d;0===e.reportIndex&&(d=+new Date,h&&(J.detach(h),this._containerDiv.appendChild(this._containerDom)),this._errorView.visible=!1);const c=e.reportView,u=c.pageView;e.async=r,e.preview=s,e.designDp&&e.designDp.preparePrint(e),e.dp&&e.dp.preparePrint(e),e.floatings=[],e.contextElements={},c.$_preparePrint(e);const p=u.prepareAsync(t,e);try{const r=function(r){let n,o;if(0===e.reportIndex){r._containerDom.style.opacity="0",n=t.createElement("div"),n.className="rr-print-back",n.style.position="absolute",n.style.width="100%",n.style.height="100%",r._containerDiv.appendChild(n);const a=t.createElement("div");s&&(a.id=hp.PREVIEW_CLASS+i),a.className="rr-report-root"+(s?" "+hp.PREVIEW_CLASS:""),a.style.setProperty("position","absolute","important"),a.style.setProperty("transform-origin","top left","important"),n.appendChild(a),e.container=a,l.pageMark&&(o=t.createElement("span"),o.className="rr-report-page-marker",Object.assign(o.style,{position:"fixed",fontFamily:"Arial Bold",fontSize:"100px",color:"#0000ff80",top:"calc(50% - .5em)",width:"100%",textAlign:"center"}),r._containerDiv.appendChild(o))}else n=r._containerDiv.getElementsByClassName("rr-print-back")[0],e.container=n.getElementsByClassName("rr-report-root")[0],l.pageMark&&(o=r._containerDiv.getElementsByClassName("rr-report-page-marker")[0]);return o}(this),h=[];if(e.async)this.$_buildOutputAsync(t,s,e,h,p,0,0,((t,e,s)=>{r&&(r.textContent=t.prevPages+s+1+"Page"),0===s&&this.$_resetPreviewer(),n&&n(t,e,s)}),((t,e)=>{a(this,e),A(this),this._pages=this._pages.concat(e),o&&o(t,this._pages)}));else{let i=0,r=0;if(p.length>0)for(;r<p.length;)r=this.$_buildOutputAsync(t,s,e,h,p,r,i,null,null),0==i++&&this.$_resetPreviewer();else this.$_buildOutputAsync(t,s,e,h,p,0,0,null,null),this.$_resetPreviewer();this.$_refreshContextValues(e),a(this,h),A(this),this._pages=h.concat(this._pages)}}catch(t){return J.remove(this._indicator),this.$_showError(h,t),void console.error(t)}}$_print2Async(t,e,s,i,r,n,o){const a=e.length;for(let t=0;t<a;t++){const s=e[t];s.reportCount=a,s.reportIndex=t,s.firstReport=e[0],s.nextReport=e[t+1]}this.$_printAsync(t,e[0],s,i,r)}$_getContainer(){return this._containerDiv}$_getPreviewer(t){return this.doc.getElementById(hp.PREVIEW_CLASS+(t||this._previewId))}$_resetPreviewer(){if(this._preview){const t=this.$_getPreviewer(this._previewId),e=this.$_getContainer().getBoundingClientRect(),s=this._zoom;J.extend(t.style,this._styles),t.style.transform=1==s?"":"scale("+s+")";const i=t.getBoundingClientRect().width||e.width;let r=0;switch(this._align){case c.LEFT:break;case c.RIGHT:r=e.width-i;break;case c.CENTER:default:r=Math.round((e.width-i)/2)}t.style.left=Math.max(0,r)+"px"}}$_addPageSpace(t,e){const s=t.createElement("div");s.className="rr-print-space",s.style.height=this._pageGap+"px",e.appendChild(s)}$_buildOutputAsync(t,e,s,i,r,n,o,a,A){const l=s.reportView.pageView,h=s.report,d=h.page.pageHeader,c=h.page.pageFooter,u=h.page.reportFooter,p=h.info.paper,_=p.getClientRect().height,g=new wl,f=g.contents,m=t.createElement("div"),w=t.createElement("div"),y=s.floatings,C=s.reportView.pageView.bodyView.itemsView.gap,b=n;let v;s.preparePage(o,s.prevPages+o);for(let t of s.contextValues)t.refreshPrintValues(s);g.page=m,m.className="rr-print-div2",w.className="rr-print-div3",s.preview&&(m.className="rr-print-page rr-page-break page"+o,m.dataset.page=o+"",p.applyPreviewExtents(m.style),p.applyPreviewClient(w.style)),w.style.position="absolute",m.appendChild(w),s.container.appendChild(m),g.background=v=l.backFloatingView.cloneNode(),w.appendChild(v);let B=0+J.toNumber(d.spaceTop);v=l.pageHeaderView.cloneNode(),v.style.top=B+"px",B+=v.$_h=l.pageHeaderView.$_h,g.pageHeader=v,w.appendChild(v),v=l.pageFooterView.cloneNode(),v.$_h=l.pageFooterView.$_h,g.pageFooter=v;const E=_-v.$_h-J.toNumber(c.spaceBottom);for(v.style.top=E+"px",w.appendChild(v),s.h=s.bodyHeight,0==o&&(v=l.reportHeaderView.cloneNode(),v.$_h=l.reportHeaderView.$_h,v.style.top=B+"px",f.push(v),w.appendChild(v),s.h-=v.$_h,B+=v.$_h);n<r.length&&s.h>0;){const e=r[n];if(e instanceof Xi){n++;break}if(e instanceof HTMLDivElement){if(e.$_anc)y.push(e);else{let t=e.$_h;if(t>s.h&&e.classList.contains("rr-space")&&(t=s.h),s.h-t<0&&n>b)break;f.push(e),e.style.top=B+"px",w.appendChild(e),B+=t+C,s.h-=t+C}n++}else if(e instanceof ji){const i=e.getNextPage(t,s,s.pageWidth,w);if(i){f.push(i),i.style.top=B+"px";const t=i.$_h;if(B+=t,s.h-=t,s.h<=0){e.isEnded()&&n++;break}B+=C,s.h-=C}e.isEnded()&&n++}else n++}if(n==r.length&&l.reportFooterView.visible){v=l.reportFooterView.cloneNode();const t=v.$_h=l.reportFooterView.$_h;if(t>0){let e;e=u.alignToBottom?E-t:B,v.style.top=e+"px",s.h-=t,w.appendChild(v)}}if(g.foreground=v=l.frontFloatingView.cloneNode(),w.appendChild(v),a&&a(s,g,o),i.push(g),s.pages.push(g),s.async&&!this._options.noScroll&&g.page.scrollIntoView({behavior:"auto"}),y.length>0){const t=[],e=[];for(let s of y){const i=s.$_anc;if(w.contains(i)){t.push(w),f.push(s),e.push(s);break}}this.$_layoutFloatings(t,e)}const P=o+1;return s.finishPrint(P),n<r.length?(e&&this.$_addPageSpace(t,s.container),s.async&&setTimeout((()=>{try{this.$_buildOutputAsync(t,e,s,i,r,n,o+1,a,A)}catch(t){J.remove(this._indicator),this.$_showError(s.container.parentElement,t),console.error(t)}}),100),n):(s.async&&(this.$_refreshContextValues(s),A&&A(s,i)),r.length)}$_layoutFloatings(t,e){e.forEach(((e,s)=>{const i=e.$_anc,r=e.$anp;let n=i.offsetLeft,o=i.offsetTop,a=i.offsetParent;const A=t[s];for(;a instanceof HTMLElement&&a!==A;)n+=a.offsetLeft,o+=a.offsetTop,a=a.offsetParent;switch(A.appendChild(e),r){case Di.INNER_LEFT:o-=(e.offsetHeight-i.offsetHeight)/2;break;case Di.LEFT:n-=e.offsetWidth,o-=(e.offsetHeight-i.offsetHeight)/2;break;case Di.INNER_RIGHT:n+=i.offsetWidth-e.offsetWidth,o-=(e.offsetHeight-i.offsetHeight)/2;break;case Di.RIGHT:n+=i.offsetWidth,o-=(e.offsetHeight-i.offsetHeight)/2;break;case Di.INNER_TOP:n-=(e.offsetWidth-i.offsetWidth)/2;break;case Di.TOP:n-=(e.offsetWidth-i.offsetWidth)/2,o-=e.offsetHeight;break;case Di.INNER_BOTTOM:n-=(e.offsetWidth-i.offsetWidth)/2,o+=i.offsetHeight-e.offsetHeight;break;case Di.BOTTOM:n-=(e.offsetWidth-i.offsetWidth)/2,o+=i.offsetHeight;break;case Di.CENTER:default:n-=(e.offsetWidth-i.offsetWidth)/2,o-=(e.offsetHeight-i.offsetHeight)/2}e.style.left=n+"px",e.style.top=o+"px"}))}}hp.CLASS_NAME="rr-report-container",hp.PREVIEW_CLASS="rr-report-preview",hp.CONFIRM_CLASS="rr-rendered";var dp=function(t,e){return dp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])},dp(t,e)};function cp(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function s(){this.constructor=t}dp(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}var up=function(){return up=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},up.apply(this,arguments)};function pp(t,e,s,i){return new(s||(s=Promise))((function(r,n){function o(t){try{A(i.next(t))}catch(t){n(t)}}function a(t){try{A(i.throw(t))}catch(t){n(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}A((i=i.apply(t,e||[])).next())}))}function _p(t,e){var s,i,r,n,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,i=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){o.label=n[1];break}if(6===n[0]&&o.label<r[1]){o.label=r[1],r=n;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(n);break}r[2]&&o.ops.pop(),o.trys.pop();continue}n=e.call(t,o)}catch(t){n=[6,t],i=0}finally{s=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}function gp(t,e,s){if(s||2===arguments.length)for(var i,r=0,n=e.length;r<n;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||e)}for(var fp=function(){function t(t,e,s,i){this.left=t,this.top=e,this.width=s,this.height=i}return t.prototype.add=function(e,s,i,r){return new t(this.left+e,this.top+s,this.width+i,this.height+r)},t.fromClientRect=function(e,s){return new t(s.left+e.windowBounds.left,s.top+e.windowBounds.top,s.width,s.height)},t.fromDOMRectList=function(e,s){var i=Array.from(s).find((function(t){return 0!==t.width}));return i?new t(i.left+e.windowBounds.left,i.top+e.windowBounds.top,i.width,i.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),mp=function(t,e){return fp.fromClientRect(t,e.getBoundingClientRect())},wp=function(t){for(var e=[],s=0,i=t.length;s<i;){var r=t.charCodeAt(s++);if(r>=55296&&r<=56319&&s<i){var n=t.charCodeAt(s++);56320==(64512&n)?e.push(((1023&r)<<10)+(1023&n)+65536):(e.push(r),s--)}else e.push(r)}return e},yp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var s=t.length;if(!s)return"";for(var i=[],r=-1,n="";++r<s;){var o=t[r];o<=65535?i.push(o):(o-=65536,i.push(55296+(o>>10),o%1024+56320)),(r+1===s||i.length>16384)&&(n+=String.fromCharCode.apply(String,i),i.length=0)}return n},Cp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bp="undefined"==typeof Uint8Array?[]:new Uint8Array(256),vp=0;vp<Cp.length;vp++)bp[Cp.charCodeAt(vp)]=vp;for(var Bp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ep="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Pp=0;Pp<Bp.length;Pp++)Ep[Bp.charCodeAt(Pp)]=Pp;for(var xp=function(t,e,s){return t.slice?t.slice(e,s):new Uint16Array(Array.prototype.slice.call(t,e,s))},Sp=function(){function t(t,e,s,i,r,n){this.initialValue=t,this.errorValue=e,this.highStart=s,this.highValueIndex=i,this.index=r,this.data=n}return t.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=((e=this.index[t>>5])<<2)+(31&t),this.data[e];if(t<=65535)return e=((e=this.index[2048+(t-55296>>5)])<<2)+(31&t),this.data[e];if(t<this.highStart)return e=2080+(t>>11),e=this.index[e],e+=t>>5&63,e=((e=this.index[e])<<2)+(31&t),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),Ip="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rp="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Tp=0;Tp<Ip.length;Tp++)Rp[Ip.charCodeAt(Tp)]=Tp;var Op=10,Fp=13,Dp=15,Lp=17,Np=18,Hp=19,Qp=20,Up=21,Mp=22,kp=24,Vp=25,Gp=26,Kp=27,Wp=28,zp=30,$p=32,Xp=33,jp=34,Yp=35,Jp=37,Zp=38,qp=39,t_=40,e_=42,s_=[9001,65288],i_="×",r_="÷",n_=function(t,e){var s,i,r,n=function(t){var e,s,i,r,n,o=.75*t.length,a=t.length,A=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);var l="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),h=Array.isArray(l)?l:new Uint8Array(l);for(e=0;e<a;e+=4)s=Ep[t.charCodeAt(e)],i=Ep[t.charCodeAt(e+1)],r=Ep[t.charCodeAt(e+2)],n=Ep[t.charCodeAt(e+3)],h[A++]=s<<2|i>>4,h[A++]=(15&i)<<4|r>>2,h[A++]=(3&r)<<6|63&n;return l}(t),o=Array.isArray(n)?function(t){for(var e=t.length,s=[],i=0;i<e;i+=4)s.push(t[i+3]<<24|t[i+2]<<16|t[i+1]<<8|t[i]);return s}(n):new Uint32Array(n),a=Array.isArray(n)?function(t){for(var e=t.length,s=[],i=0;i<e;i+=2)s.push(t[i+1]<<8|t[i]);return s}(n):new Uint16Array(n),A=xp(a,12,o[4]/2),l=2===o[5]?xp(a,(24+o[4])/2):(s=o,i=Math.ceil((24+o[4])/4),s.slice?s.slice(i,r):new Uint32Array(Array.prototype.slice.call(s,i,r)));return new Sp(o[0],o[1],o[2],o[3],A,l)}("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),o_=[zp,36],a_=[1,2,3,5],A_=[Op,8],l_=[Kp,Gp],h_=a_.concat(A_),d_=[Zp,qp,t_,jp,Yp],c_=[Dp,Fp],u_=function(t,e,s,i){var r=i[s];if(Array.isArray(t)?-1!==t.indexOf(r):t===r)for(var n=s;n<=i.length;){if((A=i[++n])===e)return!0;if(A!==Op)break}if(r===Op)for(n=s;n>0;){var o=i[--n];if(Array.isArray(t)?-1!==t.indexOf(o):t===o)for(var a=s;a<=i.length;){var A;if((A=i[++a])===e)return!0;if(A!==Op)break}if(o!==Op)break}return!1},p_=function(t,e){for(var s=t;s>=0;){var i=e[s];if(i!==Op)return i;s--}return 0},__=function(t,e,s,i,r){if(0===s[i])return i_;var n=i-1;if(Array.isArray(r)&&!0===r[n])return i_;var o=n-1,a=n+1,A=e[n],l=o>=0?e[o]:0,h=e[a];if(2===A&&3===h)return i_;if(-1!==a_.indexOf(A))return"!";if(-1!==a_.indexOf(h))return i_;if(-1!==A_.indexOf(h))return i_;if(8===p_(n,e))return r_;if(11===n_.get(t[n]))return i_;if((A===$p||A===Xp)&&11===n_.get(t[a]))return i_;if(7===A||7===h)return i_;if(9===A)return i_;if(-1===[Op,Fp,Dp].indexOf(A)&&9===h)return i_;if(-1!==[Lp,Np,Hp,kp,Wp].indexOf(h))return i_;if(p_(n,e)===Mp)return i_;if(u_(23,Mp,n,e))return i_;if(u_([Lp,Np],Up,n,e))return i_;if(u_(12,12,n,e))return i_;if(A===Op)return r_;if(23===A||23===h)return i_;if(16===h||16===A)return r_;if(-1!==[Fp,Dp,Up].indexOf(h)||14===A)return i_;if(36===l&&-1!==c_.indexOf(A))return i_;if(A===Wp&&36===h)return i_;if(h===Qp)return i_;if(-1!==o_.indexOf(h)&&A===Vp||-1!==o_.indexOf(A)&&h===Vp)return i_;if(A===Kp&&-1!==[Jp,$p,Xp].indexOf(h)||-1!==[Jp,$p,Xp].indexOf(A)&&h===Gp)return i_;if(-1!==o_.indexOf(A)&&-1!==l_.indexOf(h)||-1!==l_.indexOf(A)&&-1!==o_.indexOf(h))return i_;if(-1!==[Kp,Gp].indexOf(A)&&(h===Vp||-1!==[Mp,Dp].indexOf(h)&&e[a+1]===Vp)||-1!==[Mp,Dp].indexOf(A)&&h===Vp||A===Vp&&-1!==[Vp,Wp,kp].indexOf(h))return i_;if(-1!==[Vp,Wp,kp,Lp,Np].indexOf(h))for(var d=n;d>=0;){if((c=e[d])===Vp)return i_;if(-1===[Wp,kp].indexOf(c))break;d--}if(-1!==[Kp,Gp].indexOf(h))for(d=-1!==[Lp,Np].indexOf(A)?o:n;d>=0;){var c;if((c=e[d])===Vp)return i_;if(-1===[Wp,kp].indexOf(c))break;d--}if(Zp===A&&-1!==[Zp,qp,jp,Yp].indexOf(h)||-1!==[qp,jp].indexOf(A)&&-1!==[qp,t_].indexOf(h)||-1!==[t_,Yp].indexOf(A)&&h===t_)return i_;if(-1!==d_.indexOf(A)&&-1!==[Qp,Gp].indexOf(h)||-1!==d_.indexOf(h)&&A===Kp)return i_;if(-1!==o_.indexOf(A)&&-1!==o_.indexOf(h))return i_;if(A===kp&&-1!==o_.indexOf(h))return i_;if(-1!==o_.concat(Vp).indexOf(A)&&h===Mp&&-1===s_.indexOf(t[a])||-1!==o_.concat(Vp).indexOf(h)&&A===Np)return i_;if(41===A&&41===h){for(var u=s[n],p=1;u>0&&41===e[--u];)p++;if(p%2!=0)return i_}return A===$p&&h===Xp?i_:r_},g_=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var s=function(t,e){void 0===e&&(e="strict");var s=[],i=[],r=[];return t.forEach((function(t,n){var o=n_.get(t);if(o>50?(r.push(!0),o-=50):r.push(!1),-1!==["normal","auto","loose"].indexOf(e)&&-1!==[8208,8211,12316,12448].indexOf(t))return i.push(n),s.push(16);if(4===o||11===o){if(0===n)return i.push(n),s.push(zp);var a=s[n-1];return-1===h_.indexOf(a)?(i.push(i[n-1]),s.push(a)):(i.push(n),s.push(zp))}return i.push(n),31===o?s.push("strict"===e?Up:Jp):o===e_||29===o?s.push(zp):43===o?t>=131072&&t<=196605||t>=196608&&t<=262141?s.push(Jp):s.push(zp):void s.push(o)})),[i,s,r]}(t,e.lineBreak),i=s[0],r=s[1],n=s[2];"break-all"!==e.wordBreak&&"break-word"!==e.wordBreak||(r=r.map((function(t){return-1!==[Vp,zp,e_].indexOf(t)?Jp:t})));var o="keep-all"===e.wordBreak?n.map((function(e,s){return e&&t[s]>=19968&&t[s]<=40959})):void 0;return[i,r,o]},f_=function(){function t(t,e,s,i){this.codePoints=t,this.required="!"===e,this.start=s,this.end=i}return t.prototype.slice=function(){return yp.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),m_=45,w_=43,y_=-1,C_=function(t){return t>=48&&t<=57},b_=function(t){return C_(t)||t>=65&&t<=70||t>=97&&t<=102},v_=function(t){return 10===t||9===t||32===t},B_=function(t){return function(t){return function(t){return t>=97&&t<=122}(t)||function(t){return t>=65&&t<=90}(t)}(t)||function(t){return t>=128}(t)||95===t},E_=function(t){return B_(t)||C_(t)||t===m_},P_=function(t){return t>=0&&t<=8||11===t||t>=14&&t<=31||127===t},x_=function(t,e){return 92===t&&10!==e},S_=function(t,e,s){return t===m_?B_(e)||x_(e,s):!!B_(t)||!(92!==t||!x_(t,e))},I_=function(t,e,s){return t===w_||t===m_?!!C_(e)||46===e&&C_(s):C_(46===t?e:t)},R_=function(t){var e=0,s=1;t[e]!==w_&&t[e]!==m_||(t[e]===m_&&(s=-1),e++);for(var i=[];C_(t[e]);)i.push(t[e++]);var r=i.length?parseInt(yp.apply(void 0,i),10):0;46===t[e]&&e++;for(var n=[];C_(t[e]);)n.push(t[e++]);var o=n.length,a=o?parseInt(yp.apply(void 0,n),10):0;69!==t[e]&&101!==t[e]||e++;var A=1;t[e]!==w_&&t[e]!==m_||(t[e]===m_&&(A=-1),e++);for(var l=[];C_(t[e]);)l.push(t[e++]);var h=l.length?parseInt(yp.apply(void 0,l),10):0;return s*(r+a*Math.pow(10,-o))*Math.pow(10,A*h)},T_={type:2},O_={type:3},F_={type:4},D_={type:13},L_={type:8},N_={type:21},H_={type:9},Q_={type:10},U_={type:11},M_={type:12},k_={type:14},V_={type:23},G_={type:1},K_={type:25},W_={type:24},z_={type:26},$_={type:27},X_={type:28},j_={type:29},Y_={type:31},J_={type:32},Z_=function(){function t(){this._value=[]}return t.prototype.write=function(t){this._value=this._value.concat(wp(t))},t.prototype.read=function(){for(var t=[],e=this.consumeToken();e!==J_;)t.push(e),e=this.consumeToken();return t},t.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case 34:return this.consumeStringToken(34);case 35:var e=this.peekCodePoint(0),s=this.peekCodePoint(1),i=this.peekCodePoint(2);if(E_(e)||x_(s,i)){var r=S_(e,s,i)?2:1;return{type:5,value:this.consumeName(),flags:r}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),D_;break;case 39:return this.consumeStringToken(39);case 40:return T_;case 41:return O_;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),k_;break;case w_:if(I_(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 44:return F_;case m_:var n=t,o=this.peekCodePoint(0),a=this.peekCodePoint(1);if(I_(n,o,a))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(S_(n,o,a))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(o===m_&&62===a)return this.consumeCodePoint(),this.consumeCodePoint(),W_;break;case 46:if(I_(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var A=this.consumeCodePoint();if(42===A&&47===(A=this.consumeCodePoint()))return this.consumeToken();if(A===y_)return this.consumeToken()}break;case 58:return z_;case 59:return $_;case 60:if(33===this.peekCodePoint(0)&&this.peekCodePoint(1)===m_&&this.peekCodePoint(2)===m_)return this.consumeCodePoint(),this.consumeCodePoint(),K_;break;case 64:var l=this.peekCodePoint(0),h=this.peekCodePoint(1),d=this.peekCodePoint(2);if(S_(l,h,d))return{type:7,value:this.consumeName()};break;case 91:return X_;case 92:if(x_(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case 93:return j_;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),L_;break;case 123:return U_;case 125:return M_;case 117:case 85:var c=this.peekCodePoint(0),u=this.peekCodePoint(1);return c!==w_||!b_(u)&&63!==u||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),H_;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),N_;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Q_;break;case y_:return J_}return v_(t)?(this.consumeWhiteSpace(),Y_):C_(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):B_(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:yp(t)}},t.prototype.consumeCodePoint=function(){var t=this._value.shift();return void 0===t?-1:t},t.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},t.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},t.prototype.consumeUnicodeRangeToken=function(){for(var t=[],e=this.consumeCodePoint();b_(e)&&t.length<6;)t.push(e),e=this.consumeCodePoint();for(var s=!1;63===e&&t.length<6;)t.push(e),e=this.consumeCodePoint(),s=!0;if(s)return{type:30,start:parseInt(yp.apply(void 0,t.map((function(t){return 63===t?48:t}))),16),end:parseInt(yp.apply(void 0,t.map((function(t){return 63===t?70:t}))),16)};var i=parseInt(yp.apply(void 0,t),16);if(this.peekCodePoint(0)===m_&&b_(this.peekCodePoint(1))){this.consumeCodePoint(),e=this.consumeCodePoint();for(var r=[];b_(e)&&r.length<6;)r.push(e),e=this.consumeCodePoint();return{type:30,start:i,end:parseInt(yp.apply(void 0,r),16)}}return{type:30,start:i,end:i}},t.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return"url"===t.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},t.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===y_)return{type:22,value:""};var e=this.peekCodePoint(0);if(39===e||34===e){var s=this.consumeStringToken(this.consumeCodePoint());return 0===s.type&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===y_||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:s.value}):(this.consumeBadUrlRemnants(),V_)}for(;;){var i=this.consumeCodePoint();if(i===y_||41===i)return{type:22,value:yp.apply(void 0,t)};if(v_(i))return this.consumeWhiteSpace(),this.peekCodePoint(0)===y_||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:yp.apply(void 0,t)}):(this.consumeBadUrlRemnants(),V_);if(34===i||39===i||40===i||P_(i))return this.consumeBadUrlRemnants(),V_;if(92===i){if(!x_(i,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),V_;t.push(this.consumeEscapedCodePoint())}else t.push(i)}},t.prototype.consumeWhiteSpace=function(){for(;v_(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(41===t||t===y_)return;x_(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(t){for(var e="";t>0;){var s=Math.min(5e4,t);e+=yp.apply(void 0,this._value.splice(0,s)),t-=s}return this._value.shift(),e},t.prototype.consumeStringToken=function(t){for(var e="",s=0;;){var i=this._value[s];if(i===y_||void 0===i||i===t)return{type:0,value:e+=this.consumeStringSlice(s)};if(10===i)return this._value.splice(0,s),G_;if(92===i){var r=this._value[s+1];r!==y_&&void 0!==r&&(10===r?(e+=this.consumeStringSlice(s),s=-1,this._value.shift()):x_(i,r)&&(e+=this.consumeStringSlice(s),e+=yp(this.consumeEscapedCodePoint()),s=-1))}s++}},t.prototype.consumeNumber=function(){var t=[],e=4,s=this.peekCodePoint(0);for(s!==w_&&s!==m_||t.push(this.consumeCodePoint());C_(this.peekCodePoint(0));)t.push(this.consumeCodePoint());s=this.peekCodePoint(0);var i=this.peekCodePoint(1);if(46===s&&C_(i))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;C_(this.peekCodePoint(0));)t.push(this.consumeCodePoint());s=this.peekCodePoint(0),i=this.peekCodePoint(1);var r=this.peekCodePoint(2);if((69===s||101===s)&&((i===w_||i===m_)&&C_(r)||C_(i)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;C_(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[R_(t),e]},t.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),e=t[0],s=t[1],i=this.peekCodePoint(0),r=this.peekCodePoint(1),n=this.peekCodePoint(2);return S_(i,r,n)?{type:15,number:e,flags:s,unit:this.consumeName()}:37===i?(this.consumeCodePoint(),{type:16,number:e,flags:s}):{type:17,number:e,flags:s}},t.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(b_(t)){for(var e=yp(t);b_(this.peekCodePoint(0))&&e.length<6;)e+=yp(this.consumeCodePoint());v_(this.peekCodePoint(0))&&this.consumeCodePoint();var s=parseInt(e,16);return 0===s||function(t){return t>=55296&&t<=57343}(s)||s>1114111?65533:s}return t===y_?65533:t},t.prototype.consumeName=function(){for(var t="";;){var e=this.consumeCodePoint();if(E_(e))t+=yp(e);else{if(!x_(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),t;t+=yp(this.consumeEscapedCodePoint())}}},t}(),q_=function(){function t(t){this._tokens=t}return t.create=function(e){var s=new Z_;return s.write(e),new t(s.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var t=this.consumeToken();31===t.type;)t=this.consumeToken();if(32===t.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var e=this.consumeComponentValue();do{t=this.consumeToken()}while(31===t.type);if(32===t.type)return e;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var t=[];;){var e=this.consumeComponentValue();if(32===e.type)return t;t.push(e),t.push()}},t.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},t.prototype.consumeSimpleBlock=function(t){for(var e={type:t,values:[]},s=this.consumeToken();;){if(32===s.type||Ag(s,t))return e;this.reconsumeToken(s),e.values.push(this.consumeComponentValue()),s=this.consumeToken()}},t.prototype.consumeFunction=function(t){for(var e={name:t.value,values:[],type:18};;){var s=this.consumeToken();if(32===s.type||3===s.type)return e;this.reconsumeToken(s),e.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var t=this._tokens.shift();return void 0===t?J_:t},t.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},t}(),tg=function(t){return 15===t.type},eg=function(t){return 17===t.type},sg=function(t){return 20===t.type},ig=function(t){return 0===t.type},rg=function(t,e){return sg(t)&&t.value===e},ng=function(t){return 31!==t.type},og=function(t){return 31!==t.type&&4!==t.type},ag=function(t){var e=[],s=[];return t.forEach((function(t){if(4===t.type){if(0===s.length)throw new Error("Error parsing function args, zero tokens for arg");return e.push(s),void(s=[])}31!==t.type&&s.push(t)})),s.length&&e.push(s),e},Ag=function(t,e){return 11===e&&12===t.type||(28===e&&29===t.type||2===e&&3===t.type)},lg=function(t){return 17===t.type||15===t.type},hg=function(t){return 16===t.type||lg(t)},dg=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},cg={type:17,number:0,flags:4},ug={type:16,number:50,flags:4},pg={type:16,number:100,flags:4},_g=function(t,e,s){var i=t[0],r=t[1];return[gg(i,e),gg(void 0!==r?r:i,s)]},gg=function(t,e){if(16===t.type)return t.number/100*e;if(tg(t))switch(t.unit){case"rem":case"em":return 16*t.number;default:return t.number}return t.number},fg="grad",mg="turn",wg=function(t,e){if(15===e.type)switch(e.unit){case"deg":return Math.PI*e.number/180;case fg:return Math.PI/200*e.number;case"rad":return e.number;case mg:return 2*Math.PI*e.number}throw new Error("Unsupported angle type")},yg=function(t){return 15===t.type&&("deg"===t.unit||t.unit===fg||"rad"===t.unit||t.unit===mg)},Cg=function(t){switch(t.filter(sg).map((function(t){return t.value})).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[cg,cg];case"to top":case"bottom":return bg(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[cg,pg];case"to right":case"left":return bg(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[pg,pg];case"to bottom":case"top":return bg(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[pg,cg];case"to left":case"right":return bg(270)}return 0},bg=function(t){return Math.PI*t/180},vg=function(t,e){if(18===e.type){var s=Tg[e.name];if(void 0===s)throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return s(t,e.values)}if(5===e.type){if(3===e.value.length){var i=e.value.substring(0,1),r=e.value.substring(1,2),n=e.value.substring(2,3);return Pg(parseInt(i+i,16),parseInt(r+r,16),parseInt(n+n,16),1)}if(4===e.value.length){i=e.value.substring(0,1),r=e.value.substring(1,2),n=e.value.substring(2,3);var o=e.value.substring(3,4);return Pg(parseInt(i+i,16),parseInt(r+r,16),parseInt(n+n,16),parseInt(o+o,16)/255)}if(6===e.value.length){i=e.value.substring(0,2),r=e.value.substring(2,4),n=e.value.substring(4,6);return Pg(parseInt(i,16),parseInt(r,16),parseInt(n,16),1)}if(8===e.value.length){i=e.value.substring(0,2),r=e.value.substring(2,4),n=e.value.substring(4,6),o=e.value.substring(6,8);return Pg(parseInt(i,16),parseInt(r,16),parseInt(n,16),parseInt(o,16)/255)}}if(20===e.type){var a=Fg[e.value.toUpperCase()];if(void 0!==a)return a}return Fg.TRANSPARENT},Bg=function(t){return 0==(255&t)},Eg=function(t){var e=255&t,s=255&t>>8,i=255&t>>16,r=255&t>>24;return e<255?"rgba("+r+","+i+","+s+","+e/255+")":"rgb("+r+","+i+","+s+")"},Pg=function(t,e,s,i){return(t<<24|e<<16|s<<8|Math.round(255*i)<<0)>>>0},xg=function(t,e){if(17===t.type)return t.number;if(16===t.type){var s=3===e?1:255;return 3===e?t.number/100*s:Math.round(t.number/100*s)}return 0},Sg=function(t,e){var s=e.filter(og);if(3===s.length){var i=s.map(xg),r=i[0],n=i[1],o=i[2];return Pg(r,n,o,1)}if(4===s.length){var a=s.map(xg),A=(r=a[0],n=a[1],o=a[2],a[3]);return Pg(r,n,o,A)}return 0};function Ig(t,e,s){return s<0&&(s+=1),s>=1&&(s-=1),s<1/6?(e-t)*s*6+t:s<.5?e:s<2/3?6*(e-t)*(2/3-s)+t:t}var Rg=function(t,e){var s=e.filter(og),i=s[0],r=s[1],n=s[2],o=s[3],a=(17===i.type?bg(i.number):wg(t,i))/(2*Math.PI),A=hg(r)?r.number/100:0,l=hg(n)?n.number/100:0,h=void 0!==o&&hg(o)?gg(o,1):1;if(0===A)return Pg(255*l,255*l,255*l,1);var d=l<=.5?l*(A+1):l+A-l*A,c=2*l-d,u=Ig(c,d,a+1/3),p=Ig(c,d,a),_=Ig(c,d,a-1/3);return Pg(255*u,255*p,255*_,h)},Tg={hsl:Rg,hsla:Rg,rgb:Sg,rgba:Sg},Og=function(t,e){return vg(t,q_.create(e).parseComponentValue())},Fg={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Dg={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map((function(t){if(sg(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},Lg={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ng=function(t,e){var s=vg(t,e[0]),i=e[1];return i&&hg(i)?{color:s,stop:i}:{color:s,stop:null}},Hg=function(t,e){var s=t[0],i=t[t.length-1];null===s.stop&&(s.stop=cg),null===i.stop&&(i.stop=pg);for(var r=[],n=0,o=0;o<t.length;o++){var a=t[o].stop;if(null!==a){var A=gg(a,e);A>n?r.push(A):r.push(n),n=A}else r.push(null)}var l=null;for(o=0;o<r.length;o++){var h=r[o];if(null===h)null===l&&(l=o);else if(null!==l){for(var d=o-l,c=(h-r[l-1])/(d+1),u=1;u<=d;u++)r[l+u-1]=c*u;l=null}}return t.map((function(t,s){return{color:t.color,stop:Math.max(Math.min(1,r[s]/e),0)}}))},Qg=function(t,e,s){var i="number"==typeof t?t:function(t,e,s){var i=e/2,r=s/2,n=gg(t[0],e)-i,o=r-gg(t[1],s);return(Math.atan2(o,n)+2*Math.PI)%(2*Math.PI)}(t,e,s),r=Math.abs(e*Math.sin(i))+Math.abs(s*Math.cos(i)),n=e/2,o=s/2,a=r/2,A=Math.sin(i-Math.PI/2)*a,l=Math.cos(i-Math.PI/2)*a;return[r,n-l,n+l,o-A,o+A]},Ug=function(t,e){return Math.sqrt(t*t+e*e)},Mg=function(t,e,s,i,r){return[[0,0],[0,e],[t,0],[t,e]].reduce((function(t,e){var n=e[0],o=e[1],a=Ug(s-n,i-o);return(r?a<t.optimumDistance:a>t.optimumDistance)?{optimumCorner:e,optimumDistance:a}:t}),{optimumDistance:r?1/0:-1/0,optimumCorner:null}).optimumCorner},kg=function(t,e){var s=bg(180),i=[];return ag(e).forEach((function(e,r){if(0===r){var n=e[0];if(20===n.type&&-1!==["top","left","right","bottom"].indexOf(n.value))return void(s=Cg(e));if(yg(n))return void(s=(wg(t,n)+bg(270))%bg(360))}var o=Ng(t,e);i.push(o)})),{angle:s,stops:i,type:1}},Vg="closest-side",Gg="farthest-side",Kg="closest-corner",Wg="farthest-corner",zg="circle",$g="ellipse",Xg="cover",jg="contain",Yg=function(t,e){var s=0,i=3,r=[],n=[];return ag(e).forEach((function(e,o){var a=!0;if(0===o?a=e.reduce((function(t,e){if(sg(e))switch(e.value){case"center":return n.push(ug),!1;case"top":case"left":return n.push(cg),!1;case"right":case"bottom":return n.push(pg),!1}else if(hg(e)||lg(e))return n.push(e),!1;return t}),a):1===o&&(a=e.reduce((function(t,e){if(sg(e))switch(e.value){case zg:return s=0,!1;case $g:return s=1,!1;case jg:case Vg:return i=0,!1;case Gg:return i=1,!1;case Kg:return i=2,!1;case Xg:case Wg:return i=3,!1}else if(lg(e)||hg(e))return Array.isArray(i)||(i=[]),i.push(e),!1;return t}),a)),a){var A=Ng(t,e);r.push(A)}})),{size:i,shape:s,stops:r,position:n,type:2}},Jg=function(t,e){if(22===e.type){var s={url:e.value,type:0};return t.cache.addImage(e.value),s}if(18===e.type){var i=qg[e.name];if(void 0===i)throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return i(t,e.values)}throw new Error("Unsupported image type "+e.type)};var Zg,qg={"linear-gradient":function(t,e){var s=bg(180),i=[];return ag(e).forEach((function(e,r){if(0===r){var n=e[0];if(20===n.type&&"to"===n.value)return void(s=Cg(e));if(yg(n))return void(s=wg(t,n))}var o=Ng(t,e);i.push(o)})),{angle:s,stops:i,type:1}},"-moz-linear-gradient":kg,"-ms-linear-gradient":kg,"-o-linear-gradient":kg,"-webkit-linear-gradient":kg,"radial-gradient":function(t,e){var s=0,i=3,r=[],n=[];return ag(e).forEach((function(e,o){var a=!0;if(0===o){var A=!1;a=e.reduce((function(t,e){if(A)if(sg(e))switch(e.value){case"center":return n.push(ug),t;case"top":case"left":return n.push(cg),t;case"right":case"bottom":return n.push(pg),t}else(hg(e)||lg(e))&&n.push(e);else if(sg(e))switch(e.value){case zg:return s=0,!1;case $g:return s=1,!1;case"at":return A=!0,!1;case Vg:return i=0,!1;case Xg:case Gg:return i=1,!1;case jg:case Kg:return i=2,!1;case Wg:return i=3,!1}else if(lg(e)||hg(e))return Array.isArray(i)||(i=[]),i.push(e),!1;return t}),a)}if(a){var l=Ng(t,e);r.push(l)}})),{size:i,shape:s,stops:r,position:n,type:2}},"-moz-radial-gradient":Yg,"-ms-radial-gradient":Yg,"-o-radial-gradient":Yg,"-webkit-radial-gradient":Yg,"-webkit-gradient":function(t,e){var s=bg(180),i=[],r=1;return ag(e).forEach((function(e,s){var n=e[0];if(0===s){if(sg(n)&&"linear"===n.value)return void(r=1);if(sg(n)&&"radial"===n.value)return void(r=2)}if(18===n.type)if("from"===n.name){var o=vg(t,n.values[0]);i.push({stop:cg,color:o})}else if("to"===n.name){o=vg(t,n.values[0]);i.push({stop:pg,color:o})}else if("color-stop"===n.name){var a=n.values.filter(og);if(2===a.length){o=vg(t,a[1]);var A=a[0];eg(A)&&i.push({stop:{type:16,number:100*A.number,flags:A.flags},color:o})}}})),1===r?{angle:(s+bg(180))%bg(360),stops:i,type:r}:{size:3,shape:0,stops:i,position:[],type:r}}},tf={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(0===e.length)return[];var s=e[0];return 20===s.type&&"none"===s.value?[]:e.filter((function(t){return og(t)&&function(t){return!(20===t.type&&"none"===t.value||18===t.type&&!qg[t.name])}(t)})).map((function(e){return Jg(t,e)}))}},ef={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map((function(t){if(sg(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},sf={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return ag(e).map((function(t){return t.filter(hg)})).map(dg)}},rf={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return ag(e).map((function(t){return t.filter(sg).map((function(t){return t.value})).join(" ")})).map(nf)}},nf=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};!function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"}(Zg||(Zg={}));var of,af={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return ag(e).map((function(t){return t.filter(Af)}))}},Af=function(t){return sg(t)||hg(t)},lf=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},hf=lf("top"),df=lf("right"),cf=lf("bottom"),uf=lf("left"),pf=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(t,e){return dg(e.filter(hg))}}},_f=pf("top-left"),gf=pf("top-right"),ff=pf("bottom-right"),mf=pf("bottom-left"),wf=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,e){switch(e){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},yf=wf("top"),Cf=wf("right"),bf=wf("bottom"),vf=wf("left"),Bf=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return tg(e)?e.number:0}}},Ef=Bf("top"),Pf=Bf("right"),xf=Bf("bottom"),Sf=Bf("left"),If={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Rf={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){return"rtl"===e?1:0}},Tf={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(sg).reduce((function(t,e){return t|Of(e.value)}),0)}},Of=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Ff={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Df={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return 20===e.type&&"normal"===e.value?0:17===e.type||15===e.type?e.number:0}};!function(t){t.NORMAL="normal",t.STRICT="strict"}(of||(of={}));var Lf,Nf={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){return"strict"===e?of.STRICT:of.NORMAL}},Hf={name:"line-height",initialValue:"normal",prefix:!1,type:4},Qf=function(t,e){return sg(t)&&"normal"===t.value?1.2*e:17===t.type?e*t.number:hg(t)?gg(t,e):e},Uf={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return 20===e.type&&"none"===e.value?null:Jg(t,e)}},Mf={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){return"inside"===e?0:1}},kf={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},Vf=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},Gf=Vf("top"),Kf=Vf("right"),Wf=Vf("bottom"),zf=Vf("left"),$f={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(sg).map((function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}}))}},Xf={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){return"break-word"===e?"break-word":"normal"}},jf=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Yf=jf("top"),Jf=jf("right"),Zf=jf("bottom"),qf=jf("left"),tm={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},em={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},sm={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return 1===e.length&&rg(e[0],"none")?[]:ag(e).map((function(e){for(var s={color:Fg.TRANSPARENT,offsetX:cg,offsetY:cg,blur:cg},i=0,r=0;r<e.length;r++){var n=e[r];lg(n)?(0===i?s.offsetX=n:1===i?s.offsetY=n:s.blur=n,i++):s.color=vg(t,n)}return s}))}},im={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},rm={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(20===e.type&&"none"===e.value)return null;if(18===e.type){var s=nm[e.name];if(void 0===s)throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return s(e.values)}return null}},nm={matrix:function(t){var e=t.filter((function(t){return 17===t.type})).map((function(t){return t.number}));return 6===e.length?e:null},matrix3d:function(t){var e=t.filter((function(t){return 17===t.type})).map((function(t){return t.number})),s=e[0],i=e[1],r=e[4],n=e[5],o=e[12],a=e[13];return 16===e.length?[s,i,r,n,o,a]:null}},om={type:16,number:50,flags:4},am=[om,om],Am={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var s=e.filter(hg);return 2!==s.length?am:[s[0],s[1]]}},lm={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;default:return 0}}};!function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"}(Lf||(Lf={}));for(var hm={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Lf.BREAK_ALL;case"keep-all":return Lf.KEEP_ALL;default:return Lf.NORMAL}}},dm={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(20===e.type)return{auto:!0,order:0};if(eg(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},cm=function(t,e){if(15===e.type)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")},um={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return eg(e)?e.number:1}},pm={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},_m={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(sg).map((function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0})).filter((function(t){return 0!==t}))}},gm={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var s=[],i=[];return e.forEach((function(t){switch(t.type){case 20:case 0:s.push(t.value);break;case 17:s.push(t.number.toString());break;case 4:i.push(s.join(" ")),s.length=0}})),s.length&&i.push(s.join(" ")),i.map((function(t){return-1===t.indexOf(" ")?t:"'"+t+"'"}))}},fm={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},mm={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){return eg(e)?e.number:sg(e)&&"bold"===e.value?700:400}},wm={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(sg).map((function(t){return t.value}))}},ym={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},Cm=function(t,e){return 0!=(t&e)},bm={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(0===e.length)return[];var s=e[0];return 20===s.type&&"none"===s.value?[]:e}},vm={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(0===e.length)return null;var s=e[0];if(20===s.type&&"none"===s.value)return null;for(var i=[],r=e.filter(ng),n=0;n<r.length;n++){var o=r[n],a=r[n+1];if(20===o.type){var A=a&&eg(a)?a.number:1;i.push({counter:o.value,increment:A})}}return i}},Bm={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(0===e.length)return[];for(var s=[],i=e.filter(ng),r=0;r<i.length;r++){var n=i[r],o=i[r+1];if(sg(n)&&"none"!==n.value){var a=o&&eg(o)?o.number:0;s.push({counter:n.value,reset:a})}}return s}},Em={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(tg).map((function(e){return cm(t,e)}))}},Pm={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(0===e.length)return null;var s=e[0];if(20===s.type&&"none"===s.value)return null;var i=[],r=e.filter(ig);if(r.length%2!=0)return null;for(var n=0;n<r.length;n+=2){var o=r[n].value,a=r[n+1].value;i.push({open:o,close:a})}return i}},xm=function(t,e,s){if(!t)return"";var i=t[Math.min(e,t.length-1)];return i?s?i.open:i.close:""},Sm={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return 1===e.length&&rg(e[0],"none")?[]:ag(e).map((function(e){for(var s={color:255,offsetX:cg,offsetY:cg,blur:cg,spread:cg,inset:!1},i=0,r=0;r<e.length;r++){var n=e[r];rg(n,"inset")?s.inset=!0:lg(n)?(0===i?s.offsetX=n:1===i?s.offsetY=n:2===i?s.blur=n:s.spread=n,i++):s.color=vg(t,n)}return s}))}},Im={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var s=[];return e.filter(sg).forEach((function(t){switch(t.value){case"stroke":s.push(1);break;case"fill":s.push(0);break;case"markers":s.push(2)}})),[0,1,2].forEach((function(t){-1===s.indexOf(t)&&s.push(t)})),s}},Rm={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Tm={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return tg(e)?e.number:0}},Om=function(){function t(t,e){var s,i;this.animationDuration=Lm(t,Em,e.animationDuration),this.backgroundClip=Lm(t,Dg,e.backgroundClip),this.backgroundColor=Lm(t,Lg,e.backgroundColor),this.backgroundImage=Lm(t,tf,e.backgroundImage),this.backgroundOrigin=Lm(t,ef,e.backgroundOrigin),this.backgroundPosition=Lm(t,sf,e.backgroundPosition),this.backgroundRepeat=Lm(t,rf,e.backgroundRepeat),this.backgroundSize=Lm(t,af,e.backgroundSize),this.borderTopColor=Lm(t,hf,e.borderTopColor),this.borderRightColor=Lm(t,df,e.borderRightColor),this.borderBottomColor=Lm(t,cf,e.borderBottomColor),this.borderLeftColor=Lm(t,uf,e.borderLeftColor),this.borderTopLeftRadius=Lm(t,_f,e.borderTopLeftRadius),this.borderTopRightRadius=Lm(t,gf,e.borderTopRightRadius),this.borderBottomRightRadius=Lm(t,ff,e.borderBottomRightRadius),this.borderBottomLeftRadius=Lm(t,mf,e.borderBottomLeftRadius),this.borderTopStyle=Lm(t,yf,e.borderTopStyle),this.borderRightStyle=Lm(t,Cf,e.borderRightStyle),this.borderBottomStyle=Lm(t,bf,e.borderBottomStyle),this.borderLeftStyle=Lm(t,vf,e.borderLeftStyle),this.borderTopWidth=Lm(t,Ef,e.borderTopWidth),this.borderRightWidth=Lm(t,Pf,e.borderRightWidth),this.borderBottomWidth=Lm(t,xf,e.borderBottomWidth),this.borderLeftWidth=Lm(t,Sf,e.borderLeftWidth),this.boxShadow=Lm(t,Sm,e.boxShadow),this.color=Lm(t,If,e.color),this.direction=Lm(t,Rf,e.direction),this.display=Lm(t,Tf,e.display),this.float=Lm(t,Ff,e.cssFloat),this.fontFamily=Lm(t,gm,e.fontFamily),this.fontSize=Lm(t,fm,e.fontSize),this.fontStyle=Lm(t,ym,e.fontStyle),this.fontVariant=Lm(t,wm,e.fontVariant),this.fontWeight=Lm(t,mm,e.fontWeight),this.letterSpacing=Lm(t,Df,e.letterSpacing),this.lineBreak=Lm(t,Nf,e.lineBreak),this.lineHeight=Lm(t,Hf,e.lineHeight),this.listStyleImage=Lm(t,Uf,e.listStyleImage),this.listStylePosition=Lm(t,Mf,e.listStylePosition),this.listStyleType=Lm(t,kf,e.listStyleType),this.marginTop=Lm(t,Gf,e.marginTop),this.marginRight=Lm(t,Kf,e.marginRight),this.marginBottom=Lm(t,Wf,e.marginBottom),this.marginLeft=Lm(t,zf,e.marginLeft),this.opacity=Lm(t,um,e.opacity);var r=Lm(t,$f,e.overflow);this.overflowX=r[0],this.overflowY=r[r.length>1?1:0],this.overflowWrap=Lm(t,Xf,e.overflowWrap),this.paddingTop=Lm(t,Yf,e.paddingTop),this.paddingRight=Lm(t,Jf,e.paddingRight),this.paddingBottom=Lm(t,Zf,e.paddingBottom),this.paddingLeft=Lm(t,qf,e.paddingLeft),this.paintOrder=Lm(t,Im,e.paintOrder),this.position=Lm(t,em,e.position),this.textAlign=Lm(t,tm,e.textAlign),this.textDecorationColor=Lm(t,pm,null!==(s=e.textDecorationColor)&&void 0!==s?s:e.color),this.textDecorationLine=Lm(t,_m,null!==(i=e.textDecorationLine)&&void 0!==i?i:e.textDecoration),this.textShadow=Lm(t,sm,e.textShadow),this.textTransform=Lm(t,im,e.textTransform),this.transform=Lm(t,rm,e.transform),this.transformOrigin=Lm(t,Am,e.transformOrigin),this.visibility=Lm(t,lm,e.visibility),this.webkitTextStrokeColor=Lm(t,Rm,e.webkitTextStrokeColor),this.webkitTextStrokeWidth=Lm(t,Tm,e.webkitTextStrokeWidth),this.wordBreak=Lm(t,hm,e.wordBreak),this.zIndex=Lm(t,dm,e.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},t.prototype.isTransparent=function(){return Bg(this.backgroundColor)},t.prototype.isTransformed=function(){return null!==this.transform},t.prototype.isPositioned=function(){return 0!==this.position},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return 0!==this.float},t.prototype.isInlineLevel=function(){return Cm(this.display,4)||Cm(this.display,33554432)||Cm(this.display,268435456)||Cm(this.display,536870912)||Cm(this.display,67108864)||Cm(this.display,134217728)},t}(),Fm=function(t,e){this.content=Lm(t,bm,e.content),this.quotes=Lm(t,Pm,e.quotes)},Dm=function(t,e){this.counterIncrement=Lm(t,vm,e.counterIncrement),this.counterReset=Lm(t,Bm,e.counterReset)},Lm=function(t,e,s){var i=new Z_,r=null!=s?s.toString():e.initialValue;i.write(r);var n=new q_(i.read());switch(e.type){case 2:var o=n.parseComponentValue();return e.parse(t,sg(o)?o.value:e.initialValue);case 0:return e.parse(t,n.parseComponentValue());case 1:return e.parse(t,n.parseComponentValues());case 4:return n.parseComponentValue();case 3:switch(e.format){case"angle":return wg(t,n.parseComponentValue());case"color":return vg(t,n.parseComponentValue());case"image":return Jg(t,n.parseComponentValue());case"length":var a=n.parseComponentValue();return lg(a)?a:cg;case"length-percentage":var A=n.parseComponentValue();return hg(A)?A:cg;case"time":return cm(t,n.parseComponentValue())}}},Nm=function(t,e){var s=function(t){switch(t.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(t);return 1===s||e===s},Hm=function(t,e){this.context=t,this.textNodes=[],this.elements=[],this.flags=0,Nm(e,3),this.styles=new Om(t,window.getComputedStyle(e,null)),kw(e)&&(this.styles.animationDuration.some((function(t){return t>0}))&&(e.style.animationDuration="0s"),null!==this.styles.transform&&(e.style.transform="none")),this.bounds=mp(this.context,e),Nm(e,4)&&(this.flags|=16)},Qm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Um="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Mm=0;Mm<Qm.length;Mm++)Um[Qm.charCodeAt(Mm)]=Mm;for(var km=function(t,e,s){return t.slice?t.slice(e,s):new Uint16Array(Array.prototype.slice.call(t,e,s))},Vm=function(){function t(t,e,s,i,r,n){this.initialValue=t,this.errorValue=e,this.highStart=s,this.highValueIndex=i,this.index=r,this.data=n}return t.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=((e=this.index[t>>5])<<2)+(31&t),this.data[e];if(t<=65535)return e=((e=this.index[2048+(t-55296>>5)])<<2)+(31&t),this.data[e];if(t<this.highStart)return e=2080+(t>>11),e=this.index[e],e+=t>>5&63,e=((e=this.index[e])<<2)+(31&t),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),Gm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Km="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Wm=0;Wm<Gm.length;Wm++)Km[Gm.charCodeAt(Wm)]=Wm;var zm,$m=8,Xm=9,jm=11,Ym=12,Jm=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var s=t.length;if(!s)return"";for(var i=[],r=-1,n="";++r<s;){var o=t[r];o<=65535?i.push(o):(o-=65536,i.push(55296+(o>>10),o%1024+56320)),(r+1===s||i.length>16384)&&(n+=String.fromCharCode.apply(String,i),i.length=0)}return n},Zm=function(t,e){var s,i,r,n=function(t){var e,s,i,r,n,o=.75*t.length,a=t.length,A=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);var l="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),h=Array.isArray(l)?l:new Uint8Array(l);for(e=0;e<a;e+=4)s=Um[t.charCodeAt(e)],i=Um[t.charCodeAt(e+1)],r=Um[t.charCodeAt(e+2)],n=Um[t.charCodeAt(e+3)],h[A++]=s<<2|i>>4,h[A++]=(15&i)<<4|r>>2,h[A++]=(3&r)<<6|63&n;return l}(t),o=Array.isArray(n)?function(t){for(var e=t.length,s=[],i=0;i<e;i+=4)s.push(t[i+3]<<24|t[i+2]<<16|t[i+1]<<8|t[i]);return s}(n):new Uint32Array(n),a=Array.isArray(n)?function(t){for(var e=t.length,s=[],i=0;i<e;i+=2)s.push(t[i+1]<<8|t[i]);return s}(n):new Uint16Array(n),A=km(a,12,o[4]/2),l=2===o[5]?km(a,(24+o[4])/2):(s=o,i=Math.ceil((24+o[4])/4),s.slice?s.slice(i,r):new Uint32Array(Array.prototype.slice.call(s,i,r)));return new Vm(o[0],o[1],o[2],o[3],A,l)}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),qm="×",tw=function(t){return Zm.get(t)},ew=function(t,e,s){var i=s-2,r=e[i],n=e[s-1],o=e[s];if(2===n&&3===o)return qm;if(2===n||3===n||4===n)return"÷";if(2===o||3===o||4===o)return"÷";if(n===$m&&-1!==[$m,Xm,jm,Ym].indexOf(o))return qm;if(!(n!==jm&&n!==Xm||o!==Xm&&10!==o))return qm;if((n===Ym||10===n)&&10===o)return qm;if(13===o||5===o)return qm;if(7===o)return qm;if(1===n)return qm;if(13===n&&14===o){for(;5===r;)r=e[--i];if(14===r)return qm}if(15===n&&15===o){for(var a=0;15===r;)a++,r=e[--i];if(a%2==0)return qm}return"÷"},sw=function(t){var e=function(t){for(var e=[],s=0,i=t.length;s<i;){var r=t.charCodeAt(s++);if(r>=55296&&r<=56319&&s<i){var n=t.charCodeAt(s++);56320==(64512&n)?e.push(((1023&r)<<10)+(1023&n)+65536):(e.push(r),s--)}else e.push(r)}return e}(t),s=e.length,i=0,r=0,n=e.map(tw);return{next:function(){if(i>=s)return{done:!0,value:null};for(var t=qm;i<s&&(t=ew(0,n,++i))===qm;);if(t!==qm||i===s){var o=Jm.apply(null,e.slice(r,i));return r=i,{value:o,done:!1}}return{done:!0,value:null}}}},iw=function(t){return 0===t[0]&&255===t[1]&&0===t[2]&&255===t[3]},rw=function(t,e,s,i,r){var n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"svg"),a=document.createElementNS(n,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",s.toString()),a.setAttributeNS(null,"y",i.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(a),a.appendChild(r),o},nw=function(t){return new Promise((function(e,s){var i=new Image;i.onload=function(){return e(i)},i.onerror=s,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(t))}))},ow={get SUPPORT_RANGE_BOUNDS(){var t=function(t){if(t.createRange){var e=t.createRange();if(e.getBoundingClientRect){var s=t.createElement("boundtest");s.style.height="123px",s.style.display="block",t.body.appendChild(s),e.selectNode(s);var i=e.getBoundingClientRect(),r=Math.round(i.height);if(t.body.removeChild(s),123===r)return!0}}return!1}(document);return Object.defineProperty(ow,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=ow.SUPPORT_RANGE_BOUNDS&&function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var s=t.createRange();e.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var i=e.firstChild,r=wp(i.data).map((function(t){return yp(t)})),n=0,o={},a=r.every((function(t,e){s.setStart(i,n),s.setEnd(i,n+t.length);var r=s.getBoundingClientRect();n+=t.length;var a=r.x>o.x||r.y>o.y;return o=r,0===e||a}));return t.body.removeChild(e),a}(document);return Object.defineProperty(ow,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=function(t){var e=new Image,s=t.createElement("canvas"),i=s.getContext("2d");if(!i)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{i.drawImage(e,0,0),s.toDataURL()}catch(t){return!1}return!0}(document);return Object.defineProperty(ow,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t="function"==typeof Array.from&&"function"==typeof window.fetch?function(t){var e=t.createElement("canvas"),s=100;e.width=s,e.height=s;var i=e.getContext("2d");if(!i)return Promise.reject(!1);i.fillStyle="rgb(0, 255, 0)",i.fillRect(0,0,s,s);var r=new Image,n=e.toDataURL();r.src=n;var o=rw(s,s,0,0,r);return i.fillStyle="red",i.fillRect(0,0,s,s),nw(o).then((function(e){i.drawImage(e,0,0);var r=i.getImageData(0,0,s,s).data;i.fillStyle="red",i.fillRect(0,0,s,s);var o=t.createElement("div");return o.style.backgroundImage="url("+n+")",o.style.height="100px",iw(r)?nw(rw(s,s,0,0,o)):Promise.reject(!1)})).then((function(t){return i.drawImage(t,0,0),iw(i.getImageData(0,0,s,s).data)})).catch((function(){return!1}))}(document):Promise.resolve(!1);return Object.defineProperty(ow,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=void 0!==(new Image).crossOrigin;return Object.defineProperty(ow,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(ow,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(ow,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(ow,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},aw=function(t,e){this.text=t,this.bounds=e},Aw=function(t,e){var s=e.ownerDocument;if(s){var i=s.createElement("html2canvaswrapper");i.appendChild(e.cloneNode(!0));var r=e.parentNode;if(r){r.replaceChild(i,e);var n=mp(t,i);return i.firstChild&&r.replaceChild(i.firstChild,i),n}}return fp.EMPTY},lw=function(t,e,s){var i=t.ownerDocument;if(!i)throw new Error("Node has no owner document");var r=i.createRange();return r.setStart(t,e),r.setEnd(t,e+s),r},hw=function(t){if(ow.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map((function(t){return t.segment}))}return function(t){for(var e,s=sw(t),i=[];!(e=s.next()).done;)e.value&&i.push(e.value.slice());return i}(t)},dw=function(t,e){return 0!==e.letterSpacing?hw(t):function(t,e){if(ow.SUPPORT_NATIVE_TEXT_SEGMENTATION){var s=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(s.segment(t)).map((function(t){return t.segment}))}return uw(t,e)}(t,e)},cw=[32,160,4961,65792,65793,4153,4241],uw=function(t,e){for(var s,i=function(t,e){var s=wp(t),i=g_(s,e),r=i[0],n=i[1],o=i[2],a=s.length,A=0,l=0;return{next:function(){if(l>=a)return{done:!0,value:null};for(var t=i_;l<a&&(t=__(s,n,r,++l,o))===i_;);if(t!==i_||l===a){var e=new f_(s,t,A,l);return A=l,{value:e,done:!1}}return{done:!0,value:null}}}}(t,{lineBreak:e.lineBreak,wordBreak:"break-word"===e.overflowWrap?"break-word":e.wordBreak}),r=[],n=function(){if(s.value){var t=s.value.slice(),e=wp(t),i="";e.forEach((function(t){-1===cw.indexOf(t)?i+=yp(t):(i.length&&r.push(i),r.push(yp(t)),i="")})),i.length&&r.push(i)}};!(s=i.next()).done;)n();return r},pw=function(t,e,s){this.text=_w(e.data,s.textTransform),this.textBounds=function(t,e,s,i){var r=dw(e,s),n=[],o=0;return r.forEach((function(e){if(s.textDecorationLine.length||e.trim().length>0)if(ow.SUPPORT_RANGE_BOUNDS){var r=lw(i,o,e.length).getClientRects();if(r.length>1){var a=hw(e),A=0;a.forEach((function(e){n.push(new aw(e,fp.fromDOMRectList(t,lw(i,A+o,e.length).getClientRects()))),A+=e.length}))}else n.push(new aw(e,fp.fromDOMRectList(t,r)))}else{var l=i.splitText(e.length);n.push(new aw(e,Aw(t,i))),i=l}else ow.SUPPORT_RANGE_BOUNDS||(i=i.splitText(e.length));o+=e.length})),n}(t,this.text,s,e)},_w=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(gw,fw);case 2:return t.toUpperCase();default:return t}},gw=/(^|\s|:|-|\(|\))([a-z])/g,fw=function(t,e,s){return t.length>0?e+s.toUpperCase():t},mw=function(t){function e(e,s){var i=t.call(this,e,s)||this;return i.src=s.currentSrc||s.src,i.intrinsicWidth=s.naturalWidth,i.intrinsicHeight=s.naturalHeight,i.context.cache.addImage(i.src),i}return cp(e,t),e}(Hm),ww=function(t){function e(e,s){var i=t.call(this,e,s)||this;return i.canvas=s,i.intrinsicWidth=s.width,i.intrinsicHeight=s.height,i}return cp(e,t),e}(Hm),yw=function(t){function e(e,s){var i=t.call(this,e,s)||this,r=new XMLSerializer,n=mp(e,s);return s.setAttribute("width",n.width+"px"),s.setAttribute("height",n.height+"px"),i.svg="data:image/svg+xml,"+encodeURIComponent(r.serializeToString(s)),i.intrinsicWidth=s.width.baseVal.value,i.intrinsicHeight=s.height.baseVal.value,i.context.cache.addImage(i.svg),i}return cp(e,t),e}(Hm),Cw=function(t){function e(e,s){var i=t.call(this,e,s)||this;return i.value=s.value,i}return cp(e,t),e}(Hm),bw=function(t){function e(e,s){var i=t.call(this,e,s)||this;return i.start=s.start,i.reversed="boolean"==typeof s.reversed&&!0===s.reversed,i}return cp(e,t),e}(Hm),vw=[{type:15,flags:0,unit:"px",number:3}],Bw=[{type:16,flags:0,number:50}],Ew="checkbox",Pw="radio",xw="password",Sw=707406591,Iw=function(t){function e(e,s){var i,r,n,o=t.call(this,e,s)||this;switch(o.type=s.type.toLowerCase(),o.checked=s.checked,o.value=0===(r=(i=s).type===xw?new Array(i.value.length+1).join("•"):i.value).length?i.placeholder||"":r,o.type!==Ew&&o.type!==Pw||(o.styles.backgroundColor=3739148031,o.styles.borderTopColor=o.styles.borderRightColor=o.styles.borderBottomColor=o.styles.borderLeftColor=2779096575,o.styles.borderTopWidth=o.styles.borderRightWidth=o.styles.borderBottomWidth=o.styles.borderLeftWidth=1,o.styles.borderTopStyle=o.styles.borderRightStyle=o.styles.borderBottomStyle=o.styles.borderLeftStyle=1,o.styles.backgroundClip=[0],o.styles.backgroundOrigin=[0],o.bounds=(n=o.bounds).width>n.height?new fp(n.left+(n.width-n.height)/2,n.top,n.height,n.height):n.width<n.height?new fp(n.left,n.top+(n.height-n.width)/2,n.width,n.width):n),o.type){case Ew:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=vw;break;case Pw:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=Bw}return o}return cp(e,t),e}(Hm),Rw=function(t){function e(e,s){var i=t.call(this,e,s)||this,r=s.options[s.selectedIndex||0];return i.value=r&&r.text||"",i}return cp(e,t),e}(Hm),Tw=function(t){function e(e,s){var i=t.call(this,e,s)||this;return i.value=s.value,i}return cp(e,t),e}(Hm),Ow=function(t){function e(e,s){var i=t.call(this,e,s)||this;i.src=s.src,i.width=parseInt(s.width,10)||0,i.height=parseInt(s.height,10)||0,i.backgroundColor=i.styles.backgroundColor;try{if(s.contentWindow&&s.contentWindow.document&&s.contentWindow.document.documentElement){i.tree=Nw(e,s.contentWindow.document.documentElement);var r=s.contentWindow.document.documentElement?Og(e,getComputedStyle(s.contentWindow.document.documentElement).backgroundColor):Fg.TRANSPARENT,n=s.contentWindow.document.body?Og(e,getComputedStyle(s.contentWindow.document.body).backgroundColor):Fg.TRANSPARENT;i.backgroundColor=Bg(r)?Bg(n)?i.styles.backgroundColor:n:r}}catch(t){}return i}return cp(e,t),e}(Hm),Fw=["OL","UL","MENU"],Dw=function(t,e,s,i){for(var r=e.firstChild,n=void 0;r;r=n)if(n=r.nextSibling,Uw(r)&&r.data.trim().length>0)s.textNodes.push(new pw(t,r,s.styles));else if(Mw(r))if(ey(r)&&r.assignedNodes)r.assignedNodes().forEach((function(e){return Dw(t,e,s,i)}));else{var o=Lw(t,r);o.styles.isVisible()&&(Hw(r,o,i)?o.flags|=4:Qw(o.styles)&&(o.flags|=2),-1!==Fw.indexOf(r.tagName)&&(o.flags|=8),s.elements.push(o),r.shadowRoot?Dw(t,r.shadowRoot,o,i):qw(r)||zw(r)||ty(r)||Dw(t,r,o,i))}},Lw=function(t,e){return Yw(e)?new mw(t,e):Xw(e)?new ww(t,e):zw(e)?new yw(t,e):Gw(e)?new Cw(t,e):Kw(e)?new bw(t,e):Ww(e)?new Iw(t,e):ty(e)?new Rw(t,e):qw(e)?new Tw(t,e):Jw(e)?new Ow(t,e):new Hm(t,e)},Nw=function(t,e){var s=Lw(t,e);return s.flags|=4,Dw(t,e,s,s),s},Hw=function(t,e,s){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||$w(t)&&s.styles.isTransparent()},Qw=function(t){return t.isPositioned()||t.isFloating()},Uw=function(t){return t.nodeType===Node.TEXT_NODE},Mw=function(t){return t.nodeType===Node.ELEMENT_NODE},kw=function(t){return Mw(t)&&void 0!==t.style&&!Vw(t)},Vw=function(t){return"object"==typeof t.className},Gw=function(t){return"LI"===t.tagName},Kw=function(t){return"OL"===t.tagName},Ww=function(t){return"INPUT"===t.tagName},zw=function(t){return"svg"===t.tagName},$w=function(t){return"BODY"===t.tagName},Xw=function(t){return"CANVAS"===t.tagName},jw=function(t){return"VIDEO"===t.tagName},Yw=function(t){return"IMG"===t.tagName},Jw=function(t){return"IFRAME"===t.tagName},Zw=function(t){return"STYLE"===t.tagName},qw=function(t){return"TEXTAREA"===t.tagName},ty=function(t){return"SELECT"===t.tagName},ey=function(t){return"SLOT"===t.tagName},sy=function(t){return t.tagName.indexOf("-")>0},iy=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(t){var e=this.counters[t];return e&&e.length?e[e.length-1]:1},t.prototype.getCounterValues=function(t){var e=this.counters[t];return e||[]},t.prototype.pop=function(t){var e=this;t.forEach((function(t){return e.counters[t].pop()}))},t.prototype.parse=function(t){var e=this,s=t.counterIncrement,i=t.counterReset,r=!0;null!==s&&s.forEach((function(t){var s=e.counters[t.counter];s&&0!==t.increment&&(r=!1,s.length||s.push(1),s[Math.max(0,s.length-1)]+=t.increment)}));var n=[];return r&&i.forEach((function(t){var s=e.counters[t.counter];n.push(t.counter),s||(s=e.counters[t.counter]=[]),s.push(t.reset)})),n},t}(),ry={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},ny={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},oy={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},ay={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},Ay=function(t,e,s,i,r,n){return t<e||t>s?fy(t,r,n.length>0):i.integers.reduce((function(e,s,r){for(;t>=s;)t-=s,e+=i.values[r];return e}),"")+n},ly=function(t,e,s,i){var r="";do{s||t--,r=i(t)+r,t/=e}while(t*e>=e);return r},hy=function(t,e,s,i,r){var n=s-e+1;return(t<0?"-":"")+(ly(Math.abs(t),n,i,(function(t){return yp(Math.floor(t%n)+e)}))+r)},dy=function(t,e,s){void 0===s&&(s=". ");var i=e.length;return ly(Math.abs(t),i,!1,(function(t){return e[Math.floor(t%i)]}))+s},cy=function(t,e,s,i,r,n){if(t<-9999||t>9999)return fy(t,4,r.length>0);var o=Math.abs(t),a=r;if(0===o)return e[0]+a;for(var A=0;o>0&&A<=4;A++){var l=o%10;0===l&&Cm(n,1)&&""!==a?a=e[l]+a:l>1||1===l&&0===A||1===l&&1===A&&Cm(n,2)||1===l&&1===A&&Cm(n,4)&&t>100||1===l&&A>1&&Cm(n,8)?a=e[l]+(A>0?s[A-1]:"")+a:1===l&&A>0&&(a=s[A-1]+a),o=Math.floor(o/10)}return(t<0?i:"")+a},uy="十百千萬",py="拾佰仟萬",_y="マイナス",gy="마이너스",fy=function(t,e,s){var i=s?". ":"",r=s?"、":"",n=s?", ":"",o=s?" ":"";switch(e){case 0:return"•"+o;case 1:return"◦"+o;case 2:return"◾"+o;case 5:var a=hy(t,48,57,!0,i);return a.length<4?"0"+a:a;case 4:return dy(t,"〇一二三四五六七八九",r);case 6:return Ay(t,1,3999,ry,3,i).toLowerCase();case 7:return Ay(t,1,3999,ry,3,i);case 8:return hy(t,945,969,!1,i);case 9:return hy(t,97,122,!1,i);case 10:return hy(t,65,90,!1,i);case 11:return hy(t,1632,1641,!0,i);case 12:case 49:return Ay(t,1,9999,ny,3,i);case 35:return Ay(t,1,9999,ny,3,i).toLowerCase();case 13:return hy(t,2534,2543,!0,i);case 14:case 30:return hy(t,6112,6121,!0,i);case 15:return dy(t,"子丑寅卯辰巳午未申酉戌亥",r);case 16:return dy(t,"甲乙丙丁戊己庚辛壬癸",r);case 17:case 48:return cy(t,"零一二三四五六七八九",uy,"負",r,14);case 47:return cy(t,"零壹貳參肆伍陸柒捌玖",py,"負",r,15);case 42:return cy(t,"零一二三四五六七八九",uy,"负",r,14);case 41:return cy(t,"零壹贰叁肆伍陆柒捌玖",py,"负",r,15);case 26:return cy(t,"〇一二三四五六七八九","十百千万",_y,r,0);case 25:return cy(t,"零壱弐参四伍六七八九","拾百千万",_y,r,7);case 31:return cy(t,"영일이삼사오육칠팔구","십백천만",gy,n,7);case 33:return cy(t,"零一二三四五六七八九","十百千萬",gy,n,0);case 32:return cy(t,"零壹貳參四五六七八九","拾百千",gy,n,7);case 18:return hy(t,2406,2415,!0,i);case 20:return Ay(t,1,19999,ay,3,i);case 21:return hy(t,2790,2799,!0,i);case 22:return hy(t,2662,2671,!0,i);case 22:return Ay(t,1,10999,oy,3,i);case 23:return dy(t,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return dy(t,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return hy(t,3302,3311,!0,i);case 28:return dy(t,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",r);case 29:return dy(t,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",r);case 34:return hy(t,3792,3801,!0,i);case 37:return hy(t,6160,6169,!0,i);case 38:return hy(t,4160,4169,!0,i);case 39:return hy(t,2918,2927,!0,i);case 40:return hy(t,1776,1785,!0,i);case 43:return hy(t,3046,3055,!0,i);case 44:return hy(t,3174,3183,!0,i);case 45:return hy(t,3664,3673,!0,i);case 46:return hy(t,3872,3881,!0,i);default:return hy(t,48,57,!0,i)}},my="data-html2canvas-ignore",wy=function(){function t(t,e,s){if(this.context=t,this.options=s,this.scrolledElements=[],this.referenceElement=e,this.counters=new iy,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(t,e){var s=this,i=Cy(t,e);if(!i.contentWindow)return Promise.reject("Unable to find iframe window");var r=t.defaultView.pageXOffset,n=t.defaultView.pageYOffset,o=i.contentWindow,a=o.document,A=By(i).then((function(){return pp(s,void 0,void 0,(function(){var t,s;return _p(this,(function(r){switch(r.label){case 0:return this.scrolledElements.forEach(Iy),o&&(o.scrollTo(e.left,e.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||o.scrollY===e.top&&o.scrollX===e.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-e.left,o.scrollY-e.top,0,0))),t=this.options.onclone,void 0===(s=this.clonedReferenceElement)?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:a.fonts&&a.fonts.ready?[4,a.fonts.ready]:[3,2];case 1:r.sent(),r.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,vy(a)]:[3,4];case 3:r.sent(),r.label=4;case 4:return"function"==typeof t?[2,Promise.resolve().then((function(){return t(a,s)})).then((function(){return i}))]:[2,i]}}))}))}));return a.open(),a.write(xy(document.doctype)+"<html></html>"),Sy(this.referenceElement.ownerDocument,r,n),a.replaceChild(a.adoptNode(this.documentElement),a.documentElement),a.close(),A},t.prototype.createElementClone=function(t){if(Nm(t,2),Xw(t))return this.createCanvasClone(t);if(jw(t))return this.createVideoClone(t);if(Zw(t))return this.createStyleClone(t);var e=t.cloneNode(!1);return Yw(e)&&(Yw(t)&&t.currentSrc&&t.currentSrc!==t.src&&(e.src=t.currentSrc,e.srcset=""),"lazy"===e.loading&&(e.loading="eager")),sy(e)?this.createCustomElementClone(e):e},t.prototype.createCustomElementClone=function(t){var e=document.createElement("html2canvascustomelement");return Py(t.style,e),e},t.prototype.createStyleClone=function(t){try{var e=t.sheet;if(e&&e.cssRules){var s=[].slice.call(e.cssRules,0).reduce((function(t,e){return e&&"string"==typeof e.cssText?t+e.cssText:t}),""),i=t.cloneNode(!1);return i.textContent=s,i}}catch(t){if(this.context.logger.error("Unable to access cssRules property",t),"SecurityError"!==t.name)throw t}return t.cloneNode(!1)},t.prototype.createCanvasClone=function(t){var e;if(this.options.inlineImages&&t.ownerDocument){var s=t.ownerDocument.createElement("img");try{return s.src=t.toDataURL(),s}catch(e){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var i=t.cloneNode(!1);try{i.width=t.width,i.height=t.height;var r=t.getContext("2d"),n=i.getContext("2d");if(n)if(!this.options.allowTaint&&r)n.putImageData(r.getImageData(0,0,t.width,t.height),0,0);else{var o=null!==(e=t.getContext("webgl2"))&&void 0!==e?e:t.getContext("webgl");if(o){var a=o.getContextAttributes();!1===(null==a?void 0:a.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}n.drawImage(t,0,0)}return i}catch(e){this.context.logger.info("Unable to clone canvas as it is tainted",t)}return i},t.prototype.createVideoClone=function(t){var e=t.ownerDocument.createElement("canvas");e.width=t.offsetWidth,e.height=t.offsetHeight;var s=e.getContext("2d");try{return s&&(s.drawImage(t,0,0,e.width,e.height),this.options.allowTaint||s.getImageData(0,0,e.width,e.height)),e}catch(e){this.context.logger.info("Unable to clone video as it is tainted",t)}var i=t.ownerDocument.createElement("canvas");return i.width=t.offsetWidth,i.height=t.offsetHeight,i},t.prototype.appendChildNode=function(t,e,s){Mw(e)&&("SCRIPT"===e.tagName||e.hasAttribute(my)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(e))||this.options.copyStyles&&Mw(e)&&Zw(e)||t.appendChild(this.cloneNode(e,s))},t.prototype.cloneChildNodes=function(t,e,s){for(var i=this,r=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;r;r=r.nextSibling)if(Mw(r)&&ey(r)&&"function"==typeof r.assignedNodes){var n=r.assignedNodes();n.length&&n.forEach((function(t){return i.appendChildNode(e,t,s)}))}else this.appendChildNode(e,r,s)},t.prototype.cloneNode=function(t,e){if(Uw(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var s=t.ownerDocument.defaultView;if(s&&Mw(t)&&(kw(t)||Vw(t))){var i=this.createElementClone(t);i.style.transitionProperty="none";var r=s.getComputedStyle(t),n=s.getComputedStyle(t,":before"),o=s.getComputedStyle(t,":after");this.referenceElement===t&&kw(i)&&(this.clonedReferenceElement=i),$w(i)&&Fy(i);var a=this.counters.parse(new Dm(this.context,r)),A=this.resolvePseudoContent(t,i,n,zm.BEFORE);sy(t)&&(e=!0),jw(t)||this.cloneChildNodes(t,i,e),A&&i.insertBefore(A,i.firstChild);var l=this.resolvePseudoContent(t,i,o,zm.AFTER);return l&&i.appendChild(l),this.counters.pop(a),(r&&(this.options.copyStyles||Vw(t))&&!Jw(t)||e)&&Py(r,i),0===t.scrollTop&&0===t.scrollLeft||this.scrolledElements.push([i,t.scrollLeft,t.scrollTop]),(qw(t)||ty(t))&&(qw(i)||ty(i))&&(i.value=t.value),i}return t.cloneNode(!1)},t.prototype.resolvePseudoContent=function(t,e,s,i){var r=this;if(s){var n=s.content,o=e.ownerDocument;if(o&&n&&"none"!==n&&"-moz-alt-content"!==n&&"none"!==s.display){this.counters.parse(new Dm(this.context,s));var a=new Fm(this.context,s),A=o.createElement("html2canvaspseudoelement");Py(s,A),a.content.forEach((function(e){if(0===e.type)A.appendChild(o.createTextNode(e.value));else if(22===e.type){var s=o.createElement("img");s.src=e.value,s.style.opacity="1",A.appendChild(s)}else if(18===e.type){if("attr"===e.name){var i=e.values.filter(sg);i.length&&A.appendChild(o.createTextNode(t.getAttribute(i[0].value)||""))}else if("counter"===e.name){var n=e.values.filter(og),l=n[0],h=n[1];if(l&&sg(l)){var d=r.counters.getCounterValue(l.value),c=h&&sg(h)?kf.parse(r.context,h.value):3;A.appendChild(o.createTextNode(fy(d,c,!1)))}}else if("counters"===e.name){var u=e.values.filter(og),p=(l=u[0],u[1]);h=u[2];if(l&&sg(l)){var _=r.counters.getCounterValues(l.value),g=h&&sg(h)?kf.parse(r.context,h.value):3,f=p&&0===p.type?p.value:"",m=_.map((function(t){return fy(t,g,!1)})).join(f);A.appendChild(o.createTextNode(m))}}}else if(20===e.type)switch(e.value){case"open-quote":A.appendChild(o.createTextNode(xm(a.quotes,r.quoteDepth++,!0)));break;case"close-quote":A.appendChild(o.createTextNode(xm(a.quotes,--r.quoteDepth,!1)));break;default:A.appendChild(o.createTextNode(e.value))}})),A.className=Ry+" "+Ty;var l=i===zm.BEFORE?" "+Ry:" "+Ty;return Vw(e)?e.className.baseValue+=l:e.className+=l,A}}},t.destroy=function(t){return!!t.parentNode&&(t.parentNode.removeChild(t),!0)},t}();!function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"}(zm||(zm={}));var yy,Cy=function(t,e){var s=t.createElement("iframe");return s.className="html2canvas-container",s.style.visibility="hidden",s.style.position="fixed",s.style.left="-10000px",s.style.top="0px",s.style.border="0",s.width=e.width.toString(),s.height=e.height.toString(),s.scrolling="no",s.setAttribute(my,"true"),t.body.appendChild(s),s},by=function(t){return new Promise((function(e){t.complete?e():t.src?(t.onload=e,t.onerror=e):e()}))},vy=function(t){return Promise.all([].slice.call(t.images,0).map(by))},By=function(t){return new Promise((function(e,s){var i=t.contentWindow;if(!i)return s("No window assigned for iframe");var r=i.document;i.onload=t.onload=function(){i.onload=t.onload=null;var s=setInterval((function(){r.body.childNodes.length>0&&"complete"===r.readyState&&(clearInterval(s),e(t))}),50)}}))},Ey=["all","d","content"],Py=function(t,e){for(var s=t.length-1;s>=0;s--){var i=t.item(s);-1===Ey.indexOf(i)&&e.style.setProperty(i,t.getPropertyValue(i))}return e},xy=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},Sy=function(t,e,s){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||s!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,s)},Iy=function(t){var e=t[0],s=t[1],i=t[2];e.scrollLeft=s,e.scrollTop=i},Ry="___html2canvas___pseudoelement_before",Ty="___html2canvas___pseudoelement_after",Oy='{\n    content: "" !important;\n    display: none !important;\n}',Fy=function(t){Dy(t,"."+Ry+":before"+Oy+"\n         ."+Ty+":after"+Oy)},Dy=function(t,e){var s=t.ownerDocument;if(s){var i=s.createElement("style");i.textContent=e,t.appendChild(i)}},Ly=function(){function t(){}return t.getOrigin=function(e){var s=t._link;return s?(s.href=e,s.href=s.href,s.protocol+s.hostname+s.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),Ny=function(){function t(t,e){this.context=t,this._options=e,this._cache={}}return t.prototype.addImage=function(t){var e=Promise.resolve();return this.has(t)?e:Gy(t)||My(t)?((this._cache[t]=this.loadImage(t)).catch((function(){})),e):e},t.prototype.match=function(t){return this._cache[t]},t.prototype.loadImage=function(t){return pp(this,void 0,void 0,(function(){var e,s,i,r,n=this;return _p(this,(function(o){switch(o.label){case 0:return e=Ly.isSameOrigin(t),s=!ky(t)&&!0===this._options.useCORS&&ow.SUPPORT_CORS_IMAGES&&!e,i=!ky(t)&&!e&&!Gy(t)&&"string"==typeof this._options.proxy&&ow.SUPPORT_CORS_XHR&&!s,e||!1!==this._options.allowTaint||ky(t)||Gy(t)||i||s?(r=t,i?[4,this.proxy(r)]:[3,2]):[2];case 1:r=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise((function(t,e){var i=new Image;i.onload=function(){return t(i)},i.onerror=e,(Vy(r)||s)&&(i.crossOrigin="anonymous"),i.src=r,!0===i.complete&&setTimeout((function(){return t(i)}),500),n._options.imageTimeout>0&&setTimeout((function(){return e("Timed out ("+n._options.imageTimeout+"ms) loading image")}),n._options.imageTimeout)}))];case 3:return[2,o.sent()]}}))}))},t.prototype.has=function(t){return void 0!==this._cache[t]},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(t){var e=this,s=this._options.proxy;if(!s)throw new Error("No proxy defined");var i=t.substring(0,256);return new Promise((function(r,n){var o=ow.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest;a.onload=function(){if(200===a.status)if("text"===o)r(a.response);else{var t=new FileReader;t.addEventListener("load",(function(){return r(t.result)}),!1),t.addEventListener("error",(function(t){return n(t)}),!1),t.readAsDataURL(a.response)}else n("Failed to proxy resource "+i+" with status code "+a.status)},a.onerror=n;var A=s.indexOf("?")>-1?"&":"?";if(a.open("GET",""+s+A+"url="+encodeURIComponent(t)+"&responseType="+o),"text"!==o&&a instanceof XMLHttpRequest&&(a.responseType=o),e._options.imageTimeout){var l=e._options.imageTimeout;a.timeout=l,a.ontimeout=function(){return n("Timed out ("+l+"ms) proxying "+i)}}a.send()}))},t}(),Hy=/^data:image\/svg\+xml/i,Qy=/^data:image\/.*;base64,/i,Uy=/^data:image\/.*/i,My=function(t){return ow.SUPPORT_SVG_DRAWING||!Ky(t)},ky=function(t){return Uy.test(t)},Vy=function(t){return Qy.test(t)},Gy=function(t){return"blob"===t.substr(0,4)},Ky=function(t){return"svg"===t.substr(-3).toLowerCase()||Hy.test(t)},Wy=function(){function t(t,e){this.type=0,this.x=t,this.y=e}return t.prototype.add=function(e,s){return new t(this.x+e,this.y+s)},t}(),zy=function(t,e,s){return new Wy(t.x+(e.x-t.x)*s,t.y+(e.y-t.y)*s)},$y=function(){function t(t,e,s,i){this.type=1,this.start=t,this.startControl=e,this.endControl=s,this.end=i}return t.prototype.subdivide=function(e,s){var i=zy(this.start,this.startControl,e),r=zy(this.startControl,this.endControl,e),n=zy(this.endControl,this.end,e),o=zy(i,r,e),a=zy(r,n,e),A=zy(o,a,e);return s?new t(this.start,i,o,A):new t(A,a,n,this.end)},t.prototype.add=function(e,s){return new t(this.start.add(e,s),this.startControl.add(e,s),this.endControl.add(e,s),this.end.add(e,s))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),Xy=function(t){return 1===t.type},jy=function(t){var e=t.styles,s=t.bounds,i=_g(e.borderTopLeftRadius,s.width,s.height),r=i[0],n=i[1],o=_g(e.borderTopRightRadius,s.width,s.height),a=o[0],A=o[1],l=_g(e.borderBottomRightRadius,s.width,s.height),h=l[0],d=l[1],c=_g(e.borderBottomLeftRadius,s.width,s.height),u=c[0],p=c[1],_=[];_.push((r+a)/s.width),_.push((u+h)/s.width),_.push((n+p)/s.height),_.push((A+d)/s.height);var g=Math.max.apply(Math,_);g>1&&(r/=g,n/=g,a/=g,A/=g,h/=g,d/=g,u/=g,p/=g);var f=s.width-a,m=s.height-d,w=s.width-h,y=s.height-p,C=e.borderTopWidth,b=e.borderRightWidth,v=e.borderBottomWidth,B=e.borderLeftWidth,E=gg(e.paddingTop,t.bounds.width),P=gg(e.paddingRight,t.bounds.width),x=gg(e.paddingBottom,t.bounds.width),S=gg(e.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=r>0||n>0?Yy(s.left+B/3,s.top+C/3,r-B/3,n-C/3,yy.TOP_LEFT):new Wy(s.left+B/3,s.top+C/3),this.topRightBorderDoubleOuterBox=r>0||n>0?Yy(s.left+f,s.top+C/3,a-b/3,A-C/3,yy.TOP_RIGHT):new Wy(s.left+s.width-b/3,s.top+C/3),this.bottomRightBorderDoubleOuterBox=h>0||d>0?Yy(s.left+w,s.top+m,h-b/3,d-v/3,yy.BOTTOM_RIGHT):new Wy(s.left+s.width-b/3,s.top+s.height-v/3),this.bottomLeftBorderDoubleOuterBox=u>0||p>0?Yy(s.left+B/3,s.top+y,u-B/3,p-v/3,yy.BOTTOM_LEFT):new Wy(s.left+B/3,s.top+s.height-v/3),this.topLeftBorderDoubleInnerBox=r>0||n>0?Yy(s.left+2*B/3,s.top+2*C/3,r-2*B/3,n-2*C/3,yy.TOP_LEFT):new Wy(s.left+2*B/3,s.top+2*C/3),this.topRightBorderDoubleInnerBox=r>0||n>0?Yy(s.left+f,s.top+2*C/3,a-2*b/3,A-2*C/3,yy.TOP_RIGHT):new Wy(s.left+s.width-2*b/3,s.top+2*C/3),this.bottomRightBorderDoubleInnerBox=h>0||d>0?Yy(s.left+w,s.top+m,h-2*b/3,d-2*v/3,yy.BOTTOM_RIGHT):new Wy(s.left+s.width-2*b/3,s.top+s.height-2*v/3),this.bottomLeftBorderDoubleInnerBox=u>0||p>0?Yy(s.left+2*B/3,s.top+y,u-2*B/3,p-2*v/3,yy.BOTTOM_LEFT):new Wy(s.left+2*B/3,s.top+s.height-2*v/3),this.topLeftBorderStroke=r>0||n>0?Yy(s.left+B/2,s.top+C/2,r-B/2,n-C/2,yy.TOP_LEFT):new Wy(s.left+B/2,s.top+C/2),this.topRightBorderStroke=r>0||n>0?Yy(s.left+f,s.top+C/2,a-b/2,A-C/2,yy.TOP_RIGHT):new Wy(s.left+s.width-b/2,s.top+C/2),this.bottomRightBorderStroke=h>0||d>0?Yy(s.left+w,s.top+m,h-b/2,d-v/2,yy.BOTTOM_RIGHT):new Wy(s.left+s.width-b/2,s.top+s.height-v/2),this.bottomLeftBorderStroke=u>0||p>0?Yy(s.left+B/2,s.top+y,u-B/2,p-v/2,yy.BOTTOM_LEFT):new Wy(s.left+B/2,s.top+s.height-v/2),this.topLeftBorderBox=r>0||n>0?Yy(s.left,s.top,r,n,yy.TOP_LEFT):new Wy(s.left,s.top),this.topRightBorderBox=a>0||A>0?Yy(s.left+f,s.top,a,A,yy.TOP_RIGHT):new Wy(s.left+s.width,s.top),this.bottomRightBorderBox=h>0||d>0?Yy(s.left+w,s.top+m,h,d,yy.BOTTOM_RIGHT):new Wy(s.left+s.width,s.top+s.height),this.bottomLeftBorderBox=u>0||p>0?Yy(s.left,s.top+y,u,p,yy.BOTTOM_LEFT):new Wy(s.left,s.top+s.height),this.topLeftPaddingBox=r>0||n>0?Yy(s.left+B,s.top+C,Math.max(0,r-B),Math.max(0,n-C),yy.TOP_LEFT):new Wy(s.left+B,s.top+C),this.topRightPaddingBox=a>0||A>0?Yy(s.left+Math.min(f,s.width-b),s.top+C,f>s.width+b?0:Math.max(0,a-b),Math.max(0,A-C),yy.TOP_RIGHT):new Wy(s.left+s.width-b,s.top+C),this.bottomRightPaddingBox=h>0||d>0?Yy(s.left+Math.min(w,s.width-B),s.top+Math.min(m,s.height-v),Math.max(0,h-b),Math.max(0,d-v),yy.BOTTOM_RIGHT):new Wy(s.left+s.width-b,s.top+s.height-v),this.bottomLeftPaddingBox=u>0||p>0?Yy(s.left+B,s.top+Math.min(y,s.height-v),Math.max(0,u-B),Math.max(0,p-v),yy.BOTTOM_LEFT):new Wy(s.left+B,s.top+s.height-v),this.topLeftContentBox=r>0||n>0?Yy(s.left+B+S,s.top+C+E,Math.max(0,r-(B+S)),Math.max(0,n-(C+E)),yy.TOP_LEFT):new Wy(s.left+B+S,s.top+C+E),this.topRightContentBox=a>0||A>0?Yy(s.left+Math.min(f,s.width+B+S),s.top+C+E,f>s.width+B+S?0:a-B+S,A-(C+E),yy.TOP_RIGHT):new Wy(s.left+s.width-(b+P),s.top+C+E),this.bottomRightContentBox=h>0||d>0?Yy(s.left+Math.min(w,s.width-(B+S)),s.top+Math.min(m,s.height+C+E),Math.max(0,h-(b+P)),d-(v+x),yy.BOTTOM_RIGHT):new Wy(s.left+s.width-(b+P),s.top+s.height-(v+x)),this.bottomLeftContentBox=u>0||p>0?Yy(s.left+B+S,s.top+y,Math.max(0,u-(B+S)),p-(v+x),yy.BOTTOM_LEFT):new Wy(s.left+B+S,s.top+s.height-(v+x))};!function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(yy||(yy={}));var Yy=function(t,e,s,i,r){var n=(Math.sqrt(2)-1)/3*4,o=s*n,a=i*n,A=t+s,l=e+i;switch(r){case yy.TOP_LEFT:return new $y(new Wy(t,l),new Wy(t,l-a),new Wy(A-o,e),new Wy(A,e));case yy.TOP_RIGHT:return new $y(new Wy(t,e),new Wy(t+o,e),new Wy(A,l-a),new Wy(A,l));case yy.BOTTOM_RIGHT:return new $y(new Wy(A,e),new Wy(A,e+a),new Wy(t+o,l),new Wy(t,l));case yy.BOTTOM_LEFT:default:return new $y(new Wy(A,l),new Wy(A-o,l),new Wy(t,e+a),new Wy(t,e))}},Jy=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},Zy=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},qy=function(t,e,s){this.offsetX=t,this.offsetY=e,this.matrix=s,this.type=0,this.target=6},tC=function(t,e){this.path=t,this.target=e,this.type=1},eC=function(t){this.opacity=t,this.type=2,this.target=6},sC=function(t){return 1===t.type},iC=function(t,e){return t.length===e.length&&t.some((function(t,s){return t===e[s]}))},rC=function(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]},nC=function(){function t(t,e){if(this.container=t,this.parent=e,this.effects=[],this.curves=new jy(this.container),this.container.styles.opacity<1&&this.effects.push(new eC(this.container.styles.opacity)),null!==this.container.styles.transform){var s=this.container.bounds.left+this.container.styles.transformOrigin[0].number,i=this.container.bounds.top+this.container.styles.transformOrigin[1].number,r=this.container.styles.transform;this.effects.push(new qy(s,i,r))}if(0!==this.container.styles.overflowX){var n=Jy(this.curves),o=Zy(this.curves);iC(n,o)?this.effects.push(new tC(n,6)):(this.effects.push(new tC(n,2)),this.effects.push(new tC(o,4)))}}return t.prototype.getEffects=function(t){for(var e=-1===[2,3].indexOf(this.container.styles.position),s=this.parent,i=this.effects.slice(0);s;){var r=s.effects.filter((function(t){return!sC(t)}));if(e||0!==s.container.styles.position||!s.parent){if(i.unshift.apply(i,r),e=-1===[2,3].indexOf(s.container.styles.position),0!==s.container.styles.overflowX){var n=Jy(s.curves),o=Zy(s.curves);iC(n,o)||i.unshift(new tC(o,6))}}else i.unshift.apply(i,r);s=s.parent}return i.filter((function(e){return Cm(e.target,t)}))},t}(),oC=function(t,e,s,i){t.container.elements.forEach((function(r){var n=Cm(r.flags,4),o=Cm(r.flags,2),a=new nC(r,t);Cm(r.styles.display,2048)&&i.push(a);var A=Cm(r.flags,8)?[]:i;if(n||o){var l=n||r.styles.isPositioned()?s:e,h=new rC(a);if(r.styles.isPositioned()||r.styles.opacity<1||r.styles.isTransformed()){var d=r.styles.zIndex.order;if(d<0){var c=0;l.negativeZIndex.some((function(t,e){return d>t.element.container.styles.zIndex.order?(c=e,!1):c>0})),l.negativeZIndex.splice(c,0,h)}else if(d>0){var u=0;l.positiveZIndex.some((function(t,e){return d>=t.element.container.styles.zIndex.order?(u=e+1,!1):u>0})),l.positiveZIndex.splice(u,0,h)}else l.zeroOrAutoZIndexOrTransformedOrOpacity.push(h)}else r.styles.isFloating()?l.nonPositionedFloats.push(h):l.nonPositionedInlineLevel.push(h);oC(a,h,n?h:s,A)}else r.styles.isInlineLevel()?e.inlineLevel.push(a):e.nonInlineLevel.push(a),oC(a,e,s,A);Cm(r.flags,8)&&aC(r,A)}))},aC=function(t,e){for(var s=t instanceof bw?t.start:1,i=t instanceof bw&&t.reversed,r=0;r<e.length;r++){var n=e[r];n.container instanceof Cw&&"number"==typeof n.container.value&&0!==n.container.value&&(s=n.container.value),n.listValue=fy(s,n.container.styles.listStyleType,!0),s+=i?-1:1}},AC=function(t,e){switch(e){case 0:return hC(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return hC(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return hC(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);default:return hC(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},lC=function(t,e){var s=[];return Xy(t)?s.push(t.subdivide(.5,!1)):s.push(t),Xy(e)?s.push(e.subdivide(.5,!0)):s.push(e),s},hC=function(t,e,s,i){var r=[];return Xy(t)?r.push(t.subdivide(.5,!1)):r.push(t),Xy(s)?r.push(s.subdivide(.5,!0)):r.push(s),Xy(i)?r.push(i.subdivide(.5,!0).reverse()):r.push(i),Xy(e)?r.push(e.subdivide(.5,!1).reverse()):r.push(e),r},dC=function(t){var e=t.bounds,s=t.styles;return e.add(s.borderLeftWidth,s.borderTopWidth,-(s.borderRightWidth+s.borderLeftWidth),-(s.borderTopWidth+s.borderBottomWidth))},cC=function(t){var e=t.styles,s=t.bounds,i=gg(e.paddingLeft,s.width),r=gg(e.paddingRight,s.width),n=gg(e.paddingTop,s.width),o=gg(e.paddingBottom,s.width);return s.add(i+e.borderLeftWidth,n+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+i+r),-(e.borderTopWidth+e.borderBottomWidth+n+o))},uC=function(t,e,s){var i=function(t,e){return 0===t?e.bounds:2===t?cC(e):dC(e)}(fC(t.styles.backgroundOrigin,e),t),r=function(t,e){return 0===t?e.bounds:2===t?cC(e):dC(e)}(fC(t.styles.backgroundClip,e),t),n=gC(fC(t.styles.backgroundSize,e),s,i),o=n[0],a=n[1],A=_g(fC(t.styles.backgroundPosition,e),i.width-o,i.height-a);return[mC(fC(t.styles.backgroundRepeat,e),A,n,i,r),Math.round(i.left+A[0]),Math.round(i.top+A[1]),o,a]},pC=function(t){return sg(t)&&t.value===Zg.AUTO},_C=function(t){return"number"==typeof t},gC=function(t,e,s){var i=e[0],r=e[1],n=e[2],o=t[0],a=t[1];if(!o)return[0,0];if(hg(o)&&a&&hg(a))return[gg(o,s.width),gg(a,s.height)];var A=_C(n);if(sg(o)&&(o.value===Zg.CONTAIN||o.value===Zg.COVER))return _C(n)?s.width/s.height<n!=(o.value===Zg.COVER)?[s.width,s.width/n]:[s.height*n,s.height]:[s.width,s.height];var l=_C(i),h=_C(r),d=l||h;if(pC(o)&&(!a||pC(a)))return l&&h?[i,r]:A||d?d&&A?[l?i:r*n,h?r:i/n]:[l?i:s.width,h?r:s.height]:[s.width,s.height];if(A){var c=0,u=0;return hg(o)?c=gg(o,s.width):hg(a)&&(u=gg(a,s.height)),pC(o)?c=u*n:a&&!pC(a)||(u=c/n),[c,u]}var p=null,_=null;if(hg(o)?p=gg(o,s.width):a&&hg(a)&&(_=gg(a,s.height)),null===p||a&&!pC(a)||(_=l&&h?p/i*r:s.height),null!==_&&pC(o)&&(p=l&&h?_/r*i:s.width),null!==p&&null!==_)return[p,_];throw new Error("Unable to calculate background-size for element")},fC=function(t,e){var s=t[e];return void 0===s?t[0]:s},mC=function(t,e,s,i,r){var n=e[0],o=e[1],a=s[0],A=s[1];switch(t){case 2:return[new Wy(Math.round(i.left),Math.round(i.top+o)),new Wy(Math.round(i.left+i.width),Math.round(i.top+o)),new Wy(Math.round(i.left+i.width),Math.round(A+i.top+o)),new Wy(Math.round(i.left),Math.round(A+i.top+o))];case 3:return[new Wy(Math.round(i.left+n),Math.round(i.top)),new Wy(Math.round(i.left+n+a),Math.round(i.top)),new Wy(Math.round(i.left+n+a),Math.round(i.height+i.top)),new Wy(Math.round(i.left+n),Math.round(i.height+i.top))];case 1:return[new Wy(Math.round(i.left+n),Math.round(i.top+o)),new Wy(Math.round(i.left+n+a),Math.round(i.top+o)),new Wy(Math.round(i.left+n+a),Math.round(i.top+o+A)),new Wy(Math.round(i.left+n),Math.round(i.top+o+A))];default:return[new Wy(Math.round(r.left),Math.round(r.top)),new Wy(Math.round(r.left+r.width),Math.round(r.top)),new Wy(Math.round(r.left+r.width),Math.round(r.height+r.top)),new Wy(Math.round(r.left),Math.round(r.height+r.top))]}},wC="Hidden Text",yC=function(){function t(t){this._data={},this._document=t}return t.prototype.parseMetrics=function(t,e){var s=this._document.createElement("div"),i=this._document.createElement("img"),r=this._document.createElement("span"),n=this._document.body;s.style.visibility="hidden",s.style.fontFamily=t,s.style.fontSize=e,s.style.margin="0",s.style.padding="0",s.style.whiteSpace="nowrap",n.appendChild(s),i.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",i.width=1,i.height=1,i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",r.style.fontFamily=t,r.style.fontSize=e,r.style.margin="0",r.style.padding="0",r.appendChild(this._document.createTextNode(wC)),s.appendChild(r),s.appendChild(i);var o=i.offsetTop-r.offsetTop+2;s.removeChild(r),s.appendChild(this._document.createTextNode(wC)),s.style.lineHeight="normal",i.style.verticalAlign="super";var a=i.offsetTop-s.offsetTop+2;return n.removeChild(s),{baseline:o,middle:a}},t.prototype.getMetrics=function(t,e){var s=t+" "+e;return void 0===this._data[s]&&(this._data[s]=this.parseMetrics(t,e)),this._data[s]},t}(),CC=function(t,e){this.context=t,this.options=e},bC=function(t){function e(e,s){var i=t.call(this,e,s)||this;return i._activeEffects=[],i.canvas=s.canvas?s.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),s.canvas||(i.canvas.width=Math.floor(s.width*s.scale),i.canvas.height=Math.floor(s.height*s.scale),i.canvas.style.width=s.width+"px",i.canvas.style.height=s.height+"px"),i.fontMetrics=new yC(document),i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-s.x,-s.y),i.ctx.textBaseline="bottom",i._activeEffects=[],i.context.logger.debug("Canvas renderer initialized ("+s.width+"x"+s.height+") with scale "+s.scale),i}return cp(e,t),e.prototype.applyEffects=function(t){for(var e=this;this._activeEffects.length;)this.popEffect();t.forEach((function(t){return e.applyEffect(t)}))},e.prototype.applyEffect=function(t){this.ctx.save(),function(t){return 2===t.type}(t)&&(this.ctx.globalAlpha=t.opacity),function(t){return 0===t.type}(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),sC(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(t){return pp(this,void 0,void 0,(function(){return _p(this,(function(e){switch(e.label){case 0:return t.element.container.styles.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.renderNode=function(t){return pp(this,void 0,void 0,(function(){return _p(this,(function(e){switch(e.label){case 0:return Cm(t.container.flags,16),t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return e.sent(),[4,this.renderNodeContent(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e.prototype.renderTextWithLetterSpacing=function(t,e,s){var i=this;0===e?this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+s):hw(t.text).reduce((function(e,r){return i.ctx.fillText(r,e,t.bounds.top+s),e+i.ctx.measureText(r).width}),t.bounds.left)},e.prototype.createFontStyle=function(t){var e=t.fontVariant.filter((function(t){return"normal"===t||"small-caps"===t})).join(""),s=xC(t.fontFamily).join(", "),i=tg(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,e,t.fontWeight,i,s].join(" "),s,i]},e.prototype.renderTextNode=function(t,e){return pp(this,void 0,void 0,(function(){var s,i,r,n,o,a,A,l,h=this;return _p(this,(function(d){return s=this.createFontStyle(e),i=s[0],r=s[1],n=s[2],this.ctx.font=i,this.ctx.direction=1===e.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",o=this.fontMetrics.getMetrics(r,n),a=o.baseline,A=o.middle,l=e.paintOrder,t.textBounds.forEach((function(t){l.forEach((function(s){switch(s){case 0:h.ctx.fillStyle=Eg(e.color),h.renderTextWithLetterSpacing(t,e.letterSpacing,a);var i=e.textShadow;i.length&&t.text.trim().length&&(i.slice(0).reverse().forEach((function(s){h.ctx.shadowColor=Eg(s.color),h.ctx.shadowOffsetX=s.offsetX.number*h.options.scale,h.ctx.shadowOffsetY=s.offsetY.number*h.options.scale,h.ctx.shadowBlur=s.blur.number,h.renderTextWithLetterSpacing(t,e.letterSpacing,a)})),h.ctx.shadowColor="",h.ctx.shadowOffsetX=0,h.ctx.shadowOffsetY=0,h.ctx.shadowBlur=0),e.textDecorationLine.length&&(h.ctx.fillStyle=Eg(e.textDecorationColor||e.color),e.textDecorationLine.forEach((function(e){switch(e){case 1:h.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top+a),t.bounds.width,1);break;case 2:h.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top),t.bounds.width,1);break;case 3:h.ctx.fillRect(t.bounds.left,Math.ceil(t.bounds.top+A),t.bounds.width,1)}})));break;case 1:e.webkitTextStrokeWidth&&t.text.trim().length&&(h.ctx.strokeStyle=Eg(e.webkitTextStrokeColor),h.ctx.lineWidth=e.webkitTextStrokeWidth,h.ctx.lineJoin=window.chrome?"miter":"round",h.ctx.strokeText(t.text,t.bounds.left,t.bounds.top+a)),h.ctx.strokeStyle="",h.ctx.lineWidth=0,h.ctx.lineJoin="miter"}}))})),[2]}))}))},e.prototype.renderReplacedElement=function(t,e,s){if(s&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var i=cC(t),r=Zy(e);this.path(r),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,t.intrinsicWidth,t.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return pp(this,void 0,void 0,(function(){var s,i,r,n,o,a,A,l,h,d,c,u,p,_,g,f,m,w;return _p(this,(function(y){switch(y.label){case 0:this.applyEffects(t.getEffects(4)),s=t.container,i=t.curves,r=s.styles,n=0,o=s.textNodes,y.label=1;case 1:return n<o.length?(a=o[n],[4,this.renderTextNode(a,r)]):[3,4];case 2:y.sent(),y.label=3;case 3:return n++,[3,1];case 4:if(!(s instanceof mw))return[3,8];y.label=5;case 5:return y.trys.push([5,7,,8]),[4,this.context.cache.match(s.src)];case 6:return g=y.sent(),this.renderReplacedElement(s,i,g),[3,8];case 7:return y.sent(),this.context.logger.error("Error loading image "+s.src),[3,8];case 8:if(s instanceof ww&&this.renderReplacedElement(s,i,s.canvas),!(s instanceof yw))return[3,12];y.label=9;case 9:return y.trys.push([9,11,,12]),[4,this.context.cache.match(s.svg)];case 10:return g=y.sent(),this.renderReplacedElement(s,i,g),[3,12];case 11:return y.sent(),this.context.logger.error("Error loading svg "+s.svg.substring(0,255)),[3,12];case 12:return s instanceof Ow&&s.tree?[4,new e(this.context,{scale:this.options.scale,backgroundColor:s.backgroundColor,x:0,y:0,width:s.width,height:s.height}).render(s.tree)]:[3,14];case 13:A=y.sent(),s.width&&s.height&&this.ctx.drawImage(A,0,0,s.width,s.height,s.bounds.left,s.bounds.top,s.bounds.width,s.bounds.height),y.label=14;case 14:if(s instanceof Iw&&(l=Math.min(s.bounds.width,s.bounds.height),s.type===Ew?s.checked&&(this.ctx.save(),this.path([new Wy(s.bounds.left+.39363*l,s.bounds.top+.79*l),new Wy(s.bounds.left+.16*l,s.bounds.top+.5549*l),new Wy(s.bounds.left+.27347*l,s.bounds.top+.44071*l),new Wy(s.bounds.left+.39694*l,s.bounds.top+.5649*l),new Wy(s.bounds.left+.72983*l,s.bounds.top+.23*l),new Wy(s.bounds.left+.84*l,s.bounds.top+.34085*l),new Wy(s.bounds.left+.39363*l,s.bounds.top+.79*l)]),this.ctx.fillStyle=Eg(Sw),this.ctx.fill(),this.ctx.restore()):s.type===Pw&&s.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(s.bounds.left+l/2,s.bounds.top+l/2,l/4,0,2*Math.PI,!0),this.ctx.fillStyle=Eg(Sw),this.ctx.fill(),this.ctx.restore())),vC(s)&&s.value.length){switch(h=this.createFontStyle(r),m=h[0],d=h[1],c=this.fontMetrics.getMetrics(m,d).baseline,this.ctx.font=m,this.ctx.fillStyle=Eg(r.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=EC(s.styles.textAlign),w=cC(s),u=0,s.styles.textAlign){case 1:u+=w.width/2;break;case 2:u+=w.width}p=w.add(u,0,0,-w.height/2+1),this.ctx.save(),this.path([new Wy(w.left,w.top),new Wy(w.left+w.width,w.top),new Wy(w.left+w.width,w.top+w.height),new Wy(w.left,w.top+w.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new aw(s.value,p),r.letterSpacing,c),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Cm(s.styles.display,2048))return[3,20];if(null===s.styles.listStyleImage)return[3,19];if(0!==(_=s.styles.listStyleImage).type)return[3,18];g=void 0,f=_.url,y.label=15;case 15:return y.trys.push([15,17,,18]),[4,this.context.cache.match(f)];case 16:return g=y.sent(),this.ctx.drawImage(g,s.bounds.left-(g.width+10),s.bounds.top),[3,18];case 17:return y.sent(),this.context.logger.error("Error loading list-style-image "+f),[3,18];case 18:return[3,20];case 19:t.listValue&&-1!==s.styles.listStyleType&&(m=this.createFontStyle(r)[0],this.ctx.font=m,this.ctx.fillStyle=Eg(r.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",w=new fp(s.bounds.left,s.bounds.top+gg(s.styles.paddingTop,s.bounds.width),s.bounds.width,Qf(r.lineHeight,r.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new aw(t.listValue,w),r.letterSpacing,Qf(r.lineHeight,r.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),y.label=20;case 20:return[2]}}))}))},e.prototype.renderStackContent=function(t){return pp(this,void 0,void 0,(function(){var e,s,i,r,n,o,a,A,l,h,d,c,u,p,_;return _p(this,(function(g){switch(g.label){case 0:return Cm(t.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:g.sent(),e=0,s=t.negativeZIndex,g.label=2;case 2:return e<s.length?(_=s[e],[4,this.renderStack(_)]):[3,5];case 3:g.sent(),g.label=4;case 4:return e++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:g.sent(),i=0,r=t.nonInlineLevel,g.label=7;case 7:return i<r.length?(_=r[i],[4,this.renderNode(_)]):[3,10];case 8:g.sent(),g.label=9;case 9:return i++,[3,7];case 10:n=0,o=t.nonPositionedFloats,g.label=11;case 11:return n<o.length?(_=o[n],[4,this.renderStack(_)]):[3,14];case 12:g.sent(),g.label=13;case 13:return n++,[3,11];case 14:a=0,A=t.nonPositionedInlineLevel,g.label=15;case 15:return a<A.length?(_=A[a],[4,this.renderStack(_)]):[3,18];case 16:g.sent(),g.label=17;case 17:return a++,[3,15];case 18:l=0,h=t.inlineLevel,g.label=19;case 19:return l<h.length?(_=h[l],[4,this.renderNode(_)]):[3,22];case 20:g.sent(),g.label=21;case 21:return l++,[3,19];case 22:d=0,c=t.zeroOrAutoZIndexOrTransformedOrOpacity,g.label=23;case 23:return d<c.length?(_=c[d],[4,this.renderStack(_)]):[3,26];case 24:g.sent(),g.label=25;case 25:return d++,[3,23];case 26:u=0,p=t.positiveZIndex,g.label=27;case 27:return u<p.length?(_=p[u],[4,this.renderStack(_)]):[3,30];case 28:g.sent(),g.label=29;case 29:return u++,[3,27];case 30:return[2]}}))}))},e.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},e.prototype.formatPath=function(t){var e=this;t.forEach((function(t,s){var i=Xy(t)?t.start:t;0===s?e.ctx.moveTo(i.x,i.y):e.ctx.lineTo(i.x,i.y),Xy(t)&&e.ctx.bezierCurveTo(t.startControl.x,t.startControl.y,t.endControl.x,t.endControl.y,t.end.x,t.end.y)}))},e.prototype.renderRepeat=function(t,e,s,i){this.path(t),this.ctx.fillStyle=e,this.ctx.translate(s,i),this.ctx.fill(),this.ctx.translate(-s,-i)},e.prototype.resizeImage=function(t,e,s){var i;if(t.width===e&&t.height===s)return t;var r=(null!==(i=this.canvas.ownerDocument)&&void 0!==i?i:document).createElement("canvas");return r.width=Math.max(1,e),r.height=Math.max(1,s),r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,e,s),r},e.prototype.renderBackgroundImage=function(t){return pp(this,void 0,void 0,(function(){var e,s,i,r,n,o;return _p(this,(function(a){switch(a.label){case 0:e=t.styles.backgroundImage.length-1,s=function(s){var r,n,o,a,A,l,h,d,c,u,p,_,g,f,m,w,y,C,b,v,B,E,P,x,S,I,R,T,O,F,D;return _p(this,(function(L){switch(L.label){case 0:if(0!==s.type)return[3,5];r=void 0,n=s.url,L.label=1;case 1:return L.trys.push([1,3,,4]),[4,i.context.cache.match(n)];case 2:return r=L.sent(),[3,4];case 3:return L.sent(),i.context.logger.error("Error loading background-image "+n),[3,4];case 4:return r&&(o=uC(t,e,[r.width,r.height,r.width/r.height]),w=o[0],E=o[1],P=o[2],b=o[3],v=o[4],f=i.ctx.createPattern(i.resizeImage(r,b,v),"repeat"),i.renderRepeat(w,f,E,P)),[3,6];case 5:1===s.type?(a=uC(t,e,[null,null,null]),w=a[0],E=a[1],P=a[2],b=a[3],v=a[4],A=Qg(s.angle,b,v),l=A[0],h=A[1],d=A[2],c=A[3],u=A[4],(p=document.createElement("canvas")).width=b,p.height=v,_=p.getContext("2d"),g=_.createLinearGradient(h,c,d,u),Hg(s.stops,l).forEach((function(t){return g.addColorStop(t.stop,Eg(t.color))})),_.fillStyle=g,_.fillRect(0,0,b,v),b>0&&v>0&&(f=i.ctx.createPattern(p,"repeat"),i.renderRepeat(w,f,E,P))):function(t){return 2===t.type}(s)&&(m=uC(t,e,[null,null,null]),w=m[0],y=m[1],C=m[2],b=m[3],v=m[4],B=0===s.position.length?[ug]:s.position,E=gg(B[0],b),P=gg(B[B.length-1],v),x=function(t,e,s,i,r){var n=0,o=0;switch(t.size){case 0:0===t.shape?n=o=Math.min(Math.abs(e),Math.abs(e-i),Math.abs(s),Math.abs(s-r)):1===t.shape&&(n=Math.min(Math.abs(e),Math.abs(e-i)),o=Math.min(Math.abs(s),Math.abs(s-r)));break;case 2:if(0===t.shape)n=o=Math.min(Ug(e,s),Ug(e,s-r),Ug(e-i,s),Ug(e-i,s-r));else if(1===t.shape){var a=Math.min(Math.abs(s),Math.abs(s-r))/Math.min(Math.abs(e),Math.abs(e-i)),A=Mg(i,r,e,s,!0),l=A[0],h=A[1];o=a*(n=Ug(l-e,(h-s)/a))}break;case 1:0===t.shape?n=o=Math.max(Math.abs(e),Math.abs(e-i),Math.abs(s),Math.abs(s-r)):1===t.shape&&(n=Math.max(Math.abs(e),Math.abs(e-i)),o=Math.max(Math.abs(s),Math.abs(s-r)));break;case 3:if(0===t.shape)n=o=Math.max(Ug(e,s),Ug(e,s-r),Ug(e-i,s),Ug(e-i,s-r));else if(1===t.shape){a=Math.max(Math.abs(s),Math.abs(s-r))/Math.max(Math.abs(e),Math.abs(e-i));var d=Mg(i,r,e,s,!1);l=d[0],h=d[1],o=a*(n=Ug(l-e,(h-s)/a))}}return Array.isArray(t.size)&&(n=gg(t.size[0],i),o=2===t.size.length?gg(t.size[1],r):n),[n,o]}(s,E,P,b,v),S=x[0],I=x[1],S>0&&I>0&&(R=i.ctx.createRadialGradient(y+E,C+P,0,y+E,C+P,S),Hg(s.stops,2*S).forEach((function(t){return R.addColorStop(t.stop,Eg(t.color))})),i.path(w),i.ctx.fillStyle=R,S!==I?(T=t.bounds.left+.5*t.bounds.width,O=t.bounds.top+.5*t.bounds.height,D=1/(F=I/S),i.ctx.save(),i.ctx.translate(T,O),i.ctx.transform(1,0,0,F,0,0),i.ctx.translate(-T,-O),i.ctx.fillRect(y,D*(C-O)+O,b,v*D),i.ctx.restore()):i.ctx.fill())),L.label=6;case 6:return e--,[2]}}))},i=this,r=0,n=t.styles.backgroundImage.slice(0).reverse(),a.label=1;case 1:return r<n.length?(o=n[r],[5,s(o)]):[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},e.prototype.renderSolidBorder=function(t,e,s){return pp(this,void 0,void 0,(function(){return _p(this,(function(i){return this.path(AC(s,e)),this.ctx.fillStyle=Eg(t),this.ctx.fill(),[2]}))}))},e.prototype.renderDoubleBorder=function(t,e,s,i){return pp(this,void 0,void 0,(function(){var r,n;return _p(this,(function(o){switch(o.label){case 0:return e<3?[4,this.renderSolidBorder(t,s,i)]:[3,2];case 1:return o.sent(),[2];case 2:return r=function(t,e){switch(e){case 0:return hC(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return hC(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return hC(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);default:return hC(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}}(i,s),this.path(r),this.ctx.fillStyle=Eg(t),this.ctx.fill(),n=function(t,e){switch(e){case 0:return hC(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return hC(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return hC(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);default:return hC(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}}(i,s),this.path(n),this.ctx.fill(),[2]}}))}))},e.prototype.renderNodeBackgroundAndBorders=function(t){return pp(this,void 0,void 0,(function(){var e,s,i,r,n,o,a,A,l=this;return _p(this,(function(h){switch(h.label){case 0:return this.applyEffects(t.getEffects(2)),e=t.container.styles,s=!Bg(e.backgroundColor)||e.backgroundImage.length,i=[{style:e.borderTopStyle,color:e.borderTopColor,width:e.borderTopWidth},{style:e.borderRightStyle,color:e.borderRightColor,width:e.borderRightWidth},{style:e.borderBottomStyle,color:e.borderBottomColor,width:e.borderBottomWidth},{style:e.borderLeftStyle,color:e.borderLeftColor,width:e.borderLeftWidth}],r=BC(fC(e.backgroundClip,0),t.curves),s||e.boxShadow.length?(this.ctx.save(),this.path(r),this.ctx.clip(),Bg(e.backgroundColor)||(this.ctx.fillStyle=Eg(e.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),e.boxShadow.slice(0).reverse().forEach((function(e){l.ctx.save();var s,i,r,n,o,a=Jy(t.curves),A=e.inset?0:1e4,h=(s=a,i=-A+(e.inset?1:-1)*e.spread.number,r=(e.inset?1:-1)*e.spread.number,n=e.spread.number*(e.inset?-2:2),o=e.spread.number*(e.inset?-2:2),s.map((function(t,e){switch(e){case 0:return t.add(i,r);case 1:return t.add(i+n,r);case 2:return t.add(i+n,r+o);case 3:return t.add(i,r+o)}return t})));e.inset?(l.path(a),l.ctx.clip(),l.mask(h)):(l.mask(a),l.ctx.clip(),l.path(h)),l.ctx.shadowOffsetX=e.offsetX.number+A,l.ctx.shadowOffsetY=e.offsetY.number,l.ctx.shadowColor=Eg(e.color),l.ctx.shadowBlur=e.blur.number,l.ctx.fillStyle=e.inset?Eg(e.color):"rgba(0,0,0,1)",l.ctx.fill(),l.ctx.restore()})),h.label=2;case 2:n=0,o=0,a=i,h.label=3;case 3:return o<a.length?0!==(A=a[o]).style&&!Bg(A.color)&&A.width>0?2!==A.style?[3,5]:[4,this.renderDashedDottedBorder(A.color,A.width,n,t.curves,2)]:[3,11]:[3,13];case 4:return h.sent(),[3,11];case 5:return 3!==A.style?[3,7]:[4,this.renderDashedDottedBorder(A.color,A.width,n,t.curves,3)];case 6:return h.sent(),[3,11];case 7:return 4!==A.style?[3,9]:[4,this.renderDoubleBorder(A.color,A.width,n,t.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(A.color,n,t.curves)];case 10:h.sent(),h.label=11;case 11:n++,h.label=12;case 12:return o++,[3,3];case 13:return[2]}}))}))},e.prototype.renderDashedDottedBorder=function(t,e,s,i,r){return pp(this,void 0,void 0,(function(){var n,o,a,A,l,h,d,c,u,p,_,g,f,m,w,y;return _p(this,(function(C){return this.ctx.save(),n=function(t,e){switch(e){case 0:return lC(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return lC(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return lC(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);default:return lC(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}}(i,s),o=AC(i,s),2===r&&(this.path(o),this.ctx.clip()),Xy(o[0])?(a=o[0].start.x,A=o[0].start.y):(a=o[0].x,A=o[0].y),Xy(o[1])?(l=o[1].end.x,h=o[1].end.y):(l=o[1].x,h=o[1].y),d=0===s||2===s?Math.abs(a-l):Math.abs(A-h),this.ctx.beginPath(),3===r?this.formatPath(n):this.formatPath(o.slice(0,2)),c=e<3?3*e:2*e,u=e<3?2*e:e,3===r&&(c=e,u=e),p=!0,d<=2*c?p=!1:d<=2*c+u?(c*=_=d/(2*c+u),u*=_):(g=Math.floor((d+u)/(c+u)),f=(d-g*c)/(g-1),u=(m=(d-(g+1)*c)/g)<=0||Math.abs(u-f)<Math.abs(u-m)?f:m),p&&(3===r?this.ctx.setLineDash([0,c+u]):this.ctx.setLineDash([c,u])),3===r?(this.ctx.lineCap="round",this.ctx.lineWidth=e):this.ctx.lineWidth=2*e+1.1,this.ctx.strokeStyle=Eg(t),this.ctx.stroke(),this.ctx.setLineDash([]),2===r&&(Xy(o[0])&&(w=o[3],y=o[0],this.ctx.beginPath(),this.formatPath([new Wy(w.end.x,w.end.y),new Wy(y.start.x,y.start.y)]),this.ctx.stroke()),Xy(o[1])&&(w=o[1],y=o[2],this.ctx.beginPath(),this.formatPath([new Wy(w.end.x,w.end.y),new Wy(y.start.x,y.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]}))}))},e.prototype.render=function(t){return pp(this,void 0,void 0,(function(){var e;return _p(this,(function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Eg(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),i=new nC(t,null),r=new rC(i),oC(i,r,r,n=[]),aC(i.container,n),e=r,[4,this.renderStack(e)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}var i,r,n}))}))},e}(CC),vC=function(t){return t instanceof Tw||(t instanceof Rw||t instanceof Iw&&t.type!==Pw&&t.type!==Ew)},BC=function(t,e){switch(t){case 0:return Jy(e);case 2:return function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]}(e);default:return Zy(e)}},EC=function(t){switch(t){case 1:return"center";case 2:return"right";default:return"left"}},PC=["-apple-system","system-ui"],xC=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter((function(t){return-1===PC.indexOf(t)})):t},SC=function(t){function e(e,s){var i=t.call(this,e,s)||this;return i.canvas=s.canvas?s.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),i.options=s,i.canvas.width=Math.floor(s.width*s.scale),i.canvas.height=Math.floor(s.height*s.scale),i.canvas.style.width=s.width+"px",i.canvas.style.height=s.height+"px",i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-s.x,-s.y),i.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+s.width+"x"+s.height+" at "+s.x+","+s.y+") with scale "+s.scale),i}return cp(e,t),e.prototype.render=function(t){return pp(this,void 0,void 0,(function(){var e,s;return _p(this,(function(i){switch(i.label){case 0:return e=rw(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,IC(e)];case 1:return s=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Eg(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}}))}))},e}(CC),IC=function(t){return new Promise((function(e,s){var i=new Image;i.onload=function(){e(i)},i.onerror=s,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(t))}))},RC=function(){function t(t){var e=t.id,s=t.enabled;this.id=e,this.enabled=s,this.start=Date.now()}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug?console.debug.apply(console,gp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof console.info&&console.info.apply(console,gp([this.id,this.getTime()+"ms"],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn?console.warn.apply(console,gp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error?console.error.apply(console,gp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},t.instances={},t}(),TC=function(){function t(e,s){var i;this.windowBounds=s,this.instanceName="#"+t.instanceCount++,this.logger=new RC({id:this.instanceName,enabled:e.logging}),this.cache=null!==(i=e.cache)&&void 0!==i?i:new Ny(this,e)}return t.instanceCount=1,t}(),OC=function(t,e){return void 0===e&&(e={}),FC(t,e)};"undefined"!=typeof window&&Ly.setContext(window);var FC=function(t,e){return pp(void 0,void 0,void 0,(function(){var s,i,r,n,o,a,A,l,h,d,c,u,p,_,g,f,m,w,y,C,b,v,B,E,P,x,S,I,R,T,O,F,D,L,N,H,Q,U;return _p(this,(function(M){switch(M.label){case 0:if(!t||"object"!=typeof t)return[2,Promise.reject("Invalid element provided as first argument")];if(!(s=t.ownerDocument))throw new Error("Element is not attached to a Document");if(!(i=s.defaultView))throw new Error("Document is not attached to a Window");return r={allowTaint:null!==(v=e.allowTaint)&&void 0!==v&&v,imageTimeout:null!==(B=e.imageTimeout)&&void 0!==B?B:15e3,proxy:e.proxy,useCORS:null!==(E=e.useCORS)&&void 0!==E&&E},n=up({logging:null===(P=e.logging)||void 0===P||P,cache:e.cache},r),o={windowWidth:null!==(x=e.windowWidth)&&void 0!==x?x:i.innerWidth,windowHeight:null!==(S=e.windowHeight)&&void 0!==S?S:i.innerHeight,scrollX:null!==(I=e.scrollX)&&void 0!==I?I:i.pageXOffset,scrollY:null!==(R=e.scrollY)&&void 0!==R?R:i.pageYOffset},a=new fp(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),A=new TC(n,a),l=null!==(T=e.foreignObjectRendering)&&void 0!==T&&T,h={allowTaint:null!==(O=e.allowTaint)&&void 0!==O&&O,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:l,copyStyles:l},A.logger.debug("Starting document clone with size "+a.width+"x"+a.height+" scrolled to "+-a.left+","+-a.top),d=new wy(A,t,h),(c=d.clonedReferenceElement)?[4,d.toIFrame(s,a)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return u=M.sent(),p=$w(c)||"HTML"===c.tagName?function(t){var e=t.body,s=t.documentElement;if(!e||!s)throw new Error("Unable to get document size");var i=Math.max(Math.max(e.scrollWidth,s.scrollWidth),Math.max(e.offsetWidth,s.offsetWidth),Math.max(e.clientWidth,s.clientWidth)),r=Math.max(Math.max(e.scrollHeight,s.scrollHeight),Math.max(e.offsetHeight,s.offsetHeight),Math.max(e.clientHeight,s.clientHeight));return new fp(0,0,i,r)}(c.ownerDocument):mp(A,c),_=p.width,g=p.height,f=p.left,m=p.top,w=DC(A,c,e.backgroundColor),y={canvas:e.canvas,backgroundColor:w,scale:null!==(D=null!==(F=e.scale)&&void 0!==F?F:i.devicePixelRatio)&&void 0!==D?D:1,x:(null!==(L=e.x)&&void 0!==L?L:0)+f,y:(null!==(N=e.y)&&void 0!==N?N:0)+m,width:null!==(H=e.width)&&void 0!==H?H:Math.ceil(_),height:null!==(Q=e.height)&&void 0!==Q?Q:Math.ceil(g)},l?(A.logger.debug("Document cloned, using foreign object rendering"),[4,new SC(A,y).render(c)]):[3,3];case 2:return C=M.sent(),[3,5];case 3:return A.logger.debug("Document cloned, element located at "+f+","+m+" with size "+_+"x"+g+" using computed rendering"),A.logger.debug("Starting DOM parsing"),b=Nw(A,c),w===b.styles.backgroundColor&&(b.styles.backgroundColor=Fg.TRANSPARENT),A.logger.debug("Starting renderer for element at "+y.x+","+y.y+" with size "+y.width+"x"+y.height),[4,new bC(A,y).render(b)];case 4:C=M.sent(),M.label=5;case 5:return(null===(U=e.removeContainer)||void 0===U||U)&&(wy.destroy(u)||A.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),A.logger.debug("Finished rendering"),[2,C]}}))}))},DC=function(t,e,s){var i=e.ownerDocument,r=i.documentElement?Og(t,getComputedStyle(i.documentElement).backgroundColor):Fg.TRANSPARENT,n=i.body?Og(t,getComputedStyle(i.body).backgroundColor):Fg.TRANSPARENT,o="string"==typeof s?Og(t,s):null===s?Fg.TRANSPARENT:4294967295;return e===i.documentElement?Bg(r)?Bg(n)?o:n:r:o},LC=Uint8Array,NC=Uint16Array,HC=Uint32Array,QC=new LC([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),UC=new LC([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),MC=new LC([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kC=function(t,e){for(var s=new NC(31),i=0;i<31;++i)s[i]=e+=1<<t[i-1];var r=new HC(s[30]);for(i=1;i<30;++i)for(var n=s[i];n<s[i+1];++n)r[n]=n-s[i]<<5|i;return[s,r]},VC=kC(QC,2),GC=VC[0],KC=VC[1];GC[28]=258,KC[258]=28;for(var WC=kC(UC,0)[1],zC=new NC(32768),$C=0;$C<32768;++$C){var XC=(43690&$C)>>>1|(21845&$C)<<1;XC=(61680&(XC=(52428&XC)>>>2|(13107&XC)<<2))>>>4|(3855&XC)<<4,zC[$C]=((65280&XC)>>>8|(255&XC)<<8)>>>1}var jC=function(t,e,s){for(var i=t.length,r=0,n=new NC(e);r<i;++r)t[r]&&++n[t[r]-1];var o,a=new NC(e);for(r=0;r<e;++r)a[r]=a[r-1]+n[r-1]<<1;if(s){o=new NC(1<<e);var A=15-e;for(r=0;r<i;++r)if(t[r])for(var l=r<<4|t[r],h=e-t[r],d=a[t[r]-1]++<<h,c=d|(1<<h)-1;d<=c;++d)o[zC[d]>>>A]=l}else for(o=new NC(i),r=0;r<i;++r)t[r]&&(o[r]=zC[a[t[r]-1]++]>>>15-t[r]);return o},YC=new LC(288);for($C=0;$C<144;++$C)YC[$C]=8;for($C=144;$C<256;++$C)YC[$C]=9;for($C=256;$C<280;++$C)YC[$C]=7;for($C=280;$C<288;++$C)YC[$C]=8;var JC=new LC(32);for($C=0;$C<32;++$C)JC[$C]=5;var ZC=jC(YC,9,0),qC=jC(JC,5,0),tb=function(t){return(t+7)/8|0},eb=function(t,e,s){(null==e||e<0)&&(e=0),(null==s||s>t.length)&&(s=t.length);var i=new(2==t.BYTES_PER_ELEMENT?NC:4==t.BYTES_PER_ELEMENT?HC:LC)(s-e);return i.set(t.subarray(e,s)),i},sb=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ib=function(t,e,s){var i=new Error(e||sb[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,ib),!s)throw i;return i},rb=function(t,e,s){s<<=7&e;var i=e/8|0;t[i]|=s,t[i+1]|=s>>>8},nb=function(t,e,s){s<<=7&e;var i=e/8|0;t[i]|=s,t[i+1]|=s>>>8,t[i+2]|=s>>>16},ob=function(t,e){for(var s=[],i=0;i<t.length;++i)t[i]&&s.push({s:i,f:t[i]});var r=s.length,n=s.slice();if(!r)return[ub,0];if(1==r){var o=new LC(s[0].s+1);return o[s[0].s]=1,[o,1]}s.sort((function(t,e){return t.f-e.f})),s.push({s:-1,f:25001});var a=s[0],A=s[1],l=0,h=1,d=2;for(s[0]={s:-1,f:a.f+A.f,l:a,r:A};h!=r-1;)a=s[s[l].f<s[d].f?l++:d++],A=s[l!=h&&s[l].f<s[d].f?l++:d++],s[h++]={s:-1,f:a.f+A.f,l:a,r:A};var c=n[0].s;for(i=1;i<r;++i)n[i].s>c&&(c=n[i].s);var u=new NC(c+1),p=ab(s[h-1],u,0);if(p>e){i=0;var _=0,g=p-e,f=1<<g;for(n.sort((function(t,e){return u[e.s]-u[t.s]||t.f-e.f}));i<r;++i){var m=n[i].s;if(!(u[m]>e))break;_+=f-(1<<p-u[m]),u[m]=e}for(_>>>=g;_>0;){var w=n[i].s;u[w]<e?_-=1<<e-u[w]++-1:++i}for(;i>=0&&_;--i){var y=n[i].s;u[y]==e&&(--u[y],++_)}p=e}return[new LC(u),p]},ab=function(t,e,s){return-1==t.s?Math.max(ab(t.l,e,s+1),ab(t.r,e,s+1)):e[t.s]=s},Ab=function(t){for(var e=t.length;e&&!t[--e];);for(var s=new NC(++e),i=0,r=t[0],n=1,o=function(t){s[i++]=t},a=1;a<=e;++a)if(t[a]==r&&a!=e)++n;else{if(!r&&n>2){for(;n>138;n-=138)o(32754);n>2&&(o(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(o(r),--n;n>6;n-=6)o(8304);n>2&&(o(n-3<<5|8208),n=0)}for(;n--;)o(r);n=1,r=t[a]}return[s.subarray(0,i),e]},lb=function(t,e){for(var s=0,i=0;i<e.length;++i)s+=t[i]*e[i];return s},hb=function(t,e,s){var i=s.length,r=tb(e+2);t[r]=255&i,t[r+1]=i>>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var n=0;n<i;++n)t[r+n+4]=s[n];return 8*(r+4+i)},db=function(t,e,s,i,r,n,o,a,A,l,h){rb(e,h++,s),++r[256];for(var d=ob(r,15),c=d[0],u=d[1],p=ob(n,15),_=p[0],g=p[1],f=Ab(c),m=f[0],w=f[1],y=Ab(_),C=y[0],b=y[1],v=new NC(19),B=0;B<m.length;++B)v[31&m[B]]++;for(B=0;B<C.length;++B)v[31&C[B]]++;for(var E=ob(v,7),P=E[0],x=E[1],S=19;S>4&&!P[MC[S-1]];--S);var I,R,T,O,F=l+5<<3,D=lb(r,YC)+lb(n,JC)+o,L=lb(r,c)+lb(n,_)+o+14+3*S+lb(v,P)+(2*v[16]+3*v[17]+7*v[18]);if(F<=D&&F<=L)return hb(e,h,t.subarray(A,A+l));if(rb(e,h,1+(L<D)),h+=2,L<D){I=jC(c,u,0),R=c,T=jC(_,g,0),O=_;var N=jC(P,x,0);rb(e,h,w-257),rb(e,h+5,b-1),rb(e,h+10,S-4),h+=14;for(B=0;B<S;++B)rb(e,h+3*B,P[MC[B]]);h+=3*S;for(var H=[m,C],Q=0;Q<2;++Q){var U=H[Q];for(B=0;B<U.length;++B){var M=31&U[B];rb(e,h,N[M]),h+=P[M],M>15&&(rb(e,h,U[B]>>>5&127),h+=U[B]>>>12)}}}else I=ZC,R=YC,T=qC,O=JC;for(B=0;B<a;++B)if(i[B]>255){M=i[B]>>>18&31;nb(e,h,I[M+257]),h+=R[M+257],M>7&&(rb(e,h,i[B]>>>23&31),h+=QC[M]);var k=31&i[B];nb(e,h,T[k]),h+=O[k],k>3&&(nb(e,h,i[B]>>>5&8191),h+=UC[k])}else nb(e,h,I[i[B]]),h+=R[i[B]];return nb(e,h,I[256]),h+R[256]},cb=new HC([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ub=new LC(0),pb=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var s=e,i=9;--i;)s=(1&s&&-306674912)^s>>>1;t[e]=s}return t}(),_b=function(){var t=-1;return{p:function(e){for(var s=t,i=0;i<e.length;++i)s=pb[255&s^e[i]]^s>>>8;t=s},d:function(){return~t}}},gb=function(t,e,s,i,r){return function(t,e,s,i,r,n){var o=t.length,a=new LC(i+o+5*(1+Math.ceil(o/7e3))+r),A=a.subarray(i,a.length-r),l=0;if(!e||o<8)for(var h=0;h<=o;h+=65535){var d=h+65535;d>=o&&(A[l>>3]=n),l=hb(A,l+1,t.subarray(h,d))}else{for(var c=cb[e-1],u=c>>>13,p=8191&c,_=(1<<s)-1,g=new NC(32768),f=new NC(_+1),m=Math.ceil(s/3),w=2*m,y=function(e){return(t[e]^t[e+1]<<m^t[e+2]<<w)&_},C=new HC(25e3),b=new NC(288),v=new NC(32),B=0,E=0,P=(h=0,0),x=0,S=0;h<o;++h){var I=y(h),R=32767&h,T=f[I];if(g[R]=T,f[I]=R,x<=h){var O=o-h;if((B>7e3||P>24576)&&O>423){l=db(t,A,0,C,b,v,E,P,S,h-S,l),P=B=E=0,S=h;for(var F=0;F<286;++F)b[F]=0;for(F=0;F<30;++F)v[F]=0}var D=2,L=0,N=p,H=R-T&32767;if(O>2&&I==y(h-H))for(var Q=Math.min(u,O)-1,U=Math.min(32767,h),M=Math.min(258,O);H<=U&&--N&&R!=T;){if(t[h+D]==t[h+D-H]){for(var k=0;k<M&&t[h+k]==t[h+k-H];++k);if(k>D){if(D=k,L=H,k>Q)break;var V=Math.min(H,k-2),G=0;for(F=0;F<V;++F){var K=h-H+F+32768&32767,W=K-g[K]+32768&32767;W>G&&(G=W,T=K)}}}H+=(R=T)-(T=g[R])+32768&32767}if(L){C[P++]=268435456|KC[D]<<18|WC[L];var z=31&KC[D],$=31&WC[L];E+=QC[z]+UC[$],++b[257+z],++v[$],x=h+D,++B}else C[P++]=t[h],++b[t[h]]}}l=db(t,A,n,C,b,v,E,P,S,h-S,l),!n&&7&l&&(l=hb(A,l+1,ub))}return eb(a,0,i+tb(l)+r)}(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,s,i,!r)},fb=function(t,e){var s={};for(var i in t)s[i]=t[i];for(var i in e)s[i]=e[i];return s},mb=function(t,e,s){for(;s;++e)t[e]=s,s>>>=8};function wb(t,e){return gb(t,e||{},0,0)}var yb=function(t,e,s,i){for(var r in t){var n=t[r],o=e+r,a=i;Array.isArray(n)&&(a=fb(i,n[1]),n=n[0]),n instanceof LC?s[o]=[n,a]:(s[o+="/"]=[new LC(0),a],yb(n,o,s,i))}},Cb="undefined"!=typeof TextEncoder&&new TextEncoder,bb="undefined"!=typeof TextDecoder&&new TextDecoder;try{bb.decode(ub,{stream:!0})}catch(t){}function vb(t,e){if(e){for(var s=new LC(t.length),i=0;i<t.length;++i)s[i]=t.charCodeAt(i);return s}if(Cb)return Cb.encode(t);var r=t.length,n=new LC(t.length+(t.length>>1)),o=0,a=function(t){n[o++]=t};for(i=0;i<r;++i){if(o+5>n.length){var A=new LC(o+8+(r-i<<1));A.set(n),n=A}var l=t.charCodeAt(i);l<128||e?a(l):l<2048?(a(192|l>>6),a(128|63&l)):l>55295&&l<57344?(a(240|(l=65536+(1047552&l)|1023&t.charCodeAt(++i))>>18),a(128|l>>12&63),a(128|l>>6&63),a(128|63&l)):(a(224|l>>12),a(128|l>>6&63),a(128|63&l))}return eb(n,0,o)}var Bb=function(t){var e=0;if(t)for(var s in t){var i=t[s].length;i>65535&&ib(9),e+=i+4}return e},Eb=function(t,e,s,i,r,n,o,a){var A=i.length,l=s.extra,h=a&&a.length,d=Bb(l);mb(t,e,null!=o?33639248:67324752),e+=4,null!=o&&(t[e++]=20,t[e++]=s.os),t[e]=20,e+=2,t[e++]=s.flag<<1|(null==n&&8),t[e++]=r&&8,t[e++]=255&s.compression,t[e++]=s.compression>>8;var c=new Date(null==s.mtime?Date.now():s.mtime),u=c.getFullYear()-1980;if((u<0||u>119)&&ib(10),mb(t,e,u<<25|c.getMonth()+1<<21|c.getDate()<<16|c.getHours()<<11|c.getMinutes()<<5|c.getSeconds()>>>1),e+=4,null!=n&&(mb(t,e,s.crc),mb(t,e+4,n),mb(t,e+8,s.size)),mb(t,e+12,A),mb(t,e+14,d),e+=16,null!=o&&(mb(t,e,h),mb(t,e+6,s.attrs),mb(t,e+10,o),e+=14),t.set(i,e),e+=A,d)for(var p in l){var _=l[p],g=_.length;mb(t,e,+p),mb(t,e+2,g),t.set(_,e+4),e+=4+g}return h&&(t.set(a,e),e+=h),e};function Pb(t,e){e||(e={});var s={},i=[];yb(t,"",s,e);var r=0,n=0;for(var o in s){var a=s[o],A=a[0],l=a[1],h=0==l.level?0:8,d=(v=vb(o)).length,c=l.comment,u=c&&vb(c),p=u&&u.length,_=Bb(l.extra);d>65535&&ib(11);var g=h?wb(A,l):A,f=g.length,m=_b();m.p(A),i.push(fb(l,{size:A.length,crc:m.d(),c:g,f:v,m:u,u:d!=o.length||u&&c.length!=p,o:r,compression:h})),r+=30+d+_+f,n+=76+2*(d+_)+(p||0)+f}for(var w=new LC(n+22),y=r,C=n-r,b=0;b<i.length;++b){var v=i[b];Eb(w,v.o,v,v.f,v.u,v.c.length);var B=30+v.f.length+Bb(v.extra);w.set(v.c,v.o+B),Eb(w,r,v,v.f,v.u,v.c.length,v.o,v.m),r+=16+B+(v.m?v.m.length:0)}return function(t,e,s,i,r){mb(t,e,101010256),mb(t,e+8,s),mb(t,e+10,s),mb(t,e+12,i),mb(t,e+16,r)}(w,r,i.length,C,y),w}var xb=Ah((function(t,e){t.exports=function t(e,s,i){var r,n,o=window,a="application/octet-stream",A=i||a,l=e,h=!s&&!i&&l,d=document.createElement("a"),c=function(t){return String(t)},u=o.Blob||o.MozBlob||o.WebKitBlob||c,p=s||"download";if(u=u.call?u.bind(o):Blob,"true"===String(this)&&(A=(l=[l,A])[0],l=l[1]),h&&h.length<2048&&(p=h.split("/").pop().split("?")[0],d.href=h,-1!==d.href.indexOf(h))){var _=new XMLHttpRequest;return _.open("GET",h,!0),_.responseType="blob",_.onload=function(e){t(e.target.response,p,a)},setTimeout((function(){_.send()}),0),_}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l)){if(!(l.length>2096103.424&&u!==c))return navigator.msSaveBlob?navigator.msSaveBlob(w(l),p):y(l);A=(l=w(l)).type||a}else if(/([\x80-\xff])/.test(l)){for(var g=0,f=new Uint8Array(l.length),m=f.length;g<m;++g)f[g]=l.charCodeAt(g);l=new u([f],{type:A})}function w(t){for(var e=t.split(/[:;,]/),s=e[1],i=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),r=i.length,n=0,o=new Uint8Array(r);n<r;++n)o[n]=i.charCodeAt(n);return new u([o],{type:s})}function y(t,e){if("download"in d)return d.href=t,d.setAttribute("download",p),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===e&&setTimeout((function(){o.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,a)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var s=document.createElement("iframe");document.body.appendChild(s),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,a)),s.src=t,setTimeout((function(){document.body.removeChild(s)}),333)}if(r=l instanceof u?l:new u([l],{type:A}),navigator.msSaveBlob)return navigator.msSaveBlob(r,p);if(o.URL)y(o.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===c)try{return y("data:"+A+";base64,"+o.btoa(r))}catch(t){return y("data:"+A+","+encodeURIComponent(r))}(n=new FileReader).onload=function(t){y(this.result)},n.readAsDataURL(r)}return!0}})),Sb=Ah((function(t,e){t.exports=function(){function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}var s=void 0;s=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var i=s,r=0,n=void 0,o=void 0,a=function(t,e){y[r]=t,y[r+1]=e,2===(r+=2)&&(o?o(C):v())};function A(t){o=t}function l(t){a=t}var h="undefined"!=typeof window?window:void 0,d=h||{},c=d.MutationObserver||d.WebKitMutationObserver,u="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function _(){return function(){return process.nextTick(C)}}function g(){return void 0!==n?function(){n(C)}:w()}function f(){var t=0,e=new c(C),s=document.createTextNode("");return e.observe(s,{characterData:!0}),function(){s.data=t=++t%2}}function m(){var t=new MessageChannel;return t.port1.onmessage=C,function(){return t.port2.postMessage(0)}}function w(){var t=setTimeout;return function(){return t(C,1)}}var y=new Array(1e3);function C(){for(var t=0;t<r;t+=2)(0,y[t])(y[t+1]),y[t]=void 0,y[t+1]=void 0;r=0}function b(){try{var t=Function("return this")().require("vertx");return n=t.runOnLoop||t.runOnContext,g()}catch(t){return w()}}var v=void 0;function B(t,e){var s=this,i=new this.constructor(x);void 0===i[P]&&$(i);var r=s._state;if(r){var n=arguments[r-1];a((function(){return G(r,i,n,s._result)}))}else k(s,i,t,e);return i}function E(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var s=new e(x);return H(s,t),s}v=u?_():c?f():p?m():void 0===h?b():w();var P=Math.random().toString(36).substring(2);function x(){}var S=void 0,I=1,R=2;function T(){return new TypeError("You cannot resolve a promise with itself")}function O(){return new TypeError("A promises callback cannot return that same promise.")}function F(t,e,s,i){try{t.call(e,s,i)}catch(t){return t}}function D(t,e,s){a((function(t){var i=!1,r=F(s,e,(function(s){i||(i=!0,e!==s?H(t,s):U(t,s))}),(function(e){i||(i=!0,M(t,e))}));!i&&r&&(i=!0,M(t,r))}),t)}function L(t,e){e._state===I?U(t,e._result):e._state===R?M(t,e._result):k(e,void 0,(function(e){return H(t,e)}),(function(e){return M(t,e)}))}function N(t,s,i){s.constructor===t.constructor&&i===B&&s.constructor.resolve===E?L(t,s):void 0===i?U(t,s):e(i)?D(t,s,i):U(t,s)}function H(e,s){if(e===s)M(e,T());else if(t(s)){var i=void 0;try{i=s.then}catch(t){return void M(e,t)}N(e,s,i)}else U(e,s)}function Q(t){t._onerror&&t._onerror(t._result),V(t)}function U(t,e){t._state===S&&(t._result=e,t._state=I,0!==t._subscribers.length&&a(V,t))}function M(t,e){t._state===S&&(t._state=R,t._result=e,a(Q,t))}function k(t,e,s,i){var r=t._subscribers,n=r.length;t._onerror=null,r[n]=e,r[n+I]=s,r[n+R]=i,0===n&&t._state&&a(V,t)}function V(t){var e=t._subscribers,s=t._state;if(0!==e.length){for(var i=void 0,r=void 0,n=t._result,o=0;o<e.length;o+=3)i=e[o],r=e[o+s],i?G(s,i,r,n):r(n);t._subscribers.length=0}}function G(t,s,i,r){var n=e(i),o=void 0,a=void 0,A=!0;if(n){try{o=i(r)}catch(t){A=!1,a=t}if(s===o)return void M(s,O())}else o=r;s._state!==S||(n&&A?H(s,o):!1===A?M(s,a):t===I?U(s,o):t===R&&M(s,o))}function K(t,e){try{e((function(e){H(t,e)}),(function(e){M(t,e)}))}catch(e){M(t,e)}}var W=0;function z(){return W++}function $(t){t[P]=W++,t._state=void 0,t._result=void 0,t._subscribers=[]}function X(){return new Error("Array Methods must be provided an Array")}var j=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(x),this.promise[P]||$(this.promise),i(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?U(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&U(this.promise,this._result))):M(this.promise,X())}return t.prototype._enumerate=function(t){for(var e=0;this._state===S&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var s=this._instanceConstructor,i=s.resolve;if(i===E){var r=void 0,n=void 0,o=!1;try{r=t.then}catch(t){o=!0,n=t}if(r===B&&t._state!==S)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(s===et){var a=new s(x);o?M(a,n):N(a,t,r),this._willSettleAt(a,e)}else this._willSettleAt(new s((function(e){return e(t)})),e)}else this._willSettleAt(i(t),e)},t.prototype._settledAt=function(t,e,s){var i=this.promise;i._state===S&&(this._remaining--,t===R?M(i,s):this._result[e]=s),0===this._remaining&&U(i,this._result)},t.prototype._willSettleAt=function(t,e){var s=this;k(t,void 0,(function(t){return s._settledAt(I,e,t)}),(function(t){return s._settledAt(R,e,t)}))},t}();function Y(t){return new j(this,t).promise}function J(t){var e=this;return i(t)?new e((function(s,i){for(var r=t.length,n=0;n<r;n++)e.resolve(t[n]).then(s,i)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))}function Z(t){var e=new this(x);return M(e,t),e}function q(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function tt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var et=function(){function t(e){this[P]=z(),this._result=this._state=void 0,this._subscribers=[],x!==e&&("function"!=typeof e&&q(),this instanceof t?K(this,e):tt())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var s=this,i=s.constructor;return e(t)?s.then((function(e){return i.resolve(t()).then((function(){return e}))}),(function(e){return i.resolve(t()).then((function(){throw e}))})):s.then(t,t)},t}();function st(){var t=void 0;if(void 0!==oh)t=oh;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var s=null;try{s=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===s&&!e.cast)return}t.Promise=et}return et.prototype.then=B,et.all=Y,et.race=J,et.resolve=E,et.reject=Z,et._setScheduler=A,et._setAsap=l,et._asap=a,et.polyfill=st,et.Promise=et,et}()}));const Ib=[12,1,-1,9,1,-2,10,1,-2,11,1,-2,12,0,-2],Rb=function(t,e,s){return{codeLen:t,code:e,runLength:s}},Tb=function(t){const e=[];for(let s=0,i=t.length;s<i;s+=3)e.push({codeLen:t[s],code:t[s+1],runLength:t[s+2]});return e},Ob=[Tb([8,53,0,6,7,1,4,7,2,4,8,3,4,11,4,4,12,5,4,14,6,4,15,7,5,19,8,5,20,9,5,7,10,5,8,11,6,8,12,6,3,13,6,52,14,6,53,15,6,42,16,6,43,17,7,39,18,7,12,19,7,8,20,7,23,21,7,3,22,7,4,23,7,40,24,7,43,25,7,19,26,7,36,27,7,24,28,8,2,29,8,3,30,8,26,31,8,27,32,8,18,33,8,19,34,8,20,35,8,21,36,8,22,37,8,23,38,8,40,39,8,41,40,8,42,41,8,43,42,8,44,43,8,45,44,8,4,45,8,5,46,8,10,47,8,11,48,8,82,49,8,83,50,8,84,51,8,85,52,8,36,53,8,37,54,8,88,55,8,89,56,8,90,57,8,91,58,8,74,59,8,75,60,8,50,61,8,51,62,8,52,63]),Tb([10,55,0,3,2,1,2,3,2,2,2,3,3,3,4,4,3,5,4,2,6,5,3,7,6,5,8,6,4,9,7,4,10,7,5,11,7,7,12,8,4,13,8,7,14,9,24,15,10,23,16,10,24,17,10,8,18,11,103,19,11,104,20,11,108,21,11,55,22,11,40,23,11,23,24,11,24,25,12,202,26,12,203,27,12,204,28,12,205,29,12,104,30,12,105,31,12,106,32,12,107,33,12,210,34,12,211,35,12,212,36,12,213,37,12,214,38,12,215,39,12,108,40,12,109,41,12,218,42,12,219,43,12,84,44,12,85,45,12,86,46,12,87,47,12,100,48,12,101,49,12,82,50,12,83,51,12,36,52,12,55,53,12,56,54,12,39,55,12,40,56,12,88,57,12,89,58,12,43,59,12,44,60,12,90,61,12,102,62,12,103,63])],Fb=[Tb([5,27,64,5,18,128,6,23,192,7,55,256,8,54,320,8,55,384,8,100,448,8,101,512,8,104,576,8,103,640,9,204,704,9,205,768,9,210,832,9,211,896,9,212,960,9,213,1024,9,214,1088,9,215,1152,9,216,1216,9,217,1280,9,218,1344,9,219,1408,9,152,1472,9,153,1536,9,154,1600,6,24,1664,9,155,1728,11,8,1792,11,12,1856,11,13,1920,12,18,1984,12,19,2048,12,20,2112,12,21,2176,12,22,2240,12,23,2304,12,28,2368,12,29,2432,12,30,2496,12,31,2560]),Tb([10,15,64,12,200,128,12,201,192,12,91,256,12,51,320,12,52,384,12,53,448,13,108,512,13,109,576,13,74,640,13,75,704,13,76,768,13,77,832,13,114,896,13,115,960,13,116,1024,13,117,1088,13,118,1152,13,119,1216,13,82,1280,13,83,1344,13,84,1408,13,85,1472,13,90,1536,13,91,1600,13,100,1664,13,101,1728,11,8,1792,11,12,1856,11,13,1920,12,18,1984,12,19,2048,12,20,2112,12,21,2176,12,22,2240,12,23,2304,12,28,2368,12,29,2432,12,30,2496,12,31,2560])],Db=Tb(Ib),Lb=Rb(4,1,0),Nb=Rb(3,1,0),Hb=Tb([7,3,0,6,3,0,3,3,0,1,1,0,3,2,0,6,2,0,7,2,0]);var Qb;!function(t){t.GROUP_3="g3",t.GROUP_3_2D="g3-2d",t.GROUP_4="g4"}(Qb||(Qb={}));const Ub=[128,64,32,16,8,4,2,1],Mb=[240,15];class kb{constructor(t,e){if(1!==t&&4!==t&&8!==t)throw new Error("Invalid bps: "+t);this._bps=t,this._pixels=e,this._bytes=this.bytesOfPixels(e),this._dv=new DataView(new ArrayBuffer(this._bytes))}get byteLength(){return this._bytes}bytesOfPixels(t){return(t*this._bps+7)/8|0}prepare(t,e){for(let s=0;s<this._bytes;s++)this._dv.setUint8(s,t[e+s]);return this}clear(){for(let t=0;t<this._bytes;t++)this._dv.setUint8(t,0);return this}getRow(t){return new Uint8Array(this._dv.buffer.slice(0,this.bytesOfPixels(t)))}getByte(t){return this._dv.getUint8(t)}getBytes(t){return new Uint8Array(this._dv.buffer.slice(0,t))}getPixel(t){const e=t*this._bps,s=e/8|0,i=e%8,r=this._dv.getUint8(s);return 1===this._bps?r&Ub[i]:4===this._bps?r&Mb[i]:r}getBit(t){const e=t/8|0,s=t%8;return this._dv.getUint8(e)&Ub[s]?1:0}setBits(t,e,s){const i=s-1;let r=t/8|0,n=t%8,o=0;for(;o<s;)try{let t=this._dv.getUint8(r);for(;n<8&&o<s;){t&=255&~(1<<7-n),t|=(e&1<<i-o?1:0)<<7-n,o++,n++}this._dv.setUint8(r,t),r++,n=0}catch(t){}}setString(t,e){const s=e.length;let i=0;for(let t=0;t<s;t++){i+=("0"===e.charAt(t)?0:1)<<s-1-t}this.setBits(t,i,s)}getBits(t,e){const s=e-1;let i=t/8|0,r=t%8,n=0,o=0;for(;o<e;){const t=this._dv.getUint8(i);for(;r<8&&o<e;){n|=(t&Ub[r]?1:0)<<s-o,o++,r++}i++,r=0}return n}getSpan(t){const e=this._dv.byteLength;let s=t/8|0,i=t%8,r=this._dv.getUint8(s);const n=r&Ub[i++]?1:0;let o=1;for(;s<e;){for(;i<8;){if((r&Ub[i++]?1:0)!==n)return o;o++}s++,i=0,s<e&&(r=this._dv.getUint8(s))}return o}toString(){let t="";for(let e=0,s=this._dv.byteLength;e<s;e++){const s=this._dv.getUint8(e);for(let e=0;e<8;e++){t+=s&1<<7-e?1:0}}return t}}class Vb{constructor(){}static encodePixcels(t,e){return e.scheme===Qb.GROUP_4?(new Kb).encode(t,e):(new Gb).encode(t,e)}encode(t,e){return this._wPixels=e.columns,this._doEncode(t,e)}_encodeLine1D(t,e,s,i){let r=0,n=0,o=0,a=0;const A=Db[0];if(e.setBits(n,A.code,A.codeLen),n+=A.codeLen,i&&(e.setBits(n,1,1),n+=1),1===t.getBit(0)){const t=Ob[0][0];e.setBits(n,t.code,t.codeLen),n+=t.codeLen,o=1}for(;r<s;){const s=t.getSpan(r);if(s<64){const t=Ob[o][s];e.setBits(n,t.code,t.codeLen),n+=t.codeLen,a+=t.runLength}else if(s<2624){const t=Fb[o][(s-64)/64|0];e.setBits(n,t.code,t.codeLen),n+=t.codeLen,a+=t.runLength;const i=Ob[o][s%64];e.setBits(n,i.code,i.codeLen),n+=i.codeLen,a+=i.runLength}r+=s,o=1-o}return a!==s&&console.log(a),n}$_findDiff(t,e,s){let i=e;for(;i<this._wPixels;i++)if(t.getBit(i)!==s)return i;return i}$_setSpan(t,e,s,i){let r=0;if(s<64){const n=Ob[i][s];t.setBits(e,n.code,n.codeLen),r+=n.codeLen}else if(s<2624){const n=Fb[i][(s-64)/64|0];t.setBits(e,n.code,n.codeLen),e+=n.codeLen,r+=n.codeLen;const o=Ob[i][s%64];t.setBits(e,o.code,o.codeLen),r+=o.codeLen}return r}_encodeLine2D(t,e,s,i){let r=0,n=0!==e.getBit(0)?0:this.$_findDiff(e,0,0),o=0!==t.getBit(0)?0:this.$_findDiff(t,0,0),a=0;for(;;){const A=o<i?this.$_findDiff(t,o,t.getBit(o)):i;if(A>=n){const t=o-n;if(t>=-3&&t<=3){const e=Hb[t+3];s.setBits(a,e.code,e.codeLen),a+=e.codeLen,r=n}else{const t=n<i?this.$_findDiff(e,n,e.getBit(n)):i;s.setBits(a,Nb.code,Nb.codeLen),a+=Nb.codeLen,r+n===0||0===e.getBit(r)?(a+=this.$_setSpan(s,a,n-r,0),a+=this.$_setSpan(s,a,t-n,1)):(a+=this.$_setSpan(s,a,n-r,1),a+=this.$_setSpan(s,a,t-n,0)),r=t}}else s.setBits(a,Lb.code,Lb.codeLen),a+=Lb.codeLen,r=A;if(r>=i)break;const l=e.getBit(r);n=this.$_findDiff(e,r,l),o=this.$_findDiff(t,r,1-l),o=this.$_findDiff(t,o,l)}return a}}class Gb extends Vb{_doEncode(t,e){const s=e.columns,i=e.height;return e.scheme===Qb.GROUP_3?this.$_encode1D(t,s,i):this.$_encode2D(t,s,i)}$_encode1D(t,e,s){const i=[],r=[],n=new kb(1,e),o=n.byteLength,a=new kb(1,4*e);for(let A=0;A<s;A++){const s=this._encodeLine1D(n.prepare(t,o*A),a.clear(),e,!1),l=a.bytesOfPixels(s);i.push(l),r.push(a.getBytes(l))}const A=r.map((t=>t.length)).reduce(((t,e)=>t+e),0),l=new Uint8Array(new ArrayBuffer(A));for(let t=0,e=0;t<s;t++)l.set(r[t],e),e+=i[t];return{counts:i,rows:l}}$_encode2D(t,e,s){const i=[],r=[],n=new kb(1,e),o=n.byteLength,a=new kb(1,4*e);for(let A=0;A<s;A++){const s=this._encodeLine1D(n.prepare(t,o*A),a.clear(),e,!0),l=a.bytesOfPixels(s);i.push(l),r.push(a.getBytes(l))}const A=r.map((t=>t.length)).reduce(((t,e)=>t+e),0),l=new Uint8Array(new ArrayBuffer(A));for(let t=0,e=0;t<s;t++)l.set(r[t],e),e+=i[t];return{counts:i,rows:l}}}class Kb extends Vb{_doEncode(t,e){const s=e.columns,i=e.height,r=[],n=[];let o=new kb(1,s).clear();const a=new kb(1,s),A=a.byteLength,l=new kb(1,4*s);for(let e=0;e<i;e++){const i=this._encodeLine2D(o,a.prepare(t,A*e),l.clear(),s),h=l.bytesOfPixels(i);r.push(h),n.push(l.getBytes(h))}const h=n.map((t=>t.length)).reduce(((t,e)=>t+e),0),d=new Uint8Array(new ArrayBuffer(h));for(let t=0,e=0;t<i;t++)d.set(n[t],e),e+=r[t];return{counts:r,rows:d}}}const Wb=500;class zb{constructor(){this._curr=0}encode(t,e){const s=8+Wb*t.length+t.map((t=>J.toEven(8*t.encoded.counts.length+t.encoded.rows.length))).reduce(((t,e)=>t+e),0),i=new ArrayBuffer(s),r=this._dv=new DataView(i);return this.$_writeHeader(r),t.forEach(((t,s,i)=>this.$_writeIFD(t,e,s,i.length))),i}seek(t){this._curr=t}skip(t){this._curr+=t}set16(t){this._dv.setInt16(this._curr,t),this._curr+=2}setU16(t){this._dv.setUint16(this._curr,t),this._curr+=2}set32(t){this._dv.setInt32(this._curr,t),this._curr+=4}setU32(t){this._dv.setUint32(this._curr,t),this._curr+=4}setStr(t){for(let e=0,s=t.length;e<s;e++)this._dv.setUint8(this._curr++,255&t.charCodeAt(e));1&this._curr&&this._curr++}strLen(t){return J.toEven(t.length)}dateStr(t){function e(t){return t<10?"0"+t:String(t)}return t.getFullYear()+":"+e(t.getMonth()+1)+":"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())}$_writeHeader(t){this.set16(19789),this.set16(42),this.set32(8)}$_writeIFD(t,e,s,i){const r=s===i-1,n=t.width,o=t.height,a=e.encoding===Qb.GROUP_3_2D||e.encoding===Qb.GROUP_3?3:4,A=this._curr,l=t.encoded.counts,h=l.length,d=t.encoded.rows,c=r?0:J.toEven(A+Wb+8*l.length+d.length);this._entryCount=0,this._pointer=0,this._pointers=[],this.skip(2),this.$_addVal(256,3,1,n),this.$_addVal(257,3,1,o),this.$_addVal(259,3,1,a),this.$_addVal(262,3,1,0),this.$_addVal(266,3,1,1),this.$_addVal(273,4,h,A+Wb+4*h),this.$_addVal(277,3,1,1),this.$_addVal(278,3,1,1),this.$_addVal(279,4,h,A+Wb),this.$_addOff(282,5,1,8),this.$_addOff(283,5,1,8),this.$_addVal(292,4,1,1),this.$_addVal(296,3,1,2),this.set32(c),this.set32(e.dpi||204),this.set32(1),this.set32(e.dpi||196),this.set32(1);let u=A+2+12*this._entryCount+4;this._pointers.forEach((t=>{const e=this._dv.getUint32(t);this._dv.setUint32(t,u+e)}));const p=this._curr;this.seek(A),this.setU16(this._entryCount),this.seek(p),this.seek(A+Wb);for(let t=0;t<h;t++)this.setU32(l[t]);for(let t=0,e=this._curr+4*h;t<h;t++)this.setU32(e),e+=l[t];this._curr;new Uint8Array(this._dv.buffer).set(t.encoded.rows,this._curr),r||this.seek(c)}$_addVal(t,e,s,i){this.set16(t),this.set16(e),this.set32(s),3===e&&1===s?(this.set16(i),this.set16(0)):this.set32(i),this._entryCount++}$_addOff(t,e,s,i){this.set16(t),this.set16(e),this.set32(s),this._pointers.push(this._curr),this.set32(this._pointer),this._pointer+=i,this._entryCount++}}class $b{constructor(){}encode(t,e){e.encoding=e.encoding||Qb.GROUP_4;const s=this.$_getImages(t,e.encoding),i=(new zb).encode(s,e);return[new Uint8Array(i)]}$_getImages(t,e){const s=[];return t.forEach(((t,i)=>{const r=t.width,n=t.height,o=t.getContext("2d").getImageData(0,0,r,n).data,a=o.length,A=Math.floor((r+7)/8)*n,l=new Uint8Array(A),h=new DataView(l.buffer);let d=0,c=0;for(;d<a;){let t=0;for(;c<A&&d<a&&t<r;){let e=0;for(let s=0;s<8&&d<a&&t<r;s++,t++)if(o[d+3]>0){const t=o[d++],i=o[d++],r=o[d++];d++,e+=(255===t&&255===i&&255===r?0:1)<<7-s}else d+=4;h.setUint8(c++,e)}}l.length;const u=Vb.encodePixcels(l,{scheme:e,width:32*t.width,height:t.height,columns:t.width});s.push({index:i,width:t.width,height:t.height,imageData:l,length:J.toEven(A),encoded:u})})),s}}function Xb(t){return~~t}var jb=256,Yb=1024,Jb=1<<18;var Zb=function(t,e){var s,i,r,n,o;function a(t,e,i,r,n){s[e][0]-=t*(s[e][0]-i)/Yb,s[e][1]-=t*(s[e][1]-r)/Yb,s[e][2]-=t*(s[e][2]-n)/Yb}function A(t,e,i,r,n){for(var a,A,l=Math.abs(e-t),h=Math.min(e+t,jb),d=e+1,c=e-1,u=1;d<h||c>l;)A=o[u++],d<h&&((a=s[d++])[0]-=A*(a[0]-i)/Jb,a[1]-=A*(a[1]-r)/Jb,a[2]-=A*(a[2]-n)/Jb),c>l&&((a=s[c--])[0]-=A*(a[0]-i)/Jb,a[1]-=A*(a[1]-r)/Jb,a[2]-=A*(a[2]-n)/Jb)}function l(t,e,i){var o,a,A,l,h,d=~(1<<31),c=d,u=-1,p=u;for(o=0;o<32;o++)a=s[o],(A=Math.abs(a[0]-t)+Math.abs(a[1]-e)+Math.abs(a[2]-i))<d&&(d=A,u=o),(l=A-(r[o]>>12))<c&&(c=l,p=o),h=n[o]>>10,n[o]-=h,r[o]+=h<<10;return n[u]+=64,r[u]-=65536,p}this.buildColormap=function(){!function(){var t,e;for(s=[],i=[],r=[],n=[],o=[],t=0;t<jb;t++)e=(t<<12)/jb,s[t]=[e,e,e],n[t]=256,r[t]=0}(),function(){var s,i,r,n,h,d,c=t.length,u=Xb(30+(e-1)/3),p=Xb(c/(3*e)),_=Xb(p/100),g=Yb,f=2048,m=f>>6;for(m<=1&&(m=0),s=0;s<m;s++)o[s]=Xb(g*(256*(m*m-s*s)/(m*m)));c<1509?(e=1,i=3):i=c%499!=0?1497:c%491!=0?1473:c%487!=0?1461:1509;var w=0;for(s=0;s<p;)if(a(g,d=l(r=(255&t[w])<<4,n=(255&t[w+1])<<4,h=(255&t[w+2])<<4),r,n,h),0!==m&&A(m,d,r,n,h),(w+=i)>=c&&(w-=c),0===_&&(_=1),++s%_==0)for(g-=g/u,(m=(f-=f/30)>>6)<=1&&(m=0),d=0;d<m;d++)o[d]=~~(g*(256*(m*m-d*d)/(m*m)))}(),function(){for(var t=0;t<jb;t++)s[t][0]>>=4,s[t][1]>>=4,s[t][2]>>=4,s[t][3]=t}(),function(){var t,e,r,n,o,a,A=0,l=0;for(t=0;t<jb;t++){for(o=t,a=(r=s[t])[1],e=t+1;e<jb;e++)(n=s[e])[1]<a&&(o=e,a=n[1]);if(n=s[o],t!=o&&(e=n[0],n[0]=r[0],r[0]=e,e=n[1],n[1]=r[1],r[1]=e,e=n[2],n[2]=r[2],r[2]=e,e=n[3],n[3]=r[3],r[3]=e),a!=A){for(i[A]=l+t>>1,e=A+1;e<a;e++)i[e]=t;A=a,l=t}}for(i[A]=l+255>>1,e=A+1;e<256;e++)i[e]=255}()},this.getColormap=function(){for(var t=[],e=[],i=0;i<jb;i++)e[s[i][3]]=i;for(var r=0,n=0;n<jb;n++){var o=e[n];t[r++]=s[o][0],t[r++]=s[o][1],t[r++]=s[o][2]}return t},this.lookupRGB=function(t,e,r){for(var n,o,a,A=1e3,l=-1,h=i[e],d=h-1;h<jb||d>=0;)h<jb&&((a=(o=s[h])[1]-e)>=A?h=jb:(h++,a<0&&(a=-a),(n=o[0]-t)<0&&(n=-n),(a+=n)<A&&((n=o[2]-r)<0&&(n=-n),(a+=n)<A&&(A=a,l=o[3])))),d>=0&&((a=e-(o=s[d])[1])>=A?d=-1:(d--,a<0&&(a=-a),(n=o[0]-t)<0&&(n=-n),(a+=n)<A&&((n=o[2]-r)<0&&(n=-n),(a+=n)<A&&(A=a,l=o[3]))));return l}},qb=256,tv=1024,ev=1<<18;var sv=function(t,e){var s,i,r,n,o;function a(t,e,i,r,n){s[e][0]-=t*(s[e][0]-i)/tv,s[e][1]-=t*(s[e][1]-r)/tv,s[e][2]-=t*(s[e][2]-n)/tv}function A(t,e,i,r,n){for(var a,A,l=Math.abs(e-t),h=Math.min(e+t,qb),d=e+1,c=e-1,u=1;d<h||c>l;)A=o[u++],d<h&&((a=s[d++])[0]-=A*(a[0]-i)/ev,a[1]-=A*(a[1]-r)/ev,a[2]-=A*(a[2]-n)/ev),c>l&&((a=s[c--])[0]-=A*(a[0]-i)/ev,a[1]-=A*(a[1]-r)/ev,a[2]-=A*(a[2]-n)/ev)}function l(t,e,i){var o,a,A,l,h,d=~(1<<31),c=d,u=-1,p=u;for(o=0;o<qb;o++)a=s[o],(A=Math.abs(a[0]-t)+Math.abs(a[1]-e)+Math.abs(a[2]-i))<d&&(d=A,u=o),(l=A-(r[o]>>12))<c&&(c=l,p=o),h=n[o]>>10,n[o]-=h,r[o]+=h<<10;return n[u]+=64,r[u]-=65536,p}this.buildColormap=function(){!function(){var t,e;for(s=[],i=new Int32Array(256),r=new Int32Array(qb),n=new Int32Array(qb),o=new Int32Array(32),t=0;t<qb;t++)e=(t<<12)/qb,s[t]=new Float64Array([e,e,e,0]),n[t]=256,r[t]=0}(),function(){var s,i,r,n,h,d,c=t.length,u=30+(e-1)/3,p=c/(3*e),_=~~(p/100),g=tv,f=2048,m=f>>6;for(m<=1&&(m=0),s=0;s<m;s++)o[s]=g*(256*(m*m-s*s)/(m*m));c<1509?(e=1,i=3):i=c%499!=0?1497:c%491!=0?1473:c%487!=0?1461:1509;var w=0;for(s=0;s<p;)if(a(g,d=l(r=(255&t[w])<<4,n=(255&t[w+1])<<4,h=(255&t[w+2])<<4),r,n,h),0!==m&&A(m,d,r,n,h),(w+=i)>=c&&(w-=c),0===_&&(_=1),++s%_==0)for(g-=g/u,(m=(f-=f/30)>>6)<=1&&(m=0),d=0;d<m;d++)o[d]=g*(256*(m*m-d*d)/(m*m))}(),function(){for(var t=0;t<qb;t++)s[t][0]>>=4,s[t][1]>>=4,s[t][2]>>=4,s[t][3]=t}(),function(){var t,e,r,n,o,a,A=0,l=0;for(t=0;t<qb;t++){for(o=t,a=(r=s[t])[1],e=t+1;e<qb;e++)(n=s[e])[1]<a&&(o=e,a=n[1]);if(n=s[o],t!=o&&(e=n[0],n[0]=r[0],r[0]=e,e=n[1],n[1]=r[1],r[1]=e,e=n[2],n[2]=r[2],r[2]=e,e=n[3],n[3]=r[3],r[3]=e),a!=A){for(i[A]=l+t>>1,e=A+1;e<a;e++)i[e]=t;A=a,l=t}}for(i[A]=l+255>>1,e=A+1;e<256;e++)i[e]=255}()},this.getColormap=function(){for(var t=[],e=[],i=0;i<qb;i++)e[s[i][3]]=i;for(var r=0,n=0;n<qb;n++){var o=e[n];t[r++]=s[o][0],t[r++]=s[o][1],t[r++]=s[o][2]}return t},this.lookupRGB=function(t,e,r){for(var n,o,a,A=1e3,l=-1,h=i[e],d=h-1;h<qb||d>=0;)h<qb&&((a=(o=s[h])[1]-e)>=A?h=qb:(h++,a<0&&(a=-a),(n=o[0]-t)<0&&(n=-n),(a+=n)<A&&((n=o[2]-r)<0&&(n=-n),(a+=n)<A&&(A=a,l=o[3])))),d>=0&&((a=e-(o=s[d])[1])>=A?d=-1:(d--,a<0&&(a=-a),(n=o[0]-t)<0&&(n=-n),(a+=n)<A&&((n=o[2]-r)<0&&(n=-n),(a+=n)<A&&(A=a,l=o[3]))));return l}},iv=5003,rv=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];var nv=function(t,e,s,i){var r,n,o,a,A,l,h,d,c,u=Math.max(2,i),p=new Uint8Array(256),_=new Int32Array(iv),g=new Int32Array(iv),f=0,m=0,w=!1;function y(t,e){p[n++]=t,n>=254&&v(e)}function C(t){b(iv),m=d+2,w=!0,P(d,t)}function b(t){for(var e=0;e<t;++e)_[e]=-1}function v(t){n>0&&(t.writeByte(n),t.writeBytes(p,0,n),n=0)}function B(t){return(1<<t)-1}function E(){return 0===a?-1:(--a,255&s[A++])}function P(t,e){for(r&=rv[f],f>0?r|=t<<f:r=t,f+=l;f>=8;)y(255&r,e),r>>=8,f-=8;if((m>o||w)&&(w?(o=B(l=h),w=!1):(++l,o=12==l?4096:B(l))),t==c){for(;f>0;)y(255&r,e),r>>=8,f-=8;v(e)}}this.encode=function(s){s.writeByte(u),a=t*e,A=0,function(t,e){var s,i,r,a,A,u,p;for(w=!1,o=B(l=h=t),c=1+(d=1<<t-1),m=d+2,n=0,a=E(),p=0,s=iv;s<65536;s*=2)++p;p=8-p,b(u=iv),P(d,e);t:for(;-1!=(i=E());)if(s=(i<<12)+a,_[r=i<<p^a]!==s){if(_[r]>=0){A=u-r,0===r&&(A=1);do{if((r-=A)<0&&(r+=u),_[r]===s){a=g[r];continue t}}while(_[r]>=0)}P(a,e),a=i,m<4096?(g[r]=m++,_[r]=s):C(e)}else a=g[r];P(a,e),P(c,e)}(u+1,s),s.writeByte(0)}};function ov(){this.page=-1,this.pages=[],this.newPage()}ov.pageSize=4096,ov.charMap={};for(var av=0;av<256;av++)ov.charMap[av]=String.fromCharCode(av);function Av(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new ov}ov.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(ov.pageSize),this.cursor=0},ov.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var s=0;s<ov.pageSize;s++)t+=ov.charMap[this.pages[e][s]];return t},ov.prototype.writeByte=function(t){this.cursor>=ov.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},ov.prototype.writeUTFBytes=function(t){for(var e=t.length,s=0;s<e;s++)this.writeByte(t.charCodeAt(s))},ov.prototype.writeBytes=function(t,e,s){for(var i=s||t.length,r=e||0;r<i;r++)this.writeByte(t[r])},Av.prototype.setDelay=function(t){this.delay=Math.round(t/10)},Av.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},Av.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},Av.prototype.setRepeat=function(t){this.repeat=t},Av.prototype.setTransparent=function(t){this.transparent=t},Av.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},Av.prototype.finish=function(){this.out.writeByte(59)},Av.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},Av.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},Av.prototype.setGlobalPalette=function(t){this.globalPalette=t},Av.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},Av.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},Av.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new Zb(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},Av.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var s=0,i=0;i<e;i++){var r=this.findClosestRGB(255&this.pixels[s++],255&this.pixels[s++],255&this.pixels[s++]);this.usedEntry[r]=!0,this.indexedPixels[i]=r}},Av.prototype.ditherPixels=function(t,e){var s={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!s[t])throw"Unknown dithering kernel: "+t;var i=s[t],r=0,n=this.height,o=this.width,a=this.pixels,A=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var l=0;l<n;l++){e&&(A*=-1);for(var h=1==A?0:o-1,d=1==A?o:0;h!==d;h+=A){var c=3*(r=l*o+h),u=a[c],p=a[c+1],_=a[c+2];c=this.findClosestRGB(u,p,_),this.usedEntry[c]=!0,this.indexedPixels[r]=c,c*=3;for(var g=u-this.colorTab[c],f=p-this.colorTab[c+1],m=_-this.colorTab[c+2],w=1==A?0:i.length-1,y=1==A?i.length:0;w!==y;w+=A){var C=i[w][1],b=i[w][2];if(C+h>=0&&C+h<o&&b+l>=0&&b+l<n){var v=i[w][0];c=r+C+b*o,a[c*=3]=Math.max(0,Math.min(255,a[c]+g*v)),a[c+1]=Math.max(0,Math.min(255,a[c+1]+f*v)),a[c+2]=Math.max(0,Math.min(255,a[c+2]+m*v))}}}}},Av.prototype.findClosest=function(t,e){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,e)},Av.prototype.findClosestRGB=function(t,e,s,i){if(null===this.colorTab)return-1;if(this.neuQuant&&!i)return this.neuQuant.lookupRGB(t,e,s);for(var r=0,n=16777216,o=this.colorTab.length,a=0,A=0;a<o;A++){var l=t-(255&this.colorTab[a++]),h=e-(255&this.colorTab[a++]),d=s-(255&this.colorTab[a++]),c=l*l+h*h+d*d;(!i||this.usedEntry[A])&&c<n&&(n=c,r=A)}return r},Av.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var s=this.image,i=0,r=0,n=0;n<e;n++)for(var o=0;o<t;o++)this.pixels[r++]=s[i++],this.pixels[r++]=s[i++],this.pixels[r++]=s[i++],i++},Av.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=7&dispose),e<<=2,this.out.writeByte(0|e|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},Av.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},Av.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},Av.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},Av.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},Av.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},Av.prototype.writePixels=function(){new nv(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},Av.prototype.stream=function(){return this.out};var lv={NeuQuant:Zb,TypedNeuQuant:sv,GIFEncoder:Av,LZWEncoder:nv};class hv extends A{constructor(){super()}_doDispose(){super._doDispose()}export(t,e,s,i){function r(t,e){i?i(t,e):xb(t,e)}const n=s.type||"png",o=s.fileName||"realreport",a=(s.zipName||"realreport")+".zip";if("tiff"===n||"tif"===n){const t=[],i=[];for(let s=0;s<e.length;s++){const r=e[s].page,n={onclone:t=>{const e=t.body.getElementsByClassName("rr-print-page");for(let t of e)t.style.boxShadow="unset";const s=t.body.getElementsByClassName("rr-group-element");for(let t of s){const e=getComputedStyle(t).backgroundColor;e&&"rgba(0, 0, 0, 0)"!==e&&"rgba(0,0,0,0)"!==e&&(t.style.backgroundColor="#fff",t.style.backgroundImage="url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='7' height='7'%3E%3Crect x='3.5' y='3.5' width='0.5' height='0.5' fill='%23000'/%3E%3C/svg%3E\")")}}},o=function(e,s){return new Sb.Promise(((i,r)=>{OC(s,n).then((s=>{t.push(s),i(e)}))}))}(s,r);i.push(o)}Sb.Promise.all(i).then((()=>{const e=(new $b).encode(t,s.tiff||{}),i={};e.forEach(((t,e)=>{i[o+"."+n]=[t,{}]}));r(Pb(i),a)})).catch((t=>{console.error(t),alert(t)}))}else if("gif"===n){const t={},s=[],i={onclone:t=>{const e=t.body.getElementsByClassName("rr-print-page");for(let t of e)t.style.boxShadow="unset"}};for(let r=0;r<e.length;r++){const a=function(s,r){return new Sb.Promise(((a,A)=>{OC(r,i).then((i=>{const r=i.getContext("2d").getImageData(0,0,i.width,i.height).data,A=new lv.GIFEncoder(i.width,i.height);A.writeHeader(),A.addFrame(r),A.finish();const l=A.out,h=l.pages;let d=0;for(let t=0;t<h.length-1;t++)d+=h[t].length;d+=l.cursor;const c=new Uint8Array(d);h[h.length-1]=h[h.length-1].subarray(0,l.cursor);for(let t=0,e=0;t<h.length;t++)c.set(h[t],e),e+=h[t].length;const u=o+(e.length>1?s+1:"");t[u+"."+n]=[c,{}],a(s)}))}))}(r,e[r].page);s.push(a)}Sb.Promise.all(s).then((()=>{r(Pb(t),a)}))}else{const t={png:"",jpg:"image/jpeg",jpeg:"image/jpeg"},s={},i=[],A={onclone:t=>{const e=t.body.getElementsByClassName("rr-print-page");for(let t of e)t.style.boxShadow="unset"}};for(let r=0;r<e.length;r++){const a=function(i,r){return new Sb.Promise(((a,l)=>{OC(r,A).then((r=>{const A=r.toDataURL(t[n]),l=J.dataUriToBinary(A),h=o+(e.length>1?i+1:"");s[h+"."+n]=[l,{}],a(i)}))}))}(r,e[r].page);i.push(a)}Sb.Promise.all(i).then((()=>{r(Pb(s),a)}))}}}var dv=Ah((function(t,e){t.exports=(()=>{var t={742:(t,e)=>{e.byteLength=function(t){var e=A(t),s=e[0],i=e[1];return 3*(s+i)/4-i},e.toByteArray=function(t){var e,s,n=A(t),o=n[0],a=n[1],l=new r(function(t,e,s){return 3*(e+s)/4-s}(0,o,a)),h=0,d=a>0?o-4:o;for(s=0;s<d;s+=4)e=i[t.charCodeAt(s)]<<18|i[t.charCodeAt(s+1)]<<12|i[t.charCodeAt(s+2)]<<6|i[t.charCodeAt(s+3)],l[h++]=e>>16&255,l[h++]=e>>8&255,l[h++]=255&e;return 2===a&&(e=i[t.charCodeAt(s)]<<2|i[t.charCodeAt(s+1)]>>4,l[h++]=255&e),1===a&&(e=i[t.charCodeAt(s)]<<10|i[t.charCodeAt(s+1)]<<4|i[t.charCodeAt(s+2)]>>2,l[h++]=e>>8&255,l[h++]=255&e),l},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,n=[],o=16383,a=0,A=i-r;a<A;a+=o)n.push(l(t,a,a+o>A?A:a+o));return 1===r?(e=t[i-1],n.push(s[e>>2]+s[e<<4&63]+"==")):2===r&&(e=(t[i-2]<<8)+t[i-1],n.push(s[e>>10]+s[e>>4&63]+s[e<<2&63]+"=")),n.join("")};for(var s=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)s[o]=n[o],i[n.charCodeAt(o)]=o;function A(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=t.indexOf("=");return-1===s&&(s=e),[s,s===e?0:4-s%4]}function l(t,e,i){for(var r,n,o=[],a=e;a<i;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(s[(n=r)>>18&63]+s[n>>12&63]+s[n>>6&63]+s[63&n]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},764:(t,e,s)=>{const i=s(742),r=s(645),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=A,e.SlowBuffer=function(t){return+t!=t&&(t=0),A.alloc(+t)},e.INSPECT_MAX_BYTES=50;const o=2147483647;function a(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,A.prototype),e}function A(t,e,s){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return d(t)}return l(t,e,s)}function l(t,e,s){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!A.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const s=0|_(t,e);let i=a(s);const r=i.write(t,e);return r!==s&&(i=i.slice(0,r)),i}(t,e);if(ArrayBuffer.isView(t))return function(t){if(j(t,Uint8Array)){const e=new Uint8Array(t);return u(e.buffer,e.byteOffset,e.byteLength)}return c(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(j(t,ArrayBuffer)||t&&j(t.buffer,ArrayBuffer))return u(t,e,s);if("undefined"!=typeof SharedArrayBuffer&&(j(t,SharedArrayBuffer)||t&&j(t.buffer,SharedArrayBuffer)))return u(t,e,s);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return A.from(i,e,s);const r=function(t){if(A.isBuffer(t)){const e=0|p(t.length),s=a(e);return 0===s.length||t.copy(s,0,0,e),s}return void 0!==t.length?"number"!=typeof t.length||Y(t.length)?a(0):c(t):"Buffer"===t.type&&Array.isArray(t.data)?c(t.data):void 0}(t);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return A.from(t[Symbol.toPrimitive]("string"),e,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function d(t){return h(t),a(t<0?0:0|p(t))}function c(t){const e=t.length<0?0:0|p(t.length),s=a(e);for(let i=0;i<e;i+=1)s[i]=255&t[i];return s}function u(t,e,s){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(s||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===e&&void 0===s?new Uint8Array(t):void 0===s?new Uint8Array(t,e):new Uint8Array(t,e,s),Object.setPrototypeOf(i,A.prototype),i}function p(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function _(t,e){if(A.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||j(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const s=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===s)return 0;let r=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*s;case"hex":return s>>>1;case"base64":return $(t).length;default:if(r)return i?-1:z(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,s){let i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===s||s>this.length)&&(s=this.length),s<=0)return"";if((s>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,s);case"utf8":case"utf-8":return P(this,e,s);case"ascii":return S(this,e,s);case"latin1":case"binary":return I(this,e,s);case"base64":return E(this,e,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,s);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function f(t,e,s){const i=t[e];t[e]=t[s],t[s]=i}function m(t,e,s,i,r){if(0===t.length)return-1;if("string"==typeof s?(i=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),Y(s=+s)&&(s=r?0:t.length-1),s<0&&(s=t.length+s),s>=t.length){if(r)return-1;s=t.length-1}else if(s<0){if(!r)return-1;s=0}if("string"==typeof e&&(e=A.from(e,i)),A.isBuffer(e))return 0===e.length?-1:w(t,e,s,i,r);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,s):Uint8Array.prototype.lastIndexOf.call(t,e,s):w(t,[e],s,i,r);throw new TypeError("val must be string, number or Buffer")}function w(t,e,s,i,r){let n,o=1,a=t.length,A=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,A/=2,s/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){let i=-1;for(n=s;n<a;n++)if(l(t,n)===l(e,-1===i?0:n-i)){if(-1===i&&(i=n),n-i+1===A)return i*o}else-1!==i&&(n-=n-i),i=-1}else for(s+A>a&&(s=a-A),n=s;n>=0;n--){let s=!0;for(let i=0;i<A;i++)if(l(t,n+i)!==l(e,i)){s=!1;break}if(s)return n}return-1}function y(t,e,s,i){s=Number(s)||0;const r=t.length-s;i?(i=Number(i))>r&&(i=r):i=r;const n=e.length;let o;for(i>n/2&&(i=n/2),o=0;o<i;++o){const i=parseInt(e.substr(2*o,2),16);if(Y(i))return o;t[s+o]=i}return o}function C(t,e,s,i){return X(z(e,t.length-s),t,s,i)}function b(t,e,s,i){return X(function(t){const e=[];for(let s=0;s<t.length;++s)e.push(255&t.charCodeAt(s));return e}(e),t,s,i)}function v(t,e,s,i){return X($(e),t,s,i)}function B(t,e,s,i){return X(function(t,e){let s,i,r;const n=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)s=t.charCodeAt(o),i=s>>8,r=s%256,n.push(r),n.push(i);return n}(e,t.length-s),t,s,i)}function E(t,e,s){return 0===e&&s===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,s))}function P(t,e,s){s=Math.min(t.length,s);const i=[];let r=e;for(;r<s;){const e=t[r];let n=null,o=e>239?4:e>223?3:e>191?2:1;if(r+o<=s){let s,i,a,A;switch(o){case 1:e<128&&(n=e);break;case 2:s=t[r+1],128==(192&s)&&(A=(31&e)<<6|63&s,A>127&&(n=A));break;case 3:s=t[r+1],i=t[r+2],128==(192&s)&&128==(192&i)&&(A=(15&e)<<12|(63&s)<<6|63&i,A>2047&&(A<55296||A>57343)&&(n=A));break;case 4:s=t[r+1],i=t[r+2],a=t[r+3],128==(192&s)&&128==(192&i)&&128==(192&a)&&(A=(15&e)<<18|(63&s)<<12|(63&i)<<6|63&a,A>65535&&A<1114112&&(n=A))}}null===n?(n=65533,o=1):n>65535&&(n-=65536,i.push(n>>>10&1023|55296),n=56320|1023&n),i.push(n),r+=o}return function(t){const e=t.length;if(e<=x)return String.fromCharCode.apply(String,t);let s="",i=0;for(;i<e;)s+=String.fromCharCode.apply(String,t.slice(i,i+=x));return s}(i)}e.kMaxLength=o,A.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),A.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(A.prototype,"parent",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.buffer}}),Object.defineProperty(A.prototype,"offset",{enumerable:!0,get:function(){if(A.isBuffer(this))return this.byteOffset}}),A.poolSize=8192,A.from=function(t,e,s){return l(t,e,s)},Object.setPrototypeOf(A.prototype,Uint8Array.prototype),Object.setPrototypeOf(A,Uint8Array),A.alloc=function(t,e,s){return function(t,e,s){return h(t),t<=0?a(t):void 0!==e?"string"==typeof s?a(t).fill(e,s):a(t).fill(e):a(t)}(t,e,s)},A.allocUnsafe=function(t){return d(t)},A.allocUnsafeSlow=function(t){return d(t)},A.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==A.prototype},A.compare=function(t,e){if(j(t,Uint8Array)&&(t=A.from(t,t.offset,t.byteLength)),j(e,Uint8Array)&&(e=A.from(e,e.offset,e.byteLength)),!A.isBuffer(t)||!A.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let s=t.length,i=e.length;for(let r=0,n=Math.min(s,i);r<n;++r)if(t[r]!==e[r]){s=t[r],i=e[r];break}return s<i?-1:i<s?1:0},A.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},A.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return A.alloc(0);let s;if(void 0===e)for(e=0,s=0;s<t.length;++s)e+=t[s].length;const i=A.allocUnsafe(e);let r=0;for(s=0;s<t.length;++s){let e=t[s];if(j(e,Uint8Array))r+e.length>i.length?(A.isBuffer(e)||(e=A.from(e)),e.copy(i,r)):Uint8Array.prototype.set.call(i,e,r);else{if(!A.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(i,r)}r+=e.length}return i},A.byteLength=_,A.prototype._isBuffer=!0,A.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)f(this,e,e+1);return this},A.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)f(this,e,e+3),f(this,e+1,e+2);return this},A.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)f(this,e,e+7),f(this,e+1,e+6),f(this,e+2,e+5),f(this,e+3,e+4);return this},A.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?P(this,0,t):g.apply(this,arguments)},A.prototype.toLocaleString=A.prototype.toString,A.prototype.equals=function(t){if(!A.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===A.compare(this,t)},A.prototype.inspect=function(){let t="";const s=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(t+=" ... "),"<Buffer "+t+">"},n&&(A.prototype[n]=A.prototype.inspect),A.prototype.compare=function(t,e,s,i,r){if(j(t,Uint8Array)&&(t=A.from(t,t.offset,t.byteLength)),!A.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===s&&(s=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||s>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=s)return 0;if(i>=r)return-1;if(e>=s)return 1;if(this===t)return 0;let n=(r>>>=0)-(i>>>=0),o=(s>>>=0)-(e>>>=0);const a=Math.min(n,o),l=this.slice(i,r),h=t.slice(e,s);for(let t=0;t<a;++t)if(l[t]!==h[t]){n=l[t],o=h[t];break}return n<o?-1:o<n?1:0},A.prototype.includes=function(t,e,s){return-1!==this.indexOf(t,e,s)},A.prototype.indexOf=function(t,e,s){return m(this,t,e,s,!0)},A.prototype.lastIndexOf=function(t,e,s){return m(this,t,e,s,!1)},A.prototype.write=function(t,e,s,i){if(void 0===e)i="utf8",s=this.length,e=0;else if(void 0===s&&"string"==typeof e)i=e,s=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(s)?(s>>>=0,void 0===i&&(i="utf8")):(i=s,s=void 0)}const r=this.length-e;if((void 0===s||s>r)&&(s=r),t.length>0&&(s<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let n=!1;for(;;)switch(i){case"hex":return y(this,t,e,s);case"utf8":case"utf-8":return C(this,t,e,s);case"ascii":case"latin1":case"binary":return b(this,t,e,s);case"base64":return v(this,t,e,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,s);default:if(n)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),n=!0}},A.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function S(t,e,s){let i="";s=Math.min(t.length,s);for(let r=e;r<s;++r)i+=String.fromCharCode(127&t[r]);return i}function I(t,e,s){let i="";s=Math.min(t.length,s);for(let r=e;r<s;++r)i+=String.fromCharCode(t[r]);return i}function R(t,e,s){const i=t.length;(!e||e<0)&&(e=0),(!s||s<0||s>i)&&(s=i);let r="";for(let i=e;i<s;++i)r+=J[t[i]];return r}function T(t,e,s){const i=t.slice(e,s);let r="";for(let t=0;t<i.length-1;t+=2)r+=String.fromCharCode(i[t]+256*i[t+1]);return r}function O(t,e,s){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>s)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,s,i,r,n){if(!A.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<n)throw new RangeError('"value" argument is out of bounds');if(s+i>t.length)throw new RangeError("Index out of range")}function D(t,e,s,i,r){V(e,i,r,t,s,7);let n=Number(e&BigInt(4294967295));t[s++]=n,n>>=8,t[s++]=n,n>>=8,t[s++]=n,n>>=8,t[s++]=n;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[s++]=o,o>>=8,t[s++]=o,o>>=8,t[s++]=o,o>>=8,t[s++]=o,s}function L(t,e,s,i,r){V(e,i,r,t,s,7);let n=Number(e&BigInt(4294967295));t[s+7]=n,n>>=8,t[s+6]=n,n>>=8,t[s+5]=n,n>>=8,t[s+4]=n;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[s+3]=o,o>>=8,t[s+2]=o,o>>=8,t[s+1]=o,o>>=8,t[s]=o,s+8}function N(t,e,s,i,r,n){if(s+i>t.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function H(t,e,s,i,n){return e=+e,s>>>=0,n||N(t,0,s,4),r.write(t,e,s,i,23,4),s+4}function Q(t,e,s,i,n){return e=+e,s>>>=0,n||N(t,0,s,8),r.write(t,e,s,i,52,8),s+8}A.prototype.slice=function(t,e){const s=this.length;(t=~~t)<0?(t+=s)<0&&(t=0):t>s&&(t=s),(e=void 0===e?s:~~e)<0?(e+=s)<0&&(e=0):e>s&&(e=s),e<t&&(e=t);const i=this.subarray(t,e);return Object.setPrototypeOf(i,A.prototype),i},A.prototype.readUintLE=A.prototype.readUIntLE=function(t,e,s){t>>>=0,e>>>=0,s||O(t,e,this.length);let i=this[t],r=1,n=0;for(;++n<e&&(r*=256);)i+=this[t+n]*r;return i},A.prototype.readUintBE=A.prototype.readUIntBE=function(t,e,s){t>>>=0,e>>>=0,s||O(t,e,this.length);let i=this[t+--e],r=1;for(;e>0&&(r*=256);)i+=this[t+--e]*r;return i},A.prototype.readUint8=A.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},A.prototype.readUint16LE=A.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},A.prototype.readUint16BE=A.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},A.prototype.readUint32LE=A.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},A.prototype.readUint32BE=A.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},A.prototype.readBigUInt64LE=Z((function(t){G(t>>>=0,"offset");const e=this[t],s=this[t+7];void 0!==e&&void 0!==s||K(t,this.length-8);const i=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,r=this[++t]+256*this[++t]+65536*this[++t]+s*2**24;return BigInt(i)+(BigInt(r)<<BigInt(32))})),A.prototype.readBigUInt64BE=Z((function(t){G(t>>>=0,"offset");const e=this[t],s=this[t+7];void 0!==e&&void 0!==s||K(t,this.length-8);const i=e*2**24+65536*this[++t]+256*this[++t]+this[++t],r=this[++t]*2**24+65536*this[++t]+256*this[++t]+s;return(BigInt(i)<<BigInt(32))+BigInt(r)})),A.prototype.readIntLE=function(t,e,s){t>>>=0,e>>>=0,s||O(t,e,this.length);let i=this[t],r=1,n=0;for(;++n<e&&(r*=256);)i+=this[t+n]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*e)),i},A.prototype.readIntBE=function(t,e,s){t>>>=0,e>>>=0,s||O(t,e,this.length);let i=e,r=1,n=this[t+--i];for(;i>0&&(r*=256);)n+=this[t+--i]*r;return r*=128,n>=r&&(n-=Math.pow(2,8*e)),n},A.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},A.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);const s=this[t]|this[t+1]<<8;return 32768&s?4294901760|s:s},A.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);const s=this[t+1]|this[t]<<8;return 32768&s?4294901760|s:s},A.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},A.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},A.prototype.readBigInt64LE=Z((function(t){G(t>>>=0,"offset");const e=this[t],s=this[t+7];void 0!==e&&void 0!==s||K(t,this.length-8);const i=this[t+4]+256*this[t+5]+65536*this[t+6]+(s<<24);return(BigInt(i)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),A.prototype.readBigInt64BE=Z((function(t){G(t>>>=0,"offset");const e=this[t],s=this[t+7];void 0!==e&&void 0!==s||K(t,this.length-8);const i=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+s)})),A.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!0,23,4)},A.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!1,23,4)},A.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!0,52,8)},A.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!1,52,8)},A.prototype.writeUintLE=A.prototype.writeUIntLE=function(t,e,s,i){t=+t,e>>>=0,s>>>=0,i||F(this,t,e,s,Math.pow(2,8*s)-1,0);let r=1,n=0;for(this[e]=255&t;++n<s&&(r*=256);)this[e+n]=t/r&255;return e+s},A.prototype.writeUintBE=A.prototype.writeUIntBE=function(t,e,s,i){t=+t,e>>>=0,s>>>=0,i||F(this,t,e,s,Math.pow(2,8*s)-1,0);let r=s-1,n=1;for(this[e+r]=255&t;--r>=0&&(n*=256);)this[e+r]=t/n&255;return e+s},A.prototype.writeUint8=A.prototype.writeUInt8=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,1,255,0),this[e]=255&t,e+1},A.prototype.writeUint16LE=A.prototype.writeUInt16LE=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},A.prototype.writeUint16BE=A.prototype.writeUInt16BE=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},A.prototype.writeUint32LE=A.prototype.writeUInt32LE=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},A.prototype.writeUint32BE=A.prototype.writeUInt32BE=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},A.prototype.writeBigUInt64LE=Z((function(t){return D(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),A.prototype.writeBigUInt64BE=Z((function(t){return L(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),A.prototype.writeIntLE=function(t,e,s,i){if(t=+t,e>>>=0,!i){const i=Math.pow(2,8*s-1);F(this,t,e,s,i-1,-i)}let r=0,n=1,o=0;for(this[e]=255&t;++r<s&&(n*=256);)t<0&&0===o&&0!==this[e+r-1]&&(o=1),this[e+r]=(t/n>>0)-o&255;return e+s},A.prototype.writeIntBE=function(t,e,s,i){if(t=+t,e>>>=0,!i){const i=Math.pow(2,8*s-1);F(this,t,e,s,i-1,-i)}let r=s-1,n=1,o=0;for(this[e+r]=255&t;--r>=0&&(n*=256);)t<0&&0===o&&0!==this[e+r+1]&&(o=1),this[e+r]=(t/n>>0)-o&255;return e+s},A.prototype.writeInt8=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},A.prototype.writeInt16LE=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},A.prototype.writeInt16BE=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},A.prototype.writeInt32LE=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},A.prototype.writeInt32BE=function(t,e,s){return t=+t,e>>>=0,s||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},A.prototype.writeBigInt64LE=Z((function(t){return D(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),A.prototype.writeBigInt64BE=Z((function(t){return L(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),A.prototype.writeFloatLE=function(t,e,s){return H(this,t,e,!0,s)},A.prototype.writeFloatBE=function(t,e,s){return H(this,t,e,!1,s)},A.prototype.writeDoubleLE=function(t,e,s){return Q(this,t,e,!0,s)},A.prototype.writeDoubleBE=function(t,e,s){return Q(this,t,e,!1,s)},A.prototype.copy=function(t,e,s,i){if(!A.isBuffer(t))throw new TypeError("argument should be a Buffer");if(s||(s=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<s&&(i=s),i===s)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-s&&(i=t.length-e+s);const r=i-s;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,s,i):Uint8Array.prototype.set.call(t,this.subarray(s,i),e),r},A.prototype.fill=function(t,e,s,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,s=this.length):"string"==typeof s&&(i=s,s=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!A.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){const e=t.charCodeAt(0);("utf8"===i&&e<128||"latin1"===i)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<s)throw new RangeError("Out of range index");if(s<=e)return this;let r;if(e>>>=0,s=void 0===s?this.length:s>>>0,t||(t=0),"number"==typeof t)for(r=e;r<s;++r)this[r]=t;else{const n=A.isBuffer(t)?t:A.from(t,i),o=n.length;if(0===o)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(r=0;r<s-e;++r)this[r+e]=n[r%o]}return this};const U={};function M(t,e,s){U[t]=class extends s{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name="".concat(this.name," [").concat(t,"]"),delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return"".concat(this.name," [").concat(t,"]: ").concat(this.message)}}}function k(t){let e="",s=t.length;const i="-"===t[0]?1:0;for(;s>=i+4;s-=3)e="_".concat(t.slice(s-3,s)).concat(e);return"".concat(t.slice(0,s)).concat(e)}function V(t,e,s,i,r,n){if(t>s||t<e){const i="bigint"==typeof e?"n":"";let r;throw r=n>3?0===e||e===BigInt(0)?">= 0".concat(i," and < 2").concat(i," ** ").concat(8*(n+1)).concat(i):">= -(2".concat(i," ** ").concat(8*(n+1)-1).concat(i,") and < 2 ** ").concat(8*(n+1)-1).concat(i):">= ".concat(e).concat(i," and <= ").concat(s).concat(i),new U.ERR_OUT_OF_RANGE("value",r,t)}!function(t,e,s){G(e,"offset"),void 0!==t[e]&&void 0!==t[e+s]||K(e,t.length-(s+1))}(i,r,n)}function G(t,e){if("number"!=typeof t)throw new U.ERR_INVALID_ARG_TYPE(e,"number",t)}function K(t,e,s){if(Math.floor(t)!==t)throw G(t,s),new U.ERR_OUT_OF_RANGE(s||"offset","an integer",t);if(e<0)throw new U.ERR_BUFFER_OUT_OF_BOUNDS;throw new U.ERR_OUT_OF_RANGE(s||"offset",">= ".concat(s?1:0," and <= ").concat(e),t)}M("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?"".concat(t," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),M("ERR_INVALID_ARG_TYPE",(function(t,e){return'The "'.concat(t,'" argument must be of type number. Received type ').concat(typeof e)}),TypeError),M("ERR_OUT_OF_RANGE",(function(t,e,s){let i='The value of "'.concat(t,'" is out of range.'),r=s;return Number.isInteger(s)&&Math.abs(s)>2**32?r=k(String(s)):"bigint"==typeof s&&(r=String(s),(s>BigInt(2)**BigInt(32)||s<-(BigInt(2)**BigInt(32)))&&(r=k(r)),r+="n"),i+=" It must be ".concat(e,". Received ").concat(r),i}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function z(t,e){let s;e=e||1/0;const i=t.length;let r=null;const n=[];for(let o=0;o<i;++o){if(s=t.charCodeAt(o),s>55295&&s<57344){if(!r){if(s>56319){(e-=3)>-1&&n.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&n.push(239,191,189);continue}r=s;continue}if(s<56320){(e-=3)>-1&&n.push(239,191,189),r=s;continue}s=65536+(r-55296<<10|s-56320)}else r&&(e-=3)>-1&&n.push(239,191,189);if(r=null,s<128){if((e-=1)<0)break;n.push(s)}else if(s<2048){if((e-=2)<0)break;n.push(s>>6|192,63&s|128)}else if(s<65536){if((e-=3)<0)break;n.push(s>>12|224,s>>6&63|128,63&s|128)}else{if(!(s<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;n.push(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}}return n}function $(t){return i.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function X(t,e,s,i){let r;for(r=0;r<i&&!(r+s>=e.length||r>=t.length);++r)e[r+s]=t[r];return r}function j(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Y(t){return t!=t}const J=function(){const t="0123456789abcdef",e=new Array(256);for(let s=0;s<16;++s){const i=16*s;for(let r=0;r<16;++r)e[i+r]=t[s]+t[r]}return e}();function Z(t){return"undefined"==typeof BigInt?q:t}function q(){throw new Error("BigInt not supported")}},187:t=>{var e,s="object"==typeof Reflect?Reflect:null,i=s&&"function"==typeof s.apply?s.apply:function(t,e,s){return Function.prototype.apply.call(t,e,s)};e=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!=t};function n(){n.init.call(this)}t.exports=n,t.exports.once=function(t,e){return new Promise((function(s,i){function r(s){t.removeListener(e,n),i(s)}function n(){"function"==typeof t.removeListener&&t.removeListener("error",r),s([].slice.call(arguments))}_(t,e,n,{once:!0}),"error"!==e&&function(t,e,s){"function"==typeof t.on&&_(t,"error",e,{once:!0})}(t,r)}))},n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var o=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function A(t){return void 0===t._maxListeners?n.defaultMaxListeners:t._maxListeners}function l(t,e,s,i){var r,n,o,l;if(a(s),void 0===(n=t._events)?(n=t._events=Object.create(null),t._eventsCount=0):(void 0!==n.newListener&&(t.emit("newListener",e,s.listener?s.listener:s),n=t._events),o=n[e]),void 0===o)o=n[e]=s,++t._eventsCount;else if("function"==typeof o?o=n[e]=i?[s,o]:[o,s]:i?o.unshift(s):o.push(s),(r=A(t))>0&&o.length>r&&!o.warned){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=o.length,l=h,console&&console.warn&&console.warn(l)}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,s){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:s},r=h.bind(i);return r.listener=s,i.wrapFn=r,r}function c(t,e,s){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?s?[r.listener||r]:[r]:s?function(t){for(var e=new Array(t.length),s=0;s<e.length;++s)e[s]=t[s].listener||t[s];return e}(r):p(r,r.length)}function u(t){var e=this._events;if(void 0!==e){var s=e[t];if("function"==typeof s)return 1;if(void 0!==s)return s.length}return 0}function p(t,e){for(var s=new Array(e),i=0;i<e;++i)s[i]=t[i];return s}function _(t,e,s,i){if("function"==typeof t.on)i.once?t.once(e,s):t.on(e,s);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(n){i.once&&t.removeEventListener(e,r),s(n)}))}}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");o=t}}),n.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},n.prototype.getMaxListeners=function(){return A(this)},n.prototype.emit=function(t){for(var e=[],s=1;s<arguments.length;s++)e.push(arguments[s]);var r="error"===t,n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var A=n[t];if(void 0===A)return!1;if("function"==typeof A)i(A,this,e);else{var l=A.length,h=p(A,l);for(s=0;s<l;++s)i(h[s],this,e)}return!0},n.prototype.addListener=function(t,e){return l(this,t,e,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(t,e){return l(this,t,e,!0)},n.prototype.once=function(t,e){return a(e),this.on(t,d(this,t,e)),this},n.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,d(this,t,e)),this},n.prototype.removeListener=function(t,e){var s,i,r,n,o;if(a(e),void 0===(i=this._events))return this;if(void 0===(s=i[t]))return this;if(s===e||s.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,s.listener||e));else if("function"!=typeof s){for(r=-1,n=s.length-1;n>=0;n--)if(s[n]===e||s[n].listener===e){o=s[n].listener,r=n;break}if(r<0)return this;0===r?s.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(s,r),1===s.length&&(i[t]=s[0]),void 0!==i.removeListener&&this.emit("removeListener",t,o||e)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(t){var e,s,i;if(void 0===(s=this._events))return this;if(void 0===s.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==s[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete s[t]),this;if(0===arguments.length){var r,n=Object.keys(s);for(i=0;i<n.length;++i)"removeListener"!==(r=n[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=s[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},n.prototype.listeners=function(t){return c(this,t,!0)},n.prototype.rawListeners=function(t){return c(this,t,!1)},n.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):u.call(t,e)},n.prototype.listenerCount=u,n.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},645:(t,e)=>{e.read=function(t,e,s,i,r){var n,o,a=8*r-i-1,A=(1<<a)-1,l=A>>1,h=-7,d=s?r-1:0,c=s?-1:1,u=t[e+d];for(d+=c,n=u&(1<<-h)-1,u>>=-h,h+=a;h>0;n=256*n+t[e+d],d+=c,h-=8);for(o=n&(1<<-h)-1,n>>=-h,h+=i;h>0;o=256*o+t[e+d],d+=c,h-=8);if(0===n)n=1-l;else{if(n===A)return o?NaN:1/0*(u?-1:1);o+=Math.pow(2,i),n-=l}return(u?-1:1)*o*Math.pow(2,n-i)},e.write=function(t,e,s,i,r,n){var o,a,A,l=8*n-r-1,h=(1<<l)-1,d=h>>1,c=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,u=i?0:n-1,p=i?1:-1,_=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(A=Math.pow(2,-o))<1&&(o--,A*=2),(e+=o+d>=1?c/A:c*Math.pow(2,1-d))*A>=2&&(o++,A/=2),o+d>=h?(a=0,o=h):o+d>=1?(a=(e*A-1)*Math.pow(2,r),o+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,r),o=0));r>=8;t[s+u]=255&a,u+=p,a/=256,r-=8);for(o=o<<r|a,l+=r;l>0;t[s+u]=255&o,u+=p,o/=256,l-=8);t[s+u-p]|=128*_}},717:t=>{"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var s=function(){};s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t}}},733:(t,e,s)=>{t.exports=function t(e,s,i){function r(o,a){if(!s[o]){if(!e[o]){if(n)return n(o,!0);var A=new Error("Cannot find module '"+o+"'");throw A.code="MODULE_NOT_FOUND",A}var l=s[o]={exports:{}};e[o][0].call(l.exports,(function(t){return r(e[o][1][t]||t)}),l,l.exports,t,e,s,i)}return s[o].exports}for(var n=void 0,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,s){var i=t("./utils"),r=t("./support"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(t){for(var e,s,r,o,a,A,l,h=[],d=0,c=t.length,u=c,p="string"!==i.getTypeOf(t);d<t.length;)u=c-d,r=p?(e=t[d++],s=d<c?t[d++]:0,d<c?t[d++]:0):(e=t.charCodeAt(d++),s=d<c?t.charCodeAt(d++):0,d<c?t.charCodeAt(d++):0),o=e>>2,a=(3&e)<<4|s>>4,A=1<u?(15&s)<<2|r>>6:64,l=2<u?63&r:64,h.push(n.charAt(o)+n.charAt(a)+n.charAt(A)+n.charAt(l));return h.join("")},s.decode=function(t){var e,s,i,o,a,A,l=0,h=0,d="data:";if(t.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var c,u=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===n.charAt(64)&&u--,t.charAt(t.length-2)===n.charAt(64)&&u--,u%1!=0)throw new Error("Invalid base64 input, bad content length.");for(c=r.uint8array?new Uint8Array(0|u):new Array(0|u);l<t.length;)e=n.indexOf(t.charAt(l++))<<2|(o=n.indexOf(t.charAt(l++)))>>4,s=(15&o)<<4|(a=n.indexOf(t.charAt(l++)))>>2,i=(3&a)<<6|(A=n.indexOf(t.charAt(l++))),c[h++]=e,64!==a&&(c[h++]=s),64!==A&&(c[h++]=i);return c}},{"./support":30,"./utils":32}],2:[function(t,e,s){var i=t("./external"),r=t("./stream/DataWorker"),n=t("./stream/Crc32Probe"),o=t("./stream/DataLengthProbe");function a(t,e,s,i,r){this.compressedSize=t,this.uncompressedSize=e,this.crc32=s,this.compression=i,this.compressedContent=r}a.prototype={getContentWorker:function(){var t=new r(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new r(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(t,e,s){return t.pipe(new n).pipe(new o("uncompressedSize")).pipe(e.compressWorker(s)).pipe(new o("compressedSize")).withStreamInfo("compression",e)},e.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,s){var i=t("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(t){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,s){var i=t("./utils"),r=function(){for(var t,e=[],s=0;s<256;s++){t=s;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[s]=t}return e}();e.exports=function(t,e){return void 0!==t&&t.length?"string"!==i.getTypeOf(t)?function(t,e,s,i){var n=r,o=0+s;t^=-1;for(var a=0;a<o;a++)t=t>>>8^n[255&(t^e[a])];return-1^t}(0|e,t,t.length):function(t,e,s,i){var n=r,o=0+s;t^=-1;for(var a=0;a<o;a++)t=t>>>8^n[255&(t^e.charCodeAt(a))];return-1^t}(0|e,t,t.length):0}},{"./utils":32}],5:[function(t,e,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(t,e,s){var i;i="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:i}},{lie:37}],7:[function(t,e,s){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=t("pako"),n=t("./utils"),o=t("./stream/GenericWorker"),a=i?"uint8array":"array";function A(t,e){o.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}s.magic="\b\0",n.inherits(A,o),A.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(n.transformTo(a,t.data),!1)},A.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},A.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},A.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},s.compressWorker=function(t){return new A("Deflate",t)},s.uncompressWorker=function(){return new A("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,s){function i(t,e){var s,i="";for(s=0;s<e;s++)i+=String.fromCharCode(255&t),t>>>=8;return i}function r(t,e,s,r,o,h){var d,c,u=t.file,p=t.compression,_=h!==a.utf8encode,g=n.transformTo("string",h(u.name)),f=n.transformTo("string",a.utf8encode(u.name)),m=u.comment,w=n.transformTo("string",h(m)),y=n.transformTo("string",a.utf8encode(m)),C=f.length!==u.name.length,b=y.length!==m.length,v="",B="",E="",P=u.dir,x=u.date,S={crc32:0,compressedSize:0,uncompressedSize:0};e&&!s||(S.crc32=t.crc32,S.compressedSize=t.compressedSize,S.uncompressedSize=t.uncompressedSize);var I=0;e&&(I|=8),_||!C&&!b||(I|=2048);var R=0,T=0;P&&(R|=16),"UNIX"===o?(T=798,R|=function(t,e){var s=t;return t||(s=e?16893:33204),(65535&s)<<16}(u.unixPermissions,P)):(T=20,R|=function(t){return 63&(t||0)}(u.dosPermissions)),d=x.getUTCHours(),d<<=6,d|=x.getUTCMinutes(),d<<=5,d|=x.getUTCSeconds()/2,c=x.getUTCFullYear()-1980,c<<=4,c|=x.getUTCMonth()+1,c<<=5,c|=x.getUTCDate(),C&&(B=i(1,1)+i(A(g),4)+f,v+="up"+i(B.length,2)+B),b&&(E=i(1,1)+i(A(w),4)+y,v+="uc"+i(E.length,2)+E);var O="";return O+="\n\0",O+=i(I,2),O+=p.magic,O+=i(d,2),O+=i(c,2),O+=i(S.crc32,4),O+=i(S.compressedSize,4),O+=i(S.uncompressedSize,4),O+=i(g.length,2),O+=i(v.length,2),{fileRecord:l.LOCAL_FILE_HEADER+O+g+v,dirRecord:l.CENTRAL_FILE_HEADER+i(T,2)+O+i(w.length,2)+"\0\0\0\0"+i(R,4)+i(r,4)+g+v+w}}var n=t("../utils"),o=t("../stream/GenericWorker"),a=t("../utf8"),A=t("../crc32"),l=t("../signature");function h(t,e,s,i){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=s,this.encodeFileName=i,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(h,o),h.prototype.push=function(t){var e=t.meta.percent||0,s=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,o.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:s?(e+100*(s-i-1))/s:100}}))},h.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var s=r(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:s.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,s=r(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(s.dirRecord),e)this.push({data:function(t){return l.DATA_DESCRIPTOR+i(t.crc32,4)+i(t.compressedSize,4)+i(t.uncompressedSize,4)}(t),meta:{percent:100}});else for(this.push({data:s.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var s=this.bytesWritten-t,r=function(t,e,s,r,o){var a=n.transformTo("string",o(r));return l.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(t,2)+i(t,2)+i(e,4)+i(s,4)+i(a.length,2)+a}(this.dirRecords.length,s,t,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},h.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(t){var e=this._sources;if(!o.prototype.error.call(this,t))return!1;for(var s=0;s<e.length;s++)try{e[s].error(t)}catch(t){}return!0},h.prototype.lock=function(){o.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,s){var i=t("../compressions"),r=t("./ZipFileWorker");s.generateWorker=function(t,e,s){var n=new r(e.streamFiles,s,e.platform,e.encodeFileName),o=0;try{t.forEach((function(t,s){o++;var r=function(t,e){var s=t||e,r=i[s];if(!r)throw new Error(s+" is not a valid compression method !");return r}(s.options.compression,e.compression),a=s.options.compressionOptions||e.compressionOptions||{},A=s.dir,l=s.date;s._compressWorker(r,a).withStreamInfo("file",{name:t,dir:A,date:l,comment:s.comment||"",unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions}).pipe(n)})),n.entriesCount=o}catch(t){n.error(t)}return n}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new i;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.7.1",i.loadAsync=function(t,e){return(new i).loadAsync(t,e)},i.external=t("./external"),e.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,s){var i=t("./utils"),r=t("./external"),n=t("./utf8"),o=t("./zipEntries"),a=t("./stream/Crc32Probe"),A=t("./nodejsUtils");function l(t){return new r.Promise((function(e,s){var i=t.decompressed.getContentWorker().pipe(new a);i.on("error",(function(t){s(t)})).on("end",(function(){i.streamInfo.crc32!==t.decompressed.crc32?s(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}e.exports=function(t,e){var s=this;return e=i.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),A.isNode&&A.isStream(t)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var s=new o(e);return s.load(t),s})).then((function(t){var s=[r.Promise.resolve(t)],i=t.files;if(e.checkCRC32)for(var n=0;n<i.length;n++)s.push(l(i[n]));return r.Promise.all(s)})).then((function(t){for(var i=t.shift(),r=i.files,n=0;n<r.length;n++){var o=r[n];s.file(o.fileNameStr,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:e.createFolders})}return i.zipComment.length&&(s.comment=i.zipComment),s}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,s){var i=t("../utils"),r=t("../stream/GenericWorker");function n(t,e){r.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}i.inherits(n,r),n.prototype._bindStream=function(t){var e=this;(this._stream=t).pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},n.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,s){var i=t("readable-stream").Readable;function r(t,e,s){i.call(this,e),this._helper=t;var r=this;t.on("data",(function(t,e){r.push(t)||r._helper.pause(),s&&s(e)})).on("error",(function(t){r.emit("error",t)})).on("end",(function(){r.push(null)}))}t("../utils").inherits(r,i),r.prototype._read=function(){this._helper.resume()},e.exports=r},{"../utils":32,"readable-stream":16}],14:[function(t,e,s){e.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(t,e){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,e);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new Buffer(t,e)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var e=new Buffer(t);return e.fill(0),e},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,s){function i(t,e,s){var i,r=n.getTypeOf(e),a=n.extend(s||{},A);a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),"string"==typeof a.unixPermissions&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&16384&a.unixPermissions&&(a.dir=!0),a.dosPermissions&&16&a.dosPermissions&&(a.dir=!0),a.dir&&(t=_(t)),a.createFolders&&(i=p(t))&&g.call(this,i,!0);var d,f="string"===r&&!1===a.binary&&!1===a.base64;s&&void 0!==s.binary||(a.binary=!f),(e instanceof l&&0===e.uncompressedSize||a.dir||!e||0===e.length)&&(a.base64=!1,a.binary=!0,e="",a.compression="STORE",r="string"),d=e instanceof l||e instanceof o?e:c.isNode&&c.isStream(e)?new u(t,e):n.prepareContent(t,e,a.binary,a.optimizedBinaryString,a.base64);var m=new h(t,d,a);this.files[t]=m}var r=t("./utf8"),n=t("./utils"),o=t("./stream/GenericWorker"),a=t("./stream/StreamHelper"),A=t("./defaults"),l=t("./compressedObject"),h=t("./zipObject"),d=t("./generate"),c=t("./nodejsUtils"),u=t("./nodejs/NodejsStreamInputAdapter"),p=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return 0<e?t.substring(0,e):""},_=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},g=function(t,e){return e=void 0!==e?e:A.createFolders,t=_(t),this.files[t]||i.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function f(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var m={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,s,i;for(e in this.files)i=this.files[e],(s=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(s,i)},filter:function(t){var e=[];return this.forEach((function(s,i){t(s,i)&&e.push(i)})),e},file:function(t,e,s){if(1!==arguments.length)return t=this.root+t,i.call(this,t,e,s),this;if(f(t)){var r=t;return this.filter((function(t,e){return!e.dir&&r.test(t)}))}var n=this.files[this.root+t];return n&&!n.dir?n:null},folder:function(t){if(!t)return this;if(f(t))return this.filter((function(e,s){return s.dir&&t.test(e)}));var e=this.root+t,s=g.call(this,e),i=this.clone();return i.root=s.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var s=this.filter((function(e,s){return s.name.slice(0,t.length)===t})),i=0;i<s.length;i++)delete this.files[s[i].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,s={};try{if((s=n.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=s.type.toLowerCase(),s.compression=s.compression.toUpperCase(),"binarystring"===s.type&&(s.type="string"),!s.type)throw new Error("No output type specified.");n.checkSupport(s.type),"darwin"!==s.platform&&"freebsd"!==s.platform&&"linux"!==s.platform&&"sunos"!==s.platform||(s.platform="UNIX"),"win32"===s.platform&&(s.platform="DOS");var i=s.comment||this.comment||"";e=d.generateWorker(this,s,i)}catch(t){(e=new o("error")).error(t)}return new a(e,s.type||"string",s.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=m},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,s){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,s){var i=t("./DataReader");function r(t){i.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(r,i),r.prototype.byteAt=function(t){return this.data[this.zero+t]},r.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),s=t.charCodeAt(1),i=t.charCodeAt(2),r=t.charCodeAt(3),n=this.length-4;0<=n;--n)if(this.data[n]===e&&this.data[n+1]===s&&this.data[n+2]===i&&this.data[n+3]===r)return n-this.zero;return-1},r.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),s=t.charCodeAt(1),i=t.charCodeAt(2),r=t.charCodeAt(3),n=this.readData(4);return e===n[0]&&s===n[1]&&i===n[2]&&r===n[3]},r.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./DataReader":18}],18:[function(t,e,s){var i=t("../utils");function r(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,s=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)s=(s<<8)+this.byteAt(e);return this.index+=t,s},readString:function(t){return i.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=r},{"../utils":32}],19:[function(t,e,s){var i=t("./Uint8ArrayReader");function r(t){i.call(this,t)}t("../utils").inherits(r,i),r.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,s){var i=t("./DataReader");function r(t){i.call(this,t)}t("../utils").inherits(r,i),r.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},r.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},r.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},r.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./DataReader":18}],21:[function(t,e,s){var i=t("./ArrayReader");function r(t){i.call(this,t)}t("../utils").inherits(r,i),r.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,s){var i=t("../utils"),r=t("../support"),n=t("./ArrayReader"),o=t("./StringReader"),a=t("./NodeBufferReader"),A=t("./Uint8ArrayReader");e.exports=function(t){var e=i.getTypeOf(t);return i.checkSupport(e),"string"!==e||r.uint8array?"nodebuffer"===e?new a(t):r.uint8array?new A(i.transformTo("uint8array",t)):new n(i.transformTo("array",t)):new o(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,s){var i=t("./GenericWorker"),r=t("../utils");function n(t){i.call(this,"ConvertWorker to "+t),this.destType=t}r.inherits(n,i),n.prototype.processChunk=function(t){this.push({data:r.transformTo(this.destType,t.data),meta:t.meta})},e.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,s){var i=t("./GenericWorker"),r=t("../crc32");function n(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(n,i),n.prototype.processChunk=function(t){this.streamInfo.crc32=r(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,s){var i=t("../utils"),r=t("./GenericWorker");function n(t){r.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}i.inherits(n,r),n.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}r.prototype.processChunk.call(this,t)},e.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,s){var i=t("../utils"),r=t("./GenericWorker");function n(t){r.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=i.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}i.inherits(n,r),n.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,s){function i(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var s=0;s<this._listeners[t].length;s++)this._listeners[t][s].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var t=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=i},{}],29:[function(t,e,s){var i=t("../utils"),r=t("./ConvertWorker"),n=t("./GenericWorker"),o=t("../base64"),a=t("../support"),A=t("../external"),l=null;if(a.nodestream)try{l=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function h(t,e,s){var o=e;switch(e){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=e,this._mimeType=s,i.checkSupport(o),this._worker=t.pipe(new r(o)),t.lock()}catch(t){this._worker=new n("error"),this._worker.error(t)}}h.prototype={accumulate:function(t){return function(t,e){return new A.Promise((function(s,r){var n=[],a=t._internalType,A=t._outputType,l=t._mimeType;t.on("data",(function(t,s){n.push(t),e&&e(s)})).on("error",(function(t){n=[],r(t)})).on("end",(function(){try{var t=function(t,e,s){switch(t){case"blob":return i.newBlob(i.transformTo("arraybuffer",e),s);case"base64":return o.encode(e);default:return i.transformTo(t,e)}}(A,function(t,e){var s,i=0,r=null,n=0;for(s=0;s<e.length;s++)n+=e[s].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(r=new Uint8Array(n),s=0;s<e.length;s++)r.set(e[s],i),i+=e[s].length;return r;case"nodebuffer":return Buffer.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}(a,n),l);s(t)}catch(t){r(t)}n=[]})).resume()}))}(this,t)},on:function(t,e){var s=this;return"data"===t?this._worker.on(t,(function(t){e.call(s,t.data,t.meta)})):this._worker.on(t,(function(){i.delay(e,arguments,s)})),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new l(this,{objectMode:"nodebuffer"!==this._outputType},t)}},e.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,e,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,s.nodebuffer="undefined"!=typeof Buffer,s.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=0===new Blob([i],{type:"application/zip"}).size}catch(t){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),s.blob=0===r.getBlob("application/zip").size}catch(t){s.blob=!1}}}try{s.nodestream=!!t("readable-stream").Readable}catch(t){s.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,s){for(var i=t("./utils"),r=t("./support"),n=t("./nodejsUtils"),o=t("./stream/GenericWorker"),a=new Array(256),A=0;A<256;A++)a[A]=252<=A?6:248<=A?5:240<=A?4:224<=A?3:192<=A?2:1;function l(){o.call(this,"utf-8 decode"),this.leftOver=null}function h(){o.call(this,"utf-8 encode")}a[254]=a[254]=1,s.utf8encode=function(t){return r.nodebuffer?n.newBufferFrom(t,"utf-8"):function(t){var e,s,i,n,o,a=t.length,A=0;for(n=0;n<a;n++)55296==(64512&(s=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(s=65536+(s-55296<<10)+(i-56320),n++),A+=s<128?1:s<2048?2:s<65536?3:4;for(e=r.uint8array?new Uint8Array(A):new Array(A),n=o=0;o<A;n++)55296==(64512&(s=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(i=t.charCodeAt(n+1)))&&(s=65536+(s-55296<<10)+(i-56320),n++),s<128?e[o++]=s:(s<2048?e[o++]=192|s>>>6:(s<65536?e[o++]=224|s>>>12:(e[o++]=240|s>>>18,e[o++]=128|s>>>12&63),e[o++]=128|s>>>6&63),e[o++]=128|63&s);return e}(t)},s.utf8decode=function(t){return r.nodebuffer?i.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,s,r,n,o=t.length,A=new Array(2*o);for(e=s=0;e<o;)if((r=t[e++])<128)A[s++]=r;else if(4<(n=a[r]))A[s++]=65533,e+=n-1;else{for(r&=2===n?31:3===n?15:7;1<n&&e<o;)r=r<<6|63&t[e++],n--;1<n?A[s++]=65533:r<65536?A[s++]=r:(r-=65536,A[s++]=55296|r>>10&1023,A[s++]=56320|1023&r)}return A.length!==s&&(A.subarray?A=A.subarray(0,s):A.length=s),i.applyFromCharCode(A)}(t=i.transformTo(r.uint8array?"uint8array":"array",t))},i.inherits(l,o),l.prototype.processChunk=function(t){var e=i.transformTo(r.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var n=e;(e=new Uint8Array(n.length+this.leftOver.length)).set(this.leftOver,0),e.set(n,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var o=function(t,e){var s;for((e=e||t.length)>t.length&&(e=t.length),s=e-1;0<=s&&128==(192&t[s]);)s--;return s<0||0===s?e:s+a[t[s]]>e?s:e}(e),A=e;o!==e.length&&(r.uint8array?(A=e.subarray(0,o),this.leftOver=e.subarray(o,e.length)):(A=e.slice(0,o),this.leftOver=e.slice(o,e.length))),this.push({data:s.utf8decode(A),meta:t.meta})},l.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=l,i.inherits(h,o),h.prototype.processChunk=function(t){this.push({data:s.utf8encode(t.data),meta:t.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,s){var i=t("./support"),r=t("./base64"),n=t("./nodejsUtils"),o=t("set-immediate-shim"),a=t("./external");function A(t){return t}function l(t,e){for(var s=0;s<t.length;++s)e[s]=255&t.charCodeAt(s);return e}s.newBlob=function(t,e){s.checkSupport("blob");try{return new Blob([t],{type:e})}catch(s){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(t),i.getBlob(e)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(t,e,s){var i=[],r=0,n=t.length;if(n<=s)return String.fromCharCode.apply(null,t);for(;r<n;)"array"===e||"nodebuffer"===e?i.push(String.fromCharCode.apply(null,t.slice(r,Math.min(r+s,n)))):i.push(String.fromCharCode.apply(null,t.subarray(r,Math.min(r+s,n)))),r+=s;return i.join("")},stringifyByChar:function(t){for(var e="",s=0;s<t.length;s++)e+=String.fromCharCode(t[s]);return e},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,n.allocBuffer(1)).length}catch(t){return!1}}()}};function d(t){var e=65536,i=s.getTypeOf(t),r=!0;if("uint8array"===i?r=h.applyCanBeUsed.uint8array:"nodebuffer"===i&&(r=h.applyCanBeUsed.nodebuffer),r)for(;1<e;)try{return h.stringifyByChunk(t,i,e)}catch(t){e=Math.floor(e/2)}return h.stringifyByChar(t)}function c(t,e){for(var s=0;s<t.length;s++)e[s]=t[s];return e}s.applyFromCharCode=d;var u={};u.string={string:A,array:function(t){return l(t,new Array(t.length))},arraybuffer:function(t){return u.string.uint8array(t).buffer},uint8array:function(t){return l(t,new Uint8Array(t.length))},nodebuffer:function(t){return l(t,n.allocBuffer(t.length))}},u.array={string:d,array:A,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return n.newBufferFrom(t)}},u.arraybuffer={string:function(t){return d(new Uint8Array(t))},array:function(t){return c(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:A,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return n.newBufferFrom(new Uint8Array(t))}},u.uint8array={string:d,array:function(t){return c(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:A,nodebuffer:function(t){return n.newBufferFrom(t)}},u.nodebuffer={string:d,array:function(t){return c(t,new Array(t.length))},arraybuffer:function(t){return u.nodebuffer.uint8array(t).buffer},uint8array:function(t){return c(t,new Uint8Array(t.length))},nodebuffer:A},s.transformTo=function(t,e){if(e=e||"",!t)return e;s.checkSupport(t);var i=s.getTypeOf(e);return u[i][t](e)},s.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":i.nodebuffer&&n.isBuffer(t)?"nodebuffer":i.uint8array&&t instanceof Uint8Array?"uint8array":i.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(t){if(!i[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(t){var e,s,i="";for(s=0;s<(t||"").length;s++)i+="\\x"+((e=t.charCodeAt(s))<16?"0":"")+e.toString(16).toUpperCase();return i},s.delay=function(t,e,s){o((function(){t.apply(s||null,e||[])}))},s.inherits=function(t,e){function s(){}s.prototype=e.prototype,t.prototype=new s},s.extend=function(){var t,e,s={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===s[e]&&(s[e]=arguments[t][e]);return s},s.prepareContent=function(t,e,n,o,A){return a.Promise.resolve(e).then((function(t){return i.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new a.Promise((function(e,s){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.onerror=function(t){s(t.target.error)},i.readAsArrayBuffer(t)})):t})).then((function(e){var h=s.getTypeOf(e);return h?("arraybuffer"===h?e=s.transformTo("uint8array",e):"string"===h&&(A?e=r.decode(e):n&&!0!==o&&(e=function(t){return l(t,i.uint8array?new Uint8Array(t.length):new Array(t.length))}(e))),e):a.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(t,e,s){var i=t("./reader/readerFor"),r=t("./utils"),n=t("./signature"),o=t("./zipEntry"),a=(t("./utf8"),t("./support"));function A(t){this.files=[],this.loadOptions=t}A.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(e)+", expected "+r.pretty(t)+")")}},isSignature:function(t,e){var s=this.reader.index;this.reader.setIndex(t);var i=this.reader.readString(4)===e;return this.reader.setIndex(s),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=a.uint8array?"uint8array":"array",s=r.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(s)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,s,i=this.zip64EndOfCentralSize-44;0<i;)t=this.reader.readInt(2),e=this.reader.readInt(4),s=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:s}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(t=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(t<0)throw this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var e=t;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var s=this.centralDirOffset+this.centralDirSize;this.zip64&&(s+=20,s+=12+this.zip64EndOfCentralSize);var i=e-s;if(0<i)this.isSignature(e,n.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(t){this.reader=i(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=A},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,s){var i=t("./reader/readerFor"),r=t("./utils"),n=t("./compressedObject"),o=t("./crc32"),a=t("./utf8"),A=t("./compressions"),l=t("./support");function h(t,e){this.options=t,this.loadOptions=e}h.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,s;if(t.skip(22),this.fileNameLength=t.readInt(2),s=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(s),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in A)if(A.hasOwnProperty(e)&&A[e].magic===t)return A[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,s,i,r=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<r;)e=t.readInt(2),s=t.readInt(2),i=t.readData(s),this.extraFields[e]={id:e,length:s,value:i};t.setIndex(r)},handleUTF8:function(){var t=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var s=r.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(s)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var n=r.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(n)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=i(t.value);return 1!==e.readInt(1)||o(this.fileName)!==e.readInt(4)?null:a.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=i(t.value);return 1!==e.readInt(1)||o(this.fileComment)!==e.readInt(4)?null:a.utf8decode(e.readData(t.length-5))}return null}},e.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,s){function i(t,e,s){this.name=t,this.dir=s.dir,this.date=s.date,this.comment=s.comment,this.unixPermissions=s.unixPermissions,this.dosPermissions=s.dosPermissions,this._data=e,this._dataBinary=s.binary,this.options={compression:s.compression,compressionOptions:s.compressionOptions}}var r=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),o=t("./utf8"),a=t("./compressedObject"),A=t("./stream/GenericWorker");i.prototype={internalStream:function(t){var e=null,s="string";try{if(!t)throw new Error("No output type specified.");var i="string"===(s=t.toLowerCase())||"text"===s;"binarystring"!==s&&"text"!==s||(s="string"),e=this._decompressWorker();var n=!this._dataBinary;n&&!i&&(e=e.pipe(new o.Utf8EncodeWorker)),!n&&i&&(e=e.pipe(new o.Utf8DecodeWorker))}catch(t){(e=new A("error")).error(t)}return new r(e,s,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof a&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var s=this._decompressWorker();return this._dataBinary||(s=s.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(s,t,e)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof A?this._data:new n(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<l.length;d++)i.prototype[l[d]]=h;e.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,i){(function(t){var s,i,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var n=0,o=new r(h),a=t.document.createTextNode("");o.observe(a,{characterData:!0}),s=function(){a.data=n=++n%2}}else if(t.setImmediate||void 0===t.MessageChannel)s="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){h(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(h,0)};else{var A=new t.MessageChannel;A.port1.onmessage=h,s=function(){A.port2.postMessage(0)}}var l=[];function h(){var t,e;i=!0;for(var s=l.length;s;){for(e=l,l=[],t=-1;++t<s;)e[t]();s=l.length}i=!1}e.exports=function(t){1!==l.push(t)||i||s()}}).call(this,void 0!==s.g?s.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,s){var i=t("immediate");function r(){}var n={},o=["REJECTED"],a=["FULFILLED"],A=["PENDING"];function l(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=A,this.queue=[],this.outcome=void 0,t!==r&&u(this,t)}function h(t,e,s){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof s&&(this.onRejected=s,this.callRejected=this.otherCallRejected)}function d(t,e,s){i((function(){var i;try{i=e(s)}catch(i){return n.reject(t,i)}i===t?n.reject(t,new TypeError("Cannot resolve promise with itself")):n.resolve(t,i)}))}function c(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function u(t,e){var s=!1;function i(e){s||(s=!0,n.reject(t,e))}function r(e){s||(s=!0,n.resolve(t,e))}var o=p((function(){e(r,i)}));"error"===o.status&&i(o.value)}function p(t,e){var s={};try{s.value=t(e),s.status="success"}catch(t){s.status="error",s.value=t}return s}(e.exports=l).prototype.finally=function(t){if("function"!=typeof t)return this;var e=this.constructor;return this.then((function(s){return e.resolve(t()).then((function(){return s}))}),(function(s){return e.resolve(t()).then((function(){throw s}))}))},l.prototype.catch=function(t){return this.then(null,t)},l.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===o)return this;var s=new this.constructor(r);return this.state!==A?d(s,this.state===a?t:e,this.outcome):this.queue.push(new h(s,t,e)),s},h.prototype.callFulfilled=function(t){n.resolve(this.promise,t)},h.prototype.otherCallFulfilled=function(t){d(this.promise,this.onFulfilled,t)},h.prototype.callRejected=function(t){n.reject(this.promise,t)},h.prototype.otherCallRejected=function(t){d(this.promise,this.onRejected,t)},n.resolve=function(t,e){var s=p(c,e);if("error"===s.status)return n.reject(t,s.value);var i=s.value;if(i)u(t,i);else{t.state=a,t.outcome=e;for(var r=-1,o=t.queue.length;++r<o;)t.queue[r].callFulfilled(e)}return t},n.reject=function(t,e){t.state=o,t.outcome=e;for(var s=-1,i=t.queue.length;++s<i;)t.queue[s].callRejected(e);return t},l.resolve=function(t){return t instanceof this?t:n.resolve(new this(r),t)},l.reject=function(t){var e=new this(r);return n.reject(e,t)},l.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var s=t.length,i=!1;if(!s)return this.resolve([]);for(var o=new Array(s),a=0,A=-1,l=new this(r);++A<s;)h(t[A],A);return l;function h(t,r){e.resolve(t).then((function(t){o[r]=t,++a!==s||i||(i=!0,n.resolve(l,o))}),(function(t){i||(i=!0,n.reject(l,t))}))}},l.race=function(t){if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var e=t.length,s=!1;if(!e)return this.resolve([]);for(var i,o=-1,a=new this(r);++o<e;)i=t[o],this.resolve(i).then((function(t){s||(s=!0,n.resolve(a,t))}),(function(t){s||(s=!0,n.reject(a,t))}));return a}},{immediate:36}],38:[function(t,e,s){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,s){var i=t("./zlib/deflate"),r=t("./utils/common"),n=t("./utils/strings"),o=t("./zlib/messages"),a=t("./zlib/zstream"),A=Object.prototype.toString;function l(t){if(!(this instanceof l))return new l(t);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var s=i.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==s)throw new Error(o[s]);if(e.header&&i.deflateSetHeader(this.strm,e.header),e.dictionary){var h;if(h="string"==typeof e.dictionary?n.string2buf(e.dictionary):"[object ArrayBuffer]"===A.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(s=i.deflateSetDictionary(this.strm,h)))throw new Error(o[s]);this._dict_set=!0}}function h(t,e){var s=new l(e);if(s.push(t,!0),s.err)throw s.msg||o[s.err];return s.result}l.prototype.push=function(t,e){var s,o,a=this.strm,l=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?4:0,"string"==typeof t?a.input=n.string2buf(t):"[object ArrayBuffer]"===A.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new r.Buf8(l),a.next_out=0,a.avail_out=l),1!==(s=i.deflate(a,o))&&0!==s)return this.onEnd(s),!(this.ended=!0);0!==a.avail_out&&(0!==a.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(n.buf2binstring(r.shrinkBuf(a.output,a.next_out))):this.onData(r.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&1!==s);return 4===o?(s=i.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,0===s):2!==o||(this.onEnd(0),!(a.avail_out=0))},l.prototype.onData=function(t){this.chunks.push(t)},l.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},s.Deflate=l,s.deflate=h,s.deflateRaw=function(t,e){return(e=e||{}).raw=!0,h(t,e)},s.gzip=function(t,e){return(e=e||{}).gzip=!0,h(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,s){var i=t("./zlib/inflate"),r=t("./utils/common"),n=t("./utils/strings"),o=t("./zlib/constants"),a=t("./zlib/messages"),A=t("./zlib/zstream"),l=t("./zlib/gzheader"),h=Object.prototype.toString;function d(t){if(!(this instanceof d))return new d(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A,this.strm.avail_out=0;var s=i.inflateInit2(this.strm,e.windowBits);if(s!==o.Z_OK)throw new Error(a[s]);this.header=new l,i.inflateGetHeader(this.strm,this.header)}function c(t,e){var s=new d(e);if(s.push(t,!0),s.err)throw s.msg||a[s.err];return s.result}d.prototype.push=function(t,e){var s,a,A,l,d,c,u=this.strm,p=this.options.chunkSize,_=this.options.dictionary,g=!1;if(this.ended)return!1;a=e===~~e?e:!0===e?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof t?u.input=n.binstring2buf(t):"[object ArrayBuffer]"===h.call(t)?u.input=new Uint8Array(t):u.input=t,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new r.Buf8(p),u.next_out=0,u.avail_out=p),(s=i.inflate(u,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&_&&(c="string"==typeof _?n.string2buf(_):"[object ArrayBuffer]"===h.call(_)?new Uint8Array(_):_,s=i.inflateSetDictionary(this.strm,c)),s===o.Z_BUF_ERROR&&!0===g&&(s=o.Z_OK,g=!1),s!==o.Z_STREAM_END&&s!==o.Z_OK)return this.onEnd(s),!(this.ended=!0);u.next_out&&(0!==u.avail_out&&s!==o.Z_STREAM_END&&(0!==u.avail_in||a!==o.Z_FINISH&&a!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(A=n.utf8border(u.output,u.next_out),l=u.next_out-A,d=n.buf2string(u.output,A),u.next_out=l,u.avail_out=p-l,l&&r.arraySet(u.output,u.output,A,l,0),this.onData(d)):this.onData(r.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(g=!0)}while((0<u.avail_in||0===u.avail_out)&&s!==o.Z_STREAM_END);return s===o.Z_STREAM_END&&(a=o.Z_FINISH),a===o.Z_FINISH?(s=i.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===o.Z_OK):a!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(u.avail_out=0))},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},s.Inflate=d,s.inflate=c,s.inflateRaw=function(t,e){return(e=e||{}).raw=!0,c(t,e)},s.ungzip=c},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,s){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;s.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var s=e.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(var i in s)s.hasOwnProperty(i)&&(t[i]=s[i])}}return t},s.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,s,i,r){if(e.subarray&&t.subarray)t.set(e.subarray(s,s+i),r);else for(var n=0;n<i;n++)t[r+n]=e[s+n]},flattenChunks:function(t){var e,s,i,r,n,o;for(e=i=0,s=t.length;e<s;e++)i+=t[e].length;for(o=new Uint8Array(i),e=r=0,s=t.length;e<s;e++)n=t[e],o.set(n,r),r+=n.length;return o}},n={arraySet:function(t,e,s,i,r){for(var n=0;n<i;n++)t[r+n]=e[s+n]},flattenChunks:function(t){return[].concat.apply([],t)}};s.setTyped=function(t){t?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,r)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,n))},s.setTyped(i)},{}],42:[function(t,e,s){var i=t("./common"),r=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){n=!1}for(var o=new i.Buf8(256),a=0;a<256;a++)o[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function A(t,e){if(e<65537&&(t.subarray&&n||!t.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(t,e));for(var s="",o=0;o<e;o++)s+=String.fromCharCode(t[o]);return s}o[254]=o[254]=1,s.string2buf=function(t){var e,s,r,n,o,a=t.length,A=0;for(n=0;n<a;n++)55296==(64512&(s=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(r=t.charCodeAt(n+1)))&&(s=65536+(s-55296<<10)+(r-56320),n++),A+=s<128?1:s<2048?2:s<65536?3:4;for(e=new i.Buf8(A),n=o=0;o<A;n++)55296==(64512&(s=t.charCodeAt(n)))&&n+1<a&&56320==(64512&(r=t.charCodeAt(n+1)))&&(s=65536+(s-55296<<10)+(r-56320),n++),s<128?e[o++]=s:(s<2048?e[o++]=192|s>>>6:(s<65536?e[o++]=224|s>>>12:(e[o++]=240|s>>>18,e[o++]=128|s>>>12&63),e[o++]=128|s>>>6&63),e[o++]=128|63&s);return e},s.buf2binstring=function(t){return A(t,t.length)},s.binstring2buf=function(t){for(var e=new i.Buf8(t.length),s=0,r=e.length;s<r;s++)e[s]=t.charCodeAt(s);return e},s.buf2string=function(t,e){var s,i,r,n,a=e||t.length,l=new Array(2*a);for(s=i=0;s<a;)if((r=t[s++])<128)l[i++]=r;else if(4<(n=o[r]))l[i++]=65533,s+=n-1;else{for(r&=2===n?31:3===n?15:7;1<n&&s<a;)r=r<<6|63&t[s++],n--;1<n?l[i++]=65533:r<65536?l[i++]=r:(r-=65536,l[i++]=55296|r>>10&1023,l[i++]=56320|1023&r)}return A(l,i)},s.utf8border=function(t,e){var s;for((e=e||t.length)>t.length&&(e=t.length),s=e-1;0<=s&&128==(192&t[s]);)s--;return s<0||0===s?e:s+o[t[s]]>e?s:e}},{"./common":41}],43:[function(t,e,s){e.exports=function(t,e,s,i){for(var r=65535&t|0,n=t>>>16&65535|0,o=0;0!==s;){for(s-=o=2e3<s?2e3:s;n=n+(r=r+e[i++]|0)|0,--o;);r%=65521,n%=65521}return r|n<<16|0}},{}],44:[function(t,e,s){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,s){var i=function(){for(var t,e=[],s=0;s<256;s++){t=s;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[s]=t}return e}();e.exports=function(t,e,s,r){var n=i,o=r+s;t^=-1;for(var a=r;a<o;a++)t=t>>>8^n[255&(t^e[a])];return-1^t}},{}],46:[function(t,e,s){var i,r=t("../utils/common"),n=t("./trees"),o=t("./adler32"),a=t("./crc32"),A=t("./messages"),l=-2,h=258,d=262,c=113;function u(t,e){return t.msg=A[e],e}function p(t){return(t<<1)-(4<t?9:0)}function _(t){for(var e=t.length;0<=--e;)t[e]=0}function g(t){var e=t.state,s=e.pending;s>t.avail_out&&(s=t.avail_out),0!==s&&(r.arraySet(t.output,e.pending_buf,e.pending_out,s,t.next_out),t.next_out+=s,e.pending_out+=s,t.total_out+=s,t.avail_out-=s,e.pending-=s,0===e.pending&&(e.pending_out=0))}function f(t,e){n._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,g(t.strm)}function m(t,e){t.pending_buf[t.pending++]=e}function w(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function y(t,e){var s,i,r=t.max_chain_length,n=t.strstart,o=t.prev_length,a=t.nice_match,A=t.strstart>t.w_size-d?t.strstart-(t.w_size-d):0,l=t.window,c=t.w_mask,u=t.prev,p=t.strstart+h,_=l[n+o-1],g=l[n+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{if(l[(s=e)+o]===g&&l[s+o-1]===_&&l[s]===l[n]&&l[++s]===l[n+1]){n+=2,s++;do{}while(l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&n<p);if(i=h-(p-n),n=p-h,o<i){if(t.match_start=e,a<=(o=i))break;_=l[n+o-1],g=l[n+o]}}}while((e=u[e&c])>A&&0!=--r);return o<=t.lookahead?o:t.lookahead}function C(t){var e,s,i,n,A,l,h,c,u,p,_=t.w_size;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=_+(_-d)){for(r.arraySet(t.window,t.window,_,_,0),t.match_start-=_,t.strstart-=_,t.block_start-=_,e=s=t.hash_size;i=t.head[--e],t.head[e]=_<=i?i-_:0,--s;);for(e=s=_;i=t.prev[--e],t.prev[e]=_<=i?i-_:0,--s;);n+=_}if(0===t.strm.avail_in)break;if(l=t.strm,h=t.window,c=t.strstart+t.lookahead,p=void 0,(u=n)<(p=l.avail_in)&&(p=u),s=0===p?0:(l.avail_in-=p,r.arraySet(h,l.input,l.next_in,p,c),1===l.state.wrap?l.adler=o(l.adler,h,p,c):2===l.state.wrap&&(l.adler=a(l.adler,h,p,c)),l.next_in+=p,l.total_in+=p,p),t.lookahead+=s,t.lookahead+t.insert>=3)for(A=t.strstart-t.insert,t.ins_h=t.window[A],t.ins_h=(t.ins_h<<t.hash_shift^t.window[A+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[A+3-1])&t.hash_mask,t.prev[A&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=A,A++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<d&&0!==t.strm.avail_in)}function b(t,e){for(var s,i;;){if(t.lookahead<d){if(C(t),t.lookahead<d&&0===e)return 1;if(0===t.lookahead)break}if(s=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==s&&t.strstart-s<=t.w_size-d&&(t.match_length=y(t,s)),t.match_length>=3)if(i=n._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=n._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}function v(t,e){for(var s,i,r;;){if(t.lookahead<d){if(C(t),t.lookahead<d&&0===e)return 1;if(0===t.lookahead)break}if(s=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==s&&t.prev_length<t.max_lazy_match&&t.strstart-s<=t.w_size-d&&(t.match_length=y(t,s),t.match_length<=5&&(1===t.strategy||3===t.match_length&&4096<t.strstart-t.match_start)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){for(r=t.strstart+t.lookahead-3,i=n._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(f(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((i=n._tr_tally(t,0,t.window[t.strstart-1]))&&f(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=n._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}function B(t,e,s,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=s,this.max_chain=i,this.func=r}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),_(this.dyn_ltree),_(this.dyn_dtree),_(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),_(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),_(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function P(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:c,t.adler=2===e.wrap?0:1,e.last_flush=0,n._tr_init(e),0):u(t,l)}function x(t){var e=P(t);return 0===e&&function(t){t.window_size=2*t.w_size,_(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0}(t.state),e}function S(t,e,s,i,n,o){if(!t)return l;var a=1;if(-1===e&&(e=6),i<0?(a=0,i=-i):15<i&&(a=2,i-=16),n<1||9<n||8!==s||i<8||15<i||e<0||9<e||o<0||4<o)return u(t,l);8===i&&(i=9);var A=new E;return(t.state=A).strm=t,A.wrap=a,A.gzhead=null,A.w_bits=i,A.w_size=1<<A.w_bits,A.w_mask=A.w_size-1,A.hash_bits=n+7,A.hash_size=1<<A.hash_bits,A.hash_mask=A.hash_size-1,A.hash_shift=~~((A.hash_bits+3-1)/3),A.window=new r.Buf8(2*A.w_size),A.head=new r.Buf16(A.hash_size),A.prev=new r.Buf16(A.w_size),A.lit_bufsize=1<<n+6,A.pending_buf_size=4*A.lit_bufsize,A.pending_buf=new r.Buf8(A.pending_buf_size),A.d_buf=1*A.lit_bufsize,A.l_buf=3*A.lit_bufsize,A.level=e,A.strategy=o,A.method=s,x(t)}i=[new B(0,0,0,0,(function(t,e){var s=65535;for(s>t.pending_buf_size-5&&(s=t.pending_buf_size-5);;){if(t.lookahead<=1){if(C(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+s;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,f(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-d&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(f(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(f(t,!1),t.strm.avail_out),1)})),new B(4,4,8,4,b),new B(4,5,16,8,b),new B(4,6,32,32,b),new B(4,4,16,16,v),new B(8,16,32,32,v),new B(8,16,128,128,v),new B(8,32,128,256,v),new B(32,128,258,1024,v),new B(32,258,258,4096,v)],s.deflateInit=function(t,e){return S(t,e,8,15,8,0)},s.deflateInit2=S,s.deflateReset=x,s.deflateResetKeep=P,s.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?l:(t.state.gzhead=e,0):l},s.deflate=function(t,e){var s,r,o,A;if(!t||!t.state||5<e||e<0)return t?u(t,l):l;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||666===r.status&&4!==e)return u(t,0===t.avail_out?-5:l);if(r.strm=t,s=r.last_flush,r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,m(r,31),m(r,139),m(r,8),r.gzhead?(m(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),m(r,255&r.gzhead.time),m(r,r.gzhead.time>>8&255),m(r,r.gzhead.time>>16&255),m(r,r.gzhead.time>>24&255),m(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),m(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(m(r,255&r.gzhead.extra.length),m(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=a(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(m(r,0),m(r,0),m(r,0),m(r,0),m(r,0),m(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),m(r,3),r.status=c);else{var d=8+(r.w_bits-8<<4)<<8;d|=(2<=r.strategy||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(d|=32),d+=31-d%31,r.status=c,w(r,d),0!==r.strstart&&(w(r,t.adler>>>16),w(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(o=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),g(t),o=r.pending,r.pending!==r.pending_buf_size));)m(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),g(t),o=r.pending,r.pending===r.pending_buf_size)){A=1;break}A=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,m(r,A)}while(0!==A);r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),0===A&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),g(t),o=r.pending,r.pending===r.pending_buf_size)){A=1;break}A=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,m(r,A)}while(0!==A);r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),0===A&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&g(t),r.pending+2<=r.pending_buf_size&&(m(r,255&t.adler),m(r,t.adler>>8&255),t.adler=0,r.status=c)):r.status=c),0!==r.pending){if(g(t),0===t.avail_out)return r.last_flush=-1,0}else if(0===t.avail_in&&p(e)<=p(s)&&4!==e)return u(t,-5);if(666===r.status&&0!==t.avail_in)return u(t,-5);if(0!==t.avail_in||0!==r.lookahead||0!==e&&666!==r.status){var y=2===r.strategy?function(t,e){for(var s;;){if(0===t.lookahead&&(C(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,s=n._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,s&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}(r,e):3===r.strategy?function(t,e){for(var s,i,r,o,a=t.window;;){if(t.lookahead<=h){if(C(t),t.lookahead<=h&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&0<t.strstart&&(i=a[r=t.strstart-1])===a[++r]&&i===a[++r]&&i===a[++r]){o=t.strstart+h;do{}while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<o);t.match_length=h-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(s=n._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(s=n._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),s&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}(r,e):i[r.level].func(r,e);if(3!==y&&4!==y||(r.status=666),1===y||3===y)return 0===t.avail_out&&(r.last_flush=-1),0;if(2===y&&(1===e?n._tr_align(r):5!==e&&(n._tr_stored_block(r,0,0,!1),3===e&&(_(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),g(t),0===t.avail_out))return r.last_flush=-1,0}return 4!==e?0:r.wrap<=0?1:(2===r.wrap?(m(r,255&t.adler),m(r,t.adler>>8&255),m(r,t.adler>>16&255),m(r,t.adler>>24&255),m(r,255&t.total_in),m(r,t.total_in>>8&255),m(r,t.total_in>>16&255),m(r,t.total_in>>24&255)):(w(r,t.adler>>>16),w(r,65535&t.adler)),g(t),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending?0:1)},s.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&e!==c&&666!==e?u(t,l):(t.state=null,e===c?u(t,-3):0):l},s.deflateSetDictionary=function(t,e){var s,i,n,a,A,h,d,c,u=e.length;if(!t||!t.state)return l;if(2===(a=(s=t.state).wrap)||1===a&&42!==s.status||s.lookahead)return l;for(1===a&&(t.adler=o(t.adler,e,u,0)),s.wrap=0,u>=s.w_size&&(0===a&&(_(s.head),s.strstart=0,s.block_start=0,s.insert=0),c=new r.Buf8(s.w_size),r.arraySet(c,e,u-s.w_size,s.w_size,0),e=c,u=s.w_size),A=t.avail_in,h=t.next_in,d=t.input,t.avail_in=u,t.next_in=0,t.input=e,C(s);s.lookahead>=3;){for(i=s.strstart,n=s.lookahead-2;s.ins_h=(s.ins_h<<s.hash_shift^s.window[i+3-1])&s.hash_mask,s.prev[i&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=i,i++,--n;);s.strstart=i,s.lookahead=2,C(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,t.next_in=h,t.input=d,t.avail_in=A,s.wrap=a,0},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,s){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,s){e.exports=function(t,e){var s,i,r,n,o,a,A,l,h,d,c,u,p,_,g,f,m,w,y,C,b,v,B,E,P;s=t.state,i=t.next_in,E=t.input,r=i+(t.avail_in-5),n=t.next_out,P=t.output,o=n-(e-t.avail_out),a=n+(t.avail_out-257),A=s.dmax,l=s.wsize,h=s.whave,d=s.wnext,c=s.window,u=s.hold,p=s.bits,_=s.lencode,g=s.distcode,f=(1<<s.lenbits)-1,m=(1<<s.distbits)-1;t:do{p<15&&(u+=E[i++]<<p,p+=8,u+=E[i++]<<p,p+=8),w=_[u&f];e:for(;;){if(u>>>=y=w>>>24,p-=y,0==(y=w>>>16&255))P[n++]=65535&w;else{if(!(16&y)){if(0==(64&y)){w=_[(65535&w)+(u&(1<<y)-1)];continue e}if(32&y){s.mode=12;break t}t.msg="invalid literal/length code",s.mode=30;break t}C=65535&w,(y&=15)&&(p<y&&(u+=E[i++]<<p,p+=8),C+=u&(1<<y)-1,u>>>=y,p-=y),p<15&&(u+=E[i++]<<p,p+=8,u+=E[i++]<<p,p+=8),w=g[u&m];s:for(;;){if(u>>>=y=w>>>24,p-=y,!(16&(y=w>>>16&255))){if(0==(64&y)){w=g[(65535&w)+(u&(1<<y)-1)];continue s}t.msg="invalid distance code",s.mode=30;break t}if(b=65535&w,p<(y&=15)&&(u+=E[i++]<<p,(p+=8)<y&&(u+=E[i++]<<p,p+=8)),A<(b+=u&(1<<y)-1)){t.msg="invalid distance too far back",s.mode=30;break t}if(u>>>=y,p-=y,(y=n-o)<b){if(h<(y=b-y)&&s.sane){t.msg="invalid distance too far back",s.mode=30;break t}if(B=c,(v=0)===d){if(v+=l-y,y<C){for(C-=y;P[n++]=c[v++],--y;);v=n-b,B=P}}else if(d<y){if(v+=l+d-y,(y-=d)<C){for(C-=y;P[n++]=c[v++],--y;);if(v=0,d<C){for(C-=y=d;P[n++]=c[v++],--y;);v=n-b,B=P}}}else if(v+=d-y,y<C){for(C-=y;P[n++]=c[v++],--y;);v=n-b,B=P}for(;2<C;)P[n++]=B[v++],P[n++]=B[v++],P[n++]=B[v++],C-=3;C&&(P[n++]=B[v++],1<C&&(P[n++]=B[v++]))}else{for(v=n-b;P[n++]=P[v++],P[n++]=P[v++],P[n++]=P[v++],2<(C-=3););C&&(P[n++]=P[v++],1<C&&(P[n++]=P[v++]))}break}}break}}while(i<r&&n<a);i-=C=p>>3,u&=(1<<(p-=C<<3))-1,t.next_in=i,t.next_out=n,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=n<a?a-n+257:257-(n-a),s.hold=u,s.bits=p}},{}],49:[function(t,e,s){var i=t("../utils/common"),r=t("./adler32"),n=t("./crc32"),o=t("./inffast"),a=t("./inftrees"),A=-2;function l(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function h(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new i.Buf32(852),e.distcode=e.distdyn=new i.Buf32(592),e.sane=1,e.back=-1,0):A}function c(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,d(t)):A}function u(t,e){var s,i;return t&&t.state?(i=t.state,e<0?(s=0,e=-e):(s=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?A:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=s,i.wbits=e,c(t))):A}function p(t,e){var s,i;return t?(i=new h,(t.state=i).window=null,0!==(s=u(t,e))&&(t.state=null),s):A}var _,g,f=!0;function m(t){if(f){var e;for(_=new i.Buf32(512),g=new i.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(a(1,t.lens,0,288,_,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;a(2,t.lens,0,32,g,0,t.work,{bits:5}),f=!1}t.lencode=_,t.lenbits=9,t.distcode=g,t.distbits=5}function w(t,e,s,r){var n,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),r>=o.wsize?(i.arraySet(o.window,e,s-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(r<(n=o.wsize-o.wnext)&&(n=r),i.arraySet(o.window,e,s-r,n,o.wnext),(r-=n)?(i.arraySet(o.window,e,s-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=n,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=n))),0}s.inflateReset=c,s.inflateReset2=u,s.inflateResetKeep=d,s.inflateInit=function(t){return p(t,15)},s.inflateInit2=p,s.inflate=function(t,e){var s,h,d,c,u,p,_,g,f,y,C,b,v,B,E,P,x,S,I,R,T,O,F,D,L=0,N=new i.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return A;12===(s=t.state).mode&&(s.mode=13),u=t.next_out,d=t.output,_=t.avail_out,c=t.next_in,h=t.input,p=t.avail_in,g=s.hold,f=s.bits,y=p,C=_,O=0;t:for(;;)switch(s.mode){case 1:if(0===s.wrap){s.mode=13;break}for(;f<16;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if(2&s.wrap&&35615===g){N[s.check=0]=255&g,N[1]=g>>>8&255,s.check=n(s.check,N,2,0),f=g=0,s.mode=2;break}if(s.flags=0,s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&g)<<8)+(g>>8))%31){t.msg="incorrect header check",s.mode=30;break}if(8!=(15&g)){t.msg="unknown compression method",s.mode=30;break}if(f-=4,T=8+(15&(g>>>=4)),0===s.wbits)s.wbits=T;else if(T>s.wbits){t.msg="invalid window size",s.mode=30;break}s.dmax=1<<T,t.adler=s.check=1,s.mode=512&g?10:12,f=g=0;break;case 2:for(;f<16;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if(s.flags=g,8!=(255&s.flags)){t.msg="unknown compression method",s.mode=30;break}if(57344&s.flags){t.msg="unknown header flags set",s.mode=30;break}s.head&&(s.head.text=g>>8&1),512&s.flags&&(N[0]=255&g,N[1]=g>>>8&255,s.check=n(s.check,N,2,0)),f=g=0,s.mode=3;case 3:for(;f<32;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}s.head&&(s.head.time=g),512&s.flags&&(N[0]=255&g,N[1]=g>>>8&255,N[2]=g>>>16&255,N[3]=g>>>24&255,s.check=n(s.check,N,4,0)),f=g=0,s.mode=4;case 4:for(;f<16;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}s.head&&(s.head.xflags=255&g,s.head.os=g>>8),512&s.flags&&(N[0]=255&g,N[1]=g>>>8&255,s.check=n(s.check,N,2,0)),f=g=0,s.mode=5;case 5:if(1024&s.flags){for(;f<16;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}s.length=g,s.head&&(s.head.extra_len=g),512&s.flags&&(N[0]=255&g,N[1]=g>>>8&255,s.check=n(s.check,N,2,0)),f=g=0}else s.head&&(s.head.extra=null);s.mode=6;case 6:if(1024&s.flags&&(p<(b=s.length)&&(b=p),b&&(s.head&&(T=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Array(s.head.extra_len)),i.arraySet(s.head.extra,h,c,b,T)),512&s.flags&&(s.check=n(s.check,h,b,c)),p-=b,c+=b,s.length-=b),s.length))break t;s.length=0,s.mode=7;case 7:if(2048&s.flags){if(0===p)break t;for(b=0;T=h[c+b++],s.head&&T&&s.length<65536&&(s.head.name+=String.fromCharCode(T)),T&&b<p;);if(512&s.flags&&(s.check=n(s.check,h,b,c)),p-=b,c+=b,T)break t}else s.head&&(s.head.name=null);s.length=0,s.mode=8;case 8:if(4096&s.flags){if(0===p)break t;for(b=0;T=h[c+b++],s.head&&T&&s.length<65536&&(s.head.comment+=String.fromCharCode(T)),T&&b<p;);if(512&s.flags&&(s.check=n(s.check,h,b,c)),p-=b,c+=b,T)break t}else s.head&&(s.head.comment=null);s.mode=9;case 9:if(512&s.flags){for(;f<16;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if(g!==(65535&s.check)){t.msg="header crc mismatch",s.mode=30;break}f=g=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),t.adler=s.check=0,s.mode=12;break;case 10:for(;f<32;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}t.adler=s.check=l(g),f=g=0,s.mode=11;case 11:if(0===s.havedict)return t.next_out=u,t.avail_out=_,t.next_in=c,t.avail_in=p,s.hold=g,s.bits=f,2;t.adler=s.check=1,s.mode=12;case 12:if(5===e||6===e)break t;case 13:if(s.last){g>>>=7&f,f-=7&f,s.mode=27;break}for(;f<3;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}switch(s.last=1&g,f-=1,3&(g>>>=1)){case 0:s.mode=14;break;case 1:if(m(s),s.mode=20,6!==e)break;g>>>=2,f-=2;break t;case 2:s.mode=17;break;case 3:t.msg="invalid block type",s.mode=30}g>>>=2,f-=2;break;case 14:for(g>>>=7&f,f-=7&f;f<32;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if((65535&g)!=(g>>>16^65535)){t.msg="invalid stored block lengths",s.mode=30;break}if(s.length=65535&g,f=g=0,s.mode=15,6===e)break t;case 15:s.mode=16;case 16:if(b=s.length){if(p<b&&(b=p),_<b&&(b=_),0===b)break t;i.arraySet(d,h,c,b,u),p-=b,c+=b,_-=b,u+=b,s.length-=b;break}s.mode=12;break;case 17:for(;f<14;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if(s.nlen=257+(31&g),g>>>=5,f-=5,s.ndist=1+(31&g),g>>>=5,f-=5,s.ncode=4+(15&g),g>>>=4,f-=4,286<s.nlen||30<s.ndist){t.msg="too many length or distance symbols",s.mode=30;break}s.have=0,s.mode=18;case 18:for(;s.have<s.ncode;){for(;f<3;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}s.lens[H[s.have++]]=7&g,g>>>=3,f-=3}for(;s.have<19;)s.lens[H[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,F={bits:s.lenbits},O=a(0,s.lens,0,19,s.lencode,0,s.work,F),s.lenbits=F.bits,O){t.msg="invalid code lengths set",s.mode=30;break}s.have=0,s.mode=19;case 19:for(;s.have<s.nlen+s.ndist;){for(;P=(L=s.lencode[g&(1<<s.lenbits)-1])>>>16&255,x=65535&L,!((E=L>>>24)<=f);){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if(x<16)g>>>=E,f-=E,s.lens[s.have++]=x;else{if(16===x){for(D=E+2;f<D;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if(g>>>=E,f-=E,0===s.have){t.msg="invalid bit length repeat",s.mode=30;break}T=s.lens[s.have-1],b=3+(3&g),g>>>=2,f-=2}else if(17===x){for(D=E+3;f<D;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}f-=E,T=0,b=3+(7&(g>>>=E)),g>>>=3,f-=3}else{for(D=E+7;f<D;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}f-=E,T=0,b=11+(127&(g>>>=E)),g>>>=7,f-=7}if(s.have+b>s.nlen+s.ndist){t.msg="invalid bit length repeat",s.mode=30;break}for(;b--;)s.lens[s.have++]=T}}if(30===s.mode)break;if(0===s.lens[256]){t.msg="invalid code -- missing end-of-block",s.mode=30;break}if(s.lenbits=9,F={bits:s.lenbits},O=a(1,s.lens,0,s.nlen,s.lencode,0,s.work,F),s.lenbits=F.bits,O){t.msg="invalid literal/lengths set",s.mode=30;break}if(s.distbits=6,s.distcode=s.distdyn,F={bits:s.distbits},O=a(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,F),s.distbits=F.bits,O){t.msg="invalid distances set",s.mode=30;break}if(s.mode=20,6===e)break t;case 20:s.mode=21;case 21:if(6<=p&&258<=_){t.next_out=u,t.avail_out=_,t.next_in=c,t.avail_in=p,s.hold=g,s.bits=f,o(t,C),u=t.next_out,d=t.output,_=t.avail_out,c=t.next_in,h=t.input,p=t.avail_in,g=s.hold,f=s.bits,12===s.mode&&(s.back=-1);break}for(s.back=0;P=(L=s.lencode[g&(1<<s.lenbits)-1])>>>16&255,x=65535&L,!((E=L>>>24)<=f);){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if(P&&0==(240&P)){for(S=E,I=P,R=x;P=(L=s.lencode[R+((g&(1<<S+I)-1)>>S)])>>>16&255,x=65535&L,!(S+(E=L>>>24)<=f);){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}g>>>=S,f-=S,s.back+=S}if(g>>>=E,f-=E,s.back+=E,s.length=x,0===P){s.mode=26;break}if(32&P){s.back=-1,s.mode=12;break}if(64&P){t.msg="invalid literal/length code",s.mode=30;break}s.extra=15&P,s.mode=22;case 22:if(s.extra){for(D=s.extra;f<D;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}s.length+=g&(1<<s.extra)-1,g>>>=s.extra,f-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=23;case 23:for(;P=(L=s.distcode[g&(1<<s.distbits)-1])>>>16&255,x=65535&L,!((E=L>>>24)<=f);){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if(0==(240&P)){for(S=E,I=P,R=x;P=(L=s.distcode[R+((g&(1<<S+I)-1)>>S)])>>>16&255,x=65535&L,!(S+(E=L>>>24)<=f);){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}g>>>=S,f-=S,s.back+=S}if(g>>>=E,f-=E,s.back+=E,64&P){t.msg="invalid distance code",s.mode=30;break}s.offset=x,s.extra=15&P,s.mode=24;case 24:if(s.extra){for(D=s.extra;f<D;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}s.offset+=g&(1<<s.extra)-1,g>>>=s.extra,f-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){t.msg="invalid distance too far back",s.mode=30;break}s.mode=25;case 25:if(0===_)break t;if(b=C-_,s.offset>b){if((b=s.offset-b)>s.whave&&s.sane){t.msg="invalid distance too far back",s.mode=30;break}v=b>s.wnext?(b-=s.wnext,s.wsize-b):s.wnext-b,b>s.length&&(b=s.length),B=s.window}else B=d,v=u-s.offset,b=s.length;for(_<b&&(b=_),_-=b,s.length-=b;d[u++]=B[v++],--b;);0===s.length&&(s.mode=21);break;case 26:if(0===_)break t;d[u++]=s.length,_--,s.mode=21;break;case 27:if(s.wrap){for(;f<32;){if(0===p)break t;p--,g|=h[c++]<<f,f+=8}if(C-=_,t.total_out+=C,s.total+=C,C&&(t.adler=s.check=s.flags?n(s.check,d,C,u-C):r(s.check,d,C,u-C)),C=_,(s.flags?g:l(g))!==s.check){t.msg="incorrect data check",s.mode=30;break}f=g=0}s.mode=28;case 28:if(s.wrap&&s.flags){for(;f<32;){if(0===p)break t;p--,g+=h[c++]<<f,f+=8}if(g!==(4294967295&s.total)){t.msg="incorrect length check",s.mode=30;break}f=g=0}s.mode=29;case 29:O=1;break t;case 30:O=-3;break t;case 31:return-4;default:return A}return t.next_out=u,t.avail_out=_,t.next_in=c,t.avail_in=p,s.hold=g,s.bits=f,(s.wsize||C!==t.avail_out&&s.mode<30&&(s.mode<27||4!==e))&&w(t,t.output,t.next_out,C-t.avail_out)?(s.mode=31,-4):(y-=t.avail_in,C-=t.avail_out,t.total_in+=y,t.total_out+=C,s.total+=C,s.wrap&&C&&(t.adler=s.check=s.flags?n(s.check,d,C,t.next_out-C):r(s.check,d,C,t.next_out-C)),t.data_type=s.bits+(s.last?64:0)+(12===s.mode?128:0)+(20===s.mode||15===s.mode?256:0),(0==y&&0===C||4===e)&&0===O&&(O=-5),O)},s.inflateEnd=function(t){if(!t||!t.state)return A;var e=t.state;return e.window&&(e.window=null),t.state=null,0},s.inflateGetHeader=function(t,e){var s;return t&&t.state?0==(2&(s=t.state).wrap)?A:((s.head=e).done=!1,0):A},s.inflateSetDictionary=function(t,e){var s,i=e.length;return t&&t.state?0!==(s=t.state).wrap&&11!==s.mode?A:11===s.mode&&r(1,e,i,0)!==s.check?-3:w(t,e,i,i)?(s.mode=31,-4):(s.havedict=1,0):A},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,s){var i=t("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,s,A,l,h,d,c){var u,p,_,g,f,m,w,y,C,b=c.bits,v=0,B=0,E=0,P=0,x=0,S=0,I=0,R=0,T=0,O=0,F=null,D=0,L=new i.Buf16(16),N=new i.Buf16(16),H=null,Q=0;for(v=0;v<=15;v++)L[v]=0;for(B=0;B<A;B++)L[e[s+B]]++;for(x=b,P=15;1<=P&&0===L[P];P--);if(P<x&&(x=P),0===P)return l[h++]=20971520,l[h++]=20971520,c.bits=1,0;for(E=1;E<P&&0===L[E];E++);for(x<E&&(x=E),v=R=1;v<=15;v++)if(R<<=1,(R-=L[v])<0)return-1;if(0<R&&(0===t||1!==P))return-1;for(N[1]=0,v=1;v<15;v++)N[v+1]=N[v]+L[v];for(B=0;B<A;B++)0!==e[s+B]&&(d[N[e[s+B]]++]=B);if(m=0===t?(F=H=d,19):1===t?(F=r,D-=257,H=n,Q-=257,256):(F=o,H=a,-1),v=E,f=h,I=B=O=0,_=-1,g=(T=1<<(S=x))-1,1===t&&852<T||2===t&&592<T)return 1;for(;;){for(w=v-I,C=d[B]<m?(y=0,d[B]):d[B]>m?(y=H[Q+d[B]],F[D+d[B]]):(y=96,0),u=1<<v-I,E=p=1<<S;l[f+(O>>I)+(p-=u)]=w<<24|y<<16|C|0,0!==p;);for(u=1<<v-1;O&u;)u>>=1;if(0!==u?(O&=u-1,O+=u):O=0,B++,0==--L[v]){if(v===P)break;v=e[s+d[B]]}if(x<v&&(O&g)!==_){for(0===I&&(I=x),f+=E,R=1<<(S=v-I);S+I<P&&!((R-=L[S+I])<=0);)S++,R<<=1;if(T+=1<<S,1===t&&852<T||2===t&&592<T)return 1;l[_=O&g]=x<<24|S<<16|f-h|0}}return 0!==O&&(l[f+O]=v-I<<24|64<<16|0),c.bits=x,0}},{"../utils/common":41}],51:[function(t,e,s){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,s){var i=t("../utils/common");function r(t){for(var e=t.length;0<=--e;)t[e]=0}var n=256,o=286,a=30,A=15,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],h=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);r(u);var p=new Array(60);r(p);var _=new Array(512);r(_);var g=new Array(256);r(g);var f=new Array(29);r(f);var m,w,y,C=new Array(a);function b(t,e,s,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=s,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}function v(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function B(t){return t<256?_[t]:_[256+(t>>>7)]}function E(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function P(t,e,s){t.bi_valid>16-s?(t.bi_buf|=e<<t.bi_valid&65535,E(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=s-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=s)}function x(t,e,s){P(t,s[2*e],s[2*e+1])}function S(t,e){for(var s=0;s|=1&t,t>>>=1,s<<=1,0<--e;);return s>>>1}function I(t,e,s){var i,r,n=new Array(16),o=0;for(i=1;i<=A;i++)n[i]=o=o+s[i-1]<<1;for(r=0;r<=e;r++){var a=t[2*r+1];0!==a&&(t[2*r]=S(n[a]++,a))}}function R(t){var e;for(e=0;e<o;e++)t.dyn_ltree[2*e]=0;for(e=0;e<a;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function T(t){8<t.bi_valid?E(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function O(t,e,s,i){var r=2*e,n=2*s;return t[r]<t[n]||t[r]===t[n]&&i[e]<=i[s]}function F(t,e,s){for(var i=t.heap[s],r=s<<1;r<=t.heap_len&&(r<t.heap_len&&O(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!O(e,i,t.heap[r],t.depth));)t.heap[s]=t.heap[r],s=r,r<<=1;t.heap[s]=i}function D(t,e,s){var i,r,o,a,A=0;if(0!==t.last_lit)for(;i=t.pending_buf[t.d_buf+2*A]<<8|t.pending_buf[t.d_buf+2*A+1],r=t.pending_buf[t.l_buf+A],A++,0===i?x(t,r,e):(x(t,(o=g[r])+n+1,e),0!==(a=l[o])&&P(t,r-=f[o],a),x(t,o=B(--i),s),0!==(a=h[o])&&P(t,i-=C[o],a)),A<t.last_lit;);x(t,256,e)}function L(t,e){var s,i,r,n=e.dyn_tree,o=e.stat_desc.static_tree,a=e.stat_desc.has_stree,l=e.stat_desc.elems,h=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<l;s++)0!==n[2*s]?(t.heap[++t.heap_len]=h=s,t.depth[s]=0):n[2*s+1]=0;for(;t.heap_len<2;)n[2*(r=t.heap[++t.heap_len]=h<2?++h:0)]=1,t.depth[r]=0,t.opt_len--,a&&(t.static_len-=o[2*r+1]);for(e.max_code=h,s=t.heap_len>>1;1<=s;s--)F(t,n,s);for(r=l;s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],F(t,n,1),i=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=i,n[2*r]=n[2*s]+n[2*i],t.depth[r]=(t.depth[s]>=t.depth[i]?t.depth[s]:t.depth[i])+1,n[2*s+1]=n[2*i+1]=r,t.heap[1]=r++,F(t,n,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var s,i,r,n,o,a,l=e.dyn_tree,h=e.max_code,d=e.stat_desc.static_tree,c=e.stat_desc.has_stree,u=e.stat_desc.extra_bits,p=e.stat_desc.extra_base,_=e.stat_desc.max_length,g=0;for(n=0;n<=A;n++)t.bl_count[n]=0;for(l[2*t.heap[t.heap_max]+1]=0,s=t.heap_max+1;s<573;s++)_<(n=l[2*l[2*(i=t.heap[s])+1]+1]+1)&&(n=_,g++),l[2*i+1]=n,h<i||(t.bl_count[n]++,o=0,p<=i&&(o=u[i-p]),a=l[2*i],t.opt_len+=a*(n+o),c&&(t.static_len+=a*(d[2*i+1]+o)));if(0!==g){do{for(n=_-1;0===t.bl_count[n];)n--;t.bl_count[n]--,t.bl_count[n+1]+=2,t.bl_count[_]--,g-=2}while(0<g);for(n=_;0!==n;n--)for(i=t.bl_count[n];0!==i;)h<(r=t.heap[--s])||(l[2*r+1]!==n&&(t.opt_len+=(n-l[2*r+1])*l[2*r],l[2*r+1]=n),i--)}}(t,e),I(n,h,t.bl_count)}function N(t,e,s){var i,r,n=-1,o=e[1],a=0,A=7,l=4;for(0===o&&(A=138,l=3),e[2*(s+1)+1]=65535,i=0;i<=s;i++)r=o,o=e[2*(i+1)+1],++a<A&&r===o||(a<l?t.bl_tree[2*r]+=a:0!==r?(r!==n&&t.bl_tree[2*r]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,n=r,l=(a=0)===o?(A=138,3):r===o?(A=6,3):(A=7,4))}function H(t,e,s){var i,r,n=-1,o=e[1],a=0,A=7,l=4;for(0===o&&(A=138,l=3),i=0;i<=s;i++)if(r=o,o=e[2*(i+1)+1],!(++a<A&&r===o)){if(a<l)for(;x(t,r,t.bl_tree),0!=--a;);else 0!==r?(r!==n&&(x(t,r,t.bl_tree),a--),x(t,16,t.bl_tree),P(t,a-3,2)):a<=10?(x(t,17,t.bl_tree),P(t,a-3,3)):(x(t,18,t.bl_tree),P(t,a-11,7));n=r,l=(a=0)===o?(A=138,3):r===o?(A=6,3):(A=7,4)}}r(C);var Q=!1;function U(t,e,s,r){P(t,0+(r?1:0),3),function(t,e,s,r){T(t),E(t,s),E(t,~s),i.arraySet(t.pending_buf,t.window,e,s,t.pending),t.pending+=s}(t,e,s)}s._tr_init=function(t){Q||(function(){var t,e,s,i,r,n=new Array(16);for(i=s=0;i<28;i++)for(f[i]=s,t=0;t<1<<l[i];t++)g[s++]=i;for(g[s-1]=i,i=r=0;i<16;i++)for(C[i]=r,t=0;t<1<<h[i];t++)_[r++]=i;for(r>>=7;i<a;i++)for(C[i]=r<<7,t=0;t<1<<h[i]-7;t++)_[256+r++]=i;for(e=0;e<=A;e++)n[e]=0;for(t=0;t<=143;)u[2*t+1]=8,t++,n[8]++;for(;t<=255;)u[2*t+1]=9,t++,n[9]++;for(;t<=279;)u[2*t+1]=7,t++,n[7]++;for(;t<=287;)u[2*t+1]=8,t++,n[8]++;for(I(u,287,n),t=0;t<a;t++)p[2*t+1]=5,p[2*t]=S(t,5);m=new b(u,l,257,o,A),w=new b(p,h,0,a,A),y=new b(new Array(0),d,0,19,7)}(),Q=!0),t.l_desc=new v(t.dyn_ltree,m),t.d_desc=new v(t.dyn_dtree,w),t.bl_desc=new v(t.bl_tree,y),t.bi_buf=0,t.bi_valid=0,R(t)},s._tr_stored_block=U,s._tr_flush_block=function(t,e,s,i){var r,o,a=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,s=4093624447;for(e=0;e<=31;e++,s>>>=1)if(1&s&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<n;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),L(t,t.l_desc),L(t,t.d_desc),a=function(t){var e;for(N(t,t.dyn_ltree,t.l_desc.max_code),N(t,t.dyn_dtree,t.d_desc.max_code),L(t,t.bl_desc),e=18;3<=e&&0===t.bl_tree[2*c[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=r&&(r=o)):r=o=s+5,s+4<=r&&-1!==e?U(t,e,s,i):4===t.strategy||o===r?(P(t,2+(i?1:0),3),D(t,u,p)):(P(t,4+(i?1:0),3),function(t,e,s,i){var r;for(P(t,e-257,5),P(t,s-1,5),P(t,i-4,4),r=0;r<i;r++)P(t,t.bl_tree[2*c[r]+1],3);H(t,t.dyn_ltree,e-1),H(t,t.dyn_dtree,s-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),D(t,t.dyn_ltree,t.dyn_dtree)),R(t),i&&T(t)},s._tr_tally=function(t,e,s){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&s,t.last_lit++,0===e?t.dyn_ltree[2*s]++:(t.matches++,e--,t.dyn_ltree[2*(g[s]+n+1)]++,t.dyn_dtree[2*B(e)]++),t.last_lit===t.lit_bufsize-1},s._tr_align=function(t){P(t,2,3),x(t,256,u),function(t){16===t.bi_valid?(E(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,e,s){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,s){e.exports="function"==typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}},{}]},{},[10])(10)},155:t=>{var e,s,i=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(e===setTimeout)return setTimeout(t,0);if((e===r||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(s){try{return e.call(null,t,0)}catch(s){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:r}catch(t){e=r}try{s="function"==typeof clearTimeout?clearTimeout:n}catch(t){s=n}}();var a,A=[],l=!1,h=-1;function d(){l&&a&&(l=!1,a.length?A=a.concat(A):h=-1,A.length&&c())}function c(){if(!l){var t=o(d);l=!0;for(var e=A.length;e;){for(a=A,A=[];++h<e;)a&&a[h].run();h=-1,e=A.length}a=null,l=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===n||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(t)}}function u(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)e[s-1]=arguments[s];A.push(new u(t,e)),1!==A.length||l||o(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},509:(t,e,s)=>{var i=s(764),r=i.Buffer;function n(t,e){for(var s in t)e[s]=t[s]}function o(t,e,s){return r(t,e,s)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=i:(n(i,e),e.Buffer=o),n(r,o),o.from=function(t,e,s){if("number"==typeof t)throw new TypeError("Argument must not be a number");return r(t,e,s)},o.alloc=function(t,e,s){if("number"!=typeof t)throw new TypeError("Argument must be a number");var i=r(t);return void 0!==e?"string"==typeof s?i.fill(e,s):i.fill(e):i.fill(0),i},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i.SlowBuffer(t)}},99:(t,e,s)=>{!function(t){t.parser=function(t,e){return new r(t,e)},t.SAXParser=r,t.SAXStream=o,t.createStream=function(t,e){return new o(t,e)},t.MAX_BUFFER_LENGTH=65536;var e,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function r(e,s){if(!(this instanceof r))return new r(e,s);var n=this;!function(t){for(var e=0,s=i.length;e<s;e++)t[i[e]]=""}(n),n.q=n.c="",n.bufferCheckPosition=t.MAX_BUFFER_LENGTH,n.opt=s||{},n.opt.lowercase=n.opt.lowercase||n.opt.lowercasetags,n.looseCase=n.opt.lowercase?"toLowerCase":"toUpperCase",n.tags=[],n.closed=n.closedRoot=n.sawRoot=!1,n.tag=n.error=null,n.strict=!!e,n.noscript=!(!e&&!n.opt.noscript),n.state=b.BEGIN,n.strictEntities=n.opt.strictEntities,n.ENTITIES=n.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),n.attribList=[],n.opt.xmlns&&(n.ns=Object.create(l)),n.trackPosition=!1!==n.opt.position,n.trackPosition&&(n.position=n.line=n.column=0),B(n,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var s in t)t.hasOwnProperty(s)&&e.push(s);return e}),r.prototype={end:function(){I(this)},write:function(e){var s=this;if(this.error)throw this.error;if(s.closed)return S(s,"Cannot write after close. Assign an onready handler.");if(null===e)return I(s);"object"==typeof e&&(e=e.toString());for(var r=0,n="";n=Q(e,r++),s.c=n,n;)switch(s.trackPosition&&(s.position++,"\n"===n?(s.line++,s.column=0):s.column++),s.state){case b.BEGIN:if(s.state=b.BEGIN_WHITESPACE,"\ufeff"===n)continue;H(s,n);continue;case b.BEGIN_WHITESPACE:H(s,n);continue;case b.TEXT:if(s.sawRoot&&!s.closedRoot){for(var o=r-1;n&&"<"!==n&&"&"!==n;)(n=Q(e,r++))&&s.trackPosition&&(s.position++,"\n"===n?(s.line++,s.column=0):s.column++);s.textNode+=e.substring(o,r-1)}"<"!==n||s.sawRoot&&s.closedRoot&&!s.strict?(p(n)||s.sawRoot&&!s.closedRoot||R(s,"Text data outside of root node."),"&"===n?s.state=b.TEXT_ENTITY:s.textNode+=n):(s.state=b.OPEN_WAKA,s.startTagPosition=s.position);continue;case b.SCRIPT:"<"===n?s.state=b.SCRIPT_ENDING:s.script+=n;continue;case b.SCRIPT_ENDING:"/"===n?s.state=b.CLOSE_TAG:(s.script+="<"+n,s.state=b.SCRIPT);continue;case b.OPEN_WAKA:if("!"===n)s.state=b.SGML_DECL,s.sgmlDecl="";else if(p(n));else if(f(h,n))s.state=b.OPEN_TAG,s.tagName=n;else if("/"===n)s.state=b.CLOSE_TAG,s.tagName="";else if("?"===n)s.state=b.PROC_INST,s.procInstName=s.procInstBody="";else{if(R(s,"Unencoded <"),s.startTagPosition+1<s.position){var a=s.position-s.startTagPosition;n=new Array(a).join(" ")+n}s.textNode+="<"+n,s.state=b.TEXT}continue;case b.SGML_DECL:"[CDATA["===(s.sgmlDecl+n).toUpperCase()?(E(s,"onopencdata"),s.state=b.CDATA,s.sgmlDecl="",s.cdata=""):s.sgmlDecl+n==="--"?(s.state=b.COMMENT,s.comment="",s.sgmlDecl=""):"DOCTYPE"===(s.sgmlDecl+n).toUpperCase()?(s.state=b.DOCTYPE,(s.doctype||s.sawRoot)&&R(s,"Inappropriately located doctype declaration"),s.doctype="",s.sgmlDecl=""):">"===n?(E(s,"onsgmldeclaration",s.sgmlDecl),s.sgmlDecl="",s.state=b.TEXT):_(n)?(s.state=b.SGML_DECL_QUOTED,s.sgmlDecl+=n):s.sgmlDecl+=n;continue;case b.SGML_DECL_QUOTED:n===s.q&&(s.state=b.SGML_DECL,s.q=""),s.sgmlDecl+=n;continue;case b.DOCTYPE:">"===n?(s.state=b.TEXT,E(s,"ondoctype",s.doctype),s.doctype=!0):(s.doctype+=n,"["===n?s.state=b.DOCTYPE_DTD:_(n)&&(s.state=b.DOCTYPE_QUOTED,s.q=n));continue;case b.DOCTYPE_QUOTED:s.doctype+=n,n===s.q&&(s.q="",s.state=b.DOCTYPE);continue;case b.DOCTYPE_DTD:s.doctype+=n,"]"===n?s.state=b.DOCTYPE:_(n)&&(s.state=b.DOCTYPE_DTD_QUOTED,s.q=n);continue;case b.DOCTYPE_DTD_QUOTED:s.doctype+=n,n===s.q&&(s.state=b.DOCTYPE_DTD,s.q="");continue;case b.COMMENT:"-"===n?s.state=b.COMMENT_ENDING:s.comment+=n;continue;case b.COMMENT_ENDING:"-"===n?(s.state=b.COMMENT_ENDED,s.comment=x(s.opt,s.comment),s.comment&&E(s,"oncomment",s.comment),s.comment=""):(s.comment+="-"+n,s.state=b.COMMENT);continue;case b.COMMENT_ENDED:">"!==n?(R(s,"Malformed comment"),s.comment+="--"+n,s.state=b.COMMENT):s.state=b.TEXT;continue;case b.CDATA:"]"===n?s.state=b.CDATA_ENDING:s.cdata+=n;continue;case b.CDATA_ENDING:"]"===n?s.state=b.CDATA_ENDING_2:(s.cdata+="]"+n,s.state=b.CDATA);continue;case b.CDATA_ENDING_2:">"===n?(s.cdata&&E(s,"oncdata",s.cdata),E(s,"onclosecdata"),s.cdata="",s.state=b.TEXT):"]"===n?s.cdata+="]":(s.cdata+="]]"+n,s.state=b.CDATA);continue;case b.PROC_INST:"?"===n?s.state=b.PROC_INST_ENDING:p(n)?s.state=b.PROC_INST_BODY:s.procInstName+=n;continue;case b.PROC_INST_BODY:if(!s.procInstBody&&p(n))continue;"?"===n?s.state=b.PROC_INST_ENDING:s.procInstBody+=n;continue;case b.PROC_INST_ENDING:">"===n?(E(s,"onprocessinginstruction",{name:s.procInstName,body:s.procInstBody}),s.procInstName=s.procInstBody="",s.state=b.TEXT):(s.procInstBody+="?"+n,s.state=b.PROC_INST_BODY);continue;case b.OPEN_TAG:f(d,n)?s.tagName+=n:(T(s),">"===n?D(s):"/"===n?s.state=b.OPEN_TAG_SLASH:(p(n)||R(s,"Invalid character in tag name"),s.state=b.ATTRIB));continue;case b.OPEN_TAG_SLASH:">"===n?(D(s,!0),L(s)):(R(s,"Forward-slash in opening tag not followed by >"),s.state=b.ATTRIB);continue;case b.ATTRIB:if(p(n))continue;">"===n?D(s):"/"===n?s.state=b.OPEN_TAG_SLASH:f(h,n)?(s.attribName=n,s.attribValue="",s.state=b.ATTRIB_NAME):R(s,"Invalid attribute name");continue;case b.ATTRIB_NAME:"="===n?s.state=b.ATTRIB_VALUE:">"===n?(R(s,"Attribute without value"),s.attribValue=s.attribName,F(s),D(s)):p(n)?s.state=b.ATTRIB_NAME_SAW_WHITE:f(d,n)?s.attribName+=n:R(s,"Invalid attribute name");continue;case b.ATTRIB_NAME_SAW_WHITE:if("="===n)s.state=b.ATTRIB_VALUE;else{if(p(n))continue;R(s,"Attribute without value"),s.tag.attributes[s.attribName]="",s.attribValue="",E(s,"onattribute",{name:s.attribName,value:""}),s.attribName="",">"===n?D(s):f(h,n)?(s.attribName=n,s.state=b.ATTRIB_NAME):(R(s,"Invalid attribute name"),s.state=b.ATTRIB)}continue;case b.ATTRIB_VALUE:if(p(n))continue;_(n)?(s.q=n,s.state=b.ATTRIB_VALUE_QUOTED):(R(s,"Unquoted attribute value"),s.state=b.ATTRIB_VALUE_UNQUOTED,s.attribValue=n);continue;case b.ATTRIB_VALUE_QUOTED:if(n!==s.q){"&"===n?s.state=b.ATTRIB_VALUE_ENTITY_Q:s.attribValue+=n;continue}F(s),s.q="",s.state=b.ATTRIB_VALUE_CLOSED;continue;case b.ATTRIB_VALUE_CLOSED:p(n)?s.state=b.ATTRIB:">"===n?D(s):"/"===n?s.state=b.OPEN_TAG_SLASH:f(h,n)?(R(s,"No whitespace between attributes"),s.attribName=n,s.attribValue="",s.state=b.ATTRIB_NAME):R(s,"Invalid attribute name");continue;case b.ATTRIB_VALUE_UNQUOTED:if(!g(n)){"&"===n?s.state=b.ATTRIB_VALUE_ENTITY_U:s.attribValue+=n;continue}F(s),">"===n?D(s):s.state=b.ATTRIB;continue;case b.CLOSE_TAG:if(s.tagName)">"===n?L(s):f(d,n)?s.tagName+=n:s.script?(s.script+="</"+s.tagName,s.tagName="",s.state=b.SCRIPT):(p(n)||R(s,"Invalid tagname in closing tag"),s.state=b.CLOSE_TAG_SAW_WHITE);else{if(p(n))continue;m(h,n)?s.script?(s.script+="</"+n,s.state=b.SCRIPT):R(s,"Invalid tagname in closing tag."):s.tagName=n}continue;case b.CLOSE_TAG_SAW_WHITE:if(p(n))continue;">"===n?L(s):R(s,"Invalid characters in closing tag");continue;case b.TEXT_ENTITY:case b.ATTRIB_VALUE_ENTITY_Q:case b.ATTRIB_VALUE_ENTITY_U:var A,l;switch(s.state){case b.TEXT_ENTITY:A=b.TEXT,l="textNode";break;case b.ATTRIB_VALUE_ENTITY_Q:A=b.ATTRIB_VALUE_QUOTED,l="attribValue";break;case b.ATTRIB_VALUE_ENTITY_U:A=b.ATTRIB_VALUE_UNQUOTED,l="attribValue"}";"===n?(s[l]+=N(s),s.entity="",s.state=A):f(s.entity.length?u:c,n)?s.entity+=n:(R(s,"Invalid character in entity name"),s[l]+="&"+s.entity+n,s.entity="",s.state=A);continue;default:throw new Error(s,"Unknown state: "+s.state)}return s.position>=s.bufferCheckPosition&&function(e){for(var s=Math.max(t.MAX_BUFFER_LENGTH,10),r=0,n=0,o=i.length;n<o;n++){var a=e[i[n]].length;if(a>s)switch(i[n]){case"textNode":P(e);break;case"cdata":E(e,"oncdata",e.cdata),e.cdata="";break;case"script":E(e,"onscript",e.script),e.script="";break;default:S(e,"Max buffer length exceeded: "+i[n])}r=Math.max(r,a)}var A=t.MAX_BUFFER_LENGTH-r;e.bufferCheckPosition=A+e.position}(s),s},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;P(t=this),""!==t.cdata&&(E(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(E(t,"onscript",t.script),t.script="")}};try{e=s(830).Stream}catch(t){e=function(){}}var n=t.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function o(t,s){if(!(this instanceof o))return new o(t,s);e.apply(this),this._parser=new r(t,s),this.writable=!0,this.readable=!0;var i=this;this._parser.onend=function(){i.emit("end")},this._parser.onerror=function(t){i.emit("error",t),i._parser.error=null},this._decoder=null,n.forEach((function(t){Object.defineProperty(i,"on"+t,{get:function(){return i._parser["on"+t]},set:function(e){if(!e)return i.removeAllListeners(t),i._parser["on"+t]=e,e;i.on(t,e)},enumerable:!0,configurable:!1})}))}o.prototype=Object.create(e.prototype,{constructor:{value:o}}),o.prototype.write=function(t){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)){if(!this._decoder){var e=s(553).s;this._decoder=new e("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},o.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},o.prototype.on=function(t,s){var i=this;return i._parser["on"+t]||-1===n.indexOf(t)||(i._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),i.emit.apply(i,e)}),e.prototype.on.call(i,t,s)};var a="http://www.w3.org/XML/1998/namespace",A="http://www.w3.org/2000/xmlns/",l={xml:a,xmlns:A},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,c=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,u=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function p(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function _(t){return'"'===t||"'"===t}function g(t){return">"===t||p(t)}function f(t,e){return t.test(e)}function m(t,e){return!f(t,e)}var w,y,C,b=0;for(var v in t.STATE={BEGIN:b++,BEGIN_WHITESPACE:b++,TEXT:b++,TEXT_ENTITY:b++,OPEN_WAKA:b++,SGML_DECL:b++,SGML_DECL_QUOTED:b++,DOCTYPE:b++,DOCTYPE_QUOTED:b++,DOCTYPE_DTD:b++,DOCTYPE_DTD_QUOTED:b++,COMMENT_STARTING:b++,COMMENT:b++,COMMENT_ENDING:b++,COMMENT_ENDED:b++,CDATA:b++,CDATA_ENDING:b++,CDATA_ENDING_2:b++,PROC_INST:b++,PROC_INST_BODY:b++,PROC_INST_ENDING:b++,OPEN_TAG:b++,OPEN_TAG_SLASH:b++,ATTRIB:b++,ATTRIB_NAME:b++,ATTRIB_NAME_SAW_WHITE:b++,ATTRIB_VALUE:b++,ATTRIB_VALUE_QUOTED:b++,ATTRIB_VALUE_CLOSED:b++,ATTRIB_VALUE_UNQUOTED:b++,ATTRIB_VALUE_ENTITY_Q:b++,ATTRIB_VALUE_ENTITY_U:b++,CLOSE_TAG:b++,CLOSE_TAG_SAW_WHITE:b++,SCRIPT:b++,SCRIPT_ENDING:b++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var s=t.ENTITIES[e],i="number"==typeof s?String.fromCharCode(s):s;t.ENTITIES[e]=i})),t.STATE)t.STATE[t.STATE[v]]=v;function B(t,e,s){t[e]&&t[e](s)}function E(t,e,s){t.textNode&&P(t),B(t,e,s)}function P(t){t.textNode=x(t.opt,t.textNode),t.textNode&&B(t,"ontext",t.textNode),t.textNode=""}function x(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function S(t,e){return P(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,B(t,"onerror",e),t}function I(t){return t.sawRoot&&!t.closedRoot&&R(t,"Unclosed root tag"),t.state!==b.BEGIN&&t.state!==b.BEGIN_WHITESPACE&&t.state!==b.TEXT&&S(t,"Unexpected end"),P(t),t.c="",t.closed=!0,B(t,"onend"),r.call(t,t.strict,t.opt),t}function R(t,e){if("object"!=typeof t||!(t instanceof r))throw new Error("bad call to strictFail");t.strict&&S(t,e)}function T(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,s=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(s.ns=e.ns),t.attribList.length=0,E(t,"onopentagstart",s)}function O(t,e){var s=t.indexOf(":")<0?["",t]:t.split(":"),i=s[0],r=s[1];return e&&"xmlns"===t&&(i="xmlns",r=""),{prefix:i,local:r}}function F(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=O(t.attribName,!0),s=e.prefix,i=e.local;if("xmlns"===s)if("xml"===i&&t.attribValue!==a)R(t,"xml: prefix must be bound to "+a+"\nActual: "+t.attribValue);else if("xmlns"===i&&t.attribValue!==A)R(t,"xmlns: prefix must be bound to "+A+"\nActual: "+t.attribValue);else{var r=t.tag,n=t.tags[t.tags.length-1]||t;r.ns===n.ns&&(r.ns=Object.create(n.ns)),r.ns[i]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,E(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function D(t,e){if(t.opt.xmlns){var s=t.tag,i=O(t.tagName);s.prefix=i.prefix,s.local=i.local,s.uri=s.ns[i.prefix]||"",s.prefix&&!s.uri&&(R(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),s.uri=i.prefix);var r=t.tags[t.tags.length-1]||t;s.ns&&r.ns!==s.ns&&Object.keys(s.ns).forEach((function(e){E(t,"onopennamespace",{prefix:e,uri:s.ns[e]})}));for(var n=0,o=t.attribList.length;n<o;n++){var a=t.attribList[n],A=a[0],l=a[1],h=O(A,!0),d=h.prefix,c=h.local,u=""===d?"":s.ns[d]||"",p={name:A,value:l,prefix:d,local:c,uri:u};d&&"xmlns"!==d&&!u&&(R(t,"Unbound namespace prefix: "+JSON.stringify(d)),p.uri=d),t.tag.attributes[A]=p,E(t,"onattribute",p)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),E(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=b.TEXT:t.state=b.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function L(t){if(!t.tagName)return R(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=b.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=b.SCRIPT);E(t,"onscript",t.script),t.script=""}var e=t.tags.length,s=t.tagName;t.strict||(s=s[t.looseCase]());for(var i=s;e--&&t.tags[e].name!==i;)R(t,"Unexpected close tag");if(e<0)return R(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=b.TEXT);t.tagName=s;for(var r=t.tags.length;r-- >e;){var n=t.tag=t.tags.pop();t.tagName=t.tag.name,E(t,"onclosetag",t.tagName);var o={};for(var a in n.ns)o[a]=n.ns[a];var A=t.tags[t.tags.length-1]||t;t.opt.xmlns&&n.ns!==A.ns&&Object.keys(n.ns).forEach((function(e){var s=n.ns[e];E(t,"onclosenamespace",{prefix:e,uri:s})}))}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=b.TEXT}function N(t){var e,s=t.entity,i=s.toLowerCase(),r="";return t.ENTITIES[s]?t.ENTITIES[s]:t.ENTITIES[i]?t.ENTITIES[i]:("#"===(s=i).charAt(0)&&("x"===s.charAt(1)?(s=s.slice(2),r=(e=parseInt(s,16)).toString(16)):(s=s.slice(1),r=(e=parseInt(s,10)).toString(10))),s=s.replace(/^0+/,""),isNaN(e)||r.toLowerCase()!==s?(R(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function H(t,e){"<"===e?(t.state=b.OPEN_WAKA,t.startTagPosition=t.position):p(e)||(R(t,"Non-whitespace before first tag."),t.textNode=e,t.state=b.TEXT)}function Q(t,e){var s="";return e<t.length&&(s=t.charAt(e)),s}b=t.STATE,String.fromCodePoint||(w=String.fromCharCode,y=Math.floor,C=function(){var t,e,s=16384,i=[],r=-1,n=arguments.length;if(!n)return"";for(var o="";++r<n;){var a=Number(arguments[r]);if(!isFinite(a)||a<0||a>1114111||y(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?i.push(a):(t=55296+((a-=65536)>>10),e=a%1024+56320,i.push(t,e)),(r+1===n||i.length>s)&&(o+=w.apply(null,i),i.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:C,configurable:!0,writable:!0}):String.fromCodePoint=C)}(e)},830:(t,e,s)=>{t.exports=r;var i=s(187).EventEmitter;function r(){i.call(this)}s(717)(r,i),r.Readable=s(577),r.Writable=s(323),r.Duplex=s(656),r.Transform=s(473),r.PassThrough=s(366),r.finished=s(86),r.pipeline=s(472),r.Stream=r,r.prototype.pipe=function(t,e){var s=this;function r(e){t.writable&&!1===t.write(e)&&s.pause&&s.pause()}function n(){s.readable&&s.resume&&s.resume()}s.on("data",r),t.on("drain",n),t._isStdio||e&&!1===e.end||(s.on("end",a),s.on("close",A));var o=!1;function a(){o||(o=!0,t.end())}function A(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function l(t){if(h(),0===i.listenerCount(this,"error"))throw t}function h(){s.removeListener("data",r),t.removeListener("drain",n),s.removeListener("end",a),s.removeListener("close",A),s.removeListener("error",l),t.removeListener("error",l),s.removeListener("end",h),s.removeListener("close",h),t.removeListener("close",h)}return s.on("error",l),t.on("error",l),s.on("end",h),s.on("close",h),t.on("close",h),t.emit("pipe",s),t}},106:t=>{var e={};function s(t,s,i){i||(i=Error);var r=function(t){var e,i;function r(e,i,r){return t.call(this,function(t,e,i){return"string"==typeof s?s:s(t,e,i)}(e,i,r))||this}return i=t,(e=r).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,r}(i);r.prototype.name=i.name,r.prototype.code=t,e[t]=r}function i(t,e){if(Array.isArray(t)){var s=t.length;return t=t.map((function(t){return String(t)})),s>2?"one of ".concat(e," ").concat(t.slice(0,s-1).join(", "),", or ")+t[s-1]:2===s?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}s("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),s("ERR_INVALID_ARG_TYPE",(function(t,e,s){var r,n,o,a,A;if("string"==typeof e&&(n="not ",e.substr(0,n.length)===n)?(r="must not be",e=e.replace(/^not /,"")):r="must be",function(t,e,s){return(void 0===s||s>t.length)&&(s=t.length),t.substring(s-e.length,s)===e}(t," argument"))o="The ".concat(t," ").concat(r," ").concat(i(e,"type"));else{var l=("number"!=typeof A&&(A=0),A+".".length>(a=t).length||-1===a.indexOf(".",A)?"argument":"property");o='The "'.concat(t,'" ').concat(l," ").concat(r," ").concat(i(e,"type"))}return o+". Received type ".concat(typeof s)}),TypeError),s("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),s("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),s("ERR_STREAM_PREMATURE_CLOSE","Premature close"),s("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),s("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),s("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),s("ERR_STREAM_WRITE_AFTER_END","write after end"),s("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),s("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),s("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.q=e},656:(t,e,s)=>{var i=s(155),r=Object.keys||function(t){var e=[];for(var s in t)e.push(s);return e};t.exports=h;var n=s(577),o=s(323);s(717)(h,n);for(var a=r(o.prototype),A=0;A<a.length;A++){var l=a[A];h.prototype[l]||(h.prototype[l]=o.prototype[l])}function h(t){if(!(this instanceof h))return new h(t);n.call(this,t),o.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",d)))}function d(){this._writableState.ended||i.nextTick(c,this)}function c(t){t.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})},366:(t,e,s)=>{t.exports=r;var i=s(473);function r(t){if(!(this instanceof r))return new r(t);i.call(this,t)}s(717)(r,i),r.prototype._transform=function(t,e,s){s(null,t)}},577:(t,e,s)=>{var i,r=s(155);t.exports=E,E.ReadableState=B,s(187).EventEmitter;var n,o=function(t,e){return t.listeners(e).length},a=s(194),A=s(764).Buffer,l=s.g.Uint8Array||function(){},h=s(964);n=h&&h.debuglog?h.debuglog("stream"):function(){};var d,c,u,p=s(686),_=s(29),g=s(94).getHighWaterMark,f=s(106).q,m=f.ERR_INVALID_ARG_TYPE,w=f.ERR_STREAM_PUSH_AFTER_EOF,y=f.ERR_METHOD_NOT_IMPLEMENTED,C=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;s(717)(E,a);var b=_.errorOrDestroy,v=["error","close","destroy","pause","resume"];function B(t,e,r){i=i||s(656),t=t||{},"boolean"!=typeof r&&(r=e instanceof i),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=g(this,t,"readableHighWaterMark",r),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=s(553).s),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function E(t){if(i=i||s(656),!(this instanceof E))return new E(t);var e=this instanceof i;this._readableState=new B(t,this,e),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),a.call(this)}function P(t,e,s,i,r){n("readableAddChunk",e);var o,a=t._readableState;if(null===e)a.reading=!1,function(t,e){if(n("onEofChunk"),!e.ended){if(e.decoder){var s=e.decoder.end();s&&s.length&&(e.buffer.push(s),e.length+=e.objectMode?1:s.length)}e.ended=!0,e.sync?R(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,T(t)))}}(t,a);else if(r||(o=function(t,e){var s,i;return i=e,A.isBuffer(i)||i instanceof l||"string"==typeof e||void 0===e||t.objectMode||(s=new m("chunk",["string","Buffer","Uint8Array"],e)),s}(a,e)),o)b(t,o);else if(a.objectMode||e&&e.length>0)if("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===A.prototype||(e=function(t){return A.from(t)}(e)),i)a.endEmitted?b(t,new C):x(t,a,e,!0);else if(a.ended)b(t,new w);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!s?(e=a.decoder.write(e),a.objectMode||0!==e.length?x(t,a,e,!1):O(t,a)):x(t,a,e,!1)}else i||(a.reading=!1,O(t,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function x(t,e,s,i){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",s)):(e.length+=e.objectMode?1:s.length,i?e.buffer.unshift(s):e.buffer.push(s),e.needReadable&&R(t)),O(t,e)}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),E.prototype.destroy=_.destroy,E.prototype._undestroy=_.undestroy,E.prototype._destroy=function(t,e){e(t)},E.prototype.push=function(t,e){var s,i=this._readableState;return i.objectMode?s=!0:"string"==typeof t&&((e=e||i.defaultEncoding)!==i.encoding&&(t=A.from(t,e),e=""),s=!0),P(this,t,e,!1,s)},E.prototype.unshift=function(t){return P(this,t,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(t){d||(d=s(553).s);var e=new d(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,r="";null!==i;)r+=e.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var S=1073741824;function I(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=S?t=S:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function R(t){var e=t._readableState;n("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(n("emitReadable",e.flowing),e.emittedReadable=!0,r.nextTick(T,t))}function T(t){var e=t._readableState;n("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,H(t)}function O(t,e){e.readingMore||(e.readingMore=!0,r.nextTick(F,t,e))}function F(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var s=e.length;if(n("maybeReadMore read 0"),t.read(0),s===e.length)break}e.readingMore=!1}function D(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function L(t){n("readable nexttick read 0"),t.read(0)}function N(t,e){n("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),H(t),e.flowing&&!e.reading&&t.read(0)}function H(t){var e=t._readableState;for(n("flow",e.flowing);e.flowing&&null!==t.read(););}function Q(t,e){return 0===e.length?null:(e.objectMode?s=e.buffer.shift():!t||t>=e.length?(s=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):s=e.buffer.consume(t,e.decoder),s);var s}function U(t){var e=t._readableState;n("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,r.nextTick(M,e,t))}function M(t,e){if(n("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var s=e._writableState;(!s||s.autoDestroy&&s.finished)&&e.destroy()}}function k(t,e){for(var s=0,i=t.length;s<i;s++)if(t[s]===e)return s;return-1}E.prototype.read=function(t){n("read",t),t=parseInt(t,10);var e=this._readableState,s=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return n("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?U(this):R(this),null;if(0===(t=I(t,e))&&e.ended)return 0===e.length&&U(this),null;var i,r=e.needReadable;return n("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&n("length less than watermark",r=!0),e.ended||e.reading?n("reading or ended",r=!1):r&&(n("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=I(s,e))),null===(i=t>0?Q(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),s!==t&&e.ended&&U(this)),null!==i&&this.emit("data",i),i},E.prototype._read=function(t){b(this,new y("_read()"))},E.prototype.pipe=function(t,e){var s=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t)}i.pipesCount+=1,n("pipe count=%d opts=%j",i.pipesCount,e);var a=e&&!1===e.end||t===r.stdout||t===r.stderr?_:A;function A(){n("onend"),t.end()}i.endEmitted?r.nextTick(a):s.once("end",a),t.on("unpipe",(function e(r,o){n("onunpipe"),r===s&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,n("cleanup"),t.removeListener("close",u),t.removeListener("finish",p),t.removeListener("drain",l),t.removeListener("error",c),t.removeListener("unpipe",e),s.removeListener("end",A),s.removeListener("end",_),s.removeListener("data",d),h=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||l())}));var l=function(t){return function(){var e=t._readableState;n("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(t,"data")&&(e.flowing=!0,H(t))}}(s);t.on("drain",l);var h=!1;function d(e){n("ondata");var r=t.write(e);n("dest.write",r),!1===r&&((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==k(i.pipes,t))&&!h&&(n("false write response, pause",i.awaitDrain),i.awaitDrain++),s.pause())}function c(e){n("onerror",e),_(),t.removeListener("error",c),0===o(t,"error")&&b(t,e)}function u(){t.removeListener("finish",p),_()}function p(){n("onfinish"),t.removeListener("close",u),_()}function _(){n("unpipe"),s.unpipe(t)}return s.on("data",d),function(t,e,s){if("function"==typeof t.prependListener)return t.prependListener(e,s);t._events&&t._events.error?Array.isArray(t._events.error)?t._events.error.unshift(s):t._events.error=[s,t._events.error]:t.on(e,s)}(t,"error",c),t.once("close",u),t.once("finish",p),t.emit("pipe",s),i.flowing||(n("pipe resume"),s.resume()),t},E.prototype.unpipe=function(t){var e=this._readableState,s={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,s)),this;if(!t){var i=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var n=0;n<r;n++)i[n].emit("unpipe",this,{hasUnpiped:!1});return this}var o=k(e.pipes,t);return-1===o||(e.pipes.splice(o,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,s)),this},E.prototype.on=function(t,e){var s=a.prototype.on.call(this,t,e),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===t&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,n("on readable",i.length,i.reading),i.length?R(this):i.reading||r.nextTick(L,this))),s},E.prototype.addListener=E.prototype.on,E.prototype.removeListener=function(t,e){var s=a.prototype.removeListener.call(this,t,e);return"readable"===t&&r.nextTick(D,this),s},E.prototype.removeAllListeners=function(t){var e=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||r.nextTick(D,this),e},E.prototype.resume=function(){var t=this._readableState;return t.flowing||(n("resume"),t.flowing=!t.readableListening,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,r.nextTick(N,t,e))}(this,t)),t.paused=!1,this},E.prototype.pause=function(){return n("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(n("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},E.prototype.wrap=function(t){var e=this,s=this._readableState,i=!1;for(var r in t.on("end",(function(){if(n("wrapped end"),s.decoder&&!s.ended){var t=s.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(r){n("wrapped data"),s.decoder&&(r=s.decoder.write(r)),s.objectMode&&null==r||(s.objectMode||r&&r.length)&&(e.push(r)||(i=!0,t.pause()))})),t)void 0===this[r]&&"function"==typeof t[r]&&(this[r]=function(e){return function(){return t[e].apply(t,arguments)}}(r));for(var o=0;o<v.length;o++)t.on(v[o],this.emit.bind(this,v[o]));return this._read=function(e){n("wrapped _read",e),i&&(i=!1,t.resume())},this},"function"==typeof Symbol&&(E.prototype[Symbol.asyncIterator]=function(){return void 0===c&&(c=s(828)),c(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),E._fromList=Q,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(E.from=function(t,e){return void 0===u&&(u=s(265)),u(E,t,e)})},473:(t,e,s)=>{t.exports=h;var i=s(106).q,r=i.ERR_METHOD_NOT_IMPLEMENTED,n=i.ERR_MULTIPLE_CALLBACK,o=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=i.ERR_TRANSFORM_WITH_LENGTH_0,A=s(656);function l(t,e){var s=this._transformState;s.transforming=!1;var i=s.writecb;if(null===i)return this.emit("error",new n);s.writechunk=null,s.writecb=null,null!=e&&this.push(e),i(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function h(t){if(!(this instanceof h))return new h(t);A.call(this,t),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",d)}function d(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?c(this,null,null):this._flush((function(e,s){c(t,e,s)}))}function c(t,e,s){if(e)return t.emit("error",e);if(null!=s&&t.push(s),t._writableState.length)throw new a;if(t._transformState.transforming)throw new o;return t.push(null)}s(717)(h,A),h.prototype.push=function(t,e){return this._transformState.needTransform=!1,A.prototype.push.call(this,t,e)},h.prototype._transform=function(t,e,s){s(new r("_transform()"))},h.prototype._write=function(t,e,s){var i=this._transformState;if(i.writecb=s,i.writechunk=t,i.writeencoding=e,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},h.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},h.prototype._destroy=function(t,e){A.prototype._destroy.call(this,t,(function(t){e(t)}))}},323:(t,e,s)=>{var i,r=s(155);function n(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,s){var i=t.entry;for(t.entry=null;i;){var r=i.callback;e.pendingcb--,r(void 0),i=i.next}e.corkedRequestsFree.next=t}(e,t)}}t.exports=E,E.WritableState=B;var o,a={deprecate:s(927)},A=s(194),l=s(764).Buffer,h=s.g.Uint8Array||function(){},d=s(29),c=s(94).getHighWaterMark,u=s(106).q,p=u.ERR_INVALID_ARG_TYPE,_=u.ERR_METHOD_NOT_IMPLEMENTED,g=u.ERR_MULTIPLE_CALLBACK,f=u.ERR_STREAM_CANNOT_PIPE,m=u.ERR_STREAM_DESTROYED,w=u.ERR_STREAM_NULL_VALUES,y=u.ERR_STREAM_WRITE_AFTER_END,C=u.ERR_UNKNOWN_ENCODING,b=d.errorOrDestroy;function v(){}function B(t,e,o){i=i||s(656),t=t||{},"boolean"!=typeof o&&(o=e instanceof i),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=c(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var s=t._writableState,i=s.sync,n=s.writecb;if("function"!=typeof n)throw new g;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(s),e)!function(t,e,s,i,n){--e.pendingcb,s?(r.nextTick(n,i),r.nextTick(T,t,e),t._writableState.errorEmitted=!0,b(t,i)):(n(i),t._writableState.errorEmitted=!0,b(t,i),T(t,e))}(t,s,i,e,n);else{var o=I(s)||t.destroyed;o||s.corked||s.bufferProcessing||!s.bufferedRequest||S(t,s),i?r.nextTick(x,t,s,o,n):x(t,s,o,n)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function E(t){var e=this instanceof(i=i||s(656));if(!e&&!o.call(E,this))return new E(t);this._writableState=new B(t,this,e),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),A.call(this)}function P(t,e,s,i,r,n,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new m("write")):s?t._writev(r,e.onwrite):t._write(r,n,e.onwrite),e.sync=!1}function x(t,e,s,i){s||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,i(),T(t,e)}function S(t,e){e.bufferProcessing=!0;var s=e.bufferedRequest;if(t._writev&&s&&s.next){var i=e.bufferedRequestCount,r=new Array(i),o=e.corkedRequestsFree;o.entry=s;for(var a=0,A=!0;s;)r[a]=s,s.isBuf||(A=!1),s=s.next,a+=1;r.allBuffers=A,P(t,e,!0,e.length,r,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new n(e),e.bufferedRequestCount=0}else{for(;s;){var l=s.chunk,h=s.encoding,d=s.callback;if(P(t,e,!1,e.objectMode?1:l.length,l,h,d),s=s.next,e.bufferedRequestCount--,e.writing)break}null===s&&(e.lastBufferedRequest=null)}e.bufferedRequest=s,e.bufferProcessing=!1}function I(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function R(t,e){t._final((function(s){e.pendingcb--,s&&b(t,s),e.prefinished=!0,t.emit("prefinish"),T(t,e)}))}function T(t,e){var s=I(e);if(s&&(function(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,r.nextTick(R,t,e)))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var i=t._readableState;(!i||i.autoDestroy&&i.endEmitted)&&t.destroy()}return s}s(717)(E,A),B.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(B.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(t){return!!o.call(this,t)||this===E&&t&&t._writableState instanceof B}})):o=function(t){return t instanceof this},E.prototype.pipe=function(){b(this,new f)},E.prototype.write=function(t,e,s){var i,n=this._writableState,o=!1,a=!n.objectMode&&(i=t,l.isBuffer(i)||i instanceof h);return a&&!l.isBuffer(t)&&(t=function(t){return l.from(t)}(t)),"function"==typeof e&&(s=e,e=null),a?e="buffer":e||(e=n.defaultEncoding),"function"!=typeof s&&(s=v),n.ending?function(t,e){var s=new y;b(t,s),r.nextTick(e,s)}(this,s):(a||function(t,e,s,i){var n;return null===s?n=new w:"string"==typeof s||e.objectMode||(n=new p("chunk",["string","Buffer"],s)),!n||(b(t,n),r.nextTick(i,n),!1)}(this,n,t,s))&&(n.pendingcb++,o=function(t,e,s,i,r,n){if(!s){var o=function(t,e,s){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=l.from(e,s)),e}(e,i,r);i!==o&&(s=!0,r="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var A=e.length<e.highWaterMark;if(A||(e.needDrain=!0),e.writing||e.corked){var h=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:r,isBuf:s,callback:n,next:null},h?h.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else P(t,e,!1,a,i,r,n);return A}(this,n,a,t,e,s)),o},E.prototype.cork=function(){this._writableState.corked++},E.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||S(this,t))},E.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new C(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(E.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),E.prototype._write=function(t,e,s){s(new _("_write()"))},E.prototype._writev=null,E.prototype.end=function(t,e,s){var i=this._writableState;return"function"==typeof t?(s=t,t=null,e=null):"function"==typeof e&&(s=e,e=null),null!=t&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||function(t,e,s){e.ending=!0,T(t,e),s&&(e.finished?r.nextTick(s):t.once("finish",s)),e.ended=!0,t.writable=!1}(this,i,s),this},Object.defineProperty(E.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),E.prototype.destroy=d.destroy,E.prototype._undestroy=d.undestroy,E.prototype._destroy=function(t,e){e(t)}},828:(t,e,s)=>{var i,r=s(155);function n(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var o=s(86),a=Symbol("lastResolve"),A=Symbol("lastReject"),l=Symbol("error"),h=Symbol("ended"),d=Symbol("lastPromise"),c=Symbol("handlePromise"),u=Symbol("stream");function p(t,e){return{value:t,done:e}}function _(t){var e=t[a];if(null!==e){var s=t[u].read();null!==s&&(t[d]=null,t[a]=null,t[A]=null,e(p(s,!1)))}}function g(t){r.nextTick(_,t)}var f=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((n(i={get stream(){return this[u]},next:function(){var t=this,e=this[l];if(null!==e)return Promise.reject(e);if(this[h])return Promise.resolve(p(void 0,!0));if(this[u].destroyed)return new Promise((function(e,s){r.nextTick((function(){t[l]?s(t[l]):e(p(void 0,!0))}))}));var s,i=this[d];if(i)s=new Promise(function(t,e){return function(s,i){t.then((function(){e[h]?s(p(void 0,!0)):e[c](s,i)}),i)}}(i,this));else{var n=this[u].read();if(null!==n)return Promise.resolve(p(n,!1));s=new Promise(this[c])}return this[d]=s,s}},Symbol.asyncIterator,(function(){return this})),n(i,"return",(function(){var t=this;return new Promise((function(e,s){t[u].destroy(null,(function(t){t?s(t):e(p(void 0,!0))}))}))})),i),f);t.exports=function(t){var e,s=Object.create(m,(n(e={},u,{value:t,writable:!0}),n(e,a,{value:null,writable:!0}),n(e,A,{value:null,writable:!0}),n(e,l,{value:null,writable:!0}),n(e,h,{value:t._readableState.endEmitted,writable:!0}),n(e,c,{value:function(t,e){var i=s[u].read();i?(s[d]=null,s[a]=null,s[A]=null,t(p(i,!1))):(s[a]=t,s[A]=e)},writable:!0}),e));return s[d]=null,o(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=s[A];return null!==e&&(s[d]=null,s[a]=null,s[A]=null,e(t)),void(s[l]=t)}var i=s[a];null!==i&&(s[d]=null,s[a]=null,s[A]=null,i(p(void 0,!0))),s[h]=!0})),t.on("readable",g.bind(null,s)),s}},686:(t,e,s)=>{function i(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function n(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o=s(764).Buffer,a=s(862).inspect,A=a&&a.custom||"inspect";t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}var e;return e=[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,s=""+e.data;e=e.next;)s+=t+e.data;return s}},{key:"concat",value:function(t){if(0===this.length)return o.alloc(0);for(var e,s,i,r=o.allocUnsafe(t>>>0),n=this.head,a=0;n;)e=n.data,s=r,i=a,o.prototype.copy.call(e,s,i),a+=n.data.length,n=n.next;return r}},{key:"consume",value:function(t,e){var s;return t<this.head.data.length?(s=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):s=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),s}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,s=1,i=e.data;for(t-=i.length;e=e.next;){var r=e.data,n=t>r.length?r.length:t;if(n===r.length?i+=r:i+=r.slice(0,t),0==(t-=n)){n===r.length?(++s,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=r.slice(n));break}++s}return this.length-=s,i}},{key:"_getBuffer",value:function(t){var e=o.allocUnsafe(t),s=this.head,i=1;for(s.data.copy(e),t-=s.data.length;s=s.next;){var r=s.data,n=t>r.length?r.length:t;if(r.copy(e,e.length-t,0,n),0==(t-=n)){n===r.length?(++i,s.next?this.head=s.next:this.head=this.tail=null):(this.head=s,s.data=r.slice(n));break}++i}return this.length-=i,e}},{key:A,value:function(t,e){return a(this,function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?i(Object(s),!0).forEach((function(e){r(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},e,{depth:0,customInspect:!1}))}}],e&&n(t.prototype,e),t}()},29:(t,e,s)=>{var i=s(155);function r(t,e){o(t,e),n(t)}function n(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function o(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var s=this,a=this._readableState&&this._readableState.destroyed,A=this._writableState&&this._writableState.destroyed;return a||A?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(o,this,t)):i.nextTick(o,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?s._writableState?s._writableState.errorEmitted?i.nextTick(n,s):(s._writableState.errorEmitted=!0,i.nextTick(r,s,t)):i.nextTick(r,s,t):e?(i.nextTick(n,s),e(t)):i.nextTick(n,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var s=t._readableState,i=t._writableState;s&&s.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}}},86:(t,e,s)=>{var i=s(106).q.ERR_STREAM_PREMATURE_CLOSE;function r(){}t.exports=function t(e,s,n){if("function"==typeof s)return t(e,null,s);s||(s={}),n=function(t){var e=!1;return function(){if(!e){e=!0;for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];t.apply(this,i)}}}(n||r);var o=s.readable||!1!==s.readable&&e.readable,a=s.writable||!1!==s.writable&&e.writable,A=function(){e.writable||h()},l=e._writableState&&e._writableState.finished,h=function(){a=!1,l=!0,o||n.call(e)},d=e._readableState&&e._readableState.endEmitted,c=function(){o=!1,d=!0,a||n.call(e)},u=function(t){n.call(e,t)},p=function(){var t;return o&&!d?(e._readableState&&e._readableState.ended||(t=new i),n.call(e,t)):a&&!l?(e._writableState&&e._writableState.ended||(t=new i),n.call(e,t)):void 0},_=function(){e.req.on("finish",h)};return function(t){return t.setHeader&&"function"==typeof t.abort}(e)?(e.on("complete",h),e.on("abort",p),e.req?_():e.on("request",_)):a&&!e._writableState&&(e.on("end",A),e.on("close",A)),e.on("end",c),e.on("finish",h),!1!==s.error&&e.on("error",u),e.on("close",p),function(){e.removeListener("complete",h),e.removeListener("abort",p),e.removeListener("request",_),e.req&&e.req.removeListener("finish",h),e.removeListener("end",A),e.removeListener("close",A),e.removeListener("finish",h),e.removeListener("end",c),e.removeListener("error",u),e.removeListener("close",p)}}},265:t=>{t.exports=function(){throw new Error("Readable.from is not available in the browser")}},472:(t,e,s)=>{var i,r=s(106).q,n=r.ERR_MISSING_ARGS,o=r.ERR_STREAM_DESTROYED;function a(t){if(t)throw t}function A(t,e,r,n){n=function(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}(n);var a=!1;t.on("close",(function(){a=!0})),void 0===i&&(i=s(86)),i(t,{readable:e,writable:r},(function(t){if(t)return n(t);a=!0,n()}));var A=!1;return function(e){if(!a&&!A)return A=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void n(e||new o("pipe"))}}function l(t){t()}function h(t,e){return t.pipe(e)}function d(t){return t.length?"function"!=typeof t[t.length-1]?a:t.pop():a}t.exports=function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];var i,r=d(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new n("streams");var o=e.map((function(t,s){var n=s<e.length-1;return A(t,n,s>0,(function(t){i||(i=t),t&&o.forEach(l),n||(o.forEach(l),r(i))}))}));return e.reduce(h)}},94:(t,e,s)=>{var i=s(106).q.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(t,e,s,r){var n=function(t,e,s){return null!=t.highWaterMark?t.highWaterMark:e?t[s]:null}(e,r,s);if(null!=n){if(!isFinite(n)||Math.floor(n)!==n||n<0)throw new i(r?s:"highWaterMark",n);return Math.floor(n)}return t.objectMode?16:16384}}},194:(t,e,s)=>{t.exports=s(187).EventEmitter},553:(t,e,s)=>{var i=s(509).Buffer,r=i.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(i.isEncoding===r||!r(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=A,this.end=l,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=h,this.end=d,e=3;break;default:return this.write=c,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(e)}function o(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,s=function(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function A(t,e){if((t.length-e)%2==0){var s=t.toString("utf16le",e);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function l(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,s)}return e}function h(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function d(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function c(t){return t.toString(this.encoding)}function u(t){return t&&t.length?this.write(t):""}e.s=n,n.prototype.write=function(t){if(0===t.length)return"";var e,s;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},n.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},n.prototype.text=function(t,e){var s=function(t,e,s){var i=e.length-1;if(i<s)return 0;var r=o(e[i]);return r>=0?(r>0&&(t.lastNeed=r-1),r):--i<s||-2===r?0:(r=o(e[i]))>=0?(r>0&&(t.lastNeed=r-2),r):--i<s||-2===r?0:(r=o(e[i]))>=0?(r>0&&(2===r?r=0:t.lastNeed=r-3),r):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=s;var i=t.length-(s-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)},n.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},927:(t,e,s)=>{function i(t){try{if(!s.g.localStorage)return!1}catch(t){return!1}var e=s.g.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}t.exports=function(t,e){if(i("noDeprecation"))return t;var s=!1;return function(){if(!s){if(i("throwDeprecation"))throw new Error(e);i("traceDeprecation")?console.trace(e):console.warn(e),s=!0}return t.apply(this,arguments)}}},881:t=>{t.exports={isArray:function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}}},888:(t,e,s)=>{var i=s(229),r=s(388),n=s(501),o=s(673);t.exports={xml2js:i,xml2json:r,js2xml:n,json2xml:o}},501:(t,e,s)=>{var i,r,n=s(740),o=s(881).isArray;function a(t,e,s){return(!s&&t.spaces?"\n":"")+Array(e+1).join(t.spaces)}function A(t,e,s){if(e.ignoreAttributes)return"";"attributesFn"in e&&(t=e.attributesFn(t,r,i));var n,o,A,l,h=[];for(n in t)t.hasOwnProperty(n)&&null!==t[n]&&void 0!==t[n]&&(l=e.noQuotesForNativeAttributes&&"string"!=typeof t[n]?"":'"',o=(o=""+t[n]).replace(/"/g,"&quot;"),A="attributeNameFn"in e?e.attributeNameFn(n,o,r,i):n,h.push(e.spaces&&e.indentAttributes?a(e,s+1,!1):" "),h.push(A+"="+l+("attributeValueFn"in e?e.attributeValueFn(o,n,r,i):o)+l));return t&&Object.keys(t).length&&e.spaces&&e.indentAttributes&&h.push(a(e,s,!1)),h.join("")}function l(t,e,s){return i=t,r="xml",e.ignoreDeclaration?"":"<?xml"+A(t[e.attributesKey],e,s)+"?>"}function h(t,e,s){if(e.ignoreInstruction)return"";var n;for(n in t)if(t.hasOwnProperty(n))break;var o="instructionNameFn"in e?e.instructionNameFn(n,t[n],r,i):n;if("object"==typeof t[n])return i=t,r=o,"<?"+o+A(t[n][e.attributesKey],e,s)+"?>";var a=t[n]?t[n]:"";return"instructionFn"in e&&(a=e.instructionFn(a,n,r,i)),"<?"+o+(a?" "+a:"")+"?>"}function d(t,e){return e.ignoreComment?"":"\x3c!--"+("commentFn"in e?e.commentFn(t,r,i):t)+"--\x3e"}function c(t,e){return e.ignoreCdata?"":"<![CDATA["+("cdataFn"in e?e.cdataFn(t,r,i):t.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function u(t,e){return e.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in e?e.doctypeFn(t,r,i):t)+">"}function p(t,e){return e.ignoreText?"":(t=(t=(t=""+t).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in e?e.textFn(t,r,i):t)}function _(t,e,s,n){return t.reduce((function(t,o){var l=a(e,s,n&&!t);switch(o.type){case"element":return t+l+function(t,e,s){i=t,r=t.name;var n=[],o="elementNameFn"in e?e.elementNameFn(t.name,t):t.name;n.push("<"+o),t[e.attributesKey]&&n.push(A(t[e.attributesKey],e,s));var a=t[e.elementsKey]&&t[e.elementsKey].length||t[e.attributesKey]&&"preserve"===t[e.attributesKey]["xml:space"];return a||(a="fullTagEmptyElementFn"in e?e.fullTagEmptyElementFn(t.name,t):e.fullTagEmptyElement),a?(n.push(">"),t[e.elementsKey]&&t[e.elementsKey].length&&(n.push(_(t[e.elementsKey],e,s+1)),i=t,r=t.name),n.push(e.spaces&&function(t,e){var s;if(t.elements&&t.elements.length)for(s=0;s<t.elements.length;++s)switch(t.elements[s][e.typeKey]){case"text":if(e.indentText)return!0;break;case"cdata":if(e.indentCdata)return!0;break;case"instruction":if(e.indentInstruction)return!0;break;default:return!0}return!1}(t,e)?"\n"+Array(s+1).join(e.spaces):""),n.push("</"+o+">")):n.push("/>"),n.join("")}(o,e,s);case"comment":return t+l+d(o[e.commentKey],e);case"doctype":return t+l+u(o[e.doctypeKey],e);case"cdata":return t+(e.indentCdata?l:"")+c(o[e.cdataKey],e);case"text":return t+(e.indentText?l:"")+p(o[e.textKey],e);case"instruction":var g={};return g[o[e.nameKey]]=o[e.attributesKey]?o:o[e.instructionKey],t+(e.indentInstruction?l:"")+h(g,e,s)}}),"")}function g(t,e,s){var i;for(i in t)if(t.hasOwnProperty(i))switch(i){case e.parentKey:case e.attributesKey:break;case e.textKey:if(e.indentText||s)return!0;break;case e.cdataKey:if(e.indentCdata||s)return!0;break;case e.instructionKey:if(e.indentInstruction||s)return!0;break;case e.doctypeKey:case e.commentKey:default:return!0}return!1}function f(t,e,s,n,o){i=t,r=e;var l="elementNameFn"in s?s.elementNameFn(e,t):e;if(null==t||""===t)return"fullTagEmptyElementFn"in s&&s.fullTagEmptyElementFn(e,t)||s.fullTagEmptyElement?"<"+l+"></"+l+">":"<"+l+"/>";var h=[];if(e){if(h.push("<"+l),"object"!=typeof t)return h.push(">"+p(t,s)+"</"+l+">"),h.join("");t[s.attributesKey]&&h.push(A(t[s.attributesKey],s,n));var d=g(t,s,!0)||t[s.attributesKey]&&"preserve"===t[s.attributesKey]["xml:space"];if(d||(d="fullTagEmptyElementFn"in s?s.fullTagEmptyElementFn(e,t):s.fullTagEmptyElement),!d)return h.push("/>"),h.join("");h.push(">")}return h.push(m(t,s,n+1,!1)),i=t,r=e,e&&h.push((o?a(s,n,!1):"")+"</"+l+">"),h.join("")}function m(t,e,s,i){var r,n,A,_=[];for(n in t)if(t.hasOwnProperty(n))for(A=o(t[n])?t[n]:[t[n]],r=0;r<A.length;++r){switch(n){case e.declarationKey:_.push(l(A[r],e,s));break;case e.instructionKey:_.push((e.indentInstruction?a(e,s,i):"")+h(A[r],e,s));break;case e.attributesKey:case e.parentKey:break;case e.textKey:_.push((e.indentText?a(e,s,i):"")+p(A[r],e));break;case e.cdataKey:_.push((e.indentCdata?a(e,s,i):"")+c(A[r],e));break;case e.doctypeKey:_.push(a(e,s,i)+u(A[r],e));break;case e.commentKey:_.push(a(e,s,i)+d(A[r],e));break;default:_.push(a(e,s,i)+f(A[r],n,e,s,g(A[r],e)))}i=i&&!_.length}return _.join("")}t.exports=function(t,e){e=function(t){var e=n.copyOptions(t);return n.ensureFlagExists("ignoreDeclaration",e),n.ensureFlagExists("ignoreInstruction",e),n.ensureFlagExists("ignoreAttributes",e),n.ensureFlagExists("ignoreText",e),n.ensureFlagExists("ignoreComment",e),n.ensureFlagExists("ignoreCdata",e),n.ensureFlagExists("ignoreDoctype",e),n.ensureFlagExists("compact",e),n.ensureFlagExists("indentText",e),n.ensureFlagExists("indentCdata",e),n.ensureFlagExists("indentAttributes",e),n.ensureFlagExists("indentInstruction",e),n.ensureFlagExists("fullTagEmptyElement",e),n.ensureFlagExists("noQuotesForNativeAttributes",e),n.ensureSpacesExists(e),"number"==typeof e.spaces&&(e.spaces=Array(e.spaces+1).join(" ")),n.ensureKeyExists("declaration",e),n.ensureKeyExists("instruction",e),n.ensureKeyExists("attributes",e),n.ensureKeyExists("text",e),n.ensureKeyExists("comment",e),n.ensureKeyExists("cdata",e),n.ensureKeyExists("doctype",e),n.ensureKeyExists("type",e),n.ensureKeyExists("name",e),n.ensureKeyExists("elements",e),n.checkFnExists("doctype",e),n.checkFnExists("instruction",e),n.checkFnExists("cdata",e),n.checkFnExists("comment",e),n.checkFnExists("text",e),n.checkFnExists("instructionName",e),n.checkFnExists("elementName",e),n.checkFnExists("attributeName",e),n.checkFnExists("attributeValue",e),n.checkFnExists("attributes",e),n.checkFnExists("fullTagEmptyElement",e),e}(e);var s=[];return i=t,r="_root_",e.compact?s.push(m(t,e,0,!0)):(t[e.declarationKey]&&s.push(l(t[e.declarationKey],e,0)),t[e.elementsKey]&&t[e.elementsKey].length&&s.push(_(t[e.elementsKey],e,0,!s.length))),s.join("")}},673:(t,e,s)=>{var i=s(501);t.exports=function(t,e){t instanceof Buffer&&(t=t.toString());var s=null;if("string"==typeof t)try{s=JSON.parse(t)}catch(t){throw new Error("The JSON structure is invalid")}else s=t;return i(s,e)}},740:(t,e,s)=>{var i=s(881).isArray;t.exports={copyOptions:function(t){var e,s={};for(e in t)t.hasOwnProperty(e)&&(s[e]=t[e]);return s},ensureFlagExists:function(t,e){t in e&&"boolean"==typeof e[t]||(e[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||"number"!=typeof t.spaces&&"string"!=typeof t.spaces)&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){"alwaysArray"in t&&("boolean"==typeof t.alwaysArray||i(t.alwaysArray))||(t.alwaysArray=!1)},ensureKeyExists:function(t,e){t+"Key"in e&&"string"==typeof e[t+"Key"]||(e[t+"Key"]=e.compact?"_"+t:t)},checkFnExists:function(t,e){return t+"Fn"in e}}},229:(t,e,s)=>{var i,r,n=s(99),o=s(740),a=s(881).isArray;function A(t){var e=Number(t);if(!isNaN(e))return e;var s=t.toLowerCase();return"true"===s||"false"!==s&&t}function l(t,e){var s;if(i.compact){if(!r[i[t+"Key"]]&&(a(i.alwaysArray)?-1!==i.alwaysArray.indexOf(i[t+"Key"]):i.alwaysArray)&&(r[i[t+"Key"]]=[]),r[i[t+"Key"]]&&!a(r[i[t+"Key"]])&&(r[i[t+"Key"]]=[r[i[t+"Key"]]]),t+"Fn"in i&&"string"==typeof e&&(e=i[t+"Fn"](e,r)),"instruction"===t&&("instructionFn"in i||"instructionNameFn"in i))for(s in e)if(e.hasOwnProperty(s))if("instructionFn"in i)e[s]=i.instructionFn(e[s],s,r);else{var n=e[s];delete e[s],e[i.instructionNameFn(s,n,r)]=n}a(r[i[t+"Key"]])?r[i[t+"Key"]].push(e):r[i[t+"Key"]]=e}else{r[i.elementsKey]||(r[i.elementsKey]=[]);var o={};if(o[i.typeKey]=t,"instruction"===t){for(s in e)if(e.hasOwnProperty(s))break;o[i.nameKey]="instructionNameFn"in i?i.instructionNameFn(s,e,r):s,i.instructionHasAttributes?(o[i.attributesKey]=e[s][i.attributesKey],"instructionFn"in i&&(o[i.attributesKey]=i.instructionFn(o[i.attributesKey],s,r))):("instructionFn"in i&&(e[s]=i.instructionFn(e[s],s,r)),o[i.instructionKey]=e[s])}else t+"Fn"in i&&(e=i[t+"Fn"](e,r)),o[i[t+"Key"]]=e;i.addParent&&(o[i.parentKey]=r),r[i.elementsKey].push(o)}}function h(t){var e;if("attributesFn"in i&&t&&(t=i.attributesFn(t,r)),(i.trim||"attributeValueFn"in i||"attributeNameFn"in i||i.nativeTypeAttributes)&&t)for(e in t)if(t.hasOwnProperty(e)&&(i.trim&&(t[e]=t[e].trim()),i.nativeTypeAttributes&&(t[e]=A(t[e])),"attributeValueFn"in i&&(t[e]=i.attributeValueFn(t[e],e,r)),"attributeNameFn"in i)){var s=t[e];delete t[e],t[i.attributeNameFn(e,t[e],r)]=s}return t}function d(t){var e={};if(t.body&&("xml"===t.name.toLowerCase()||i.instructionHasAttributes)){for(var s,n=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(s=n.exec(t.body));)e[s[1]]=s[2]||s[3]||s[4];e=h(e)}if("xml"===t.name.toLowerCase()){if(i.ignoreDeclaration)return;r[i.declarationKey]={},Object.keys(e).length&&(r[i.declarationKey][i.attributesKey]=e),i.addParent&&(r[i.declarationKey][i.parentKey]=r)}else{if(i.ignoreInstruction)return;i.trim&&(t.body=t.body.trim());var o={};i.instructionHasAttributes&&Object.keys(e).length?(o[t.name]={},o[t.name][i.attributesKey]=e):o[t.name]=t.body,l("instruction",o)}}function c(t,e){var s;if("object"==typeof t&&(e=t.attributes,t=t.name),e=h(e),"elementNameFn"in i&&(t=i.elementNameFn(t,r)),i.compact){var n;if(s={},!i.ignoreAttributes&&e&&Object.keys(e).length)for(n in s[i.attributesKey]={},e)e.hasOwnProperty(n)&&(s[i.attributesKey][n]=e[n]);!(t in r)&&(a(i.alwaysArray)?-1!==i.alwaysArray.indexOf(t):i.alwaysArray)&&(r[t]=[]),r[t]&&!a(r[t])&&(r[t]=[r[t]]),a(r[t])?r[t].push(s):r[t]=s}else r[i.elementsKey]||(r[i.elementsKey]=[]),(s={})[i.typeKey]="element",s[i.nameKey]=t,!i.ignoreAttributes&&e&&Object.keys(e).length&&(s[i.attributesKey]=e),i.alwaysChildren&&(s[i.elementsKey]=[]),r[i.elementsKey].push(s);s[i.parentKey]=r,r=s}function u(t){i.ignoreText||(t.trim()||i.captureSpacesBetweenElements)&&(i.trim&&(t=t.trim()),i.nativeType&&(t=A(t)),i.sanitize&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),l("text",t))}function p(t){i.ignoreComment||(i.trim&&(t=t.trim()),l("comment",t))}function _(t){var e=r[i.parentKey];i.addParent||delete r[i.parentKey],r=e}function g(t){i.ignoreCdata||(i.trim&&(t=t.trim()),l("cdata",t))}function f(t){i.ignoreDoctype||(t=t.replace(/^ /,""),i.trim&&(t=t.trim()),l("doctype",t))}function m(t){t.note=t}t.exports=function(t,e){var s=n.parser(!0,{}),a={};if(r=a,i=function(t){return i=o.copyOptions(t),o.ensureFlagExists("ignoreDeclaration",i),o.ensureFlagExists("ignoreInstruction",i),o.ensureFlagExists("ignoreAttributes",i),o.ensureFlagExists("ignoreText",i),o.ensureFlagExists("ignoreComment",i),o.ensureFlagExists("ignoreCdata",i),o.ensureFlagExists("ignoreDoctype",i),o.ensureFlagExists("compact",i),o.ensureFlagExists("alwaysChildren",i),o.ensureFlagExists("addParent",i),o.ensureFlagExists("trim",i),o.ensureFlagExists("nativeType",i),o.ensureFlagExists("nativeTypeAttributes",i),o.ensureFlagExists("sanitize",i),o.ensureFlagExists("instructionHasAttributes",i),o.ensureFlagExists("captureSpacesBetweenElements",i),o.ensureAlwaysArrayExists(i),o.ensureKeyExists("declaration",i),o.ensureKeyExists("instruction",i),o.ensureKeyExists("attributes",i),o.ensureKeyExists("text",i),o.ensureKeyExists("comment",i),o.ensureKeyExists("cdata",i),o.ensureKeyExists("doctype",i),o.ensureKeyExists("type",i),o.ensureKeyExists("name",i),o.ensureKeyExists("elements",i),o.ensureKeyExists("parent",i),o.checkFnExists("doctype",i),o.checkFnExists("instruction",i),o.checkFnExists("cdata",i),o.checkFnExists("comment",i),o.checkFnExists("text",i),o.checkFnExists("instructionName",i),o.checkFnExists("elementName",i),o.checkFnExists("attributeName",i),o.checkFnExists("attributeValue",i),o.checkFnExists("attributes",i),i}(e),s.opt={strictEntities:!0},s.onopentag=c,s.ontext=u,s.oncomment=p,s.onclosetag=_,s.onerror=m,s.oncdata=g,s.ondoctype=f,s.onprocessinginstruction=d,s.write(t).close(),a[i.elementsKey]){var A=a[i.elementsKey];delete a[i.elementsKey],a[i.elementsKey]=A,delete a.text}return a}},388:(t,e,s)=>{var i=s(740),r=s(229);t.exports=function(t,e){var s,n,o;return s=function(t){var e=i.copyOptions(t);return i.ensureSpacesExists(e),e}(e),n=r(t,s),o="compact"in s&&s.compact?"_parent":"parent",("addParent"in s&&s.addParent?JSON.stringify(n,(function(t,e){return t===o?"_":e}),s.spaces):JSON.stringify(n,null,s.spaces)).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}},255:t=>{var e={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};t.exports=function(t){return t&&t.replace?t.replace(/([&"<>'])/g,(function(t,s){return e[s]})):t}},479:(t,e,s)=>{var i=s(155),r=s(255),n=s(830).Stream;function o(t,e,s){s=s||0;var i,n,a=(i=e,new Array(s||0).join(i||"")),A=t;if("object"==typeof t&&(A=t[n=Object.keys(t)[0]])&&A._elem)return A._elem.name=n,A._elem.icount=s,A._elem.indent=e,A._elem.indents=a,A._elem.interrupt=A,A._elem;var l,h=[],d=[];function c(t){Object.keys(t).forEach((function(e){h.push(function(t,e){return t+'="'+r(e)+'"'}(e,t[e]))}))}switch(typeof A){case"object":if(null===A)break;A._attr&&c(A._attr),A._cdata&&d.push(("<![CDATA["+A._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),A.forEach&&(l=!1,d.push(""),A.forEach((function(t){"object"==typeof t?"_attr"==Object.keys(t)[0]?c(t._attr):d.push(o(t,e,s+1)):(d.pop(),l=!0,d.push(r(t)))})),l||d.push(""));break;default:d.push(r(A))}return{name:n,interrupt:!1,attributes:h,content:d,icount:s,indents:a,indent:e}}function a(t,e,s){if("object"!=typeof e)return t(!1,e);var i=e.interrupt?1:e.content.length;function r(){for(;e.content.length;){var r=e.content.shift();if(void 0!==r){if(n(r))return;a(t,r)}}t(!1,(i>1?e.indents:"")+(e.name?"</"+e.name+">":"")+(e.indent&&!s?"\n":"")),s&&s()}function n(e){return!!e.interrupt&&(e.interrupt.append=t,e.interrupt.end=r,e.interrupt=!1,t(!0),!0)}if(t(!1,e.indents+(e.name?"<"+e.name:"")+(e.attributes.length?" "+e.attributes.join(" "):"")+(i?e.name?">":"":e.name?"/>":"")+(e.indent&&i>1?"\n":"")),!i)return t(!1,e.indent?"\n":"");n(e)||r()}t.exports=function(t,e){"object"!=typeof e&&(e={indent:e});var s,r,A=e.stream?new n:null,l="",h=!1,d=e.indent?!0===e.indent?"    ":e.indent:"",c=!0;function u(t){c?i.nextTick(t):t()}function p(t,e){if(void 0!==e&&(l+=e),t&&!h&&(A=A||new n,h=!0),t&&h){var s=l;u((function(){A.emit("data",s)})),l=""}}function _(t,e){a(p,o(t,d,d?1:0),e)}function g(){if(A){var t=l;u((function(){A.emit("data",t),A.emit("end"),A.readable=!1,A.emit("close")}))}}return u((function(){c=!1})),e.declaration&&(r={version:"1.0",encoding:(s=e.declaration).encoding||"UTF-8"},s.standalone&&(r.standalone=s.standalone),_({"?xml":{_attr:r}}),l=l.replace("/>","?>")),t&&t.forEach?t.forEach((function(e,s){var i;s+1===t.length&&(i=g),_(e,i)})):_(t,g),A?(A.readable=!0,A):l},t.exports.element=t.exports.Element=function(){var t={_elem:o(Array.prototype.slice.call(arguments)),push:function(t){if(!this.append)throw new Error("not assigned to a parent!");var e=this,s=this._elem.indent;a(this.append,o(t,s,this._elem.icount+(s?1:0)),(function(){e.append(!0)}))},close:function(t){void 0!==t&&this.push(t),this.end&&this.end()}};return t}},862:()=>{},964:()=>{}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};return(()=>{s.r(i),s.d(i,{AbstractNumbering:()=>lo,Alignment:()=>X,AlignmentAttributes:()=>$,AlignmentType:()=>U,Attributes:()=>a,BaseEmphasisMark:()=>ut,BaseXmlComponent:()=>t,Body:()=>Ci,Bookmark:()=>Gs,BookmarkEnd:()=>Ws,BookmarkStart:()=>Ks,Border:()=>J,BorderElement:()=>j,BorderStyle:()=>M,Column:()=>vi,ColumnAttributes:()=>bi,ColumnBreak:()=>Bs,Columns:()=>ei,ColumnsAttributes:()=>ti,ConcreteHyperlink:()=>Qs,ConcreteNumbering:()=>uo,DeletedTextRun:()=>wa,DocGridAttributes:()=>si,Document:()=>Jo,DocumentAttributes:()=>Bi,DocumentBackground:()=>Pi,DocumentBackgroundAttributes:()=>Ei,DocumentDefaults:()=>Xo,DocumentGrid:()=>ii,DocumentGridType:()=>ee,DotEmphasisMark:()=>_t,Drawing:()=>us,DropCapType:()=>Ti,EMPTY_OBJECT:()=>e,EmphasisMark:()=>pt,EmphasisMarkType:()=>K,ExternalHyperlink:()=>Ms,File:()=>Jo,FootNoteReferenceRunAttributes:()=>la,FootNotes:()=>Kn,Footer:()=>Aa,FooterWrapper:()=>Dn,FootnoteReference:()=>ha,FootnoteReferenceRun:()=>da,FrameAnchorType:()=>Oi,FrameProperties:()=>Li,FramePropertiesAttributes:()=>Di,FrameWrap:()=>Fi,GridSpan:()=>kr,Header:()=>aa,HeaderFooterReference:()=>qs,HeaderFooterReferenceType:()=>qt,HeaderFooterType:()=>te,HeaderWrapper:()=>Xn,HeadingLevel:()=>zt,HeightRule:()=>sn,HorizontalPosition:()=>_e,HorizontalPositionAlign:()=>Ca,HorizontalPositionRelativeFrom:()=>Mt,HpsMeasureElement:()=>L,HyperlinkType:()=>Jt,IgnoreIfEmptyXmlComponent:()=>n,ImageRun:()=>ps,ImportDotx:()=>Da,ImportedRootElementAttributes:()=>c,ImportedXmlComponent:()=>d,Indent:()=>tt,InitializableXmlComponent:()=>p,InsertedTextRun:()=>ca,InternalHyperlink:()=>Us,LeaderType:()=>Xt,Level:()=>no,LevelBase:()=>ro,LevelForOverride:()=>oo,LevelFormat:()=>Jn,LevelOverride:()=>_o,LevelSuffix:()=>Zn,LineNumberAttributes:()=>ri,LineNumberRestartFormat:()=>se,LineNumberType:()=>ni,LineRuleType:()=>Wt,Math:()=>Qi,MathAccentCharacter:()=>Wi,MathAngledBrackets:()=>Sr,MathBase:()=>zi,MathCurlyBrackets:()=>xr,MathDegree:()=>cr,MathDenominator:()=>ki,MathFraction:()=>Gi,MathFunction:()=>wr,MathFunctionName:()=>fr,MathFunctionProperties:()=>mr,MathLimitLocation:()=>Xi,MathNArayProperties:()=>qi,MathNumerator:()=>Vi,MathPreSubSuperScript:()=>hr,MathPreSubSuperScriptProperties:()=>lr,MathRadical:()=>gr,MathRadicalProperties:()=>_r,MathRoundBrackets:()=>Er,MathRun:()=>Mi,MathSquareBrackets:()=>Pr,MathSubScript:()=>or,MathSubScriptElement:()=>tr,MathSubScriptProperties:()=>nr,MathSubSuperScript:()=>Ar,MathSubSuperScriptProperties:()=>ar,MathSum:()=>sr,MathSuperScript:()=>rr,MathSuperScriptElement:()=>er,MathSuperScriptProperties:()=>ir,Media:()=>jn,NumberFormat:()=>va,NumberProperties:()=>Os,NumberValueElement:()=>H,Numbering:()=>mo,OnOffElement:()=>D,OutlineLevel:()=>zs,OverlapType:()=>Jr,Packer:()=>Ra,PageBorderDisplay:()=>ie,PageBorderOffsetFrom:()=>re,PageBorderZOrder:()=>ne,PageBorders:()=>ai,PageBreak:()=>vs,PageBreakBefore:()=>Es,PageMargin:()=>li,PageMarginAttributes:()=>Ai,PageNumber:()=>z,PageNumberSeparator:()=>oe,PageNumberType:()=>di,PageNumberTypeAttributes:()=>hi,PageOrientation:()=>ae,PageReference:()=>js,PageSize:()=>ui,PageSizeAttributes:()=>ci,PageTextDirection:()=>_i,PageTextDirectionType:()=>Ae,Paragraph:()=>Hi,ParagraphProperties:()=>Ni,ParagraphPropertiesDefaults:()=>zo,RelativeHorizontalPosition:()=>qr,RelativeVerticalPosition:()=>tn,Run:()=>Rt,RunFonts:()=>Ct,RunProperties:()=>Pt,RunPropertiesChange:()=>xt,RunPropertiesDefaults:()=>$o,SectionProperties:()=>yi,SectionType:()=>le,SectionTypeAttributes:()=>gi,SequentialIdentifier:()=>fs,Shading:()=>ct,ShadingType:()=>G,SimpleField:()=>ys,SimpleMailMergeField:()=>Cs,SimplePos:()=>de,Spacing:()=>xs,StringContainer:()=>Q,StringValueElement:()=>N,Style:()=>Ss,StyleForCharacter:()=>Ro,StyleForParagraph:()=>Io,StyleLevel:()=>oa,Styles:()=>Wo,SymbolRun:()=>Dt,TDirection:()=>Wr,Tab:()=>ms,TabAttributes:()=>Rs,TabStop:()=>Is,TabStopItem:()=>Ts,TabStopPosition:()=>jt,TabStopType:()=>$t,Table:()=>cn,TableAnchorType:()=>Zr,TableBorders:()=>Yr,TableCell:()=>$r,TableCellBorders:()=>Ur,TableFloatOptionsAttributes:()=>an,TableFloatProperties:()=>An,TableLayout:()=>hn,TableLayoutType:()=>en,TableOfContents:()=>na,TableOverlap:()=>on,TableProperties:()=>dn,TableRow:()=>gn,TableRowHeight:()=>pn,TableRowHeightAttributes:()=>un,TableRowProperties:()=>_n,TableWidthElement:()=>Hr,TextDirection:()=>Lr,TextRun:()=>Tt,TextWrappingSide:()=>Gt,TextWrappingType:()=>Vt,ThematicBreak:()=>Z,Type:()=>fi,Underline:()=>Et,UnderlineType:()=>W,VerticalAlign:()=>Zt,VerticalAlignAttributes:()=>Ys,VerticalAlignElement:()=>Js,VerticalMerge:()=>Gr,VerticalMergeType:()=>Dr,VerticalPosition:()=>fe,VerticalPositionAlign:()=>ba,VerticalPositionRelativeFrom:()=>kt,WORKAROUND:()=>Zo,WORKAROUND2:()=>Yn,WORKAROUND3:()=>u,WORKAROUND4:()=>dr,WidthType:()=>Or,WrapNone:()=>$e,WrapSquare:()=>je,WrapTight:()=>Je,WrapTopAndBottom:()=>qe,XmlAttributeComponent:()=>o,XmlComponent:()=>r,convertInchesToTwip:()=>Ht,convertMillimetersToTwip:()=>Nt,convertToXmlComponent:()=>l,dateTimeValue:()=>F,decimalNumber:()=>_,eighthPointMeasureValue:()=>T,hexColorValue:()=>B,hpsMeasureValue:()=>P,longHexNumber:()=>m,measurementOrPercentValue:()=>R,percentageValue:()=>I,pointMeasureValue:()=>O,positiveUniversalMeasureValue:()=>v,sectionMarginDefaults:()=>mi,sectionPageSizeDefaults:()=>wi,shortHexNumber:()=>w,signedHpsMeasureValue:()=>x,signedTwipsMeasureValue:()=>E,twipsMeasureValue:()=>S,uCharHexNumber:()=>y,uniqueId:()=>Ut,uniqueNumericId:()=>Qt,universalMeasureValue:()=>C,unsignedDecimalNumber:()=>g});class t{constructor(t){this.rootKey=t}}const e=Object.seal({});class r extends t{constructor(t){super(t),this.root=new Array}prepForXml(s){var i;const r=this.root.map((e=>e instanceof t?e.prepForXml(s):e)).filter((t=>void 0!==t));return{[this.rootKey]:r.length?1===r.length&&(null===(i=r[0])||void 0===i?void 0:i._attr)?r[0]:r:e}}addChildElement(t){return this.root.push(t),this}}class n extends r{prepForXml(t){const e=super.prepForXml(t);if(e&&("object"!=typeof e[this.rootKey]||Object.keys(e[this.rootKey]).length))return e}}class o extends t{constructor(t){super("_attr"),this.root=t}prepForXml(t){const e={};return Object.keys(this.root).forEach((t=>{const s=this.root[t];if(void 0!==s){const i=this.xmlKeys&&this.xmlKeys[t]||t;e[i]=s}})),{_attr:e}}set(t){this.root=t}}class a extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"}}}var A=s(888);function l(t){switch(t.type){case void 0:case"element":const e=new d(t.name,t.attributes),s=t.elements||[];for(const t of s){const s=l(t);void 0!==s&&e.push(s)}return e;case"text":return t.text;default:return}}class h extends o{}class d extends r{static fromXmlString(t){return l((0,A.xml2js)(t,{compact:!1}))}constructor(t,e){super(t),e&&this.root.push(new h(e))}push(t){this.root.push(t)}}class c extends r{constructor(t){super(""),this._attr=t}prepForXml(t){return{_attr:this._attr}}}const u="";class p extends r{constructor(t,e){super(t),e&&(this.root=e.root)}}function _(t){if(isNaN(t))throw new Error("Invalid value '".concat(t,"' specified. Must be an integer."));return Math.floor(t)}function g(t){const e=_(t);if(e<0)throw new Error("Invalid value '".concat(t,"' specified. Must be a positive integer."));return e}function f(t,e){const s=2*e;if(t.length!==s||isNaN(Number("0x"+t)))throw new Error("Invalid hex value '".concat(t,"'. Expected ").concat(s," digit hex value"));return t}function m(t){return f(t,4)}function w(t){return f(t,2)}function y(t){return f(t,1)}function C(t){const e=t.slice(-2);if(!b.includes(e))throw new Error("Invalid unit '".concat(e,"' specified. Valid units are ").concat(b.join(", ")));const s=t.substring(0,t.length-2);if(isNaN(Number(s)))throw new Error("Invalid value '".concat(s,"' specified. Expected a valid number."));return"".concat(Number(s)).concat(e)}const b=["mm","cm","in","pt","pc","pi"];function v(t){const e=C(t);if(parseFloat(e)<0)throw new Error("Invalid value '".concat(e,"' specified. Expected a positive number."));return e}function B(t){return"auto"===t?t:f("#"===t.charAt(0)?t.substring(1):t,3)}function E(t){return"string"==typeof t?C(t):_(t)}function P(t){return"string"==typeof t?v(t):g(t)}function x(t){return"string"==typeof t?C(t):_(t)}function S(t){return"string"==typeof t?v(t):g(t)}function I(t){if("%"!==t.slice(-1))throw new Error("Invalid value '".concat(t,"'. Expected percentage value (eg '55%')"));const e=t.substring(0,t.length-1);if(isNaN(Number(e)))throw new Error("Invalid value '".concat(e,"' specified. Expected a valid number."));return"".concat(Number(e),"%")}function R(t){return"number"==typeof t?_(t):"%"===t.slice(-1)?I(t):C(t)}const T=g,O=g;function F(t){return t.toISOString()}class D extends r{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(t),!0!==e&&this.root.push(new a({val:e}))}}class L extends r{constructor(t,e){super(t),this.root.push(new a({val:P(e)}))}}class N extends r{constructor(t,e){super(t),this.root.push(new a({val:e}))}}class H extends r{constructor(t,e){super(t),this.root.push(new a({val:e}))}}class Q extends r{constructor(t,e){super(t),this.root.push(e)}}var U,M,k,V,G,K,W,z;!function(t){t.START="start",t.END="end",t.CENTER="center",t.BOTH="both",t.JUSTIFIED="both",t.DISTRIBUTE="distribute",t.LEFT="left",t.RIGHT="right"}(U||(U={}));class $ extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class X extends r{constructor(t){super("w:jc"),this.root.push(new $({val:t}))}}class j extends r{constructor(t,e){let{color:s,size:i,space:r,style:n}=e;super(t),this.root.push(new Y({style:n,color:void 0===s?void 0:B(s),size:void 0===i?void 0:T(i),space:void 0===r?void 0:O(r)}))}}class Y extends o{constructor(){super(...arguments),this.xmlKeys={style:"w:val",color:"w:color",size:"w:sz",space:"w:space"}}}!function(t){t.SINGLE="single",t.DASH_DOT_STROKED="dashDotStroked",t.DASHED="dashed",t.DASH_SMALL_GAP="dashSmallGap",t.DOT_DASH="dotDash",t.DOT_DOT_DASH="dotDotDash",t.DOTTED="dotted",t.DOUBLE="double",t.DOUBLE_WAVE="doubleWave",t.INSET="inset",t.NIL="nil",t.NONE="none",t.OUTSET="outset",t.THICK="thick",t.THICK_THIN_LARGE_GAP="thickThinLargeGap",t.THICK_THIN_MEDIUM_GAP="thickThinMediumGap",t.THICK_THIN_SMALL_GAP="thickThinSmallGap",t.THIN_THICK_LARGE_GAP="thinThickLargeGap",t.THIN_THICK_MEDIUM_GAP="thinThickMediumGap",t.THIN_THICK_SMALL_GAP="thinThickSmallGap",t.THIN_THICK_THIN_LARGE_GAP="thinThickThinLargeGap",t.THIN_THICK_THIN_MEDIUM_GAP="thinThickThinMediumGap",t.THIN_THICK_THIN_SMALL_GAP="thinThickThinSmallGap",t.THREE_D_EMBOSS="threeDEmboss",t.THREE_D_ENGRAVE="threeDEngrave",t.TRIPLE="triple",t.WAVE="wave"}(M||(M={}));class J extends n{constructor(t){super("w:pBdr"),t.top&&this.root.push(new j("w:top",t.top)),t.bottom&&this.root.push(new j("w:bottom",t.bottom)),t.left&&this.root.push(new j("w:left",t.left)),t.right&&this.root.push(new j("w:right",t.right))}}class Z extends r{constructor(){super("w:pBdr");const t=new j("w:bottom",{color:"auto",space:1,style:M.SINGLE,size:6});this.root.push(t)}}class q extends o{constructor(){super(...arguments),this.xmlKeys={start:"w:start",end:"w:end",left:"w:left",right:"w:right",hanging:"w:hanging",firstLine:"w:firstLine"}}}class tt extends r{constructor(t){let{start:e,end:s,left:i,right:r,hanging:n,firstLine:o}=t;super("w:ind"),this.root.push(new q({start:void 0===e?void 0:E(e),end:void 0===s?void 0:E(s),left:void 0===i?void 0:E(i),right:void 0===r?void 0:E(r),hanging:void 0===n?void 0:S(n),firstLine:void 0===o?void 0:S(o)}))}}class et extends r{constructor(){super("w:br")}}!function(t){t.BEGIN="begin",t.END="end",t.SEPARATE="separate"}(k||(k={}));class st extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:fldCharType",dirty:"w:dirty"}}}class it extends r{constructor(t){super("w:fldChar"),this.root.push(new st({type:k.BEGIN,dirty:t}))}}class rt extends r{constructor(t){super("w:fldChar"),this.root.push(new st({type:k.SEPARATE,dirty:t}))}}class nt extends r{constructor(t){super("w:fldChar"),this.root.push(new st({type:k.END,dirty:t}))}}!function(t){t.DEFAULT="default",t.PRESERVE="preserve"}(V||(V={}));class ot extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class at extends r{constructor(){super("w:instrText"),this.root.push(new ot({space:V.PRESERVE})),this.root.push("PAGE")}}class At extends r{constructor(){super("w:instrText"),this.root.push(new ot({space:V.PRESERVE})),this.root.push("NUMPAGES")}}class lt extends r{constructor(){super("w:instrText"),this.root.push(new ot({space:V.PRESERVE})),this.root.push("SECTIONPAGES")}}class ht extends o{constructor(){super(...arguments),this.xmlKeys={id:"w:id",author:"w:author",date:"w:date"}}}class dt extends o{constructor(){super(...arguments),this.xmlKeys={fill:"w:fill",color:"w:color",type:"w:val"}}}class ct extends r{constructor(t){let{fill:e,color:s,type:i}=t;super("w:shd"),this.root.push(new dt({fill:void 0===e?void 0:B(e),color:void 0===s?void 0:B(s),type:i}))}}!function(t){t.CLEAR="clear",t.DIAGONAL_CROSS="diagCross",t.DIAGONAL_STRIPE="diagStripe",t.HORIZONTAL_CROSS="horzCross",t.HORIZONTAL_STRIPE="horzStripe",t.NIL="nil",t.PERCENT_5="pct5",t.PERCENT_10="pct10",t.PERCENT_12="pct12",t.PERCENT_15="pct15",t.PERCENT_20="pct20",t.PERCENT_25="pct25",t.PERCENT_30="pct30",t.PERCENT_35="pct35",t.PERCENT_37="pct37",t.PERCENT_40="pct40",t.PERCENT_45="pct45",t.PERCENT_50="pct50",t.PERCENT_55="pct55",t.PERCENT_60="pct60",t.PERCENT_62="pct62",t.PERCENT_65="pct65",t.PERCENT_70="pct70",t.PERCENT_75="pct75",t.PERCENT_80="pct80",t.PERCENT_85="pct85",t.PERCENT_87="pct87",t.PERCENT_90="pct90",t.PERCENT_95="pct95",t.REVERSE_DIAGONAL_STRIPE="reverseDiagStripe",t.SOLID="solid",t.THIN_DIAGONAL_CROSS="thinDiagCross",t.THIN_DIAGONAL_STRIPE="thinDiagStripe",t.THIN_HORIZONTAL_CROSS="thinHorzCross",t.THIN_REVERSE_DIAGONAL_STRIPE="thinReverseDiagStripe",t.THIN_VERTICAL_STRIPE="thinVertStripe",t.VERTICAL_STRIPE="vertStripe"}(G||(G={})),function(t){t.DOT="dot"}(K||(K={}));class ut extends r{constructor(t){super("w:em"),this.root.push(new a({val:t}))}}class pt extends ut{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:K.DOT)}}class _t extends ut{constructor(){super(K.DOT)}}class gt extends r{constructor(t){super("w:spacing"),this.root.push(new a({val:E(t)}))}}class ft extends r{constructor(t){super("w:color"),this.root.push(new a({val:B(t)}))}}class mt extends r{constructor(t){super("w:highlight"),this.root.push(new a({val:t}))}}class wt extends r{constructor(t){super("w:highlightCs"),this.root.push(new a({val:t}))}}class yt extends o{constructor(){super(...arguments),this.xmlKeys={ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"}}}class Ct extends r{constructor(t,e){if(super("w:rFonts"),"string"==typeof t){const s=t;this.root.push(new yt({ascii:s,cs:s,eastAsia:s,hAnsi:s,hint:e}))}else{const e=t;this.root.push(new yt(e))}}}class bt extends r{constructor(t){super("w:vertAlign"),this.root.push(new a({val:t}))}}class vt extends bt{constructor(){super("superscript")}}class Bt extends bt{constructor(){super("subscript")}}!function(t){t.SINGLE="single",t.WORDS="words",t.DOUBLE="double",t.THICK="thick",t.DOTTED="dotted",t.DOTTEDHEAVY="dottedHeavy",t.DASH="dash",t.DASHEDHEAVY="dashedHeavy",t.DASHLONG="dashLong",t.DASHLONGHEAVY="dashLongHeavy",t.DOTDASH="dotDash",t.DASHDOTHEAVY="dashDotHeavy",t.DOTDOTDASH="dotDotDash",t.DASHDOTDOTHEAVY="dashDotDotHeavy",t.WAVE="wave",t.WAVYHEAVY="wavyHeavy",t.WAVYDOUBLE="wavyDouble"}(W||(W={}));class Et extends r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W.SINGLE,e=arguments.length>1?arguments[1]:void 0;super("w:u"),this.root.push(new a({val:t,color:void 0===e?void 0:B(e)}))}}class Pt extends n{constructor(t){var e,s;if(super("w:rPr"),!t)return;void 0!==t.bold&&this.push(new D("w:b",t.bold)),(void 0===t.boldComplexScript&&void 0!==t.bold||t.boldComplexScript)&&this.push(new D("w:bCs",null!==(e=t.boldComplexScript)&&void 0!==e?e:t.bold)),void 0!==t.italics&&this.push(new D("w:i",t.italics)),(void 0===t.italicsComplexScript&&void 0!==t.italics||t.italicsComplexScript)&&this.push(new D("w:iCs",null!==(s=t.italicsComplexScript)&&void 0!==s?s:t.italics)),t.underline&&this.push(new Et(t.underline.type,t.underline.color)),t.emphasisMark&&this.push(new pt(t.emphasisMark.type)),t.color&&this.push(new ft(t.color)),void 0!==t.size&&this.push(new L("w:sz",t.size));const i=void 0===t.sizeComplexScript||!0===t.sizeComplexScript?t.size:t.sizeComplexScript;i&&this.push(new L("w:szCs",i)),void 0!==t.rightToLeft&&this.push(new D("w:rtl",t.rightToLeft)),void 0!==t.smallCaps?this.push(new D("w:smallCaps",t.smallCaps)):void 0!==t.allCaps&&this.push(new D("w:caps",t.allCaps)),void 0!==t.strike&&this.push(new D("w:strike",t.strike)),void 0!==t.doubleStrike&&this.push(new D("w:dstrike",t.doubleStrike)),t.subScript&&this.push(new Bt),t.superScript&&this.push(new vt),t.style&&this.push(new N("w:rStyle",t.style)),t.font&&("string"==typeof t.font?this.push(new Ct(t.font)):"name"in t.font?this.push(new Ct(t.font.name,t.font.hint)):this.push(new Ct(t.font))),t.highlight&&this.push(new mt(t.highlight));const r=void 0===t.highlightComplexScript||!0===t.highlightComplexScript?t.highlight:t.highlightComplexScript;r&&this.push(new wt(r)),t.characterSpacing&&this.push(new gt(t.characterSpacing)),void 0!==t.emboss&&this.push(new D("w:emboss",t.emboss)),void 0!==t.imprint&&this.push(new D("w:imprint",t.imprint)),t.shading&&this.push(new ct(t.shading)),t.revision&&this.push(new xt(t.revision))}push(t){this.root.push(t)}}class xt extends r{constructor(t){super("w:rPrChange"),this.root.push(new ht({id:t.id,author:t.author,date:t.date})),this.addChildElement(new Pt(t))}}class St extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class It extends r{constructor(t){super("w:t"),this.root.push(new St({space:V.PRESERVE})),this.root.push(t)}}!function(t){t.CURRENT="CURRENT",t.TOTAL_PAGES="TOTAL_PAGES",t.TOTAL_PAGES_IN_SECTION="TOTAL_PAGES_IN_SECTION"}(z||(z={}));class Rt extends r{constructor(t){if(super("w:r"),this.properties=new Pt(t),this.root.push(this.properties),t.break)for(let e=0;e<t.break;e++)this.root.push(new et);if(t.children)for(const e of t.children)if("string"!=typeof e)this.root.push(e);else switch(e){case z.CURRENT:this.root.push(new it),this.root.push(new at),this.root.push(new rt),this.root.push(new nt);break;case z.TOTAL_PAGES:this.root.push(new it),this.root.push(new At),this.root.push(new rt),this.root.push(new nt);break;case z.TOTAL_PAGES_IN_SECTION:this.root.push(new it),this.root.push(new lt),this.root.push(new rt),this.root.push(new nt);break;default:this.root.push(new It(e))}else t.text&&this.root.push(new It(t.text))}}class Tt extends Rt{constructor(t){if("string"==typeof t)return super({}),this.root.push(new It(t)),this;super(t)}}class Ot extends o{constructor(){super(...arguments),this.xmlKeys={char:"w:char",symbolfont:"w:font"}}}class Ft extends r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Wingdings";super("w:sym"),this.root.push(new Ot({char:t,symbolfont:e}))}}class Dt extends Rt{constructor(t){if("string"==typeof t)return super({}),void this.root.push(new Ft(t));super(t),this.root.push(new Ft(t.char,t.symbolfont))}}let Lt=0;const Nt=t=>Math.floor(t/25.4*72*20),Ht=t=>Math.floor(72*t*20),Qt=()=>++Lt,Ut=()=>function(){let t="",e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;e--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}().toLowerCase();var Mt,kt,Vt,Gt,Kt,Wt,zt,$t,Xt,jt,Yt,Jt,Zt,qt,te,ee,se,ie,re,ne,oe,ae,Ae,le;!function(t){t.CHARACTER="character",t.COLUMN="column",t.INSIDE_MARGIN="insideMargin",t.LEFT_MARGIN="leftMargin",t.MARGIN="margin",t.OUTSIDE_MARGIN="outsideMargin",t.PAGE="page",t.RIGHT_MARGIN="rightMargin"}(Mt||(Mt={})),function(t){t.BOTTOM_MARGIN="bottomMargin",t.INSIDE_MARGIN="insideMargin",t.LINE="line",t.MARGIN="margin",t.OUTSIDE_MARGIN="outsideMargin",t.PAGE="page",t.PARAGRAPH="paragraph",t.TOP_MARGIN="topMargin"}(kt||(kt={}));class he extends o{constructor(){super(...arguments),this.xmlKeys={x:"x",y:"y"}}}class de extends r{constructor(){super("wp:simplePos"),this.root.push(new he({x:0,y:0}))}}class ce extends r{constructor(t){super("wp:align"),this.root.push(t)}}class ue extends r{constructor(t){super("wp:posOffset"),this.root.push(t.toString())}}class pe extends o{constructor(){super(...arguments),this.xmlKeys={relativeFrom:"relativeFrom"}}}class _e extends r{constructor(t){if(super("wp:positionH"),this.root.push(new pe({relativeFrom:t.relative||Mt.PAGE})),t.align)this.root.push(new ce(t.align));else{if(void 0===t.offset)throw new Error("There is no configuration provided for floating position (Align or offset)");this.root.push(new ue(t.offset))}}}class ge extends o{constructor(){super(...arguments),this.xmlKeys={relativeFrom:"relativeFrom"}}}class fe extends r{constructor(t){if(super("wp:positionV"),this.root.push(new ge({relativeFrom:t.relative||kt.PAGE})),t.align)this.root.push(new ce(t.align));else{if(void 0===t.offset)throw new Error("There is no configuration provided for floating position (Align or offset)");this.root.push(new ue(t.offset))}}}class me extends o{constructor(){super(...arguments),this.xmlKeys={uri:"uri"}}}class we extends o{constructor(){super(...arguments),this.xmlKeys={embed:"r:embed",cstate:"cstate"}}}class ye extends r{constructor(t){super("a:blip"),this.root.push(new we({embed:"rId{".concat(t.fileName,"}"),cstate:"none"}))}}class Ce extends r{constructor(){super("a:srcRect")}}class be extends r{constructor(){super("a:fillRect")}}class ve extends r{constructor(){super("a:stretch"),this.root.push(new be)}}class Be extends r{constructor(t){super("pic:blipFill"),this.root.push(new ye(t)),this.root.push(new Ce),this.root.push(new ve)}}class Ee extends o{constructor(){super(...arguments),this.xmlKeys={noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"}}}class Pe extends r{constructor(){super("a:picLocks"),this.root.push(new Ee({noChangeAspect:1,noChangeArrowheads:1}))}}class xe extends r{constructor(){super("pic:cNvPicPr"),this.root.push(new Pe)}}class Se extends o{constructor(){super(...arguments),this.xmlKeys={id:"id",name:"name",descr:"descr"}}}class Ie extends r{constructor(){super("pic:cNvPr"),this.root.push(new Se({id:0,name:"",descr:""}))}}class Re extends r{constructor(){super("pic:nvPicPr"),this.root.push(new Ie),this.root.push(new xe)}}class Te extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns:pic"}}}class Oe extends o{constructor(){super(...arguments),this.xmlKeys={cx:"cx",cy:"cy"}}}class Fe extends r{constructor(t,e){super("a:ext"),this.attributes=new Oe({cx:t,cy:e}),this.root.push(this.attributes)}}class De extends o{constructor(){super(...arguments),this.xmlKeys={x:"x",y:"y"}}}class Le extends r{constructor(){super("a:off"),this.root.push(new De({x:0,y:0}))}}class Ne extends o{constructor(){super(...arguments),this.xmlKeys={flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"}}}class He extends r{constructor(t){var e,s;super("a:xfrm"),this.root.push(new Ne({flipVertical:null===(e=t.flip)||void 0===e?void 0:e.vertical,flipHorizontal:null===(s=t.flip)||void 0===s?void 0:s.horizontal,rotation:t.rotation})),this.extents=new Fe(t.emus.x,t.emus.y),this.root.push(new Le),this.root.push(this.extents)}}class Qe extends r{constructor(){super("a:avLst")}}class Ue extends o{constructor(){super(...arguments),this.xmlKeys={prst:"prst"}}}class Me extends r{constructor(){super("a:prstGeom"),this.root.push(new Ue({prst:"rect"})),this.root.push(new Qe)}}class ke extends o{constructor(){super(...arguments),this.xmlKeys={bwMode:"bwMode"}}}class Ve extends r{constructor(t){super("pic:spPr"),this.root.push(new ke({bwMode:"auto"})),this.form=new He(t),this.root.push(this.form),this.root.push(new Me)}}class Ge extends r{constructor(t,e){super("pic:pic"),this.root.push(new Te({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new Re),this.root.push(new Be(t)),this.root.push(new Ve(e))}}class Ke extends r{constructor(t,e){super("a:graphicData"),this.root.push(new me({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new Ge(t,e),this.root.push(this.pic)}}class We extends o{constructor(){super(...arguments),this.xmlKeys={a:"xmlns:a"}}}class ze extends r{constructor(t,e){super("a:graphic"),this.root.push(new We({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new Ke(t,e),this.root.push(this.data)}}!function(t){t[t.NONE=0]="NONE",t[t.SQUARE=1]="SQUARE",t[t.TIGHT=2]="TIGHT",t[t.TOP_AND_BOTTOM=3]="TOP_AND_BOTTOM"}(Vt||(Vt={})),function(t){t.BOTH_SIDES="bothSides",t.LEFT="left",t.RIGHT="right",t.LARGEST="largest"}(Gt||(Gt={}));class $e extends r{constructor(){super("wp:wrapNone")}}class Xe extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"}}}class je extends r{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{top:0,bottom:0,left:0,right:0};super("wp:wrapSquare"),this.root.push(new Xe({wrapText:t.side||Gt.BOTH_SIDES,distT:e.top,distB:e.bottom,distL:e.left,distR:e.right}))}}class Ye extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB"}}}class Je extends r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{top:0,bottom:0};super("wp:wrapTight"),this.root.push(new Ye({distT:t.top,distB:t.bottom}))}}class Ze extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB"}}}class qe extends r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{top:0,bottom:0};super("wp:wrapTopAndBottom"),this.root.push(new Ze({distT:t.top,distB:t.bottom}))}}class ts extends o{constructor(){super(...arguments),this.xmlKeys={id:"id",name:"name",descr:"descr"}}}class es extends r{constructor(){super("wp:docPr"),this.root.push(new ts({id:0,name:"",descr:""}))}}class ss extends o{constructor(){super(...arguments),this.xmlKeys={b:"b",l:"l",r:"r",t:"t"}}}class is extends r{constructor(){super("wp:effectExtent"),this.root.push(new ss({b:0,l:0,r:0,t:0}))}}class rs extends o{constructor(){super(...arguments),this.xmlKeys={cx:"cx",cy:"cy"}}}class ns extends r{constructor(t,e){super("wp:extent"),this.attributes=new rs({cx:t,cy:e}),this.root.push(this.attributes)}}class os extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"}}}class as extends r{constructor(){super("a:graphicFrameLocks"),this.root.push(new os({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}}class As extends r{constructor(){super("wp:cNvGraphicFramePr"),this.root.push(new as)}}class ls extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"}}}class hs extends r{constructor(t,e,s){super("wp:anchor");const i=Object.assign({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},s.floating);if(this.root.push(new ls({distT:i.margins&&i.margins.top||0,distB:i.margins&&i.margins.bottom||0,distL:i.margins&&i.margins.left||0,distR:i.margins&&i.margins.right||0,simplePos:"0",allowOverlap:!0===i.allowOverlap?"1":"0",behindDoc:!0===i.behindDocument?"1":"0",locked:!0===i.lockAnchor?"1":"0",layoutInCell:!0===i.layoutInCell?"1":"0",relativeHeight:i.zIndex?i.zIndex:e.emus.y})),this.root.push(new de),this.root.push(new _e(i.horizontalPosition)),this.root.push(new fe(i.verticalPosition)),this.root.push(new ns(e.emus.x,e.emus.y)),this.root.push(new is),void 0!==s.floating&&void 0!==s.floating.wrap)switch(s.floating.wrap.type){case Vt.SQUARE:this.root.push(new je(s.floating.wrap,s.floating.margins));break;case Vt.TIGHT:this.root.push(new Je(s.floating.margins));break;case Vt.TOP_AND_BOTTOM:this.root.push(new qe(s.floating.margins));break;case Vt.NONE:default:this.root.push(new $e)}else this.root.push(new $e);this.root.push(new es),this.root.push(new As),this.root.push(new ze(t,e))}}class ds extends o{constructor(){super(...arguments),this.xmlKeys={distT:"distT",distB:"distB",distL:"distL",distR:"distR"}}}class cs extends r{constructor(t,e){super("wp:inline"),this.root.push(new ds({distT:0,distB:0,distL:0,distR:0})),this.extent=new ns(e.emus.x,e.emus.y),this.graphic=new ze(t,e),this.root.push(this.extent),this.root.push(new is),this.root.push(new es),this.root.push(new As),this.root.push(this.graphic)}}class us extends r{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super("w:drawing"),e.floating?this.root.push(new hs(t,t.transformation,e)):(this.inline=new cs(t,t.transformation),this.root.push(this.inline))}}class ps extends Rt{constructor(t){super({}),this.key="".concat(Ut(),".png");const e="string"==typeof t.data?this.convertDataURIToBinary(t.data):t.data;this.imageData={stream:e,fileName:this.key,transformation:{pixels:{x:Math.round(t.transformation.width),y:Math.round(t.transformation.height)},emus:{x:Math.round(9525*t.transformation.width),y:Math.round(9525*t.transformation.height)},flip:t.transformation.flip,rotation:t.transformation.rotation?6e4*t.transformation.rotation:void 0}};const s=new us(this.imageData,{floating:t.floating});this.root.push(s)}prepForXml(t){return t.file.Media.addImage(this.key,this.imageData),super.prepForXml(t)}convertDataURIToBinary(t){const e=";base64,",i=t.indexOf(e)+e.length;return"function"==typeof atob?new Uint8Array(atob(t.substring(i)).split("").map((t=>t.charCodeAt(0)))):new(s(764).Buffer)(t,"base64")}}class _s extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class gs extends r{constructor(t){super("w:instrText"),this.root.push(new _s({space:V.PRESERVE})),this.root.push("SEQ ".concat(t))}}class fs extends Rt{constructor(t){super({}),this.root.push(new it(!0)),this.root.push(new gs(t)),this.root.push(new rt),this.root.push(new nt)}}class ms extends r{constructor(){super("w:tab")}}class ws extends o{constructor(){super(...arguments),this.xmlKeys={instr:"w:instr"}}}class ys extends r{constructor(t,e){super("w:fldSimple"),this.root.push(new ws({instr:t})),void 0!==e&&this.root.push(new Tt(e))}}class Cs extends ys{constructor(t){super(" MERGEFIELD ".concat(t," "),"«".concat(t,"»"))}}!function(t){t.COLUMN="column",t.PAGE="page"}(Kt||(Kt={}));class bs extends r{constructor(t){super("w:br"),this.root.push(new a({type:t}))}}class vs extends Rt{constructor(){super({}),this.root.push(new bs(Kt.PAGE))}}class Bs extends Rt{constructor(){super({}),this.root.push(new bs(Kt.COLUMN))}}class Es extends r{constructor(){super("w:pageBreakBefore")}}!function(t){t.AT_LEAST="atLeast",t.EXACTLY="exactly",t.AUTO="auto"}(Wt||(Wt={}));class Ps extends o{constructor(){super(...arguments),this.xmlKeys={after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"}}}class xs extends r{constructor(t){super("w:spacing"),this.root.push(new Ps(t))}}!function(t){t.HEADING_1="Heading1",t.HEADING_2="Heading2",t.HEADING_3="Heading3",t.HEADING_4="Heading4",t.HEADING_5="Heading5",t.HEADING_6="Heading6",t.TITLE="Title"}(zt||(zt={}));class Ss extends r{constructor(t){super("w:pStyle"),this.root.push(new a({val:t}))}}class Is extends r{constructor(t,e,s){super("w:tabs"),this.root.push(new Ts(t,e,s))}}!function(t){t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.BAR="bar",t.CLEAR="clear",t.DECIMAL="decimal",t.END="end",t.NUM="num",t.START="start"}($t||($t={})),function(t){t.DOT="dot",t.HYPHEN="hyphen",t.MIDDLE_DOT="middleDot",t.NONE="none",t.UNDERSCORE="underscore"}(Xt||(Xt={})),function(t){t[t.MAX=9026]="MAX"}(jt||(jt={}));class Rs extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val",pos:"w:pos",leader:"w:leader"}}}class Ts extends r{constructor(t,e,s){super("w:tab"),this.root.push(new Rs({val:t,pos:e,leader:s}))}}class Os extends r{constructor(t,e){super("w:numPr"),this.root.push(new Fs(e)),this.root.push(new Ds(t))}}class Fs extends r{constructor(t){if(super("w:ilvl"),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new a({val:t}))}}class Ds extends r{constructor(t){super("w:numId"),this.root.push(new a({val:"string"==typeof t?"{".concat(t,"}"):t}))}}class Ls extends o{constructor(){super(...arguments),this.xmlKeys={id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"}}}!function(t){t.EXTERNAL="External"}(Yt||(Yt={}));class Ns extends r{constructor(t,e,s,i){super("Relationship"),this.root.push(new Ls({id:t,type:e,target:s,targetMode:i}))}}class Hs extends o{constructor(){super(...arguments),this.xmlKeys={id:"r:id",history:"w:history",anchor:"w:anchor"}}}!function(t){t.INTERNAL="INTERNAL",t.EXTERNAL="EXTERNAL"}(Jt||(Jt={}));class Qs extends r{constructor(t,e,s){super("w:hyperlink"),this.linkId=e;const i={history:1,anchor:s||void 0,id:s?void 0:"rId".concat(this.linkId)},r=new Hs(i);this.root.push(r),t.forEach((t=>{this.root.push(t)}))}}class Us extends Qs{constructor(t){super(t.children,Ut(),t.anchor)}}class Ms{constructor(t){this.options=t}}class ks extends o{constructor(){super(...arguments),this.xmlKeys={id:"w:id",name:"w:name"}}}class Vs extends o{constructor(){super(...arguments),this.xmlKeys={id:"w:id"}}}class Gs{constructor(t){const e=Qt();this.start=new Ks(t.id,e),this.children=t.children,this.end=new Ws(e)}}class Ks extends r{constructor(t,e){super("w:bookmarkStart");const s=new ks({name:t,id:e});this.root.push(s)}}class Ws extends r{constructor(t){super("w:bookmarkEnd");const e=new Vs({id:t});this.root.push(e)}}class zs extends r{constructor(t){super("w:outlineLvl"),this.level=t,this.root.push(new a({val:t}))}}class $s extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class Xs extends r{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super("w:instrText"),this.root.push(new $s({space:V.PRESERVE}));let s="PAGEREF ".concat(t);e.hyperlink&&(s="".concat(s," \\h")),e.useRelativePosition&&(s="".concat(s," \\p")),this.root.push(s)}}class js extends Rt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super({children:[new it(!0),new Xs(t,e),new nt]})}}!function(t){t.BOTH="both",t.BOTTOM="bottom",t.CENTER="center",t.TOP="top"}(Zt||(Zt={}));class Ys extends o{constructor(){super(...arguments),this.xmlKeys={verticalAlign:"w:val"}}}class Js extends r{constructor(t){super("w:vAlign"),this.root.push(new Ys({verticalAlign:t}))}}!function(t){t.DEFAULT="default",t.FIRST="first",t.EVEN="even"}(qt||(qt={}));class Zs extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",id:"r:id"}}}!function(t){t.HEADER="w:headerReference",t.FOOTER="w:footerReference"}(te||(te={}));class qs extends r{constructor(t,e){super(t),this.root.push(new Zs({type:e.type||qt.DEFAULT,id:"rId".concat(e.id)}))}}class ti extends o{constructor(){super(...arguments),this.xmlKeys={space:"w:space",count:"w:num",separate:"w:sep",equalWidth:"w:equalWidth"}}}class ei extends r{constructor(t){let{space:e,count:s,separate:i,equalWidth:r,children:n}=t;super("w:cols"),this.root.push(new ti({space:void 0===e?void 0:S(e),count:void 0===s?void 0:_(s),separate:i,equalWidth:r})),!r&&n&&n.forEach((t=>this.addChildElement(t)))}}!function(t){t.DEFAULT="default",t.LINES="lines",t.LINES_AND_CHARS="linesAndChars",t.SNAP_TO_CHARS="snapToChars"}(ee||(ee={}));class si extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"}}}class ii extends r{constructor(t,e,s){super("w:docGrid"),this.root.push(new si({type:s,linePitch:_(t),charSpace:e?_(e):void 0}))}}!function(t){t.NEW_PAGE="newPage",t.NEW_SECTION="newSection",t.CONTINUOUS="continuous"}(se||(se={}));class ri extends o{constructor(){super(...arguments),this.xmlKeys={countBy:"w:countBy",start:"w:start",restart:"w:restart",distance:"w:distance"}}}class ni extends r{constructor(t){let{countBy:e,start:s,restart:i,distance:r}=t;super("w:lnNumType"),this.root.push(new ri({countBy:void 0===e?void 0:_(e),start:void 0===s?void 0:_(s),restart:i,distance:void 0===r?void 0:S(r)}))}}!function(t){t.ALL_PAGES="allPages",t.FIRST_PAGE="firstPage",t.NOT_FIRST_PAGE="notFirstPage"}(ie||(ie={})),function(t){t.PAGE="page",t.TEXT="text"}(re||(re={})),function(t){t.BACK="back",t.FRONT="front"}(ne||(ne={}));class oi extends o{constructor(){super(...arguments),this.xmlKeys={display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"}}}class ai extends n{constructor(t){super("w:pgBorders"),t&&(t.pageBorders?this.root.push(new oi({display:t.pageBorders.display,offsetFrom:t.pageBorders.offsetFrom,zOrder:t.pageBorders.zOrder})):this.root.push(new oi({})),t.pageBorderTop&&this.root.push(new j("w:top",t.pageBorderTop)),t.pageBorderLeft&&this.root.push(new j("w:left",t.pageBorderLeft)),t.pageBorderBottom&&this.root.push(new j("w:bottom",t.pageBorderBottom)),t.pageBorderRight&&this.root.push(new j("w:right",t.pageBorderRight)))}}class Ai extends o{constructor(){super(...arguments),this.xmlKeys={top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter"}}}class li extends r{constructor(t,e,s,i,r,n,o){super("w:pgMar"),this.root.push(new Ai({top:E(t),right:S(e),bottom:E(s),left:S(i),header:S(r),footer:S(n),gutter:S(o)}))}}!function(t){t.HYPHEN="hyphen",t.PERIOD="period",t.COLON="colon",t.EM_DASH="emDash",t.EN_DASH="endash"}(oe||(oe={}));class hi extends o{constructor(){super(...arguments),this.xmlKeys={start:"w:start",formatType:"w:fmt",separator:"w:chapSep"}}}class di extends r{constructor(t){let{start:e,formatType:s,separator:i}=t;super("w:pgNumType"),this.root.push(new hi({start:void 0===e?void 0:_(e),formatType:s,separator:i}))}}!function(t){t.PORTRAIT="portrait",t.LANDSCAPE="landscape"}(ae||(ae={}));class ci extends o{constructor(){super(...arguments),this.xmlKeys={width:"w:w",height:"w:h",orientation:"w:orient"}}}class ui extends r{constructor(t,e,s){super("w:pgSz");const i=s===ae.LANDSCAPE,r=S(t),n=S(e);this.root.push(new ci({width:i?n:r,height:i?r:n,orientation:s}))}}!function(t){t.LEFT_TO_RIGHT_TOP_TO_BOTTOM="lrTb",t.TOP_TO_BOTTOM_RIGHT_TO_LEFT="tbRl"}(Ae||(Ae={}));class pi extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class _i extends r{constructor(t){super("w:textDirection"),this.root.push(new pi({val:t}))}}!function(t){t.NEXT_PAGE="nextPage",t.NEXT_COLUMN="nextColumn",t.CONTINUOUS="continuous",t.EVEN_PAGE="evenPage",t.ODD_PAGE="oddPage"}(le||(le={}));class gi extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class fi extends r{constructor(t){super("w:type"),this.root.push(new gi({val:t}))}}const mi={TOP:"1in",RIGHT:"1in",BOTTOM:"1in",LEFT:"1in",HEADER:708,FOOTER:708,GUTTER:0},wi={WIDTH:11906,HEIGHT:16838,ORIENTATION:ae.PORTRAIT};class yi extends r{constructor(){let{page:{size:{width:t=wi.WIDTH,height:e=wi.HEIGHT,orientation:s=wi.ORIENTATION}={},margin:{top:i=mi.TOP,right:r=mi.RIGHT,bottom:n=mi.BOTTOM,left:o=mi.LEFT,header:a=mi.HEADER,footer:A=mi.FOOTER,gutter:l=mi.GUTTER}={},pageNumbers:h={},borders:d,textDirection:c}={},grid:{linePitch:u=360,charSpace:p,type:_}={},headerWrapperGroup:g={},footerWrapperGroup:f={},lineNumbers:m,titlePage:w,verticalAlign:y,column:C,type:b}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("w:sectPr"),this.addHeaderFooterGroup(te.HEADER,g),this.addHeaderFooterGroup(te.FOOTER,f),b&&this.root.push(new fi(b)),this.root.push(new ui(t,e,s)),this.root.push(new li(i,r,n,o,a,A,l)),d&&this.root.push(new ai(d)),m&&this.root.push(new ni(m)),this.root.push(new di(h)),C&&this.root.push(new ei(C)),y&&this.root.push(new Js(y)),void 0!==w&&this.root.push(new D("w:titlePg",w)),c&&this.root.push(new _i(c)),this.root.push(new ii(u,p,_))}addHeaderFooterGroup(t,e){e.default&&this.root.push(new qs(t,{type:qt.DEFAULT,id:e.default.View.ReferenceId})),e.first&&this.root.push(new qs(t,{type:qt.FIRST,id:e.first.View.ReferenceId})),e.even&&this.root.push(new qs(t,{type:qt.EVEN,id:e.even.View.ReferenceId}))}}class Ci extends r{constructor(){super("w:body"),this.sections=[]}addSection(t){const e=this.sections.pop();this.root.push(this.createSectionParagraph(e)),this.sections.push(new yi(t))}prepForXml(t){return 1===this.sections.length&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(t)}push(t){this.root.push(t)}createSectionParagraph(t){const e=new Hi({}),s=new Ni({});return s.push(t),e.addChildElement(s),e}}class bi extends o{constructor(){super(...arguments),this.xmlKeys={width:"w:w",space:"w:space"}}}class vi extends r{constructor(t){let{width:e,space:s}=t;super("w:col"),this.root.push(new bi({width:S(e),space:void 0===s?void 0:S(s)}))}}class Bi extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"}}}class Ei extends o{constructor(){super(...arguments),this.xmlKeys={color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"}}}class Pi extends r{constructor(t){super("w:background"),this.root.push(new Ei({color:void 0===t.color?void 0:B(t.color),themeColor:t.themeColor,themeShade:void 0===t.themeShade?void 0:y(t.themeShade),themeTint:void 0===t.themeTint?void 0:y(t.themeTint)}))}}class xi extends r{constructor(t){super("w:document"),this.root.push(new Bi({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.body=new Ci,this.root.push(new Pi(t.background)),this.root.push(this.body)}add(t){return this.body.push(t),this}get Body(){return this.body}}class Si extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns"}}}class Ii extends r{constructor(){super("Relationships"),this.root.push(new Si({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}addRelationship(t){this.root.push(t)}createRelationship(t,e,s,i){const r=new Ns("rId".concat(t),e,s,i);return this.addRelationship(r),r}get RelationshipCount(){return this.root.length-1}}class Ri{constructor(t){this.document=new xi(t),this.relationships=new Ii}get View(){return this.document}get Relationships(){return this.relationships}}var Ti,Oi,Fi;!function(t){t.NONE="none",t.DROP="drop",t.MARGIN="margin"}(Ti||(Ti={})),function(t){t.MARGIN="margin",t.PAGE="page",t.TEXT="text"}(Oi||(Oi={})),function(t){t.AROUND="around",t.AUTO="auto",t.NONE="none",t.NOT_BESIDE="notBeside",t.THROUGH="through",t.TIGHT="tight"}(Fi||(Fi={}));class Di extends o{constructor(){super(...arguments),this.xmlKeys={anchorLock:"w:anchorLock",dropCap:"w:dropCap",width:"w:w",height:"w:h",x:"w:x",y:"w:y",anchorHorizontal:"w:hAnchor",anchorVertical:"w:vAnchor",spaceHorizontal:"w:hSpace",spaceVertical:"w:vSpace",rule:"w:hRule",alignmentX:"w:xAlign",alignmentY:"w:yAlign",lines:"w:lines",wrap:"w:wrap"}}}class Li extends r{constructor(t){var e,s;super("w:framePr"),this.root.push(new Di({anchorLock:t.anchorLock,dropCap:t.dropCap,width:t.width,height:t.height,x:t.position.x,y:t.position.y,anchorHorizontal:t.anchor.horizontal,anchorVertical:t.anchor.vertical,spaceHorizontal:null===(e=t.space)||void 0===e?void 0:e.horizontal,spaceVertical:null===(s=t.space)||void 0===s?void 0:s.vertical,rule:t.rule,alignmentX:t.alignment.x,alignmentY:t.alignment.y,lines:t.lines,wrap:t.wrap}))}}class Ni extends n{constructor(t){var e,s;if(super("w:pPr"),this.numberingReferences=[],!t)return this;if(t.heading&&this.push(new Ss(t.heading)),t.bullet&&this.push(new Ss("ListParagraph")),t.numbering&&(t.style||t.heading||t.numbering.custom||this.push(new Ss("ListParagraph"))),t.style&&this.push(new Ss(t.style)),void 0!==t.keepNext&&this.push(new D("w:keepNext",t.keepNext)),void 0!==t.keepLines&&this.push(new D("w:keepLines",t.keepLines)),t.pageBreakBefore&&this.push(new Es),t.frame&&this.push(new Li(t.frame)),void 0!==t.widowControl&&this.push(new D("w:widowControl",t.widowControl)),t.bullet&&this.push(new Os(1,t.bullet.level)),t.numbering&&(this.numberingReferences.push({reference:t.numbering.reference,instance:null!==(e=t.numbering.instance)&&void 0!==e?e:0}),this.push(new Os("".concat(t.numbering.reference,"-").concat(null!==(s=t.numbering.instance)&&void 0!==s?s:0),t.numbering.level))),t.border&&this.push(new J(t.border)),t.thematicBreak&&this.push(new Z),t.shading&&this.push(new ct(t.shading)),t.rightTabStop&&this.push(new Is($t.RIGHT,t.rightTabStop)),t.tabStops)for(const e of t.tabStops)this.push(new Is(e.type,e.position,e.leader));t.leftTabStop&&this.push(new Is($t.LEFT,t.leftTabStop)),void 0!==t.bidirectional&&this.push(new D("w:bidi",t.bidirectional)),t.spacing&&this.push(new xs(t.spacing)),t.indent&&this.push(new tt(t.indent)),void 0!==t.contextualSpacing&&this.push(new D("w:contextualSpacing",t.contextualSpacing)),t.alignment&&this.push(new X(t.alignment)),void 0!==t.outlineLevel&&this.push(new zs(t.outlineLevel)),void 0!==t.suppressLineNumbers&&this.push(new D("w:suppressLineNumbers",t.suppressLineNumbers))}push(t){this.root.push(t)}prepForXml(t){if(t.viewWrapper instanceof Ri)for(const e of this.numberingReferences)t.file.Numbering.createConcreteNumberingInstance(e.reference,e.instance);return super.prepForXml(t)}}class Hi extends r{constructor(t){if(super("w:p"),"string"==typeof t)return this.properties=new Ni({}),this.root.push(this.properties),this.root.push(new Tt(t)),this;if(this.properties=new Ni(t),this.root.push(this.properties),t.text&&this.root.push(new Tt(t.text)),t.children)for(const e of t.children)if(e instanceof Gs){this.root.push(e.start);for(const t of e.children)this.root.push(t);this.root.push(e.end)}else this.root.push(e)}prepForXml(t){for(const e of this.root)if(e instanceof Ms){const s=this.root.indexOf(e),i=new Qs(e.options.children,Ut());t.viewWrapper.Relationships.createRelationship(i.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",e.options.link,Yt.EXTERNAL),this.root[s]=i}return super.prepForXml(t)}addRunToFront(t){return this.root.splice(1,0,t),this}}class Qi extends r{constructor(t){super("m:oMath");for(const e of t.children)this.root.push(e)}}class Ui extends r{constructor(t){super("m:t"),this.root.push(t)}}class Mi extends r{constructor(t){super("m:r"),this.root.push(new Ui(t))}}class ki extends r{constructor(t){super("m:den");for(const e of t)this.root.push(e)}}class Vi extends r{constructor(t){super("m:num");for(const e of t)this.root.push(e)}}class Gi extends r{constructor(t){super("m:f"),this.root.push(new Vi(t.numerator)),this.root.push(new ki(t.denominator))}}class Ki extends o{constructor(){super(...arguments),this.xmlKeys={accent:"m:val"}}}class Wi extends r{constructor(t){super("m:chr"),this.root.push(new Ki({accent:t}))}}class zi extends r{constructor(t){super("m:e");for(const e of t)this.root.push(e)}}class $i extends o{constructor(){super(...arguments),this.xmlKeys={value:"m:val"}}}class Xi extends r{constructor(){super("m:limLoc"),this.root.push(new $i({value:"undOvr"}))}}class ji extends o{constructor(){super(...arguments),this.xmlKeys={hide:"m:val"}}}class Yi extends r{constructor(){super("m:subHide"),this.root.push(new ji({hide:1}))}}class Ji extends o{constructor(){super(...arguments),this.xmlKeys={hide:"m:val"}}}class Zi extends r{constructor(){super("m:supHide"),this.root.push(new Ji({hide:1}))}}class qi extends r{constructor(t,e,s){super("m:naryPr"),this.root.push(new Wi(t)),this.root.push(new Xi),e||this.root.push(new Zi),s||this.root.push(new Yi)}}class tr extends r{constructor(t){super("m:sub");for(const e of t)this.root.push(e)}}class er extends r{constructor(t){super("m:sup");for(const e of t)this.root.push(e)}}class sr extends r{constructor(t){super("m:nary"),this.root.push(new qi("∑",!!t.superScript,!!t.subScript)),t.subScript&&this.root.push(new tr(t.subScript)),t.superScript&&this.root.push(new er(t.superScript)),this.root.push(new zi(t.children))}}class ir extends r{constructor(){super("m:sSupPr")}}class rr extends r{constructor(t){super("m:sSup"),this.root.push(new ir),this.root.push(new zi(t.children)),this.root.push(new er(t.superScript))}}class nr extends r{constructor(){super("m:sSubPr")}}class or extends r{constructor(t){super("m:sSub"),this.root.push(new nr),this.root.push(new zi(t.children)),this.root.push(new tr(t.subScript))}}class ar extends r{constructor(){super("m:sSubSupPr")}}class Ar extends r{constructor(t){super("m:sSubSup"),this.root.push(new ar),this.root.push(new zi(t.children)),this.root.push(new tr(t.subScript)),this.root.push(new er(t.superScript))}}class lr extends r{constructor(){super("m:sPrePr")}}class hr extends r{constructor(t){super("m:sPre"),this.root.push(new lr),this.root.push(new zi(t.children)),this.root.push(new tr(t.subScript)),this.root.push(new er(t.superScript))}}const dr="";class cr extends r{constructor(t){if(super("m:deg"),t)for(const e of t)this.root.push(e)}}class ur extends o{constructor(){super(...arguments),this.xmlKeys={hide:"m:val"}}}class pr extends r{constructor(){super("m:degHide"),this.root.push(new ur({hide:1}))}}class _r extends r{constructor(t){super("m:radPr"),t||this.root.push(new pr)}}class gr extends r{constructor(t){super("m:rad"),this.root.push(new _r(!!t.degree)),this.root.push(new cr(t.degree)),this.root.push(new zi(t.children))}}class fr extends r{constructor(t){super("m:fName");for(const e of t)this.root.push(e)}}class mr extends r{constructor(){super("m:funcPr")}}class wr extends r{constructor(t){super("m:func"),this.root.push(new mr),this.root.push(new fr(t.name)),this.root.push(new zi(t.children))}}class yr extends o{constructor(){super(...arguments),this.xmlKeys={character:"m:val"}}}class Cr extends r{constructor(t){super("m:begChr"),this.root.push(new yr({character:t}))}}class br extends o{constructor(){super(...arguments),this.xmlKeys={character:"m:val"}}}class vr extends r{constructor(t){super("m:endChr"),this.root.push(new br({character:t}))}}class Br extends r{constructor(t){super("m:dPr"),t&&(this.root.push(new Cr(t.beginningCharacter)),this.root.push(new vr(t.endingCharacter)))}}class Er extends r{constructor(t){super("m:d"),this.root.push(new Br),this.root.push(new zi(t.children))}}class Pr extends r{constructor(t){super("m:d"),this.root.push(new Br({beginningCharacter:"[",endingCharacter:"]"})),this.root.push(new zi(t.children))}}class xr extends r{constructor(t){super("m:d"),this.root.push(new Br({beginningCharacter:"{",endingCharacter:"}"})),this.root.push(new zi(t.children))}}class Sr extends r{constructor(t){super("m:d"),this.root.push(new Br({beginningCharacter:"〈",endingCharacter:"〉"})),this.root.push(new zi(t.children))}}class Ir extends r{constructor(t){super("w:tblGrid");for(const e of t)this.root.push(new Tr(e))}}class Rr extends o{constructor(){super(...arguments),this.xmlKeys={w:"w:w"}}}class Tr extends r{constructor(t){super("w:gridCol"),void 0!==t&&this.root.push(new Rr({w:S(t)}))}}var Or,Fr,Dr,Lr;!function(t){t.AUTO="auto",t.DXA="dxa",t.NIL="nil",t.PERCENTAGE="pct"}(Or||(Or={}));class Nr extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",size:"w:w"}}}class Hr extends r{constructor(t,e){let{type:s=Or.AUTO,size:i}=e;super(t);let r=i;s===Or.PERCENTAGE&&"number"==typeof i&&(r="".concat(i,"%")),this.root.push(new Nr({type:s,size:R(r)}))}}!function(t){t.TABLE="w:tblCellMar",t.TABLE_CELL="w:tcMar"}(Fr||(Fr={}));class Qr extends n{constructor(t,e){let{marginUnitType:s=Or.DXA,top:i,left:r,bottom:n,right:o}=e;super(t),void 0!==i&&this.root.push(new Hr("w:top",{type:s,size:i})),void 0!==r&&this.root.push(new Hr("w:left",{type:s,size:r})),void 0!==n&&this.root.push(new Hr("w:bottom",{type:s,size:n})),void 0!==o&&this.root.push(new Hr("w:right",{type:s,size:o}))}}class Ur extends n{constructor(t){super("w:tcBorders"),t.top&&this.root.push(new j("w:top",t.top)),t.start&&this.root.push(new j("w:start",t.start)),t.left&&this.root.push(new j("w:left",t.left)),t.bottom&&this.root.push(new j("w:bottom",t.bottom)),t.end&&this.root.push(new j("w:end",t.end)),t.right&&this.root.push(new j("w:right",t.right))}}class Mr extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class kr extends r{constructor(t){super("w:gridSpan"),this.root.push(new Mr({val:_(t)}))}}!function(t){t.CONTINUE="continue",t.RESTART="restart"}(Dr||(Dr={}));class Vr extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class Gr extends r{constructor(t){super("w:vMerge"),this.root.push(new Vr({val:t}))}}!function(t){t.BOTTOM_TO_TOP_LEFT_TO_RIGHT="btLr",t.LEFT_TO_RIGHT_TOP_TO_BOTTOM="lrTb",t.TOP_TO_BOTTOM_RIGHT_TO_LEFT="tbRl"}(Lr||(Lr={}));class Kr extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class Wr extends r{constructor(t){super("w:textDirection"),this.root.push(new Kr({val:t}))}}class zr extends n{constructor(t){super("w:tcPr"),t.width&&this.root.push(new Hr("w:tcW",t.width)),t.columnSpan&&this.root.push(new kr(t.columnSpan)),t.verticalMerge?this.root.push(new Gr(t.verticalMerge)):t.rowSpan&&t.rowSpan>1&&this.root.push(new Gr(Dr.RESTART)),t.borders&&this.root.push(new Ur(t.borders)),t.shading&&this.root.push(new ct(t.shading)),t.margins&&this.root.push(new Qr(Fr.TABLE_CELL,t.margins)),t.textDirection&&this.root.push(new Wr(t.textDirection)),t.verticalAlign&&this.root.push(new Js(t.verticalAlign))}}class $r extends r{constructor(t){super("w:tc"),this.options=t,this.root.push(new zr(t));for(const e of t.children)this.root.push(e)}prepForXml(t){return this.root[this.root.length-1]instanceof Hi||this.root.push(new Hi({})),super.prepForXml(t)}}const Xr={style:M.NONE,size:0,color:"auto"},jr={style:M.SINGLE,size:4,color:"auto"};class Yr extends r{constructor(t){super("w:tblBorders"),t.top?this.root.push(new j("w:top",t.top)):this.root.push(new j("w:top",jr)),t.left?this.root.push(new j("w:left",t.left)):this.root.push(new j("w:left",jr)),t.bottom?this.root.push(new j("w:bottom",t.bottom)):this.root.push(new j("w:bottom",jr)),t.right?this.root.push(new j("w:right",t.right)):this.root.push(new j("w:right",jr)),t.insideHorizontal?this.root.push(new j("w:insideH",t.insideHorizontal)):this.root.push(new j("w:insideH",jr)),t.insideVertical?this.root.push(new j("w:insideV",t.insideVertical)):this.root.push(new j("w:insideV",jr))}}var Jr,Zr,qr,tn,en,sn,rn;Yr.NONE={top:Xr,bottom:Xr,left:Xr,right:Xr,insideHorizontal:Xr,insideVertical:Xr},function(t){t.NEVER="never",t.OVERLAP="overlap"}(Jr||(Jr={}));class nn extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class on extends r{constructor(t){super("w:tblOverlap"),this.root.push(new nn({val:t}))}}!function(t){t.MARGIN="margin",t.PAGE="page",t.TEXT="text"}(Zr||(Zr={})),function(t){t.CENTER="center",t.INSIDE="inside",t.LEFT="left",t.OUTSIDE="outside",t.RIGHT="right"}(qr||(qr={})),function(t){t.CENTER="center",t.INSIDE="inside",t.BOTTOM="bottom",t.OUTSIDE="outside",t.INLINE="inline",t.TOP="top"}(tn||(tn={}));class an extends o{constructor(){super(...arguments),this.xmlKeys={horizontalAnchor:"w:horzAnchor",verticalAnchor:"w:vertAnchor",absoluteHorizontalPosition:"w:tblpX",relativeHorizontalPosition:"w:tblpXSpec",absoluteVerticalPosition:"w:tblpY",relativeVerticalPosition:"w:tblpYSpec",bottomFromText:"w:bottomFromText",topFromText:"w:topFromText",leftFromText:"w:leftFromText",rightFromText:"w:rightFromText"}}}class An extends r{constructor(t){var{leftFromText:e,rightFromText:s,topFromText:i,bottomFromText:r,absoluteHorizontalPosition:n,absoluteVerticalPosition:o}=t,a=function(t,e){var s={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(s[i[r]]=t[i[r]])}return s}(t,["leftFromText","rightFromText","topFromText","bottomFromText","absoluteHorizontalPosition","absoluteVerticalPosition"]);super("w:tblpPr"),this.root.push(new an(Object.assign({leftFromText:void 0===e?void 0:S(e),rightFromText:void 0===s?void 0:S(s),topFromText:void 0===i?void 0:S(i),bottomFromText:void 0===r?void 0:S(r),absoluteHorizontalPosition:void 0===n?void 0:E(n),absoluteVerticalPosition:void 0===o?void 0:E(o)},a))),a.overlap&&this.root.push(new on(a.overlap))}}!function(t){t.AUTOFIT="autofit",t.FIXED="fixed"}(en||(en={}));class ln extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type"}}}class hn extends r{constructor(t){super("w:tblLayout"),this.root.push(new ln({type:t}))}}class dn extends n{constructor(t){super("w:tblPr"),t.style&&this.root.push(new N("w:tblStyle",t.style)),t.float&&this.root.push(new An(t.float)),void 0!==t.visuallyRightToLeft&&this.root.push(new D("w:bidiVisual",t.visuallyRightToLeft)),t.width&&this.root.push(new Hr("w:tblW",t.width)),t.alignment&&this.root.push(new X(t.alignment)),t.indent&&this.root.push(new Hr("w:tblInd",t.indent)),t.borders&&this.root.push(new Yr(t.borders)),t.shading&&this.root.push(new ct(t.shading)),t.layout&&this.root.push(new hn(t.layout)),t.cellMargin&&this.root.push(new Qr(Fr.TABLE,t.cellMargin))}}class cn extends r{constructor(t){let{rows:e,width:s,columnWidths:i=Array(Math.max(...e.map((t=>t.CellCount)))).fill(100),margins:r,indent:n,float:o,layout:a,style:A,borders:l,alignment:h,visuallyRightToLeft:d}=t;super("w:tbl"),this.root.push(new dn({borders:null!=l?l:{},width:null!=s?s:{size:100},indent:n,float:o,layout:a,style:A,alignment:h,cellMargin:r,visuallyRightToLeft:d})),this.root.push(new Ir(i));for(const t of e)this.root.push(t);e.forEach(((t,s)=>{if(s===e.length-1)return;let i=0;t.cells.forEach((t=>{if(t.options.rowSpan&&t.options.rowSpan>1){const r=new $r({rowSpan:t.options.rowSpan-1,columnSpan:t.options.columnSpan,borders:t.options.borders,children:[],verticalMerge:Dr.CONTINUE});e[s+1].addCellToColumnIndex(r,i)}i+=t.options.columnSpan||1}))}))}}!function(t){t.AUTO="auto",t.ATLEAST="atLeast",t.EXACT="exact"}(sn||(sn={}));class un extends o{constructor(){super(...arguments),this.xmlKeys={value:"w:val",rule:"w:hRule"}}}class pn extends r{constructor(t,e){super("w:trHeight"),this.root.push(new un({value:S(t),rule:e}))}}class _n extends n{constructor(t){super("w:trPr"),void 0!==t.cantSplit&&this.root.push(new D("w:cantSplit",t.cantSplit)),void 0!==t.tableHeader&&this.root.push(new D("w:tblHeader",t.tableHeader)),t.height&&this.root.push(new pn(t.height.value,t.height.rule))}}class gn extends r{constructor(t){super("w:tr"),this.options=t,this.root.push(new _n(t));for(const e of t.children)this.root.push(e)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter((t=>t instanceof $r))}addCellToIndex(t,e){this.root.splice(e+1,0,t)}addCellToColumnIndex(t,e){const s=this.columnIndexToRootIndex(e,!0);this.addCellToIndex(t,s-1)}rootIndexToColumnIndex(t){if(t<1||t>=this.root.length)throw new Error("cell 'rootIndex' should between 1 to "+(this.root.length-1));let e=0;for(let s=1;s<t;s++)e+=this.root[s].options.columnSpan||1;return e}columnIndexToRootIndex(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t<0)throw new Error("cell 'columnIndex' should not less than zero");let s=0,i=1;for(;s<=t;){if(i>=this.root.length){if(e)return this.root.length;throw new Error("cell 'columnIndex' should not great than "+(s-1))}const t=this.root[i];i+=1,s+=t&&t.options.columnSpan||1}return i-1}}class fn extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns",vt:"xmlns:vt"}}}class mn extends r{constructor(){super("Properties"),this.root.push(new fn({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class wn extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns"}}}class yn extends o{constructor(){super(...arguments),this.xmlKeys={contentType:"ContentType",extension:"Extension"}}}class Cn extends r{constructor(t,e){super("Default"),this.root.push(new yn({contentType:t,extension:e}))}}class bn extends o{constructor(){super(...arguments),this.xmlKeys={contentType:"ContentType",partName:"PartName"}}}class vn extends r{constructor(t,e){super("Override"),this.root.push(new bn({contentType:t,partName:e}))}}class Bn extends r{constructor(){super("Types"),this.root.push(new wn({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new Cn("image/png","png")),this.root.push(new Cn("image/jpeg","jpeg")),this.root.push(new Cn("image/jpeg","jpg")),this.root.push(new Cn("image/bmp","bmp")),this.root.push(new Cn("image/gif","gif")),this.root.push(new Cn("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new Cn("application/xml","xml")),this.root.push(new vn("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new vn("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new vn("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new vn("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new vn("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new vn("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new vn("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new vn("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml"))}addFooter(t){this.root.push(new vn("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml","/word/footer".concat(t,".xml")))}addHeader(t){this.root.push(new vn("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml","/word/header".concat(t,".xml")))}}class En extends r{constructor(t){super("cp:coreProperties"),this.root.push(new Bi({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),t.title&&this.root.push(new Q("dc:title",t.title)),t.subject&&this.root.push(new Q("dc:subject",t.subject)),t.creator&&this.root.push(new Q("dc:creator",t.creator)),t.keywords&&this.root.push(new Q("cp:keywords",t.keywords)),t.description&&this.root.push(new Q("dc:description",t.description)),t.lastModifiedBy&&this.root.push(new Q("cp:lastModifiedBy",t.lastModifiedBy)),t.revision&&this.root.push(new Q("cp:revision",String(t.revision))),this.root.push(new Pn("dcterms:created")),this.root.push(new Pn("dcterms:modified"))}}class Pn extends r{constructor(t){super(t),this.root.push(new Bi({type:"dcterms:W3CDTF"})),this.root.push(F(new Date))}}class xn extends o{constructor(){super(...arguments),this.xmlKeys={xmlns:"xmlns",vt:"xmlns:vt"}}}class Sn extends o{constructor(){super(...arguments),this.xmlKeys={fmtid:"fmtid",pid:"pid",name:"name"}}}class In extends r{constructor(t,e){super("property"),this.root.push(new Sn({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t.toString(),name:e.name})),this.root.push(new Rn(e.value))}}class Rn extends r{constructor(t){super("vt:lpwstr"),this.root.push(t)}}class Tn extends r{constructor(t){super("Properties"),this.properties=[],this.root.push(new xn({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const e of t)this.addCustomProperty(e)}prepForXml(t){return this.properties.forEach((t=>this.root.push(t))),super.prepForXml(t)}addCustomProperty(t){this.properties.push(new In(this.nextId++,t))}}class On extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"}}}class Fn extends p{constructor(t,e){super("w:ftr",e),this.refId=t,e||this.root.push(new On({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}}class Dn{constructor(t,e,s){this.media=t,this.footer=new Fn(e,s),this.relationships=new Ii}add(t){this.footer.add(t)}addChildElement(t){this.footer.addChildElement(t)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class Ln extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",id:"w:id"}}}class Nn extends r{constructor(){super("w:footnoteRef")}}class Hn extends Rt{constructor(){super({style:"FootnoteReference"}),this.root.push(new Nn)}}!function(t){t.SEPERATOR="separator",t.CONTINUATION_SEPERATOR="continuationSeparator"}(rn||(rn={}));class Qn extends r{constructor(t){super("w:footnote"),this.root.push(new Ln({type:t.type,id:t.id}));for(let e=0;e<t.children.length;e++){const s=t.children[e];0===e&&s.addRunToFront(new Hn),this.root.push(s)}}}class Un extends r{constructor(){super("w:continuationSeparator")}}class Mn extends Rt{constructor(){super({}),this.root.push(new Un)}}class kn extends r{constructor(){super("w:separator")}}class Vn extends Rt{constructor(){super({}),this.root.push(new kn)}}class Gn extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"}}}class Kn extends r{constructor(){super("w:footnotes"),this.root.push(new Gn({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new Qn({id:-1,type:rn.SEPERATOR,children:[new Hi({spacing:{after:0,line:240,lineRule:Wt.AUTO},children:[new Vn]})]});this.root.push(t);const e=new Qn({id:0,type:rn.CONTINUATION_SEPERATOR,children:[new Hi({spacing:{after:0,line:240,lineRule:Wt.AUTO},children:[new Mn]})]});this.root.push(e)}createFootNote(t,e){const s=new Qn({id:t,children:e});this.root.push(s)}}class Wn{constructor(){this.footnotess=new Kn,this.relationships=new Ii}get View(){return this.footnotess}get Relationships(){return this.relationships}}class zn extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"}}}class $n extends p{constructor(t,e){super("w:hdr",e),this.refId=t,e||this.root.push(new zn({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}}class Xn{constructor(t,e,s){this.media=t,this.header=new $n(e,s),this.relationships=new Ii}add(t){return this.header.add(t),this}addChildElement(t){this.header.addChildElement(t)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class jn{constructor(){this.map=new Map}addMedia(t,e){const s="".concat(Ut(),".png"),i={stream:"string"==typeof t?this.convertDataURIToBinary(t):t,fileName:s,transformation:{pixels:{x:Math.round(e.width),y:Math.round(e.height)},emus:{x:Math.round(9525*e.width),y:Math.round(9525*e.height)},flip:e.flip,rotation:e.rotation?6e4*e.rotation:void 0}};return this.map.set(s,i),i}addImage(t,e){this.map.set(t,e)}get Array(){return Array.from(this.map.values())}convertDataURIToBinary(t){const e=";base64,",i=t.indexOf(e)+e.length;return"function"==typeof atob?new Uint8Array(atob(t.substring(i)).split("").map((t=>t.charCodeAt(0)))):new(s(764).Buffer)(t,"base64")}}const Yn="";var Jn,Zn;!function(t){t.BULLET="bullet",t.CARDINAL_TEXT="cardinalText",t.CHICAGO="chicago",t.DECIMAL="decimal",t.DECIMAL_ENCLOSED_CIRCLE="decimalEnclosedCircle",t.DECIMAL_ENCLOSED_FULLSTOP="decimalEnclosedFullstop",t.DECIMAL_ENCLOSED_PARENTHESES="decimalEnclosedParen",t.DECIMAL_ZERO="decimalZero",t.LOWER_LETTER="lowerLetter",t.LOWER_ROMAN="lowerRoman",t.NONE="none",t.ORDINAL_TEXT="ordinalText",t.UPPER_LETTER="upperLetter",t.UPPER_ROMAN="upperRoman"}(Jn||(Jn={}));class qn extends o{constructor(){super(...arguments),this.xmlKeys={ilvl:"w:ilvl",tentative:"w15:tentative"}}}class to extends r{constructor(t){super("w:numFmt"),this.root.push(new a({val:t}))}}class eo extends r{constructor(t){super("w:lvlText"),this.root.push(new a({val:t}))}}class so extends r{constructor(t){super("w:lvlJc"),this.root.push(new a({val:t}))}}!function(t){t.NOTHING="nothing",t.SPACE="space",t.TAB="tab"}(Zn||(Zn={}));class io extends r{constructor(t){super("w:suff"),this.root.push(new a({val:t}))}}class ro extends r{constructor(t){let{level:e,format:s,text:i,alignment:r=U.START,start:n=1,style:o,suffix:a}=t;if(super("w:lvl"),this.root.push(new H("w:start",_(n))),s&&this.root.push(new to(s)),a&&this.root.push(new io(a)),i&&this.root.push(new eo(i)),this.root.push(new so(r)),this.paragraphProperties=new Ni(o&&o.paragraph),this.runProperties=new Pt(o&&o.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new qn({ilvl:_(e),tentative:1}))}}class no extends ro{constructor(t){super(t)}}class oo extends ro{}class ao extends r{constructor(t){super("w:multiLevelType"),this.root.push(new a({val:t}))}}class Ao extends o{constructor(){super(...arguments),this.xmlKeys={abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"}}}class lo extends r{constructor(t,e){super("w:abstractNum"),this.root.push(new Ao({abstractNumId:_(t),restartNumberingAfterBreak:0})),this.root.push(new ao("hybridMultilevel")),this.id=t;for(const t of e)this.root.push(new no(t))}}class ho extends r{constructor(t){super("w:abstractNumId"),this.root.push(new a({val:t}))}}class co extends o{constructor(){super(...arguments),this.xmlKeys={numId:"w:numId"}}}class uo extends r{constructor(t){super("w:num"),this.numId=t.numId,this.reference=t.reference,this.instance=t.instance,this.root.push(new co({numId:_(t.numId)})),this.root.push(new ho(_(t.abstractNumId))),t.overrideLevel&&this.root.push(new _o(t.overrideLevel.num,t.overrideLevel.start))}}class po extends o{constructor(){super(...arguments),this.xmlKeys={ilvl:"w:ilvl"}}}class _o extends r{constructor(t,e){super("w:lvlOverride"),this.root.push(new po({ilvl:t})),void 0!==e&&this.root.push(new fo(e))}}class go extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class fo extends r{constructor(t){super("w:startOverride"),this.root.push(new go({val:t}))}}class mo extends r{constructor(t){super("w:numbering"),this.abstractNumberingMap=new Map,this.concreteNumberingMap=new Map,this.referenceConfigMap=new Map,this.root.push(new Bi({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const e=new lo(Qt(),[{level:0,format:Jn.BULLET,text:"●",alignment:U.LEFT,style:{paragraph:{indent:{left:Ht(.5),hanging:Ht(.25)}}}},{level:1,format:Jn.BULLET,text:"○",alignment:U.LEFT,style:{paragraph:{indent:{left:Ht(1),hanging:Ht(.25)}}}},{level:2,format:Jn.BULLET,text:"■",alignment:U.LEFT,style:{paragraph:{indent:{left:2160,hanging:Ht(.25)}}}},{level:3,format:Jn.BULLET,text:"●",alignment:U.LEFT,style:{paragraph:{indent:{left:2880,hanging:Ht(.25)}}}},{level:4,format:Jn.BULLET,text:"○",alignment:U.LEFT,style:{paragraph:{indent:{left:3600,hanging:Ht(.25)}}}},{level:5,format:Jn.BULLET,text:"■",alignment:U.LEFT,style:{paragraph:{indent:{left:4320,hanging:Ht(.25)}}}},{level:6,format:Jn.BULLET,text:"●",alignment:U.LEFT,style:{paragraph:{indent:{left:5040,hanging:Ht(.25)}}}},{level:7,format:Jn.BULLET,text:"●",alignment:U.LEFT,style:{paragraph:{indent:{left:5760,hanging:Ht(.25)}}}},{level:8,format:Jn.BULLET,text:"●",alignment:U.LEFT,style:{paragraph:{indent:{left:6480,hanging:Ht(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new uo({numId:1,abstractNumId:e.id,reference:"default-bullet-numbering",instance:0,overrideLevel:{num:0,start:1}})),this.abstractNumberingMap.set("default-bullet-numbering",e);for(const e of t.config)this.abstractNumberingMap.set(e.reference,new lo(Qt(),e.levels)),this.referenceConfigMap.set(e.reference,e.levels)}prepForXml(t){for(const t of this.abstractNumberingMap.values())this.root.push(t);for(const t of this.concreteNumberingMap.values())this.root.push(t);return super.prepForXml(t)}createConcreteNumberingInstance(t,e){const s=this.abstractNumberingMap.get(t);if(!s)return;const i="".concat(t,"-").concat(e);if(this.concreteNumberingMap.has(i))return;const r={numId:Qt(),abstractNumId:s.id,reference:t,instance:e,overrideLevel:{num:0,start:1}},n=this.referenceConfigMap.get(t),o=n&&n[0].start;o&&Number.isInteger(o)&&(r.overrideLevel={num:0,start:o}),this.concreteNumberingMap.set(i,new uo(r))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class wo extends o{constructor(){super(...arguments),this.xmlKeys={version:"w:val",name:"w:name",uri:"w:uri"}}}class yo extends r{constructor(t){super("w:compatSetting"),this.root.push(new wo({version:t,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class Co extends r{constructor(t){super("w:compat"),void 0!==t.doNotExpandShiftReturn&&this.root.push(new D("w:doNotExpandShiftReturn",t.doNotExpandShiftReturn)),t.version&&this.root.push(new yo(t.version))}}class bo extends o{constructor(){super(...arguments),this.xmlKeys={wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"}}}class vo extends r{constructor(t){super("w:settings"),this.root.push(new bo({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new D("w:displayBackgroundShape",!0)),void 0!==t.trackRevisions&&this.root.push(new D("w:trackRevisions",t.trackRevisions)),void 0!==t.evenAndOddHeaders&&this.root.push(new D("w:evenAndOddHeaders",t.evenAndOddHeaders)),void 0!==t.updateFields&&this.root.push(new D("w:updateFields",t.updateFields)),this.root.push(new Co({version:t.compatabilityModeVersion||15}))}}class Bo extends o{constructor(){super(...arguments),this.xmlKeys={val:"w:val"}}}class Eo extends r{constructor(t){super("w:name"),this.root.push(new Bo({val:t}))}}class Po extends r{constructor(t){super("w:uiPriority"),this.root.push(new Bo({val:_(t)}))}}class xo extends o{constructor(){super(...arguments),this.xmlKeys={type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"}}}class So extends r{constructor(t,e){super("w:style"),this.root.push(new xo(t)),e.name&&this.root.push(new Eo(e.name)),e.basedOn&&this.root.push(new N("w:basedOn",e.basedOn)),e.next&&this.root.push(new N("w:next",e.next)),e.link&&this.root.push(new N("w:link",e.link)),void 0!==e.uiPriority&&this.root.push(new Po(e.uiPriority)),void 0!==e.semiHidden&&this.root.push(new D("w:semiHidden",e.semiHidden)),void 0!==e.unhideWhenUsed&&this.root.push(new D("w:unhideWhenUsed",e.unhideWhenUsed)),void 0!==e.quickFormat&&this.root.push(new D("w:qFormat",e.quickFormat))}}class Io extends So{constructor(t){super({type:"paragraph",styleId:t.id},t),this.paragraphProperties=new Ni(t.paragraph),this.runProperties=new Pt(t.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class Ro extends So{constructor(t){super({type:"character",styleId:t.id},Object.assign({uiPriority:99,unhideWhenUsed:!0},t)),this.runProperties=new Pt(t.run),this.root.push(this.runProperties)}}class To extends Io{constructor(t){super(Object.assign(Object.assign({},t),{basedOn:"Normal",next:"Normal",quickFormat:!0}))}}class Oo extends To{constructor(t){super(Object.assign(Object.assign({},t),{id:"Title",name:"Title"}))}}class Fo extends To{constructor(t){super(Object.assign(Object.assign({},t),{id:"Heading1",name:"Heading 1"}))}}class Do extends To{constructor(t){super(Object.assign(Object.assign({},t),{id:"Heading2",name:"Heading 2"}))}}class Lo extends To{constructor(t){super(Object.assign(Object.assign({},t),{id:"Heading3",name:"Heading 3"}))}}class No extends To{constructor(t){super(Object.assign(Object.assign({},t),{id:"Heading4",name:"Heading 4"}))}}class Ho extends To{constructor(t){super(Object.assign(Object.assign({},t),{id:"Heading5",name:"Heading 5"}))}}class Qo extends To{constructor(t){super(Object.assign(Object.assign({},t),{id:"Heading6",name:"Heading 6"}))}}class Uo extends To{constructor(t){super(Object.assign(Object.assign({},t),{id:"Strong",name:"Strong"}))}}class Mo extends Io{constructor(t){super(Object.assign(Object.assign({},t),{id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0}))}}class ko extends Io{constructor(t){super(Object.assign(Object.assign({},t),{id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:Wt.AUTO}},run:{size:20}}))}}class Vo extends Ro{constructor(t){super(Object.assign(Object.assign({},t),{id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}}))}}class Go extends Ro{constructor(t){super(Object.assign(Object.assign({},t),{id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}}))}}class Ko extends Ro{constructor(t){super(Object.assign(Object.assign({},t),{id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:W.SINGLE}}}))}}class Wo extends r{constructor(t){if(super("w:styles"),t.initialStyles&&this.root.push(t.initialStyles),t.importedStyles)for(const e of t.importedStyles)this.root.push(e);if(t.paragraphStyles)for(const e of t.paragraphStyles)this.root.push(new Io(e));if(t.characterStyles)for(const e of t.characterStyles)this.root.push(new Ro(e))}}class zo extends r{constructor(t){super("w:pPrDefault"),this.root.push(new Ni(t))}}class $o extends r{constructor(t){super("w:rPrDefault"),this.root.push(new Pt(t))}}class Xo extends r{constructor(t){super("w:docDefaults"),this.runPropertiesDefaults=new $o(t.run),this.paragraphPropertiesDefaults=new zo(t.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class jo{newInstance(t){const e=(0,A.xml2js)(t,{compact:!1});let s;for(const t of e.elements||[])"w:styles"===t.name&&(s=t);if(void 0===s)throw new Error("can not find styles element");const i=s.elements||[];return new Wo({initialStyles:new c(s.attributes),importedStyles:i.map((t=>l(t)))})}}class Yo{newInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var e;return{initialStyles:new Bi({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new Xo(null!==(e=t.document)&&void 0!==e?e:{}),new Oo(Object.assign({run:{size:56}},t.title)),new Fo(Object.assign({run:{color:"2E74B5",size:32}},t.heading1)),new Do(Object.assign({run:{color:"2E74B5",size:26}},t.heading2)),new Lo(Object.assign({run:{color:"1F4D78",size:24}},t.heading3)),new No(Object.assign({run:{color:"2E74B5",italics:!0}},t.heading4)),new Ho(Object.assign({run:{color:"2E74B5"}},t.heading5)),new Qo(Object.assign({run:{color:"1F4D78"}},t.heading6)),new Uo(Object.assign({run:{bold:!0}},t.strong)),new Mo(t.listParagraph||{}),new Ko(t.hyperlink||{}),new Vo(t.footnoteReference||{}),new ko(t.footnoteText||{}),new Go(t.footnoteTextChar||{})]}}}class Jo{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,i,r,n,o,a;if(this.currentRelationshipId=1,this.headers=[],this.footers=[],this.coreProperties=new En(Object.assign(Object.assign({},t),{creator:null!==(s=t.creator)&&void 0!==s?s:"Un-named",revision:null!==(i=t.revision)&&void 0!==i?i:1,lastModifiedBy:null!==(r=t.lastModifiedBy)&&void 0!==r?r:"Un-named"})),this.numbering=new mo(t.numbering?t.numbering:{config:[]}),this.fileRelationships=new Ii,this.customProperties=new Tn(null!==(n=t.customProperties)&&void 0!==n?n:[]),this.appProperties=new mn,this.footnotesWrapper=new Wn,this.contentTypes=new Bn,this.documentWrapper=new Ri({background:t.background||{}}),this.settings=new vo({compatabilityModeVersion:t.compatabilityModeVersion,evenAndOddHeaders:!!t.evenAndOddHeaderAndFooters,trackRevisions:null===(o=t.features)||void 0===o?void 0:o.trackRevisions,updateFields:null===(a=t.features)||void 0===a?void 0:a.updateFields}),this.media=e.template&&e.template.media?e.template.media:new jn,e.template&&(this.currentRelationshipId=e.template.currentRelationshipId+1),e.template&&t.externalStyles)throw Error("can not use both template and external styles");if(e.template){const t=new jo;this.styles=t.newInstance(e.template.styles)}else if(t.externalStyles){const e=new jo;this.styles=e.newInstance(t.externalStyles)}else if(t.styles){const e=(new Yo).newInstance(t.styles.default);this.styles=new Wo(Object.assign(Object.assign({},e),t.styles))}else{const t=new Yo;this.styles=new Wo(t.newInstance())}if(this.addDefaultRelationships(),e.template&&e.template.headers)for(const t of e.template.headers)this.addHeaderToDocument(t.header,t.type);if(e.template&&e.template.footers)for(const t of e.template.footers)this.addFooterToDocument(t.footer,t.type);for(const e of t.sections)this.addSection(e);if(t.footnotes)for(const e in t.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(e),t.footnotes[e].children)}addSection(t){let{headers:e={},footers:s={},children:i,properties:r}=t;this.documentWrapper.View.Body.addSection(Object.assign(Object.assign({},r),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:s.default?this.createFooter(s.default):void 0,first:s.first?this.createFooter(s.first):void 0,even:s.even?this.createFooter(s.even):void 0}}));for(const t of i)this.documentWrapper.View.add(t)}createHeader(t){const e=new Xn(this.media,this.currentRelationshipId++);for(const s of t.options.children)e.add(s);return this.addHeaderToDocument(e),e}createFooter(t){const e=new Dn(this.media,this.currentRelationshipId++);for(const s of t.options.children)e.add(s);return this.addFooterToDocument(e),e}addHeaderToDocument(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qt.DEFAULT;this.headers.push({header:t,type:e}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header","header".concat(this.headers.length,".xml")),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qt.DEFAULT;this.footers.push({footer:t,type:e}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer","footer".concat(this.footers.length,".xml")),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map((t=>t.header))}get Footers(){return this.footers.map((t=>t.footer))}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}}const Zo="";class qo extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class ta extends r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("w:instrText"),this.properties=t,this.root.push(new qo({space:V.PRESERVE}));let e="TOC";this.properties.captionLabel&&(e="".concat(e,' \\a "').concat(this.properties.captionLabel,'"')),this.properties.entriesFromBookmark&&(e="".concat(e,' \\b "').concat(this.properties.entriesFromBookmark,'"')),this.properties.captionLabelIncludingNumbers&&(e="".concat(e,' \\c "').concat(this.properties.captionLabelIncludingNumbers,'"')),this.properties.sequenceAndPageNumbersSeparator&&(e="".concat(e,' \\d "').concat(this.properties.sequenceAndPageNumbersSeparator,'"')),this.properties.tcFieldIdentifier&&(e="".concat(e,' \\f "').concat(this.properties.tcFieldIdentifier,'"')),this.properties.hyperlink&&(e="".concat(e," \\h")),this.properties.tcFieldLevelRange&&(e="".concat(e,' \\l "').concat(this.properties.tcFieldLevelRange,'"')),this.properties.pageNumbersEntryLevelsRange&&(e="".concat(e,' \\n "').concat(this.properties.pageNumbersEntryLevelsRange,'"')),this.properties.headingStyleRange&&(e="".concat(e,' \\o "').concat(this.properties.headingStyleRange,'"')),this.properties.entryAndPageNumberSeparator&&(e="".concat(e,' \\p "').concat(this.properties.entryAndPageNumberSeparator,'"')),this.properties.seqFieldIdentifierForPrefix&&(e="".concat(e,' \\s "').concat(this.properties.seqFieldIdentifierForPrefix,'"')),this.properties.stylesWithLevels&&this.properties.stylesWithLevels.length&&(e="".concat(e,' \\t "').concat(this.properties.stylesWithLevels.map((t=>"".concat(t.styleName,",").concat(t.level))).join(","),'"')),this.properties.useAppliedParagraphOutlineLevel&&(e="".concat(e," \\u")),this.properties.preserveTabInEntries&&(e="".concat(e," \\w")),this.properties.preserveNewLineInEntries&&(e="".concat(e," \\x")),this.properties.hideTabAndPageNumbersInWebView&&(e="".concat(e," \\z")),this.root.push(e)}}class ea extends r{constructor(){super("w:sdtContent")}}class sa extends o{constructor(){super(...arguments),this.xmlKeys={alias:"w:val"}}}class ia extends r{constructor(t){super("w:alias"),this.root.push(new sa({alias:t}))}}class ra extends r{constructor(t){super("w:sdtPr"),this.root.push(new ia(t))}}class na extends r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Table of Contents",e=arguments.length>1?arguments[1]:void 0;super("w:sdt"),this.root.push(new ra(t));const s=new ea,i=new Hi({children:[new Rt({children:[new it(!0),new ta(e),new rt]})]});s.addChildElement(i);const r=new Hi({children:[new Rt({children:[new nt]})]});s.addChildElement(r),this.root.push(s)}}class oa{constructor(t,e){this.styleName=t,this.level=e}}class aa{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{children:[]};this.options=t}}class Aa{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{children:[]};this.options=t}}class la extends o{constructor(){super(...arguments),this.xmlKeys={id:"w:id"}}}class ha extends r{constructor(t){super("w:footnoteReference"),this.root.push(new la({id:t}))}}class da extends Rt{constructor(t){super({style:"FootnoteReference"}),this.root.push(new ha(t))}}class ca extends r{constructor(t){super("w:ins"),this.root.push(new ht({id:t.id,author:t.author,date:t.date})),this.addChildElement(new Tt(t))}}class ua extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class pa extends r{constructor(){super("w:delInstrText"),this.root.push(new ua({space:V.PRESERVE})),this.root.push("PAGE")}}class _a extends r{constructor(){super("w:delInstrText"),this.root.push(new ua({space:V.PRESERVE})),this.root.push("NUMPAGES")}}class ga extends r{constructor(){super("w:delInstrText"),this.root.push(new ua({space:V.PRESERVE})),this.root.push("SECTIONPAGES")}}class fa extends o{constructor(){super(...arguments),this.xmlKeys={space:"xml:space"}}}class ma extends r{constructor(t){super("w:delText"),this.root.push(new fa({space:V.PRESERVE})),this.root.push(t)}}class wa extends r{constructor(t){super("w:del"),this.root.push(new ht({id:t.id,author:t.author,date:t.date})),this.deletedTextRunWrapper=new ya(t),this.addChildElement(this.deletedTextRunWrapper)}}class ya extends r{constructor(t){if(super("w:r"),this.root.push(new Pt(t)),t.children)for(const e of t.children)if("string"!=typeof e)this.root.push(e);else switch(e){case z.CURRENT:this.root.push(new it),this.root.push(new pa),this.root.push(new rt),this.root.push(new nt);break;case z.TOTAL_PAGES:this.root.push(new it),this.root.push(new _a),this.root.push(new rt),this.root.push(new nt);break;case z.TOTAL_PAGES_IN_SECTION:this.root.push(new it),this.root.push(new ga),this.root.push(new rt),this.root.push(new nt);break;default:this.root.push(new ma(e))}else t.text&&this.root.push(new ma(t.text));if(t.break)for(let e=0;e<t.break;e++)this.root.splice(1,0,new et)}}var Ca,ba,va;!function(t){t.CENTER="center",t.INSIDE="inside",t.LEFT="left",t.OUTSIDE="outside",t.RIGHT="right"}(Ca||(Ca={})),function(t){t.BOTTOM="bottom",t.CENTER="center",t.INSIDE="inside",t.OUTSIDE="outside",t.TOP="top"}(ba||(ba={})),function(t){t.DECIMAL="decimal",t.UPPER_ROMAN="upperRoman",t.LOWER_ROMAN="lowerRoman",t.UPPER_LETTER="upperLetter",t.LOWER_LETTER="lowerLetter",t.ORDINAL="ordinal",t.CARDINAL_TEXT="cardinalText",t.ORDINAL_TEXT="ordinalText",t.HEX="hex",t.CHICAGO="chicago",t.IDEOGRAPH_DIGITAL="ideographDigital",t.JAPANESE_COUNTING="japaneseCounting",t.AIUEO="aiueo",t.IROHA="iroha",t.DECIMAL_FULL_WIDTH="decimalFullWidth",t.DECIMAL_HALF_WIDTH="decimalHalfWidth",t.JAPANESE_LEGAL="japaneseLegal",t.JAPANESE_DIGITAL_TEN_THOUSAND="japaneseDigitalTenThousand",t.DECIMAL_ENCLOSED_CIRCLE="decimalEnclosedCircle",t.DECIMAL_FULL_WIDTH_2="decimalFullWidth2",t.AIUEO_FULL_WIDTH="aiueoFullWidth",t.IROHA_FULL_WIDTH="irohaFullWidth",t.DECIMAL_ZERO="decimalZero",t.BULLET="bullet",t.GANADA="ganada",t.CHOSUNG="chosung",t.DECIMAL_ENCLOSED_FULL_STOP="decimalEnclosedFullstop",t.DECIMAL_ENCLOSED_PAREN="decimalEnclosedParen",t.DECIMAL_ENCLOSED_CIRCLE_CHINESE="decimalEnclosedCircleChinese",t.IDEOGRAPH_ENCLOSED_CIRCLE="ideographEnclosedCircle",t.IDEOGRAPH_TRADITIONAL="ideographTraditional",t.IDEOGRAPH_ZODIAC="ideographZodiac",t.IDEOGRAPH_ZODIAC_TRADITIONAL="ideographZodiacTraditional",t.TAIWANESE_COUNTING="taiwaneseCounting",t.IDEOGRAPH_LEGAL_TRADITIONAL="ideographLegalTraditional",t.TAIWANESE_COUNTING_THOUSAND="taiwaneseCountingThousand",t.TAIWANESE_DIGITAL="taiwaneseDigital",t.CHINESE_COUNTING="chineseCounting",t.CHINESE_LEGAL_SIMPLIFIED="chineseLegalSimplified",t.CHINESE_COUNTING_TEN_THOUSAND="chineseCountingThousand",t.KOREAN_DIGITAL="koreanDigital",t.KOREAN_COUNTING="koreanCounting",t.KOREAN_LEGAL="koreanLegal",t.KOREAN_DIGITAL_2="koreanDigital2",t.VIETNAMESE_COUNTING="vietnameseCounting",t.RUSSIAN_LOWER="russianLower",t.RUSSIAN_UPPER="russianUpper",t.NONE="none",t.NUMBER_IN_DASH="numberInDash",t.HEBREW_1="hebrew1",t.HEBREW_2="hebrew2",t.ARABIC_ALPHA="arabicAlpha",t.ARABIC_ABJAD="arabicAbjad",t.HINDI_VOWELS="hindiVowels",t.HINDI_CONSONANTS="hindiConsonants",t.HINDI_NUMBERS="hindiNumbers",t.HINDI_COUNTING="hindiCounting",t.THAI_LETTERS="thaiLetters",t.THAI_NUMBERS="thaiNumbers",t.THAI_COUNTING="thaiCounting",t.BAHT_TEXT="bahtText",t.DOLLAR_TEXT="dollarText"}(va||(va={}));var Ba=s(733),Ea=s(479);class Pa{format(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=t.prepForXml(e);if(s)return s;throw Error("XMLComponent did not format correctly")}}class xa{replace(t,e,s){let i=t;return e.forEach(((t,e)=>{i=i.replace(new RegExp("{".concat(t.fileName,"}"),"g"),(s+e).toString())})),i}getMediaData(t,e){return e.Array.filter((e=>t.search("{".concat(e.fileName,"}"))>0))}}class Sa{replace(t,e){let s=t;for(const t of e)s=s.replace(new RegExp("{".concat(t.reference,"-").concat(t.instance,"}"),"g"),t.numId.toString());return s}}var Ia=function(t,e,s,i){return new(s||(s=Promise))((function(r,n){function o(t){try{A(i.next(t))}catch(t){n(t)}}function a(t){try{A(i.throw(t))}catch(t){n(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}A((i=i.apply(t,e||[])).next())}))};class Ra{static toBuffer(t,e){return Ia(this,void 0,void 0,(function*(){const s=this.compiler.compile(t,e);return yield s.generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}))}static toBase64String(t,e){return Ia(this,void 0,void 0,(function*(){const s=this.compiler.compile(t,e);return yield s.generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}))}static toBlob(t,e){return Ia(this,void 0,void 0,(function*(){const s=this.compiler.compile(t,e);return yield s.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})}))}}Ra.compiler=new class{constructor(){this.formatter=new Pa,this.imageReplacer=new xa,this.numberingReplacer=new Sa}compile(t,e){const s=new Ba,i=this.xmlifyFile(t,e),r=new Map(Object.entries(i));for(const[,t]of r)if(Array.isArray(t))for(const e of t)s.file(e.path,e.data);else s.file(t.path,t.data);for(const e of t.Media.Array){const t=e.stream;s.file("word/media/".concat(e.fileName),t)}return s}xmlifyFile(t,e){const s=t.Document.Relationships.RelationshipCount+1,i=Ea(this.formatter.format(t.Document.View,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{standalone:"yes",encoding:"UTF-8"}}),r=this.imageReplacer.getMediaData(i,t.Media);return{Relationships:{data:(()=>(r.forEach(((e,i)=>{t.Document.Relationships.createRelationship(s+i,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image","media/".concat(e.fileName))})),Ea(this.formatter.format(t.Document.Relationships,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{encoding:"UTF-8"}})))(),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const e=this.imageReplacer.replace(i,r,s);return this.numberingReplacer.replace(e,t.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const s=Ea(this.formatter.format(t.Styles,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(s,t.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:Ea(this.formatter.format(t.CoreProperties,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:Ea(this.formatter.format(t.Numbering,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:Ea(this.formatter.format(t.FileRelationships,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:t.Headers.map(((s,i)=>{const r=Ea(this.formatter.format(s.View,{viewWrapper:s,file:t}),{indent:e,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(r,t.Media).forEach(((t,e)=>{s.Relationships.createRelationship(e,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image","media/".concat(t.fileName))})),{data:Ea(this.formatter.format(s.Relationships,{viewWrapper:s,file:t}),{indent:e,declaration:{encoding:"UTF-8"}}),path:"word/_rels/header".concat(i+1,".xml.rels")}})),FooterRelationships:t.Footers.map(((s,i)=>{const r=Ea(this.formatter.format(s.View,{viewWrapper:s,file:t}),{indent:e,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(r,t.Media).forEach(((t,e)=>{s.Relationships.createRelationship(e,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image","media/".concat(t.fileName))})),{data:Ea(this.formatter.format(s.Relationships,{viewWrapper:s,file:t}),{indent:e,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footer".concat(i+1,".xml.rels")}})),Headers:t.Headers.map(((s,i)=>{const r=Ea(this.formatter.format(s.View,{viewWrapper:s,file:t}),{indent:e,declaration:{encoding:"UTF-8"}}),n=this.imageReplacer.getMediaData(r,t.Media);return{data:this.imageReplacer.replace(r,n,0),path:"word/header".concat(i+1,".xml")}})),Footers:t.Footers.map(((s,i)=>{const r=Ea(this.formatter.format(s.View,{viewWrapper:s,file:t}),{indent:e,declaration:{encoding:"UTF-8"}}),n=this.imageReplacer.getMediaData(r,t.Media);return{data:this.imageReplacer.replace(r,n,0),path:"word/footer".concat(i+1,".xml")}})),ContentTypes:{data:Ea(this.formatter.format(t.ContentTypes,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:Ea(this.formatter.format(t.CustomProperties,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:Ea(this.formatter.format(t.AppProperties,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:Ea(this.formatter.format(t.FootNotes.View,{viewWrapper:t.FootNotes,file:t}),{indent:e,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:Ea(this.formatter.format(t.FootNotes.Relationships,{viewWrapper:t.FootNotes,file:t}),{indent:e,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:Ea(this.formatter.format(t.Settings,{viewWrapper:t.Document,file:t}),{indent:e,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"}}}};var Ta=function(t,e,s,i){return new(s||(s=Promise))((function(r,n){function o(t){try{A(i.next(t))}catch(t){n(t)}}function a(t){try{A(i.throw(t))}catch(t){n(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}A((i=i.apply(t,e||[])).next())}))};const Oa={"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header":"header","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer":"footer","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":"image","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink":"hyperlink"};var Fa;!function(t){t.HEADER="header",t.FOOTER="footer",t.IMAGE="image",t.HYPERLINK="hyperlink"}(Fa||(Fa={}));class Da{extract(t){return Ta(this,void 0,void 0,(function*(){const e=yield Ba.loadAsync(t),s=yield e.files["word/document.xml"].async("text"),i=yield e.files["word/_rels/document.xml.rels"].async("text"),r=this.extractDocumentRefs(s),n=this.findReferenceFiles(i),o=new jn;return{headers:yield this.createHeaders(e,r,n,o,0),footers:yield this.createFooters(e,r,n,o,r.headers.length),currentRelationshipId:r.footers.length+r.headers.length,styles:yield e.files["word/styles.xml"].async("text"),titlePageIsDefined:this.checkIfTitlePageIsDefined(s),media:o}}))}createFooters(t,e,s,i,r){return Ta(this,void 0,void 0,(function*(){const n=e.footers.map(((e,n)=>Ta(this,void 0,void 0,(function*(){const o=s.find((t=>t.id===e.id));if(null===o||!o)throw new Error("Can not find target file for id ".concat(e.id));const a=yield t.files["word/".concat(o.target)].async("text"),h=(0,A.xml2js)(a,{compact:!1,captureSpacesBetweenElements:!0});if(!h.elements)return;const d=l(h.elements.reduce(((t,e)=>"w:ftr"===e.name?e:t))),c=new Dn(i,r+n,d);return yield this.addRelationshipToWrapper(o,t,c,i),{type:e.type,footer:c}})))).filter((t=>!!t));return Promise.all(n)}))}createHeaders(t,e,s,i,r){return Ta(this,void 0,void 0,(function*(){const n=e.headers.map(((e,n)=>Ta(this,void 0,void 0,(function*(){const o=s.find((t=>t.id===e.id));if(null===o||!o)throw new Error("Can not find target file for id ".concat(e.id));const a=yield t.files["word/".concat(o.target)].async("text"),h=(0,A.xml2js)(a,{compact:!1,captureSpacesBetweenElements:!0});if(!h.elements)return;const d=l(h.elements.reduce(((t,e)=>"w:hdr"===e.name?e:t))),c=new Xn(i,r+n,d);return yield this.addRelationshipToWrapper(o,t,c,i),{type:e.type,header:c}})))).filter((t=>!!t));return Promise.all(n)}))}addRelationshipToWrapper(t,e,s,i){return Ta(this,void 0,void 0,(function*(){const r=e.files["word/_rels/".concat(t.target,".rels")];if(!r)return;const n=yield r.async("text"),o=this.findReferenceFiles(n).filter((t=>t.type===Fa.IMAGE)),a=this.findReferenceFiles(n).filter((t=>t.type===Fa.HYPERLINK));for(const t of o){const r=yield e.files["word/".concat(t.target)].async("nodebuffer"),n=i.addMedia(r,{width:100,height:100});s.Relationships.createRelationship(t.id,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image","media/".concat(n.fileName))}for(const t of a)s.Relationships.createRelationship(t.id,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.target,Yt.EXTERNAL)}))}findReferenceFiles(t){const e=(0,A.xml2js)(t,{compact:!0});return(Array.isArray(e.Relationships.Relationship)?e.Relationships.Relationship:[e.Relationships.Relationship]).map((t=>{if(void 0===t._attributes)throw Error("relationship element has no attributes");return{id:this.parseRefId(t._attributes.Id),type:Oa[t._attributes.Type],target:t._attributes.Target}})).filter((t=>null!==t.type))}extractDocumentRefs(t){const e=(0,A.xml2js)(t,{compact:!0})["w:document"]["w:body"]["w:sectPr"],s=e["w:headerReference"];let i;i=void 0===s?[]:Array.isArray(s)?s:[s];const r=i.map((t=>{if(void 0===t._attributes)throw Error("header reference element has no attributes");return{type:t._attributes["w:type"],id:this.parseRefId(t._attributes["r:id"])}})),n=e["w:footerReference"];let o;return o=void 0===n?[]:Array.isArray(n)?n:[n],{headers:r,footers:o.map((t=>{if(void 0===t._attributes)throw Error("footer reference element has no attributes");return{type:t._attributes["w:type"],id:this.parseRefId(t._attributes["r:id"])}}))}}checkIfTitlePageIsDefined(t){return void 0!==(0,A.xml2js)(t,{compact:!0})["w:document"]["w:body"]["w:sectPr"]["w:titlePg"]}parseRefId(t){const e=/^rId(\d+)$/.exec(t);if(null===e)throw new Error("Invalid ref id");return parseInt(e[1],10)}}})(),i})()}));class cv{constructor(){this._elements=[],this._images={},this._loadCount=0}get loaded(){return 0===this._elements.length}add(t,e){if(!(t in this._images)){const s=document.createElement("img");s.crossOrigin="anonymous",s.src=t,s.style.opacity=e,this._elements.push(s),this._images[t]=""}}get(t){return this._images[t]}load(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;if(this._loadCount<t){for(let t=this._elements.length-1;t>=0;t--){const e=this._elements[t];if(e.complete&&e.naturalHeight>0){const s=document.createElement("canvas"),i=s.getContext("2d"),r=parseFloat(e.style.opacity)||1;s.width=e.width,s.height=e.height,i.globalAlpha=r,i.drawImage(e,0,0);const n=s.toDataURL("image/png");this._images[e.src]=n,this._elements.splice(t,1)}}return this._loadCount++,0===this._elements.length}return!0}}function uv(t,e){const s={};if(t.borderLeft){const t=e.borderLeftStyle,i=e.borderLeftColor;s.left={style:t,color:i}}if(t.borderRight){const t=e.borderRightStyle,i=e.borderRightColor;s.right={style:t,color:i}}if(t.borderTop){const t=e.borderTopStyle,i=e.borderTopColor;s.top={style:t,color:i}}if(t.borderBottom){const t=e.borderBottomStyle,i=e.borderBottomColor;s.bottom={style:t,color:i}}return J.isEmpty(s)?null:s}function pv(t,e){const s=e.getBoundingClientRect(),i=e.firstElementChild.children[0].firstElementChild.firstElementChild,r=e.firstElementChild.children[1].firstElementChild.firstElementChild,n=e.children[1],o=document.createElement("canvas"),a=o.getContext("2d");o.width=s.width,o.height=s.height,a.strokeStyle=getComputedStyle(n).borderTopColor,a.beginPath(),a.moveTo(0,0),a.lineTo(s.width,s.height),a.stroke();let A=getComputedStyle(i);return a.textBaseline="bottom",a.fillStyle=A.color,a.font=A.font,a.fillText(i.textContent,0,s.height-1),A=getComputedStyle(r),a.textBaseline="top",a.textAlign="right",a.fillStyle=A.color,a.font=A.font,a.fillText(r.textContent,s.width,1),o.toDataURL()}const _v=["borderTopStyle","borderBottomStyle","borderLeftStyle","borderRightStyle"],gv=["borderTopColor","borderBottomColor","borderLeftColor","borderRightColor"];class fv{}class mv extends fv{constructor(t,e,s){if(super(),this._dom=e,this._model=s,e instanceof Text?this._elements=[]:this._elements=this.$_build(t,e,s)||[],e instanceof Element&&s){const s=this._elements,i=t.getBounds(e),r=getComputedStyle(e),n=Ve.cssToColor(r.backgroundColor);for(let e=0;e<_v.length;e++){const n=r[_v[e]];if(n&&"none"!=n){let o,a,A,l;switch(e){case 0:o=i.x,A=i.x+i.width,a=l=i.y;break;case 1:o=i.x,A=i.x+i.width,a=l=i.y+i.height>>>0;break;case 2:o=A=i.x,a=i.y,l=i.y+i.height;break;case 3:o=A=i.x+i.width>>>0,a=i.y,l=i.y+i.height}const h=new Sv(t,o,a,A,l,n,r[gv[e]]);s.unshift(h)}}if(n){const i=new yv(t,e,null);i.color=n.color,i.alpha=n.alpha,s.unshift(i)}}}get model(){return this._model}write(t){return this._doWrite(t,this._dom,this._model)}_doWrite(t,e,s){const i=[],r=this._elements;return null==r||r.forEach((e=>{e.write(t).forEach((t=>i.push(t)))})),i}$_build(t,e,s){return this._doBuild(t,e,s)}_doBuild(t,e,s){const i=[],r=e.children;for(let e=0;e<r.length;e++){const s=r[e],n=t.createDOCElements(s);J.isArray(n)?i.push(...n):n&&i.push(n)}return i}_fontName(t){if(t){const e=t.split(/,\s*/)[0];return e.startsWith('"')?e.substring(1,e.length-1):e}return"굴림"}_fontSize(t){return t?t.endsWith("px")?Math.round(72*parseInt(t)/96)+"pt":t.endsWith("pt")?t:t+"pt":"10px"}_toBold(t){return parseInt(t)>=700}_toUnderline(t){if(t&&t.indexOf("underline")>=0)return{}}_toColor(t){function e(t){return 1===(t=(+t).toString(16)).length?"0"+t:t}if(t.startsWith("#"))return t.substr(t.length-6);if(t.startsWith("rgb(")){const s=t.substring(4,t.length-1).split(/,\s*/);return s[2],e(s[0])+e(s[1])+e(s[2])}if(t.startsWith("rgba(")){const s=t.substring(5,t.length-1).split(/,\s*/);return s[3],e(s[0])+e(s[1])+e(s[2])}return"000000"}_toDoc(t){return 20*t*72/96>>0}_toPosition(t){return 914400*t/96>>0}_toSize(t){return t>>0}_toShading(t,e){return e<1?{fill:J.pad16(Ve.lighten(t,e),6)}:{fill:J.pad16(t,6)}}_createText(t,e){return 1===t.length&&160===t.charCodeAt(0)&&(t=""),new dv.TextRun({text:t,font:this._fontName(e.fontFamily),size:this._fontSize(e.fontSize),color:this._toColor(e.color),italics:"italic"===e.fontStyle,bold:this._toBold(e.fontWeight),underline:this._toUnderline(e.textDecoration)})}_getFloating(t){return{horizontalPosition:{relative:dv.HorizontalPositionRelativeFrom.PAGE,offset:this._toPosition(t.x)},verticalPosition:{relative:dv.VerticalPositionRelativeFrom.PAGE,offset:this._toPosition(t.y)},allowOverlap:!0}}}class wv extends mv{constructor(t,e,s){super(t,e,s)}_doBuild(t,e,s){const i=[],r=e.childNodes;for(let e=0;e<r.length;e++){const s=r[e],n=s instanceof Text?new Cv(t,s,null):t.createDOCElements(s);J.isArray(n)?i.push(...n):n&&i.push(n)}return i}}class yv extends mv{constructor(){super(...arguments),this.alpha=1}_doWrite(t,e,s){if(t.inTable){const s=t.getBounds(e);return[new dv.ImageRun({data:this.$_createImage(t,s,e),transformation:{width:this._toSize(s.width),height:this._toSize(s.height)}})]}const i=t.getBounds(e);return[new dv.Paragraph({frame:{position:{x:this._toDoc(i.x),y:this._toDoc(i.y)},width:1*this._toDoc(i.width),height:1*this._toDoc(i.height),anchor:{horizontal:dv.FrameAnchorType.TEXT,vertical:dv.FrameAnchorType.TEXT},alignment:{x:dv.HorizontalPositionAlign.CENTER,y:dv.VerticalPositionAlign.CENTER}},shading:this._toShading(this.color,this.alpha),children:[]})]}$_createImage(t,e,s){const i=document.createElement("canvas"),r=i.getContext("2d");return i.width=Math.max(1,e.width),i.height=Math.max(1,e.height),r.fillStyle=Ve.colorToCss(this.color,this.alpha),r.fillRect(0,0,i.width,i.height),i.toDataURL()}}class Cv extends mv{_doWrite(t,e){const s=e instanceof Text?t.getTextBounds(e):t.getBounds(e),i=getComputedStyle(e instanceof Text?e.parentElement:e),r=e.textContent;return t.inTable?[this._createText(r,i)]:[new dv.Paragraph({frame:{position:{x:this._toDoc(s.x),y:this._toDoc(s.y-.2*s.height)},width:1.05*this._toDoc(s.width),height:1*this._toDoc(s.height),anchor:{horizontal:dv.FrameAnchorType.PAGE,vertical:dv.FrameAnchorType.PAGE},alignment:{x:dv.HorizontalPositionAlign.CENTER,y:dv.VerticalPositionAlign.CENTER}},children:[this._createText(r,i)]})]}_doBuild(t,e,s){}}class bv extends mv{constructor(t,e,s){super(t,e,s)}_doBuild(t,e,s){const i=getComputedStyle(e),r=J.getImageUrl(i);r.startsWith("data:image")?this._data=r:r.startsWith("http")&&t.addImage(this._url=r,i.opacity)}_doWrite(t,e,s){const i=this._data||t.getImage(this._url)||new Uint8Array(0),r=t.getBounds(e),n=[new dv.ImageRun({data:i,transformation:{width:this._toSize(r.width),height:this._toSize(r.height)},floating:t.inTable?void 0:this._getFloating(r)})];return t.inTable?n:[new dv.Paragraph({children:n})]}}class vv extends mv{constructor(t,e,s){super(t,e,s)}_doBuild(t,e,s){const i=e.querySelector("img");i&&(this._data=i.src)}_doWrite(t,e,s){const i=this._data||new Uint8Array(0),r=t.getBounds(e),n=[new dv.ImageRun({data:i,transformation:{width:this._toSize(r.width),height:this._toSize(r.height)},floating:t.inTable?void 0:this._getFloating(r)})];return t.inTable?n:[new dv.Paragraph({children:n})]}}class Bv extends mv{constructor(t,e,s){super(t,e,s)}_doBuild(t,e,s){this._data=pv(0,e)}_doWrite(t,e,s){const i=t.getBounds(e);return[new dv.ImageRun({data:this._data,transformation:{width:this._toSize(i.width),height:this._toSize(i.height)},floating:t.inTable?void 0:this._getFloating(i)})]}}class Ev extends mv{constructor(t,e,s,i){super(t,e,i);const r=new Blob([s],{type:"image/svg+xml;charset=utf-8"});this._svgData=(URL||webkitURL).createObjectURL(r),t.addImage(this._svgData,"1")}_doBuild(t,e,s){}_doWrite(t,e,s){const i=t.getImage(this._svgData+""),r=t.getBounds(e),n=[new dv.ImageRun({data:i||new Uint8Array(0),transformation:{width:this._toSize(r.width),height:this._toSize(r.height)},floating:t.inTable?void 0:this._getFloating(r)})];return t.inTable?n:[new dv.Paragraph({children:n})]}}class Pv extends mv{constructor(t,e,s){super(t,e,s)}_doBuild(t,e,s){this._data=e.toDataURL()}_doWrite(t,e,s){const i=t.getBounds(e),r=[new dv.ImageRun({data:this._data,transformation:{width:this._toSize(i.width),height:this._toSize(i.height)},floating:t.inTable?void 0:this._getFloating(i)})];return t.inTable?r:[new dv.Paragraph({children:r})]}}class xv extends mv{}class Sv extends mv{constructor(t,e,s,i,r,n,o){super(t,null,null),this._x1=Math.min(e,i),this._y1=Math.min(s,r),this._x2=Math.max(e,i),this._y2=Math.max(s,r),this._x11=e-this._x1,this._y11=s-this._y1,this._x22=i-this._x1,this._y22=r-this._y1,this._cssStyle=n,this._cssColor=o}static bulidLine(t,e,s,i,r,n){const o=document.createElement("canvas"),a=o.getContext("2d");switch(o.width=Math.max(1,Math.abs(s-t)),o.height=Math.max(1,Math.abs(i-e)),r){case"dashed":a.setLineDash([4,3]);break;case"dotted":a.setLineDash([2,2])}a.strokeStyle=n,a.beginPath(),a.moveTo(t,e),a.lineTo(s,i),a.stroke();return o.toDataURL()}static write(t,e,s,i,r,n){const o=[new dv.ImageRun({data:e,transformation:{width:r,height:n},floating:t.inTable?void 0:{horizontalPosition:{relative:dv.HorizontalPositionRelativeFrom.PAGE,offset:s},verticalPosition:{relative:dv.VerticalPositionRelativeFrom.PAGE,offset:i},allowOverlap:!0}})];return t.inTable?o:[new dv.Paragraph({children:o})]}_doBuild(t,e,s){}_doWrite(t,e,s){return this._data||(this._data=Sv.bulidLine(this._x11,this._y11,this._x22,this._y22,this._cssStyle,this._cssColor)),Sv.write(t,this._data,this._toPosition(this._x1),this._toPosition(this._y1),this._toSize(Math.max(1,this._x2-this._x1)),this._toSize(Math.max(1,this._y2-this._y1)))}}class Iv extends mv{constructor(t,e,s){super(t,e,s)}_doBuild(t,e,s){const i=e.getBoundingClientRect();s.reversed?this._data=Sv.bulidLine(0,i.height,i.width,0,"solid","black"):this._data=Sv.bulidLine(0,0,i.width,i.height,"solid","black")}_doWrite(t,e,s){const i=t.getBounds(e);return Sv.write(t,this._data,this._toPosition(i.x),this._toPosition(i.y),this._toSize(i.width),this._toSize(i.height))}}class Rv{constructor(t,e,s){this._pages=[],s.forEach((e=>{t.setPageDiv(e.page),this._pages.push(new Tv(t,e))}))}get pages(){return this._pages}}class Tv extends fv{constructor(t,e){super(),this._page=e,this._elements=this.$_build(t)}write(t){const e=[];t.setPageDiv(this._page.page);for(let s of this._elements){const i=s.write(t);null==i||i.forEach((t=>e.push(t)))}return e}$_buildBackground(t,e){return new mv(t,e,null)}$_buildForeground(t,e){return new mv(t,e,null)}$_buildPageHeader(t,e){return new mv(t,e,t.report.page.pageHeader)}$_buildPageFooter(t,e){return new mv(t,e,t.report.page.pageFooter)}$_buildPageBody(t,e){const s=[];for(let i of e){const e=t.createDOCElements(i);J.isArray(e)?s.push(...e):e&&s.push(e)}return s}$_build(t){const e=this._page,s=[];return s.push(this.$_buildBackground(t,e.background)),s.push(this.$_buildPageHeader(t,e.pageHeader)),this.$_buildPageBody(t,e.contents).forEach((t=>t&&s.push(t))),s.push(this.$_buildPageFooter(t,e.pageFooter)),s.push(this.$_buildForeground(t,e.foreground)),s}}const Ov={l:dv.AlignmentType.LEFT,c:dv.AlignmentType.CENTER,r:dv.AlignmentType.RIGHT};class Fv extends mv{constructor(t,e,s){super(t,e,s)}write(t){const e=t.inTable;t.inTable=this;try{return super.write(t)}finally{t.inTable=e}}_doBuild(t,e,s){var i;const r=e.rows,n=this._elts=[],o=t.inTable;t.inTable=this;try{for(let e=0;e<r.length;e++){const s=r[e].cells,o=[];for(let e=0;e<s.length;e++){const r=s[e];if("none"===getComputedStyle(r).display)o.push(null);else{const e=t.createDOCElements(null===(i=r.firstElementChild)||void 0===i?void 0:i.firstElementChild);o.push(e)}}n.push(o)}}finally{t.inTable=o}}_doWrite(t,e,s){const i=e.firstChild.children,r=i.length,n=new Array(r),o=t.getBounds(e);for(let t=0;t<r;t++){const e=i[t],s=e.$_w;n[t]=this._toDoc(isNaN(s)?+e.dataset.width:s)}return[new dv.Table({float:{horizontalAnchor:dv.TableAnchorType.PAGE,verticalAnchor:dv.TableAnchorType.PAGE,overlap:dv.OverlapType.OVERLAP,absoluteHorizontalPosition:this._toDoc(o.x),absoluteVerticalPosition:this._toDoc(o.y)},layout:dv.TableLayoutType.FIXED,columnWidths:n,rows:this.$_writeRows(t,e.rows)})]}$_writeRows(t,e){const s=[];for(let i=0;i<e.length;i++)s.push(this.$_writeRow(t,i,e[i]));return s}$_writeRow(t,e,s){function i(t){if(t){if("none"===t.style)return{style:dv.BorderStyle.NONE,size:0,color:"ffffff"};if(0===Ve.cssToColor(t.color,!1).alpha)return{style:dv.BorderStyle.NONE,size:0,color:"ffffff"}}}const r=s.cells,n=getComputedStyle(s),o=Ve.cssToColor(n.backgroundColor),a=[];for(let s=0;s<r.length;s++){const n=r[s],A=getComputedStyle(n);if("none"===A.display)continue;const l=Ve.cssToColor(A.backgroundColor)||o;let h=A;const d=n.getElementsByClassName(vl.SPAN)[0];d&&(h=getComputedStyle(d));const c=uv(n.style,A);let u;c&&(u={start:i(c.left),end:i(c.right),top:i(c.top),bottom:i(c.bottom)});const p=Ov[n.dataset._align],_=this._elts[e][s];let g;if(_ instanceof mv&&_.model instanceof cr)g=[this._createText(n.textContent,h)];else if(Array.isArray(_)){g=[];for(let e of _)g.push(...e.write(t))}else g=_?_.write(t):[];let f=!0;for(let t of g)if(!(t instanceof dv.Run)){f=!1;break}f&&(g=[new dv.Paragraph({children:g,alignment:p})]);const m=new dv.TableCell({columnSpan:n.colSpan||1,rowSpan:n.rowSpan||1,children:g,shading:l&&this._toShading(l.color,l.alpha),verticalAlign:dv.VerticalAlign.CENTER,borders:u});a.push(m)}return new dv.TableRow({height:{value:this._toDoc(s.clientHeight),rule:dv.HeightRule.EXACT},children:a})}}class Dv extends mv{constructor(t,e,s){super(t,e,s)}write(t){const e=t.inTable;t.inTable=this;try{return super.write(t)}finally{t.inTable=e}}_doBuild(t,e,s){const i=Array.from(e.firstElementChild.children);this._vertical=s instanceof mr;const r=this._elts=[],n=t.inTable;t.inTable=this;try{for(let e=0;e<i.length;e++){const s=t.createDOCElements(i[e]);r.push(s)}}finally{t.inTable=n}}_doWrite(t,e,s){const i=Array.from(e.firstElementChild.children),r=this._elts,n=s instanceof mr,o=n?1:r.length,a=n?r.length:1,A=s.getItemGap(e.offsetWidth),l=s.itemsAlign,h=this._wDom=e.offsetWidth,d=this._hDom=e.offsetHeight,c=this._wCols=new Array(o),u=this._hRows=new Array(a);if(n){c[0]=this._toDoc(h);let t=0;for(let e=0;e<a;e++){const s=i[e].offsetHeight+A;u[e]=this._toDoc(s),t+=s}t<d&&(l===_r.MIDDLE?(i.unshift(null),u.unshift(this._toDoc((d-t)/2)),r.unshift(null),i.push(null),u.push(this._toDoc((d-t)/2)),r.push(null)):l===_r.END?(i.unshift(null),u.unshift(this._toDoc(d-t)),r.unshift(null)):(i.push(null),u.push(this._toDoc(d-t)),r.push(null)))}else{u[0]=this._toDoc(d);let t=0;for(let e=0;e<o;e++){const s=i[e].offsetWidth+A;c[e]=this._toDoc(s),t+=s}t<h&&(l===_r.MIDDLE?(i.unshift(null),c.unshift(this._toDoc((h-t)/2)),r.unshift(null),i.push(null),c.push(this._toDoc((h-t)/2)),r.push(null)):l===_r.END?(i.unshift(null),c.unshift(this._toDoc(h-t)),r.unshift(null)):(i.push(null),c.push(this._toDoc(h-t)),r.push(null)))}const p=t.getBounds(e);return[new dv.Table({float:{horizontalAnchor:dv.TableAnchorType.PAGE,verticalAnchor:dv.TableAnchorType.PAGE,overlap:dv.OverlapType.OVERLAP,absoluteHorizontalPosition:this._toDoc(p.x),absoluteVerticalPosition:this._toDoc(p.y)},layout:dv.TableLayoutType.FIXED,columnWidths:c,rows:this.$_writeRows(t,i)})]}$_writeRows(t,e){const s=[];if(this._vertical)for(let i=0;i<e.length;i++)s.push(this.$_writeRow(t,i,[e[i]]));else s.push(this.$_writeRow(t,0,e));return s}$_writeRow(t,e,s){const i=this._wDom,r=this._hDom,n=[];for(let o=0;o<s.length;o++){const a={start:{style:dv.BorderStyle.NONE,size:0,color:"ffffff"},end:{style:dv.BorderStyle.NONE,size:0,color:"ffffff"},top:{style:dv.BorderStyle.NONE,size:0,color:"ffffff"},bottom:{style:dv.BorderStyle.NONE,size:0,color:"ffffff"}},A=s[o],l=this._elts[e*s.length+o];let h;if(l instanceof mv&&l.model instanceof cr){const t=getComputedStyle(A);h=[this._createText(A.textContent,t)]}else if(Array.isArray(l)){h=[];for(let e of l)h.push(...e.write(t))}else h=l?l.write(t):[];let d=dv.AlignmentType.CENTER,c=dv.VerticalAlign.CENTER;const u={left:0,right:0,top:0,bottom:0};if(l){const e=A instanceof HTMLElement&&t.report.models[A.dataset._m_];if(this._vertical){const t=e.getLeft(i),s=e.getRight(i);(isNaN(t)||isNaN(s))&&isNaN(t)?isNaN(s)||(d=dv.AlignmentType.RIGHT,u.right=this._toDoc(s)):(d=dv.AlignmentType.LEFT,u.left=this._toDoc(t))}else{const t=e.getTop(r),s=e.getBottom(r);(isNaN(t)||isNaN(s))&&isNaN(t)?isNaN(s)||(u.bottom=this._toDoc(s),c=dv.VerticalAlign.BOTTOM):(c=dv.VerticalAlign.TOP,u.top=this._toDoc(t))}}let p=!0;for(let t of h)if(!(t instanceof dv.Run)){p=!1;break}p&&(h=[new dv.Paragraph({children:h,alignment:d,spacing:{lineRule:dv.LineRuleType.EXACTLY}})]);const _=new dv.TableCell({columnSpan:1,rowSpan:1,children:h,verticalAlign:c,borders:a,margins:u});n.push(_)}return new dv.TableRow({height:{value:this._hRows[e],rule:dv.HeightRule.EXACT},children:n})}}class Lv extends _t{get picker(){return this.container}}class Nv extends Lv{constructor(t){super(t,"rr-color-picker-alpha-slider"),this._color=16777215,this._alpha=1,this._addChild(this._selector=new Hv(t)),this._changed()}get selector(){return this._selector}get color(){return this._color}set color(t){t!=this._color&&(this._color=t,this._changed())}get alpha(){return this._alpha}set alpha(t){t!=this._alpha&&(this._alpha=t,this.picker&&this.picker.refresh())}moveSelector(t){const e=this.height;this.alpha=(e-t)/e,t=100*(1-this.alpha),this.selector.setYP(t),this.picker&&this.picker.refresh()}moveByAlpha(t){this.alpha=t,this.selector.setYP(100*(1-this.alpha))}_changed(){const t=this._color;let e="linear-gradient(";e+=Ve.toHex(t)+","+Ve.toRgba(t,0)+")",e+=",",e+='url("'+Nv.BACKGROUND+'")',this.setStyles({backgroundImage:e}),this._selector.setStyles({top:Math.round(100*(1-this._alpha))+"%"})}}Nv.BACKGROUND="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgray'/%3E%3C/svg%3E";class Hv extends _t{constructor(t){super(t,"rr-color-picker-alpha-selector")}}class Qv extends yt{constructor(t){super(t),this._context=new $i}_doDispose(){super._doDispose()}_doPrepareContainer(t){super._doPrepareContainer(t),t.classList.add(Qv.CLASS_NAME),t.classList.add("rr-report-root")}_doLayout(t){}}Qv.CLASS_NAME="rr-report-container";class Uv extends class{constructor(t,e){this._started=J.getTimeF(),this._target=t,this._duration=e,this._doStart(this._target)}get target(){return this._target}run(t){const e=t-this._started;return e<=this._duration?(this._doRun(this._target,this._duration,e),!0):(this._doEnd(this._target),!1)}execute(){this.run(this._started)}_doStart(t){}_doEnd(t){}}{_doStart(t){t.style.display="inline-block"}_doRun(t,e,s){}_doEnd(t){t.style.display="none"}}class Mv extends tt{constructor(t){super(t,"feedbackLayer"),this._childMap={},this._actions=[],setInterval((()=>{this.update()}),300)}update(){const t=J.getTimeF();for(let e=this._actions.length-1;e>=0;e--)this._actions[e].run(t)||this._actions.splice(e,1)}addSpan(t,e,s,i){if(this._childMap[e])throw new Error("Already exists: "+e);const r=t.createElement("span"),n=r.style;if(n.position="absolute",n.display="none","string"==typeof s)r.className=s;else if(s)for(let t in s)n[t]=s[t];return i&&(r.textContent=i),this._dom.appendChild(r),this._childMap[e]=r,r}clearAction(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=this._childMap[t];if(s){const t=J.getTimeF();for(let i=this._actions.length-1;i>=0;i--)this._actions[i].target===s&&(e&&this._actions[i].run(t),this._actions.splice(i,1))}}showSpan(t,e,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3;const n=this._childMap[t];if(n){const t=n.style;t.left=s+"px",t.top=i+"px",n.textContent=e||"",this.$_addAction(new Uv(n,r))}}_initDom(t,e){super._initDom(t,e),e.style.pointerEvents="none"}$_addAction(t){t&&this._actions.indexOf(t)<0&&(this._actions.push(t),t.execute())}}class kv extends q{constructor(t){super(t,"editMarquee")}get target(){return this._target}set target(t){t!==this._target&&(this._target=t,this.invalidate())}get targetItem(){if(this._target instanceof Mi)return this._target.model}layout(t){const e=t.getItemBoundingRect(this._target);this._doLayout(this.doc,this.dom,e)}_getCssSelector(){return"rr-edit-marquee"}get findable(){return!1}_initDom(t,e){super._initDom(t,e),e.style.zIndex=kv.MARQUEE_ZINDEX}_doDraw(t){}_selectItem(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];delete t.dataset.cellselect,delete t.dataset.select,delete t.dataset.focus,s?t.dataset.focus="":e&&(t.dataset.select="")}_selectCell(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];delete t.dataset.select,delete t.dataset.focus,e?t.dataset.cellselect="":delete t.dataset.cellselect}_isColSelected(t,e,s){const i=e.rowCount;let r=!1;return t.selections.forEach(((t,e)=>{if(t instanceof Rr)for(let e=0;e<i;e++)if(t.contains(e,s))return r=!0,!0})),r}_isRowSelected(t,e,s){const i=e.colCount;let r=!1;return t.selections.forEach(((t,e)=>{if(t instanceof Rr)for(let e=0;e<i;e++)if(t.contains(s,e))return r=!0,!0})),r}}kv.MARQUEE_ZINDEX="20",kv.ITEM_CLASS="rr-edit-marquee-item",kv.TRACKER_STYLE="rr-edit-marquee-tracker";const Vv=2e3,Gv=3e3;class Kv extends kv{constructor(t){super(t),this._leftItems=[],this._rightItems=[],this._topItems=[],this._bottomItems=[],this._leftTrackers=[],this._rightTrackers=[],this._topTrackers=[],this._bottomTrackers=[],this._sectionFocus=-1,this._colFocus=-1,this._rowFocus=-1}static $_isBand(t){return t.parentElement.classList.contains(Kv.STYLE_NAME)}static getTarget(t,e){if(t instanceof tn&&this.$_isBand(e)){let s=e.dataset.target;if(s)if(s.startsWith("r")){const i=parseInt(s.substr(1)),r=parseInt(e.dataset.section);let n;switch(r){case 0:n=t.header.rows;break;case 1:n=t.dataRow.rows;break;case 2:n=t.footer.rows;break;default:if(r>=Gv){const e=r-Gv;n=t.groups.get(e).footer.rows}else if(r>=Vv){const e=r-Vv;n=t.groups.get(e).header.rows}}n?(t=n.get(i),s=s.substr(1)):s=""}else if(s.startsWith("c")){const e=s.substr(1);e&&(s=e,t=t.columns.get(parseInt(e)))}return s?{target:t,tag:s}:null}}static isColSizeTracker(t){return t instanceof HTMLElement&&t.classList.contains(kv.TRACKER_STYLE)&&this.$_isBand(t)&&"ew-resize"===t.style.cursor?t.$_idx:-1}static isRowSizeTracker(t){if(t instanceof HTMLElement&&t.classList.contains(kv.TRACKER_STYLE)&&this.$_isBand(t)&&"ns-resize"===t.style.cursor){return{table:this.$_getTable(t),row:t.$_idx}}}static $_getTable(t){const e=t&&t.$_grp;return e instanceof Or?e:e instanceof Ir||e instanceof xr?e.table:e.model}$_createResizeFeedback(){return this._sizeFeedback||(this._sizeFeedback=this.doc.createElement("div"),J.extend(this._sizeFeedback.style,{position:"absolute",boxSizing:"border-box",borderColor:"#000088aa",borderStyle:"none"}),this._sizeValueFeedback=this.doc.createElement("div"),this._sizeValueFeedback.className="rr-table-size-value-feedback",J.extend(this._sizeValueFeedback.style,{position:"absolute",backgroundColor:"#11c",color:"white",borderRadius:"3px",padding:"3px 5px",textAlign:"center",minWidth:"32px"})),this._sizeFeedback}showColSizeFeedback(t,e,s){let i=this.$_createResizeFeedback();const r=this.height-2*Kv.H_ITEM;J.extend(i.style,{top:Kv.H_ITEM+"px",left:e+"px",width:"1px",height:r+"px",borderBottomStyle:"none",borderRightWidth:"2px",borderRightStyle:"dotted"}),this.dom.appendChild(i),i=this._sizeValueFeedback,i.textContent=s,J.extend(i.style,{left:e-i.offsetWidth+"px",top:-i.offsetHeight+"px"}),this.dom.appendChild(i)}showRowSizeFeedback(t,e,s,i){let r=this.$_createResizeFeedback();const n=this.width-2*Kv.W_ITEM;J.extend(r.style,{left:Kv.W_ITEM+"px",top:s+"px",height:"1px",width:n+"px",borderRightStyle:"none",borderBottomWidth:"2px",borderBottomStyle:"dashed"}),this.dom.appendChild(r),r=this._sizeValueFeedback,r.textContent=i,J.extend(r.style,{left:17-r.offsetWidth+"px",top:s-r.offsetHeight+"px"}),this.dom.appendChild(r)}hideSizeFeedbacks(){J.remove(this._sizeFeedback),J.remove(this._sizeValueFeedback)}_getCssSelector(){return super._getCssSelector()+" "+Kv.STYLE_NAME}_doLayout(t,e,s){function i(t,e){for(let s of n._tables)if(t._isColSelected(o,s,e))return!0;return!1}const r=this.target,n=r.model,o=r.container;let a=o.focusedItem;const A=Kv.W_ITEM,l=Kv.H_ITEM,h=s.x-A,d=s.y-l,c=s.width+2*A,u=s.height+2*l;let p,_,g,f,m=!1;if(this._rowFocus=this._colFocus=this._sectionFocus=-1,a instanceof Ir?(this._rowFocus=a.row,this._colFocus=a.col,p=a.table,m=!0):a instanceof xr&&(this._rowFocus=a.index,p=a.table),a instanceof Mr?this._colFocus=a.index:p&&(this._sectionFocus=function(t){return t instanceof Kr?0:t instanceof Xr?1:t instanceof Wr?2:t instanceof Zr?r.indexOfGroup(t)+1e3:t instanceof Yr?r.indexOfGroup(t.group)+Vv:t instanceof Jr?r.indexOfGroup(t.group)+Gv:void 0}(p)),f=function(t){let e,s=0;switch(t){case 0:e=r.headerView;break;case 1:e=r.dataRowView;break;case 2:e=r.footerView;break;default:if(t>=Gv){const i=r.getGroupView(t%Gv);s=i.y,e=i.footer}else if(t>=Vv){const i=r.getGroupView(t%Vv);s=i.y,e=i.header}}if(e){const t=e.y+s,i=e.getRowPoints();for(let e=0;e<i.length;e++)i[e]+=t;return i}}(this._sectionFocus),f){_=this.$_getItems(t,e,this._leftItems,f.length-1);for(let t=0;t<Math.min(_.length,f.length-1);t++){const e=_[t];if(e.dataset.target="r"+t,e.dataset.section=this._sectionFocus+"",m)this._selectCell(e,this._rowFocus===t||this._isRowSelected(o,p,t));else if(this._rowFocus===t)this._selectItem(e,!0,o.selectionCount>1);else{const s=p&&o.isSelected(p.getRow(t));this._selectItem(e,s,!1)}e.textContent="r-"+t,e.title="row "+t,J.setBounds(e,0,f[t]+l+2,A,f[t+1]-f[t])}g=this.$_getTrackers(t,e,this._leftTrackers,f.length-2);for(let t=0;t<f.length-2;t++){const e=g[t];e.$_idx=t,e.$_grp=a,e.style.cursor="ns-resize",J.setBounds(e,0,f[t+1]+l+2,A,3)}_=this.$_getItems(t,e,this._rightItems,f.length-1);for(let t=0;t<Math.min(_.length,f.length-1);t++){const e=_[t];if(e.dataset.target="r"+t,e.dataset.section=this._sectionFocus+"",m)this._selectCell(e,this._rowFocus===t||this._isRowSelected(o,p,t));else if(this._rowFocus===t)this._selectItem(e,!0,o.selectionCount>1);else{const s=p&&o.isSelected(p.getRow(t));this._selectItem(e,s,!1)}e.textContent="r-"+t,e.title="row "+t,J.setBounds(e,A+s.width,f[t]+l+2,A,f[t+1]-f[t])}g=this.$_getTrackers(t,e,this._rightTrackers,f.length-2);for(let t=0;t<f.length-2;t++){const e=g[t];e.$_idx=t,e.$_grp=a,e.style.cursor="ns-resize",J.setBounds(e,A+s.width,f[t+1]+l+2,A,3)}}else this.$_getItems(t,e,this._leftItems,0),this.$_getItems(t,e,this._rightItems,0);f=r.getColPoints(),_=this.$_getItems(t,e,this._topItems,f.length-1);for(let t=0;t<Math.min(_.length,f.length-1);t++){const e=_[t];if(e.dataset.target="c"+t,m)this._selectCell(e,this._colFocus===t||i(this,t));else if(this._colFocus===t)this._selectItem(e,!0,o.selectionCount>1);else{const s=o.isSelected(n.getColumn(t));this._selectItem(e,s,!1)}e.textContent="c-"+t,e.title="column "+t,J.setBounds(e,A+f[t]+2,0,f[t+1]-f[t],l)}g=this.$_getTrackers(t,e,this._topTrackers,f.length-2);for(let t=0;t<f.length-2;t++){const e=g[t];e.$_idx=t,e.$_grp=this.target,e.style.cursor="ew-resize",J.setBounds(e,A+f[t+1]+2-1,0,3,l)}_=this.$_getItems(t,e,this._bottomItems,f.length-1);for(let t=0;t<Math.min(_.length,f.length-1);t++){const e=_[t];if(e.dataset.target="c"+t,m)this._selectCell(e,this._colFocus===t||i(this,t));else if(this._colFocus===t)this._selectItem(e,!0,o.selectionCount>1);else{const s=o.isSelected(n.getColumn(t));this._selectItem(e,s,!1)}e.textContent="c-"+t,e.title="column "+t,J.setBounds(e,A+f[t]+2,l+s.height,f[t+1]-f[t],l)}g=this.$_getTrackers(t,e,this._bottomTrackers,f.length-2);for(let t=0;t<f.length-2;t++){const e=g[t];e.$_idx=t,e.$_grp=this.target,e.style.cursor="ew-resize",J.setBounds(e,A+f[t+1]+2-1,l+s.height,3,l)}this.setBounds(h,d,c,u).applyBounds()}$_getDivs(t,e,s,i,r){for(;s.length<i;){const i=t.createElement("div");i.className=r,e.appendChild(i),s.push(i)}for(let t=s.length-1;t>=0;t--)s[t].style.display=t>=i?"none":"",s[t].$_grp=null;return s}$_getItems(t,e,s,i){return this.$_getDivs(t,e,s,i,kv.ITEM_CLASS)}$_getTrackers(t,e,s,i){return this.$_getDivs(t,e,s,i,kv.TRACKER_STYLE)}}Kv.STYLE_NAME="rr-tableband-marquee",Kv.W_ITEM=50,Kv.H_ITEM=17;class Wv extends kv{constructor(t){super(t),this._leftItems=[],this._rightItems=[],this._topItems=[],this._bottomItems=[],this._leftTrackers=[],this._rightTrackers=[],this._topTrackers=[],this._bottomTrackers=[],this._colFocus=-1,this._rowFocus=-1,this._topDivs=[]}static $_isContainer(t){return t.parentElement.classList.contains(Wv.STYLE_NAME)}static getTarget(t,e){if(t instanceof ln&&this.$_isContainer(e)){let s=e.dataset.target;if(s){if(s.startsWith("r")){const e=s.substr(1);return s=e,{target:t.rows.get(parseInt(e)),tag:s}}if(s.startsWith("c")){const e=s.substr(1);return s=e,{target:t.columns.get(parseInt(e)),tag:s}}}return s?{target:t,tag:s}:null}}static isColSizeTracker(t){return t instanceof HTMLElement&&t.classList.contains(kv.TRACKER_STYLE)&&this.$_isContainer(t)&&"ew-resize"===t.style.cursor?t.$_idx:-1}static isRowSizeTracker(t){return t instanceof HTMLElement&&t.classList.contains(kv.TRACKER_STYLE)&&this.$_isContainer(t)&&"ns-resize"===t.style.cursor?t.$_idx:-1}$_createResizeFeedback(){return this._sizeFeedback||(this._sizeFeedback=this.doc.createElement("div"),this._sizeFeedback.className="rr-table-size-feedback",J.extend(this._sizeFeedback.style,{position:"absolute",boxSizing:"border-box",borderColor:"#000088aa",borderStyle:"none"}),this._sizeValueFeedback=this.doc.createElement("div"),this._sizeValueFeedback.className="rr-table-size-value-feedback",J.extend(this._sizeValueFeedback.style,{position:"absolute",backgroundColor:"#11c",color:"white",borderRadius:"3px",padding:"3px 5px",textAlign:"center",minWidth:"32px"})),this._sizeFeedback}showColSizeFeedback(t,e,s){let i=this.$_createResizeFeedback();const r=this.height-2*Wv.H_ITEM;J.extend(i.style,{top:Wv.H_ITEM+"px",left:e+"px",width:"1px",height:r+"px",borderBottomStyle:"none",borderRightWidth:"2px",borderRightStyle:"dotted"}),this.dom.appendChild(i),i=this._sizeValueFeedback,i.textContent=s,J.extend(i.style,{left:e-i.offsetWidth+"px",top:-i.offsetHeight+"px"}),this.dom.appendChild(i)}showRowSizeFeedback(t,e,s,i){let r=this.$_createResizeFeedback();const n=this.width-2*Wv.W_ITEM;J.extend(r.style,{left:Wv.W_ITEM+"px",top:s+"px",height:"1px",width:n+"px",borderRightStyle:"none",borderBottomWidth:"2px",borderBottomStyle:"dashed"}),this.dom.appendChild(r),r=this._sizeValueFeedback,r.textContent=i,J.extend(r.style,{left:17-r.offsetWidth+"px",top:s-r.offsetHeight+"px"}),this.dom.appendChild(r)}hideSizeFeedbacks(){J.remove(this._sizeFeedback),J.remove(this._sizeValueFeedback)}_getCssSelector(){return super._getCssSelector()+" "+Wv.STYLE_NAME}_initDom(t,e){super._initDom(t,e);const s=this._tableItem=t.createElement("div");s.className=kv.ITEM_CLASS,s.dataset.target="t",s.style.cursor="pointer",s.textContent="table",s.title="Table",e.appendChild(s)}_doLayout(t,e,s){const i=this.target,r=i.model,n=i.container,o=n.focusedItem,a=Wv.W_ITEM,A=Wv.H_ITEM,l=s.x-a,h=s.y-A,d=s.width+2*a,c=s.height+2*A;let u,p,_,g=!1;this._colFocus=this._rowFocus=-1,o instanceof on?this._colFocus=o.index:o instanceof xr?this._rowFocus=o.index:o instanceof Ir&&(this._colFocus=o.col,this._rowFocus=o.row,g=!0);let f=this._tableItem;this._selectItem(f,o===r),J.setBounds(f,0,0,a-1,A),_=i.getRowPoints(),u=this.$_getItems(t,e,this._leftItems,i.rowCount);for(let t=0;t<_.length-1;t++){if(f=u[t],f.dataset.target="r"+t,g)this._selectCell(f,this._rowFocus===t||this._isRowSelected(n,r,t));else if(this._rowFocus===t)this._selectItem(f,!0,n.selectionCount>1);else{const e=n.isSelected(r.getRow(t));this._selectItem(f,e,!1)}f.textContent="r-"+t,f.title="row "+t,J.setBounds(f,0,_[t]+A+2,a,_[t+1]-_[t])}p=this.$_getTrackers(t,e,this._leftTrackers,_.length-2);for(let t=0;t<_.length-2;t++)f=p[t],f.$_idx=t,f.$_grp=this.target,f.style.cursor="ns-resize",J.setBounds(f,0,_[t+1]+A+2,a,3);u=this.$_getItems(t,e,this._rightItems,i.rowCount);for(let t=0;t<_.length-1;t++){if(f=u[t],f.dataset.target="r"+t,g)this._selectCell(f,this._rowFocus===t||this._isRowSelected(n,r,t));else if(this._rowFocus===t)this._selectItem(f,!0,n.selectionCount>1);else{const e=n.isSelected(r.getRow(t));this._selectItem(f,e,!1)}f.textContent="r-"+t,f.title="row "+t,J.setBounds(f,a+s.width,_[t]+A+2,a,_[t+1]-_[t])}p=this.$_getTrackers(t,e,this._rightTrackers,_.length-2);for(let t=0;t<_.length-2;t++)f=p[t],f.$_idx=t,f.$_grp=this.target,f.style.cursor="ns-resize",J.setBounds(f,a+s.width,_[t+1]+A+2,a,3);_=i.getColPoints(),u=this.$_getItems(t,e,this._topItems,_.length-1);for(let t=0;t<_.length-1;t++){if(f=u[t],f.dataset.target="c"+t,g)this._selectCell(f,this._colFocus===t||this._isColSelected(n,r,t));else if(this._colFocus===t)this._selectItem(f,!0,n.selectionCount>1);else{const e=n.isSelected(r.getColumn(t));this._selectItem(f,e,!1)}f.textContent="c-"+t,f.title="column "+t,J.setBounds(f,a+_[t]+2,0,_[t+1]-_[t],A)}p=this.$_getTrackers(t,e,this._topTrackers,_.length-2);for(let t=0;t<_.length-2;t++)f=p[t],f.$_idx=t,f.$_grp=this.target,f.style.cursor="ew-resize",J.setBounds(f,a+_[t+1]+2-1,0,3,A);u=this.$_getItems(t,e,this._bottomItems,_.length-1);for(let t=0;t<_.length-1;t++){if(f=u[t],f.dataset.target="c"+t,g)this._selectCell(f,this._colFocus===t||this._isColSelected(n,r,t));else if(this._colFocus===t)this._selectItem(f,!0,n.selectionCount>1);else{const e=n.isSelected(r.getColumn(t));this._selectItem(f,e,!1)}f.textContent="c-"+t,f.title="column "+t,J.setBounds(f,a+_[t]+2,A+s.height+2,_[t+1]-_[t],A)}p=this.$_getTrackers(t,e,this._bottomTrackers,_.length-2);for(let t=0;t<_.length-2;t++)f=p[t],f.$_idx=t,f.$_grp=this.target,f.style.cursor="ew-resize",J.setBounds(f,a+_[t+1]+2-1,A+s.height,3,A);this.setBounds(l,h,d,c).applyBounds()}$_getDivs(t,e,s,i,r){for(;s.length<i;){const i=t.createElement("div");i.className=r,e.appendChild(i),s.push(i)}for(let t=s.length-1;t>=0;t--)s[t].style.display=t>=i?"none":"",s[t].$_grp=null;return s}$_getItems(t,e,s,i){return this.$_getDivs(t,e,s,i,kv.ITEM_CLASS)}$_getTrackers(t,e,s,i){return this.$_getDivs(t,e,s,i,kv.TRACKER_STYLE)}}Wv.STYLE_NAME="rr-table-container-marquee",Wv.W_ITEM=50,Wv.H_ITEM=17;class zv extends kv{constructor(t){super(t),this._leftItems=[],this._rightItems=[]}static getTarget(t,e){if(e.parentElement.classList.contains(zv.STYLE_NAME)){let s=e.dataset.target;if(s.startsWith("c-")){const t=s.substr(2);t&&(s=t)}return s?{target:t,tag:s}:null}}_getCssSelector(){return super._getCssSelector()+" "+zv.STYLE_NAME}_initDom(t,e){super._initDom(t,e)}_doLayout(t,e,s){const i=this.target,r=s.x-50,n=s.y,o=s.width+100,a=s.height;let A,l,h;l=i.getRowPoints(),h=h=l.length/2,A=this.$_getItems(t,e,this._leftItems,h);for(let t=0;t<h;t++){const e=A[t];e.dataset.target="r"+t,e.textContent="r-"+t,e.title="row "+t,J.setBounds(e,0,l[2*t],50,l[2*t+1]-l[2*t])}A=this.$_getItems(t,e,this._rightItems,h);for(let t=0;t<h;t++){const e=A[t];e.dataset.target="r"+t,e.textContent="r-"+t,e.title="row "+t,J.setBounds(e,50+s.width,l[2*t],50,l[2*t+1]-l[2*t])}this.setBounds(r,n,o,a).applyBounds()}$_getItems(t,e,s,i){for(;s.length<i;){const i=t.createElement("div");i.className="rr-edit-marquee-item",e.appendChild(i),s.push(i)}for(let t=s.length-1;t>=0;t--)s[t].style.display=t>=i?"none":"";return s}}zv.STYLE_NAME="rr-column-box-marquee";class $v extends kv{constructor(t){super(t),this._topItems=[],this._bottomItems=[]}static getTarget(t,e){if(e.parentElement.classList.contains($v.STYLE_NAME)){let s=e.dataset.target;if(s.startsWith("r-")){const t=s.substr(2);t&&(s=t)}return s?{target:t,tag:s}:null}}_getCssSelector(){return super._getCssSelector()+" "+$v.STYLE_NAME}_initDom(t,e){super._initDom(t,e)}_doLayout(t,e,s){const i=this.target,r=s.x,n=s.y-32,o=s.width,a=s.height+64;let A,l,h;l=i.getColPoints(),h=h=l.length/2,A=this.$_getItems(t,e,this._topItems,h);for(let t=0;t<h;t++){const e=A[t];e.dataset.target="c"+t,e.textContent="c-"+t,e.title="col "+t,J.setBounds(e,l[2*t],0,l[2*t+1]-l[2*t],32)}A=this.$_getItems(t,e,this._bottomItems,h);for(let t=0;t<h;t++){const e=A[t];e.dataset.target="c"+t,e.textContent="c-"+t,e.title="col "+t,J.setBounds(e,l[2*t],32+s.height,l[2*t+1]-l[2*t],32)}this.setBounds(r,n,o,a).applyBounds()}$_getItems(t,e,s,i){for(;s.length<i;){const i=t.createElement("div");i.className="rr-edit-marquee-item",e.appendChild(i),s.push(i)}for(let t=s.length-1;t>=0;t--)s[t].style.display=t>=i?"none":"";return s}}$v.STYLE_NAME="rr-row-box-marquee";class Xv extends kv{constructor(t){super(t),this._seriesItems=[]}static getTarget(t,e){if(t instanceof Nn&&e.parentElement.classList.contains(Xv.STYLE_NAME)){let s=e.dataset.target;switch(s){case"xaxis":t=t.xAxis;break;case"yaxis":t=t.yAxis;break;default:s.startsWith("series")&&(t=t.series.get(parseInt(s.substr(6))))}return s?{target:t,tag:s}:null}}get chart(){return this.target.model}getSeriesMarqueeAt(t){for(let e of this._seriesItems){const s=e.offsetLeft,i=e.offsetWidth;if(t>=s&&t<s+i)return e}}getSeriesIndex(t){const e=t.dataset.target;if(e.startsWith("series"))return parseInt(e.substring(6))}isSeries(t){if(t instanceof HTMLDivElement&&this._seriesItems.indexOf(t)>=0)return t}_getCssSelector(){return super._getCssSelector()+" "+Xv.STYLE_NAME}_initDom(t,e){super._initDom(t,e);let s=this._chartItem=t.createElement("div");s.className=kv.ITEM_CLASS,s.dataset.target="chart",s.textContent="highchart",e.appendChild(s),s=this._xAxisItem=t.createElement("div"),s.className=kv.ITEM_CLASS,s.dataset.target="xaxis",s.textContent="x axis",e.appendChild(s),s=this._yAxisItem=t.createElement("div"),s.className=kv.ITEM_CLASS,s.dataset.target="yaxis",s.style.transform="rotate(90deg)",s.textContent="y axis",e.appendChild(s)}_doLayout(t,e,s){const i=this.target,r=i.model,n=i.container.focusedItem,o=s.x,a=s.y,A=s.width,l=s.height,h=17;let d,c;this.$_prepareSeries(i,t,e),d=this._chartItem,c=64,this._selectItem(d,n===r),J.setBounds(d,0,-19,c,h);let u=c+4;this._seriesItems.forEach(((t,e)=>{J.setBounds(t,u,-19,55,h),this._selectItem(t,n===r.series.get(e)),u+=59})),r.inverted?(d=this._yAxisItem,d.style.transform="",c=50,J.setBounds(d,(A-c)/2,l+2+2,c,h),this._selectItem(d,n===r.yAxis),d=this._xAxisItem,d.style.transform="rotate(90deg)",c=50,this._selectItem(d,n===r.xAxis),J.setBounds(d,-c-2+h,(l-h)/2,c,h)):(d=this._xAxisItem,d.style.transform="",c=50,this._selectItem(d,n===r.xAxis),J.setBounds(d,(A-c)/2,l+2+2,c,h),d=this._yAxisItem,d.style.transform="rotate(90deg)",c=50,this._selectItem(d,n===r.yAxis),J.setBounds(d,-c-2+h,(l-h)/2,c,h)),this.setBounds(o,a,A,l).applyBounds()}$_prepareSeries(t,e,s){const i=t.model.series,r=i.count;for(;this._seriesItems.length<r;){const t=e.createElement("div");t.className=kv.ITEM_CLASS,s.appendChild(t),this._seriesItems.push(t)}for(;this._seriesItems.length>r;)J.remove(this._seriesItems.pop());this._seriesItems.forEach(((t,e)=>{const s=i.get(e).name;t.dataset.target="series"+e,t.textContent=s||"series "+(e+1)}))}}Xv.STYLE_NAME="rr-hichart-marquee";class jv extends kv{constructor(t){super(t),this._topItems=[],this._bottomItems=[],this._topTrackers=[],this._bottomTrackers=[],this._cellFocus=-1,this._topDivs=[]}static $_isContainer(t){return t.parentElement.classList.contains(jv.STYLE_NAME)}static getTarget(t,e){if(t instanceof Qa&&this.$_isContainer(e)){let s=e.dataset.target;if(s.startsWith("c")){const e=s.substring(1);return s=e,{target:t.get(+e),tag:s}}return s?{target:t,tag:s}:null}}_getCssSelector(){return super._getCssSelector()+" "+jv.STYLE_NAME}_initDom(t,e){super._initDom(t,e);const s=this._tableItem=t.createElement("div");s.className=kv.ITEM_CLASS,s.dataset.target="g",s.style.cursor="pointer",s.style.border="1px solid black",s.textContent="BAND GROUP",s.title="Band Group",e.appendChild(s)}_doLayout(t,e,s){const i=this.target,r=i.model,n=i.container.focusedItem,o=jv.W_ITEM,a=jv.H_ITEM,A=s.x,l=s.y-a,h=s.width,d=s.height+a;let c,u,p=this._tableItem;this._selectItem(p,n===r),J.setBounds(p,2,1.2*-a,1.5*o,1.2*a),u=i.getCellPoints(),c=this.$_getItems(t,e,this._topItems,u.length-1);for(let t=0;t<u.length-1;t++)p=c[t],p.dataset.target="c"+t,this._selectItem(p,n===r.get(t),!1),p.textContent="bandcell-"+t,p.title="cell "+t,J.setBounds(p,u[t],0,u[t+1]-u[t],a);c=this.$_getItems(t,e,this._bottomItems,u.length-1);for(let t=0;t<u.length-1;t++)p=c[t],p.dataset.target="c"+t,this._selectItem(p,n===r.get(t),!1),p.textContent="bandcell-"+t,p.title="cell "+t,J.setBounds(p,u[t],a+s.height+2,u[t+1]-u[t],a);this.setBounds(A,l,h,d).applyBounds()}$_getDivs(t,e,s,i,r){for(;s.length<i;){const i=t.createElement("div");i.className=r,e.appendChild(i),s.push(i)}for(let t=s.length-1;t>=0;t--)s[t].style.display=t>=i?"none":"",s[t].$_grp=null;return s}$_getItems(t,e,s,i){return this.$_getDivs(t,e,s,i,kv.ITEM_CLASS)}$_getTrackers(t,e,s,i){return this.$_getDivs(t,e,s,i,kv.TRACKER_STYLE)}}jv.STYLE_NAME="rr-bandgroup-marquee",jv.W_ITEM=50,jv.H_ITEM=17;class Yv extends q{constructor(t){super(t,"selectView")}layout(t,e){this.dom.dataset.cell=e instanceof Rr&&!e.isSingle(!1)?"1":"0",this.setRect(t).draw(),this.setRotation(e instanceof Ri?e.rotation:0)}_getCssSelector(){return Yv.STYLE}get isLayer(){return!0}_initDom(t,e){super._initDom(t,e),e.style.zIndex=iB.SELECT_ZINDEX}}Yv.STYLE="rr-select-view";class Jv extends Yv{_getCssSelector(){return Jv.STYLE}layout(t,e){this.setRect(t).draw()}}Jv.STYLE="rr-table-select-view";class Zv extends q{constructor(t,e){super(t,"focusHandle"),this._enabled=!0,this.dir=e,this.resize(9,9)}get dir(){return this._dir}set dir(t){t!==this._dir&&(this._dir=t,this.invalidate())}get enabled(){return this._enabled}get vertical(){return this._dir===E.TOP||this._dir===E.BOTTOM||this._dir===E.TOP_LEFT||this._dir===E.BOTTOM_RIGHT||this._dir===E.TOP_RIGHT||this._dir===E.BOTTOM_LEFT}get horizontal(){return this._dir===E.LEFT||this._dir===E.RIGHT||this._dir===E.TOP_LEFT||this._dir===E.BOTTOM_RIGHT||this._dir===E.TOP_RIGHT||this._dir===E.BOTTOM_LEFT}_getCssSelector(){return"rr-focus-handle"}_initDom(t,e){super._initDom(t,e)}_doDraw(t){var e;const s=this.dir,i=this.itemView;i?(t.dataset.hidden="",this._enabled=i.model.canResize(s)&&(null===(e=i.model.parent)||void 0===e?void 0:e.canResizeChild(i.model,s)),t.dataset.disabled=String(!this.enabled),t.dataset.dir=s==E.LEFT||s==E.RIGHT?"horz":s==E.TOP||s==E.BOTTOM?"vert":s==E.TOP_RIGHT||s==E.BOTTOM_LEFT?"up":s==E.TOP_LEFT||s==E.BOTTOM_RIGHT?"down":""):t.dataset.hidden="true"}}class qv extends q{constructor(){super(...arguments),this._dragging=!1}setTarget(t,e){this._editView=t,this._target=e}_getCssSelector(){return"rr-rotate-handle"}_initDom(t,e){e.style.position="absolute",e.style.display="inline-block",e.style.pointerEvents="all",this.width=this.height=20,e.ondblclick=t=>{this._target.model.rotation=0},e.onpointerdown=t=>{e.setPointerCapture(t.pointerId),this._oldRotation=this._target.model.rotation,this._dragging=!0},e.onpointerup=t=>{this._target.model.report.setItemProperty(this._target.model,"rotation",this._target.rotation),this._dragging=!1,e.releasePointerCapture(t.pointerId)},e.onpointermove=t=>{if(this._dragging){const e=this._target.dom.getBoundingClientRect();e.x+=e.width/2,e.y+=e.height/2;const s=+(180*Math.atan2(t.clientX-e.x,t.clientY-e.y)/Math.PI).toPrecision(15);this._target.setRotation(+((360-s)%360).toFixed(1)),this._editView.editLayer.resetFocusView()}}}}class tB extends q{_getCssSelector(){return"rr-rotate-line"}}class eB extends q{constructor(t,e){super(t,"focusView"),this._simpleMode=!1,this._editView=e,this.addChild(this._rotateLine=new tB(t)),this.addChild(this._topHandle=new Zv(t,E.TOP)),this.addChild(this._bottomHandle=new Zv(t,E.BOTTOM)),this.addChild(this._leftHandle=new Zv(t,E.LEFT)),this.addChild(this._rightHandle=new Zv(t,E.RIGHT)),this.addChild(this._topLeftHandle=new Zv(t,E.TOP_LEFT)),this.addChild(this._topRightHandle=new Zv(t,E.TOP_RIGHT)),this.addChild(this._bottomLeftHandle=new Zv(t,E.BOTTOM_LEFT)),this.addChild(this._bottomRightHandle=new Zv(t,E.BOTTOM_RIGHT)),this.addChild(this._rotateHandle=new qv(t))}get simpleMode(){return this._simpleMode}set simpleMode(t){t!=this._simpleMode&&(this._simpleMode=t,this._topHandle.dir=t?E.TOP_LEFT:E.TOP,this._bottomHandle.dir=t?E.BOTTOM_RIGHT:E.BOTTOM,this._leftHandle.visible=!t,this._rightHandle.visible=!t)}layout(t){if(this._topHandle.itemView=this._bottomHandle.itemView=this._leftHandle.itemView=this._rightHandle.itemView=null,this._topLeftHandle.itemView=this._bottomLeftHandle.itemView=this._topRightHandle.itemView=this._bottomRightHandle.itemView=null,t instanceof Mi){const e=this.width,s=this.height,i=6,r=i/2;this._simpleMode?(this._topHandle.itemView=this._bottomHandle.itemView=t,this._topHandle.move(-r,-r,!0),this._bottomHandle.move(e-i,s-i,!0)):(this._topHandle.itemView=this._bottomHandle.itemView=this._leftHandle.itemView=this._rightHandle.itemView=t,this._topLeftHandle.itemView=this._bottomLeftHandle.itemView=this._topRightHandle.itemView=this._bottomRightHandle.itemView=t,this._topHandle.move((e-i-r)/2,-i,!0),this._bottomHandle.move((e-i-r)/2,s-r,!0),this._leftHandle.move(-i,(s-i-r)/2,!0),this._rightHandle.move(e-r,(s-i-r)/2,!0),this._topLeftHandle.move(-i,-i,!0),this._topRightHandle.move(e-r,-i,!0),this._bottomLeftHandle.move(-i,s-r,!0),this._bottomRightHandle.move(e-r,s-r,!0)),(this._rotateHandle.visible=t.model.canRotate())&&(this._rotateHandle.setTarget(this._editView,t),this._rotateHandle.move((e-this._rotateHandle.width)/2,s+this._rotateHandle.width,!0)),(this._rotateLine.visible=this._rotateHandle.visible)&&(this._rotateLine.width=1,this._rotateLine.height=this._rotateHandle.width,this._rotateLine.move(e/2,s)),this.setRotation(t.rotation)}else this._rotateHandle.visible=this._rotateLine.visible=!1,this.setRotation(0)}_getCssSelector(){return eB.STYLE}get isLayer(){return!0}_initDom(t,e){super._initDom(t,e),e.style.zIndex=iB.FOCUS_ZINDEX}}eB.STYLE="rr-focus-view";class sB extends _t{constructor(t){super(t,"rr-error-view")}setError(t){this.setText(t)}_prepareDom(t,e){J.extend(e.style,{position:"absolute"})}}class iB extends tt{constructor(t,e){super(t,"reportEditLayer"),this._selectPool=[],this._selectViews=[],this._tableSelectPool=[],this._tableSelectViews=[],this._marquees={TableBand:null,TableContainer:null,BandGroup:null,ColumnBoxContainer:null,RowBoxContainer:null,ChartItem:null,HichartItem:null},this._reportView=e,this.addChild(this._focusView=new eB(t,e))}_doDispose(){super._doDispose()}get editMarquee(){return this._editMarquee}layoutContent(){const t=this._reportView;this.$_layoutFocus(t),this.$_layoutSelection(t),this.$_layoutTableSelection(t),this.$_layoutMarquee(t)}closeEditMarquees(){this._editMarquee&&(this._editMarquee.visible=!1,this._editMarquee=null)}showFocus(){this._focusView.visible=!0}hideFocus(){this._focusView.visible=!1}showError(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;const i=this._reportView.getElementOf(t);if(!i)return!1;this.hideError();const r=this.container.getDomPosition(i);let n=r.x,o=r.y;const a=this.width,A=this.height;this._errorView||(this._errorView=new sB(this.doc)),this._errorView.dom.classList.remove("rr-error-view-hide"),this._errorView.setError(e),this.container.addFeedback(this._errorView);const l=this._errorView.getBounds();return n=Math.max(0,n+(a-l.width)/2),l.height<=o?o-=l.height:o=Math.max(A-l.height,o+l.height+2),this._errorView.move(n,o),this._errorView.dom.classList.remove("rp-error-view-hide"),this._errorTimer=setTimeout((()=>{this.hideError()}),1e3*s),!0}hideError(){this._hideErrorTimer&&(clearTimeout(this._hideErrorTimer),this._hideErrorTimer=null,this.container.removeFeedback(this._errorView)),this._errorTimer&&(clearTimeout(this._errorTimer),this._errorTimer=null,this._errorView.dom.classList.add("rp-error-view-hide"),this._hideErrorTimer=setTimeout((()=>{this.container.removeFeedback(this._errorView)}),500))}itemsRemoved(t){}itemRemoved(t){}resetFocusView(){this.$_layoutFocus(this._reportView)}_getCssSelector(){return"rr-edit-layer"}_isEmptySize(){return!0}_initDom(t,e){super._initDom(t,e)}$_getCellRect(t,e,s,i,r){const n=t.getElementOf(e.table),o=t.getItemBoundingRect(n,r),a=n.getCellBoundingRect(e.col,e.row,s,i);return a.x+=o.x,a.y+=o.y,a}$_getFieldRect(t,e){const s=No.getBandOf(e),i=t.getElementOf(s),r=t.getItemBoundingRect(i),n=i.getFieldBoundingRect(e);return n.x+=r.x,n.y+=r.y,n}$_layoutSelection(t){const e=this.doc,s=this._selectPool,i=this._selectViews,r=t.selection,n=t.focusedItem;let o=r?r.length:0;if(o>0)for(let t of r)t===n?o--:t instanceof Rr?t.equals(n)&&o--:t instanceof Ri||o--;for(;i.length>o;){const t=i.pop();this.removeChild(t),s.push(t)}for(;i.length<o;){const t=s.pop()||new Yv(e);this.addChild(t),i.push(t)}if(o>0){let e=0;for(let s=0,o=r.length;s<o;s++){const o=r[s];if(o instanceof Ri&&o!==n){const s=t.getElementOf(o);if(s){const r=t.getItemBoundingRect(s,0!==o.rotation);i[e++].layout(r,o)}}else if(o instanceof Rr&&n instanceof Ir&&!o.equals(n)){const s=this.$_getCellRect(t,o.cell,o.cols,o.rows,!1);i[e++].layout(s,o)}}}}$_layoutTableSelection(t){var e;const s=this.doc,i=this._tableSelectPool,r=this._tableSelectViews,n=null===(e=t.selection)||void 0===e?void 0:e.filter((t=>t instanceof Fr||t instanceof xr));let o=n?n.length:0;for(;r.length>o;){const t=r.pop();this.removeChild(t),i.push(t)}for(;r.length<o;){const t=i.pop()||new Jv(s);this.addChild(t),r.push(t)}if(o>0){let e=0;for(let s=0,i=n.length;s<i;s++){const i=n[s];let o,a;if(i instanceof on){const e=t.getTableElementOfColumn(i);o=t.getItemBoundingRect(e),a=e.getColRect(i.index,1)}else if(i instanceof Mr){const e=t.getTableBandElementOfColumn(i);o=t.getItemBoundingRect(e),a=e.getColRect(i.index,1)}else if(i instanceof xr){const e=t.getTableElementOfRow(i);o=t.getItemBoundingRect(e),a=e.getRowRect(i.index,1)}a.x+=o.x+2,a.y+=o.y+2,r[e++].layout(a,i)}}}$_layoutFocus(t){const e=this._focusView,s=t.getFocusedElement(),i=t.focusedItem,r=s instanceof Mi&&!isNaN(s.rotation)&&0!==s.rotation;let n;i instanceof Ir?(e.visible=!t.editing)&&(n=this.$_getCellRect(t,i,i.width,i.height,r)):No.isFieldCell(i)?(e.visible=!t.editing)&&(n=this.$_getFieldRect(t,i)):(e.visible=!t.editing&&!!s)&&(n=t.getItemBoundingRect(s,r)),e.visible&&(e.setRect(n),e.layout(s),e.draw())}$_getMarquee(t){const e=t&&t.constructor.$_ctor;let s=this._marquees[e];return!s&&e in this._marquees&&(s=new iB.MarqueeTypes[e](this.doc),this.addChild(s),this._marquees[e]=s),s}$_getMarqueeParent(t){for(;t;){const e=t.marqueeParent;if(e===t)return t;t=e}}$_layoutMarquee(t){const e=t.focusedItem,s=this.$_getMarqueeParent(e),i=this._editMarquee;if(s){const e=t.getElementOf(s);if(e&&!t.pageView.isPageDom(e.dom)){const t=this.$_getMarquee(s);return i&&i.target!==e&&(i.visible=!1),void(t&&(t.target=e,t.visible=!0,t.layout(this._reportView),this._editMarquee=t))}}i&&(i.visible=!1)}}iB.SELECT_ZINDEX="100",iB.FOCUS_ZINDEX="101",iB.MarqueeTypes={TableBand:Kv,TableContainer:Wv,BandGroup:jv,ColumnBoxContainer:zv,RowBoxContainer:$v,HichartItem:Xv};class rB extends br{constructor(t,e){super("Change Itme Parent"),Z(!!t),this._item=t,this._newParent=e,this._oldParent=t.parent}static createCommands(t,e){if(t&&t.length>0){const s=[];return t.forEach(((t,i)=>{s.push(new rB(t,e))})),s.length>0?s:null}}_doDispose(){this._item=this._oldParent=this._newParent=null}redo(t){this._oldParent.remove(this._item),this._newParent.add(this._item)}undo(){this._newParent.remove(this._item),this._oldParent.add(this._item)}get description(){return"Change parent: "+this._item.designText}get source(){return this._item}}class nB extends vr{constructor(t,e){super("Change Items Parent",rB.createCommands(t,e))}}class oB extends st{constructor(t,e){super(t,e),this._editor=t}_doDispose(){this._editor=null,super._doDispose()}get editor(){return this._editor}get selectable(){return!1}handleSelection(){return null}get startWhenCreated(){return!0}}class aB extends oB{constructor(t){super(t,"handModeTracker"),this._saveLeft=0,this._saveTop=0}_doStart(t,e,s,i){const r=this.editor;return this._saveLeft=r.leftPos,this._saveTop=r.topPos,r.setCursor("grabbing"),!0}_doDrag(t,e,s){return this.editor.leftPos=this._saveLeft-(e-this.startX),this.editor.topPos=this._saveTop-(s-this.startY),!0}_doEnded(){this.editor.setCursor("grab")}}class AB extends oB{constructor(t,e){super(t,"itemResizeTracker"),this._isLeft=!1,this._isTop=!1,this._zoom=1,this._handle=e,this._itemView=this._handle.itemView}_doDispose(){super._doDispose()}handleSelection(){const t=this.editor,e=this._itemView.model;return t.clearSelection(),e}_doStart(t,e,s,i){const r=this._itemView,n=r.model,o=this._handle.dir;return this._zoom=this.editor.zoom/100,n instanceof pr?this._saveWidth=this._saveHeight=n.size:(this._saveWidth=n.width,this._saveHeight=n.height),this._oldWidth=r.width,this._oldHeight=r.height,this._isLeft=E.isLeft(o),this._isTop=E.isTop(o),this._saveX=n.left,this._saveY=n.top,this._oldPos=this.editor.getDomPosition(r),this._oldLeft=n.getLeft(Number.MAX_SAFE_INTEGER),this._oldTop=n.getTop(Number.MAX_SAFE_INTEGER),!0}_doDrag(t,e,s){const i=1/this._zoom,r=this.$_getDelta(this._handle.dir),n=this._handle.itemView.model,o=(e-this.startX)*r.dx*i,a=(s-this.startY)*r.dy*i,A=this._isLeft?this._oldLeft-o:NaN,l=this._isTop?this._oldTop-a:NaN,h=Math.max(0,Math.round(this._oldWidth+o)),d=Math.max(0,Math.round(this._oldHeight+a));return this._handle.horizontal&&(n instanceof pr&&n.parent instanceof fr?n.size=h:(isNaN(A)||n.setChildProp("left",A),n.width=h)),this._handle.vertical&&(n instanceof pr&&n.parent instanceof mr?n.size=d:(isNaN(l)||n.setChildProp("top",l),n.height=d)),!0}_doCompleted(){const t=this.editor.report,e=1/this._zoom,s=this._handle.itemView.model,i=this.$_getDelta(this._handle.dir),r=this._handle.horizontal?Math.round((this.currentX-this.startX)*i.dx*e):0,n=this._handle.vertical?Math.round((this.currentY-this.startY)*i.dy*e):0;if(s instanceof pr)s.parent instanceof fr?t.resizeSpace(s,this._saveWidth,this._oldWidth,r):s.parent instanceof mr&&t.resizeSpace(s,this._saveHeight,this._oldHeight,n);else if(this._saveX!==s.left||this._saveY!==s.top){const e=this._isLeft?this._oldLeft-r:this._oldLeft,i=this._isTop?this._oldTop-n:this._oldTop;t.resizeAndMove(s,this._saveWidth,this._saveHeight,this._oldWidth,this._oldHeight,r,n,e,i)}else t.resizeItem(s,this._saveWidth,this._saveHeight,this._oldWidth,this._oldHeight,r,n)}_doCanceled(){this._handle.itemView.model.resize(this._oldWidth,this._oldHeight)}_doEnded(){}$_getDelta(t){let e=0,s=0;switch(t){case E.LEFT:e=-1;break;case E.RIGHT:e=1;break;case E.TOP:s=-1;break;case E.BOTTOM:s=1;break;case E.TOP_LEFT:e=s=-1;break;case E.BOTTOM_RIGHT:e=s=1;break;case E.TOP_RIGHT:e=1,s=-1;break;case E.BOTTOM_LEFT:e=-1,s=1}return{dx:e,dy:s}}}class lB extends _t{constructor(t,e){super(t,"rr-move-feedback")}_prepareDom(t,e){this.setImportantStyle("position","absolute"),e.appendChild(this._span=t.createElement("span"))}setNewPosition(t,e){return delete this._span.dataset.change,this._span.textContent="(left: "+t+", top: "+e+")",this._span.style.display="",this._span.style.left=-(this._span.offsetWidth+1)+"px",this}setNewParent(t){let e=t.model.pathLabel;return t.model.name&&(e=t.model.name+"("+e+")"),this._span.dataset.change="",this._span.textContent="[to "+e+"]",this._span.style.display="",this._span.style.left="",this}hideSpan(){this._span.style.display="none"}}class hB extends _t{constructor(t,e){super(t,e||"rr-move-line-feedback"),this._width="1px"}vline(t,e,s){this.show(),this.clearStyle("border-top-width"),this.setStyle("border-left-width",this._width),this.setBounds(t,Math.min(e,s),2,Math.abs(e-s))}hline(t,e,s){this.show(),this.clearStyle("border-left-width"),this.setStyle("border-top-width",this._width),this.setBounds(Math.min(e,s),t,Math.abs(s-e),2)}}class dB extends _t{constructor(t){super(t,"rr-move-mask-feedback")}}class cB extends hB{constructor(t){super(t,"rr-move-guide-feedback"),this._width="2px"}}class uB extends oB{constructor(t,e,s){if(super(t,"itemMoveTracker"),this._alt=!1,this._dir="",this._guideX=NaN,this._guideY=NaN,this._zoom=1,this._itemView=e,this._moveType=s,this._parentView=e.parent,this._parentView instanceof UA){const t=this._parentView.container;this._siblings=this._parentView.elements.filter((t=>t!==this._itemView&&t instanceof Mi)).map((e=>{const s=t.getDomPosition(e);return d.create(s.x,s.y,e.width,e.height)}))}}_doDispose(){super._doDispose()}get selectable(){return!0}get cursor(){return"move"}handleSelection(){var t;const e=this.editor,s=this._itemView.model;return this._items=[s],this._itemViews=[this._itemView],e.isSelected(s)?null===(t=e.getSelection())||void 0===t||t.forEach((t=>{t instanceof Ri&&t!==s&&t.parent===s.parent?(this._items.push(t),this._itemViews.push(e.reportView.pageView.getElementOf(t))):e.removeSelection(t)})):e.clearSelection(),s}_doStart(t,e,s,i,r){const n=this.editor,o=this._itemViews;return this._zoom=n.zoom/100,this._alt=r,this._parentPos=this._parentView.container.getDomPosition(this._parentView),this.$_prepare(n.doc),this._itemPts=[],this._feedbacks.forEach(((t,e)=>{const s=o[e],i=n.getDomPosition(s,0!==s.rotation);t.setBounds(i.x,i.y,i.width,i.height),t.setRotation(s.rotation),this._itemPts.push(i)})),!0}_doDrag(t,e,s){const i=this.editor.findReportElementOf(t),r=this._itemView;let n=e-this.startX,o=s-this.startY;if(i!==r&&i instanceof ki&&i!==r.parent&&!r.isAncestorOf(i)){const t=i.boundsByContainer();t.x-=this.editor.leftPos,t.y-=this.editor.topPos,this._mask.setRect(t),this._mask.show(),this._newParent=i,this._feedbacks.forEach(((t,e)=>{const s=this._itemPts[e];t.setNewParent(i).move(s.x+n,s.y+o)})),this._hline.hide(),this._vline.hide()}else{this._mask.hide(),this._newParent=null;let t=this._dir;t||n===o||(t=this._alt?Math.abs(n)>Math.abs(o)?"h":"v":""),this._dir=t,"h"===t&&(o=0),"v"===t&&(n=0);const i=this.$_calcPts(n,o);if(this._feedbacks.forEach(((t,r)=>{const a=this._itemPts[r],A=i[r],l=a.x+n,h=a.y+o;t.setNewPosition(A.x,A.y).move(l,h),0===r&&(e=l,s=h)})),"h"!==t&&t?this._hline.hide():this._hline.hline(s+r.height/2,e,this._parentPos.x),"v"!==t&&t?this._vline.hide():this._vline.vline(e+r.width/2,s,this._parentPos.y),this._guideX=this._guideY=NaN,this._hguide.hide(),this._vguide.hide(),this._siblings){const t=d.create(e,s,r.width,r.height);let i;i=this.$_getNearest(t,"t","t"),i?(this._guideY=s-i.y,this._hguide.hline(i.y,i.x,i.x+i.width),this._feedbacks[0].hideSpan()):(i=this.$_getNearest(t,"b","b"),i&&(this._guideY=s+t.height-(i.y+i.height),this._hguide.hline(i.y+i.height,i.x,i.x+i.width))),i=this.$_getNearest(t,"l","l"),i?(this._guideX=e-i.x,this._vguide.vline(i.x,i.y,i.y+i.height),this._feedbacks[0].hideSpan()):(i=this.$_getNearest(t,"r","r"),i&&(this._guideX=e+t.width-(i.x+i.width),this._vguide.vline(i.x+i.width,i.y,i.y+i.height)))}}return!0}_doCompleted(){const t=this._itemView.model,e=t.report;let s=this.currentX-this.startX,i=this.currentY-this.startY;if("h"===this._dir&&(i=0),"v"===this._dir&&(s=0),this._newParent)this._items.length>1?e.execute(new nB(this._items,this._newParent.model)):e.execute(new rB(t,this._newParent.model));else if(0!==s||0!==i){isNaN(this._guideY)||(i-=this._guideY),isNaN(this._guideX)||(s-=this._guideX);const r=this.$_calcPts(s,i);r.length>1?e.execute(new pA(this._items,r)):e.execute(new uA(t,r[0].x,r[0].y))}}_doCanceled(){}_doEnded(){this._editor.removeFeedbacks(this._hguide,this._vguide,this._hline,this._vline,this._mask),this._feedbacks.forEach((t=>this._editor.removeFeedback(t)))}$_calcPts(t,e){const s=this._zoom,i=this._parentPos,r=[];return this._itemPts.forEach((n=>{const o=Math.round((n.x-i.x+t)/s),a=Math.round((n.y-i.y+e)/s);r.push({x:o,y:a})})),r}$_prepare(t){this._feedbacks=[],this._items.forEach((e=>{this._feedbacks.push(new lB(t,e))})),this._hguide=new cB(t),this._vguide=new cB(t),this._hline=new hB(t),this._vline=new hB(t),this._mask=new dB(t),this._feedbacks.forEach((t=>this._editor.addFeedbacks(t))),this._editor.addFeedbacks(this._hguide,this._vguide,this._hline,this._vline,this._mask)}$_distance(t,e){const s=Math.pow(t.x+t.width/2-(e.x+e.width/2),2),i=Math.pow(t.y+t.height/2-(e.y+e.height/2),2);return Math.sqrt(s+i)}$_getNearest(t,e,s){const i=t.x,r=t.y,n=t.x+t.width,o=t.y+t.height;let a,A;for(let l=0;l<this._siblings.length;l++){const h=this._siblings[l];let d;switch(e){case"t":if("t"===s)r>=h.y-1&&r<=h.y+1&&(d=h);break;case"b":if("b"===s)o>=h.y+h.height-1&&o<=h.y+h.height+1&&(d=h);case"l":if("l"===s)i>=h.x-1&&i<=h.x+1&&(d=h);case"r":if("r"===s)n>=h.x+h.width-1&&n<=h.x+h.width+1&&(d=h)}if(d)if(A){const e=this.$_distance(t,d);e<a&&(A=d,a=e)}else A=d,a=this.$_distance(t,A)}return A}}class pB extends oB{constructor(t,e,s,i){super(t,"tableColumnResizeTracker"),this._table=e,this._marquee=s,this._col=i,this._sibling=J.isDefined(e.model.width)&&i<e.colCount-1?i+1:-1,this._oldPoints=e.getColPoints(),this._oldSize=this._oldPoints[this._col+1]-this._oldPoints[this._col]}get cursor(){return"ew-resize"}get startWhenCreated(){return!0}_doStart(t,e,s,i){return this._start=e,!0}_doDrag(t,e,s){const i=this._oldPoints,r=this._col,n=e-this._start;if(n<=0&&i[r+1]+n<=i[r]+4)return!1;if(n>0&&this._sibling&&i[r+1]+n>=i[r+2]-4)return!1;const o=this.editor.getDomPosition(this._marquee);return this._newSize=Math.round(this._oldSize+n),this._marquee.showColSizeFeedback(this._col,e-o.x,this._newSize+"px"),!0}_doCompleted(){if(this._sibling>=0)this.editor.report.adjustColumnWidths(this._table,this._col,this._oldPoints,this._newSize);else{const t=this._table.getColumn(this._col);this.editor.report.setItemProperty(t,"width",this._newSize)}}_doEnded(){this._marquee.hideSizeFeedbacks()}}class _B extends oB{constructor(t,e,s,i){super(t,"tableRowResizeTracker"),this._table=e,this._marquee=s,this._row=i,this._sibling=J.isDefined(e.model.height)?i+1:-1,this._oldPoints=e.getRowPoints(),this._oldSize=this._oldPoints[this._row+1]-this._oldPoints[this._row]}get cursor(){return"ns-resize"}get startWhenCreated(){return!0}_doStart(t,e,s,i){return this._start=s,!0}_doDrag(t,e,s){const i=this._oldPoints,r=this._row,n=s-this._start;if(n<=0&&i[r+1]+n<=i[r]+4)return!1;if(n>0&&this._sibling&&i[r+1]+n>=i[r+2]-4)return!1;const o=this.editor.getDomPosition(this._marquee);return this._newSize=Math.round(this._oldSize+n),this._marquee.showRowSizeFeedback(this._table,this._row,s-o.y,this._newSize+"px"),!0}_doCompleted(){if(this._sibling>=0)this.editor.report.adjustRowHeights(this._table.model,this._row,this._oldPoints,this._newSize);else{const t=this._table.model.getRow(this._row);this.editor.report.setItemProperty(t,"height",this._newSize)}}_doEnded(){this._marquee.hideSizeFeedbacks()}}class gB extends oB{constructor(t,e,s){super(t,"chartSeriesMoveTracker"),this._dom=e,this._bounds=J.getOffsetRect(e)}get selectable(){return!0}_doStart(t,e,s,i){return this._feedback=this.editor.doc.createElement("div"),this._feedback.className="rr-series-move-feedback",Object.assign(this._feedback.style,{position:"absolute",backgroundColor:"#33333380",border:"1px solid #111"}),J.setRect(this._feedback,this._bounds),this._dom.parentElement.appendChild(this._feedback),!0}_doDrag(t,e,s){const i=this.editor.getEditMarquee();this.editor.dom.getBoundingClientRect().x,this.editor.leftPos;const r=i.isSeries(t);return r!==this._targetDom&&(this._targetDom&&(this._targetDom.style.backgroundColor=""),r!==this._dom?(this._targetDom=r,this._targetDom&&(r.style.backgroundColor="#f80")):this._targetDom=null),e=this._bounds.x+100*(e-this.startX)/this.editor.zoom,this._feedback.style.left=e+"px",!0}_doCompleted(t,e,s){if(this._targetDom){const t=this.editor.getEditMarquee(),e=t.chart,s=t.getSeriesIndex(this._dom),i=t.getSeriesIndex(this._targetDom);this.editor.report.moveCollectionItem(e.series,s,i)}}_doEnded(){this._targetDom&&(this._targetDom.style.backgroundColor="",this._targetDom=null),this._dom.parentElement.removeChild(this._feedback),this._dom=null}}class fB extends je{constructor(t){super(t,"gaurdItemView"),this._index=-1,this._focused=!1}_doDispose(){super._doDispose()}get section(){return this._section}_debuggable(){return!1}isDom(t){return t===this._label||super.isDom(t)}_initDom(t,e){super._initDom(t,e),e.style.overflow="hidden",this._label=t.createElement("div"),e.appendChild(this._label)}_doMeasure(t,e,s,i){let r=this._index%2?"rr-section-guard-item-odd":"rr-section-guard-item";return this._focused&&(r+=" rr-section-guard-item-focus"),this.styleName=r,this._section.model instanceof ko&&(e.style.backgroundColor=this._focused?"":"#ddd"),new Me(s,i)}_doLayoutContent(t){this._label.textContent=this._section.guardLabel}$_setSection(t,e,s){this._index=t,this._section=e,this._focused=s}}class mB extends je{constructor(t,e){super(t,"sectionGaurd"),this._itemPool=[],this._itemViews=[],this._editor=e}_doDispose(){super._doDispose()}_debuggable(){return!1}_getCssSelector(){return"rr-section-guard"}_initDom(t,e){super._initDom(t,e)}_doPrepareMeasure(t,e){const s=this._editor.reportView.pageView.getSections().length,i=this._itemViews,r=this.doc;let n;for(;i.length<s;)n=this.$_borrow(r),this.addChild(n),i.push(n);for(;i.length>s;)n=i.pop(),this.removeChild(n),this.$_free(n)}_doAfterMeasure(t,e,s,i,r){}_doMeasure(t,e,s,i){const r=this._editor.reportView.pageView.getSections(),n=this._itemViews,o=r.length,a=this.width-1,A=this._editor.focusedItem;for(let e=0;e<o;e++){const s=r[e],i=n[e];i.$_setSection(e,s,s.model==A),i.measure(t,a,s.height)}return new Me(s,i)}_doLayoutContent(t){const e=this._editor,s=e.reportView,i=e.zoom/100,r=e.reportView.pageView.getSections(),n=this._itemViews,o=r.length,a=e.topPos,A=s.boundsByContainer().y;let l=n[0],h=A+r[1].boundsBy(s).y*i-a-20;l.resize(n[1].measuredWidth,20,!0),l.layoutContent(t),l.move(0,h);for(let e=1;e<o;e++)l=n[e],h=A+r[e].boundsBy(s).y*i,l.resize(l.measuredWidth,l.measuredHeight*i,!0),l.layoutContent(t),l.move(0,h-a)}$_borrow(t){return this._itemPool.pop()||new fB(t)}$_free(t){this._itemPool.push(t)}}class wB extends _t{constructor(t){super(t,"rr-add-feedback","div"),this.hide()}_doDispose(){super._doDispose()}get target(){return this._target}get tableTarget(){return this._tableTarget}get trow(){return this._tcell?this._tcell.parentElement.rowIndex-0:-1}get tcol(){return this._tcell?this._tcell.cellIndex:-1}setTarget(t){!t||t instanceof ki||(t=t.modelParent);const e=t;if(e!==this._target)if(this._target=e,this._tcell=this._tableTarget=null,e&&e.container instanceof WB){const s=e.container,i=s.getDomPosition(e),r=t.width*s.zoom/100,n=t.height*s.zoom/100;i.x+=s.leftPos,i.y+=s.topPos,this.setStyles({display:"",left:i.x-s.leftPos+"px",top:i.y-s.topPos+"px",width:r+"px",height:n+"px"})}else this.setStyle("display","none")}setTableTarget(t,e){if(e!==this._tcell){const s=this._tcell=e&&e.parentElement;if(this._tableTarget=s&&t.findTable(this._tcell),this._target=null,this._tcell){const e=s.getBoundingClientRect(),i=t.getBound(),r=s.offsetWidth*t.zoom/100,n=s.offsetHeight*t.zoom/100;this.setStyles({display:"",left:e.x-i.x+"px",top:e.y-i.y+"px",width:r+"px",height:n+"px"})}else this.setStyle("display","none")}}clearTarget(){this.setTarget(null),this.setTableTarget(null,null)}}class yB extends _t{constructor(t){super(t,"rr-add-effect","span"),this.hide()}_doDispose(){super._doDispose()}setAddType(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t?(this.setText(t),this.setStyles({display:"",left:e+18+"px",top:s+"px"})):this.hide()}clearAddType(){this.hide()}}class CB extends oB{constructor(t,e){super(t,"tableSelectionTracker"),this._table=e}get selectable(){return!0}_doStart(t,e,s,i){return this._selection=this.editor.getSelection()[0],!0}_doDrag(t,e,s){const i=this._table.getCellOf(t,!0);if(i)return this.editor.selections.resize(this._selection,i),!0}_doCompleted(t,e,s){}_doEnded(){}}class bB extends _t{constructor(t){super(t,"rr-select-feedback")}_prepareDom(t,e){this.setImportantStyle("position","absolute")}}class vB extends oB{constructor(t,e,s){super(t,"itemSelectionTracker"),this._selectable=!s}get startWhenCreated(){return this._offset=this.editor.getDomPosition(this.editor.reportView.pageView),!1}get selectable(){return this._selectable}_doStart(t,e,s,i){const r=this.editor;return this.$_prepare(r.doc),this._bounds=d.create(e,s,0,0),this._offset=this.editor.getDomPosition(this.editor.reportView.pageView),!0}_doDrag(t,e,s){return this._bounds.x=Math.min(this.startX,e),this._bounds.y=Math.min(this.startY,s),this._bounds.width=Math.abs(e-this.startX),this._bounds.height=Math.abs(s-this.startY),this._feedback.setRect(this._bounds),!0}_doCompleted(t,e,s){const i=this.$_getItems();i&&i.length>0&&(this.editor.clearSelection(),this.editor.addSelections(i),this.editor.focusedItem=i[0])}_doEnded(){this._editor.removeFeedback(this._feedback)}$_prepare(t){this._feedback=new bB(t),this._editor.addFeedback(this._feedback)}$_getItems(){this._bounds.translate(-this._offset.x,-this._offset.y);const t=this.editor.reportView.activeContainerView;return this.editor.reportView.pageView.getAllElements(t,this._bounds).map((t=>t.model))}}class BB extends oB{constructor(t,e){super(t,"tableColumnMarqueeSelectTracker"),this._column=e.target}get selectable(){return!0}_doStart(t,e,s,i){return!0}_doDrag(t,e,s){const i=this.editor,r=i.getEditMarqueeTarget(t);if(r&&r.target instanceof Fr){const t=this._column.collection.getRange(this._column.index,r.target.index);return i.selections.replace(t),!0}}_doCompleted(t,e,s){}_doEnded(){}}class EB extends oB{constructor(t,e){super(t,"tableRowMarqueeSelectTracker"),this._row=e.target}get selectable(){return!0}_doStart(t,e,s,i){return!0}_doDrag(t,e,s){const i=this.editor,r=i.getEditMarqueeTarget(t);if(r&&r.target instanceof xr){const t=this._row.collection.getRange(this._row.index,r.target.index);return i.selections.replace(t),!0}}_doCompleted(t,e,s){}_doEnded(){}}class PB{constructor(t){this._dx=0,this._dy=0,this._view=t,this._item=t.model,this._oldX=t.x,this._oldY=t.y}isMe(t){return t===this._item}move(t,e){return this._dx+=t,this._dy+=e,0!==this._dx&&(this._view.x=this._oldX+this._dx),0!==this._dy&&(this._view.y=this._oldY+this._dy),this}run(t){0!==this._dx&&0!==this._dy?t.moveItem(this._item,this._oldX+this._dx,this._oldY+this._dy):0!==this._dx?t.moveItemDir(this._item,"left",this._oldX+this._dx):0!==this._dy&&t.moveItemDir(this._item,"top",this._oldY+this._dy)}}class xB{constructor(t,e){var s;this._oldX=[],this._oldY=[],this._dx=0,this._dy=0;const i=e.model;this._views=[e],this._items=[i],t.isSelected(i)?null===(s=t.getSelection())||void 0===s||s.forEach((e=>{e instanceof Ri&&e!==i&&e.parent===i.parent?(this._items.push(e),this._views.push(t.reportView.pageView.getElementOf(e))):t.removeSelection(e)})):t.clearSelection(),this._views.forEach((t=>{this._oldX.push(t.x),this._oldY.push(t.y)}))}isMe(t){return this._items.indexOf(t)>=0}move(t,e){return this._dx+=t,this._dy+=e,0!==this._dx&&this._views.forEach(((t,e)=>t.x=this._oldX[e]+this._dx)),0!==this._dy&&this._views.forEach(((t,e)=>t.y=this._oldY[e]+this._dy)),this}run(t){if(0!==this._dx&&0!==this._dy){const e=[];for(let t=0;t<this._items.length;t++)e.push({x:this._oldX[t]+this._dx,y:this._oldY[t]+this._dy});t.execute(new pA(this._items,e))}else if(0!==this._dx){const e=[];for(let t=0;t<this._items.length;t++)e.push(this._oldX[t]+this._dx);t.execute(new gA(this._items,"left",e))}else if(0!==this._dy){const e=[];for(let t=0;t<this._items.length;t++)e.push(this._oldY[t]+this._dy);t.execute(new gA(this._items,"top",e))}}}class SB extends A{constructor(t){super(),this._editor=t}_doDispose(){this._editor=null,super._doDispose()}mouseDown(t){const e=t.target,s=this.$_getCrosstab(e);if(e instanceof Element&&s){const t=this._editor,i=t.focusedItem;if(pl.isFieldArrow(e))i instanceof uo&&(t.report.addCrosstabField(i,e.$_fld),t.focusedItem=i);else{const i=s.getFieldOf(e);if(i)t.setFocused(i);else{const i=s.getFieldsOf(e);t.setFocused(i||s.model)}}return!0}}click(t){const e=t.target;this.$_getCrosstab(e)}$_getCrosstab(t){const e=t instanceof HTMLElement&&this._editor.findReportElementOf(t);return e instanceof pl&&e}}class IB extends et{constructor(t){super(t,"reportSelectionTool"),this._crosstabTool=new SB(t),this._editor=t,this._editor.addFeedback(this._addFeedback=new wB(t.doc)),this._editor.addFeedback(this._addEffect=new yB(t.doc))}_doDispose(){this._editor.removeFeedback(this._addEffect),this._editor.removeFeedback(this._addFeedback),this._editor=null,this._crosstabTool=this._crosstabTool.dispose(),super._doDispose()}get editor(){return this._editor}_doMouseDown(t){const e=t.target,s=this._editor,i=s.report,r=i.page,n="mousedown"===t.type?t.button:0,o=J.isMac,a=o&&t.metaKey||!o&&t.ctrlKey,A=t.shiftKey,l=t.altKey;if(s.reportView.editLayer.hideError(),s.isEditing()&&e instanceof HTMLInputElement)return!0;if(s.isScrollContainer(e))return!0;if(s.isRuler(e))return!0;if(this.$_selectMarquee(e,n,A,a))return!0;const h=e instanceof Element?e:null;let d=h&&s.findElementOf(h),c=!1;if(this._clickElement=d,s.addMode){const t=!s.addShifted||0==s.addedCount;if(t&&s.clearSelection(),s.addStyle===MB.CLICK){let e=this._addFeedback.target;const r=this._addFeedback.tableTarget,n=this._addFeedback.trow,o=this._addFeedback.tcol;return this.$_finishAdding(),r?s.endAddCell(r,n,o,(e=>{e&&(t?s.focusedItem=e:s.addSelection(e))})):e?(e instanceof _l&&(s.focusedItem!==i.page.backContainer&&s.focusedItem!==i.page.frontContainer||(e=s.focusedElement)),s.endAdd(!0,e,(e=>{e&&(t?s.focusedItem=e:s.addSelection(e))}))):s.cancelAdd(),!0}}if(s.isEditor(this.mouseEventTarget)||s.hideEditor(!0),this.mouseEventTarget.classList.contains("rr-outline-expander"))return!1;if(0===n&&(this.dragTracker=this._getTracker(h,this._clickElement,A,l,a),this.dragTracker instanceof oB)){const t=this.dragTracker.handleSelection();if(t)return s.focusedItem=t,!1}if(!this.dragTracker||this.dragTracker.selectable){const i=s.focusedItem;let o,h,u=sl.getTable(d);if(d===s.reportView)h=s.report.root;else if(d instanceof Je)c=!0,h=d.containsClass(Ap.PAGE_HEAD)?s.report.page:d.containsClass(Ap.BACK_HEAD)?s.report.page.backContainer:d.containsClass(Ap.FRONT_HEAD)?s.report.page.frontContainer:d.model;else if(d instanceof fB&&d.section instanceof Mi)h=d.section.model;else if(!(d instanceof Mi)&&t.target instanceof HTMLElement&&(d=this._clickElement=s.reportView.findElementOf(t.target),d&&!u&&(u=sl.getTable(d))),d instanceof Mi&&d.model instanceof Qi&&(d=d.navigableParent),d instanceof Mi){let t;h=a&&(t=Ri.findFloatingAnchor(d.model))?t:d.model}else h=d instanceof gl?d.model:null;if(u&&e instanceof HTMLElement&&(o=u.getCellOf(e,l)),o)(A||a)&&o!==i?s.toggleSelection(o,A)&&s.setFocused(o):0!=n&&s.isSelected(o)||s.setFocused(o);else if(a||A)h&&!s.focusedItem?(s.focusedItem=h,h instanceof Ri&&s.addSelection(h)):h!==i&&h instanceof Ii&&s.toggleSelection(h,A)&&s.setFocused(h);else if(h)if(0==n){if(s.reportView.activeContainer===r.backContainer?c||r.backContainer.isAncestorOf(h)||(h=null):s.reportView.activeContainer===r.frontContainer&&(c||r.frontContainer.isAncestorOf(h)||(h=null)),h instanceof No)return this._crosstabTool.mouseDown(t);h&&s.setFocused(h)}else{const t=s.getSelection();t&&(t.length>1||t[0]instanceof Rr&&!t[0].isSingle(!1))||s.isSelected(h)||s.setFocused(h)}}return!1}_doMouseMove(t){var e;const s=t.target,i=t.mouseX,r=t.mouseY,n=this._editor;if(n.addMode){n.setCursor("copy");const t=s instanceof HTMLElement?s.classList:null,o=this._addFeedback;let a=s instanceof HTMLElement&&n.findElementOf(s),A=a instanceof Mi&&a.model;!a&&s instanceof HTMLElement&&(null===(e=s.parentElement)||void 0===e?void 0:e.classList.contains("rr-item-container"))&&(a=n.findElementOf(s.parentElement),A=a instanceof Mi&&a.model),t&&t.contains(el.STYLE)?o.setTableTarget(n,s):s instanceof HTMLTableCellElement?s.firstElementChild&&s.firstElementChild.classList.contains(el.STYLE)&&o.setTableTarget(n,s.firstElementChild):a instanceof Sl||a instanceof UA||a instanceof $A||a instanceof eh||a instanceof YA?o.setTarget(a):a instanceof zi?o.clearTarget():a instanceof Tl?o.setTarget(a):A instanceof Ui||A&&A.parent instanceof Qi?o.clearTarget():a instanceof Mi?o.setTarget(a):a instanceof gl?o.setTarget(a.itemsView):o.clearTarget(),this._addEffect.setAddType(n.addType.ITEM_TYPE,i,r)}else n.handMode?n.setCursor("grab"):n.setCursor("")}_doMouseUp(t){}_doClick(t){if(this._crosstabTool.click(t))return;const e=t.target,s=this._editor;e instanceof HTMLElement&&s.findElementOf(e)}_doDblClick(t){const e=t.target,s=this._editor,i=e instanceof HTMLElement&&s.findElementOf(e);s.addMode||!i||i!==this._clickElement||!this.editor.focusedItem||s.showEditor()}_doMouseWheel(t){const e=this._editor;if(e.isEditing())return t.stopImmediatePropagation(),!0;if(t.shiftKey||Math.abs(t.deltaX)>Math.abs(t.deltaY)){const s=e.leftPos;return e.leftPos=s+t.deltaX,e.invalidateLayout(!0),!0}{const s=e.topPos;return e.topPos=s+t.deltaY,e.invalidateLayout(!0),!0}}_doMouseEnter(t){}_doMouseLeave(t){}_doMouseOutside(){this._editor.endAdd()}_doMouseOver(t){}_doContextMenu(t){return!1}_doKeyDown(t){const e=t.code,s=J.isMac,i=t.shiftKey,r=t.altKey,n=t.ctrlKey,o=s&&t.metaKey||!s&&n,a=o&&!r&&!i,A=this._editor,l=A.report,h=A.reportView.pageView,d=A.focusedItem,c=A.focusedItemElement;let u,p;if(this.$_isEditingCode(e))return!1;switch(e){case"KeyZ":if(s&&o&&i)return A.redo();if(n&&i&&!r)return A.redo();if(a)return A.undo();break;case"KeyY":if(a)return A.redo();break;case"KeyC":if(s&&t.ctrlKey&&t.metaKey&&!t.altKey&&!t.shiftKey){this.$_doAlignItems("center");break}if(n&&r&&t.metaKey&&!t.shiftKey){this.$_doAlignItems("center");break}if(a)return A.copy();break;case"KeyV":if(a)return A.paste();break;case"KeyX":if(a)return A.cut();break;case"Delete":return A.deleteSelection();case"Backspace":if(s&&a)return A.deleteSelection();case"Escape":if(this._doEsc(a))return!0;break;case"Enter":t.isComposing||this._doEnter(i)||t.preventDefault();break;case"Tab":if(this._doTab(i))return!0;break;case"Home":a&&(p=h.getFirst()),c&&(p=h.getFirstInGroup(c.navigableParent));break;case"End":a&&(p=h.getLast()),c&&(p=h.getLastInGroup(c.navigableParent));break;case"ArrowUp":if(s&&t.ctrlKey&&t.metaKey&&!t.altKey&&!t.shiftKey){this.$_doAlignItems("top");break}if(n&&r&&t.metaKey&&!t.shiftKey){this.$_doAlignItems("top");break}if(!o&&r&&d instanceof Ri)return this.$_moveItem(c,0,-1),!0;if(o&&r&&d instanceof Ri)l.changeItemIndex(d,d.index-1);else if(d instanceof Ir){if(i)return A.selections.resizeBy(A.selections.find(d),0,-1),!0;u=d.table.getCell(d.row-1,d.col),u||(p=h.getUpper(h.getElementOf(d.table)))}else p=h.getUpper(c);break;case"ArrowDown":if(s&&t.ctrlKey&&t.metaKey&&!t.altKey&&!t.shiftKey){this.$_doAlignItems("bottom");break}if(n&&r&&t.metaKey&&!t.shiftKey){this.$_doAlignItems("bottom");break}if(!o&&r&&d instanceof Ri)return this.$_moveItem(c,0,1),!0;if(o&&r&&d instanceof Ri)l.changeItemIndex(d,d.index+1);else if(d instanceof Ir){if(i)return A.selections.resizeBy(A.selections.find(d),0,1),!0;u=d.table.getCell(d.row+1,d.col),u||(p=h.getLower(h.getElementOf(d.table)))}else p=h.getLower(c);break;case"ArrowLeft":if(s&&t.ctrlKey&&t.metaKey&&!t.altKey&&!t.shiftKey){this.$_doAlignItems("left");break}if(n&&r&&t.metaKey&&!t.shiftKey){this.$_doAlignItems("left");break}if(!o&&r&&d instanceof Ri)return this.$_moveItem(c,-1,0),!0;if(o&&r&&d instanceof Ri)l.changeItemIndex(d,d.index-1);else if(d instanceof Ir){if(i)return A.selections.resizeBy(A.selections.find(d),-1,0),!0;u=d.table.getCell(d.row,d.col-1),u||(p=h.getLeft(h.getElementOf(d.table)))}else p=h.getLeft(c);break;case"ArrowRight":if(s&&t.ctrlKey&&t.metaKey&&!t.altKey&&!t.shiftKey){this.$_doAlignItems("right");break}if(n&&r&&t.metaKey&&!t.shiftKey){this.$_doAlignItems("right");break}if(!o&&r&&d instanceof Ri)return this.$_moveItem(c,1,0),!0;if(o&&r&&d instanceof Ri)l.changeItemIndex(d,d.index+1);else if(d instanceof Ir){if(i)return A.selections.resizeBy(A.selections.find(d),1,0),!0;u=d.table.getCell(d.row,d.col+1),u||(p=h.getRight(h.getElementOf(d.table)))}else p=h.getRight(c);break;case"KeyA":if(a&&d instanceof Ti)return A.selectAll(i?d:null),!0;break;case"Digit0":if(a)return A.incZoom(0),!0;break;case"Equal":if(a)return A.incZoom(1),!0;break;case"Minus":if(a)return A.incZoom(-1),!0}return p&&(u=u||p.model),u&&u!=d&&A.setFocused(u),super._doKeyDown(t)}_doKeyPress(t){return!1}_doKeyUp(t){return this._moveAction&&(this._moveAction.run(this.editor.reportView.model),this._moveAction=null),!1}$_getTable(t){for(;t;){if(t instanceof HTMLTableCellElement)return this._editor.findTable(t);t=t.parentElement}}_getTracker(t,e,s,i,r){var n;const o=this._editor,a=sl.getTable(e)||this.$_getTable(t);let A;if(r&&s)return new vB(o,e,s&&r);if(e instanceof Zv&&e.enabled&&!s)return new AB(o,e);if(o.handMode)return new aB(o);if(a){if(a.getCellOf(t,i))return new CB(o,a)}if((A=Wv.isColSizeTracker(t))>=0){const t=o.marquee.target;if(t)return new pB(o,t,o.marquee,A)}if((A=Wv.isRowSizeTracker(t))>=0){const t=o.marquee.target;if(t)return new _B(o,t,o.marquee,A)}if((A=Kv.isColSizeTracker(t))>=0){const t=o.marquee.target;if(t)return new pB(o,t,o.marquee,A)}if(A=Kv.isRowSizeTracker(t)){const t=o.marquee.target.getTableView(A.table);return new _B(o,t,o.marquee,A.row)}if(e instanceof Mi&&e.model.canMove()&&!s){const t=null===(n=e.model.parent)||void 0===n?void 0:n.getMoveType(e.model);if(t)return new uB(o,e,t)}return e===o.reportView.parent||e instanceof VB||e instanceof gl||e instanceof kA||e instanceof _l||e instanceof JA?new vB(o,e,!1):void 0}$_selectMarquee(t,e,s,i){const r=this._editor,n=this._marqueeTarget=r.getEditMarqueeTarget(J.cast(t,HTMLElement));if(n){const o=n.target;return(s||i)&&o&&r.focusedItem&&o.constructor===r.focusedItem.constructor?r.toggleSelection(o,s)&&r.setFocused(o):o&&r.focusedItem!==o&&r.setFocused(o),0!==e||i||(o instanceof Fr?this.dragTracker=new BB(r,n):o instanceof xr?this.dragTracker=new EB(r,n):o instanceof Yn&&(this.dragTracker=new gB(r,t,n))),!0}}_doEsc(t){const e=this._editor,s=e.focusedItem;if(this._marqueeTarget)return e.closeEditMarquee(),this._marqueeTarget.target===s&&e.setFocused(e.getDisplayParent(s)),this._marqueeTarget=null,!0;if(this.$_finishAdding(),!e.cancelAdd()&&!e.hideEditor(!1)&&s){let i;t&&(i=Ri.findFloatingAnchor(s))?e.setFocused(i):e.setFocused(e.getDisplayParent(s))}}_doEnter(t){const e=this._editor;if(e.focusedItem){if(e.isEditing()&&t&&e.canMultiLine())return!0;if(e.hideEditor(!0))return;if(e.showEditor())return}}_doTab(t){const e=this._editor,s=e.reportView.pageView;if(e.focusedItem){const i=e.focusedItemElement;let r;if(r=t?s.getPrev(i):s.getNext(i),r&&r!==i)return e.setFocused(r.model),!0}}$_moveItem(t,e,s){this._moveAction?this._moveAction.isMe(t.model)||(this._moveAction.run(this.editor.reportView.model),this.editor.selectionCount>1?this._moveAction=new xB(this.editor,t):this._moveAction=new PB(t)):this.editor.selectionCount>1?this._moveAction=new xB(this.editor,t):this._moveAction=new PB(t),this._moveAction.move(e,s)}$_isEditingCode(t){const e=this._editor.isEditing();return!!Object.values(B).includes(t)&&e}$_doAlignItems(t){this._editor.report.alignItems(this._editor.getSelectedItems(),t)}$_finishAdding(){this._editor.setCursor(""),this._addFeedback.clearTarget(),this._addEffect.clearAddType()}}class RB extends tt{constructor(t,e,s){super(t,e),this._unit=p.MILLI,this._startPos=50,this._length=210,this._marginStart=12,this._marginEnd=12,this._zoom=100,this._tickPool=[],this._ticks=[],this._labelPool=[],this._labels=[],this._layoutChanged=!0,this._dimChanged=!0,this._container=s}_doDispose(){super._doDispose()}get unit(){return this._unit}set unit(t){t!=this._unit&&(this._unit=t,this._dimensionChanged())}get startPos(){return this._startPos}set startPos(t){t!=this._startPos&&(this._startPos=t,this._changed())}get length(){return this._length}set length(t){t!=this._length&&(this._length=t,this._dimensionChanged())}get marginStart(){return this._marginStart}set marginStart(t){(t=Math.max(0,t))!=this._marginStart&&(this._marginStart=t,this._dimensionChanged())}get marginEnd(){return this._marginEnd}set marginEnd(t){(t=Math.max(0,t))!=this._marginEnd&&(this._marginEnd=t,this._dimensionChanged())}get zoom(){return this._zoom}set zoom(t){t!==this._zoom&&(this._zoom=t,this._changed())}refreshView(){if(this._layoutChanged||this._dimChanged){if(this._dimChanged){const t=this._unit;this._lengthDim=new C(this._length+t),this._marginStartDim=new C(this._marginStart+t),this._marginEndDim=new C(this._marginEnd+t),this._dimChanged=!1}this._doRefreshView(this._container),this.setFocusedElement(this._container.focusedElement),this._layoutChanged=!1}}getTick(t){return this._ticks[t]}setFocusedElement(t){}_initDom(t,e){super._initDom(t,e),e.style.boxSizing="content-box",this._contentMask=t.createElement("div"),this._contentMask.className="rr-ruler-content",this._contentMask.style.position="absolute",e.appendChild(this._contentMask),this._tickBar=t.createElement("div"),this._tickBar.style.position="absolute",e.appendChild(this._tickBar)}_changed(){this._layoutChanged=!0}_dimensionChanged(){this._dimChanged=!0}_clearTicks(){if(this._ticks.length>0){for(let t of this._ticks)J.remove(t),this._tickPool.push(t);this._ticks=[]}if(this._labels.length>0){for(let t of this._labels)J.remove(t),this._labelPool.push(t);this._labels=[]}}_addTick(t){let e=this._tickPool.pop();return e||(e=t.createElement("span"),e.style.position="absolute",e.style.width="1px",e.style.backgroundColor="#aaa"),this._tickBar.appendChild(e),this._ticks.push(e),e}_addLabel(t){let e=this._labelPool.pop();return e||(e=t.createElement("span"),e.style.position="absolute",e.style.color="#555",e.style.textAlign="center",e.style.fontFamily="Helvetica, Arial, sans-serif",e.style.fontSize="8px"),this._tickBar.appendChild(e),this._labels.push(e),e}_prepareTicks(t){this._clearTicks();let e=1+2*Math.round(this.length/10);for(let s=0;s<e;s++)this._addTick(t);e/=2;for(let s=0;s<e;s++)this._addLabel(t)}}RB.RULER_WIDTH=14;class TB extends RB{constructor(t,e){super(t,"horizontalRuler",e),this.height=RB.RULER_WIDTH}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-ruler rr-ruler-horizontal"}_initDom(t,e){super._initDom(t,e),this._indicator=t.createElement("span"),this._indicator.className="rr-ruler-indicator rr-ruler-indicator-horz",this._indicator.style.position="absolute",this._indicator.style.boxSizing="border-box",this._contentMask.appendChild(this._indicator)}_doRefreshView(t){const e=this.zoom/100;let s=this.startPos;let i=this._lengthDim.getFixedPixel()*e;const r=this.height;J.setBounds(this._tickBar,s,0,i,r);const n=this._marginStartDim.getFixedPixel()*e;s+=n,i-=n+this._marginEndDim.getFixedPixel()*e,J.setBounds(this._contentMask,s,0,i,r),this._prepareTicks(t.doc),this.$_layoutTicks(e)}setFocusedElement(t){if(t){const e=this.container,s=this.zoom/100,i=e.reportView.getItemBoundingRect(t);J.setBounds(this._indicator,i.left*s,0,i.width*s,this.height),this._indicator.style.display=""}else this._indicator.style.display="none"}$_layoutTicks(t){const e=this.unit,s=this.height,i=.2*s,r=.4*s,n=s-i,o=s-r,a=this._ticks,A=this._labels;for(let s=0,l=0,h=a.length;s<h;s++){const h=a[s],d=s%2==0?i:r,c=s%2==0?n:o;let u=f(e,5*s);if(l>0&&(u*=t),J.setBounds(h,u,c,1,d),s%2==0){const t=A[l++];t.textContent=l+"",J.setBounds(t,u-50,-1,100,d)}}}}class OB extends RB{constructor(t,e){super(t,"verticalRuler",e),this.length=297,this.marginStart=15,this.marginEnd=15,this.width=RB.RULER_WIDTH}_doDispose(){super._doDispose()}_getCssSelector(){return"rr-ruler rr-ruler-vertical"}_initDom(t,e){super._initDom(t,e),this._indicator=t.createElement("span"),this._indicator.className="rr-ruler-indicator rr-ruler-indicator-vert",this._indicator.style.position="absolute",this._indicator.style.boxSizing="border-box",this._contentMask.appendChild(this._indicator)}_doRefreshView(t){const e=this.zoom/100;let s=this.startPos;let i=this._lengthDim.getFixedPixel()*e;const r=this.width;J.setBounds(this._tickBar,0,s,r,i);const n=this._marginStartDim.getFixedPixel()*e;s+=n,i-=n+this._marginEndDim.getFixedPixel()*e,J.setBounds(this._contentMask,0,s,r,i),this._prepareTicks(t.doc),this.$_layoutTicks(e)}setFocusedElement(t){if(t){const e=this.container,s=this.zoom/100,i=e.reportView.getItemBoundingRect(t);J.setBounds(this._indicator,0,i.top*s,this.width,i.height*s),this._indicator.style.display=""}else this._indicator.style.display="none"}$_layoutTicks(t){const e=this.unit,s=this.width,i=.2*s,r=.4*s,n=s-i,o=s-r,a=this._ticks,A=this._labels;for(let s=0,l=0,h=a.length;s<h;s++){const h=a[s],d=s%2==0?i:r,c=s%2==0?n:o;let u=f(e,5*s);if(l>0&&(u*=t),J.setBounds(h,c,u,d,1),s%2==0){const t=A[l++];t.style.transform="rotate(-90deg)",t.textContent=l+"",J.setBounds(t,-46,u-4,100,10)}}}}class FB extends q{constructor(t,e){super(t,"textEditor"),this._reportEditor=e}_doDispose(){super._doDispose()}get editTarget(){return this._editTarget}get isEditing(){return!!this._editTarget}show(t,e){if(t&&t.editable&&t!==this._editTarget){const e=this.container._scrollContainer,s=J.getBoundingRect(e.dom,t.parent.dom);return s.x+=e.scrollLeft,s.y+=e.scrollTop,this.setBounds(s.x,s.y,s.width,s.height),this._input.innerText=t.getEditText(),this.$_setInputEvent(),this.$_setInputStyle(t),this.style.display="",J.selectAll(this._input),t.dom.style.visibility="hidden",this._editTarget=t,this._reportEditor.reportView._editLayer.hideFocus(),this._oldValue=this._input.innerText,!0}}hide(t){const e=this._input;if(this._editTarget)return t&&e.innerText!==this._oldValue&&(this._editTarget.setEditText(this._reportEditor.reportView.model,e.innerText),this.container.invalidateLayout()),this.style.display="none",this._reportEditor.reportView._editLayer.showFocus(),this._editTarget.dom.style.visibility="",this._editTarget=null,!0}is(t){return this.dom.contains(t)}canMultiLine(){const t=this._editTarget.model;return t instanceof ur&&t.multiLine}_initDom(t,e){super._initDom(t,e);const s=this._input=t.createElement("span");s.className="rr-text-edit",s.contentEditable="true",e.style.display="none",e.style.zIndex=VB.ACTIVE_ZINDEX,e.appendChild(s)}_getCssSelector(){return"rr-text-editor"}$_setInputStyle(t){if(t&&this._reportEditor){const e=this._input.style;e.left=null,e.right=null,e.transform=null,e.maxWidth=null,e.top=t.y+"px";const s=cr.STYLE_PROPS.concat(["whiteSpace","wordBreak","letterSpacing"]),i=window.getComputedStyle(t.dom);for(let t=0;t<s.length;t++){const r=s[t].search(/[A-Z]/gm);e[s[t]]=-1===r?i.getPropertyValue(s[t]):i.getPropertyValue(s[t].slice(0,r)+"-"+s[t].slice(r).toLowerCase())}const r=t.parent,n=t.model;if(r instanceof Il){const t=r.model.table.getCell(r.model.row,r.model.col).styles.cellAlign;"left"===t?e.left="0px":"right"===t?e.right="0px":(e.left="50%",e.transform="translate(-50%, 0)")}else if(r instanceof XA){const s=r.model.itemsAlign;"middle"===s?(e.left=t.x+t.width/2+"px",e.transform="translate(-50%, 0)"):"end"===s?e.right=r.width-(t.x+t.width)+"px":e.left=t.x+"px"}else r instanceof xl?e.left=t.x+"px":r instanceof YA?t.x&&(e.right="0px"):n.left?e.left=J.isNumber(n.left)?n.left+"px":n.left:n.right?e.right=J.isNumber(n.right)?n.right+"px":n.right:(e.left="50%",e.transform="translate(-50%, 0)");0!==t.rotation&&(e.transform=e.transform+" rotate(".concat(t.rotation,"deg)")),e.border="1px solid #000",e.position="absolute",e.minWidth=n.width?t.width+"px":null,e.minHeight=n.height?t.height+"px":null,t instanceof Bl&&t.model.wrap&&t.model.width&&(e.maxWidth=t.width+"px")}}$_setInputEvent(){const t=this._input;t.addEventListener("mousedown",(t=>{t.stopPropagation()})),t.addEventListener("blur",(()=>{this.hide(!0)}))}}class DB extends et{constructor(t,e){super(e),this._cellClicked=!1,this._titleClicked=!1,this._designer=t}_doMouseDown(t){const e=t.target;return this._cellClicked=this._titleClicked=!1,0===t.button&&e instanceof HTMLElement&&((this._cellClicked=e.className===LB.CELL_CLASS)?this._designer.setRange(0,0):(this._titleClicked=e.className===LB.TITLE_CLASS)&&(this._prevX=t.clientX,this._prevY=t.clientY)),!1}_doMouseMove(t){const e=t.target;if(this._cellClicked&&e instanceof HTMLSpanElement&&e.className===LB.CELL_CLASS){const t=+e.dataset.row,s=+e.dataset.col;this._designer.setRange(t+1,s+1)}else if(this._titleClicked){const e=t.clientX,s=t.clientY;this._designer.moveBy(e-this._prevX,s-this._prevY,!0),this._prevX=e,this._prevY=s}}_doMouseUp(t){this._cellClicked=this._titleClicked=!1}_doKeyDown(t){if("Escape"===t.key)return this._designer.$_end(!1),!0}_doKeyPress(t){if("Enter"===t.key)return this._designer.$_end(!0),!0}}class LB extends Ze{constructor(t){super(t,"tableDesigner"),this._row=-1,this._col=-1}run(t,e){this._callback=e,t.showPopup(this),t.activeTool=new DB(this,t)}setRange(t,e){t===this._row&&e===this._col||(this._row=t,this._col=e,this._cells.forEach((s=>{const i=+s.dataset.row,r=+s.dataset.col;s.style.backgroundColor=i<t&&r<e?"#00eeff":"white"})),this._spanRange.textContent="(".concat(t," X ").concat(e," cells)"))}_getCssSelector(){return"rr-table-designer"}_initDom(t,e){super._initDom(t,e),Object.assign(e.style,{boxShadow:"3px 3px 8px #888"}),this._spanTitle=t.createElement("span"),this._spanTitle.className=LB.TITLE_CLASS,this._spanTitle.dataset.title="1",this._spanTitle.textContent="New TableContainer",Object.assign(this._spanTitle.style,{display:"inline-block",width:"100%"}),e.appendChild(this._spanTitle),this._cellContainer=t.createElement("div"),Object.assign(this._cellContainer.style,{display:"flex",flexWrap:"wrap",gap:"2px",border:"1px solid gray",backgroundColor:"#ccc",padding:"4px",marginBottom:"12px"}),this._rowLen=LB.ROWS,this._colLen=LB.COLS,this._cells=[],this.$_prepareCells(t,this._cellContainer,this._rowLen,this._colLen),e.appendChild(this._cellContainer),this._buttonContainer=t.createElement("div"),Object.assign(this._buttonContainer.style,{textAlign:"right"}),this.$_prepareButtons(t,this._buttonContainer),e.appendChild(this._buttonContainer);const s=this._spanRange=t.createElement("span");Object.assign(s.style,{display:"inline-block",position:"absolute",bottom:"15px",marginLeft:"5px",fontSize:"1.1em",fontWeight:"bold"}),s.textContent="(0 X 0 cells)",e.appendChild(this._spanRange)}_doMeasure(t,e,s,i){return this._cellContainer.style.height="200px",new Me(310,300)}$_prepareCells(t,e,s,i){const r=this._cells;for(;r.length<s*i;){const s=t.createElement("span");Object.assign(s.style,{display:"inline-block",width:LB.CELL_WIDTH,height:LB.CELL_HEIGHT,color:"white",border:"1px solid #555",backgroundColor:"white"}),s.className=LB.CELL_CLASS,e.appendChild(s),this._cells.push(s)}for(let t=0;t<s;t++)for(let e=0;e<i;e++){const s=r[t*i+e];s.dataset.row=String(t),s.dataset.col=String(e)}}$_prepareButtons(t,e){let s=t.createElement("button");s.style.marginRight="8px",s.textContent="Create",s.onclick=()=>{this.$_end(!0)},e.appendChild(s),s=t.createElement("button"),s.textContent="Cancel",s.onclick=()=>{this.$_end(!1)},e.appendChild(s)}$_end(t){if(t&&(this._row<1||this._col<1))alert("테이블 셀 범위를 지정해야 합니다.");else if(this.container.activeTool=null,this.container.hidePopup(this),t&&this._callback){const t=new ln("");t.rowCount=this._row,t.colCount=this._col,this._callback&&this._callback(t)}}}LB.CELL_CLASS="rr-table-designer-cell",LB.TITLE_CLASS="rr-table-designer-title",LB.COLS=10,LB.ROWS=10,LB.CELL_WIDTH="24px",LB.CELL_HEIGHT="16px";class NB extends et{constructor(t,e){super(e),this._titleClicked=!1,this._sizeClicked=!1,this._designer=t}_doMouseDown(t){const e=t.target;return this._titleClicked=this._sizeClicked=!1,0===t.button&&e instanceof HTMLElement&&((this._sizeClicked=e===this._designer._sizer)||(this._titleClicked=e.className===HB.TITLE_CLASS))&&(this._prevX=t.clientX,this._prevY=t.clientY),!1}_doMouseMove(t){const e=t.clientX,s=t.clientY;this._sizeClicked?this._designer.resizeBy(e-this._prevX,s-this._prevY,!0):this._titleClicked&&this._designer.moveBy(e-this._prevX,s-this._prevY,!0),this._prevX=e,this._prevY=s}_doMouseUp(t){this._titleClicked=this._sizeClicked=!1}_doClick(t){const e=t.target;e instanceof HTMLButtonElement?this._designer.buttonClick(e):e instanceof HTMLElement&&this._designer.clickField(e)}_doKeyDown(t){if("Escape"===t.key)return this._designer._end(!1),!0}_doKeyPress(t){if("Enter"===t.key)return this._designer._end(!0),!0}}class HB extends Ze{clickField(t){t.className===HB.FIELD_CLASS?t.parentElement===this._fieldList?this._currSrc=t:t.parentElement===this._bandFieldList&&(this._currDst=t):t.className===HB.FIELD_LIST_CLASS&&(this._currSrc=this._currDst=null),this.$_checkArrows()}buttonClick(t){switch(t.textContent){case">>":this.$_addAll();break;case">":this.$_add();break;case"<<":this.$_removeAll();break;case"<":this.$_remove()}}$_refreshFields(){for(let t of this._fieldList.children)t===this._currSrc?t.dataset.select="1":delete t.dataset.select}_refreshBandFields(){for(let t of this._bandFieldList.children)t===this._currDst?t.dataset.select="1":delete t.dataset.select}$_checkArrows(){const t=this.dom.getElementsByClassName(HB.ARROW_CLASS);for(let e of t){const t=e;switch(t.textContent){case">>":t.disabled=0===this._fieldList.children.length;break;case">":t.disabled=!this._currSrc;break;case"<<":t.disabled=0===this._bandFieldList.children.length;break;case"<":t.disabled=!this._currDst}}this.$_refreshFields(),this._refreshBandFields(),this._ok.disabled=0===this._bandFieldList.children.length}resizeBy(t,e,s){super.resizeBy(t,e,s),this._refreshBandFields()}$_addAll(){const t=this._fieldList,e=this._bandFieldList;for(;t.firstElementChild;)e.appendChild(t.firstElementChild);this._currSrc=null,this.$_checkArrows()}$_removeAll(){const t=this._fieldList,e=this._bandFieldList;for(;e.firstElementChild;)t.appendChild(e.firstElementChild);this._currDst=null,this.$_checkArrows()}$_add(){this._bandFieldList.append(this._currSrc),this._currDst=this._currSrc,this._currSrc=null,this.$_checkArrows()}$_remove(){this._fieldList.append(this._currDst),this._currSrc=this._currDst,this._currDst=null,this.$_checkArrows()}}HB.TITLE_CLASS="rr-band-designer-title",HB.FIELD_LIST_CLASS="rr-band-designer-field-list",HB.FIELD_CLASS="rr-band-designer-field",HB.ARROW_CLASS="rr-band-designer-arrow";class QB extends HB{constructor(t){super(t,"tableBandDesigner")}run(t,e){this._callback=e,this._editor=t,this.$_buildDesinger(t),t.showPopup(this),t.activeTool=new NB(this,t)}_getCssSelector(){return"rr-band-designer"}_initDom(t,e){super._initDom(t,e),Object.assign(e.style,{display:"flex",flexDirection:"column",width:"480px",height:"380px",minWidth:"300px",minHeight:"250px"}),Object.assign(e.style,{boxShadow:"3px 3px 8px #888"}),this._spanTitle=t.createElement("span"),this._spanTitle.className=HB.TITLE_CLASS,this._spanTitle.dataset.title="1",this._spanTitle.textContent="New TableBand",Object.assign(this._spanTitle.style,{display:"inline-block",flex:"0",width:"100%"}),e.appendChild(this._spanTitle),e.appendChild(this._container=t.createElement("div")),Object.assign(this._container.style,{display:"flex",gap:"8px",flex:"1 1 auto",width:"100%",overflow:"hidden"}),this._container.appendChild(this._dataContainer=t.createElement("div")),Object.assign(this._dataContainer.style,{display:"flex",flexDirection:"column",gap:"4px",flex:"1 1",height:"100%",border:"1px solid #ddd",boxSizing:"border-box"}),this.$_prepareData(t,this._dataContainer),this._container.appendChild(this._arrowContainer=t.createElement("div")),Object.assign(this._arrowContainer.style,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"10px",width:"50px",height:"100%",border:"1px solid #ddd",boxSizing:"border-box",paddingTop:"74px"}),this.$_prepareArrows(t,this._arrowContainer),this._container.appendChild(this._bandContainer=t.createElement("div")),Object.assign(this._bandContainer.style,{display:"flex",gap:"4px",flexDirection:"column",flex:"1 1",height:"100%",border:"1px solid #ddd",boxSizing:"border-box"}),this.$_prepareBand(t,this._bandContainer),e.appendChild(this._buttonContainer=t.createElement("div")),Object.assign(this._buttonContainer.style,{width:"100%",padding:"16px 0 0",textAlign:"right"}),this.$_prepareButtons(t,this._buttonContainer),e.appendChild(this._sizer=t.createElement("div")),Object.assign(this._sizer.style,{position:"absolute",right:"0",bottom:"0",width:"8px",height:"8px",background:"transparent",cursor:"nwse-resize"})}_doMeasure(t,e,s,i){return new Me(e.offsetWidth,e.offsetHeight)}_refreshBandFields(){super._refreshBandFields();const t=this._bandFieldList,e=this._currDst,s=this._upButton,i=this._downButton;if(e){s.style.display="",i.style.display="";const r=e.offsetWidth,n=0;e.appendChild(s),e.appendChild(i),J.move(s,r-s.offsetWidth-i.offsetWidth-4,n),J.move(i,r-i.offsetWidth-2,n),s.disabled=e===t.firstElementChild,i.disabled=e===t.lastElementChild}else s.remove(),i.remove(),s.style.display="none",i.style.display="none"}buttonClick(t){if(super.buttonClick(t),t===this._upButton||t===this._downButton){const e=this._bandFieldList,s=this._currDst;if(t===this._upButton){const t=J.getPrev(s);s.remove(),e.insertBefore(s,t)}else{const t=J.getNext(J.getNext(s));s.remove(),t?e.insertBefore(s,t):e.appendChild(s)}this._refreshBandFields()}}$_prepareData(t,e){let s=t.createElement("span");s.textContent="Band Data 선택:",e.appendChild(s);const i=this._dataList=t.createElement("select");i.style.marginBottom="12px",i.onchange=t=>{this.$_collectFields(),this._bandFieldList.innerHTML="",this._currSrc=this._currDst=null,this.$_checkArrows()},e.appendChild(i),s=t.createElement("span"),s.textContent="필드 목록:",e.appendChild(s);const r=this._fieldList=t.createElement("div");r.className=HB.FIELD_LIST_CLASS,Object.assign(r.style,{display:"flex",flexDirection:"column",gap:"4px",flex:"1 1 auto",background:"white",padding:"2px",border:"1px solid gray",overflow:"auto"}),e.appendChild(r)}$_prepareArrows(t,e){[">>",">","","<","<<"].forEach((s=>{let i=t.createElement(s?"button":"span");Object.assign(i.style,{whiteSpace:"pre",width:"32px",height:"25px"}),i.textContent=s,i instanceof HTMLButtonElement&&(i.className=HB.ARROW_CLASS,i.disabled=!0),e.appendChild(i)}))}$_prepareBand(t,e){let s=t.createElement("span");s.style.height="50px",e.appendChild(s),s=t.createElement("span"),s.textContent="Band 필드:",e.appendChild(s);const i=this._bandFieldList=t.createElement("div");this._bandFieldList.className=HB.FIELD_LIST_CLASS,e.appendChild(i),Object.assign(i.style,{flex:"1 1 auto",background:"white",border:"1px solid gray",padding:"2px",overflow:"auto"});let r=this._upButton=t.createElement("button");Object.assign(r.style,{position:"absolute",display:"none",padding:"0px 2px",fontSize:"10px"}),r.textContent="⬆",r=this._downButton=t.createElement("button"),Object.assign(r.style,{position:"absolute",display:"none",padding:"0px 2px",fontSize:"10px"}),r.textContent="⬇"}$_prepareButtons(t,e){let s=this._ok=t.createElement("button");s.disabled=!0,s.style.marginRight="8px",s.textContent="Create",s.onclick=()=>{this._end(!0)},e.appendChild(s),s=this._cancel=t.createElement("button"),s.textContent="Cancel",s.onclick=()=>{this._end(!1)},e.appendChild(s)}_end(t){if(this.container.activeTool=null,this._currDst=null,this._refreshBandFields(),this.container.hidePopup(this),t&&this._callback){const t=new tn(""),e=this._dataList.selectedIndex;t.data=this._dataList.options[e].text;const s=this._bandFieldList.children,i=s.length;if(i>0){t.colCount=i;for(let e=0;e<i;e++){let i=new ur("",s[e].textContent);i.setChildProp("col",e),t.header.add(i),i=new ur(""),i.value=s[e].textContent,i.setChildProp("col",e),t.dataRow.add(i)}}this._callback&&this._callback(t)}}$_buildDesinger(t){const e=t.report.designData.getNames();this._dataList.innerHTML="",e.forEach((t=>{const e=new Option(t,t);this._dataList.appendChild(e)})),this._bandFieldList.innerHTML="",this.$_collectFields()}$_collectFields(){const t=this._editor.report.designData.get(this._dataList.value);if(this._fieldList.innerHTML="",t){const e=this._editor.doc;t.getFieldNames().forEach((t=>{const s=e.createElement("div");s.className=HB.FIELD_CLASS,Object.assign(s.style,{position:"relative",padding:"1px 4px"}),s.textContent=t,this._fieldList.appendChild(s)}))}}}class UB extends HB{constructor(t){super(t,"simpleBandDesigner")}run(t,e){this._callback=e,t.showPopup(this),t.activeTool=new NB(this,t)}_getCssSelector(){return"rr-band-designer"}_initDom(t,e){super._initDom(t,e),Object.assign(e.style,{display:"flex",flexDirection:"column",width:"600px",height:"450px",minWidth:"400px",minHeight:"250px"}),Object.assign(e.style,{boxShadow:"3px 3px 8px #888"}),this._spanTitle=t.createElement("span"),this._spanTitle.className=QB.TITLE_CLASS,this._spanTitle.dataset.title="1",this._spanTitle.textContent="New SimpleBand",Object.assign(this._spanTitle.style,{display:"inline-block",flex:"0",width:"100%"}),e.appendChild(this._spanTitle),e.appendChild(this._container=t.createElement("div")),Object.assign(this._container.style,{display:"flex",flex:"1 1 auto",width:"100%"}),this._container.appendChild(this._dataContainer=t.createElement("div")),Object.assign(this._dataContainer.style,{display:"flex",flex:"1 1 auto",height:"100%",border:"1px solid gray"}),this.$_prepareData(t,this._dataContainer),e.appendChild(this._buttonContainer=t.createElement("div")),Object.assign(this._buttonContainer.style,{width:"100%",padding:"16px 0 0",textAlign:"right"}),this.$_prepareButtons(t,this._buttonContainer),e.appendChild(this._sizer=t.createElement("div")),Object.assign(this._sizer.style,{position:"absolute",right:"0",bottom:"0",width:"8px",height:"8px",background:"transparent",cursor:"nwse-resize"})}_doMeasure(t,e,s,i){return new Me(e.offsetWidth,e.offsetHeight)}buttonClick(t){}$_prepareData(t,e){}$_prepareButtons(t,e){let s=t.createElement("button");s.style.marginRight="8px",s.textContent="Create",s.onclick=()=>{this._end(!0)},e.appendChild(s),s=t.createElement("button"),s.textContent="Cancel",s.onclick=()=>{this._end(!1)},e.appendChild(s)}_end(t){if(this.container.activeTool=null,this.container.hidePopup(this),t&&this._callback){const t=new Aa("");this._callback&&this._callback(t)}}}var MB;!function(t){t.CLICK="click",t.DRAG="drag"}(MB||(MB={}));class kB extends l{constructor(){super(...arguments),this._items=[]}get count(){return this._items.length}get isEmpty(){return 0===this._items.length}get items(){return this._items.length>0?this._items.slice(0):null}get pageItems(){const t=this._items;if(t.length>0){if(t[0]instanceof Rr){let e=[];return t.forEach((t=>{e=e.concat(t.getCells(!0))})),e}return t.slice(0)}return null}get last(){return this._items.length>0?this._items[this._items.length-1]:null}get first(){return this._items.length>0?this._items[0]:null}get isSinlge(){return this._items.length<=1}get(t){return this._items[t]}forEach(t){for(let e=0,s=this._items.length;e<s&&!0!==t(this._items[e],e);e++);}indexOf(t){const e=this._items;if(t instanceof Ir){for(let s=e.length-1;s>=0;s--){const i=e[s];if(i instanceof Rr&&i.containsCell(t))return s}return-1}return e.indexOf(t)}find(t){const e=this.indexOf(t);return e>=0?this._items[e]:null}contains(t){if(this.indexOf(t)>=0)return!0;if(t instanceof Ir)for(let e of this._items)if(e instanceof Rr&&e.contains(t.row,t.col))return!0;return!1}clear(){return this._items.length>0&&(this._items=[],this._changed(),!0)}$_add(t){return!!(t&&this.indexOf(t)<0)&&(t instanceof Ir?this._items.push(t.table.getSelection(t)):this._items.push(t),!0)}add(t){return!!this.$_add(t)&&(this._changed(),!0)}addAll(t){if(t&&t.length>0){let e=!1;for(let s of t)this.$_add(s)&&(e=!0);return e&&this._changed(),e}return!1}removeAt(t){return t>=0&&t<this._items.length&&(this._items.splice(t,1),this._changed(),!0)}remove(t){if(t){const e=t instanceof Ir?this.indexOf(t):this._items.indexOf(t);return this.removeAt(e)}return!1}removeAll(t){if(this._items.length>1){const e=this._items.indexOf(t);if(e>=0)return this._items=[this._items[e]],this._changed(),!0}return!1}replace(t){return t=t||[],!J.equalArrays(t,this._items)&&(this._items=t.slice(0),this._changed(),!0)}resize(t,e){t.resizeTo(e)&&(this.removeAll(t),this._changed())}resizeBy(t,e,s){t.resizeBy(e,s)&&(this.removeAll(t),this._changed())}getLinkedTableColumns(t){if(this._items.indexOf(t)>=0){const e=this._items.filter((t=>t instanceof Fr));return y(e,t)}return[]}isSingleTableColumns(){const t=this._items[0];if(t instanceof Fr){return this.getLinkedTableColumns(t).length===this._items.length}}getLinkedTableRows(t){if(this._items.indexOf(t)>=0){const e=this._items.filter((t=>t instanceof xr));return y(e,t)}return[]}isSingleTableRows(){const t=this._items[0];if(t instanceof xr){return this.getLinkedTableRows(t).length===this._items.length}}_changed(){this.fireEvent(kB.CHANGED)}}kB.CHANGED="onSelectionsChanged";class VB extends Ap{constructor(t){super(t,!0),this._focusRequested=!1,this.addChild(this._pageHead=new Je(t,null,"PAGE","Report Page",Ap.PAGE_HEAD)),this.addChild(this._backHead=new Je(t,null,"BACK ITEMS","Page Back Items",Ap.BACK_HEAD)),this.addChild(this._frontHead=new Je(t,null,"FRONT ITEMS","Page Front Items",Ap.FRONT_HEAD)),this.addChild(this._editLayer=new iB(this.doc,this)),this._selections=new kB,this._selections.addListener(this)}onSelectionsChanged(t){this.invalidateLayout(),this._fireSelectionChanged(t.pageItems)}get editor(){return this.container}get activeContainer(){return this._activeConatiner}get activeContainerView(){return this._activeConatiner===this.model.page.backContainer?this.pageView.backFloatingView:this._activeConatiner===this.model.page.frontContainer?this.pageView.frontFloatingView:void 0}get focusedItem(){return this._focusedItem}set focusedItem(t){if(t!==this._focusedItem){const e=this._focusedItem;this._focusedItem=t,this._focusRequested=!0,this.invalidateLayout(),t&&this._selections.add(t),this.container.$_focusedChanged(t,e),this._fireFocusedChanged(t,e)}else t&&!this._selections.contains(t)&&this._selections.add(t)}get focusedElement(){return this._focusedItem instanceof Ri&&this.getElementOf(this._focusedItem)}get focusedItemElement(){const t=this.focusedElement;return t instanceof Mi?t:null}get focusedRequested(){return this._focusRequested}get selection(){return this._selections.items}get lastSelectedItem(){return this._selections.last}get zoom(){return this.editor.zoom}get editing(){return this.editor.isEditing()}get editLayer(){return this._editLayer}getFocusedElement(){const t=this.focusedItem;if(this.model){if(t===this.model.root)return this;if(t===this.model.page)return this.pageView}if(t instanceof Ii)return this.getElementOf(t)}itemOfDom(t){const e=this.pageView;return e.isDom(t)?e.model:e.itemOfDom(t)}focusCell(t){if(t&&t.parent instanceof Pr){const e=t.parent.parent.getCell(t.row,t.col);this.focusedItem=e}}getTableElementOfRow(t){return this.getElementOf(t.collection.table)}getTableElementsOfColumn(t){const e=t.collection;return e instanceof an?[this.getElementOf(e.table)]:e instanceof kr?this.getElementOf(e.band).getTableViews():void 0}getTableElementOfColumn(t){return this.getElementOf(t.collection.table)}getTableBandElementOfColumn(t){return this.getElementOf(t.collection.band)}getSelectedTableColums(t){return this._selections.getLinkedTableColumns(t)}canMoveTableColumns(t){return!0}getSelectedTableRows(t){return this._selections.getLinkedTableRows(t)}canMoveTableRows(t){return!0}focusParent(t){t instanceof Oi&&(this.focusedItem=t.collection)}_initDom(t,e){super._initDom(t,e),e.style.transformOrigin="0 0 0",this._pageBorders=[];for(let s=0;s<4;s++){const i=t.createElement("span");this._pageBorders.push(i),i.className=s<2?"rr-page-border-horz":"rr-page-border-vert",e.appendChild(i)}}_afterLayout(t){function e(t){i===t.model?t.dom.dataset.selected="":delete t.dom.dataset.selected}super._afterLayout(t);const s=this.model.page,i=this._activeConatiner=function(t){for(;t;){if(t instanceof dr)return t;t=t.parent}}(this.focusedItem)||s,r=this.pageView,n="0.2",o=VB.ACTIVE_ZINDEX,a=r.bounds;let A=a.x+1,l=this._pageHead;l.model=s,l.text="PAGE - "+Math.round(r.width)+" x "+Math.round(r.height)+" px",e(l),l.measure(t,a.width,a.height),l.setBounds(A,a.y-l.measuredHeight,l.measuredWidth,l.measuredHeight),A+=l.width+4,l=this._backHead,l.model=s.backContainer,e(l),l.measure(t,a.width,a.height),l.setBounds(A,a.y-l.measuredHeight,l.measuredWidth,l.measuredHeight),A+=l.width+4,l=this._frontHead,l.model=s.frontContainer,e(l),l.measure(t,a.width,a.height),l.setBounds(A,a.y-l.measuredHeight,l.measuredWidth,l.measuredHeight),r.sections.forEach((t=>t.dom.style.opacity="")),r.backFloatingView.dom.style.opacity="",r.frontFloatingView.dom.style.opacity="",r.sections.forEach((t=>t.dom.style.pointerEvents="none")),r.backFloatingView.dom.style.pointerEvents="none",r.frontFloatingView.dom.style.pointerEvents="none",r.sections.forEach((t=>t.dom.style.zIndex="")),r.backFloatingView.dom.style.zIndex="",r.frontFloatingView.dom.style.zIndex="",r.bodyView.findable=!1,r.backFloatingView.findable=!1,r.frontFloatingView.findable=!1,i===s.backContainer?(r.backFloatingView.findable=!0,r.backFloatingView.dom.style.zIndex=o,r.backFloatingView.dom.style.pointerEvents="",r.frontFloatingView.dom.style.opacity=n,r.sections.forEach((t=>t.dom.style.opacity=n))):i===s.frontContainer?(r.frontFloatingView.findable=!0,r.frontFloatingView.dom.style.zIndex=o,r.frontFloatingView.dom.style.pointerEvents="",r.backFloatingView.dom.style.opacity=n,r.sections.forEach((t=>t.dom.style.opacity=n))):(r.bodyView.findable=!0,r.sections.forEach((t=>{t.dom.style.zIndex=o,t.dom.style.pointerEvents=""})),r.backFloatingView.dom.style.opacity=n,r.frontFloatingView.dom.style.opacity=n)}onReportItemAdded(t,e,s,i){super.onReportItemAdded(t,e,s,i),i||this.editor.addMode&&0!=this.editor.addedCount||(this._selections.clear(),this.focusedItem=e instanceof Qi?e.item:e)}onReportItemRemoved(t,e,s){super.onReportItemRemoved(t,e,s),e instanceof Qi&&(e=e.item);const i=this.container,r=this.focusedItem;let n=e===r;!n&&e instanceof Ti&&(n=e.isAncestorOf(r)),n?(this.focusedItem=null,i.clearSelection()):i.isSelected(e)&&i.removeSelection(e),n?this.focusedItem=s:r instanceof Fi&&e instanceof Oi&&(this.focusedItem=null,this.focusedItem=r)}onReportItemsRemoved(t,e){super.onReportItemsRemoved(t,e);let s=!1;if(!(this.focusedItem instanceof Ir&&e[0]instanceof Ir))for(let t of e)if(s=t===this.focusedItem||t instanceof Qi&&t.item===this.focusedItem)break;s&&(this.focusedItem=null,this.container.clearSelection())}onReportCommandStackChanged(t,e){const s=null==e?void 0:e.source;this.editor.addMode&&0!=this.editor.addedCount||s instanceof Ii&&s.parent&&this.editor.setFocused(s)}onReportCellMerged(t,e){this._selections.clear(),this.focusedItem=e}onReportAlert(t,e,s){this._editLayer.showError(e,s)}$_layoutMask(){const t=this._editLayer;(t.visible=this.pageView.visible)&&(t.setRect(this.pageView.bounds),t.layoutContent())}_layoutPageBorders(t,e){let s=this._pageBorders[0].style;s.top=e.y+"px",s.width=t.width+"px",s=this._pageBorders[1].style,s.top=Math.floor(e.bottom)+"px",s.width=t.width+"px",s=this._pageBorders[2].style,s.left=e.x+"px",s.height=t.height+"px",s=this._pageBorders[3].style,s.left=Math.floor(e.right)+"px",s.height=t.height+"px"}_fireFocusedChanged(t,e){this.fireEvent(VB.FOCUSED_CHANGED,t,e)}_fireSelectionChanged(t){this.fireEvent(VB.SELECTION_CHANGED,t)}}VB.ACTIVE_ZINDEX="2",VB.FOCUSED_CHANGED="onReportFocusedChanged",VB.SELECTION_CHANGED="onReportSelectionChanged";class GB extends tt{get popup(){return this._popup}setPopup(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN;if(t!==this._popup&&(this._popup&&this.removeChild(this._popup),this._popup=t,t)){this.addChild(t),t.measure(null,this.width,this.height),t.applyMeasure();const i=this.container.width,r=this.container.height;isNaN(e)&&(e=(i-t.width)/2),isNaN(s)&&(s=(r-t.height)/2),t.move(e,s,!0)}}_initDom(t,e){}_getCssSelector(){return"rr-editor-popup-layer"}}const KB=[50,67,75,80,90,100,110,125,150,175,200,250,300,400,500];class WB extends Qv{constructor(t){super(t),this._defaultUnit=p.PIXEL,this._guardWidth=100,this._paddingTop=35,this._paddingLeft=45,this._zoom=100,this._handMode=!1,this._addStyle=MB.CLICK,this._started=!1,this._addShifted=!1,this._addedCount=0}_doDispose(){super._doDispose()}getEditProps(){return WB.PROPINFOS}getStyleProps(){}getSubStyleProps(t){}isDominantProp(t){return!1}getPlaceHolder(t){}getPropDomain(t){}getProperty(t){return this[t]}setProperty(t,e){this[t]=e}setItemsProperty(t,e,s){}getStyleProperty(t){}setStyleProperty(t,e){}setItemsStyleProperty(t,e,s){}isChildProp(t){return!1}getSubStyleProperty(t,e){}setSubStyleProperty(t,e,s){}setItemsSubStyleProperty(t,e,s,i){}isReadOnlyProperty(t){return!1}canPropAdoptDragSource(t,e){return!1}adoptPropDragSource(t,e){}isCollectionProp(){return!1}isEditableCollection(){return!1}isCollectionItem(){return!1}getPropertySources(){}getCollectionLabel(){}getPopupPropLabel(t){}get displayPath(){return"editor"}get reportView(){return this._reportView}get report(){return this._reportView.model}set report(t){this._reportView.model=t}get defaultUnit(){return this._defaultUnit}set defaultUnit(t){t!==this._defaultUnit&&(this._defaultUnit=t,this.fireEvent(WB.UNIT_CHANGED,t))}get guardWidth(){return this._guardWidth}set guardWidth(t){(t=Math.max(100,t))!=this._guardWidth&&(this._guardWidth=t,this.invalidateLayout())}get topPos(){return this._scrollContainer.scrollTop}set topPos(t){const e=Math.max(1,this._zoom/100);(t=Math.max(0,Math.min(this._editContainer.height*e-this._scrollContainer.height,t)))!=this.topPos&&(this._scrollContainer.scrollDom(this.leftPos,t),this.invalidateLayout())}get leftPos(){return this._scrollContainer.scrollLeft}set leftPos(t){const e=Math.max(1,this._zoom/100);(t=Math.max(0,Math.min(this._editContainer.width*e-this._scrollContainer.width,t)))!=this.leftPos&&(this._scrollContainer.scrollDom(t,this.topPos),this.invalidateLayout())}get zoom(){return this._zoom}set zoom(t){if((t=J.pickNum(t,0))===WB.ZOOM_PAGE_WIDTH)t=Math.floor(100*this.$_containerWidth()/this.reportView.dom.offsetWidth);else if(t===WB.ZOOM_FULL_PAGE){const e=100*this.$_containerWidth()/this.reportView.dom.offsetWidth,s=100*this.$_containerHeight()/this.reportView.dom.offsetHeight;t=Math.floor(Math.min(e,s))}else t=Math.floor(Math.max(50,Math.min(500,t)));if(t!=this._zoom){const e=this._zoom;this._zoom=t,this._reportView._dom.style.transform="scale("+t/100+")",this.invalidateLayout(),this._feedbackLayer.clearAction(WB.ZOOM_LABEL),this._feedbackLayer.showSpan(WB.ZOOM_LABEL,t+"%",10,10),this.fireEvent(WB.ZOOM_CHANGED,t,e)}}get addStyle(){return this._addStyle}set addStyle(t){this._addStyle=t}get handMode(){return this._handMode}set handMode(t){t!=this._handMode&&(this._handMode=t,this._addShifted=!1,this.endAdd())}get selectMode(){return!this._handMode&&!this.addMode}set selectMode(t){t&&(this.handMode=!1,this._addShifted=!1,this.endAdd())}get addMode(){return!!this._addType}get addType(){return this._addType}get addShifted(){return this._addShifted}get addedCount(){return this._addedCount}get focusedItem(){return this._reportView.focusedItem}set focusedItem(t){this._reportView.focusedItem=t}get focusedElement(){return this._reportView.focusedElement}get focusedItemElement(){return this._reportView.focusedItemElement}get marquee(){return this._reportView.editLayer.editMarquee}get selections(){return this._reportView._selections}get tableDesigner(){return this._tableDesigner||(this._tableDesigner=new LB(this.doc)),this._tableDesigner}get tableBandDesigner(){return this._tableBandDesigner||(this._tableBandDesigner=new QB(this.doc)),this._tableBandDesigner}get simpleBandDesigner(){return this._simpleBandDesigner||(this._simpleBandDesigner=new UB(this.doc)),this._simpleBandDesigner}showAlert(t,e){e&&this._reportView.editLayer.showError(t,e)}incZoom(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0!==t){const e=this.zoom;let s=-1;if(e>=KB[0]){s=0;for(let t=0;t<KB.length-1&&!(e>=KB[t]&&e<KB[t+1]);t++,s++);}t>0?s<KB.length-1&&(this.zoom=KB[s+1]):t<0&&s>0&&(this.zoom=KB[s-1])}else this.zoom=100}isEditor(t){return this._textEditor.is(t)}isEditing(){return this._textEditor.isEditing}showEditor(t){if(!this.isEditing()&&(t=t||(this.focusedElement instanceof Mi?this.focusedElement:null)))return this._textEditor.show(t,this._zoom/100)}hideEditor(t){if(this.isEditing())return this._textEditor.hide(t),this.setFocus(),!0}canMultiLine(){return this._textEditor.canMultiLine()}setFocused(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t!==this.focusedItem&&(e&&this.clearSelection(t instanceof Ri?t:null),this.focusedItem=t)}undo(){return this.report.undo()}redo(){return this.report.redo()}copy(){return this.fireConfirmEvent(WB.COPY)}paste(){return this.fireConfirmEvent(WB.PASTE)}cut(){return this.fireConfirmEvent(WB.CUT)}findDropTarget(t,e,s){const i=this._reportView.findElementOf(e);if(i instanceof Mi){const e=i.model;if(e&&e.canAdoptDragSource(t))return e}else if(i){const t=sl.getTable(i);if(t){return t.getCellOf(e,!1)}}}beginAdd(t,e){if(!this.addMode&&t)return this._addType=t,this._addShifted=e,!0}$_startDesigner(t){return this._addType===ln?(this.tableDesigner.run(this,(e=>{null==t||t(e)})),!0):this._addType===tn&&(this.tableBandDesigner.run(this,(e=>{null==t||t(e)})),!0)}endAdd(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2?arguments[2]:void 0;if(this.addMode){const i=e.model;let r;if(t&&e){if(this.$_startDesigner((t=>{if(t.canAddTo(i))try{this.report.defaultInit(t,i,e.offsetWidth,e.offsetHeight),this.report.addItem(i,t)&&(this._addedCount++,null==s||s(t),this.focusedItem=t)}catch(t){alert(t)}})))return void this.cancelAdd();if(r=new this._addType(""),r.canAddTo(i))try{this.report.defaultInit(r,i,e.offsetWidth,e.offsetHeight),this.report.addItem(i,r)?this._addedCount++:r=null}catch(t){alert(t),r=null}else alert("Can not add to this group."),r=null}return this._addShifted||this.cancelAdd(),null==s||s(r),r}}endAddCell(t,e,s,i){if(this.addMode){const r=t.model;if(r.getCellItemAt(e,s))return alert("Only one item can exists int a cell."),null;if(this.$_startDesigner((t=>{if(t.canAddTo(r))try{t.setChildProp("row",e),t.setChildProp("col",s),this.report.defaultInit(t,r,void 0,void 0),this.report.addItem(r,t)&&(this._addedCount++,null==i||i(t))}catch(t){alert(t)}})))return void this.cancelAdd();let n=new this._addType("");if(n.canAddTo(r))try{n.setChildProp("row",e),n.setChildProp("col",s),this.report.defaultInit(n,r,void 0,void 0),this.report.addItem(r,n)?this._addedCount++:n=null}catch(t){alert(t),n=null}else alert("Can not insert in a cell."),n=null;return this._addShifted||this.cancelAdd(),null==i||i(n),n}}cancelAdd(){if(this.addMode)return this._addedCount=0,this._addType=void 0,this._addShifted=!1,this.invalidateLayout(),this.fireEvent(WB.ADD_CANCELED),!0}getDisplayParent(t){if(t instanceof Ii){let e=t.displayParent;if(e instanceof Qi){if(e=e.displayParent,e instanceof Or&&t instanceof Ri)return e.getCell(t.row,t.col)}else e instanceof Fi&&(e=e.displayParent);for(;e&&!(e instanceof Ti)&&!(e instanceof Fi);)e=e.displayParent;return e}}findTable(t){if(t){const e=t.parentElement.parentElement.parentElement.parentElement,s=this.findElementOf(e);if(s instanceof sl)return s}}getEditMarquee(){return this._reportView.editLayer.editMarquee}getEditMarqueeTarget(t){var e;if(t){const s=null===(e=this._reportView.editLayer.editMarquee)||void 0===e?void 0:e.targetItem;return Kv.getTarget(s,t)||jv.getTarget(s,t)||Wv.getTarget(s,t)||zv.getTarget(s,t)||$v.getTarget(s,t)||Xv.getTarget(s,t)}}closeEditMarquee(){this._reportView.editLayer.closeEditMarquees()}get selectionCount(){return this.selections.count}isSelected(t){return this.selections.contains(t)}getSelection(){return this.selections.items}getSelectedItems(){return this.selections.pageItems}clearSelection(t){this.selections.clear(),t&&this.addSelection(t)}addSelection(t){const e=this.selections.first;(!e||e.canSelectedWith(t)&&t.canSelectedWith(e))&&this.selections.add(t)}addSelections(t){const e=this.selections.first;t.forEach((t=>{(!e||e.canSelectedWith(t)&&t.canSelectedWith(e))&&this.selections.add(t)}))}removeSelection(t){t&&this.selections.remove(t)}toggleSelection(t,e){if(t&&t!==this.focusedItem){const s=this.selections;if(t instanceof Ir){if(!e)return s.clear(),this.addSelection(t),!0;if(s.isEmpty)this.addSelection(t);else{if(!(s.first instanceof Rr&&s.first.table===t.table))return s.clear(),this.addSelection(t),!0;s.resize(s.first,t)}}else if(s.contains(t))this.removeSelection(t);else{if(s.first instanceof Rr)return s.clear(),this.addSelection(t),!0;this.addSelection(t)}}}selectAll(t){const e=this.selections,s=(t||this.reportView.pageView.model).getDescendants();s.length>0&&(s.forEach((t=>{this.addSelection(t)})),e.remove(t),this.focusedItem=s[0])}deleteSelection(){let t=this.selections.pageItems;if(t&&(t=t.filter((t=>!(t instanceof Ir)))),t&&t.length>0)return this._reportView.model.removeItems(t),!0}copySelection(){var t;const e=null===(t=this.getSelectedItems())||void 0===t?void 0:t.filter((t=>t.selectItem instanceof Ri)).map((t=>t.selectItem));if(e)return this.report.saveItems(e)}findSelection(t){return this.selections.find(t)}findReportElementOf(t){return t&&this._reportView.findElementOf(t)}pasteItems(t,e){return this.report.pasteItems(t,e)}isScrollContainer(t){return t.className===WB.SCROLL_CONTAINER_CLASS}isRuler(t){return this._vruler.containsDom(t)||this._hruler.containsDom(t)}focusCell(t){!t&&this.focusedItem instanceof Ri&&(t=this.focusedItem),this._reportView.focusCell(t)}showPopup(t){t&&(t.dom.style.zIndex=String(WB.POPUP_ZINDEX),this._popupLayer.setPopup(t))}hidePopup(t){t&&this._popupLayer.popup===t&&this._popupLayer.setPopup(null)}_createDefaultTool(){return new IB(this)}_doPrepareContainer(t){super._doPrepareContainer(t);const e=this.doc;this.addElement(this._scrollContainer=new tt(e)),this._scrollContainer.dom.className=WB.SCROLL_CONTAINER_CLASS,this._scrollContainer.setStyles({overflow:"auto"}),this._scrollContainer.dom.addEventListener("scroll",(t=>this.invalidateLayout(!0))),this._scrollContainer.addChild(this._editContainer=new tt(e)),this._editContainer.dom.className=WB.EDIT_CONTAINER_CLASS,this._editContainer.addChild(this._reportView=this._createEditView(e)),this._scrollContainer.addChild(this._textEditor=new FB(e,this)),this.addElement(this._vruler=new OB(e,this)),this.addElement(this._hruler=new TB(e,this)),this.addElement(this._guard=new mB(e,this)),this.addElement(this._feedbackLayer=new Mv(e)),this.$_prepareFeedback(e,this._feedbackLayer),this.addElement(this._popupLayer=new GB(e))}_doLayout(t){if(this._hruler.zoom=this._vruler.zoom=this.zoom,this.scrolling)return this._hruler.startPos=this._vruler.width+this._paddingLeft-this.leftPos,this._hruler.refreshView(),this._vruler.startPos=this._hruler.height+this._paddingTop-this.topPos,this._vruler.refreshView(),void this._guard.layoutContent(this._context);const e=this._reportView.model,s=e?e.paper.getPageSize():new Me(500,500);let i=t.clone();this._context.assets=e&&e.assets,this._feedbackLayer.setRect(i),(this._guard.visible=this._guardWidth>0)&&(this._guard.setBounds(i.x,i.y,this._guardWidth,s.height),i.leftBy(this._guardWidth)),this._hruler.setBounds(i.x,i.y,i.width,this._hruler.height),this._vruler.setBounds(i.x,i.y,this._vruler.width,i.height),this._hruler.startPos=this._vruler.width+this._paddingLeft-this.leftPos,this._hruler.refreshView(),this._vruler.startPos=this._hruler.height+this._paddingTop-this.topPos,this._vruler.refreshView(),i.leftBy(this._vruler.width),i.topBy(this._hruler.height),this._scrollContainer.setRect(i),i.set(this._paddingLeft,this._paddingTop,s.width,s.height),this._reportView.setRect(i);const r=this._reportView.$_layout(this._context,i.move());i.set(0,0,2*this._paddingLeft+r.width,2*this._paddingTop+r.height),this._editContainer.setRect(i),this._guard.measure(this._context,t.width,t.height),this._guard.layoutContent(this._context),this._reportView.focusedRequested&&(this._reportView._focusRequested=!1,this.$_makeFocusVisible(this._reportView)),this._started||(this._started=!0,this._isTesting?this.updateNow():setTimeout((()=>{this.updateNow()})))}_doAfterRender(){this._reportView.$_afterRender(this._context),this._reportView.$_layoutMask()}findElementAt(t,e,s,i){return t>=this._guardWidth?super.findElementAt(t+this.leftPos,e+this.topPos,s,i):super.findElementAt(t,e,s,i)}_createEditView(t){return new VB(t)}$_prepareFeedback(t,e){e.addSpan(t,WB.ZOOM_LABEL,"rr-edit-feedback-span")}$_makeFocusVisible(t){const e=t.getFocusedElement();if(!e||e===t||e===t.pageView||e===t.pageView.bodyView||e===t.pageView.bodyView.itemsView)return;const s=this.getDomPosition(e),i=this._hruler.visible?this._hruler.height:0,r=(this._vruler.visible?this._vruler.width:0)+this._guardWidth;let n,o=this.leftPos,a=this.topPos;if(s.y-i<0&&(a+=n=s.y-i-10,s.y-=n),s.y+s.height>this.height-20){const t=a,e=s.y;a-=n=this.height-20-(s.y+s.height),s.y+=n,(s.y-i<0||s.y+s.height>this.height-20)&&(s.y=e,a=t)}if(this.topPos=a,s.x-r<0&&(o+=n=s.x-r-10,s.x-=n),s.x+s.width>this.width-20&&!(e instanceof ll)){const t=o,e=s.x;o-=n=this.width-20-(s.x+s.width),s.x+=n,(s.x-r<0||s.x+s.width>this.width-20)&&(s.x=e,o=t)}this.leftPos=o}$_focusedChanged(t,e){const s=this._reportView.focusedElement;if(this._hruler.setFocusedElement(s),this._vruler.setFocusedElement(s),t instanceof Yn)t.chart.selectSeries(t);else if(e instanceof Yn||e instanceof Nn){(e instanceof Nn?e:e.chart).selectSeries(null)}}$_containerWidth(){return this._scrollContainer.offsetWidth-20-this.reportView.dom.offsetLeft}$_containerHeight(){return this._scrollContainer.offsetHeight-20-this.reportView.dom.offsetTop}}WB.ZOOM_PAGE_WIDTH=-1,WB.ZOOM_FULL_PAGE=-2,WB.POPUP_ZINDEX=yt.FEEDBACK_ZINDEX+1,WB.PROP_DEFAULT_UNIT="defaultUnit",WB.PROP_GUARD_WIDTH="guardWidth",WB.PROPINFOS=[{name:WB.PROP_DEFAULT_UNIT,category:Ws.EDITOR,type:As,domain:p,multiple:!1,default:void 0}],WB.ZOOM_LABEL="zoomLabel",WB.ZOOM_CHANGED="onReportEditorZoomChanged",WB.COPY="onReportEditorCopy",WB.PASTE="onReportEditorPaste",WB.CUT="onReportEditorCut",WB.ADD_CANCELED="onReportEditorAddCanceled",WB.UNIT_CHANGED="onReportEditorUnitChanged",WB.SCROLL_CONTAINER_CLASS="rr-scroll-container",WB.EDIT_CONTAINER_CLASS="rr-edit-container",WB.RULER_CLASS="rr-ruler";const zB=72/C.HTMLDPI;class $B extends A{constructor(t,e,s){super(),this._report=t,this.elementCreator=s,this._imageLoader=new cv,this._pages=this.$_build(e)}_doDispose(){super._doDispose()}get report(){return this._report}getModel(t){return this._report.models[t.dataset._m_]}getParent(t){for(;t;){if(t instanceof HTMLElement){if(this._report.models[t.dataset._m_])return t}t=t.parentElement}}addImage(t,e){this._imageLoader.add(t,e)}getImage(t){return this._imageLoader.get(t)}prepare(t){return this._imageLoader.load(t)}canExport(){return this._imageLoader.loaded}write(t,e,s){this._doc=t,this._font=e,this._fontBold=s;for(let e=0;e<this._pages.length;e++){const s=this._pages[e];this._offsetX=s.offsetX,this._offsetY=s.offsetY,s.write(this),e<this._pages.length-1&&t.addPage()}}getBounds(t){const e=t.getBoundingClientRect();return e.x-=this._offsetX,e.y-=this._offsetY,e.x*=zB,e.y*=zB,e.width*=zB,e.height*=zB,e}getTextBounds(t){const e=J.getTextRect(t);return e.x-=this._offsetX,e.y-=this._offsetY,e.x*=zB,e.y*=zB,e.width*=zB,e.height*=zB,e}getBox(t){const e=t.getBBox();return e.x*=zB,e.y*=zB,e.width*=zB,e.height*=zB,e}text(t,e,s,i,r){t=this.$_css(t);const n=this._doc,o=t.textDecoration,a=this.$_color(t.color),A=t.fontSize;let l=parseFloat(A);if(r={lineBreak:!1,lineGap:l<13?-1:-2,...r},"italic"===t.fontStyle&&(r.oblique=!0),isNaN(l)?l=$B.FONT_SIZE:A.endsWith("px")&&(J.isMac?l=Math.floor(l*zB)-(l<13?1:0):l*=zB),n.save(),n.fontSize(l),parseFloat(t.fontWeight)>=700?n.font(this._fontBold):n.font(this._font),a&&n.fillColor(a.color,a.opacity),0!=i&&n.rotate(i,{origin:[e.x+e.width/2,e.y+e.height/2]}),e.y-=.15*l,n.text(s,e.x,e.y,r),o&&o.startsWith("underline")){const t=n.widthOfString(s),i=n.currentLineHeight()-1;n.underline(e.x,e.y,t,i,{color:"black"})}return n.restore(),this}save(){return this._doc.save(),this}restore(){return this._doc.restore(),this}transformSvg(t){return this._doc.transform(t.a,t.b,t.c,t.d,t.e*zB,t.f*zB),this}translate(t,e){return this._doc.translate(t,e),this}scale(t,e){return this._doc.scale(t,e),this}clip(t){const e=this.getBounds(t);return this._doc.rect(e.x,e.y,e.width,e.height).clip(),this}clipRect(t){return this._doc.rect(t.x,t.y,t.width,t.height).clip(),this}path(t,e){return this.$_render(t,((t,s)=>{const i=this.$_color(s.fill),r=this.$_color(s.stroke),n=parseFloat(s.strokeWidth);(i||r&&n>0)&&(r&&n>0&&t.path(e).lineWidth(n).strokeColor(r.color,r.opacity).stroke(),i&&t.path(e).fillColor(i.color,i.opacity).fill())})),this}dline(t,e,s,i,r){return this.$_render(t,((t,n)=>{this.$_border(n,"top")&&t.moveTo(e,s).lineTo(i,r).stroke()})),this}rect(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.$_render(t,((t,i)=>{const r=this.$_color(s?i.fill:i.backgroundColor);r&&(t.fillColor(r.color,r.opacity),t.rect(e.x,e.y,e.width,e.height).fill())})),this}polygon(t,e){return this.$_render(t,((t,s)=>{const i=parseFloat(s.strokeWidth),r=this.$_color(s.fill);if(r&&(t.fillColor(r.color,r.opacity),t.polygon(...e).fill()),i>0){const r=this.$_color(s.stroke);r&&(t.strokeColor(r.color,r.opacity).lineWidth(i*zB),t.polygon(...e).stroke())}})),this}ellipse(t,e){return this.$_render(t,((t,s)=>{const i=this.$_color(s.fill),r=e.width/2,n=e.height/2;i&&(t.fillColor(i.color,i.opacity),t.ellipse(e.x+r,e.y+n,r,n).fill());const o=parseFloat(s.strokeWidth);if(o>0){const i=this.$_color(s.stroke);i&&(t.strokeColor(i.color,i.opacity).lineWidth(o*zB),t.ellipse(e.x+r,e.y+n,r,n).stroke())}})),this}border(t,e){return this.$_render(t,((t,s)=>{this.$_border(s,"top")&&t.moveTo(e.x,e.y).lineTo(e.x+e.width,e.y).stroke(),this.$_border(s,"bottom")&&t.moveTo(e.x,e.y+e.height).lineTo(e.x+e.width,e.y+e.height).stroke(),this.$_border(s,"left")&&t.moveTo(e.x,e.y).lineTo(e.x,e.y+e.height).stroke(),this.$_border(s,"right")&&t.moveTo(e.x+e.width,e.y).lineTo(e.x+e.width,e.y+e.height).stroke()})),this}image(t,e,s){return this.$_render(t,((t,i)=>{t.image(e,s.x,s.y,s),this.border(i,s)})),this}$_build(t){const e=[];for(let s of t){const t=new jB(this,s);e.push(t)}return e}$_render(t,e){t=this.$_css(t),this._doc.save(),e(this._doc,t),this._doc.restore()}$_css(t){return t instanceof Element&&(t=getComputedStyle(t)),t}$_color(t){let e=t,s=1;if(t.startsWith("#"));else{if(!t.startsWith("rgb"))return null;{const i=t.substring(t.startsWith("rgb(")?4:5,t.length-1).split(/\s*\,\s*/g);e="#";for(let t=0;t<3;t++)e+=J.pad16(parseInt(i[t]),2);i.length>3&&(s=parseFloat(i[3]))}}return s>0?{color:e,opacity:s}:null}$_border(t,e){const s="border"+J.capitalize(e),i=parseFloat(t[s+"Width"]);if(i>0){const e=this.$_color(t[s+"Color"]);if(e){const r=t[s+"Style"],n="dotted"===r?1:"dashed"===r?2:0;return this._doc.strokeColor(e.color,e.opacity).lineWidth(i*zB),n>0&&this._doc.dash(n),!0}}}}$B.FONT_SIZE=10;class XB{}class jB extends XB{constructor(t,e){super();const s=e.page.getBoundingClientRect();this.offsetX=s.x,this.offsetY=s.y,this._page=e,this._elements=this.$_build(t)}write(t){for(let e of this._elements)e.write(t)}$_build(t){const e=this._page,s=[];s.push(new YB(t,e.background)),s.push(new YB(t,e.pageHeader));for(let i of e.contents){const e=i instanceof HTMLElement&&t.getModel(i),r=t.elementCreator(t,e,i);r&&s.push(r)}return s.push(new YB(t,e.pageFooter)),s.push(new YB(t,e.foreground)),s}}class YB extends XB{constructor(t,e){super(),this._dom=e,this._elements=e instanceof HTMLElement?this._build(t,e):void 0}write(t){if(this._doBeginWrite(t,this._dom),this._doWrite(t,this._dom),this._elements)for(let e of this._elements)e.write(t);this._doEndWrite(t,this._dom)}_doBeginWrite(t,e){}_doEndWrite(t,e){}_doWrite(t,e){if(e instanceof HTMLElement){const s=t.getModel(e),i=t.getBounds(e),r=getComputedStyle(e);if(e instanceof HTMLSpanElement){let n=e.textContent;n&&(s instanceof ur&&s.wrap?t.text(r,i,n,0,{width:i.width+2,align:r.textAlign}):"right"===r.textAlign?t.text(r,i,n,0,{width:i.width,align:"right"}):t.text(r,i,n,0))}else if(e instanceof HTMLElement&&"B"===e.tagName){let s=e.textContent;s&&t.text(r,i,s,0)}else(s instanceof Ti||s instanceof ur||s instanceof Ba)&&t.rect(r,i).border(r,i)}}_build(t,e){const s=[],i=e.children;for(let e=0;e<i.length;e++){const r=i[e],n=(r instanceof HTMLElement||r instanceof SVGSVGElement)&&t.getModel(r),o=t.elementCreator(t,n,r);o&&s.push(o)}return s}}class JB extends YB{_needClip(){return!1}_doBeginWrite(t,e){this._needClip()&&(t.save(),t.clip(e))}_doEndWrite(t,e){this._needClip()&&t.restore()}_doWrite(t,e){const s=t.getBounds(e),i=getComputedStyle(e);t.rect(i,s),t.border(i,s)}}class ZB extends YB{_build(t,e){const s=[],i=e.childNodes;for(let e=0;e<i.length;e++){const r=t.elementCreator(t,null,i[e]);r&&s.push(r)}return s}}class qB extends YB{_doWrite(t,e){const s=t.getTextBounds(e),i=getComputedStyle(e.parentElement);let r=e.textContent;r&&t.text(i,s,r,0)}}class tE extends YB{constructor(t,e,s){super(t,e),this._model=s}_build(t,e){}_doWrite(t,e){const s=t.getBounds(e);t.rect(e,s)}}class eE extends YB{constructor(t,e){super(t,e)}_build(t,e){}_doWrite(t,e){const s=e.toDataURL();if(s){const i=t.getBounds(e);t.image(e,s,i)}}}class sE extends YB{constructor(t,e,s){super(t,e),this._model=s}_build(t,e){}_doWrite(t,e){const s=t.getBounds(e),i=this._model.getChecked(this._model.checked),r="0"===i?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAACXBIWXMAAA/XAAAP1wHWM14/AAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTAzLTMwVDE5OjA2OjQzKzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wMy0zMFQxOTowNzozMCswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wMy0zMFQxOTowNzozMCswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1ZmUyOTFjMy1iNTM0LTIwNGMtODYyNC0wMTE3MmEzYjJhZTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NWZlMjkxYzMtYjUzNC0yMDRjLTg2MjQtMDExNzJhM2IyYWUzIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NWZlMjkxYzMtYjUzNC0yMDRjLTg2MjQtMDExNzJhM2IyYWUzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1ZmUyOTFjMy1iNTM0LTIwNGMtODYyNC0wMTE3MmEzYjJhZTMiIHN0RXZ0OndoZW49IjIwMjEtMDMtMzBUMTk6MDY6NDMrMDk6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4yIChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7vzoxhAAAOmElEQVR4nO3d3+v2d0HH8dd7u9fWXKkD++Eii7DsF4QdFBvVrHApZUoHri2CgiBnRgQdhVEnUUEHY2FiURGRkVMcTHIOm2ZBsHL9PMicSgc21y83JbzV7d3B9ZXcD+/d9319v/f7e31ej8df8Dr7PK/r+rzf15hzBgDoctnqAQDApScAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACo0kv7Z6BACb8ViS2+ecD68ewrmNJHP1CAA24WySH5tz3rl6CM/szOoBAGzCo0leOee8b/UQzo8AAGBfH0vysjnnA6uHcP4EAAD7eDDJTXPOB1cP4cI4BQDAxXogyQ0e/odJAABwMe5LcuOc82Orh3BxBAAAF+rO7H7zf3T1EC6eAADgQvx2klfPOc+uHsJ+BAAA5+uX55y3zTkfXz2E/TkFAMAzeTzJa+ecb1w9hOMjAAA4l7NJbp1zvnX1EI6XAADgC3k0yQ/POd+zegjHTwAA8HQeyu5N/79bPYSTIQAAeLIHk7x0zvmh1UM4OU4BAPD53p/keg//7RMAAHzOn2d3u9/Dq4dw8gQAAEnylux+8//E6iFcGgIAgDckuXnO+enVQ7h0BABAt1+ac77W7X59nAIA6PR4ktfMOd+0eghrCACAPmeT3DLnfNvqIawjAAC6PJLd7X7vXT2EtQQAQI+HkvzAnPPvVw9hPQEA0OGD2d3u9+HVQzgdnAIA2L6/TXKDhz+fTwAAbNu7k7zE7X48mQAA2K4/TfJyt/vxdAQAwDb9VpIfdbsfX4gAANie1885X+d2P87FKQCA7Xgsu9v9fmf1EE4/AQCwDZ/K7iv/t68ewmEQAACH75Ekr5hz/sXqIRwOAQBw2P49u9v9/mH1EA6LAAA4XP+a3e1+H1k9hMPjFADAYfqb7G73+8jqIRwmAQBweO7N7na//1g9hMMlAAAOy58k+cE55ydXD+GwCQCAw3FHklvc7sdxEAAAh+EX55w/O+ecq4ewDU4BAJxujyX56Tnn764ewrYIAIDT61NJbp5z3rV6CNsjAABOp49nd7vf+1YPYZsEAMDp89Hsbvf7x9VD2C4BAHC6fCDJTS744aQ5BQBwetwft/txiQgAgNPhXUm+d875n6uH0EEAAKz35rjdj0tMAACsdXuSW+ecn1k9hC5beAnwgSS3rR4BcBE+Ped8/+oRdNpCADw65/zr1SMA4JD4CQAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAAA4pzHGWL2B43dm9QAATqfPPfjnnHP1Fo6fbwAAeIoxxpXzyOotnAwBAMATjDGePec8u3oHJ0sAAJAkGWNcPsZ4/pzzkdVbOHkCAICMMa5K8tVzzo+u3rKvMcZzVm84BAIAoNwY47lJnj/n/PDqLfsaY3xLkreu3nEInAIANmmMMbzAdm5Hb/lfl+SyOeeHVu/Z1xjj+iR3J3l49ZZD4BsAYHPGGFcned7qHQfgG5J8ds75b6uH7GuM8bIk9yZ57uoth0IAAJty9Kn2hUm+dPWW02rsvDjJw3POh1bv2dcY45YkdyW5evWWQyIAgE05+tr/n5N8fPGUU2mMcVmSG5J8YM7536v37GuM8TNJ/ijJFau3HBoBAGzOnPOzSf7r6GHHkTHGmSTfn+T+OecnV+/Z1xjjV5LckcRVxRfBS4DAJh19E+AlwCNHx/xuTHLvnPOxxXP2chR2dyS5bfWWQyYAADZujPHFSb57zvnO1Vv2Nca4IskfJrl59ZZDJwAANmyMcU2Sb59z3rN6y77GGM/K7oz/Tau3bIEAANioowfmN84537t6y77GGNcmeUeS71y9ZSsEAMAGHX3y/5o55/2rt+xrjHFdknuSfPPqLVsiAAA25uiFv6+Yc/7T6i37GmO8MLsLfl6wesvWOCIDsCFHL8ldO+f84Oot+zq6rOgv4+F/IgQAwEaMMS5Pcs1G/tHvxiT3JfmytUu2SwAAbMDR2fgr55z/s3rLvsYYr0zyZ3Gd84kSAAAH7uj/Dy6fc/7v6i37GmP8RJI7k1y1esvWCQCAwzfmnJ9ZPWJfY4xfSPJ7SS5fvaWBAAA4cHPOx1dv2NcY49eT/MbqHU0cAwRgmaMXF9+U5CdXb2kjAABYYoxxZZI3J3nV6i2NBAAAl9wY40uS3JXkJau3tBIAAFxSY4znJXlnkhev3tJMAABwyYwxXpDkXUm+fvWWdk4BAHBJjDG+KclfxcP/VBAAAJy4McZ3JHlfkutWb2FHAABwosYYL03y7iTXrt7C/xMAAJyYMcark9yd5Fmrt/BEAgCAEzHGeE2SP05yxeotPJUAAODYjTFen+QN8Zw5tRwDBODYHP0z4e1JXrd6C+cmAAA4FmOMK5L8fpJbV2/hmQkAAPY2xrg6yVuSvHz1Fs6PAABgL2OM5yR5R5LrF0/hAggAAC7aGOMrk9yT5FtXb+HCCAAALsoY4+uS3Jvka1dv4cI5ngHABRtjfFt29/p7+B8oAQDABRljfFeS9yT58sVT2IMAAOC8jTF+KLu/83326i3sRwAAcF7GGD+e5G1Jrlq9hf0JAACe0Rjj55P8Qbw8vhkCAIBzGmP8apLfTDJWb+H4KDkAntYY47Ikb0zyU6u3cPwEAABPMcb4ouz+yvdHVm/hZAgAAJ5gjHFNkrcn+b7FUzhBAgCAJ7s7yfesHsHJ8hIgAE/2otUDOHkCAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACp1ZPeAYfNUY4+dWjwDYkKtXD+DkjSRz9QgAOEb/Mud80eoRp52fAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACp1J8qrVIwDgGH1i9YBDMOacqzcAAJeYnwAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBCAgAACgkAACgkAACgkAAAgEICAAAKCQAAKCQAAKCQAACAQgIAAAoJAAAoJAAAoJAAAIBC/wcVCcUnTpFFpAAAAABJRU5ErkJggg==":"-1"===i?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAACXBIWXMAAA/XAAAP1wHWM14/AAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTAzLTMwVDE5OjA2OjQzKzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wMy0zMFQxOTowOTowNCswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wMy0zMFQxOTowOTowNCswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpiMzI0ZTM5OS1iZmU1LTA5NDAtOGFjOS1hYzc2YWZmYTU0NWUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6YjMyNGUzOTktYmZlNS0wOTQwLThhYzktYWM3NmFmZmE1NDVlIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YjMyNGUzOTktYmZlNS0wOTQwLThhYzktYWM3NmFmZmE1NDVlIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiMzI0ZTM5OS1iZmU1LTA5NDAtOGFjOS1hYzc2YWZmYTU0NWUiIHN0RXZ0OndoZW49IjIwMjEtMDMtMzBUMTk6MDY6NDMrMDk6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4yIChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7jm/kdAAAVl0lEQVR4nO3dvY8l2VkH4LfnYwdsvDK7CBBgI2PYtu8KAYYAZAnWJBCtWJGQkRghUgKEhEREAEgkgLBwiMgcICQSCBD4T7Dlwhe0AsmkuzIIix0vM03Q0zs9PdPd9+PU+XqfJ117uvreqvP7nbfq3j45OzsLACCXO60PAACoTwEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgIQUAABISAEAgITubZflrPVBADCdk5Y//HSzafnjh2ACAEBpTcOf3SgAAJQk/AehAABQivAfiAIAQAnCfzAKAADHEv4DUgAAOIbwH5QCAMChhP/AFAAADiH8B3ev9QEAMBTBPwkTAAB2JfwnogAAsAvhPxkFAIDbCP8JKQAA3ET4T0oBAOA6wn9iCgAALyL8J6cAAHDV0OF/utm0PoQhKAAAXCb8k1AAALgg/BPxTYAADB38EcL/ECYAALkJ/6RMAADyGjr8Bf9xTAAAchL+ySkAAPkIfxQAgGSEPxHhGQCATIYNf8FfngkAQA7Cn2coAADzE/48RwEAmJvw54U8AwAwJ8HPjUwAAOYzbPhTjwkAwFyGDX87/7pMAADmIfzZmQIAMAfhz14UAIDxCX/2pgAAjE34cxAFAGBcwp+DKQAAYxL+HEUBABiP8OdovgcAYBzDBn+E8O+NCQDAGIQ/RSkAAP0T/hSnAAD0TfizCgUAoF/Cn9UoAAB9Ev6sSgEA6I/wZ3UKAEBfhD9VKAAA/RD+VOOLgAD6MGz4C/4xKQAAbQ0b/BHCf2SzFIChLyCAEQn/sXkGAIC9Cf/xKQAA7EX4z0EBAGBnwn8eszwDAMCKBP98TAAAICETAACuZec/LxMAAF5I+M9NAQDgOcJ/fgoAAM8Q/jkoAAB8QPjn4SFAAAR/QiYAAMkJ/5xMAACSEvy5KQAwsdsW+O2yVDoSeiP8UQBgAhZz9uF8IUIBgCFYsCnBecRlCgB0xALNWpxbXKUAAExM8HMdBQAqshhTk/ONmygAkNjlgPCJgHkIfnahAMABZlxgZ/yd9jFLAcr+PrI7BQBuYUGd2yzBH+FcZT8KAOlZNJmB85h9KQCkYYHkMjt/svPHgAAGJvw5lAkAw7HgcYiZdvwRrgOOpwDQNYscPM91QQkKAF2woMFuXCuUogBQhUWLFoz94XoKAEVZoGAdri1KUwA4mAWJ3sy247/gWmMNCgC3svhAG6491qQAYJGBDrkuWZsCkICFhNnNNvp3zVKDAtCQixy4zJpATQoA0L3ZdvgvIvypTQEAaEjw04o/BgTQiPCnJQUAoAHhT2sKAEBlwp8eeAYAoBLBT09MAAAqEP70RgEAWJnwryvDx0ZLcAsA6NboC7ngr2/0c6YmEwCAFQj/+oT/fkwAgO6MvpAL//pGP2daMAEAKEj41yf8D2MCADQ3ywIu/Oub5dxpwQQAoADhX5/wP44JAMABBH5bwv94CgDAjoR+e4K/HAUAaGaExVzo92OE82UkngEAuIbw74fwL88EAKiu98Vc8Pej93NlZCYAAJcI/34I/3WZAACrGW0BF/79GO3cGZEJAEAI/54I/zpMAIDUBH8/BH9dJgBAWsK/H8K/PhMA4CijLtzCvw+jnj8zMAEA0hH+fRD+bSkAQCrCvw/Cvz23AICDjLiAC//2RjxvZqUAADsbefEW/u2NfP7MyC0AYHrCvz3h3x8TAIpxgd9MCLXhdW/LutAvBYCjucB3c/l16jmUvJ+U4lzqmwLAQVzYjKDnojU7a0T/FAB25oIu5+K1FFDr8dq2YZ0YhwIwKBcZXE/4t2FdGosCMBgX2FxaTAJmP4eEf32zn1OzUgASuGlBdOEyE+FfnzVkXArAAA65wHZdCK/+71zMjEr412e9GJsCMJljF8GL/78Lu67tsgiwI3jt6rI+zEEB6Ng+F1npBfB0s3GRT2D291Dw1zf7OZWJAjC4NRdA0wB6Iuzbsg7MRwHo1C4XW60F0TSgjl1uA2R6HwR+PzKdd5koAIOqvTgqAdQg9Pvimp+bAjCg3hbJXY7HQrKbzA8DZv29e+R6zUEB6MxtF17LRfLyFGDf4/A8AdcR/H2Z5Bo9i4iT1gfROwVgID0slKU+ZhgxzULDEXo4p3lqkmvyrPUBjOJO6wPgqZsuvhkXyhl/pxImWYRv5f3vx3ZZTiY574T/HkwAGprkgjuKhwuv53Whhu2y3I2IR62PowDhvycTgAHMvlOa/fc7xOzh7z3vw3ZZXg7hn5YC0LksC2WW3xPvdQ+ejPw/FRH/3fpYChD+B1IAOpZtocz2+0IL22W5FxFvRsTXWx9LAcL/CApAp4QhUNp2Wb4rIn43Iv629bEc6SyE/9EUALqi+MzN+9vOdlk+GRH/ExF/0PpYjiT4C/EpgA5ZJIFStstyJyJ+PiL+qfGhlCD8CzIBAJjUdlm+MyJ+M4Q/L6AAdMbu32sAx3rylP8PRMQfRcQXWh9PAcJ/BW4BdETwMTPndx3bZTmJiJ+J83v9v9T4cEoQ/isxAQCYxJNv9fu1iPirEP7cQgHohN3Rs7we85n92w1b2y7LhyPi9yPizyPi040PpwThvzK3AAAGt12W742IP4mIX42IDzU+nBKEfwUKQAfsdoFDbZflE3H+oN8vRsRLjQ+nBOFfiQLQmPAHDvHkYb/XI+JP4/xz/jOs58K/Is8A0CX3i+fkfS3qMxHxxRD+HGiGk2ZYdv/Avp7s/H82Iv4szkvA6Bs5wd+IAgAwiCfh/9k4v+f/440PpwTh39DozXFYdv9k5TbAYZ6E/y+E8KcQBYDuCIg+nW42xYqr9/ggPxcRfxHCn0LcAmjA7p/e3XSOvui/CfR1bZflNM7v+c+weAj/TigAwAcOLacX/79di4ASvLvtsnwkIv4wIn669bEUIPw74hYAXbGTbKPUeF+wl/Xkvv+vR8RbrY+lAOHfGROAyiyQ1xP+9a1xPt42DXAN7OVH4/y7/Ucn/DtkAgCs4pqgP6l9HKPaLstLEfFvrY+jAOHfKQUAEir5RP9tP+eS7z7dbITBDp6M/r/d+jgK8H53TAGoyOjzesb/9TQ6Dz8aEd9s8YMHNUNwzvA7TM0zAHThcigpA+toVUCf/NxvNvnhA5rg/Bf8g1AA6M7VoJpgQWzO9GkME5zrwn8gCgDd2/cz5jwl+Mcxwfkt/AfjGYBKLMTH8xrux+s1DuFPCwpAJRNc4F2o9fT6yLxGY5lgbRD+g1IAKrEgU4PzjMqE/8AUAIYk6J7nNRnLdllG3/0L/8EpAAxL4J0z8h/P4MEfIfynoAAwtOzBl/33H5HwpxcKAAxK+I9H+NMTBYDhZQtCI/8xCX96owBUMsHFTwcE/3gmeNgvQvhPyTcBwiCE/3gEPz0zAWAKs4fj7L8fXRL+k1MAoHPCf0yD7/6FfwIKQEWDLwg0IPyBtSgA0CnhPy5lnxF4CBA6I/iBGkwAKrMz4CbCf3yucUahAEAnhP/4hD8jUQAasEhwlfAHavMMAOlcDtseypjwn0MP5xLsQwFoZLssFv5Kbnqdr/632ou4c2AOwp8RKQANKQHlvGgBPuS1rTkd8N7PQfgzKs8ANGbxWEeJcF0zoIU/0JoJAFMpHawX/17Joib856HAMzITgA5M8udCm7l47UbYsQv/ebhmGd3J17/2tRn+6MNJ6wMoSUj065hF3/s6jwThP3wunG42U+XCGkwAoALhP48E4U8SCkCH3BLo17GfLADohQLQsYsioAz0ZZ9AF/5zcS0yE58CGMTVheeGL7C5f7rZvF/nqLiJ8J+L8Gc2CsCgbliM3t8uy8npZjP8Qzw9O91sbgwE4Q/0zi2AOQn/hoT/fOz+mZECAAUJ//n0Hv6nm43zjoMoAJPqfdGCEfR8HQl+jqUAwIGuLr4W47n0HP5QgocAoQDhTw3OM0oyAZiYHUwdFuX5jHbtjHa89EEBmJyFYV3Cfz49XjPu97MGBSCBHhc0ANpSAJJQAuB2vV0ndv6sSQEAiP7CH9bmUwCJXCxwdhTwrN7C3zVKDQpAQooAPNVT+LsmqcktgMR6WvgAqEsBSE4JILNezv9jHvbr5XdgPAoAkJLgJDvPABDbZXHvkVR6CH/XHK2ZABARfSyIUINzHc6ZAABp9BD+dv70wgSAD/SwOAJQhwLAM5QAZtX63Pa1vvRGAeA5rRdKKK3lOS346ZUCwAspAczCuQwvpgBwLQsno7Pzh+spANxICQCYk48BAlNqVV7t+hmFCQC3MgUAmI8JADCd2qXVrp8RmQCwE1MARlHzXPWgHyNTAAAgIQWAnZkC0DvnKOxOAWAvFlh65dyE/XgIkL1tl8V9T7pSK/yd98zEBCCZUguY3Ra9WPtcvHjQT/gzGwUgoVKLmRJAa9nPwey/P8dxCyCJtXYvFwuQ3RG11dj5w8wUgInVXMA8F0ANdrxQjgKQ2NXAPnZxPXQasF2Wk4i4d7rZvH/UATAtwQ/lKQA3sKM9zIsW68uv5UXgR8RHIuJjEfHpiPjWdln+7nSzOat0mHTKH/GBOhQAPnCxAK6xAF/8m2dnZ791cnLyckR8f0R8PCJ+OCJejYh/jIi/j4hvF//hDMNOH+pRAKjq5OTkC48fP37nzp07DyLipYi4GxFnEfGpiPi+iPhGy+OjnRbhb9dPZj4GyHPW/szznTt3Xn348OH9iLgf5+fg3Yj4oYj4zGo/lK7Z+UN9CgBNPHjw4ME77777X2dnH9zyfzUi3tguy/2Gh0UDrXb+dv9kpwBwrbUXyVdfeeWjy7L8++PHjyMiviMiPhsRP7baDyQ9wQ9PKQA09frrr//IP3/5y1959OjR3Yj4ZET8ynZZPJuSwHZZjP6hIQWAW629a/rcG2/8xNtvv/2NiHg5It6MiJ9c7YfRBcEP7SkAdOG11177+KNHj07i/DsBPr9dlldaHxPrEP7QB6NWdnbly3yK//t37969FxGPI+KXI+JftsvyxdPN5n+L/yBScK8fbmYCQG/uRMQPRsRvRMRb22V50Ph4KKjG7t+DfrAbBYCDrLzI3o+I04j47Yh4c7ssH1rrB1GP0T/0xS0AjrLi1wffj/OvBf69iHhluyxfOt1s3i39Q6ij1s4f2J0CQM9eioj3I+J3IuIT22X564j419PNxt8LADiSAkARK08CHsf5MwE/FRFf2i7LP0TEf55uNo9L/zDKWnvnb9cPh1MAGMGdOP+DQZ+L848Jfiwi/jgivtXyoGhH8MPxFIAbbJfFQrOnFT8qeBLnJeB7IuLDEfF/Jf9xyvPQH/RNAWA1K9wWOImIdyLiP+L82QA6tVb4K+RQjgLAaF6NiLfifBpAh0qHv9CHdSgArK7UJOBSEPzNcUfEWoz9YRy+CIhq7OTmtkb4O2dgPQoAcDQ7fxiPAgAcRfjDmBQA4GDCH8blIcBb+C6Ask43G6ExiRLvo2sL2jEBAICEFACq8/fax2eKA+NTAHZgsYNz22VxPcAkFAAASEgBoBm3AcZi598X7wfH8ikA4FYFv8YZ6IQJAE0Jhv7ZacKcFADgWsIf5qUAAC8k/GFungGgOd8O2B/f8gfzMwEAnqGMQQ4KAF3w7YB9EP6QhwIARITwh2wUgB1ZHJmZ8xvyUQDoilsB9Ql/yEkBgMSEP+SlANAlU4D1Cf8x+YuMlKIAQEICBFAA6JbnAdYh/IEIBWAvFk5GVnN0rLhB/3wVMN0TJgDlmQBAAqZXwFUKAExO+AMvogDAxIQ/cB0FYE8WVEbQ8rPintmAMSgAMBklFdiFAgATEf7ArnwMECbROvyN/tfX+j1mLiYAMAHBAOzLBAAG1kvw2/3DeEwAYFC9hD8wJhMAGIzgB0owAYCB9Bj+xv8wJgUABtFj+APjcgsABtBj+Nv5w9hMAKBzPYY/9TkPKM0EADrV84Jv9w/jMwGADvUc/sAcFADojPAHanALADoxQvAb/cM8TACgAyOEPzAXEwDogJ01UJsJAAAkpAAAdM4tItagAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACTkjwExLF+PWp4/SgR5KACA4IeE3AIAgIRMACAxO3/ISwFgWMeEl+cHgOwUAEjIzh/wDAAAJGQCAEnY9QOXKQCkJAyB7NwCAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAICEFAAASEgBAOjYdllaHwKTUgAAICEFAAASutf6AABqMU6HpxQAYEjCHI6jAADdEe6wPgUAqEKoQ18UAKAIAQ9jUQCAZwhyyEEBgASEOnCVAgADEujAsRQAaECAA60pAHANIQ3MTAFgWgIc4HoKAMMQ6ADlKAB0Q8AD1KMAsCqhDtAnfw4YABIyAeAodvgAY1IAuJZwB5iXApCYgAfISwGYgCAHYF8KwAAEPAClKQCNCXcAWlAAKhL2APRCAViZ0AegRwrAnk43m2v/m7AHYBQKwJGEPgAjUgD2JPABmIG/BQAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACSkAAJCQAgAACd1rfQCFnLU+AAAYiQkAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAABAQgoAACSkAAAwlYcPH561PoYRKAAATOO999575ytf/epftj6OEZycnSlKAJCNCQAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBCCgAAJKQAAEBC/w+cQjvNwRAEYgAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAP0QAAD9EBVjAapAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAACAASURBVHic7d1nmG11eb/x+7G3RFM0Go2ixt67EVRQAQFRigqCEsWKgD0kxlhjibFSLLEEe0NREEFQaQLRvwVb7ChW7Aoi0s55/i/WHnKEc6btvedZa/3uzzvxnJnvdeHlumdm72ciM5EkSW25XPUASZK09gwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIkrQGIuKKEfHX1TsWGACSJM1ZRFwdOAo4NSKuX70HIDKzeoMkSaM1+ar/aOBuk390BrBVZv6obpUBIEnS3ETEjYBjgVtc6r86ky4CzlzrTQv8EYAkSXMQEbcFTuOyD3+AzYCTIuKmazpqAwaAJEkzFhFbAJ8G/naRP3ZDugi4+dqs+lMGgCRJMxQRDwaOA661jD9+fboIuNV8V12WASBJ0oxExN7A4cBVV/DXrgucOPmRwZoxACRJmoGIeDbwVuDyq/jr1wFOiIg7znbVpvkuAEmSphARAbwGeOoMPtxvgG0y8wsz+FiLMgAkSVqliLgi8HbgETP8sL8DHpiZn53hx7wMA0CSpFWIiGsAHwK2mcOHPwfYLjNPm8PHBgwASZJWbCPX/ebhXGCHzDx5Hh/cFwFKkrQCEbEZcCrzffgDXAM4JiLuN48PbgBIkrRMEXE7uof/Wh3vuRpwVETM/McMBoAkScsQEfcGTmbx637zcFXgyIjYYZYf1ACQJGkJEfEQln/dbx6uDBw+2TETBoAkSYuIiMfRvdr/KsVTrgQcFhG7zuKDBfAfs/hAkiQB64ADM/MX1UNmISL+FXhJ9Y5LuRh4VGa+b5oPEoDvA5QkzcIFwCMz84PVQ6Y1ue53ILB/9ZZNWAc8JjPfudoPYABIkmbhHGCnzDyhesi0IuJKdNf9dq/esoT1wOMy89DV/GUDQJI0rZ/TXa07vXrItCbX/Q4Htq7eskwJPCkz37TSv2gASJKmcQawbWaeUT1kWhFxbbrrfnet3rJCCeyfma9byV/yXQCSpNU6Hdh8JA//zegO/Azt4Q/dF/OHRMTTV/KXDABJ0mqcAGyZmT+vHjKtiLg9cBpws+otU3p1RByw3D9sAEiSVuqDdD/zP6d6yLQi4j501/2uV71lRl4eEc9Zzh80ACRJK/EGYLfMvKB6yLQiYifgWOCa1Vtm7MUR8cKl/pABIElarhdk5pMzc331kGlFxOPpvpNRfd1vXp4XES9d7A/4LgBJ0lLWA/tm5hurh8zC5FvkL67esUZelZnP2th/YQBIkhZzAbBnZn6oesi0IuJydNf99qvessYOysynXvofGgCSpE05B3hIZp5YPWRak+t+7wB2q95S5A1038W55JlvAEiSNuZndK/0/1L1kGlNrvt9GHhA9ZZibwGesBABBoAk6dLOALbJzO9VD5nW5LrfMcBdqrf0xNuBvTNzvQEgSdrQF+m+8h/8r/ONiBvTvc1v6Ad+Zu09wF5XqF4hSeqN4+l+o9/vq4dMKyLuQPeV/1gO/MzSHkB6B0CSBHAY3Vf+Y3j43xc4CR/+m3Ie8B4DQJL0emD3zLywesi0ImJn4OOM77rfrPwW2DozjzYAJKltz8vMfUdy3e8JdN/JGOt1v2mdBdw3M08D8DUAktSm9cA+mfmm6iGzEBHPBV5UvaPHvkv3zo7vL/wDA0CS2nMBsEdmHl49ZFqT634HAftWb+mx04EHXvqdHQaAJLXlbLrrfidVD5nW5LrfO4GHV2/psZOAB2/sVzcbAJLUjp/RfSX45eoh04qIP6O77nf/6i09dgTdizvP39h/6YsAJakN3wXuNZKH/3WAE/Hhv5hDgV039fAHA0CSWvAFYPMNXwA2VJPrfqcCd67e0mOvyMy9M3PdYn/IAJCkcfsUsNVITvveATgN+PvqLT12QGYesJw/aABI0nh9ANh+ZNf9rlu9pafW0f2Sn1cs9y8YAJI0TocAjxjJdb9d6H6pj9f9Nu58up/3H7qSv2QASNL4PDcz9x/Jdb8n0l33u3L1lp46h+6dHUes9C/6NkBJGo91dNf93lw9ZBYi4nnAC6t39NjP6X6B0+mr+csGgCSNw/l03/L/SPWQaU2u+x0MPLl6S499n+6073dX+wEMAEkavrPprr2dXD1kWpPrfu8CHla9pce+CmybmWdN80EMAEkatrPofgb8leoh05pc9/sIcL/qLT12GvCgzPzttB/IFwFK0nB9h+663xge/gvX/Xz4b9rRwNazePiDASBJQ/V5uut+Z1YPmVZE3ITuK1uv+23au+h+idN5s/qABoAkDc8n6K77/bJ6yLQi4o50p31vWr2lxw4E9srMi2f5QQ0ASRqW99H9DPjc6iHTiogt8brfUv4tM5+WmTnrD2wASNJwHAzsMZLrfrsCHwf+vHpLT60HnpSZL5nXJzAAJGkYnpOZT5nHV4JrLSKeRPd7Crzut3EXArtl5n/N85P4NkBJ6rd1dF8JvqV6yCxExPOBF1Tv6LFzgZ0z85Pz/kQGgCT11/nA7qu58943k+t+hwD7VG/psV/R/fbGz63FJzMAJKmffkd33e/T1UOmFRFXpnsb20Ort/TYj+hO+35zrT6hASBJ/fNTuut+X60eMq2I+HO6635bVW/psW/QPfx/vJaf1ACQpH75Nt2d9zOrh0wrIv4GOAa4U/WWHvt/dN/2//Vaf2LfBSBJ/fE5xnPd76Z0B358+G/aJ4D7VTz8wQCQpL44ju5h8KvqIdOKiDvhdb+lfIDuoNMfqgYYAJJU772M57rfVnS/1Odviqf02RuAR1QfdDIAJKnWgcCemXlR9ZBpRcRD6X7m73W/Tfv3zHxyZq6vHjKGFwGeDjy5eoQkrcKFmfnF6hGzEBH70L3P3y8sNy6Bp2bmwdVDFowhAM7JzM9Uj5CkVkXEC4DnV+/osYuAR2fme6qHbGgMASBJKjC57vc64EnVW3rsPOChmXlM9ZBLMwAkSSs2ue73bmDX6i099ltgh8z8n+ohG2MASJJWZHLd7whgy+IpffZTuut+/1s9ZFMMAEnSskXEdele6X/H6i099h26h/+Z1UMW46s1JUnLssF1Px/+m/ZFYIu+P/zBAJAkLcMG1/1uUr2lx04EtsrMX1QPWQ4DQJK0qIi4H3ASXvdbzIfpfoPjOdVDlssAkCRtUkQ8jO5n/n9WvaXH3go8LDMvqB6yEgaAJGmjIuLJwPuAK1Vv6bGXZ+bjMnNd9ZCVMgAkSZcRES+kO/Ljc2LjEnhWZv5L9ZDV8m2AkqRLTK77vR54YvWWHrsYeFxmvr16yDQMAEkScMl1v/cAu1Rv6bHzgd0y88jqIdMyACRJC9f9jgTuW72lx84GHpyZJ1cPmQUDQJIaN7nu93HgDtVbeuznwLaZ+eXqIbNiAEhSwyLi74HjgBtXb+mx79Gd9j2jesgs+epOSWpURNyZ7rqfD/9N+wrdad9RPfzBAJCkJkXE/elO116neEqfnQLcNzPPqh4yDwaAJDUmIh4OHI3X/RZzFN23/X9XPWReDABJakhE7Au8F6/7LeadwM6Z+cfqIfNkAEhSIyLiRcAh+P/9i3kN8I+ZeXH1kHnzXQCSNHIRcXm6635PqN7Sc8/JzJdWj1grBoAkjVhEXIXuut/O1Vt6bD3wpMx8c/WQtWQASNJIRcQ1gSPwut9iLgD2zMwPVQ9ZawaAJI1QRFwPOAav+y3m98BOmXl89ZAKBoAkjUxE3Aw4Fg/8LOaXwPaZ+fnqIVUMAEkakYi4C917/D3ws2k/pHuP/7eqh1TyrSCSNBIR8QDgBHz4L+brwOatP/zBAJCkUYiI3YCP4XW/xXwWuHdm/rh6SB8YAJI0cBGxH91b/bzut2nHAvfPzN9UD+kLA0CSBiwi/h04GP//fDHvA3bMzD9UD+kTXwQoSQM0ue73BuDx1Vt67nXAUzJzffWQvjEAJGlgJtf93gvsVL2l516YmS+oHtFXBoAkDcjkut+RwH2qt/TYerqv+l9XPaTPDABJGojJdb+PA7ev3tJjFwF7Zeb7qof0nQEgSQMwue53HLBZ8ZQ++wOwa2YeWz1kCAwASeq5iLgr3XW/a1dv6bHfADtk5meqhwyFbxuRpB6LiK3prvv58N+0n9Ad+PHhvwIGgCT1VETsDhwFXKN6S499m+6079erhwyNASBJPRQR++N1v6V8AdgiM39QPWSIDABJ6pmIeAlwEBDVW3rseGCrzPxl9ZCh8kWAktQTk+t+bwQeV72l5w4H9sjMC6qHDJkBIEk9MLnu9z7gIdVbeu7NwD6Zua56yND5IwBJKhYR16J7j78P/8W9LDOf4MN/NvwOgCQVioi/pbvud7vqLT2WwDMz8zXVQ8bEAJCkIhFxc7rfU79Z8ZQ+uxh4bGa+o3rI2BgAklQgIu4GfAwP/Czmj8DDM/Oo6iFjZABI0hqbXPc7HA/8LOZ3wI6ZeUr1kLHyRYCStIYi4hF0X/n78N+0nwH39eE/XwaAJK2RiHgK8G7gitVbeuwMutO+X6keMnYGgCStgYh4KXAgXvdbzJfpTvt+r3pIC3wNgCTN0eS6338Bj63e0nOfpvuZ/9nVQ1phAEjSnETEVemu+z24ekvPfZTu1f7nVw9piT8CkKQ52OC6nw//xb0d2MWH/9ozACRpxibX/T4NbFG9pedeBTwmMy+uHtIiA0CSZigibgGcBty2ekvPPTszn5WZWT2kVb4GQJJmZHLd72jgr6u39Ng64EmZ+ZbqIa0zACRpBiJiG7rrflev3tJjFwCPyMwPVw+RPwKQpKlFxB7AUfjwX8zvge18+PeHASBJU4iIpwHvwut+i/klsGVmnlA9RP/HAJCkVYqIlwGvwet+i/kB3XW/L1YP0Z/yNQCStEKT635vBh5TvaXn/hfYNjN/Uj1El2UASNIKTK77vR/YsXpLz/0P8KDM/E31EG2cASBJyxQRf0F3tnbz6i0993Fg18w8r3qINs3XAEjSMkTE9YGT8eG/lPcCD/bh338GgCQtwet+y3YIsGdmXlQ9REszACRpERFxd+AU4IbVW3ru+Zm5v6d9h8PXAEjSJkTEtsCH8MDPYtYD+2fm66uHaGUMAEnaiIjYEzgUD/ws5kJgr8x8f/UQrZw/ApCkS4mIpwPvxIf/Yv4A7OjDf7j8DoAkbSAi/gP45+odPfdrYIfM/Gz1EK2eASBJQERcge6636OLp/Tdj4FtMvMb1UM0HQNAUvMm1/0+ADyoekvPfYvu4f/D6iGangEgqWmT635HAfeq3tJzn6f7db6/qh6i2fBFgJKaNbnu92l8+C/lU8BWPvzHxQCQ1KSIuCXddb/bVG/puQ8C22fmudVDNFsGgKTmRMQ98LrfcrwJ2C0zL6weotkzACQ1JSIeSPct7b+q3tJzL8nMJ2bm+uohmg8DQFIzIuKRwJF42ncxCTw9M/+teojmywCQ1ISIeAbwDrzut5iL6U77vrZ6iObPAJA0ehHxcuBVQFRv6bE/Ajtl5ruqh0wrIq5VvWEIDABJoxURV4iItwEHVG/pud8BW2fmx6qHTCsibkv3Gxy1BA8BSRqlyXW/w4Adqrf03FnAtpn51eoh04qIe9EddfpF9ZYh8DsAkkYnIv4S+CQ+/JfyXWDzkTz8twM+AfxF9ZahMAAkjUpE3ACv+y3Hl4AtMvP71UOmFRF7AEcAV6veMiQGgKTRiIhb0V33u3X1lp47GbhvZv68esi0ImI/4F347o4VMwAkjUJE3JPuK/+/q97Sc0fQ/cz/nOoh04qIFwIH47s7VsUAkDR4k5//et1vaYcCu2bm+dVDphERl4uI1wHPq94yZAaApEGLiEfRXffz57+Le2Vm7p2Z66qHTCMirgi8G3hy9ZahMwAkDVZEPBN4O76leSn/nJn/VD1iWhFxdeCjwO7VW8bAABARsWNEXKN6h7Rc0flP4JX489/FrAMem5n/WT1kWhu8tXPb6i1jYQA0LiL2pntR0DFGgIYgIq4AvA0Y/Fe0c3Y+8NDM/O/qIdOKiOvTvXPhntVbxsQAaNjk4f8Wuq+gtgA+HhF/VrtK2rSIuBpdsO5VvaXnzgG2y8yPVA+ZVkTcDDgVuE31lrExABp1qYf/gs3pvhNgBKh3NvgW8PbVW3ruF8CWmXli9ZBpRcSdgVOAG1VvGSMDoEGbePgv2By/E6Ce2eC63z9Ub+m5M+mu+51ePWRaEbElcAJwneIpo2UANGaJh/+Ce2EEqCe87rdsX6O76/+d6iHTioidgGOAP6/eMmYGQEOW+fBfcC/gWCNAlSbX/U7B635LOQ24T2b+tHrItCLiMcAHgatUbxk7A6ARK3z4L/gHugiwwrXmImJ7uut+f1m9peeOAbbOzN9WD5lWRPwT8N/A5au3tMAAaMAqH/4LjACtuYjYC3+723K8G3hIZp5XPWRaEfFyYPD3CobEABi5KR/+C+6JEaA1EhHPonufv9f9FncQ8KjMvKh6yDQi4vIR8VbggOotrTEARmxGD/8F9wSOMwI0L5Prfq8EXoHX/Zby3Mx8amZm9ZBpRMSVgcOAvau3tMgAGKkZP/wX3IMuAq45w48pLVz3ezvwzOotPbce2CczX1w9ZFqTFxgfA+xcvaVVBsAIzenhv+AedD8OMAI0E5PrfkcCj6re0nMXArtn5hurh0wrIq4NnAhsVTylaQbAyMz54b/A7wRoJibX/T4FbFe9pefOBXbIzMOqh0wrIm5E99bOO1dvaZ0BMCJr9PBfcHeMAE0hIv6O7kHgL3hZ3K+B+2XmJ6uHTCsibk131//m1VtkAIzGGj/8F9wd+IQRoJWaPAhOA25VvaXnfkR32vdz1UOmFRH3oDvnfP3qLeoYACNQ9PBfcDe6CLhWwefWAEXEP9A9CG5QvaXnvkl32veb1UOmFRHb4FGn3jEABq744b/ACNCyRMQOdL/RzwfB4j5H95X/j6qHTCsidgOOAq5evUV/ygAYsJ48/BfcFSNAi4iIfwQ+gtf9lvJJup/5/7p6yLQiYh/gPcAVq7fosgyAgerZw3+BEaCNmtx4PxSv+y3lMLpX+59bPWRaEfFc4PX4nOkt/8UMUE8f/gvuCnwyIv6ieojqTa77vYruxnsf//faJ2+ke5//hdVDpjH5d34Q8KLqLVqcATAwPX/4L7gL3XcCjICGRcQVgXcAz6jeMgAvzsx9MnN99ZBpTP6dvxPYv3qLlmYADMhAHv4L7oLfCWhWRFyd7rf5PbJ6S88l8NTMfG71kGlNLjp+BNizeouWxwAYiIE9/BfcGSOgORHxV3jdbzkuovttfgdVD5nW5HU/nwC2r96i5TMABmCgD/8FdwY+NTn5qpGLiBvSXfe7R/WWnjsPeEhmvrt6yLQi4nrAycC9qrdoZQyAnhv4w3/Bnei+E2AEjFhE3IbuzOstq7f03G+BrTPzmOoh04qIm9L9O79d9RatnAHQYyN5+C8wAkYsIu6F1/2W46fAfTLztOoh04qIO9I9/G9cvUWrYwD01Mge/gvuhD8OGJ2IeBDd8Rpf67G479Cd9v1a9ZBpRcS96X6d798UT9EUDIAeGunDf8Ed6SLgr6qHaHoR8Wjgw8BVi6f03el0p33PrB4yrYjYETgO8JeADZwB0DMjf/gvMAJGICIOwOt+y3EisGVm/qJ6yLQiYi/gcOAq1Vs0PQOgRxp5+C+4A0bAIE0uvb0aeHn1lgH4CLBdZp5TPWRaEfEM4G0YfKNhAPREYw//BXcAjo+Iv64eouXZ4NLb06u3DMB/Aw/NzPOrh0wrIl4KvIq2/v9p9AyAHoiIe9Dew3/B7em+E2AE9Nzkut+ReOltOf4zMx+bmeuqh0wjIi4XEW8Cnl29RbNnAPRAZn4WOLB6RyEjoOcmP6o5Hnhg9ZaeS+CfMvOfq4dMKyKuBHwAeHz1Fs2HAdATmfl04LXVOwrdHn8c0EsbXPe7e/WWnlsH7J2Zr6weMq2IuAZwNLBr9RbNjwHQI0YAt6OLgGtXD1Fnct3vNLzut5TzgV0y823VQ2bkKOD+1SM0XwZAzxgBRkBfRMTmdNf9rl+9pefOBrbNzCOrh8yQwdcAA6CHjABuixFQanLs5RN43W8pP6d7j//J1UOklTIAesoIMAKqRMRj8Lrfcnyf7rTvl6qHSKthAPSYEcBtgRMi4jrVQ1oREf9C9/71y1dv6bmv0j38z6geIq2WAdBzkwho+S2Ct6H7ToARMEeT636vAV5WvWUATqX7jX5nVQ+RpmEADEBmPg0jwO8EzMnkut+7gKdVbxmAjwFbZ+bvqodI0zIABsII4NZ0EeCvH52hyXW/jwJ7VG8ZgHcBO2XmH6uHSLNgAAyIEcCt6X4cYATMwOTo0vHAttVbBuC1wF6ZeXH1EGlWDICBMQL8TsAsRMSN8Lrfcj0nM5+emVk9RJolA2CAjABuhRGwahFxW7rrfreo3tJz64EnZuZLq4dI82AADJQRcEkEXLd6yJBExBZ01/3+tnpLz10I7JaZb6oeIs2LATBgRoARsBIR8WDgOOBa1Vt67lxg+8z8YPUQaZ4MgIEzArglRsCSImJv4HC87reUXwFbZeanqodI82YAjIARwC2BEyPietVD+iging28Fa/7LeWHwBaZ+fnqIdJaMABGwgjgFnTfCTACJibX/V4L+CK2pX2D7rTvt6qHSGvFABgRI8AIWDC57vdu4KnVWwbgs8C9M/PH1UOktWQAjIwRwC3ofhzQ7KvcI+IawFHAI6q3DMBxwP0z89fVQ6S1ZgCMkBHAzem+E9BcBGxw3W+b6i0D8H5gx8z8Q/UQqYIBMFJGQHsRMLnudypwt+otA/B6YI/MvLB6iFTFABgxI4Cb08iPAyLidnTX/W5evWUAXpSZ+2bm+uohUiUDYOQmEXBQ9Y5CN6OLgOtXD5mXiLg3cDJe91tKAvtn5vOrh0h9YAA0IDOfihEwygiIiIfgdb/luAjYMzMPqR4i9YUB0AgjgL9nZBEQEY8FPgRcpXpLz50HPDgz31s9ROoTA6AhRsAlEXCD6iHTioh/Bd6C1/2W8hu6t/l9vHqI1DcGQGOMgGFHwOS634HAS6q3DMBPgPtk5meqh0h9ZAA0yAjgpgwwAibX/d4DPKV6ywB8m+607/9WD5H6ygBolBFwSQT8XfWQ5Zhc9/sYsHv1lgH4It0v9flB9RCpzwyAhhkBw4iAiLg2cAKwdfWWATgB2DIzf1k9ROo7A6BxRgA3occREBGbAacAd61dMgiHA9tl5u+rh0hDYADICPi/CLhh9ZANRcTt8brfcr0FeHhmXlA9RBoKA0CAEUDPImBy3e8koPlfbbwM/5GZj8/MddVDpCExAHQJI4Ab04MIiIid8LrfciTwzMx8dvUQaYgMAP0JI+CSCLhRxSePiMcBH8Trfku5GHhMZr66eog0VAaALsMIqImAiHgO8Ga87reUPwK7ZObbq4dIQ2YAaKOMADZjjSIgIi4XEQcBL5735xqBs4FtM/Oj1UOkoTMAtElGwCURsNm8PkFEXInuut/+8/ocI/Iz4L6Z+enqIdIYGABa1CQCDq7eUWgz5hQBG1z3223WH3uEvkd32vfL1UOksTAAtKTMfAptR8CNmHEETK77nQg8YFYfc8S+Qvfw/171EGlMDAAtixHAjYCTIuLG036gycc4FbjL1KvG7xS63+j3s+oh0tgYAFo2I4Ab0n0nYNURMLnudypws5mtGq+jgG0y8+zqIdIYGQBaESNg9REQEfcBTsbrfsvxDmDnzPxj9RBprAwArZgRcEkE3GS5fyEidgaOBa45t1Xj8Wrg0Zl5cfUQacwMAK2KEbD8CIiIxwOH4XW/5fjXzHxmZmb1EGnsDACtmhHA37FEBETEvwFvwut+S1kHPD4zX1Y9RGqFAaCpGAGXRMBNN/yHk+t+BwP/XjNrUC6g+1W+b6keIrXEANDUjIA/jYDJdb/3AvuVrhqG3wPbZ+bh1UOk1hgAmgkjgBvQRcCdgKOBhxfvGYJfAltl5vHVQ6QWXaF6gMYjM58SEdDuXfsbAF8AonrIAPyA7j3+364eIrXK7wBopvxOgA//Zfg63WlfH/5SIQNAM2cEaBGfAe6dmT+pHiK1zgDQXBgB2ohjgQdk5m+qh0gyADRHRoA28F5gx8z8Q/UQSR0DQHM1iYBDqneo1CHAnpl5UfUQSf/HANDcZeb+GAGtekFm7u9pX6l/fBug1kRm7j95i6DHcdqwHtg/M19fPUTSxhkAWjNGQDMuAh6Vme+vHiJp0wwArSkjYPT+AOySmcdVD5G0OANAa84IGK3f0N31/2z1EElL80WAKuELA0fnx3QHfnz4SwNhAKiMETAa36I77fv16iGSls8AUCkjYPA+D2yRmT+sHiJpZQwAlTMCBut44H6Z+avqIZJWzgBQLxgBg/Mhuhf8/b56iKTVMQDUG0bAYLwJeHhmXlA9RNLqGQDqFSOg916amU/MzPXVQyRNxzsA6h3vBPRSAs/IzNdWD5E0GwaAeskI6JWLgb0z853VQyTNjgGg3jICeuGPwMMy82PVQyTNlgGgXptEQAD7Vm9p0O+AHTPzlOohkmbPAFDvZeZ+k+8EGAFr5yzggZn5leohkubDdwFoEDJzP+B11TsacQbdaV8f/tKIGQAaDCNgTXyJ7uH//eohkubLANCgGAFzdTKwZWb+vHqIpPkzADQ4RsBcHAlsm5lnVw+RtDYMAA2SETBTbwN2yczzq4dIWjsGgAbLCJiJV9Ed+VlXPUTS2jIANGhGwFT+JTOflZlZPUTS2vMOgAbPOwErtg54Yma+tXqIpDoGgEbBCFi2C4DdM/Mj1UMk1TIANBpGwJLOAR6SmSdWD5FUzwDQqBgBm/QLYLvM/GL1EEn94IwjvAAABmFJREFU4IsANTq+MPAyzgS28OEvaUMGgEbJCLjE1+hO+36neoikfjEANFpGAP8D3Cczf1o9RFL/GAAatUkEvL56R4FjgAdk5m+rh0jqJwNAo5eZ+9JWBLyH7tX+51UPkdRfBoCa0FAEHAw8MjMvqh4iqd8MADWjgQh4XmY+xdO+kpbDOwBqSmbuO7kT8OTqLTO0HtgvM99QPUTScBgAas7IIuBC4FGZ+YHqIZKGxQBQk0YSAecCu2TmJ6qHSBoeA0DNGngE/BrYPjP/X/UQScPkiwDVtIG+MPBHwL19+EuahgGg5g0sAr5Jd9r3G9VDJA2bASB1hnAx8HN0X/n/qHqIpOEzACRg8t75PkfAJ4H7ZeavqodIGgcDQJrocQQcBuyQmedWD5E0HgaAtIEeRsB/Abtn5oXVQySNiwEgXUqPIuDFmfmkzFxfvEPSCHkHQNqIzMyI2G/yH9f6TkACT8/MA9f480pqiAEgbcIGERDAPmv0aS8GHp2Z716jzyepUQaAtIhJBOw7+Y/zjoDzgIdl5tFz/jySZABIS1mjCPgt8KDMPG1OH1+S/oQBIC3DnCPgLGCbzPzajD+uJG2S7wKQlmny7oB9gTfM8MN+l+60rw9/SWvKAJBWYMYRcDrdw//7M/hYkrQiBoC0QjOKgJOALTPzF7NZJUkrYwBIqzBlBBwBPDAzz5ntKklaPgNAWqVVRsChwK6Zef58VknS8hgA0hRWGAGvyMy9M3PdnGdJ0pIMAGlKy4yAAzLzgDWaJElL8g6ANAOL3AlYBzw+Mw8tmCVJm2QASDOykQg4n+5X+R5ROEuSNsoAkGZogwg4D/hoZp5UvUmSNsYAkGZs8pqAZ1XvkKTF+CJASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAZdoXrADNwgIp5WPUKSRuRq1QM0fwFk9QhJkmboW5l5y+oRfeePACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBhkAkiQ1yACQJKlBVwB2rh4hSdIM/b56wBBEZlZvkCRJa8wfAUiS1CADQJKkBhkAkiQ1yACQJKlBBoAkSQ0yACRJapABIElSgwwASZIaZABIktQgA0CSpAYZAJIkNcgAkCSpQQaAJEkNMgAkSWqQASBJUoMMAEmSGmQASJLUIANAkqQGGQCSJDXIAJAkqUEGgCRJDTIAJElqkAEgSVKDDABJkhpkAEiS1CADQJKkBv1/W+egEDHxZx0AAAAASUVORK5CYII=";t.image(e,r,s)}}class iE extends YB{constructor(t,e){super(t,e)}_build(t,e){}_doWrite(t,e){const s=t.getModel(e),i=t.getBounds(e);s.reversed?t.dline(e,i.x+i.width,i.y,i.x,i.y+i.height):t.dline(e,i.x,i.y,i.x+i.width,i.y+i.height)}}class rE extends YB{constructor(t,e,s){super(t,e),this._model=s}_build(t,e){const s=getComputedStyle(e),i=J.getImageUrl(s);i&&(i.startsWith("data:image")?this._data=i:i.startsWith("http")&&t.addImage(this._url=i,s.opacity))}_doWrite(t,e){const s=this._data||t.getImage(this._url),i=t.getBounds(e),r=this._model.imagePosition;switch(r){case"top":case"bottom":i.valign=r;break;case"left":case"right":i.align=r;break;case"center":i.valign=r,i.align=r}const n=this._model.imageFit;"cover"===n?i.cover=[i.width,i.height]:"contain"===n&&(i.fit=[i.width,i.height]),t.save(),t.clip(e),t.image(e,s,i),t.restore()}}class nE extends YB{constructor(t,e){super(t,e)}_build(t,e){const s=e.firstChild;s instanceof HTMLImageElement&&(this._data=s.src)}_doWrite(t,e){const s=this._data||t.getImage(this._url);if(s){const i=t.getBounds(e);t.image(e,s,i)}}}class oE extends YB{constructor(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(t,e||t.getParent(s)),this._svg=s,this._scaled=i}_build(t,e){}_doWrite(t,e){t.save();const s=t.getBounds(e);if(this._scaled){const i=e.getBoundingClientRect(),r=this._svg.getBBox(),n=i.width/r.width,o=i.height/r.height,a=Math.min(n,o),A=(i.width-r.width*a)/2*zB,l=(i.height-r.height*a)/2*zB;t.translate(s.x+A,s.y+l),t.scale(a,a)}else t.translate(s.x,s.y);this.$_write(t,this._svg),t.restore()}$_write(t,e){const s=e.children;for(let e=0;e<s.length;e++){const i=s[e];if(i instanceof SVGGraphicsElement){t.save();const e=i.transform.baseVal,s=e.length>0?e.getItem(0):null;s&&t.transformSvg(s.matrix),"g"===i.tagName?this.$_write(t,i):i instanceof SVGTextElement?this.$_text(t,i):i instanceof SVGPathElement?this.$_path(t,i):i instanceof SVGRectElement?this.$_rect(t,i):i instanceof SVGLineElement?this.$_line(t,i):i instanceof SVGPolygonElement?this.$_polygon(t,i):i instanceof SVGEllipseElement&&this.$_ellipse(t,i),t.restore()}}}$_rotation(t){const e=t.split("(")[1].split(")")[0].split(","),s=+e[0],i=+e[1];return Math.round(Math.atan2(i,s)*(180/Math.PI))}$_text(t,e){const s=e.getElementsByClassName("highcharts-text-outline").length>0?e.children[0].textContent:e.textContent;if(s){const i=getComputedStyle(e),r=t.getBox(e),n={},o=i.transform&&i.transform.startsWith("matrix(")&&this.$_rotation(i.transform)||0;t.text(i,r,s,o,n)}}$_path(t,e){const s=e.getAttribute("d");if(s){const i=getComputedStyle(e);t.scale(zB,zB),t.path(i,s)}}$_rect(t,e){const s=t.getBox(e),i=getComputedStyle(e);t.rect(i,s,!0)}$_line(t,e){}$_polygon(t,e){const s=getComputedStyle(e),i=e.points,r=[];t.scale(zB,zB);for(let t=0;t<i.length;t++){const e=i.getItem(t);r.push([e.x,e.y])}t.polygon(s,r)}$_ellipse(t,e){const s=t.getBox(e),i=getComputedStyle(e);t.ellipse(i,s)}}class aE extends JB{_needClip(){return!0}}class AE extends YB{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t,e),this._renderCell=s}_doWrite(t,e){const s=t.getBounds(e);t.getModel(e);const i=getComputedStyle(e);t.border(i,s);const r=e.rows;for(let e=0;e<r.length;e++)this.$_writeRow(t,r[e])}$_writeRow(t,e){const s=t.getBounds(e),i=e.cells,r=getComputedStyle(e);t.rect(e,s),t.border(r,s);for(let e=0;e<i.length;e++)this.$_writeCell(t,i[e])}$_writeCell(t,e){const s=getComputedStyle(e);if("none"!==s.display){const i=t.getBounds(e);if(t.rect(e,i),t.border(s,i),this._renderCell){const r=e.textContent;r&&t.text(s,i,r,0)}}}}class lE extends A{constructor(){super(),this._elementCreator=(t,e,s)=>{let i;if(e instanceof za)i=new ZB(t,s.firstChild);else if(e instanceof jo)s.style.opacity=e.styles.opcaity,i=new rE(t,s,e);else if(e instanceof Ca){const e=s._svg_;s.innerHTML=e.substring(e.indexOf("<svg")),this._svgs.push(s);const r=s.firstElementChild;r.style.visibility="hidden",i=new oE(t,s,r,!0)}else e instanceof ha?i=new nE(t,s):s instanceof HTMLSpanElement?i=e instanceof Yo?new sE(t,s,e):e instanceof Ba?new tE(t,s,e):e instanceof wr?new iE(t,s):new YB(t,s):s instanceof HTMLTableElement?i=new AE(t,s,e instanceof No):s instanceof HTMLTableCellElement?i=new aE(t,s):s instanceof SVGSVGElement?i=new oE(t,null,s,e instanceof Va):s instanceof HTMLCanvasElement?i=new eE(t,s):s instanceof HTMLElement?i=new YB(t,s):s instanceof Text&&(i=new qB(t,s));return i}}_doDispose(){super._doDispose()}_base64ToArrayBuffer(t){for(var e=window.atob(t),s=e.length,i=new Uint8Array(s),r=0;r<s;r++)i[r]=e.charCodeAt(r);return i.buffer}export(t,e,s,i,r){const n=()=>{o.canExport()||o.prepare(a)?this.$_export(o,s,i,r):setTimeout((()=>{n()}),300)};this._svgs=[];const o=new $B(t,e,this._elementCreator),a=5;n()}$_export(t,e,s,i){const r=new window.PDFDocument({size:t.report.paper.size,layout:t.report.paper.orientation,margin:0}),n=r.pipe(s||new window.blobStream);let o,a;if(!(e&&e.length>0))throw new Error("Pdf 출력용 폰트가 설정돼야 합니다.");for(let t of e)t.content&&r.registerFont(t.name,this._base64ToArrayBuffer(t.content));o=e[0].name,a=e[1].name||o,t.write(r,o,a);for(let t of this._svgs)t.removeChild(t.firstElementChild);r.end(),s?null==i||i(s):n.on("finish",(function(){const e=n.toBlob("application/pdf");let s=document.createElement("a"),i=window.URL.createObjectURL(e);document.body.appendChild(s),s.href=i,s.download=(t.report.info.name||"rrpt")+".pdf",s.style.position="fixed",s.target="_blank",s.click(),document.body.removeChild(s)}))}}const hE=function(t){return((255&t)<<16)+(65280&t)+((16711680&t)>>16)},dE=function(t){return 255*(1-t)>>0};var cE;!function(t){t.Solid="Solid",t.Dash="Dash",t.Dot="Dot",t.DashDot="DashDot",t.DashDotDot="DashDotDot",t.LongDash="LongDash",t.Circle="Circle",t.DoubleSlim="DoubleSlim",t.SlimThick="SlimThick",t.ThickSlim="ThickSlim",t.SlimThickSlim="SlimThickSlim",t.None="None"}(cE||(cE={}));var uE,pE,_E,gE,fE,mE,wE,yE,CE,bE,vE,BE,EE,PE;!function(t){t.Solid="Solid",t.Dash="Dash",t.Dot="Dot",t.DashDot="DashDot",t.DashDotDot="DashDotDot",t.LongDash="LongDash",t.Circle="Circle",t.DoubleSlim="DoubleSlim",t.SlimThick="SlimThick",t.ThickSlim="ThickSlim",t.SlimThickSlim="SlimThickSlim"}(uE||(uE={})),function(t){t.Solid="Solid",t.Dot="Dot",t.Thick="Thick",t.Dash="Dash",t.DashDot="DashDot",t.DashDotDot="DashDotDot"}(pE||(pE={})),function(t){t.Digit="Digit",t.CircledDigit="CircledDigit",t.RomanCapital="RomanCapital",t.RomanSmall="RomanSmall",t.LatinCapital="LatinCapital",t.LatinSmall="LatinSmall",t.CircledLatinCapital="CircledLatinCapital",t.CircledLatinSmall="CircledLatinSmall",t.HangulSyllable="HangulSyllable",t.CircledHangulSyllable="CircledHangulSyllable",t.HangulJamo="HangulJamo",t.CircledHangulJamo="CircledHangulJamo",t.HangulPhonetic="HangulPhonetic",t.Ideograph="Ideograph",t.CircledIdeograph="CircledIdeograph"}(_E||(_E={})),function(t){t.Digit="Digit",t.CircledDigit="CircledDigit",t.RomanCapital="RomanCapital",t.RomanSmall="RomanSmall",t.LatinCapital="LatinCapital",t.LatinSmall="LatinSmall",t.CircledLatinCapital="CircledLatinCapital",t.CircledLatinSmall="CircledLatinSmall",t.HangulSyllable="HangulSyllable",t.CircledHangulSyllable="CircledHangulSyllable",t.HangulJamo="HangulJamo",t.CircledHangulJamo="CircledHangulJamo",t.HangulPhonetic="HangulPhonetic",t.Ideograph="Ideograph",t.CircledIdeograph="CircledIdeograph",t.DecagonCircle="DecagonCircle",t.DecagonCircleHanja="DecagonCircleHanja",t.Symbol="Symbol",t.UserChar="UserChar"}(gE||(gE={})),function(t){t.Justify="Justify",t.Left="Left",t.Right="Right",t.Center="Center",t.Distribute="Distribute",t.DistributeSpace="DistributeSpace"}(fE||(fE={})),function(t){t.Left="Left",t.Right="Right",t.Center="Center"}(mE||(mE={})),function(t){t.Normal="Normal",t.Arrow="Arrow",t.Spear="Spear",t.ConcaveArrow="ConcaveArrow",t.EmptyDiamond="EmptyDiamond",t.EmptyCircle="EmptyCircle",t.EmptyBox="EmptyBox",t.FilledDiamond="FilledDiamond",t.FilledCircle="FilledCircle",t.FilledBox="FilledBox"}(wE||(wE={})),function(t){t.SmallSmall="SmallSmall",t.SmallMedium="SmallMedium",t.SmallLarge="SmallLarge",t.MediumSmall="MediumSmall",t.MediumMedium="MediumMedium",t.MediumLarge="MediumLarge",t.LargeSmall="LargeSmall",t.LargeMedium="LargeMedium",t.LargeLarge="LargeLarge"}(yE||(yE={})),function(t){t.Hangul="Hangul",t.Latin="Latin",t.Hanja="Hanja",t.Japanese="Japanese",t.Other="Other",t.Symbol="Symbol",t.User="User"}(CE||(CE={})),function(t){t.Horizontal="Horizontal",t.Vertical="Vertical",t.BackSlash="BackSlash",t.Slash="Slash",t.Cross="Cross",t.CrossDiagonal="CrossDiagonal"}(bE||(bE={})),function(t){t.Tile="Tile",t.TileHorzTop="TileHorzTop",t.TileHorzBottom="TileHorzBottom",t.TileVertLeft="TileVertLeft",t.TileVertRight="TileVertRight",t.Total="Total",t.Center="Center",t.CenterTop="CenterTop",t.CenterBottom="CenterBottom",t.LeftCenter="LeftCenter",t.LeftTop="LeftTop",t.LeftBottom="LeftBottom",t.RightCenter="RightCenter",t.RightTop="RightTop",t.RightBottom="RightBottom",t.Zoom="Zoom"}(vE||(vE={})),function(t){t.Break="Break",t.Squeeze="Squeeze",t.Keep="Keep"}(BE||(BE={})),function(t){t.Square="Square",t.Tight="Tight",t.Through="Through",t.TopAndBottom="TopAndBottom",t.BehindText="BehindText",t.InFrontOfText="InFrontOfText"}(EE||(EE={})),function(t){t.Clickhere="Clickhere",t.Hyperlink="Hyperlink",t.Bookmark="Bookmark",t.Formula="Formula",t.Summery="Summery",t.UserInfo="UserInfo",t.Date="Date",t.DocDate="DocDate",t.Path="Path",t.Crossref="Crossref",t.Mailmerge="Mailmerge",t.Memo="Memo",t.RevisionChange="RevisionChange",t.RevisionSign="RevisionSign",t.RevisionDelete="RevisionDelete",t.RevisionAttach="RevisionAttach",t.RevisionClipping="RevisionClipping",t.RevisionSawtooth="RevisionSawtooth",t.RevisionThinking="RevisionThinking",t.RevisionPraise="RevisionPraise",t.RevisionLine="RevisionLine",t.RevisionSimpleChange="RevisionSimpleChange",t.RevisionHyperlink="RevisionHyperlink",t.RevisionLineAttach="RevisionLineAttach",t.RevisionLineLink="RevisionLineLink",t.RevisionLineTransfer="RevisionLineTransfer",t.RevisionRightmove="RevisionRightmove",t.RevisionLeftmove="RevisionLeftmove",t.RevisionTransfer="RevisionTransfer",t.RevisionSplit="RevisionSplit"}(PE||(PE={}));const xE="A".charCodeAt(0),SE="Z".charCodeAt(0),IE="_".charCodeAt(0),RE="$".charCodeAt(0);class TE{constructor(t){if(t)for(let e in t)if(e in this){const s=e.charCodeAt(0);s>=xE&&s<=SE&&(this[e]=t[e])}}static equals(t,e){if(t&&e&&t.constructor===e.constructor){for(let s in t){const i=s.charCodeAt(0);if(i>=xE&&i<=SE&&t[s]!==e[s])return!1}for(let s in t){const i=t[s];if(i instanceof TE&&!TE.equals(i,e[s]))return!1}for(let s in e){if(e[s]instanceof TE&&!(t[s]instanceof TE))return!1}return!0}return!1}get tag(){return this.constructor.TAG}get text(){}getTagOrders(){}getContent(){let t=[];const e={};for(let s in this){const i=this[s];if(i instanceof TE&&s.charCodeAt(0)!==RE)t.push(i);else{const r=s.charCodeAt(0);if(r>=xE&&r<=SE)e[s]=i;else if(J.isArray(i)&&s.charCodeAt(0)==IE)for(let e of i)t.push(e)}}const s=this.constructor.ORDERS;return s&&(t=t.sort(((t,e)=>(s[e.tag]||0)-(s[t.tag]||0)))),{elements:t,attrs:e}}}TE.TAG="INVALID";class OE extends TE{}class FE extends TE{constructor(){super(...arguments),this._size=new DE,this._position=new LE,this._outsideMargin=new NE,this.InstId=FE.Id++}setSize(t,e){return this._size.Width=t,this._size.Height=e,this}setPosition(t,e,s){return this._position.HorzOffset=t,this._position.VertOffset=e,this._position.TreatAsChar=s,this}}FE.TAG="SHAPEOBJECT",FE.Id=0;class DE extends TE{constructor(){super(...arguments),this.WidthRelTo="Absolute",this.HeightRelTo="Absolute",this.Protect=!1}}DE.TAG="SIZE";class LE extends TE{constructor(){super(...arguments),this.TreatAsChar=!1,this.VertRelTo="Paper",this.HorzRelTo="Paper",this.VertAlign="Top",this.HorzAlign="Left",this.VertOffset=0,this.HorzOffset=0,this.FlowWidthText=!0,this.AllowOverlap=!0}}LE.TAG="POSITION";(class extends TE{}).TAG="POINT";class NE extends TE{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0}}NE.TAG="OUTSIDEMARGIN";class HE extends TE{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0}}HE.TAG="INSIDEMARGIN";(class extends TE{constructor(){super(...arguments),this.Side="Left"}}).TAG="CAPTION";(class extends TE{}).TAG="SHAPECOMMENT";(class extends TE{}).TAG="SHADOW";(class extends TE{}).TAG="PARAMETERSET";class QE extends TE{constructor(){super(...arguments),this.Bright=0,this.Contrast=0,this.Effect="RealPic"}}QE.TAG="IMAGE";class UE extends TE{}UE.TAG="WINDOWBRUSH";(class extends TE{constructor(){super(...arguments),this.Angle=90,this.CenterX=0,this.CenterY=0,this.Step=50,this.ColorNum=2,this.StepCenter=50}}).TAG="GRADIATION";(class extends TE{}).TAG="COLOR";(class extends TE{constructor(){super(...arguments),this.Mode=vE.Tile}}).TAG="IMAGEBRUSH";class ME extends TE{constructor(){super(...arguments),this._windowBrush=new UE,this._color=16777215,this._alpha=0}setColor(t,e){return this._windowBrush.FaceColor=hE(this._color=t),this._windowBrush.Alpha=dE(this._alpha=e),this}sameWithColor(t,e){return t===this._color&&e===this._alpha}}ME.TAG="FILLBRUSH";(class extends TE{}).TAG="ROTATIONINFO";class kE extends TE{constructor(){super(...arguments),this.E1=1,this.E2=0,this.E3=0,this.E4=0,this.E5=1,this.E6=0}}class VE extends kE{}VE.TAG="TRANSMATRIX";class GE extends kE{}GE.TAG="SCAMATRIX";class KE extends kE{}KE.TAG="ROTMATRIX";class WE extends TE{constructor(){super(...arguments),this._translate=new VE,this._scale=new GE,this._rotate=new KE}}WE.TAG="RENDERINGINFO";class zE extends TE{constructor(){super(...arguments),this._rendering=new WE,this.XPos=0,this.YPos=0,this.GroupLevel=0,this.HorzFlip=!1,this.VertFlip=!1}setSize(t,e){this.OriWidth=t,this.OriHeight=e}}zE.TAG="SHAPECOMPONENT";class $E extends TE{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0}}$E.TAG="TEXTMARGIN";class XE extends TE{constructor(){super(...arguments),this._textMargin=new $E,this._paraList=new qE,this.Editable=!1}setText(t,e){const s=this._paraList.add().addText(!1,!0),i=s.add(eP);return s.CharShape=e,i.setText(t),this}}XE.TAG="DRAWTEXT";class jE extends TE{constructor(){super(...arguments),this.Width=33,this.Style=cE.None,this.EndCap="Flat",this.HeadStyle=wE.Normal,this.TailStyle=wE.Normal,this.HeadSize=yE.SmallSmall,this.TailSize=yE.SmallSmall,this.OutlineStyle="Normal"}setStyle(t){return this.Style=function(t){switch(t){case"dot":return cE.Dot;case"dashed":return cE.Dash;default:return cE.Solid}}(t),this}setColor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.Color=hE(t),this.Alpha=dE(e),this}}jE.TAG="LINESHAPE";class YE extends TE{constructor(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(),this._shapeComponent=new zE,this._lineShape=new jE,t&&(this._fillBrush=new ME),e&&(this._drawText=new XE)}get lineShape(){return this._lineShape}setText(t,e){return this._drawText.setText(t,e),this}setSize(t,e){return this._shapeComponent.setSize(t,e),this}setColor(t,e){return this._fillBrush||(this._fillBrush=new ME),this._fillBrush.setColor(t,e),this}setDebug(t){return t&&this._lineShape.Style===cE.None&&(this._lineShape.Style=cE.Solid,this._lineShape.Color=hE(13421772)),this}}YE.TAG="DRAWINGOBJECT";class JE extends TE{constructor(t,e,s){super(s),this._children=[],this.CharShape=0,t&&!e&&(this._secDef=new nP,this._colDef=new oP)}get secDef(){return this._secDef}get colDef(){return this._colDef}add(t){const e=new t;return this._children.push(e),e}addElement(t){t&&this._children.push(t)}addElements(t){null==t||t.forEach((t=>t&&this._children.push(t)))}}JE.TAG="TEXT",JE.ORDERS={SECDEF:10,COLDEF:9};class ZE extends TE{constructor(){super(...arguments),this._texts=[]}addText(){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const e=new JE(arguments.length>0&&void 0!==arguments[0]&&arguments[0],t);return t&&(this.ParaShape=0),this._texts.push(e),e}get firstText(){return this._texts.length>0?this._texts[0]:void 0}}ZE.TAG="P";class qE extends TE{constructor(){super(...arguments),this._paras=[],this.TextDirection=0,this.LineWrap=BE.Keep,this.VertAlign="Center"}get count(){return this._paras.length}get first(){return this._paras.length>0?this._paras[0]:void 0}add(){const t=new ZE;return this._paras.push(t),t}}qE.TAG="PARALIST";class tP extends TE{static getFontSize(t){let e=parseInt(t)||10;return t.endsWith("px")&&(e=72*e/96>>0),e>>0}static getColor(t){let e=0;if(t.startsWith("#"))e=+t.substr(t.length-6),e=(255&e)<<16+(65280&e)+(16711680&e)>>16;else if(t.startsWith("rgb(")){const s=t.substring(4,t.length-1).split(/,\s*/);e=(+s[2]<<16)+(+s[1]<<8)+ +s[0]}else if(t.startsWith("rgba(")){const s=t.substring(5,t.length-1).split(/,\s*/);e=(+s[3]<<24)+(+s[2]<<16)+(+s[1]<<8)+ +s[0]}return e}static getFontBold(t){return+t>=700}_toHwpF(t){return 100*t*72/96}_toHwp(t){return Math.round(100*t*72/96)}_toColor(t){return(255&t)<<16+(65280&t)+(16711680&t)>>16}}class eP extends tP{setText(t){t=1===t.length&&160===t.charCodeAt(0)?"":J.escapeXML(t),this._value=t}get text(){return this._value}}eP.TAG="CHAR";(class extends tP{constructor(){super(...arguments),this.PageStartOn="Both",this.Page=0,this.Figure=0,this.Table=0,this.Equation=0}}).TAG="STARTNUMBER";(class extends tP{constructor(){super(...arguments),this.Header=!1,this.Footer=!1,this.MasterPage=!1,this.Border=!1,this.Fill=!1,this.PageNumPos=!1,this.EmptyLine=!1}}).TAG="HIDE";class sP extends tP{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0,this.Header=0,this.Footer=0,this.Gutter=0}}sP.TAG="PAGEMARGIN";class iP extends tP{constructor(){super(...arguments),this._margin=new sP,this.Landscape=0,this.Width=59528,this.Height=84188,this.GutterType="LeftOnly"}}iP.TAG="PAGEDEF";(class extends tP{constructor(){super(...arguments),this.Type=gE.Digit,this.Superscript=!1}}).TAG="AUTONUMFORMAT";(class extends tP{constructor(){super(...arguments),this.Type=cE.Solid,this.Width="12mm"}}).TAG="NOTELINE";(class extends tP{constructor(){super(...arguments),this.AboveLine=567,this.BelowLine=567,this.BetweenNotes=850}}).TAG="NOTESPACING";(class extends tP{constructor(){super(...arguments),this.Type="Continuous",this.NewNumber=1}}).TAG="NOTENUMBERING";(class extends tP{constructor(){super(...arguments),this.Place="EachColumn",this.BeneathText=!1}}).TAG="NOTEPLACEMENT";class rP extends tP{}rP.TAG="FOOTNOTESHAPE";(class extends rP{constructor(){super(),this._placement.Place="EndOfDocument"}}).TAG="ENDNOTESHAPE";(class extends TE{constructor(){super(...arguments),this.Left=1417,this.Right=1417,this.Top=1417,this.Bottom=1417}}).TAG="PAGEOFFSET";(class extends TE{constructor(){super(...arguments),this.Type="Both",this.TextBorder=!1,this.HeaderInside=!1,this.FooterInside=!1,this.FillArea="Paper"}}).TAG="PAGEBORDERFILL";(class extends TE{constructor(){super(...arguments),this.Type="Both",this.HasTextRef=!1,this.HasNumRef=!1}}).TAG="MASTERPAGE";(class extends TE{}).TAG="EXT_MASTERPAGE";class nP extends tP{constructor(){super(...arguments),this._pageDef=new iP,this._pageBorderFills=[],this.TabStop=8e3}setLandscape(){this._pageDef.Landscape=1}}nP.TAG="SECDEF";(class extends tP{constructor(){super(...arguments),this.Type=cE.Solid,this.Width="0.12mm"}}).TAG="COLUMNLINE";(class extends tP{}).TAG="COLUMN";(class extends tP{constructor(){super(...arguments),this._columns=[]}}).TAG="COLUMNTABLE";class oP extends tP{constructor(){super(...arguments),this.Type="Newspaper",this.Count=1,this.Layout="Left",this.SameSize=!0,this.SameGap=0}}oP.TAG="COLDEF";class aP extends TE{setBounds(t,e,s,i){return this.X0=t,this.Y0=e,this.X1=t+s,this.Y1=e,this.X2=t+s,this.Y2=e+i,this.X3=t,this.Y3=e+i,this}}aP.TAG="IMAGERECT";class AP extends TE{constructor(){super(...arguments),this.Left=0,this.Top=0,this.Right=0,this.Bottom=0}}AP.TAG="IMAGECLIP";(class extends TE{}).TAG="EFFECTSCOLOR";(class extends TE{}).TAG="SHADOWEFFECT";(class extends TE{}).TAG="GLOW";(class extends TE{}).TAG="SOFTEDGE";(class extends TE{}).TAG="REFLECTION";(class extends TE{}).TAG="EFFECTS";class lP extends tP{constructor(){super(...arguments),this._shapeObject=new FE,this._shapeComponent=new zE,this._lineShape=new jE,this._imageRect=new aP,this._imageClip=new AP,this._image=new QE}init(){return this._shapeObject.ZOrder=1,this._shapeObject.NumberingType="Figure",this._shapeObject.TextWrap=EE.Square,this._shapeObject.Lock=!1,this}setId(t){return this._image.BinItem=t,this}setBounds(t,e,s,i,r){return t=this._toHwp(t),e=this._toHwp(e),s=this._toHwp(s),i=this._toHwp(i),this._shapeObject.setSize(s,i).setPosition(t,e,r),this._shapeComponent.setSize(s,i),this._imageRect.setBounds(0,0,s,i),this}}lP.TAG="PICTURE";class hP extends tP{constructor(t,e,s,i,r){super(),this._shape=new FE,this._drawing=new YE(!1,!1),this.IsReverseHV=!1;const n=this._toHwp(Math.min(t,s)),o=this._toHwp(Math.min(e,i)),a=this._toHwp(Math.max(t,s)),A=this._toHwp(Math.max(e,i)),l=Math.max(1,a-n),h=Math.max(1,A-o);this.StartX=0,this.StartY=0,this.EndX=l,this.EndY=h,this._shape.setPosition(n,o,r).setSize(l,h),this._drawing.setSize(l,h),this._drawing.lineShape.Style=cE.Solid}setStyle(t){return this._drawing.lineShape.setStyle(t),this}setColor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._drawing.lineShape.setColor(t,e),this}}hP.TAG="LINE";class dP extends tP{constructor(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(arguments.length>2?arguments[2]:void 0),this._shape=new FE,this._drawing=new YE(t,e)}setBounds(t,e,s,i,r){return s=this._toHwp(s),i=this._toHwp(i),this.X0=0,this.Y0=0,this.X1=0+s,this.Y1=0,this.X2=0+s,this.Y2=0+i,this.X3=0,this.Y3=0+i,this._shape.setSize(s,i).setPosition(this._toHwp(t),this._toHwp(e),r),this._drawing.setSize(s,i),this}setZOrder(t){return this._shape.ZOrder=t,this}setText(t,e){return this._drawing.setText(t,e),this}setDebug(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._drawing.setDebug(t)}setColor(t,e){return this._drawing.setColor(t,e),this}}dP.TAG="RECTANGLE";(class extends tP{constructor(){super(...arguments),this.IntervalDirty=!1,this.ArcType="Normal"}}).TAG="ELLIPSE";(class extends tP{constructor(){super(...arguments),this.Type="Normal"}}).TAG="ARC";(class extends tP{constructor(){super(...arguments),this._points=[]}}).TAG="POLYGON";(class extends TE{constructor(){super(...arguments),this.Type="Curve"}}).TAG="SEGMENT";(class extends tP{constructor(){super(...arguments),this._segments=[]}}).TAG="CURVE";(class extends tP{}).TAG="CONNECTLINE";(class extends tP{}).TAG="UNKNOWNOBJECT";(class extends tP{}).TAG="BUTTON";(class extends tP{}).TAG="RADIOBUTTON";(class extends tP{}).TAG="CHECKBUTTON";(class extends tP{constructor(){super(...arguments),this._shape=new FE}}).TAG="COMBOBOX";(class extends tP{}).TAG="EDIT";(class extends tP{}).TAG="LISTBOX";(class extends tP{}).TAG="SCROLLBAR";(class extends tP{}).TAG="CONTAINER";(class extends tP{}).TAG="EQUATION";(class extends tP{}).TAG="TEXTART";(class extends tP{}).TAG="FIELDBEGIN";(class extends tP{}).TAG="FIELDEND";(class extends tP{}).TAG="BOOKMARK";(class extends tP{}).TAG="HEADER";(class extends tP{}).TAG="FOOTER";(class extends tP{}).TAG="FOOTNOTE";(class extends tP{}).TAG="ENDNOTE";(class extends tP{}).TAG="AUTONUM";(class extends tP{}).TAG="NEWNUM";(class extends tP{}).TAG="PAGENUMCTRL";(class extends tP{}).TAG="PAGEHIDING";(class extends tP{}).TAG="PAGENUM";(class extends tP{}).TAG="INDEXMARK";(class extends tP{}).TAG="COMPOSE";(class extends tP{constructor(){super(...arguments),this.PosType="Top",this.Align=fE.Center}}).TAG="DUTMAL";(class extends tP{}).TAG="HIDDENCOMMENT";(class extends TE{constructor(){super(...arguments),this._cellZones=[],this.Count=0}}).TAG="CELLZONELIST";(class extends TE{}).TAG="CELLZONE";class cP extends TE{constructor(){super(...arguments),this.Left=0,this.Right=0,this.Top=0,this.Bottom=0}}cP.TAG="CELLMARGIN";class uP extends TE{constructor(){super(...arguments),this._paraList=new qE,this.ColAddr=0,this.RowAddr=0,this.ColSpan=1,this.RowSpan=1,this.Header=!1,this.HasMargin=!1,this.Protect=!1,this.Editable=!1,this.Dirty=!1}get textElement(){return this.$_text}add(t){const e=this.$_checkText();return this._paraList.LineWrap=BE.Break,e.add(t)}addElement(t){const e=this.$_checkText();this._paraList.LineWrap=BE.Break,e.addElement(t)}setAlign(t,e){return this._paraList.first.ParaShape=t.head.addParaShape(e),this}setVAlign(t){return this._paraList.VertAlign=t,this}setWrap(t){return this._paraList.first.ParaShape=t.head.addParaShapeWrap(),this}setMargin(t,e,s,i){const r=this._cellMargin||(this._cellMargin=new cP);return isNaN(t)||(r.Left=t),isNaN(e)||(r.Right=e),isNaN(s)||(r.Top=s),isNaN(i)||(r.Bottom=i),this.HasMargin=!0,this}$_checkText(){if(!this.$_text){const t=this._paraList.add();this.$_text=t.addText()}return this.$_text}}uP.TAG="CELL";class pP extends TE{constructor(){super(...arguments),this._cells=[]}addCell(t){this._cells.push(t)}}pP.TAG="ROW";const _P={l:fE.Left,c:fE.Center,r:fE.Right};class gP extends tP{constructor(){super(...arguments),this._shapeObject=new FE,this._insideMargin=new HE,this.PageBreak="Cell",this.RepeatHeader=!0,this.CellSpacing=0}setBounds(t,e,s,i,r){return t=this._toHwp(t),e=this._toHwp(e),s=this._toHwp(s),i=this._toHwp(i),this._shapeObject.setSize(s,i).setPosition(t,e,r),this}build(t,e,s,i){var r;function n(t,e){if(1===e)return l[t];{let s=l[t];for(let i=1;i<e;i++)s+=l[t+i];return s}}const o=i.rows,a=i.firstChild.children,A=a.length,l=new Array(A);for(let t=0;t<A;t++){const e=a[t],s=e.$_w;l[t]=this._toHwp(isNaN(s)?+e.dataset.width:s)}this.RowCount=o.length,this.ColCount=A,this._rows=[];for(let i=0,a=this.RowCount;i<a;i++){const a=o[i],l=getComputedStyle(a),h=Ve.cssToColor(l.backgroundColor),d=a.cells,c=this._toHwp(a.offsetHeight),u=new pP;for(let o=0;o<A;o++){const a=d[o],A=a.style,l=getComputedStyle(a);if("none"===l.display)continue;const p=new uP,_=Ve.cssToColor(l.backgroundColor)||h,g=uv(A,l);p.RowAddr=i,p.ColAddr=o,p.RowSpan=a.rowSpan||1,p.ColSpan=a.colSpan||1,p.Width=n(o,p.ColSpan),p.Height=c,p.BorderFill=_&&g?t.getBorderFillByCell(Ve.lighten(_.color,_.alpha),g):_?t.getBorderFillByColor(Ve.lighten(_.color,_.alpha),1):g?t.getBorderFillByBorders(g):2;const f=p.add(eP),m=null===(r=a.firstElementChild)||void 0===r?void 0:r.firstElementChild;if(m){const i=m instanceof HTMLElement&&e.models[m.dataset._m_];if(i instanceof wr){const e=this.$_createDboxRun(t,i,m);p.addElement(e),p.setAlign(t,_P[a.dataset._align])}else if(i instanceof cr){const e=a.getElementsByClassName(vl.SPAN)[0];if(e){const s=p.textElement,i=getComputedStyle(e),r=t.getCharShape(i);f.setText(e.textContent),s.CharShape=r,"pre-wrap"===i.whiteSpace?p.setWrap(t):p.setAlign(t,_P[a.dataset._align])}}else if(m instanceof HTMLElement){const i=s.createCellElement(t,e,m);if(i){for(let t of i)p.addElement(t);p.setAlign(t,_P[a.dataset._align])}}}u.addCell(p)}this._rows.push(u)}return this}buildBox(t,e,s,i,r){const n=Array.from(i.firstElementChild.children),o=r instanceof mr,a=o?1:n.length,A=o?n.length:1,l=r.getItemGap(i.offsetWidth),h=r.itemsAlign,d=i.offsetWidth,c=i.offsetHeight,u=new Array(a),p=new Array(A);if(o){u[0]=this._toHwp(d);let t=0;for(let e=0;e<A;e++){const s=n[e].offsetHeight+l;p[e]=this._toHwp(s),t+=s}t<c&&h!==_r.MIDDLE&&(h===_r.END?(n.unshift(null),p.unshift(this._toHwp(c-t))):(n.push(null),p.push(this._toHwp(c-t))))}else{p[0]=this._toHwp(c);let t=0;for(let e=0;e<a;e++){const s=n[e].offsetWidth+l;u[e]=this._toHwp(s),t+=s}t<d&&h!==_r.MIDDLE&&(h===_r.END?(n.unshift(null),u.unshift(this._toHwp(d-t))):(n.push(null),u.push(this._toHwp(d-t))))}this.RowCount=p.length,this.ColCount=u.length,this._rows=[];for(let i=0;i<p.length;i++){const r=new pP;for(let A=0;A<u.length;A++){const l=new uP;l.RowAddr=i,l.ColAddr=A,l.RowSpan=1,l.ColSpan=1,l.Width=u[A],l.Height=p[i];const h=l.add(eP),_=n[i*a+A];if(_){const i=_ instanceof HTMLElement&&e.models[_.dataset._m_];if(o){const e=i.getLeft(d),s=i.getRight(d);(isNaN(e)||isNaN(s))&&isNaN(e)?isNaN(s)?l.setAlign(t,fE.Center):(l.setAlign(t,fE.Right),l.setMargin(NaN,this._toHwp(s),NaN,NaN)):l.setMargin(this._toHwp(e),NaN,NaN,NaN)}else{const t=i.getTop(c),e=i.getBottom(c);(isNaN(t)||isNaN(e))&&isNaN(t)?isNaN(e)||(l.setVAlign("Bottom"),l.setMargin(NaN,NaN,NaN,this._toHwp(e))):(l.setVAlign("Top"),l.setMargin(NaN,NaN,this._toHwp(t),NaN))}if(i instanceof wr){const e=this.$_createDboxRun(t,i,_);l.addElement(e)}else if(i instanceof cr){const e=_.getElementsByClassName(vl.SPAN)[0];if(e){const s=l.textElement,i=getComputedStyle(e),r=t.getCharShape(i);h.setText(e.textContent),s.CharShape=r,"pre-wrap"===i.whiteSpace&&l.setWrap(t)}}else if(_ instanceof HTMLElement){const i=s.createCellElement(t,e,_);if(i)for(let t of i)l.addElement(t)}}r.addCell(l)}this._rows.push(r)}return this}$_createDboxRun(t,e,s){let i=pv(0,s);const r=t.addImage(i,"1"),n=new lP,o=t.getDomBounds(s);return n.init().setId(r).setBounds(o.x,o.y,o.width,o.height,!!t.inTable),n}}gP.TAG="TABLE";const fP=["borderTopStyle","borderBottomStyle","borderLeftStyle","borderRightStyle"],mP=["borderTopColor","borderBottomColor","borderLeftColor","borderRightColor"];class wP{constructor(){}createCellElement(t,e,s){const i=[];return function s(i,r,n){const o=e.models[r.dataset._m_];if(!o||o instanceof wr||n.push(...i.$_createBounds(t,r)),o instanceof za){const e=r.firstElementChild.childNodes;for(let r=0;r<e.length;r++){const o=e[r];o instanceof HTMLElement?s(i,o,n):o instanceof Text&&n.push(i.$_createText(t,o))}}else if(o instanceof jo)n.push(i.$_createPicture(t,r));else if(o instanceof Ca)n.push(i.$_createSvg(t,r));else if(o instanceof ha)n.push(i.$_createQrcode(t,r));else if(o instanceof Yo)n.push(...i.$_createCheck(t,r));else if(o instanceof wr)n.push(i.$_createDiagonalLine(t,r,o.reversed));else if(o instanceof gr)n.push(i.$_createBox(t,e,r,o));else if(r instanceof HTMLTableElement)n.push(i.$_createTable(t,e,r));else if(r instanceof HTMLSpanElement)o instanceof wr&&r.dataset.line?n.push(this.$_createDiagonalLine(t,r,o.reversed)):n.push(i.$_createText(t,r));else if(r instanceof SVGSVGElement)n.push(i.$_createSvg(t,r));else if(r instanceof HTMLCanvasElement)n.push(i.$_createCanvas(t,r));else if(r instanceof HTMLElement){const t=r.children;for(let e=0;e<t.length;e++)t[e]instanceof Element&&s(i,t[e],n)}}(this,s,i),i}build(t,e,s){e.forEach(((e,i)=>{const r=this.$_buildPage(s.setPageDiv(e.page),t,e),n=s.body.section.addPara(),o=n.addText(0===i);t.paper.orientation===FA.LANDSCAPE&&o.secDef.setLandscape(),r.forEach((t=>{t&&o.addElement(t)})),i>0&&(n.PageBreak=!0)}))}$_createBounds(t,e){let s=t.getDomBounds(e);const i=getComputedStyle(e),r=Ve.cssToColor(i.backgroundColor),n=[];if(r){const i=new dP(!0,!1);s=t.getDomBounds(e),i.setBounds(s.x,s.y,s.width,s.height,!!t.inTable).setZOrder(0).setColor(r.color,r.alpha),n.push(i)}return fP.forEach(((r,o)=>{const a=i[r];if(a&&"none"!=a){let r,A,l,h;switch(s||(s=t.getDomBounds(e)),o){case 0:r=s.x,l=s.x+s.width,A=h=s.y;break;case 1:r=s.x,l=s.x+s.width,A=h=s.y+s.height;break;case 2:r=l=s.x,A=s.y,h=s.y+s.height;break;case 3:r=l=s.x+s.width,A=s.y,h=s.y+s.height}const d=Ve.cssToColor(i[mP[o]]),c=new hP(r,A,l,h,!!t.inTable);c.setStyle(a).setColor(d.color,d.alpha),n.push(c)}})),n}$_createText(t,e){const s=e.textContent;if(s){const i=e instanceof Text?t.getTextBounds(e):t.getDomBounds(e),r=new dP(!1,!0),n=t.getCharShape(e instanceof Text?e.parentElement:e);return r.setBounds(i.x,i.y,i.width,i.height,!!t.inTable).setText(s,n).setDebug(wP.DEBUG),r}}$_createPicture(t,e){const s=t.getDomBounds(e),i=getComputedStyle(e),r=J.getImageUrl(i),n=t.addImage(r,i.opacity),o=new lP;return o.init().setId(n).setBounds(s.x,s.y,e.clientWidth,e.clientHeight,!!t.inTable),o}$_createCheck(t,e){const s=e.getElementsByClassName(Pl.CHECK_CLASS)[0],i=this.$_createPicture(t,s),r=e.getElementsByClassName(Pl.TEXT_CLASS)[0];return[i,this.$_createText(t,r)]}$_createSvg(t,e){let s,i=e instanceof SVGSVGElement?e:null;if(i)s=(new XMLSerializer).serializeToString(i);else{const t=e._svg_;s=t.substring(t.indexOf("<svg"))}const r=new Blob([s],{type:"image/svg+xml;charset=utf-8"}),n=(window.URL||window.webkitURL).createObjectURL(r),o=t.addImage(n,"1"),a=new lP;a.init().setId(o);const A=t.getDomBounds(e);return a.setBounds(A.x,A.y,A.width,A.height,!!t.inTable),a}$_createCanvas(t,e){const s=e.toDataURL(),i=t.addImage(s,"1"),r=new lP,n=t.getDomBounds(e);return r.init().setId(i).setBounds(n.x,n.y,n.width,n.height,!!t.inTable),r}$_createQrcode(t,e){let s=null;const i=t.getDomBounds(e),r=getComputedStyle(e),n=e.querySelector("img");n&&(s=n.src);const o=t.addImage(s,r.opacity),a=new lP;return a.init().setId(o).setBounds(i.x,i.y,e.clientWidth,e.clientHeight,!!t.inTable),a}$_createTable(t,e,s){const i=new gP,r=t.getDomBounds(s),n=t.inTable;i.BorderFill=2,i.setBounds(r.x,r.y,r.width,r.height,!!t.inTable),t.inTable=i;try{i.build(t,e,this,s)}finally{t.inTable=n}return i}$_createBox(t,e,s,i){const r=new gP,n=t.getDomBounds(s),o=t.inTable;r.BorderFill=2,r.setBounds(n.x,n.y,n.width,n.height,!!t.inTable),t.inTable=r;try{r.buildBox(t,e,this,s,i)}finally{t.inTable=o}return r}$_createDiagonalLine(t,e,s){const i=t.getDomBounds(e);return s?new hP(i.x,i.y+i.height,i.x+i.width,i.y,!!t.inTable):new hP(i.x,i.y,i.x+i.width,i.y+i.height,!!t.inTable)}$_buildItem(t,e,s,i){const r=s instanceof HTMLElement&&e.models[s.dataset._m_];if(r&&!(r instanceof wr)){const e=this.$_createBounds(t,s);J.push(i,e)}if(r instanceof za){const r=s.firstElementChild.childNodes;for(let s=0;s<r.length;s++){const n=r[s];n instanceof HTMLElement?this.$_buildItem(t,e,n,i):n instanceof Text&&i.push(this.$_createText(t,n))}}else if(r instanceof jo)i.push(this.$_createPicture(t,s));else if(r instanceof Ca)i.push(this.$_createSvg(t,s));else if(r instanceof ha)i.push(this.$_createQrcode(t,s));else if(r instanceof Yo)i.push(...this.$_createCheck(t,s));else if(s instanceof HTMLTableElement)i.push(this.$_createTable(t,e,s));else if(s instanceof HTMLSpanElement)r instanceof wr&&s.dataset.line?i.push(this.$_createDiagonalLine(t,s,r.reversed)):i.push(this.$_createText(t,s));else if(s instanceof HTMLElement&&"B"===s.tagName)i.push(this.$_createText(t,s));else if(s instanceof SVGSVGElement)i.push(this.$_createSvg(t,s));else if(s instanceof HTMLCanvasElement)i.push(this.$_createCanvas(t,s));else if(s instanceof HTMLElement){const r=s.children;for(let s=0;s<r.length;s++)r[s]instanceof Element&&this.$_buildItem(t,e,r[s],i)}}$_buildBackground(t,e,s,i){this.$_buildItem(t,e,s,i)}$_buildForeground(t,e,s,i){this.$_buildItem(t,e,s,i)}$_buildPageHeader(t,e,s,i){this.$_buildItem(t,e,s,i)}$_buildPageFooter(t,e,s,i){this.$_buildItem(t,e,s,i)}$_buildPageBody(t,e,s,i){for(let r of s)this.$_buildItem(t,e,r,i)}$_buildPage(t,e,s){const i=[];return this.$_buildBackground(t,e,s.background,i),this.$_buildPageHeader(t,e,s.pageHeader,i),this.$_buildPageBody(t,e,s.contents,i),this.$_buildPageFooter(t,e,s.pageFooter,i),this.$_buildForeground(t,e,s.foreground,i),i}}wP.DEBUG=!1;const yP="\r\n",CP=/\<|\>|\&|\"/;class bP{constructor(t){this._root=t}get root(){return this._root}addChild(t,e,s,i){const r={tag:e,attrs:s};return(t=t||this._root).children||(t.children=[]),t.children.push(r),r}setAttr(t,e,s){var i;void 0!==s?(t.attrs||(t.attrs={}),t.attrs[e]=(i=String(s),CP.test(i)?i.replace(/\&/g,"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\"/g,"&quot;"):i)):t.attrs&&delete t.attrs[e]}setValue(t,e){void 0!==e?t.value=e:delete t.value}toString(){let t='<?xml version="1.0" encoding="utf-8"?>\r\n';return t+="<!DOCTYPE ".concat(this._root.tag,">").concat(yP),t+=this.$_toStr(this._root),t}$_toStr(t){let e="<".concat(t.tag);for(let s in t.attrs)e+=" ".concat(s,'="').concat(t.attrs[s],'"');if(t.children||void 0!==t.value){if(e+=">",void 0!==t.value&&(e+=t.value),t.children){e+="".concat(yP);for(let s of t.children)e+=this.$_toStr(s)}e+="</".concat(t.tag,">")}else e+="/>";return"".concat(e).concat(yP)}}class vP extends TE{constructor(){super(),this.Version="2.8",this.Style="embed",this.SubVersion="8.0.0.0",this._head=new lx,this._body=new dx,this._tail=new px}get head(){return this._head}get body(){return this._body}get tail(){return this._tail}addImageBin(t,e,s){this._head.addBin(t,e),this._tail.addImageBin(t,s)}get tag(){return"HWPML"}}vP.TAG="HWPML";class BP extends TE{}BP.TAG="DOCSUMMARY";class EP extends TE{constructor(){super(...arguments),this.Page=1,this.Footnote=1,this.Endnote=1,this.Picture=1,this.Table=1,this.Equation=1}}EP.TAG="BEGINNUMBER";class PP extends TE{}PP.TAG="CARETPOS";class xP extends TE{constructor(){super(...arguments),this._beginNumber=new EP,this._caretPos=new PP}}xP.TAG="DOCSETTING";class SP extends TE{constructor(){super(...arguments),this.Type="Embedding",this.Format="jpg"}}SP.TAG="BINITEM";class IP extends OE{constructor(){super(...arguments),this._items=[],this.Count=0}add(t,e){const s=new SP;s.BinData=t,s.Format=e,this._items.push(s),this.Count++}get count(){return this.Count}}IP.TAG="BINDATALIST";class RP extends TE{constructor(){super(...arguments),this.FamilyType=2,this.SerifStyle=11,this.Weight=6,this.Proportion=0,this.Contrast=0,this.StrokeVariation=1,this.ArmStyle=1,this.LetterForm=1,this.MidLine=1,this.XHeight=1}}RP.TAG="TYPEINFO";class TP extends TE{constructor(){super(...arguments),this._typeInfo=new RP}}TP.TAG="FONT";class OP extends TE{constructor(){super(...arguments),this._fonts=[]}add(t){this._fonts.push(t)}}OP.TAG="FONTFACE";class FP extends OE{constructor(){super(),this._faces=[];const t=["맑은 고딕","굴림","바탕","돋움"];["Hangul","Latin","Hanja","Japanese","Other","Symbol","User"].forEach((e=>{const s=new OP;s.Lang=e,s.Count=t.length,t.forEach(((t,e)=>{const i=new TP;i.Id=e,i.Type="ttf",i.Name=t,s.add(i)})),this._faces.push(s)}))}get count(){return this._faces.length}}FP.TAG="FACENAMELIST";class DP extends TE{constructor(){super(...arguments),this.Type=cE.Solid,this.Width="0.12mm",this.Color=0}setStyles(t){const e=Ve.cssToColor(t.color,!1),s=t.style;if(s)if("none"===s)this.Type=cE.None;else this.Type=cE.Solid;return e&&(0===e.alpha&&(this.Type=cE.None),this.Color=hE(e.color)),this}sameWithStyles(t){const e=Ve.cssToColor(t.color,!1),s=e&&0===e.alpha?"none":t.style;if(s)if("none"===s){if(this.Type!==cE.None)return!1}else if(this.Type!==cE.Solid)return!1;return!e||this.Color===hE(e.color)}}class LP extends DP{}LP.TAG="LEFTBORDER";class NP extends DP{}NP.TAG="RIGHTBORDER";class HP extends DP{}HP.TAG="TOPBORDER";class QP extends DP{}QP.TAG="BOTTOMBORDER";class UP extends DP{}UP.TAG="DIAGONAL";const MP={style:"solid",color:"rgb(0,0,0)"};class kP extends TE{constructor(){super(...arguments),this._leftBorder=new LP,this._rightBorder=new NP,this._topBorder=new HP,this._bottomBorder=new QP,this._diagonal=new UP,this.ThreeD=!1,this.Shadow=!1,this.Slash=0,this.BackSlash=0,this.CrookedSlash=0,this.CounterSlash=0,this.CounterBackSlash=0,this.BreakCellSeparateLine=0,this.$_borders=[this._leftBorder,this._rightBorder,this._topBorder,this._bottomBorder,this._diagonal]}setSimple(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0.12mm";return this.$_borders.forEach((s=>{s.Type=t,s.Width=e})),this}setFill(t,e){let s=this._fillBrush;return s||(s=this._fillBrush=new ME),s.setColor(t,e),this}sameFill(t,e){return this._fillBrush&&this._fillBrush.sameWithColor(t,e)}setBorders(t){return t.left&&this._leftBorder.setStyles(t.left),t.right&&this._rightBorder.setStyles(t.right),t.top&&this._topBorder.setStyles(t.top),t.bottom&&this._bottomBorder.setStyles(t.bottom),this}sameBorders(t){return!!this._leftBorder.sameWithStyles(t.left||MP)&&(!!this._rightBorder.sameWithStyles(t.right||MP)&&(!!this._topBorder.sameWithStyles(t.top||MP)&&!!this._bottomBorder.sameWithStyles(t.bottom||MP)))}}kP.TAG="BORDERFILL";class VP extends OE{constructor(){super(),this._fills=[],this.Count=0,this.addSimple(cE.None,"0.1mm"),this.addSimple(cE.Solid,"0.12mm")}addSimple(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0.12mm";const s=new kP;return s.setSimple(t,e),s.Id=++this.Count,this._fills.push(s),s}findByFill(t,e){for(let s of this._fills)if(s.sameFill(t,e))return s}findByBorders(t){for(let e of this._fills)if(e.sameBorders(t))return e}findByCell(t,e){for(let s of this._fills)if(s.sameFill(t,1)&&s.sameBorders(e))return s}getByFill(t,e){let s=this.findByFill(t,e);return s||(s=(new kP).setFill(t,e),s.Id=++this.Count,this._fills.push(s)),s.Id}getByBorders(t){let e=this.findByBorders(t);return e||(e=(new kP).setBorders(t),e.Id=++this.Count,this._fills.push(e)),e.Id}getByCell(t,e){let s=this.findByCell(t,e);return s||(s=(new kP).setFill(t,1).setBorders(e),s.Id=++this.Count,this._fills.push(s)),s.Id}get count(){return this.Count}}VP.TAG="BORDERFILLLIST";class GP extends TE{constructor(){super(...arguments),this.Hangul=0,this.Latin=0,this.Hanja=0,this.Japanese=0,this.Other=0,this.Symbol=0,this.User=0}static create(t){return(new GP).setId(t)}setId(t){return this.Hangul=this.Latin=this.Hanja=this.Japanese=this.Other=this.Symbol=this.User=t,this}}GP.TAG="FONTID";class KP extends TE{constructor(){super(...arguments),this.Hangul=100,this.Latin=100,this.Hanja=100,this.Japanese=100,this.Other=100,this.Symbol=100,this.User=100}static create(t){const e=new KP;return e.Hangul=e.Latin=e.Hanja=e.Japanese=e.Other=e.Symbol=e.User=t,e}}KP.TAG="RATIO";class WP extends TE{constructor(){super(...arguments),this.Hangul=0,this.Latin=0,this.Hanja=0,this.Japanese=0,this.Other=0,this.Symbol=0,this.User=0}static create(t){const e=new WP;return e.Hangul=e.Latin=e.Hanja=e.Japanese=e.Other=e.Symbol=e.User=t,e}}WP.TAG="CHARSPACING";class zP extends TE{constructor(){super(...arguments),this.Hangul=100,this.Latin=100,this.Hanja=100,this.Japanese=100,this.Other=100,this.Symbol=100,this.User=100}static create(t){const e=new zP;return e.Hangul=e.Latin=e.Hanja=e.Japanese=e.Other=e.Symbol=e.User=t,e}}zP.TAG="RELSIZE";class $P extends TE{constructor(){super(...arguments),this.Hangul=0,this.Latin=0,this.Hanja=0,this.Japanese=0,this.Other=0,this.Symbol=0,this.User=0}static create(t){const e=new $P;return e.Hangul=e.Latin=e.Hanja=e.Japanese=e.Other=e.Symbol=e.User=t,e}}$P.TAG="CHAROFFSET";class XP extends TE{}XP.TAG="ITALIC";class jP extends TE{}jP.TAG="BOLD";class YP extends TE{constructor(){super(...arguments),this.Type="Bottom",this.Shape=uE.Solid,this.Color=0}}YP.TAG="UNDERLINE";(class extends TE{constructor(){super(...arguments),this.Type="Continuous",this.Shape=uE.Solid,this.Color=0}}).TAG="STRIKEOUT";(class extends TE{constructor(){super(...arguments),this.Type=pE.Solid}}).TAG="OUTLINE";(class extends TE{}).TAG="EMBOSS";(class extends TE{}).TAG="ENGRAVE";(class extends TE{}).TAG="SUPERSCRIPT";(class extends TE{}).TAG="SUBSCRIPT";class JP extends TE{constructor(){super(...arguments),this.Height=1e3,this.TextColor=0,this.ShadeColor=4294967295,this.UseFontSpace=!1,this.UseKerning=!1,this.SymMark=0}static createSimple(t,e,s,i,r,n){const o=new JP;return o.Height=Math.round(100*e),o.TextColor=s,o._fontId=GP.create(t),o._ratio=KP.create(100),o._charSpacing=WP.create(0),o._relSize=zP.create(100),o._charOffset=$P.create(0),i&&(o._bold=new jP),r&&(o._italic=new XP),n&&(o._underline=new YP),o}same(t,e,s,i,r,n){return this._fontId.Hangul===t&&Math.round(this.Height/100)===e&&this.TextColor===s&&(!(i&&!this._bold)&&(r===!!this._italic&&n===!!this._underline))}}JP.TAG="CHARSHAPE";class ZP extends OE{constructor(){super(...arguments),this._charShapes=[],this.Count=0}add(t,e,s,i,r,n){let o;for(let a of this._charShapes)if(a.same(t,e,s,i,r,n)){o=a;break}return o||(o=JP.createSimple(t,e,s,i,r,n),o.Id=this.Count++,this._charShapes.push(o)),o.Id}get(t){return this._charShapes[t]}get count(){return this.Count}}ZP.TAG="CHARSHAPELIST";(class extends TE{constructor(){super(...arguments),this.Type="Left",this.Leader=uE.Solid}}).TAG="TABITEM";class qP extends TE{constructor(){super(...arguments),this.AutoTabLeft=!1,this.AutoTabRight=!1}}qP.TAG="TABDEF";class tx extends OE{constructor(){super(...arguments),this._defs=[],this.Count=0}add(t){return this._defs.push(t),t.Id=this.Count++}addDef(t,e){const s=new qP;return s.AutoTabLeft=t,s.AutoTabRight=e,this.add(s),s}get(t){return this._defs[t]}get count(){return this.Count}}tx.TAG="TABLELIST";(class extends TE{constructor(){super(...arguments),this.Alignment="Left",this.UseInstWidth=!0,this.AutoIndent=!0,this.WidthAdjust=0,this.TextOffsetType="percent",this.TextOffset=50,this.NumFormat=_E.Digit}}).TAG="PARAHEAD";(class extends TE{constructor(){super(...arguments),this._paraheads=[],this.Start=0}}).TAG="NUMBERING";class ex extends OE{constructor(){super(...arguments),this._numberings=[],this.Count=0}get count(){return this.Count}}ex.TAG="NUMBERINGLIST";(class extends TE{constructor(){super(...arguments),this.Image=!1}}).TAG="BULLET";class sx extends OE{constructor(){super(...arguments),this._bullets=[],this.Count=0}get count(){return this.Count}}sx.TAG="BULLETLIST";(class extends TE{constructor(){super(...arguments),this.Connect=!1,this.IgnoreMargin=!1}}).TAG="PARABORDER";class ix extends TE{constructor(){super(...arguments),this.Indent=0,this.Left=0,this.Right=0,this.Prev=0,this.Mext=0,this.LineSpacingType="Percent",this.LineSpacing=130}}ix.TAG="PARAMARGIN";class rx extends TE{constructor(){super(...arguments),this.Align=fE.Justify,this.VertAlign="Baseline",this.HeadingType="None",this.Level=0,this.BreakLatinWord="KeepWord",this.BreakNonLatinWord=!0,this.Condense=0,this.WindowOrphan=!1,this.KeepWithNext=!1,this.KeepLines=!1,this.PageBreakBefore=!1,this.FontLineHeight=!1,this.SnapToGrid=!0,this.LineWrap=BE.Break,this.AutoSpaceEAsianEng=!0,this.AutoSpaceEAsianNum=!0}static create(t,e,s){const i=new rx(s);return i._margin=t,i._border=e,i}sameWith(){return!1}}rx.TAG="PARASHAPE";class nx extends OE{constructor(){super(),this._shapes=[],this.Count=0,this.add(fE.Left)}get(t){return this._shapes[t]}add(t){for(let e of this._shapes)if(e.Align===t)return e;const e=new rx;return e.Id=this.Count++,e.Align=t,this._shapes.push(e),e}addWrap(){if(!this._wrap){const t=this._wrap=rx.create(new ix,null,null);t.Id=this.Count++,t.Align=fE.Center,this._shapes.push(t)}return this._wrap}get count(){return this.Count}}nx.TAG="PARASHAPELIST";(class extends TE{constructor(){super(...arguments),this.Id=-1,this.Type="Para"}}).TAG="STYLE";class ox extends OE{constructor(){super(...arguments),this._styles=[],this.Count=0}add(t){return this._styles.push(t),t.Id=this.Count++}get count(){return this.Count}}ox.TAG="STYLELIST";(class extends TE{constructor(){super(...arguments),this.Width=0}}).TAG="MEMO";class ax extends OE{constructor(){super(...arguments),this._memos=[],this.Count=0}get count(){return this.Count}}ax.TAG="MEMOSHAPELIST";class Ax extends TE{constructor(){super(),this._binDataList=new IP,this._faceNameList=new FP,this._borderFillList=new VP,this._charShapeList=new ZP,this._tabDefList=new tx,this._numberingList=new ex,this._bulletList=new sx,this._paraShapeList=new nx,this._styleList=new ox,this._memoShapeList=new ax}get borderFillList(){return this._borderFillList}get charShapeList(){return this._charShapeList}get paraShapeList(){return this._paraShapeList}addBin(t,e){this._binDataList.add(t,e)}}Ax.TAG="MAPPINGTABLE";class lx extends TE{constructor(){super(),this._docSummary=new BP,this._docSetting=new xP,this._mappingTable=new Ax}get docSummary(){return this._docSummary}get docSetting(){return this._docSetting}get mappingTable(){return this._mappingTable}addBin(t,e){this._mappingTable.addBin(t,e)}addCharShape(t,e,s,i,r,n){return this._mappingTable.charShapeList.add(t,e,s,i,r,n)}addParaShape(t){return this._mappingTable.paraShapeList.add(t).Id}addParaShapeWrap(){return this._mappingTable.paraShapeList.addWrap().Id}}lx.TAG="HEAD";class hx extends TE{constructor(){super(...arguments),this._paras=[]}addPara(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=new ZE;return t&&e.addText(!1,!1),this._paras.push(e),e}}hx.TAG="SECTION";class dx extends TE{constructor(){super(),this._sections=[];const t=new hx;t.Id=0,this._sections.push(t)}get section(){return this._sections[0]}}dx.TAG="BODY";class cx extends TE{constructor(){super(...arguments),this.Encoding="Base64"}get text(){return this._text}}cx.TAG="BINDATA";class ux extends TE{constructor(){super(...arguments),this._data=[]}addImage(t,e){const s=new cx;return s.Id=t,s.Size=e.length,s._text=e,this._data.push(s),s}}ux.TAG="BINDATASTORAGE";class px extends TE{constructor(){super(...arguments),this._bindDataStorage=new ux}getBinData(t){return this._bindDataStorage[t]}addImageBin(t,e){return this._bindDataStorage.addImage(t,e)}}px.TAG="TAIL";class _x{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._imgId=1,this._imgMap={},this.debug=t,this._imageLoader=new cv,this._root=new vP}static write(t,e,s){const{elements:i,attrs:r}=e.getContent();for(let e in r)t.setAttr(s,e,r[e]);const n=e.text;n&&t.setValue(s,n);for(let e of i)if(!(e instanceof OE)||e.count>0){const i=t.addChild(s,e.tag);this.write(t,e,i)}}static toXml(t){const e=new bP({tag:t.tag});return this.write(e,t,e.root),e.toString()}get body(){return this._root.body}get head(){return this._root.head}get tail(){return this._root.tail}addImage(t,e){let s=this._imgMap[t];if(!s){t.indexOf("base64,")<0&&this._imageLoader.add(t,e),s=this._imgMap[t]=String(this._imgId++)}return+s}getBorderFillByColor(t,e){return this.head.mappingTable.borderFillList.getByFill(t,e)}getBorderFillByBorders(t){return this.head.mappingTable.borderFillList.getByBorders(t)}getBorderFillByCell(t,e){return this.head.mappingTable.borderFillList.getByCell(t,e)}getCharShape(t){const e=t instanceof HTMLElement?getComputedStyle(t):t,s=tP.getFontSize(e.fontSize),i=tP.getColor(e.color),r=tP.getFontBold(e.fontWeight),n="italic"===e.fontStyle,o=e.textDecoration.indexOf("underline")>=0;return this.addCharShape(0,s,i,r,n,o)}addCharShape(t,e,s,i,r,n){return this._root.head.addCharShape(t,e,s,i,r,n)}prepare(t){return this._imageLoader.load(t)}canExport(){return this._imageLoader.loaded}toXml(){const t=this._root,e=new bP({tag:"HWPML",attrs:{Version:"2.1"}});for(let e in this._imgMap){const s=+this._imgMap[e];let i;i=this._imageLoader.get(e)||e;let r=i.indexOf("base64,");r>=0&&(i=i.substring(r+7)),t.addImageBin(s,"png",i)}return _x.write(e,t,e.root),e}setPageDiv(t){return t!==this._pageDiv&&(this._pageDiv=t,this._pageRect=t.getBoundingClientRect()),this}getDomBounds(t){const e=t.getBoundingClientRect();return e.x-=this._pageRect.x,e.y-=this._pageRect.y,e}getTextBounds(t){const e=J.getTextRect(t);return e.x-=this._pageRect.x,e.y-=this._pageRect.y,e}}class gx{constructor(){}export(t,e,s){if("function"!=typeof s)return;const i=()=>{if(n.canExport()||n.prepare(r)){const t=n.toXml().toString(),e=(new TextEncoder).encode(t);null==s||s(e)}else setTimeout((()=>{i()}),300)},r=5,n=this.$_build(t,e);i()}$_build(t,e){const s=new _x(!0);if(e){(new wP).build(t,e,s)}return s}}class fx extends l{constructor(t){super(),this._root=new wx(this),t&&(this.source=t)}_doDispose(){this._source&&this._source.removeListener(this),this._source=null,super._doDispose()}get source(){return this._source}set source(t){this._source=t,this.$_build(t),this._fireSourceChanged()}get root(){return this._root}get page(){return this._root.page}isRoot(t){return t===this._root}findItem(t){return t===this._root.source?this._root:this._root.itemOf(t,!0)}$_build(t){this._source&&this._source.removeListener(this),this._source=t,this._root.load(t),t.addListener(this)}onReportItemAdded(t,e,s){const i=this._root.itemOf(e.outlineParent);e instanceof Qi&&(e=e.item);const r=new yx(e);s<0&&(s=i.count),i.add(r,s),this._fireItemAdded(r,s)}onReportItemsAdded(t,e,s){const i=this._root.itemOf(e[0].outlineParent),r=[];s<0&&(s=i.count);for(let t=0;t<e.length;t++){let n=e[t];n instanceof Qi&&(n=n.item);const o=new yx(n);i.add(o,s+t),r.push(o)}this._fireItemsAdded(r,s)}onReportItemRemoved(t,e,s){e instanceof Qi&&(e=e.item);const i=this._root.itemOf(e);i&&(this._fireItemRemoved(i),i.delete())}onReportItemsRemoved(t,e){const s=[];for(let t=e.length-1;t>=0;t--){const i=e[t],r=this._root.itemOf(i);r&&s.push(r)}this._fireItemsRemoved(s);for(let t of s)t.delete()}onReportItemChanged(t,e,s,i,r){const n=this._root.itemOf(e);n&&this._fireItemChanged(n)}onReportCollectionChanged(t,e){const s=this._root.itemOf(e);s&&this._fireChildIndexChanged(s)}_fireSourceChanged(){this.fireEvent(fx.SOURCE_CHANGED)}_fireItemAdded(t,e){this.fireEvent(fx.ITEM_ADDED,t,e)}_fireItemsAdded(t,e){this.fireEvent(fx.ITEMS_ADDED,t,e)}_fireItemRemoved(t){this.fireEvent(fx.ITEM_REMOVED,t)}_fireItemsRemoved(t){this.fireEvent(fx.ITEMS_REMOVED,t)}_fireItemChanged(t){this.fireEvent(fx.ITEM_CHANGED,t)}_fireChildIndexChanged(t){this.fireEvent(fx.CHILDE_INDEX_CHANGED,t)}}fx.SOURCE_CHANGED="onOutlineSourceChanged",fx.ITEM_ADDED="onOutlineItemAdded",fx.ITEMS_ADDED="onOutlineItemsAdded",fx.ITEM_REMOVED="onOutlineItemRemoved",fx.ITEMS_REMOVED="onOutlineItemsRemoved",fx.ITEM_CHANGED="onOutlineItemChanged",fx.CHILDE_INDEX_CHANGED="onOutlineChildIndexChanged";class mx extends A{constructor(){super()}get source(){}get count(){return this._children?this._children.length:0}get displayText(){return this.source.outlineLabel}get expandable(){return this.source.outlineExpandable}get removable(){return this.source.canRemoveFrom()}get(t){return this._children[t]}getSourceType(){return this.source.getSaveType()}itemOf(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._children)for(let s of this._children){if(s.source===t)return s;if(e){const e=s.itemOf(t,!0);if(e)return e}}}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this._addItem(t,e)}clear(){this._clear()}delete(){this.removable&&this.parent._removeItem(this)}_attached(t){}_detached(){}_clear(){if(this._children){for(let t of this._children)t._detached();this._children=null}}_addItem(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Z(!!t);const s=this._children=this._children||[];Z(s.indexOf(t)<0),e<0?s.push(t):s.splice(e,0,t),t._attached(this)}_removeItem(t){if(t&&t.removable&&this._children){const e=this._children.indexOf(t);e>=0&&(this._children.splice(e,1),t._detached())}}_sortByOrder(){this._children&&(this._children=this._children.sort(((t,e)=>t.source.outlineOrder-e.source.outlineOrder)))}}class wx extends mx{constructor(t){super(),this._model=t}get page(){return this._page}load(t){this._clear(),this._addItem(this._page=new yx(t.page))}get outline(){return this._model}get source(){return this._page.source.outlineParent}get parent(){return null}get displayText(){return"Report"}get expandable(){return!0}getSourceType(){return"report"}_clear(){super._clear(),this._page=null}}class yx extends mx{constructor(t){super(),Z(!!t),this._load(this._source=t)}load(){this._load(this._source)}get outline(){return this._parent&&this._parent.outline}get parent(){return this._parent}get source(){return this._source}_attached(t){this._parent=t,super._attached(t)}_detached(){this._parent=null,super._detached()}_load(t){const e=t.outlineItems;if(e){for(let t of e){t instanceof Qi&&(t=t.item);const e=new yx(t);this._addItem(e)}this._sortByOrder()}}}class Cx extends q{constructor(t,e){super(t,e)}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}measure(t,e){const s=this._doMeasure(t,e);return this._measuredWidth=s.width,this._measuredHeight=s.height,s}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(t){}_doMeasure(t,e){return new Me(t,e)}_doLayoutContent(){}}class bx extends Cx{constructor(t,e){super(t,"outlineRowView"),this._expanded=!1,this._vindex=-1,this._focused=!1,this._selected=!1,this._model=e}_doDispose(){super._doDispose()}get model(){return this._model}set model(t){t!==this._model&&(this._model=t)}get parentRow(){return this._parentRow}get level(){return this._parentRow?this._parentRow.level+1:1}get rows(){return this._childRows&&this._childRows.slice()}get rowCount(){return this._childRows?this._childRows.length:0}get expanded(){return this._expanded}set expanded(t){t!=this._expanded&&(this._expanded=t)}get vindex(){return this._vindex}get focused(){return this._focused}get selected(){return this._selected}getChildRow(t){return this._childRows[t]}addChildRow(t,e){return this._childRows||(this._childRows=[]),e=e<0?this._childRows.length:e,this._childRows.splice(e,0,t),t._parentRow=this,e}removeChildRow(t){if(t&&this._childRows){const e=this._childRows.indexOf(t);e>=0&&(this._childRows.splice(e,1),t.clearChildRows())}}clearChildRows(){if(this._childRows){for(let t of this._childRows)t.clearChildRows();this._childRows=null}this._parentRow=null}setFocused(t){t!=this._focused&&(this._focused=t,this.invalidate())}setSelected(t){t!=this._selected&&(this._selected=t,this.invalidate())}_getCssSelector(){let t="rr-outline-row";return this._focused?t+=" rr-outline-row-focus":this._selected&&(t+=" rr-outline-row-select"),t}_getCssDisplay(){return"flex"}_isEmptySize(){return!0}_initDom(t,e){super._initDom(t,e),e.appendChild(this._spanIndent=t.createElement("span")),e.appendChild(this._spanExpander=t.createElement("span")),e.appendChild(this._spanText=t.createElement("span")),this._spanText.className="rr-outline-label"}_doDraw(t){}_doMeasure(t,e){const s=this.model.getSourceType();s?this._dom.dataset.type=s:delete this._dom.dataset.type,this._spanIndent.style.minWidth=8+bx.INDENT_SIZE*(this.level-1)+"px";let i="";return i=this._model.expandable&&this._childRows&&this._childRows.length>0?this.expanded?"rr-outline-expander rr-outline-expander-expanded":"rr-outline-expander rr-outline-expander-collapsed":"rr-outline-expander",this._spanExpander.className=i,this._spanExpander.$_rvu=this.vindex,this._spanText.textContent=this._model.displayText,new Me(300,25)}_doLayoutContent(){}}bx.INDENT_SIZE=10;class vx extends Cx{constructor(t){super(t.doc,"outlineBodyView"),this._visibleRows=[],this._rows=[],this._rowPool=[],this._rowPoints=[0],this._viewer=t}_doDispose(){super._doDispose()}get visibleRowCount(){return this._visibleRows.length}get rowCount(){return this._rows.length}get focusedRow(){return this._focusedRow}get contentHeight(){return this._rowPoints[this._rowPoints.length-1]}get contentWidth(){return this.width}getVisible(t){return this._visibleRows[t]}getVisibleItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=this._visibleRows;if(t=Math.max(0,t),e=e<0?s.length=1:Math.min(e,s.length-1),e<t){const s=t;t=e,e=s}const i=[];for(let r=t;r<=e;r++)i.push(s[r].model);return i}findVisibleRow(t){return this.$_findRow(this._visibleRows,t)}findRow(t){return this.$_findRow(this._rows,t)}loadRows(t){if(this.clear(),!t)return;let e=this._root=this.$_borrowRow(t.root);this._rows.push(e),this._visibleRows.push(e),this.addChild(e),this.$_loadRows(e)}refreshChildren(t){this.findRow(t)&&(this.removeChildren(t),t.clear(),t.load(),this.addChildren(t))}addRow(t,e){let s=this.findRow(t.parent);if(s){const i=this.$_borrowRow(t);if(e=s.addChildRow(i,e),s=this.findVisibleRow(s.model),s&&s.expanded){const t=s.level,r=this._visibleRows,n=r.indexOf(s);let o=n+1;if(e>0)for(let i=n+1,a=r.length;i<a;i++){const n=r[i];if(n.parentRow==s){if(0==--e){for(;r[i].level>t;)i++;o=i;break}}else if(n.level<=t){o=i-1;break}}r.splice(o,0,i)}this.addChild(i),this._rows.push(i),this.invalidateLayout();for(let e=0;e<t.count;e++)this.addRow(t.get(e),e)}}addChildren(t){for(let e=0;e<t.count;e++)this.addRow(t.get(e),e)}removeChildren(t){for(let e=t.count-1;e>=0;e--)this.removeRow(t.get(e))}removeRow(t){for(let e=0;e<t.count;e++)this.removeRow(t.get(e));let e=this.findRow(t.parent);if(e){let s=this.findRow(t);if(s){e.removeChildRow(s);let i=this._rows.indexOf(s);this._rows.splice(i,1);const r=this.findVisibleRow(t);if(r){const t=this._visibleRows,e=t.indexOf(r);t.splice(e,1)}this.removeChild(s),this.$_returnRow(s),this.invalidateLayout()}}}removeRows(t){for(let e of t)this.removeRow(e)}expand(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((t=t||this._root)&&!t.expanded){const s=this._visibleRows,i=s.indexOf(t)+1;Z(i>0);const r=[];let n=0;t.expanded=!0,this.$_collectVisibleRows(t,r,e);for(let t of r)s.splice(i+n,0,r[n]),n++;this.invalidateLayout()}}expandAll(t){this.collapseAll(t),this.expand(t,Number.MAX_SAFE_INTEGER)}collapse(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((t=t||this._root)&&t.expanded){const s=this.$_hideRows(t,e),i=this._visibleRows.indexOf(t)+1;this._visibleRows.splice(i,s),t.expanded=!1,this.invalidateLayout()}}collapseAll(t){this.collapse(t,!0)}collapseShort(){this.collapseAll(),this.expand(),this.expand(this._root.getChildRow(0))}isVisible(t){for(let e of this._visibleRows)if(e.model===t)return!0}makeVisible(t){const e=this.findRow(t);if(!e||e.vindex>=0)return;let s=e.parentRow,i=0;for(;s;){if(s.vindex>=0){this.expand(s,i);break}s=s.parentRow,i++}}isExpander(t){return t.classList.contains("rr-outline-expander")}rowByExpander(t){return this.getVisible(t.$_rvu)}rowOf(t){let e=t;for(;e;){if(e.classList.contains("rr-outline-row"))for(let t of this._visibleRows)if(t.isDom(e))return t;e=e.parentElement}}getNextVisible(t){const e=this._visibleRows;if(t){const s=t.vindex;return s<e.length-1?e[s+1]:t}return e.length>0?e[0]:null}getPrevVisible(t){const e=this._visibleRows;if(t){const s=t.vindex;return s>0?e[s-1]:t}return e.length>0?e[0]:null}getNextPageVisible(t){if(!t)return this.getNextVisible(t);const e=this._visibleRows,s=this._rowPoints;let i=this.getBoundingRect().height,r=e.length,n=t.vindex;for(;n<r&&(i-=s[n+1]-s[n],!(i<=0));)n++;return e[Math.min(r-1,n)]}getPrevPageVisible(t){if(!t)return this.getPrevVisible(t);const e=this._visibleRows,s=this._rowPoints;let i=this.getBoundingRect().height,r=t.vindex;for(;r>=0&&(i-=s[r+1]-s[r],!(i<=0));)r--;return e[Math.max(0,r)]}get isLayer(){return!0}_getCssSelector(){return"rr-outline-body"}_setSizeStyle(t){}_initDom(t,e){super._initDom(t,e);const s=e.style;s.width="100%",s.height="100%",s.overflow="auto"}clear(){if(super.clear()){for(let t of this._rows)this.$_returnRow(t,!0);return this._rows=[],this._visibleRows=[],!0}}findChildAt(t,e,s,i){return e+=this._dom.scrollTop,super.findChildAt(t,e,s,i)}_doMeasure(t,e){const s=this._viewer;var i=this._rowPoints=[0];this._focusedRow=null;for(let t of this._rows)t.visible=!1,t._vindex=-1,t.setFocused(!1);for(let r=0;r<this._visibleRows.length;r++){const n=this._visibleRows[r],o=n.model;n.visible=!0,n._vindex=r,!this._focusedRow&&s.isFocused(o)&&(n.setFocused(!0),this._focusedRow=n),n.setSelected(s.isSelected(o)),n.measure(t,e),i.push(i[r]+n.measuredHeight)}return new Me(t,i[i.length-1])}scrollToFocused(t,e){const s=this._focusedRow;if(s){const i=this._rowPoints,r=s.vindex;i[r]<t?t=i[r]+(r>0?(i[r-1]-i[r])/2:0):i[r+1]-t>=e&&(t=i[r+1]-e+(r<i.length-1?(i[r+1]-i[r])/2:0))}return t}_doLayoutContent(){const t=this._rowPoints;for(let e=0;e<this._visibleRows.length;e++){const s=this._visibleRows[e];s.move(0,t[e]-0),s.layoutContent()}}$_borrowRow(t){if(this._rowPool.length>0){const e=this._rowPool.pop();return e.model=t,e.expanded=!1,e.invalidate(),e}return new bx(this.doc,t)}$_returnRow(t){t&&(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this._rowPool.indexOf(t)<0)&&(t.clearChildRows(),this._rowPool.push(t),t.validate())}$_loadRows(t){const e=t.model;for(let s=0;s<e.count;s++){const i=e.get(s),r=this.$_borrowRow(i);this._rows.push(r),this.addChild(r),t.addChildRow(r,s),this.$_loadRows(r)}}$_findRow(t,e){if(t)for(let s of t)if(s.model===e)return s}$_collectVisibleRows(t,e,s){for(let i=0;i<t.rowCount;i++){const r=t.getChildRow(i);e.push(r),(r.expanded||s>0)&&(r.expanded=!0,this.$_collectVisibleRows(r,e,s-1))}}$_hideRows(t,e){let s=0;s+=t.rowCount;for(let i=0;i<t.rowCount;i++){const r=t.getChildRow(i);(r.expanded||e)&&(r.expanded=!1,s+=this.$_hideRows(r,e))}return s}}class Bx extends et{constructor(t){super(t,"outlineSelectionTool"),this._viewer=t}_doDispose(){this._viewer=null,super._doDispose()}get viewer(){return this._viewer}_doMouseDown(t){const e=this.mouseEventTarget,s=this._viewer,i=s.bodyView,r=this._clickedRow=i.rowOf(e);return r&&i.isExpander(e)&&(r.expanded?s.collapse(r):s.expand(r)),!0}_doMouseMove(t){}_doMouseUp(t){}_doClick(t,e,s){const i=t.ctrlKey||t.metaKey,r=t.shiftKey,n=this.mouseEventTarget,o=this._viewer,a=o.bodyView,A=a.rowOf(n);if(!a.isExpander(n)&&A&&A===this._clickedRow){const t=A.model;if(i)o.toggleSelect(t),o.focusedItem||(o.focusedItem=t);else if(r){const e=o.lastSelectedItem;if(e){const t=o.bodyView.findVisibleRow(e),s=o.bodyView.getVisibleItems(t.vindex,A.vindex);o.selectAll(s)}else o.select(t);o.focusedItem||(o.focusedItem=t)}else o.clearSelection(t),o.focusedItem=t;o.focusedItem||(o.focusedItem=t)}}_doDblClick(t){const e=this.mouseEventTarget,s=this._viewer,i=s.bodyView.rowOf(e);i&&i===this._clickedRow&&(i.model.expandable?i.expanded?s.collapse(i):s.expand(i):s._fireDoubleClicked(i.model))}_doMouseWheel(t){const e=this._viewer;if(t.shiftKey||Math.abs(t.deltaX)>Math.abs(t.deltaY))return!0;{const s=e.topPos;return e.topPos=s+t.deltaY,!0}}_doMouseEnter(t){}_doMouseLeave(t){}_doMouseOver(t){}_doContextMenu(t){return!1}_doKeyDown(t){const e=t.keyCode,s=this._viewer,i=s.bodyView,r=i.focusedRow,n=s.focusedItem;switch(e){case 40:s.setFocusedRow(i.getNextVisible(r));break;case 38:s.setFocusedRow(i.getPrevVisible(r));break;case 34:s.setFocusedRow(i.getNextPageVisible(r));break;case 33:s.setFocusedRow(i.getPrevPageVisible(r));break;case 36:s.setFocusedRow(i.getVisible(0));break;case 35:s.setFocusedRow(i.getVisible(i.visibleRowCount-1));break;case 37:r&&(r.expanded?i.collapse(r):r.parent&&i.isVisible(n.parent)&&(s.focusedItem=n.parent));break;case 39:r&&(r.expanded?n.count>0&&(s.focusedItem=n.get(0)):i.expand(r))}return super._doKeyDown(t)}_doKeyPress(t){return!1}_doKeyUp(t){return!1}$_findRowView(t){}}class Ex{constructor(){this._items=[]}get items(){return this._items.length>0?this._items.slice():null}get last(){return this._items.length>0?this._items[this._items.length-1]:null}contains(t){return t&&this._items.indexOf(t)>=0}clear(){if(this._items.length>0)return this._items=[],!0}add(t){if(t&&this._items.indexOf(t)<0)return this._items.push(t),!0}addAll(t){if(t&&t.length>0){let e=!1;for(let s of t)this._items.indexOf(s)<0&&(this._items.push(s),e=!0);return e}}remove(t){if(t){const e=this._items.indexOf(t);if(e>=0)return this._items.splice(e,1),!0}}}class Px extends yt{constructor(t){super(t),this._selections=new Ex,this._focusRequested=!1,this.addElement(this._bodyView=new vx(this))}_doDispose(){super._doDispose()}onOutlineSourceChanged(t){this._bodyView.loadRows(this.model),this.invalidateLayout()}onOutlineItemAdded(t,e,s){this._bodyView.addRow(e,s),this.invalidateLayout()}onOutlineItemsAdded(t,e,s){for(let t=0;t<e.length;t++)this._bodyView.addRow(e[t],s+t);this.invalidateLayout()}onOutlineItemRemoved(t,e){this._bodyView.removeRow(e),this.invalidateLayout()}onOutlineItemsRemoved(t,e){this._bodyView.removeRows(e),this.invalidateLayout()}onOutlineItemChanged(t,e){this.invalidateLayout()}onOutlineChildIndexChanged(t,e){e instanceof yx&&this._bodyView.refreshChildren(e)}get model(){return this._model}set model(t){t!==this._model&&(this._model&&this._model.removeListener(this),this._model=t,this._bodyView.loadRows(t),this.invalidateLayout(),this._model&&this._model.addListener(this))}get bodyView(){return this._bodyView}get topPos(){return this._bodyView.scrollTop}set topPos(t){(t=Math.max(0,Math.min(this._bodyView.contentHeight-this.getBound().height,t)))!=this.topPos&&this._bodyView.scrollDom(this.leftPos,t)}get leftPos(){return this._bodyView.scrollLeft}set leftPos(t){(t=Math.max(0,Math.min(this._bodyView.contentWidth-this.getBound().width,t)))!=this.leftPos&&this._bodyView.scrollDom(t,this.topPos)}get focusedItem(){return this._focusedItem}set focusedItem(t){const e=this._focusedItem;this.changeFocus(t)&&this._fireFocusedChanged(t,e)}changeFocus(t){if(t!==this._focusedItem)return this._focusedItem=t,this.invalidateLayout(),this.clearSelection(),this._focusRequested=!0,this._bodyView.makeVisible(t),!0}get selection(){return this._selections.items}get lastSelectedItem(){return this._selections.last}expand(t){t&&!t.model.expandable||this._bodyView.expand(t)}expandAll(t){t&&!t.model.expandable||this._bodyView.expandAll(t)}collapse(t){t&&!t.model.expandable||this._bodyView.collapse(t)}collapseAll(t){t&&!t.model.expandable||this._bodyView.collapseAll(t)}collapseShort(){this._bodyView.collapseShort()}clearSelection(t){const e=this._selections.clear();(t&&this._selections.add(t)||e)&&this.invalidateLayout()}select(t){this._selections.add(t)&&this.invalidateLayout()}toggleSelect(t){this._selections.contains(t)?this._selections.remove(t):this._selections.add(t),this.invalidateLayout()}selectAll(t){t||(t=this._bodyView.getVisibleItems()),t&&this._selections.addAll(t)&&this.invalidateLayout()}unselect(t){this._selections.remove(t)&&this.invalidateLayout()}setFocusedRow(t){this.focusedItem=t&&t.model}isFocused(t){return this._focusedItem===t}isSelected(t){return this._selections.contains(t)}itemOfDom(t){const e=this._bodyView.rowOf(t);return e&&e.model}_createDefaultTool(){return new Bx(this)}_doPrepareContainer(t){t.className="rr-outline-root rr-outline"}_doLayout(t){this._bodyView.measure(t.width,t.height),this._bodyView.layoutContent(),this._focusRequested&&(this._focusRequested=!1,this.topPos=this._bodyView.scrollToFocused(this.topPos,t.height))}_fireFocusedChanged(t,e){this.fireEvent(Px.FOCUSED_CHANGED,t,e)}_fireDoubleClicked(t){this.fireEvent(Px.DOUBLE_CLICKED,t)}}Px.FOCUSED_CHANGED="onOutlineFocusedChanged",Px.DOUBLE_CLICKED="onOutlineDoubleClicked";class xx extends q{constructor(t,e){super(t,e),this._vindex=-1}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}get vindex(){return this._vindex}measure(t,e){const s=this._doMeasure(t,e);return this._measuredWidth=s.width,this._measuredHeight=s.height,s}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(t){}_doMeasure(t,e){return new Me(t,e)}_doLayoutContent(){}}class Sx extends xx{constructor(){super(...arguments),this._level=-1}get isCategory(){return!1}get source(){return this._source}get level(){return this._level}prepareElement(t){this._doPrepareElement(t,this._source)}_getCssDisplay(){return"flex"}_isEmptySize(){return!0}$_setLevel(t,e){this._source=t,this._level=e}}Sx.INDENT=8;class Ix extends Sx{constructor(t,e,s){super(t,e||"propertyRowView"),this._labelWidth=115,this._focused=!1,this._model=s}_doDispose(){super._doDispose()}get model(){return this._model}set model(t){t!==this._model&&(this._model=t)}get labelWidth(){return this._labelWidth}set labelWidth(t){this._labelWidth=t}setFocused(t){t!=this._focused&&(this._focused=t,this.$_setIndentMark(),this.invalidate())}hasFocusEdit(){const t=this._getEdit(null);return t&&this.doc.activeElement===t}select(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t instanceof HTMLInputElement?this._selectEdit(this._getEdit(t),e):t&&t.focus()}clearSelection(){this._clearSelection(this._getEdit(null))}_getCssSelector(){let t="rr-property-line rr-property-row";return this._focused&&(t+=" rr-property-row-focus"),t}_initDom(t,e){super._initDom(t,e),e.appendChild(this._spanIndent=t.createElement("span")),this._spanIndent.style.color="white",e.appendChild(this._spanLabel=t.createElement("span")),this._spanLabel.className="rr-property-row rr-property-row-label",e.appendChild(this._container=t.createElement("div")),this._container.className="rr-property-row rr-property-row-content",this._setClassName(null),this._doInitContainer(t,this._container)}_doDraw(t){}_doMeasure(t,e){const s=Sx.INDENT*(this.level-1);return this.$_setIndentMark(),this._spanIndent.style.minWidth=s+12+"px",this._model.prop.type===cs?this._spanLabel.textContent=J.capitalize(this._model.label):this._spanLabel.textContent=J.labelize(this._model.label),this._spanLabel.style.width=this._labelWidth-s+"px",new Me(300,this.offsetHeight)}_doLayoutContent(){}_getPlaceHolder(){return this.source.getPlaceHolder(this._model.prop)||"(Not Defined)"}_getEdit(t){}_selectEdit(t,e){t&&(e||t.selectionEnd===t.selectionStart)&&t.select()}_clearSelection(t){t&&t.selectionStart!==t.selectionEnd&&t.setSelectionRange(t.selectionEnd,t.selectionEnd)}_doUpdateValue(t,e){var s,i;const r=this.container;if(r&&this.source)try{return null===(i=(s=t.prop).validate)||void 0===i||i.call(s,this.source,e),r.updateValue(this.source,t,e),!0}catch(t){this.reset(null),console.error(t),r.showError(this,t)||alert(t)}}_loadText(t){return t}_setText(t,e){const s=this.model.getValue(e);return this._loadText(s),void 0===s||Number.isNaN(s)?t.value="":t.value=this._loadText(s)||"",t.placeholder=this._getPlaceHolder(),t.readOnly=this.model.isReadOnly(e),t.value}$_setIndentMark(){this._focused?this._spanIndent.classList.add("rr-property-indent-mark"):this._spanIndent.classList.remove("rr-property-indent-mark")}}class Rx extends Sx{constructor(t,e){super(t,"propertyCategoryView"),this._expanded=!0,this._model=e}static isCollectionItemDelete(t){return t.className===this.DELETE_CLASS}static isCollectionItemUp(t){return t.className===this.UP_CLASS}static isCollectionItemRight(t){return t.className===this.RIGHT_CLASS}_doDispose(){super._doDispose()}get model(){return this._model}set model(t){t!==this._model&&(this._model=t)}get expanded(){return this._expanded}set expanded(t){t!=this._expanded&&(this._expanded=t)}get isCategory(){return!0}_getCssSelector(){return"rr-property-line rr-property-category"}_initDom(t,e){super._initDom(t,e),e.appendChild(this._spanIndent=t.createElement("span")),e.appendChild(this._spanExpander=t.createElement("span")),e.appendChild(this._spanText=t.createElement("span")),this._setClassName(null)}_doDraw(t){}_doPrepareElement(t,e){this.source.isCollectionProp()?(this._spanAdd||(this._spanAdd=t.createElement("span"),this._spanAdd.className="rr-property-category-add",this._spanAdd.textContent="+"),this.dom.appendChild(this._spanAdd)):this._spanAdd&&this._spanAdd.parentElement&&this.dom.removeChild(this._spanAdd),this.source.isCollectionItem()&&this.label.endsWith("]")?(this._spanDelete||(this._spanDelete=t.createElement("span"),this._spanDelete.className=Rx.DELETE_CLASS,this._spanDelete.textContent="",this._spanDelete.style.right="0px"),this.dom.appendChild(this._spanDelete)):this._spanDelete&&this._spanDelete.parentElement&&this.dom.removeChild(this._spanDelete),this.source.isCollectionItem()&&!this.label.endsWith("]")&&0===this.level?(this._spanUp||(this._spanUp=t.createElement("span"),this._spanUp.className=Rx.UP_CLASS,this._spanUp.textContent="⇧",this._spanUp.style.right="0px"),this.dom.appendChild(this._spanUp)):this._spanUp&&this._spanUp.parentElement&&this.dom.removeChild(this._spanUp),this.source.isCollectionItem()&&!this.label.endsWith("]")&&this.level>0?(this._spanRight||(this._spanRight=t.createElement("span"),this._spanRight.className=Rx.RIGHT_CLASS,this._spanRight.textContent="⇨",this._spanRight.style.right="0px"),this.dom.appendChild(this._spanRight)):this._spanRight&&this._spanRight.parentElement&&this.dom.removeChild(this._spanRight)}_doMeasure(t,e){this._spanIndent.style.minWidth=Sx.INDENT*this.level+2+"px",this._spanText.className="rp-category-text",this._spanText.textContent=J.labelize(this.label);const s=this.expanded?"rp-expander rp-expander-expanded":"rp-expander rp-expander-collapsed";return this._spanExpander.className=s,this._spanExpander.$_rvu=this.vindex,new Me(300,this.offsetHeight)}_doLayoutContent(){}}Rx.DELETE_CLASS="rr-property-collection-delete",Rx.UP_CLASS="rr-property-collection-up",Rx.RIGHT_CLASS="rr-property-collection-right";class Tx extends Sx{constructor(t){super(t,"propertyCollectionView")}static isAdd(t){return t.className===this.ADD_CLASS}_doDispose(){super._doDispose()}get isCategory(){return!0}_getCssSelector(){return"rr-property-line rr-property-collection"}_initDom(t,e){super._initDom(t,e),e.appendChild(this._spanText=t.createElement("span")),this._spanText.className="rp-category-text",e.appendChild(this._spanAdd=t.createElement("span")),this._spanAdd.className=Tx.ADD_CLASS,this._spanAdd.textContent="+",this._setClassName(null)}_doDraw(t){}_doPrepareElement(t,e){}_doMeasure(t,e){return this._spanText.textContent=J.labelize(this.source.getCollectionLabel()),new Me(300,this.offsetHeight)}_doLayoutContent(){}}Tx.ADD_CLASS="rr-property-collection-add";class Ox extends Ix{constructor(t,e){super(t,"fontSizePropertyView",e)}_doDispose(){super._doDispose()}_doInitContainer(t,e){const s=this._edit=t.createElement("input");s.type="number",s.className="rr-property-dim",s.min="0",s.onkeydown=t=>{!isNaN(this._oldValue)||"ArrowDown"!==t.key&&"ArrowUp"!==t.key||(t.preventDefault(),t.stopImmediatePropagation())},s.onchange=()=>{this.$_updateValue(),this._text=this._edit.value},e.appendChild(s);const i=this._select=t.createElement("select");Ox.UNITS.forEach((e=>{const s=t.createElement("option");s.value=e,s.innerHTML=e,i.appendChild(s)})),i.className="rr-property-dim-units",i.onchange=()=>{this.$_updateValue(),this._text=this._edit.value},e.appendChild(i)}_doPrepareElement(t,e){const s=this.model.getValue(e),i=this._oldValue=parseFloat(s);let r=0;isNaN(i)?(this._edit.value="",this._edit.placeholder="(Not Defined)",r=0):(this._edit.value=String(i),"string"==typeof s&&Ox.UNITS.forEach(((t,e)=>{if(s.endsWith(t))return r=e,!0}))),this._select.selectedIndex=r,this._text=this._edit.value}reset(t){this._edit.value=this._text,this.select(t)}_getEdit(){return this._edit}$_updateValue(){const t=this._select.selectedIndex||0;let e=this._edit.value;e=e?e+Ox.UNITS[t]:void 0,this._doUpdateValue(this.model,e)}}Ox.UNITS=["px","pt"];class Fx extends Ix{static createEdit(t){const e=t.createElement("input");return e.type="text",e.className="rr-property-edit",e.spellcheck=!1,e}static createColor(t,e){const s=t.createElement("div");s.className="rp-color-style";const i=t.createElement("span");return i.className=Fx.BOX_STYLE,i.style.backgroundColor=Fx.NULL_COLOR,s.appendChild(i),e.appendChild(s),i}static getColor(t){let e=t.value;return e&&(e=e.trim()),!e||e.startsWith("#")||e.startsWith("rgb")||isNaN(parseFloat(e))||(e="#"+e),e}}Fx.NULL_COLOR="#aaa",Fx.BOX_STYLE="rp-color-style-box";class Dx extends Ix{constructor(t,e){super(t,"dimensionPropertyView",e)}static createDimEdit(t){const e=t.createElement("input");return e.type="number",e.className="rr-property-dim",e.pattern="[0-9.]+",e.min="0",e}static createDimSelect(t){const e=t.createElement("select");return Dx.UNITS.forEach((s=>{const i=t.createElement("option");i.value=s,i.innerHTML=s,e.appendChild(i)})),e.className="rr-property-dim-units",e}_doDispose(){super._doDispose()}_doInitContainer(t,e){const s=this._edit=Dx.createDimEdit(t);s.onkeydown=t=>{const e={"%":"%",p:"px",t:"pt",m:"mm",c:"cm",i:"in"};for(let s in e)if(t.key===s)return this._select.value=e[s],t.preventDefault(),void t.stopImmediatePropagation();isNaN(this._oldValue)&&this.model instanceof os&&("ArrowDown"===t.key||"ArrowUp"===t.key)&&(t.preventDefault(),t.stopImmediatePropagation())},s.onchange=()=>{this.$_updateValue()},e.appendChild(s);const i=this._select=Dx.createDimSelect(t);i.onchange=()=>{this.$_updateValue()},e.appendChild(i)}_doPrepareElement(t,e){const s=this.model.getValue(e),i=this._oldValue=parseFloat(s);let r=0;isNaN(i)?(this._edit.value="",this._edit.placeholder="(Not Defined)"):(this._edit.value=String(i),"string"==typeof s&&Dx.UNITS.forEach(((t,e)=>{if(s.endsWith(t))return r=e,!0}))),this._text=this._edit.value,this._select.selectedIndex=r}reset(t){this._edit.value=this._text,this.select(t)}_getEdit(){return this._edit}$_updateValue(){const t=this._select.selectedIndex||0;let e=this._edit.value;e=e?e+Dx.UNITS[t]:void 0,this._doUpdateValue(this.model,e)}}var Lx;Dx.UNITS=["px","pt","mm","cm","in","%"],function(t){t.CATEGORY="category",t.NAME="name"}(Lx||(Lx={}));class Nx extends A{constructor(t){super(),this._name=t}get name(){return String(this._name)}set name(t){t!=this._name&&(this._name=t)}get index(){return this._name}get parent(){return this._parent}get json(){return this._parent&&this._parent.json}get level(){return this._parent?this._parent.level+1:0}get revealed(){return!this._parent||this._parent.revealed}isGroup(){return!1}getPath(){const t=[this];let e=this._parent;for(;e;)t.push(e),e=e._parent;return t.reverse()}getUrl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nx.URL_SEPARATOR;const e=this._parent;let s=this.name;return e&&(s=e.getUrl(t)+t+s),s}getDisplayUrl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";const e=this._parent;let s=this.name;return e instanceof Ux?s=e.getDisplayUrl(t)+"["+s+"]":this._parent&&(s=e.getDisplayUrl(t)+t+s),s}getDataUrl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";const e=this._parent;let s=this.name;return e&&e.level>0&&(s=e.getDataUrl(t)+t+s),s}}Nx.URL_SEPARATOR="/",Nx.TAG="__tag_";class Hx extends Nx{constructor(t){super(t),this._items=[],this._expanded=!0}get count(){return this._items.length}get expanded(){return this._expanded}indexOf(t){return this._items.indexOf(t)}get(t){return this._items[t]}set(t,e){const s=this._items[t];s!==e&&(this._items[t]=e,e._parent=this,s._parent=null)}contains(t){return this._items.indexOf(t)>=0}canAdd(t){return!!t}add(t){if(t&&this._items.indexOf(t)<0)return this._addItem(t),!0}canRemove(t){return!!t}remove(t){const e=this._items.indexOf(t);if(e>=0)return this._removeItem(t,e),!0}collectItems(t){for(let e of this._items)t.push(e),e instanceof Hx&&e.collectItems(t)}collectVisibles(t){for(let e of this._items)t.push(e),e instanceof Hx&&e.expanded&&e.collectVisibles(t)}findByTag(t){if(t===this.tag)return this;for(let e of this._items)if(e instanceof Hx){const s=e.findByTag(t);if(s)return s}else if(e===t)return e}isGroup(){return this instanceof Hx}_createItem(t,e){return null==e?new kx(t):"string"==typeof e?new Vx(t,e):"number"==typeof e?new Gx(t,e):"boolean"==typeof e?new Kx(t,e):J.isValueArray(e)?new Wx(t,e):J.isArray(e)?new Ux(t,e):e?new Qx(t,e):void 0}_addItem(t){this._items.push(t),t._parent=this}_removeItem(t,e){this._items.splice(e,1),t._parent=null}$_expand(t,e){if(t!=this._expanded||e){let s=!1;if(t!=this._expanded&&(this._expanded=t,s=!0),e)for(let e of this._items)e instanceof Hx&&e.$_expand(t,!0)&&(s=!0);return s}}}class Qx extends Hx{constructor(t,e){super(t),this._nameMap={},this._parse(e)}find(t){return this._nameMap[t]}isValidName(t,e){const s=this._nameMap[e];return!s||s===t}getValidName(t){let e=t,s=1;for(;;){let i=!1;for(let r in this._nameMap)if(e===r){e=t+"-"+s++,i=!0;break}if(!i)break}return e}save(){const t={};for(let e of this._items)t[e.name]=e.save();return t}canAdd(t){if(super.canAdd(t)&&t.name){if(this._nameMap[t.name])throw new Error("Already same name exisits: "+t.name);return!0}return!1}_addItem(t){super._addItem(t),this._nameMap[t.name]=t}_parse(t){for(let e in t)if(e===Nx.TAG)this.tag=t[e];else{const s=this._createItem(e,t[e]);s&&(this._addItem(s),this._nameMap[e]=s)}}}class Ux extends Hx{constructor(t,e){super(t),this._parse(e)}save(){const t=[];for(let e of this._items)t.push(e.save());return t}_parse(t){for(let e=0;e<t.length;e++){const s=this._createItem(e,t[e]);this._addItem(s)}}}class Mx extends Nx{constructor(t,e){super(t),this._value=e}get value(){return this._value}set value(t){t!=this._value&&(this._value=t)}get displayText(){return void 0===this.value?"UNDEFINED":null===this.value?"null":this._getDisplayText(this.value)}parseValue(t){if(void 0!==t){if(null===t)return null;if("null"==t)return null;if("UNDEFINED"!=t)return this._doParseValue(t)}}valueEquals(t){return this.value==t}save(){return this._value}}class kx extends Mx{constructor(t){super(t,null)}save(){return null}_getDisplayText(t){return"null"}_doParseValue(t){return null}}class Vx extends Mx{constructor(t,e){super(t,e)}_getDisplayText(t){return t}_doParseValue(t){return t.startsWith('"')&&t.endsWith('"')?t.slice(1,t.length-1):t}}class Gx extends Mx{constructor(t,e){super(t,e)}_getDisplayText(t){return isNaN(t)?"NaN":String(t)}_doParseValue(t){return"NaN"==t?NaN:parseFloat(t)}}class Kx extends Mx{constructor(t,e){super(t,e)}_getDisplayText(t){return t?"true":"false"}_doParseValue(t){const e=t.trim().toLowerCase();return"true"===e||"t"===e||"1"===e}}class Wx extends Mx{constructor(t,e){super(t,e)}_getDisplayText(t){let e="";const s=new Array(t.length);for(let e=0;e<t.length;e++)"string"==typeof t[e]?s[e]='"'+t[e]+'"':s[e]=t[e];return e+=s.join(","),e}_doParseValue(t){const e=t.split(/\s*\,\s*/);for(let t=0;t<e.length;t++){const s=e[t];s.startsWith('"')&&s.endsWith('"')?e[t]=s.slice(1,s.length-1):e[t]=parseFloat(s)}return e}valueEquals(t){if(!J.isArray(t)||!J.isArray(this.value))return!this.value;if(t.length&&this.value.length){for(let e=0;e<t.length;e++)if(t[e]!=this.value[e])return!1;return!0}}}class zx extends br{constructor(t,e){super("Set Value"),this._item=t,this._newValue=e,this._oldValue=t.value}_doDispose(){}redo(t){this._item.value=this._newValue}undo(){this._item.value=this._oldValue}get source(){return this._item}}class $x extends br{constructor(t,e){super("Add Item"),this._model=t.json,this._parent=t,this._item=e}_doDispose(){this._model=this._parent=this._item=null}redo(t){this._model.$_addItem(this._parent,this._item)}undo(){this._model.$_removeItem(this._item)}get source(){return this._item}}class Xx extends br{constructor(t){super("Remove Item"),this._model=t.json,this._parent=t.parent,this._item=t}_doDispose(){this._model=this._parent=this._item=null}redo(t){this._model.$_removeItem(this._item)}undo(){this._model.$_addItem(this._parent,this._item)}get source(){return this._item}}class jx extends br{constructor(t,e){super("Set Value"),this._item=t,this._newName=e,this._oldName=t.name}_doDispose(){}redo(t){this._item.name=this._newName}undo(){this._item.name=this._oldName}get source(){return this._item}}class Yx extends br{constructor(t,e){super("Set Item"),this._parent=t.parent,this._index=this._parent.indexOf(t),this._oldItem=t,this._newItem=e}_doDispose(){this._parent=this._oldItem=this._newItem=null}redo(t){this._parent.set(this._index,this._newItem)}undo(){this._parent.set(this._index,this._oldItem)}get source(){return this._oldItem}}class Jx extends l{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";super(),this._editable=!0,this._rootName=s,e&&(this._commands=new Br(this)),this.$_load(t)}editCommandStackChanged(t,e,s,i){this.fireEvent(Jx.COMMANDS_STACK_CHANGED,s,i)}editCommandStackDirtyChanged(t){this.fireEvent(Jx.DIRTY_CHANGED)}get dirty(){return this._commands.canUndo}get rootName(){return this._rootName}get root(){return this._root}get rootGroup(){return this._root instanceof Hx?this._root:null}get allItems(){return this._items}get visibleItems(){return this._visibles}get firstVisible(){return this._visibles[0]}get lastVisible(){return this._visibles[this._visibles.length-1]}get editable(){return this._editable}set editable(t){t!==this._editable&&(this._editable=t,this.$_refreshVisibles())}isRoot(t){return t===this._root}load(t){this.$_load(t),this._fireReset()}save(){return this._root.save()}saveAsString(){const t=this._root.save();return JSON.stringify(t,null,2)}expand(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&this._root instanceof Hx&&(t=this._root),t&&t.$_expand(!0,e))return this.$_refreshVisibles(),!0}collapse(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&this._root instanceof Hx&&(t=this._root),t&&t.$_expand(!1,e))return this.$_refreshVisibles(),!0}reveal(t){if(t&&!t.revealed){const e=t.getPath();for(let t=0;t<e.length-1;t++)e[t].$_expanded=!0;return!0}}findItem(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=Nx.URL_SEPARATOR;if(this._root instanceof kx)return t==s?this._root:null;"/"==t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t.startsWith(s)&&(e=this._root,t=t.substr(1));const i=t.split(s);let r=e||this._root,n=0;for(;r&&n<i.length;)if(r instanceof Qx){const t=i[n++];r=r.find(t)}else{if(!(r instanceof Ux))return;{const t=parseInt(i[n++]);r=r.get(t)}}return r}findByTag(t){if(this._root instanceof Hx)return this._root.findByTag(t)}getNextVisible(t){const e=Math.max(0,Math.min(this._visibles.length-1,this._visibles.indexOf(t)+1));return this._visibles[e]}getPrevVisible(t){const e=Math.max(0,Math.min(this._visibles.length-1,this._visibles.indexOf(t)-1));return this._visibles[e]}clean(){this._commands.flush()}undo(){return this._commands&&this._commands.undo()}redo(){return this._commands&&this._commands.redo()}isEditable(t){return!0}addItem(t,e){if(t&&e&&t.canAdd(e)&&!t.contains(e))return this._commands?this._commands.execute(new $x(t,e)):this.$_addItem(t,e),this.$_buildItems(),!0}canRemove(t){return t!==this._root&&t&&t.parent&&t.parent.canRemove(t)}removeItem(t){if(t!==this._root&&t&&t.parent)return this._commands?this._commands.execute(new Xx(t)):this.$_removeItem(t),this.$_buildItems(),!0}changeName(t,e){if(t&&t.name!=e){const s=t.name;return t.parent instanceof Qx&&!t.parent.isValidName(t,e)?(this._fireNameChanged(t,s),!1):(this._commands?this._commands.execute(new jx(t,e)):t.name=e,this._fireNameChanged(t,s),!0)}}changeValue(t,e){if(!t)return!1;const s=t.parseValue(e);if(t&&!t.valueEquals(s)){if(t instanceof Gx){const t=Number(s);if(isNaN(t))return}const e=t.value;return this._commands?this._commands.execute(new zx(t,s)):t.value=s,this._fireValueChanged(t,e),!0}}changeType(t,e){if(!(t instanceof e)){const s=t.value;let i;if(e===kx?i=new kx(t.name):e===Vx?i=new Vx(t.name,String(s)):e===Kx?i=new Kx(t.name,!!s):e===Gx&&(i=new Gx(t.name,+s)),i){if(this._commands)this._commands.execute(new Yx(t,i));else{const e=t.parent;e.set(e.indexOf(t),i)}return this.$_buildItems(),this._fireItemChanged(t,i),i}}return t}search(t,e){const s=[];e.caseSensitive||(t=t.toLowerCase());for(let i of this._items)if(i instanceof Mx){const r=i.displayText;if(r){let n=r;e.caseSensitive||(n=n.toLowerCase()),(e.wholeWord&&n===t||!e.wholeWord&&n.indexOf(t)>=0)&&s.push({item:i,prop:i.displayText})}}return s.length>0?s:null}$_load(t){null==t?this._root=new kx("/"):J.isArray(t)?this._root=new Ux("/",t):this._root=new Qx("/",t);const e=this;Object.defineProperty(this._root,"json",{get:function(){return e}}),this.$_buildItems()}$_buildItems(){this._items=[this._root],this._visibles=[this._root],this._root instanceof Hx&&(this._root.collectItems(this._items),this._root.expanded&&this._root.collectVisibles(this._visibles))}$_refreshVisibles(){this._visibles=[this._root],this._root instanceof Hx&&this._root.expanded&&this._root.collectVisibles(this._visibles)}$_addItem(t,e){if(t&&t.add(e)){const s=this._visibles;let i=s.indexOf(t);if(i>=0){const r=t.level,n=s.length;for(;++i<n&&!(s[i].level<=r););s.splice(i,0,e)}this._items.push(e),this._fireItemAdded(t,e)}}$_removeItem(t){if(!t)return;const e=t.level,s=t.parent;if(s&&s.remove(t)){const i=this._items,r=this._visibles;let n=r.indexOf(t);if(n>=0){const t=r.length;let s=1;for(;n<t-1&&!(r[n+1].level<=e);)n++,s++;r.splice(n,s)}n=i.indexOf(t),this._items.splice(n,1),this._fireItemRemoved(s,t)}}_fireReset(){this.fireEvent(Jx.RESET)}_fireNameChanged(t,e){this.fireEvent(Jx.NAME_CHANGED,t,t.name,e)}_fireValueChanged(t,e){this.fireEvent(Jx.VALUE_CHANGED,t,t.value,e)}_fireItemChanged(t,e){this.fireEvent(Jx.ITEM_CHANGED,t,e)}_fireItemAdded(t,e){this.fireEvent(Jx.ITEM_ADDED,t,e)}_fireItemRemoved(t,e){this.fireEvent(Jx.ITEM_REMOVED,t,e)}}Jx.COMMANDS_STACK_CHANGED="onJsonCommandStackChanged",Jx.DIRTY_CHANGED="onJsonDirtyChanged",Jx.RESET="onJsonReset",Jx.NAME_CHANGED="onJsonNameChanged",Jx.VALUE_CHANGED="onJsonValueChanged",Jx.ITEM_CHANGED="onJsonItemChanged",Jx.ITEM_ADDED="onJsonItemAdded",Jx.ITEM_REMOVED="onJsonItemRemoved";class Zx extends q{constructor(t,e){super(t,e),this._vindex=-1}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}get vindex(){return this._vindex}measure(t,e){const s=this._doMeasure(t,e);return this._measuredWidth=s.width,this._measuredHeight=s.height,s}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(t){}_doMeasure(t,e){return new Me(t,e)}_doLayoutContent(){}}class qx extends Zx{constructor(t,e){super(t.doc,"jsonBodyView"),this._rowMap=new Map,this._itemMap=new Map,this._editor=t,this._draggable=e}_doDispose(){this._tbody=this._thead=this._table=null,this._editor=null,super._doDispose()}get draggable(){return this._draggable}isExpander(t){return t&&t.classList.contains(qx.EXPANDER)}rowOf(t){let e=t;for(;e;){if(e instanceof HTMLTableRowElement)return e;e=e.parentElement}}itemOf(t){const e=this.rowOf(t);return e&&this._rowMap.get(e)}rowOfitem(t){return this._itemMap.get(t)}getFirstValue(){const t=this._tbody.rows;for(let e=0;e<t.length;e++){const s=t[e];if(this._rowMap.get(s)instanceof Mx)return this.$_getValueDom(s)}}getLastValue(){const t=this._tbody.rows;for(let e=t.length-1;e>=0;e--){const s=t[e];if(this._rowMap.get(s)instanceof Mx)return this.$_getValueDom(s)}}getNameDom(t){return this.$_getNameDom(t)}getValueDom(t){return this.$_getValueDom(t)}getNextValue(t){const e=this._tbody.rows;let s=this.rowOf(t);if(s){for(let t=s.rowIndex;t<e.length;t++)if(s=e[t],this._rowMap.get(s)instanceof Mx)return this.$_getValueDom(s);return t}}getPrevValue(t){const e=this._tbody.rows;let s=this.rowOf(t);if(s){for(let t=s.rowIndex-2;t>=0;t--)if(s=e[t],this._rowMap.get(s)instanceof Mx)return this.$_getValueDom(s);return t}}getEditingRow(){let t=this.doc.activeElement;for(;t;){if(t instanceof HTMLTableRowElement){if(this._rowMap.get(t))return t}t=t.parentElement}}getEditingItem(){const t=this.getEditingRow();return t&&this._rowMap.get(t)}makeRowVisible(t){t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}isRowMenu(t){if(t.classList.contains(qx.ROW_MENU)){const e=this.$_getTr(t);return this._rowMap.get(e)}}beginEdit(t){const e=this.rowOfitem(t);if(e){const t=e.children[2].lastElementChild,s=this._editor.nameEditable?t.children[1]:t.children[3];if(s instanceof HTMLElement)return this._editor.setFocus(),s.focus(),!0}}_createDom(t){const e=super._createDom(t);let s=e.style;s.overflow="auto";const i=this._table=t.createElement("table");return s=i.style,i.className="json-table",s.setProperty("table-layout","fixed","important"),s.setProperty("width","100%","important"),this._thead=t.createElement("thead"),this.$_prepareHead(t,this._thead),i.appendChild(this._thead),this._tbody=t.createElement("tbody"),i.appendChild(this._tbody),e.appendChild(i),e}_getCssSelector(){return"json-body"}_doMeasure(t,e){return this.$_prepareRows(this.doc,this._tbody),new Me(t,e)}_doLayoutContent(){}$_prepareHead(t,e){let s;s=t.createElement("tr"),e.appendChild(s),s.setAttribute("aria-hidden","true");s.style.setProperty("border","0px none","important");for(let e=0;e<2;e++){const e=t.createElement("th");e.scope="col";let i=e.style;i.setProperty("visibility","hidden","important"),i.setProperty("margin","0px","important"),i.setProperty("padding","0px","important"),i.setProperty("font-size","0px","important"),i.setProperty("line-height","0px","important"),i.height="0px",i.width="24px",s.appendChild(e)}}$_prepareRows(t,e){const s=this._editor,i=s.model,r=s.focused,n=s.model&&s.model.visibleItems||[],o=e.rows;for(;o.length<n.length;){const s=t.createElement("tr");e.appendChild(s)}for(;o.length>n.length;)e.removeChild(e.lastChild);this._rowMap.clear(),this._itemMap.clear();for(let e=0,s=o.length;e<s;e++){const s=o[e],a=n[e];s.className=a===r?"json-focused":"",this.$_prepareRow(t,i,a,s,e),this._rowMap.set(s,a),this._itemMap.set(a,s)}}$_prepareRow(t,e,s,i,r){if(0==i.childElementCount)for(let e=0;e<3;e++){const e=t.createElement("td");i.appendChild(e)}let n=i.children[0],o=n.firstElementChild;o||(o=t.createElement("button"),o.className=qx.ROW_MOVER,this._draggable&&(o.draggable=!0,o.dataset.url=s.getDataUrl()),n.appendChild(o)),n=i.children[1],o=n.firstElementChild,o||(o=t.createElement("button"),o.className=qx.ROW_MENU,n.appendChild(o)),n=i.children[2];let a=n.lastChild;a||(a=this.$_prepareCell(t,s),n.appendChild(a)),a.style.marginLeft=16*s.level+"px",this.$_layoutCell(t,e,s,a,0===r&&e.isRoot(s))}$_prepareCell(t,e){const s=t.createElement("div");s.className="json-content";for(let t=0;t<4;t++){const i=document.createElement("span");1==t&&this._draggable&&e instanceof Mx&&(i.dataset.url=e.getDataUrl(),i.draggable=!0),s.appendChild(i)}return s}$_layoutCell(t,e,s,i,r){const n=i.children;let o=n[0];s instanceof Hx?(o||i.appendChild(o=t.createElement("button")),s.expanded?o.className=qx.EXPANDER_EXPANDED:o.className=qx.EXPANDER_COLLAPSED):o&&(o.className=qx.EXPANDER);let a=n[1];if(a.className="json-field",a.contentEditable=this._editor.nameEditable?"true":"false",a.textContent=r&&this._editor.model.rootName||s.name,a.spellcheck=!1,s instanceof Hx)a=n[2],a.className="json-count",s instanceof Qx?a.textContent="{"+s.count+"}":s instanceof Ux&&(a.textContent="["+s.count+"]"),a=n[3],a.contentEditable="false",a.className="json-value",a.textContent="";else if(s instanceof Mx){const t=s instanceof Wx;a=n[2],a.className="json-separator",a.textContent=t?"["+s.value.length+"] :":":",a=n[3],e.editable?(a.contentEditable="true",a.spellcheck=!1):a.contentEditable="false",a.className="json-value",a.dataset.type=t?"array":s instanceof Gx?"number":s instanceof Kx?"bool":s instanceof kx?"null":"string",a.textContent=s.displayText}}$_getNameDom(t){return t.cells[2].firstElementChild.children[1]}$_getValueDom(t){return t.cells[2].firstElementChild.children[3]}$_focusedChanged(t,e){let s=this.rowOfitem(t);s&&s.classList.remove("json-focused"),s=this.rowOfitem(e),s&&(s.classList.add("json-focused"),this.makeRowVisible(s))}$_getTr(t){do{if(t instanceof HTMLTableRowElement)return t;t=t.parentElement}while(t)}}qx.EXPANDER="json-expander",qx.EXPANDER_EXPANDED="json-expander json-expander-expanded",qx.EXPANDER_COLLAPSED="json-expander json-expander-collapsed",qx.ROW_MOVER="json-row-mover",qx.ROW_MENU="json-row-menu";class tS extends et{constructor(t){super(t,"jsonSelectionTool"),this._editor=t}_doDispose(){this._editor=null,super._doDispose()}get viewer(){return this._editor}isMouseEventTarget(t){return super.isMouseEventTarget(t)}_doMouseDown(t){const e=this._editor,s=e.bodyView,i=this.mouseEventTarget,r=s.rowOf(i),n=s.isRowMenu(i);if(n)e.onRowMenuClick&&e.onRowMenuClick(n);else if(s.isExpander(i)){const t=s.itemOf(i);t.isGroup()&&(t.expanded?e.collapse(t):e.expand(t))}return e.focused instanceof Mx&&this.$_fireChangeEvent(e.focused),r&&(e.focused=s.itemOf(r)),!0}_doMouseMove(t){}_doMouseUp(t){}_doClick(t,e,s){this.findElementAt(e,s,!1)}_doDblClick(t){}_doMouseWheel(t){return!!(t.shiftKey||Math.abs(t.deltaX)>Math.abs(t.deltaY))}_doMouseEnter(t){}_doMouseLeave(t){}_doMouseOver(t){}_doContextMenu(t){return!1}_doKeyDown(t){const e=t.keyCode,s=t.ctrlKey,i=J.isMac,r=i&&t.metaKey||!i&&t.ctrlKey,n=t.shiftKey,o=t.target instanceof HTMLElement?t.target:null,a=this._editor,A=a.focused,l=a.bodyView.itemOf(o);let h=!1;switch(e){case 13:s||r||n||(h=this.$_enter(o,l||A));break;case 27:h=this.$_esc(o,l);break;case 9:h=n?this.$_move(o,A,-1):this.$_move(o,A,1);break;case 36:r&&(h=this.$_home());break;case 35:r&&(h=this.$_end());break;case 37:h=this.$_left(o,A);break;case 39:h=this.$_right(o,A);break;case 40:h=this.$_move(o,A,1);break;case 38:h=this.$_move(o,A,-1)}return h&&(t.preventDefault(),t.stopImmediatePropagation()),h||super._doKeyDown(t)}_doKeyPress(t){return!1}_doKeyUp(t){return!1}_doFocusLeave(t){const e=this._editor;if(e.focused instanceof Mx){const t=e.bodyView.rowOfitem(e.focused),s=e.bodyView.getNameDom(t),i=e.bodyView.getValueDom(t);e._fireFocusedLeave(e.focused,s.textContent,i.textContent)}}$_enter(t,e){if(t){const s=this._editor,i=s.bodyView;if(e){const r=i.rowOfitem(e);if(e.isGroup())t=i.getNextValue(r),s.focused=i.itemOf(t);else{if(s.isEditing())return this.$_move(t,e,1);t=i.getValueDom(r)}return t&&t.focus(),J.selectAll(t),!0}}return!1}$_esc(t,e){const s=this._editor;if(t&&(t.blur(),e instanceof Mx))return s.isName(t)?t.textContent=e.name:t.textContent=e.value,!0}$_left(t,e){const s=this._editor;if(!s.isEditing()&&e.isGroup())return s.collapse(e),!0}$_right(t,e){const s=this._editor;if(!s.isEditing()&&e.isGroup())return s.expand(e),!0}$_move(t,e,s){if(t){const e=this._editor,i=e.bodyView.itemOf(t),r=e.model;let n=e.focused;if(i instanceof Mx&&this.$_fireChangeEvent(i),e.isEditing()&&t.blur(),n?s>0?n=r.getNextVisible(n):s<0&&(n=r.getPrevVisible(n)):n=r.firstVisible,n instanceof Mx&&r.isEditable(n)){const s=e.bodyView.rowOfitem(n);(t=e.bodyView.getValueDom(s))&&t.focus(),J.selectAll(t)}else e.setFocus();return e.focused=n,!0}return!1}$_home(){const t=this._editor.bodyView.getFirstValue();if(t)return t.focus(),!0}$_end(){const t=this._editor.bodyView.getLastValue();if(t)return t.focus(),!0}$_commitEdit(t,e){const s=this._editor;return e.blur(),s.isName(e)?!!s.model.changeName(t,e.textContent)||(s.invalidateLayout(),!1):!!s.model.changeValue(t,e.textContent)||(s.invalidateLayout(),!1)}$_fireChangeEvent(t){const e=this._editor,s=e.bodyView.rowOfitem(t),i=e.bodyView.getNameDom(s),r=e.bodyView.getValueDom(s),n=t;n.name!==i.textContent&&(""===i.textContent.trim()?e.model._fireNameChanged(t,t.name):e.model.changeName(n,i.textContent)||e.invalidateLayout()),n.value!==r.textContent&&(e.model.changeValue(n,r.textContent)||e.invalidateLayout())}}class eS extends yt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(t),this._nameEditable=!1,this.addElement(this._bodyView=new qx(this,e))}_doDispose(){super._doDispose()}get model(){return this._model}set model(t){t!==this._model&&(this._model&&this._model.removeListener(this),this._model=t,this._model&&this._model.addListener(this),this.$_modelchanged())}get nameEditable(){return this._nameEditable}set nameEditable(t){t!=this._nameEditable&&(this._nameEditable=t,this.invalidateLayout())}get focused(){return this._focused}set focused(t){if(t!==this._focused){const e=this._focused;this._focused=t,this.$_focusedChanged(e,this._focused)}}get bodyView(){return this._bodyView}expand(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(t=t||this.model.rootGroup).$_expand(!0,e)&&(this.model.$_refreshVisibles(),this.invalidateLayout())}collapse(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(t=t||this.model.rootGroup).$_expand(!1,e)&&(this.model.$_refreshVisibles(),this.invalidateLayout())}expandAll(){this.expand(null,!0)}collapseAll(){this.collapse(null,!0)}isName(t){return t.classList.contains("json-field")}isValue(t){return t.classList.contains("json-value")}isEditing(){return!!this._bodyView.getEditingRow()}isEditingAt(t){return(t=t||this._focused)&&this._bodyView.getEditingItem()===t}undo(){return this._model.undo()}redo(){return this._model.redo()}beginEdit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._bodyView.beginEdit(t||this._focused)}getFocusedTag(t){let e=this._focused;if(e){let s=e.tag;for(;!(s instanceof t)&&(e=e.parent,e);)s=e.tag;if(s instanceof t)return s}}_createDefaultTool(){return new tS(this)}_doPrepareContainer(t){t.className="json-root json-editor"}_doLayout(t){this._bodyView.measure(t.width,t.height),this._bodyView.setBounds(0,0,t.width,t.height),this._bodyView.layoutContent()}$_modelchanged(){this._focused=null}$_focusedChanged(t,e){e&&!e.revealed?(this._model.reveal(e),this.invalidateLayout()):this._bodyView.$_focusedChanged(t,e),this._fireFocusedChanged(e,t)}_fireFocusedChanged(t,e){this.fireEvent(eS.FOCUSED_CHANGED,t,e)}_fireFocusedLeave(t,e,s){this.fireEvent(eS.FOCUSED_LEAVE,t,e,s)}onJsonReset(t){this._focused=null,this.invalidateLayout()}onJsonNameChanged(t,e,s,i){this.invalidateLayout()}onJsonValueChanged(t,e,s,i){this.invalidateLayout()}onJsonItemChanged(t,e,s){this.invalidateLayout()}onJsonItemAdded(t,e,s){this.invalidateLayout()}onJsonItemRemoved(t,e,s){this.invalidateLayout()}}eS.FOCUSED_CHANGED="onJsonFocusedChanged",eS.FOCUSED_LEAVE="onJsonFocusedLeave";class sS extends l{constructor(t,e){super(),this._rootVisible=!0,this._visibles=[],this._inserting=!1,this._rootPath=t,this._rootDir=t&&t.endsWith("/")?t.substring(0,this.rootPath.length-1):t,this.$_setSource(e)}_doDispose(){this._source=null,super._doDispose()}get rootPath(){return this._rootPath}get source(){return this._source}set source(t){t!==this._source&&this.$_setSource(t)}get root(){return this._root}get rootVisible(){return this._rootVisible}set rootVisible(t){t!=this._rootVisible&&(this._rootVisible=t,t?this._visibles.unshift(this._root):this._visibles.shift())}get visibleCount(){return this._visibles.length}getVisible(t){return this._visibles[t]}findItem(t){return this._root.itemOf(t,!0)}getLastVisibleOf(t){if(!t||t.isRoot)return this._visibles.length-1;{const e=t.level;let s=this._visibles.indexOf(t)+1;for(;s<this._visibles.length&&!(this._visibles[s].level<=e);)s++;return s-1}}appendItems(t,e){if(t&&e&&e.length>0){const s=t.expanded;s&&this.$_collapse(t,0);const i=t._addItems(e);s&&this.$_expand(t,0),this._fireItemsAdded(t,i)}}getAbsolutePath(t){return this._rootDir+t}getItemAt(t){if("/"===t||"."===t||""===t)return this._root;const e=t.split(/[\\\/]/);let s=this._root;for(let t=e.length-1;t>=0;t--)e[t]||e.splice(t,1);for(let t=0;t<e.length-1;t++)if(s=s.find(e[t]),!s)return null;return s.find(e[e.length-1])}getVisibleItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=this._visibles;if(t=Math.max(0,t),e=e<0?s.length-1:Math.min(e,s.length-1),e>=0&&e<t){const s=t;t=e,e=s}const i=[];for(let r=t;r<=e;r++)i.push(s[r]);return i}expand(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(!(t=t||this._root)||!t.expandable||t.expanded)&&(this.$_expand(t,e),this._fireExpanded(t,!0),!0)}$_expand(t,e){const s=this._visibles;let i=s.indexOf(t);if(i<0&&t!==this._root)return void t.$_setExpanded(!0);i=t!==this._root||this._rootVisible?i+1:0,t!==this._root&&this._rootVisible&&Z(i>0);const r=[];t.$_setExpanded(!0),this.$_collectVisibles(t,r,e);for(let t of r)s.splice(i++,0,t)}expandAll(t){this.collapseAll(t),this.expand(t,Number.MAX_SAFE_INTEGER)}collapse(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!!((t=t||this._root)&&t.expandable&&t.expanded)&&(this.$_collapse(t,e),this._fireExpanded(t,!1),!0)}$_collapse(t,e){const s=this._visibles;let i=s.indexOf(t);if(i<0&&t!==this._root)return void t.$_setExpanded(!1);i=t!==this._root||this._rootVisible?i+1:0,t!==this._root&&this._rootVisible&&Z(i>0);const r=this.$_hideVisibles(t,e);s.splice(i,r),t.$_setExpanded(!1)}collapseAll(t){this.collapse(t,Number.MAX_SAFE_INTEGER)}isVisible(t){return this._visibles.indexOf(t)>=0}makeVisible(t){if(this.isVisible(t))return;let e=t.parent,s=0;for(;e;){if(e===this._root||this.isVisible(e)){this.expand(e,s);break}e=e.parent,s++}}resetFolder(t,e){const s=t instanceof iS?t:this.getItemAt(t);if(s instanceof rS){const t=s.isRoot&&!this._rootVisible||this.isVisible(s)&&s.expanded;t&&this.$_collapse(s,0),s.reset(e),t&&this.$_expand(s,0),this._fireFolderReset(s)}}beginAppend(t,e){if(!this._inserting){if(this._insertingItem||(this._insertingItem=new oS),this._insertingItem.beginEdit(e),t||(t=this._root),t._addItem(this._insertingItem),!this.expand(t)){const e=this.getLastVisibleOf(t)+1;this._visibles.splice(e,0,this._insertingItem)}return this._inserting=!0,this._fireAppendStarted(t),!0}}endAppend(t){if(this._inserting){const e=this._insertingItem.parent,s=this._visibles.indexOf(this._insertingItem);this._visibles.splice(s,1),this._insertingItem.parent._removeItem(this._insertingItem),this._fireAppendEnded(e,t?this._insertingItem:null),this._inserting=!1}}isInserting(t){return this._inserting&&(!t||t===this._insertingItem)}$_setSource(t){this._source=t,this.$_build(t),this._visibles=[],this._rootVisible?this._visibles.push(this._root):this.expand(this._root),this._fireSourceChanged()}$_build(t){this._root=new nS(this,this._source=t)}$_collectVisibles(t,e,s){for(let i=0;i<t.count;i++){const r=t.get(i);e.push(r),r instanceof rS&&(r.expanded||s>0)&&(r.$_setExpanded(!0),this.$_collectVisibles(r,e,s-1))}}$_hideVisibles(t,e){let s=0;s+=t.count;for(let i=0;i<t.count;i++){const r=t.get(i);r instanceof rS&&r.expanded&&(e>0&&r.$_setExpanded(!1),s+=this.$_hideVisibles(r,e-1))}return s}_fireSourceChanged(){this.fireEvent(sS.SOURCE_CHANGED)}_fireItemAdded(t,e){this.fireEvent(sS.ITEM_ADDED,t,e)}_fireItemsAdded(t,e){this.fireEvent(sS.ITEMS_ADDED,t,e)}_fireItemRemoved(t){this.fireEvent(sS.ITEM_REMOVED,t)}_fireItemsRemoved(t){this.fireEvent(sS.ITEMS_REMOVED,t)}_fireFolderReset(t){this.fireEvent(sS.FOLDER_RESET,t)}_fireExpanded(t,e){this.fireEvent(sS.EXPANDED,t,e)}_fireAppendStarted(t){this.fireEvent(sS.APPEND_STARTED,t)}_fireAppendEnded(t,e){this.fireEvent(sS.APPEND_ENDED,t,e)}}sS.SOURCE_CHANGED="onFolderRootChanged",sS.ITEM_ADDED="onFolderItemAdded",sS.ITEMS_ADDED="onFolderItemsAdded",sS.ITEM_REMOVED="onFolderItemRemoved",sS.ITEMS_REMOVED="onFolderItemsRemoved",sS.FOLDER_RESET="onFolderFolderReset",sS.EXPANDED="onFolderExpanded",sS.APPEND_STARTED="onFolderAppendStarted",sS.APPEND_ENDED="onFolderAppendEnded";class iS extends A{constructor(t){super(),this.name=t&&t.name}get folder(){return this._parent&&this._parent.folder}get parent(){return this._parent}get level(){return this._parent?this._parent.level+1:1}get name(){return this._name}set name(t){if(t!=this._name){this._name=t;const e=t?t.lastIndexOf("."):-1;this._ext=e>=0?t.substring(e+1):"",this._changed()}}get ext(){return this._ext}get path(){return(this._parent.isRoot?"":this._parent.path)+"/"+this._name}get displayText(){return this._name}get expandable(){return!1}getAbsolutePath(){const t=this.folder;return t?t.getAbsolutePath(this.path):this.path}_changed(){}}class rS extends iS{constructor(t){super(t),this._expanded=!1,t&&this.$_load(t)}get count(){return this._children?this._children.length:0}get loaded(){return!!this._children}get isRoot(){return!1}get expanded(){return this._expanded}get collapsed(){return!this._expanded}get(t){return this._children[t]}getItems(){return this._children&&this._children.slice()}getDescendentCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.MAX_SAFE_INTEGER,e=0;if(t>0&&(e+=this.count,t>1&&this._children))for(let s of this._children)s instanceof rS&&(e+=s.getDescendentCount(t-1));return e}itemOf(t){}find(t){if(this._children)for(let e of this._children)if(e.name===t)return e}reset(t){this._clear(),t&&this._addItems(t)}get expandable(){return!0}$_setExpanded(t){this._expanded=t}$_load(t){this._clear();const e=t.children;if(e&&e.length>0)for(let t of e)t.isDirectory||t.children?this._addItem(new rS(t)):this._addItem(new iS(t))}_clear(){if(this._children){for(let t of this._children)t._parent=null;this._children=null}}_addItem(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=this._children=this._children||[];return e<0?s.push(t):s.splice(e,0,t),t._parent=this,t}_removeItem(t){if(t&&this._children){const e=this._children.indexOf(t);e>=0&&(this._children.splice(e,1),t._parent=null)}}_addItems(t){this._children=this._children||[];let e=0;for(let s=0;s<t.length;s++){const i=t[s];i.isDirectory||i.children?this._addItem(new rS(i)):this._addItem(new iS(i)),e++}return e}}class nS extends rS{constructor(t,e){super(e),this._model=t}get isRoot(){return!0}get folder(){return this._model}get parent(){return null}get path(){return"/"}}class oS extends rS{constructor(){super(null)}beginEdit(t){this.name=t}}class aS extends q{constructor(t,e){super(t,e)}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}measure(t,e){const s=this._doMeasure(t,e);return this._measuredWidth=s.width,this._measuredHeight=s.height,s}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(t){}_doMeasure(t,e){return new Me(t,e)}_doLayoutContent(){}}class AS extends aS{constructor(t,e){super(t,"FolderRowView"),this._vindex=-1,this._indents=0,this._focused=!1,this._selected=!1,this._model=e}_doDispose(){super._doDispose()}get model(){return this._model}set model(t){t!==this._model&&(this._model=t)}get vindex(){return this._vindex}get indents(){return this._spanText.getBoundingClientRect().left-this.getBoundingRect().left}get focused(){return this._focused}get selected(){return this._selected}get expandable(){return this._model instanceof rS&&this._model.expandable}get expanded(){return this._model instanceof rS&&this._model.expanded}setFocused(t){t!=this._focused&&(this._focused=t,this.invalidate())}setSelected(t){t!=this._selected&&(this._selected=t,this.invalidate())}clearText(){this._spanText.style.visibility="hidden"}_getCssSelector(){let t="rr-folder-row";return this._focused&&this._selected?t+=" rr-folder-row-focus rr-folder-row-select":this._focused?t+=" rr-folder-row-focus":this._selected&&(t+=" rr-folder-row-select"),t}_getCssDisplay(){return"flex"}_isEmptySize(){return!0}_initDom(t,e){super._initDom(t,e),e.appendChild(this._spanIndent=t.createElement("span")),e.appendChild(this._spanExpander=t.createElement("span")),e.appendChild(this._spanText=t.createElement("span")),this._spanText.className="rr-folder-label",e.draggable=!0}_doDraw(t){}_doMeasure(t,e){const s=this._model;let i="";switch(s.ext){case"r2":case"json":i=s.ext;break;case"png":case"jpg":case"jpeg":i="img";break;default:i=s.expandable?"":"file"}i?this._dom.dataset.type=i:delete this._dom.dataset.type,this._setClassName(null),this.setHint(this._model.getAbsolutePath()),this._indents=Math.max(8,AS.INDENT_SIZE*(s.level-1)),this._spanIndent.style.minWidth=this._indents+"px";let r="";return r=s.expandable?s.expanded?"rr-folder-expander rr-folder-expander-expanded":"rr-folder-expander rr-folder-expander-collapsed":"rr-folder-expander",this._spanExpander.className=r,this._spanExpander.$_rvu=this.vindex,this._spanText.style.visibility="visible",this._spanText.textContent=s.displayText,new Me(t,this.offsetHeight)}_doLayoutContent(){}}AS.INDENT_SIZE=8;class lS extends aS{constructor(t){super(t.doc,"FolderBodyView"),this._rows=[],this._rowPool=[],this._rowPoints=[0],this._inserting=!1,this._viewer=t}_doDispose(){super._doDispose()}get rowCount(){return this._rows.length}get focusedRow(){return this._focusedRow}get contentHeight(){return this._rowPoints[this._rowPoints.length-1]}get contentWidth(){return this.width}getRow(t){return this._rows[t]}getNext(t){if(t){const e=t.vindex;return e<this._rows.length-1?this._rows[e+1]:t}return this._rows.length>0?this._rows[0]:null}getPrev(t){if(t){const e=t.vindex;return e>0?this._rows[e-1]:t}return this._rows.length>0?this._rows[0]:null}getNextPage(t){if(!t)return this.getNext(t);const e=this._rowPoints;let s=this.getBoundingRect().height,i=this._rows.length,r=t.vindex;for(;r<i&&(s-=e[r+1]-e[r],!(s<=0));)r++;return this._rows[Math.min(i-1,r)]}getPrevPage(t){if(!t)return this.getPrev(t);const e=this._rowPoints;let s=this.getBoundingRect().height,i=t.vindex;for(;i>=0&&(s-=e[i+1]-e[i],!(s<=0));)i--;return this._rows[Math.max(0,i)]}findRow(t){return this.$_findRow(this._rows,t)}loadRows(t){if(this.clear(),!t)return;const e=t.getVisibleItems();for(let t=0;t<e.length;t++){const s=e[t],i=this.$_borrowRow(s);this._rows.push(i),this.addChild(i)}}refreshRows(t){if(!t)return void this.clear();const e=this._rows,s=t.getVisibleItems();let i;for(;e.length<s.length;)e.push(i=this.$_borrowRow(null)),this.addChild(i);for(;e.length>s.length;)this.$_returnRow(i=e.pop()),this.removeChild(i);for(let t=s.length-1;t>=0;t--)e[t].model=s[t]}isExpander(t){return t.classList.contains("rr-folder-expander")}rowByExpander(t){return this._rows[t.$_rvu]}rowOf(t){let e=t;for(;e;){if(e.classList.contains("rr-folder-row"))for(let t of this._rows)if(t.isDom(e))return t;e=e.parentElement}}get isLayer(){return!0}_getCssSelector(){return"rr-folder-body"}_setSizeStyle(t){}_initDom(t,e){super._initDom(t,e);const s=e.style;s.width="100%",s.height="100%",s.overflow="auto"}clear(){if(super.clear()){for(let t of this._rows)this.$_returnRow(t,!0);return this._rows=[],!0}}findChildAt(t,e,s,i){return e+=this._dom.scrollTop,super.findChildAt(t,e,s,i)}_doMeasure(t,e){const s=this._viewer,i=this._rows;let r=this._rowPoints=[0];this._focusedRow=null;for(let n=0;n<i.length;n++){const o=i[n],a=o.model;o.visible=!0,o._vindex=n,!this._focusedRow&&s.isFocused(a)?(o.setFocused(!0),this._focusedRow=o):o.setFocused(!1),o.setSelected(s.isSelected(a)),o.measure(t,e),r.push(r[n]+o.measuredHeight)}return new Me(t,r[r.length-1])}scrollToFocused(t,e){const s=this._focusedRow;if(s){const i=this._rowPoints,r=s.vindex;i[r]<t?t=i[r]+(r>0?(i[r-1]-i[r])/2:0):i[r+1]-t>=e&&(t=i[r+1]-e+(r<i.length-1?(i[r+1]-i[r])/2:0))}return t}_doLayoutContent(){const t=this._rows,e=this._rowPoints;for(let s=0;s<t.length;s++){const i=t[s];i.move(0,e[s]-0),i.layoutContent()}}$_borrowRow(t){if(this._rowPool.length>0){const e=this._rowPool.pop();return e.model=t,e.invalidate(),e}return new AS(this.doc,t)}$_returnRow(t){t&&(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this._rowPool.indexOf(t)<0)&&(t.visible=!1,t._vindex=-1,t.setFocused(!1),t.setSelected(!1),this._rowPool.push(t),t.validate())}$_findRow(t,e){if(t)for(let s of t){if(s.model===e)return s;const t=this.$_findRow(s._children,e);if(t)return t}}}class hS extends et{constructor(t){super(t,"FolderSelectionTool"),this._viewer=t}_doDispose(){this._viewer=null,super._doDispose()}get viewer(){return this._viewer}_doMouseDown(t){const e=this.mouseEventTarget,s=this.viewer.bodyView,i=this._clickedRow=s.rowOf(e);return!i||(i.model instanceof iS&&this.viewer._fireMouseDown(i.model),!0)}_doMouseMove(t){}_doMouseUp(t){const e=this.mouseEventTarget,s=this._viewer,i=s.model,r=s.bodyView,n=r.rowOf(e);return!n||(r.isExpander(e)&&this.$_isClickedRow(e)&&(n.expanded?i.collapse(n.model):i.expand(n.model)),n.model instanceof iS&&s._fireMouseUp(n.model),!0)}_doClick(t,e,s){var i;const r=t.ctrlKey||t.metaKey,n=t.shiftKey,o=this.mouseEventTarget,a=this._viewer,A=a.bodyView,l=A.rowOf(o);if(!l||l!==this._clickedRow)return;const h=l.model;if(a.focusedItem||(a.focusedItem=h),r)a.toggleSelect(h),a.focusedItem=h;else if(n){const t=a.focusedItem;if(t){const e=null===(i=A.findRow(t))||void 0===i?void 0:i.vindex,s=a.model.getVisibleItems(e||l.vindex,l.vindex);a.clearSelection(h),a.selectAll(s)}}else a.clearSelection(h),a.select(h),a.focusedItem=h}_doDblClick(t){const e=this._viewer,s=e.model,i=e.bodyView,r=this.mouseEventTarget,n=i.rowOf(r);if(n&&n===this._clickedRow){const t=n.model;t instanceof rS?t.expanded?s.collapse(t):s.expand(t):e._fireDoubleClicked(n.model)}}_doMouseWheel(t){const e=this._viewer;if(t.shiftKey||Math.abs(t.deltaX)>Math.abs(t.deltaY))return!0;{const s=e.topPos;return e.topPos=s+t.deltaY,!0}}_doMouseEnter(t){}_doMouseLeave(t){}_doMouseOver(t){}_doContextMenu(t){return!1}_doKeyDown(t){const e=t.keyCode,s=t.shiftKey,i=this._viewer,r=i.bodyView,n=i.editing,o=r.focusedRow,a=r.getNext(o),A=r.getPrev(o),l=i.focusedItem,h=i.isSelected(l);switch(e){case 13:if(i.editing)return i.hideEdit(!0,!0),!0;if(i.showEdit())return!0;break;case 27:if(i.hideEdit(!1,!0))return!0;break;case 36:n||i.setFocusedRow(r.getRow(0));break;case 35:n||i.setFocusedRow(r.getRow(r.rowCount-1));break;case 40:if(n)break;i.setFocusedRow(a),s&&(h&&i.isSelected(a.model)?i.unselect(l):i.toggleSelect(a.model));break;case 38:if(n)break;i.setFocusedRow(A),s&&(h&&i.isSelected(A.model)?i.unselect(l):i.toggleSelect(A.model));break;case 34:n||i.setFocusedRow(r.getNextPage(o));break;case 33:n||i.setFocusedRow(r.getPrevPage(o));break;case 37:!n&&o&&(o.expanded?i.model.collapse(o.model):l.parent&&i.model.isVisible(l.parent)&&(i.focusedItem=l.parent));break;case 39:!n&&o&&(o.expandable&&!o.expanded?i.model.expand(o.model):l instanceof rS&&l.count>0&&(i.focusedItem=l.get(0)))}return super._doKeyDown(t)}_doKeyPress(t){return!1}_doKeyUp(t){return!1}_doDragStart(t){const e=this._clickedRow;return this.$_isRowFolderItem(e)&&this.viewer._fireDragStart(t,e.model),!0}_doDragEnd(t){const e=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(e)&&this.viewer._fireDragEnd(t,e.model),!0}_doDragEnter(t){const e=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(e)&&this.viewer._fireDragEnter(t,e.model),!0}_doDragOver(t){const e=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(e)&&this.viewer._fireDragOver(t,e.model),!0}_doDragLeave(t){const e=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(e)&&this.viewer._fireDragLeave(t,e.model),!0}_doDragDrop(t){const e=this.$_getFolderRow(this.mouseEventTarget);return this.$_isRowFolderItem(e)&&this.viewer._fireDragDrop(t,e.model),!0}$_findRowView(t){}$_enter(t,e){return t&&t.focus(),!1}$_esc(t,e){if(t&&(t.blur(),e instanceof iS))return t.textContent=e.displayText,!0}$_getFolderRow(t){return this.viewer.bodyView.rowOf(t)}$_isClickedRow(t){const e=this._viewer.bodyView;return this._clickedRow===e.rowOf(t)}$_isRowFolderItem(t){return!!t&&t.model instanceof iS}}class dS{constructor(){this._items=[]}get items(){return this._items.length>0?this._items.slice():null}get last(){return this._items.length>0?this._items[this._items.length-1]:null}contains(t){return t&&this._items.indexOf(t)>=0}clear(){if(this._items.length>0)return this._items=[],!0}add(t){if(t&&this._items.indexOf(t)<0)return this._items.push(t),!0}addAll(t){if(t&&t.length>0){let e=!1;for(let s of t)this._items.indexOf(s)<0&&(this._items.push(s),e=!0);return e}}remove(t){if(t){const e=this._items.indexOf(t);if(e>=0)return this._items.splice(e,1),!0}}}class cS extends q{show(t){if(!this.visible){this.visible=!0;const e=this._selectionCallback,s=t.getBoundingRect(),i=s.top-this.getBoundingRect().top;let r=this._row.style;if(r.top=i+"px",r.height=s.height+"px",r=this._input.style,r.marginLeft=t.indents+"px",r.marginRight="1px",t.clearText(),this._input.value=t.model.displayText,this._input.focus(),e){const s=e(t.model,this._input.value);s?this._input.setSelectionRange(s.start,s.end):this._input.select()}else this._input.select()}}hide(){this._input.blur(),this.visible=!1}layout(t){const e=t.getBoundingRect().top-this.getBoundingRect().top;this._row.style.top=e+"px"}_getCssSelector(){return"rr-folder-edit-mask"}_initDom(t,e){super._initDom(t,e),e.appendChild(this._row=t.createElement("div"));let s=this._row.style;s.position="absolute",s.left="0",s.width="100%",s.display="flex",s.background="rgba(255, 255, 255, 0.1)",this._row.appendChild(this._input=t.createElement("input")),this._input.className="rr-folder-root rr-folder-edit",this._input.type="text",this._input.spellcheck=!1,this._input.onblur=()=>{this.container.$_editorBlur(this._input.textContent)},s=this._input.style,s.boxSizing="border-box",s.flex="1 1 0",s.background="transparent",s.color="white",s.outline="none",s.height="100%",s.width="100%",s.padding="0",s.border="1px solid #0088ff",s.pointerEvents="auto"}_setSizeStyle(t){}_doDraw(t){}}class uS extends yt{constructor(t){super(t),this._selections=new dS,this._focusRequested=!1,this._editHiding=!1,this.addElement(this._bodyView=new lS(this)),this.addElement(this._editMask=new cS(this.doc)),this._editMask.visible=!1}_doDispose(){super._doDispose()}onFolderSourceChanged(t){this._bodyView.loadRows(this.model),this.invalidateLayout()}onFolderItemAdded(t,e,s){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderItemsAdded(t,e,s){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderItemRemoved(t,e){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderItemsRemoved(t,e){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderFolderReset(t,e){this._bodyView.refreshRows(this._model),this.invalidateLayout()}onFolderExpanded(t,e,s){this._bodyView.refreshRows(this._model),this.invalidateLayout(),this._fireExpanded(e,s)}onFolderAppendStarted(t,e){this._bodyView.refreshRows(this._model),this.focusedItem=e.get(e.count-1),this.invalidateLayout(),setTimeout((()=>{this.showEdit()}))}onFolderAppendEnded(t,e,s){this.hideEdit(!1,!0),this._bodyView.refreshRows(this._model),this.invalidateLayout(),s&&this.onAppended&&this.onAppended(e,s)}get model(){return this._model}set model(t){t!==this._model&&(this._model&&this._model.removeListener(this),this._model=t,this._bodyView.loadRows(t),this.invalidateLayout(),this._model&&this._model.addListener(this))}get bodyView(){return this._bodyView}get topPos(){return this._bodyView.scrollTop}set topPos(t){(t=Math.max(0,Math.min(this._bodyView.contentHeight-this.getBound().height,t)))!=this.topPos&&(this._bodyView.scrollDom(this.leftPos,t),this.editing&&this._editMask.layout(this._bodyView.focusedRow))}get leftPos(){return this._bodyView.scrollLeft}set leftPos(t){(t=Math.max(0,Math.min(this._bodyView.contentWidth-this.getBound().width,t)))!=this.leftPos&&this._bodyView.scrollDom(t,this.topPos)}get focusedItem(){return this._focusedItem}set focusedItem(t){if(t!==this._focusedItem){const e=this._focusedItem;this._focusedItem=t,this.invalidateLayout(),this._focusRequested=!0,this._fireFocusedChanged(t,e)}}get selection(){return this._selections.items}get lastSelectedItem(){return this._selections.last}get editing(){return this._editMask.visible}get onEditSelect(){return this._editMask._selectionCallback}set onEditSelect(t){this._editMask._selectionCallback=t}clearSelection(t){const e=this._selections.clear();(t&&this._selections.add(t)||e)&&this.invalidateLayout()}select(t){this._selections.add(t)&&this.invalidateLayout()}toggleSelect(t){this._selections.contains(t)?this._selections.remove(t):this._selections.add(t),this.invalidateLayout()}selectAll(t){t||(t=this._model.getVisibleItems()),t&&this._selections.addAll(t)&&this.invalidateLayout()}unselect(t){this._selections.remove(t)&&this.invalidateLayout()}isFocused(t){return this._focusedItem===t}isSelected(t){return this._selections.contains(t)}itemOfDom(t){const e=this._bodyView.rowOf(t);return e&&e.model}showEdit(){if(!this._editMask.visible&&this._bodyView.focusedRow)return this._editMask.show(this._bodyView.focusedRow),!0}hideEdit(t,e){if(!this._editHiding&&this._editMask.visible){this._editHiding=!0;try{const s=this._editMask._input.value;return this._editMask.hide(),e&&this.setFocus(),t?this._model.isInserting()?(this.focusedItem.name=s,this._model.endAppend(!0)):this.$_acceptEdit(s):this._model.isInserting()&&this._model.endAppend(!1),this.invalidateLayout(),!0}finally{this._editHiding=!1}}}setFocusedRow(t){this.focusedItem=t&&t.model}_createDefaultTool(){return new hS(this)}_doPrepareContainer(t){t.className="rr-folder-root rr-folder"}_doLayout(t){const e=this._bodyView,s=this.topPos;e.measure(t.width,t.height),e.layoutContent(),this._focusRequested?(this._focusRequested=!1,this.topPos=e.scrollToFocused(s,t.height)):this.topPos=s,this.editing&&this._editMask.layout(this._bodyView.focusedRow)}setFocus(){this.editing?this._editMask._input.focus():super.setFocus()}$_acceptEdit(t){const e=this.onEdit;e&&e(this.focusedItem,t)}$_editorBlur(t){this.hideEdit(!0,!0)}_fireFocusedChanged(t,e){this.fireEvent(uS.FOCUSED_CHANGED,t,e)}_fireExpanded(t,e){this.fireEvent(uS.EXPANDED,t,e)}_fireDoubleClicked(t){this.fireEvent(uS.DOUBLE_CLICKED,t)}_fireMouseDown(t){this.fireEvent(uS.MOUSE_DOWN,t)}_fireMouseUp(t){this.fireEvent(uS.MOUSE_UP,t)}_fireDragStart(t,e){this.fireEvent(uS.DRAG_START,t,e)}_fireDragEnd(t,e){this.fireEvent(uS.DRAG_END,t,e)}_fireDragOver(t,e){this.fireEvent(uS.DRAG_OVER,t,e)}_fireDragEnter(t,e){this.fireEvent(uS.DRAG_ENTER,t,e)}_fireDragLeave(t,e){this.fireEvent(uS.DRAG_LEAVE,t,e)}_fireDragDrop(t,e){this.fireEvent(uS.DRAG_DROP,t,e)}}uS.FOCUSED_CHANGED="onFolderFocusedChanged",uS.EXPANDED="onFolderExpanded",uS.DOUBLE_CLICKED="onFolderDoubleClicked",uS.MOUSE_DOWN="onFolderMouseDown",uS.MOUSE_UP="onFolderMouseUp",uS.DRAG_START="onFolderDragStart",uS.DRAG_END="onFolderDragEnd",uS.DRAG_OVER="onFolderDragOver",uS.DRAG_ENTER="onFolderDragEnter",uS.DRAG_LEAVE="onFolderDragLeave",uS.DRAG_DROP="onFolderDragDrop";class pS extends l{constructor(t){super(),this.$_setSource(t)}_doDispose(){this._source=null,super._doDispose()}get source(){return this._source}set source(t){t!==this._source&&this.$_setSource(t)}get root(){return this._root}findByTag(t){return this._root.findByTag(t)}addItem(t,e){if(e){const s=new _S(e),i=(t=t||this._root).add(s);if(i>=0)return this._fireItemAdded(s,i),s}}removeItem(t){if(t&&t.tree){const e=t.parent;e.remove(t)&&this._fireItemRemoved(t,e)}}$_setSource(t){this._source=t,this.$_build(t),this._fireSourceChanged()}$_build(t){this._root=new gS(this,this._source=t),this._root.tag=t&&t.tag}_fireSourceChanged(){this.fireEvent(pS.SOURCE_CHANGED)}_fireItemAdded(t,e){this.fireEvent(pS.ITEM_ADDED,t,e)}_fireItemRemoved(t,e){this.fireEvent(pS.ITEM_REMOVED,t,e)}}pS.SOURCE_CHANGED="onTreeRootChanged",pS.ITEM_ADDED="onTreeItemAdded",pS.ITEM_REMOVED="onTreeItemRemoved";class _S extends A{constructor(t){super(),this._editable=!0,(this._source=t)&&this.$_load(t)}get tree(){return this._parent&&this._parent.tree}get parent(){return this._parent}get count(){return this._children?this._children.length:0}get source(){return this._source}get name(){return this._name}set name(t){t!=this._name&&(this._name=t)}get editable(){return this._editable}get path(){return this._parent.path+"/"+this._name}get displayText(){return this._name}get expandable(){return this.count>0}get(t){return this._children[t]}findByTag(t){if(t===this.tag)return this;if(this._children)for(let e of this._children){const s=e.findByTag(t);if(s)return s}}add(t){return t&&!t.parent?(this._addItem(t),this._children.length-1):-1}remove(t){if(t&&t.parent===this)return this._removeItem(t),!0}$_load(t){this._name=t.name,this._editable=!1!==t.editable,this.tag=t.tag,this._clear();const e=t.children;if(e&&e.length>0)for(let t of e)this._addItem(new _S(t))}_clear(){if(this._children){for(let t of this._children)t._parent=null;this._children=null}}_addItem(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=this._children=this._children||[];return e<0?s.push(t):s.splice(e,0,t),t._parent=this,t}_removeItem(t){if(t&&this._children){const e=this._children.indexOf(t);e>=0&&(this._children.splice(e,1),t._parent=null)}}}class gS extends _S{constructor(t,e){super(e),this._model=t}get tree(){return this._model}get parent(){return null}get path(){return"/"}}class fS extends q{constructor(t,e){super(t,e)}_doDispose(){super._doDispose()}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}measure(t,e){const s=this._doMeasure(t,e);return this._measuredWidth=s.width,this._measuredHeight=s.height,s}layoutContent(){this._doLayoutContent()}_getCssSelector(){}_doDraw(t){}_doMeasure(t,e){return new Me(t,e)}_doLayoutContent(){}}class mS extends fS{constructor(t,e){super(t,"TreeRowView"),this._expanded=!1,this._vindex=-1,this._focused=!1,this._selected=!1,this._model=e}_doDispose(){super._doDispose()}get model(){return this._model}set model(t){t!==this._model&&(this._model=t)}get parentRow(){return this._parentRow}get level(){return this._parentRow?this._parentRow.level+1:1}get rows(){return this._childRows&&this._childRows.slice()}get rowCount(){return this._childRows?this._childRows.length:0}get expanded(){return this._expanded}set expanded(t){t!=this._expanded&&(this._expanded=t)}get vindex(){return this._vindex}get indents(){return this._spanText.getBoundingClientRect().left-this.getBoundingRect().left}get focused(){return this._focused}get selected(){return this._selected}getRow(t){return this._childRows[t]}addRow(t,e){this._childRows||(this._childRows=[]),this._childRows.splice(e,0,t),t._parentRow=this}removeRow(t){if(t&&this._childRows){const e=this._childRows.indexOf(t);e>=0&&(this._childRows.splice(e,1),t.clearRow())}}clearRow(){if(this._childRows){for(let t of this._childRows)t.clearRow();this._childRows=null}this._parentRow=null,this.visible=!1}setFocused(t){t!=this._focused&&(this._focused=t,this.invalidate())}setSelected(t){t!=this._selected&&(this._selected=t,this.invalidate())}clearText(){this._spanText.style.visibility="hidden"}showText(){this._spanText.style.visibility=""}_getCssSelector(){let t="rr-tree-row";return this._focused?t+=" rr-tree-row-focus":this._selected&&(t+=" rr-tree-row-select"),t}_getCssDisplay(){return"flex"}_isEmptySize(){return!0}_initDom(t,e){super._initDom(t,e),e.appendChild(this._spanIndent=t.createElement("span")),e.appendChild(this._spanExpander=t.createElement("span")),e.appendChild(this._spanText=t.createElement("span")),this._spanText.className="rr-tree-label"}_doDraw(t){}_doMeasure(t,e){const s=this._model.source.type;s?this._dom.dataset.type=s:delete this._dom.dataset.type,this._setClassName(null),this._spanIndent.style.minWidth=mS.INDENT_SIZE*this.level+"px";let i="";return i=this._model.count>0?this.expanded?"rr-tree-expander rr-tree-expander-expanded":"rr-tree-expander rr-tree-expander-collapsed":"rr-tree-expander",this._spanExpander.className=i,this._spanExpander.$_rvu=this.vindex,this._spanText.textContent=this._model.displayText,new Me(t,this.offsetHeight)}_doLayoutContent(){}}mS.INDENT_SIZE=8;class wS extends fS{constructor(t){super(t.doc,"treeBodyView"),this._visibleRows=[],this._rows=[],this._rowPool=[],this._rowPoints=[0],this._viewer=t}_doDispose(){super._doDispose()}get visibleRowCount(){return this._visibleRows.length}get rowCount(){return this._rows.length}get focusedRow(){return this._focusedRow}get contentHeight(){return this._rowPoints[this._rowPoints.length-1]}get contentWidth(){return this.width}getVisible(t){return this._visibleRows[t]}getVisibleItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const s=this._visibleRows;if(t=Math.max(0,t),e=e<0?s.length=1:Math.min(e,s.length-1),e<t){const s=t;t=e,e=s}const i=[];for(let r=t;r<=e;r++)i.push(s[r].model);return i}findVisibleRow(t){return this.$_findRow(this._visibleRows,t)}findRow(t){return this.$_findRow(this._rows,t)}loadRows(t){if(this.clear(),!t)return;const e=this._root=this.$_borrowRow(t.root);this._rows.push(e),this._visibleRows.push(e),this.addChild(e),this.$_loadRows(e),this._viewer.rootVisible||this.expand(e)}addRow(t,e){let s=this.findRow(t.parent);if(s){const i=this.$_borrowRow(t);if(s.addRow(i,e),s=this.findVisibleRow(s.model),s&&s.expanded&&(this.collapse(s),this.expand(s)),this.addChild(i),this._rows.push(i),t instanceof _S)for(let e=0;e<t.count;e++)this.addRow(t.get(e),e);this.invalidateLayout()}}addRows(t,e){let s=this.findRow(t);if(s){const i=[];let r=t.count-e;for(let n=0;n<e;n++){const e=this.$_borrowRow(t.get(r+n));s.addRow(e,r+n),i.push(e)}s=this.findVisibleRow(t),s.expanded&&(this.collapse(s),this.expand(s));for(let t=0;t<e;t++)this.addChild(i[t]),this._rows.push(i[t]);this.invalidateLayout()}}removeRow(t){const e=this.findRow(t);if(!e)return;const s=e.parentRow,i=s.expanded,r=this._rows.indexOf(e);i&&this.collapse(s),r>=0&&this.$_removeRow(e),i&&this.expand(s),this.invalidateLayout()}removeRows(t){for(let e of t)this.removeRow(e)}expand(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((t=t||this._root)&&!t.expanded){const s=this._visibleRows,i=s.indexOf(t)+1;Z(i>0);const r=[];let n=0;t.expanded=!0,this.$_collectVisibleRows(t,r,e);for(let t of r)s.splice(i+n,0,r[n]),n++;return this.invalidateLayout(),!0}}expandAll(t){this.collapseAll(t),this.expand(t,!0)}collapse(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((t=t||this._root)&&t.expanded){const s=this.$_hideRows(t,e),i=this._visibleRows.indexOf(t)+1;return this._visibleRows.splice(i,s),t.expanded=!1,this.invalidateLayout(),!0}}collapseAll(t){this.collapse(t,!0)}isVisible(t){for(let e of this._visibleRows)if(e.model===t)return!0;return!1}makeVisible(t){const e=this.findRow(t);if(e.vindex>=0)return;let s=e.parentRow;for(;s;){if(s.expanded=!0,s.vindex>=0){this.collapse(s),this.expand(s,!0);break}s=s.parentRow}}isExpander(t){return t.classList.contains("rr-tree-expander")}rowByExpander(t){return this.getVisible(t.$_rvu)}rowOf(t){let e=t;for(;e;){if(e.classList.contains("rr-tree-row"))for(let t of this._visibleRows)if(t.isDom(e))return t;e=e.parentElement}}getNextVisible(t){const e=this._visibleRows;if(t){const s=t.vindex;return s<e.length-1?e[s+1]:t}return e.length>0?e[0]:null}getPrevVisible(t){const e=this._visibleRows;if(t){const s=t.vindex;return s>0?e[s-1]:t}return e.length>0?e[0]:null}getNextPageVisible(t){if(!t)return this.getNextVisible(t);const e=this._visibleRows,s=this._rowPoints;let i=this.getBoundingRect().height,r=e.length,n=t.vindex;for(;n<r&&(i-=s[n+1]-s[n],!(i<=0));)n++;return e[Math.min(r-1,n)]}getPrevPageVisible(t){if(!t)return this.getPrevVisible(t);const e=this._visibleRows,s=this._rowPoints;let i=this.getBoundingRect().height,r=t.vindex;for(;r>=0&&(i-=s[r+1]-s[r],!(i<=0));)r--;return e[Math.max(0,r)]}get isLayer(){return!0}_getCssSelector(){return"rr-tree-body"}_setSizeStyle(t){}_initDom(t,e){super._initDom(t,e);const s=e.style;s.width="100%",s.height="100%",s.overflow="auto"}clear(){if(super.clear()){for(let t of this._rows)this.$_returnRow(t,!0);return this._rows=[],this._visibleRows=[],!0}}findChildAt(t,e,s,i){return e+=this._dom.scrollTop,super.findChildAt(t,e,s,i)}_doMeasure(t,e){const s=this._viewer;var i=this._rowPoints=[0];this._focusedRow=null;for(let t of this._rows)t.visible=!1,t._vindex=-1,t.setFocused(!1);!s.rootVisible&&this._visibleRows[0]&&this._visibleRows[0].model instanceof gS&&this._visibleRows.splice(0,1);for(let r=0;r<this._visibleRows.length;r++){const n=this._visibleRows[r],o=n.model;n.visible=!0,n._vindex=r,!this._focusedRow&&s.isFocused(o)&&(n.setFocused(!0),this._focusedRow=n),n.setSelected(s.isSelected(o)),n.measure(t,e),i.push(i[r]+n.measuredHeight)}return new Me(t,i[i.length-1])}scrollToFocused(t,e){const s=this._focusedRow;if(s){const i=this._rowPoints,r=s.vindex;i[r]<t?t=i[r]+(r>0?(i[r-1]-i[r])/2:0):i[r+1]-t>=e&&(t=i[r+1]-e+(r<i.length-1?(i[r+1]-i[r])/2:0))}return t}_doLayoutContent(){const t=this._rowPoints;for(let e=0;e<this._visibleRows.length;e++){const s=this._visibleRows[e];s.move(0,t[e]-0),s.layoutContent()}}$_borrowRow(t){if(this._rowPool.length>0){const e=this._rowPool.pop();return e.model=t,e.expanded=!1,e.invalidate(),e}return new mS(this.doc,t)}$_returnRow(t){t&&(arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this._rowPool.indexOf(t)<0)&&(t.clearRow(),this._rowPool.push(t))}$_loadRows(t){const e=t.model,s=e.count;if(s>0)for(let i=0;i<s;i++){const s=e.get(i),r=this.$_borrowRow(s);this._rows.push(r),this.addChild(r),t.addRow(r,i),this.$_loadRows(r)}}$_findRow(t,e){if(t)for(let s of t){if(s.model===e)return s;const t=this.$_findRow(s._children,e);if(t)return t}}$_collectVisibleRows(t,e,s){for(let i=0;i<t.rowCount;i++){const r=t.getRow(i);e.push(r),(r.expanded||s)&&(r.expanded=!0,this.$_collectVisibleRows(r,e,s))}}$_hideRows(t,e){let s=0;s+=t.rowCount;for(let i=0;i<t.rowCount;i++){const r=t.getRow(i);(r.expanded||e)&&(s+=this.$_hideRows(r,e))}return s}$_removeRow(t){const e=this._rows.indexOf(t);if(e>=0){for(let s=0;e<t.rowCount;s++)this.$_removeRow(t.getRow(s));t.parentRow.removeRow(t),this.removeChild(t),this._rows.splice(e,1),this.$_returnRow(t)}}}class yS extends et{constructor(t){super(t,"TreeSelectionTool"),this._viewer=t}_doDispose(){this._viewer=null,super._doDispose()}get viewer(){return this._viewer}_doMouseDown(t){const e=this.mouseEventTarget,s=this._viewer,i=s.bodyView,r=this._clickedRow=i.rowOf(e);return r&&i.isExpander(e)&&(r.expanded?s.collapse(r):s.expand(r)),!0}_doMouseMove(t){}_doMouseUp(t){}_doClick(t,e,s){const i=t.ctrlKey||t.metaKey,r=t.shiftKey,n=this.mouseEventTarget,o=this._viewer,a=o.bodyView.rowOf(n);if(a&&a===this._clickedRow){const t=a.model;if(i)o.toggleSelect(t),o.focusedItem||(o.focusedItem=t);else if(r){const e=o.lastSelectedItem;if(e){const t=o.bodyView.findVisibleRow(e),s=o.bodyView.getVisibleItems(t.vindex,a.vindex);o.selectAll(s)}else o.select(t);o.focusedItem||(o.focusedItem=t)}else o.clearSelection(t),o.focusedItem=t;o.focusedItem||(o.focusedItem=t)}}_doDblClick(t){const e=this._viewer,s=e.bodyView,i=this.mouseEventTarget,r=s.rowOf(i);r&&r===this._clickedRow&&(r.model.count>0?r.expanded?e.collapse(r):e.expand(r):e._fireDoubleClicked(r.model))}_doMouseWheel(t){const e=this._viewer;if(t.shiftKey||Math.abs(t.deltaX)>Math.abs(t.deltaY))return!0;{const s=e.topPos;return e.topPos=s+t.deltaY,!0}}_doMouseEnter(t){}_doMouseLeave(t){}_doMouseOver(t){}_doContextMenu(t){return!1}_doKeyDown(t){const e=t.keyCode,s=this._viewer,i=s.bodyView,r=i.focusedRow,n=s.focusedItem,o=s.editing;switch(e){case 13:if(o)return s.hideEdit(!0,!0),!0;if(s.showEdit())return!0;break;case 27:if(s.hideEdit(!1,!0))return!0;break;case 40:!o&&s.setFocusedRow(i.getNextVisible(r));break;case 38:!o&&s.setFocusedRow(i.getPrevVisible(r));break;case 34:!o&&s.setFocusedRow(i.getNextPageVisible(r));break;case 33:!o&&s.setFocusedRow(i.getPrevPageVisible(r));break;case 36:!o&&s.setFocusedRow(i.getVisible(0));break;case 35:!o&&s.setFocusedRow(i.getVisible(i.visibleRowCount-1));break;case 37:!o&&r&&(r.expanded?i.collapse(r):r.parent&&i.isVisible(n.parent)&&(s.focusedItem=n.parent));break;case 39:!o&&r&&(r.expanded?n.count>0&&(s.focusedItem=n.get(0)):i.expand(r))}return super._doKeyDown(t)}_doKeyPress(t){return!1}_doKeyUp(t){return!1}$_findRowView(t){}}class CS{constructor(){this._items=[]}get items(){return this._items.length>0?this._items.slice():null}get last(){return this._items.length>0?this._items[this._items.length-1]:null}contains(t){return t&&this._items.indexOf(t)>=0}clear(){if(this._items.length>0)return this._items=[],!0}add(t){if(t&&this._items.indexOf(t)<0)return this._items.push(t),!0}addAll(t){if(t&&t.length>0){let e=!1;for(let s of t)this._items.indexOf(s)<0&&(this._items.push(s),e=!0);return e}}remove(t){if(t){const e=this._items.indexOf(t);if(e>=0)return this._items.splice(e,1),!0}}}class bS extends q{show(t){if(!this.visible){this.visible=!0;const e=this._selectionCallback,s=t.getBoundingRect(),i=s.top-this.getBoundingRect().top;let r=this._row.style;if(r.top=i+"px",r.height=s.height+"px",r=this._input.style,r.marginLeft=t.indents+"px",r.marginRight="1px",t.clearText(),this._input.value=t.model.displayText,this._input.focus(),e){const s=e(t.model,this._input.value);s?this._input.setSelectionRange(s.start,s.end):this._input.select()}else this._input.select()}}hide(){this._input.blur(),this.visible=!1}layout(t){const e=t.getBoundingRect().top-this.getBoundingRect().top;this._row.style.top=e+"px"}_getCssSelector(){return"rr-tree-edit-mask"}_initDom(t,e){super._initDom(t,e),e.appendChild(this._row=t.createElement("div"));let s=this._row.style;s.position="absolute",s.left="0",s.width="100%",s.display="flex",s.background="rgba(255, 255, 255, 0.1)",this._row.appendChild(this._input=t.createElement("input")),this._input.className="rr-tree-root rr-tree-edit",this._input.type="text",this._input.spellcheck=!1,this._input.onblur=()=>{this.container.$_editorBlur(this._input.textContent)},s=this._input.style,s.boxSizing="border-box",s.flex="1 1 0",s.background="transparent",s.color="white",s.outline="none",s.height="100%",s.width="100%",s.padding="0",s.border="1px solid #0088ff",s.pointerEvents="auto"}_setSizeStyle(t){}_doDraw(t){}}class vS extends yt{constructor(t){super(t),this._rootVisible=!0,this._selections=new CS,this._focusRequested=!1,this._editHiding=!1,this.addElement(this._bodyView=new wS(this)),this.addElement(this._editMask=new bS(this.doc)),this._editMask.visible=!1}_doDispose(){super._doDispose()}onTreeSourceChanged(t){this._bodyView.loadRows(this.model),this.invalidateLayout(),this._fireModelChanged()}onTreeItemAdded(t,e,s){this._bodyView.addRow(e,s),this.invalidateLayout(),this._fireModelChanged()}onTreeItemRemoved(t,e){this._bodyView.removeRow(e),e===this.focusedItem&&(this.focusedItem=null),this.invalidateLayout(),this._fireModelChanged()}get model(){return this._model}set model(t){t!==this._model&&(this._model&&this._model.removeListener(this),this._model=t,this._bodyView.loadRows(t),this.invalidateLayout(),this._model&&this._model.addListener(this))}get rootVisible(){return this._rootVisible}set rootVisible(t){t!=this._rootVisible&&(this._rootVisible=t,this._bodyView.loadRows(this._model),this.invalidateLayout())}get bodyView(){return this._bodyView}get topPos(){return this._bodyView.scrollTop}set topPos(t){(t=Math.max(0,Math.min(this._bodyView.contentHeight-this.getBound().height,t)))!=this.topPos&&this._bodyView.scrollDom(this.leftPos,t)}get leftPos(){return this._bodyView.scrollLeft}set leftPos(t){(t=Math.max(0,Math.min(this._bodyView.contentWidth-this.getBound().width,t)))!=this.leftPos&&this._bodyView.scrollDom(t,this.topPos)}get focusedItem(){return this._focusedItem}set focusedItem(t){if(t!==this._focusedItem){const e=this._focusedItem;this._focusedItem=t,t&&this.makeVisible(t),this.invalidateLayout(),this.clearSelection(),this._focusRequested=!0,this._fireFocusedChanged(t,e)}}get selection(){return this._selections.items}get lastSelectedItem(){return this._selections.last}get editing(){return this._editMask.visible}expand(t){if((!t||t.model.expandable)&&this._bodyView.expand(t)){const e=t?t.model:this._model.root;this._fireExpanded(e,!0)}}expandAll(t){t&&!t.model.expandable||this._bodyView.expandAll(t)}collapse(t){if((!t||t.model.expandable)&&this._bodyView.collapse(t)){const e=t?t.model:this._model.root;this._fireExpanded(e,!1)}}collapseAll(t){t&&!t.model.expandable||this._bodyView.collapseAll(t)}clearSelection(t){const e=this._selections.clear();(t&&this._selections.add(t)||e)&&this.invalidateLayout()}select(t){this._selections.add(t)&&this.invalidateLayout()}toggleSelect(t){this._selections.contains(t)?this._selections.remove(t):this._selections.add(t),this.invalidateLayout()}selectAll(t){t||(t=this._bodyView.getVisibleItems()),t&&this._selections.addAll(t)&&this.invalidateLayout()}unselect(t){this._selections.remove(t)&&this.invalidateLayout()}setFocusedRow(t){this.focusedItem=t&&t.model}isFocused(t){return this._focusedItem===t}isSelected(t){return this._selections.contains(t)}itemOfDom(t){const e=this._bodyView.rowOf(t);return e&&e.model}showEdit(){if(!this._editMask.visible){const t=this._bodyView.focusedRow;if(t&&t.model.editable)return this._editMask.show(t),!0}}hideEdit(t,e){if(!this._editHiding&&this._editMask.visible){this._editHiding=!0;try{const s=this._bodyView.focusedRow,i=this._editMask._input.value;return this._editMask.hide(),e&&this.setFocus(),t&&this.$_acceptEdit(i),s.showText(),this.invalidateLayout(),!0}finally{this._editHiding=!1}}}makeVisible(t){t&&this._bodyView.makeVisible(t)}_createDefaultTool(){return new yS(this)}_doPrepareContainer(t){t.className="rr-tree-root rr-tree"}_doLayout(t){const e=this.topPos;this._bodyView.measure(t.width,t.height),this._bodyView.setBounds(0,0,t.width,t.height),this._bodyView.layoutContent(),this._focusRequested?(this._focusRequested=!1,this.topPos=this._bodyView.scrollToFocused(e,t.height)):this.topPos=e}setFocus(){this.editing?this._editMask._input.focus():super.setFocus()}$_acceptEdit(t){const e=this.onEdit;e&&e(this.focusedItem,t)}$_editorBlur(t){this.hideEdit(!0,!0)}_fireFocusedChanged(t,e){this.fireEvent(vS.FOCUSED_CHANGED,t,e)}_fireExpanded(t,e){this.fireEvent(vS.EXPANDED,t,e)}_fireDoubleClicked(t){this.fireEvent(vS.DOUBLE_CLICKED,t)}_fireModelChanged(){this.fireEvent(vS.Model_CHANGED)}}vS.FOCUSED_CHANGED="onTreeFocusedChanged",vS.EXPANDED="onTreeExpanded",vS.DOUBLE_CLICKED="onTreeDoubleClicked",vS.Model_CHANGED="onTreeModelChanged";class BS extends l{constructor(t){super(),this._items=[],t&&this.$_load(t)}_doDispose(){super._doDispose()}get count(){return this._items.length}getItem(t){return this._items[t]}itemOf(t){for(let e of this._items)if(e.id===t)return e}$_load(t){for(let e of t)if(e&&e.id){const t=new ES(e.id,e);this.$_addItem(t)}}$_addItem(t){t&&this._items.indexOf(t)<0&&this._items.push(t)}_fireItemAdded(t,e){this.fireEvent(BS.ITEM_ADDED,t,e)}_fireItemRemoved(t){this.fireEvent(BS.ITEM_REMOVED,t)}}BS.ITEM_ADDED="onAccordionItemAdded",BS.ITEM_REMOVED="onAccordionItemRemoved";class ES extends A{constructor(t,e){super(),this.height=100,this._id=t,e&&(this._header=e.header)}get id(){return this._id}get header(){return this._header}set header(t){t!=this._header&&(this._header=t)}get hint(){return this._hint}set hint(t){t!=this._hint&&(this._hint=t)}get displayText(){return this._header||this._id}}class PS extends pt{constructor(t,e){super(null,"accordionResizeTracker"),this._accordion=t,this._separator=e,this._panelsHeight=t._panelsHeight;const s=this._separator.$_idx;this._upperHeight=this._accordion.getHeader(s).model.height,this._lowerHeight=this._accordion.getHeader(s+1).model.height}_doDispose(){this._accordion=null,this._separator=null,super._doDispose()}get startWhenCreated(){return!0}_doStart(t,e,s,i,r){return this._separator.setPointerCapture(t.pointerId),!0}_doDrag(t,e,s){let i=this.startY-this.currentY;const r=this._accordion.height,n=this._panelsHeight,o=this._accordion.getVisibleHeaders(),a=this._separator.$_idx,A=this._accordion.getHeader(a),l=this._accordion.getHeader(a+1),h=A.model.height+l.model.height;let d=0;for(let t of o)d+=t.model.height;return i*=n/r,i*=d/n,l.model.height=Math.max(20,this._lowerHeight+i),A.model.height=h-l.model.height,A.model.height<20&&(i=20-A.model.height,A.model.height=20,l.model.height-=i),this._accordion.invalidateLayout(),!0}_doEnded(t){this._separator.releasePointerCapture(t.pointerId)}}class xS extends ut{constructor(t){super(null,"accordionSelectionTool"),this._container=t}_doDispose(){this._container=null,this._clickedDom=null,super._doDispose()}get container(){return this._container}_doPointerDown(t){const e=this._clickedDom=this.pointerEventTarget;if(this._container.isSeparator(e))return this.dragTracker=new PS(this._container,e),!0}_doClick(t,e,s){const i=this.pointerEventTarget;if(!this._container.checkMenu(i)&&i===this._clickedDom){const t=this._container.headerViewOf(i);t&&(t.expanded=!t.expanded)}}}class SS extends mt{constructor(t){super(t),this._separatorPool=[],this._headerPool=[],this._panelPool=[],this._separators=[],this._headers=[],this._panels=[],this._visibleHeaders=[],this._panelsHeight=0}_doDispose(){super._doDispose()}get model(){return this._model}set model(t){t!==this._model&&(this._model&&this._model.removeListener(this),this._model=t,this.invalidateLayout(),this._model&&this._model.addListener(this))}getHeader(t){return this._headers[t]}headerViewOf(t){let e=t;for(;e;){for(let t of this._headers)if(t.isDom(e))return t;e=e.parentElement}}getVisibleHeaders(){return this._visibleHeaders}itemOf(t){const e=this.headerViewOf(t);return e&&e.model}checkMenu(t){if(this._toolbar.isMenu(t))return this.$_fireMenu(),!0}expand(t,e){if(t)for(let s of this._headers)if(s.model===t){s.expanded=e;break}}isMenu(t){return this._toolbar.isMenu(t)}isSeparator(t){return t.classList.contains("rr-accordion-separator")}_getCssSelector(){return"rr-accordion rr-accordion-root"}_createDefaultTool(){return new xS(this)}_prepareChildren(t,e){this._addElement(this._toolbar=new RS(t)),this._addElement(this._body=new TS(t))}_doLayout(t,e){const s=this._model;s?(this.$_prepareElements(t,s,this._body),this.$_layoutElements(t,s)):this.$_clear()}$_clear(){const t=this._body;this._separatorPool=this._separatorPool.concat(this._separators),this._headerPool=this._headerPool.concat(this._headers),this._panelPool=this._panelPool.concat(this._panels),t.clear()}$_borrowSeparator(t){return this._separatorPool.pop()||new OS(t)}$_borrowHeader(t){return this._headerPool.pop()||new FS(t)}$_borrowPanel(t){return this._panelPool.pop()||new DS(t)}$_prepareElements(t,e,s){const i=e.count;for(;this._separators.length<i-1;){const e=this.$_borrowSeparator(t);s.addChild(e),this._separators.push(e)}for(;this._separators.length>i-1;){const t=this._separators.pop();s.removeChild(t),this._separatorPool.push(t)}for(;this._headers.length<i;){const e=this.$_borrowHeader(t);s.addChild(e),this._headers.push(e)}for(;this._headers.length>i;){const t=this._headers.pop();s.removeChild(t),this._headerPool.push(t)}for(;this._panels.length<i;){const e=this.$_borrowPanel(t);s.addChild(e),this._panels.push(e)}for(;this._panels.length>i;){const t=this._panels.pop();s.removeChild(t),this._panelPool.push(t)}for(let t=0;t<this._panels.length;t++)this._panels[t].setContentId(e.getItem(t))}$_calcPanelHeights(t,e){const s=this._headers,i=this._panels;let r=0;for(let e=0;e<t.count;e++)s[e].expanded&&(r+=t.getItem(e).height);for(let n=0;n<i.length;n++)s[n].expanded&&(i[n].userData=t.getItem(n).height*e/r)}$_layoutElements(t,e){const s=this._separators,i=this._headers,r=this._panels;let n=0,o=2*(e.count-1);this._visibleHeaders=[];for(let t=0;t<e.count;t++){const s=e.getItem(t),r=i[t];r.layout(s),o+=r.height,r.expanded&&this._visibleHeaders.push(r)}this._panelsHeight=this.height-this._toolbar.height-o,this.$_calcPanelHeights(e,this._panelsHeight);for(let t=0;t<e.count;t++){const o=e.getItem(t),a=i[t],A=r[t];if(t>0){const e=s[t-1];e._dom.$_idx=t-1,e.y=n,n+=e.height,e.setStyle("cursor",a.expanded?"ns-resize":"default")}a.y=n,n+=a.height,a.expanded?(A.setStyles({display:"",height:A.userData+"px",top:n+"px"}),n+=A.userData,A.layout(o)):A.setStyle("display","none")}}$_fireMenu(){this.fireEvent(SS.MENU)}$_fireFocusedChanged(t,e){}$_fireExpanded(t,e){this.fireEvent(SS.EXPANDED,t,e)}}SS.MENU="onAccordionMenu",SS.FOCUSED_CHANGED="onAccordionFocusedChanged",SS.EXPANDED="onAccordionExpanded";class IS extends _t{get accordion(){return this.container}}class RS extends IS{constructor(t){super(t,"rr-accordion-toolbar")}isMenu(t){return t===this._spanMenu}_prepareDom(t,e){let s=t.createElement("span");s.textContent="EXPLORER",e.appendChild(s),s=this._spanMenu=t.createElement("span"),s.className="rr-accordion-toolbar-menu",e.appendChild(s)}}class TS extends IS{constructor(t){super(t,"rr-accordion-body")}}class OS extends IS{constructor(t){super(t,"rr-accordion-separator")}}class FS extends IS{constructor(t){super(t,"rr-accordion-header rr-accordion-root"),this._expanded=!1}get model(){return this._model}get expanded(){return this._expanded}set expanded(t){if(t!=this._expanded){const e=this.container;this._expanded=t,e&&e.invalidateLayout(),e.$_fireExpanded(this._model,t)}}layout(t){this._model=t,this.setHint(t.hint||t.displayText),this._spanText.textContent=t.displayText,this._spanExpander.className="rr-accordion-expander "+(this._expanded?"rr-accordion-expander-expanded":"rr-accordion-expander-collapsed")}_prepareDom(t,e){this._spanExpander=t.createElement("span"),e.appendChild(this._spanExpander),this._spanText=t.createElement("span"),e.appendChild(this._spanText)}}class DS extends IS{constructor(t){super(t,"rr-accordion-panel")}get content(){return this._div}setContentId(t){this._div.id=t.id}layout(t){}_prepareDom(t,e){const s=this._div=t.createElement("div"),i=s.style;i.position="absolute",i.width="100%",i.height="100%",e.appendChild(s)}}class LS{constructor(t,e){this.inTable=null,this.cellAlign=dv.AlignmentType.CENTER,this._report=t,this._imageLoader=new cv,this._model=new Rv(this,t,e)}createDOCElements(t){const e=t instanceof HTMLElement&&this._report.models[t.dataset._m_];if(this.inTable&&e instanceof wr)return new Bv(this,t,e);if(this.inTable&&e instanceof gr)return new Dv(this,t,e);if(e instanceof za)return new wv(this,t.firstElementChild,e);if(e instanceof jo)return new bv(this,t,e);if(e instanceof ha)return new vv(this,t,e);if(e instanceof Yo){const s=t.getElementsByClassName(Pl.CHECK_CLASS)[0],i=new bv(this,s,e),r=t.getElementsByClassName(Pl.TEXT_CLASS)[0];return[i,new Cv(this,r,e)]}if(e instanceof Ba)return new xv(this,t,e);if(e instanceof Ca){const s=t._svg_,i=s.substring(s.indexOf("<svg"));return new Ev(this,t,i,e)}if(t instanceof HTMLTableElement)return new Fv(this,t,e);if(t instanceof HTMLSpanElement)return e instanceof wr&&t.dataset.line?new Iv(this,t,e):new Cv(this,t,e);if(t instanceof SVGSVGElement){const s=(new XMLSerializer).serializeToString(t);return new Ev(this,t,s,e)}return t instanceof HTMLCanvasElement?new Pv(this,t,e):t instanceof HTMLElement&&"B"===t.tagName?new Cv(this,t,e):t instanceof HTMLElement?new mv(this,t,e):void 0}setPageDiv(t){t!==this._pageDiv&&(this._pageDiv=t,this._pageRect=t.getBoundingClientRect())}getBounds(t){const e=t.getBoundingClientRect();return e.x-=this._pageRect.x,e.y-=this._pageRect.y,e}getTextBounds(t){const e=J.getTextRect(t);return e.x-=this._pageRect.x,e.y-=this._pageRect.y,e}addImage(t,e){this._imageLoader.add(t,e)}getImage(t){return this._imageLoader.get(t)}get report(){return this._report}prepare(t){return this._imageLoader.load(t)}canExport(){return this._imageLoader.loaded}toBlob(t){const e=new dv.Document({sections:this.$_buildSections()});dv.Packer.toBlob(e).then(t)}toBuffer(t){const e=new dv.Document({sections:this.$_buildSections()});dv.Packer.toBuffer(e).then(t)}$_buildSections(){const t=this,e={type:dv.SectionType.NEXT_PAGE,page:{margin:{top:0,bottom:0,left:0,right:0},size:{orientation:this.report.paper.orientation}}},s=[];return this._model.pages.forEach(((i,r)=>{const n=i.write(t);s.push({properties:e,children:n})})),s}}class NS{constructor(){}exportBlob(t,e,s){if("function"!=typeof s)return;const i=()=>{n.canExport()||n.prepare(r)?n.toBlob(s):setTimeout((()=>{i()}),300)},r=5,n=new LS(t,e);i()}export(t,e,s){if("function"!=typeof s)return;const i=()=>{n.canExport()||n.prepare(r)?n.toBuffer(s):setTimeout((()=>{i()}),300)},r=5,n=new LS(t,e);i()}}class HS extends A{constructor(){super()}_doDispose(){super._doDispose()}export(t,e,s){const i=s.type||"hwp",r=s.fileName||"realreport";try{if("hwp"===i){(new gx).export(t,e,(t=>{xb(t,r+".hwp")}))}else if("docx"===i){(new NS).exportBlob(t,e,(t=>{xb(t,r+".docx")}))}}catch(t){console.error(t),alert("내보내기 실패: "+t)}}}function QS(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var US={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.h=t.r=void 0;class e{static encode(t){const s=e.CHARACTERS,i=[],r=t.length;var n=r%3;let o=r-n;for(let e=0;e<o;){var a=t[e++]<<16|t[e++]<<8|t[e++];i.push(s.charAt(a>>>18&63)),i.push(s.charAt(a>>>12&63)),i.push(s.charAt(a>>>6&63)),i.push(s.charAt(63&a))}switch(n){case 2:var A=t[o++]<<16|t[o++]<<8;i.push(s.charAt(A>>>18&63)),i.push(s.charAt(A>>>12&63)),i.push(s.charAt(A>>>6&63)),i.push(e.SUFFIX);break;case 1:A=t[o++]<<16,i.push(s.charAt(A>>>18&63)),i.push(s.charAt(A>>>12&63)),i.push(e.SUFFIX),i.push(e.SUFFIX)}return i.join("")}static decode(t){const s=e.CHARACTERS;var i=e.SUFFIX;const r=t.split(""),n=[];let o=r.length;for(;r[--o]===i;);for(let t=0;t<o;){let e=s.indexOf(r[t++])<<18;t<=o&&(e|=s.indexOf(r[t++])<<12),t<=o&&(e|=s.indexOf(r[t++])<<6),t<=o&&(e|=s.indexOf(r[t++])),n.push(e>>>16&255),n.push(e>>>8&255),n.push(255&e)}for(;0===n[n.length-1];)n.pop();return n}}QS(e,"SUFFIX","="),QS(e,"CHARACTERS","ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");class s{static union(t,e){var s=e.s3[255&t],i=e.s2[255&(t>>=8)],r=e.s1[255&(t>>=8)];return((r=((r=((t=e.s0[255&(t>>=8)])>>16)+(r>>16)+((65535&t)+(65535&r)>>16)<<16|(65535&t)+(65535&r)&65535)>>16^i>>16)<<16|65535&(65535&r^65535&i))>>16)+(s>>16)+((65535&r)+(65535&s)>>16)<<16|(65535&r)+(65535&s)&65535}static xor(t,e){return(t>>16^e>>16)<<16|65535&(65535&t^65535&e)}static _encryptBlock(t,e){var i=t.left,r=t.right;const n=s.xor,o=s.union;i=n(i,e.p[0]),r=n(r,n(o(i,e),e.p[1])),i=n(i,n(o(r,e),e.p[2])),r=n(r,n(o(i,e),e.p[3])),i=n(i,n(o(r,e),e.p[4])),r=n(r,n(o(i,e),e.p[5])),i=n(i,n(o(r,e),e.p[6])),r=n(r,n(o(i,e),e.p[7])),i=n(i,n(o(r,e),e.p[8])),r=n(r,n(o(i,e),e.p[9])),i=n(i,n(o(r,e),e.p[10])),r=n(r,n(o(i,e),e.p[11])),i=n(i,n(o(r,e),e.p[12])),r=n(r,n(o(i,e),e.p[13])),i=n(i,n(o(r,e),e.p[14])),r=n(r,n(o(i,e),e.p[15])),i=n(i,n(o(r,e),e.p[16])),t.right=i,t.left=n(r,e.p[17])}static _decryptBlock(t,e){var i=t.left,r=t.right;const n=s.xor,o=s.union;i=n(i,e.p[17]),r=n(r,n(o(i,e),e.p[16])),i=n(i,n(o(r,e),e.p[15])),r=n(r,n(o(i,e),e.p[14])),i=n(i,n(o(r,e),e.p[13])),r=n(r,n(o(i,e),e.p[12])),i=n(i,n(o(r,e),e.p[11])),r=n(r,n(o(i,e),e.p[10])),i=n(i,n(o(r,e),e.p[9])),r=n(r,n(o(i,e),e.p[8])),i=n(i,n(o(r,e),e.p[7])),r=n(r,n(o(i,e),e.p[6])),i=n(i,n(o(r,e),e.p[5])),r=n(r,n(o(i,e),e.p[4])),i=n(i,n(o(r,e),e.p[3])),r=n(r,n(o(i,e),e.p[2])),i=n(i,n(o(r,e),e.p[1])),t.right=i,t.left=n(r,e.p[0])}static _init(t){const e=t.split("").map((function(t){return 255&t.charCodeAt(0)})),i=s.kb,r=s._encryptBlock;let n,o,a,A=0,l=0;var h={left:0,right:0};const d={p:i.p.slice(0).map((function(t){var i=e.length;let r;for(r=0;r<4;r++)l=l*s.POW8|e[A++%i];return(t>>16^l>>16)<<16|65535&(65535&t^65535&l)})),s0:i.s0.slice(0),s1:i.s1.slice(0),s2:i.s2.slice(0),s3:i.s3.slice(0)};for(n=0,a=d.p.length;n<a;)r(h,d),d.p[n++]=h.left,d.p[n++]=h.right;for(n=0;n<4;n++)for(o=0,a=d["s"+n].length;o<a;)r(h,d),d["s"+n][o++]=h.left,d["s"+n][o++]=h.right;return d}static encrypt(t,i){const r=s._encryptBlock;var n=s._init(i),o=8-(7&t.length);for(let e=0;e<o;e++)t+=String.fromCharCode(o);let a=0;const A=[],l=t.length>>3,h={left:null,right:null};for(let e=0;e<l;e++)h.left=t.charCodeAt(a)*s.POW24|t.charCodeAt(a+1)*s.POW16|t.charCodeAt(a+2)*s.POW8|t.charCodeAt(a+3),h.right=t.charCodeAt(a+4)*s.POW24|t.charCodeAt(a+5)*s.POW16|t.charCodeAt(a+6)*s.POW8|t.charCodeAt(a+7),r(h,n),A.push(h.left>>24&255),A.push(h.left>>16&255),A.push(h.left>>8&255),A.push(255&h.left),A.push(h.right>>24&255),A.push(h.right>>16&255),A.push(h.right>>8&255),A.push(255&h.right),a+=8;return e.encode(A)}static decrypt(t,i){const r=s._decryptBlock;var n=s._init(i);const o=[];var a=e.decode(t);let A=0;var l=a.length>>3;const h={left:null,right:null};for(let t=0;t<l;t++){h.left=a[A]*s.POW24|a[A+1]*s.POW16|a[A+2]*s.POW8|a[A+3],h.right=a[A+4]*s.POW24|a[A+5]*s.POW16|a[A+6]*s.POW8|a[A+7],r(h,n);var d=h.left,c=h.right;o.push(d>>24&255),o.push(d>>16&255),o.push(d>>8&255),o.push(255&d),o.push(c>>24&255),o.push(c>>16&255),o.push(c>>8&255),o.push(255&c),A+=8}return o[o.length-1]!==o[o.length-2]&&1!==o[o.length-1]||(t=o[o.length-1],o.splice(o.length-t,t)),o.map((function(t){return String.fromCharCode(t)})).join("")}}QS(s,"POW2",Math.pow(2,2)),QS(s,"POW3",Math.pow(2,3)),QS(s,"POW4",Math.pow(2,4)),QS(s,"POW8",Math.pow(2,8)),QS(s,"POW16",Math.pow(2,16)),QS(s,"POW24",Math.pow(2,24)),QS(s,"kb",{p:[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],s0:[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],s1:[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],s2:[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],s3:[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],k:[202,218,204,100]});const i=String.fromCharCode(100,107,100,108);class r{constructor(t){QS(this,"_gk",void 0),this._gk=null!=t?t:i}_ldk(t){let e="";for(let s=0,i=t.length;s<i;s++)e+=String.fromCharCode(t[s]>>1);return e}get(){return this._gk+this._ldk(s.kb.k)}}t.r=class{static run(t,e){return e=new r(e).get(),s.encrypt(t,e)}};class n extends Error{}t.h=class{constructor(t,e){QS(this,"_gk",void 0),QS(this,"_code",void 0),QS(this,"_lic",void 0),this._gk=e,this._code=t,this._lic=this.run()}run(){const t={},e=s.decrypt(this._code,new r(this._gk).get()).split(";");for(let s=0,r=e.length;s<r;s++){var i=e[s].split("="),n=i[0];(i=i[1])&&0<i.length&&(t[n]=i)}return t}get lic(){return this._lic}is(t,e){return t in this._lic&&this._lic[t]===e}includes(t,e){return t in this._lic&&e.includes(this._lic[t])}expired(t,e){return!(t in this._lic)||!this._lic[t]||(t=this._lic[t],e=(e?new Date(new Date(t).setMonth(new Date(t).getMonth()+e)):new Date(t)).getTime(),t=Date.now(),!isNaN(e)&&e<t)}validate(t){let e=!1;try{t.forEach((t=>{const s=Object.keys(t),i=Object.values(t);s.forEach(((t,s)=>{if(s=i[s],e=Array.isArray(s)?this.includes(t,s):this.is(t,s),!e)throw new n}))}))}catch(t){if(!(t instanceof n))throw t;e=!1}return e}}}(US);var MS=function(t){return"RealReport를 사용하려면 도움말을 참조하세요.\nhttps://real-report.com/licenses (".concat((null==t?void 0:t.message)||t,")")},kS=function(t){var e=t.code,s=t.stop,i=t.msg,r="RealReport Error #".concat(e," : ").concat("https://real-report.com/errors","/").concat(e," ").concat(null!=i?i:"");if(s)throw new Error(r);return window.console&&console.warn(r),r},VS=/[|\\{}()[\]^$+*?.]/g,GS=function(t){if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(VS,"\\$&")},KS=/^\*\./,WS=/\.\*$/,zS=/\/.*$/,$S=/:(\d+)$/,XS=/^(\w+):\/\//,jS=/\\\.\\\*/g;function YS(t){if(!t||"string"!=typeof t)return null;var e=t.match(XS);e=e?e[1]:null;var s=(t=(t=t.replace(XS,"")).replace(zS,"")).match($S);return s=s?parseInt(s[1],10):null,{protocol:e,url:t=t.replace($S,""),port:s}}var JS=function(t,e){return Array.isArray(e)||(e=[e]),e.some((e=>function(t,e){if(!t||!e)return!1;var s=!e.protocol||!t.protocol||e.protocol===t.protocol,i=!e.port||t.port===e.port,r=e.url.startsWith("."),n=e.url.endsWith("."),o="^";return r&&(o+=".+"),o+=GS(e.url).replace(jS,"\\..*"),n&&(o+=".+"),o+="$",new RegExp(o).test(t.url)&&s&&i}(YS(t),function(t){var e=YS(t);return e&&(e.url=e.url.replace(KS,"."),e.url=e.url.replace(WS,".")),e}(e))))},ZS=location?location.hostname:void 0,qS=function(t){return Array.isArray(t)?t.every(qS):!(t.startsWith(".")||t.endsWith(".")||t.endsWith("*")||-1!==t.indexOf(".*.")||-1!==t.indexOf("..")||-1!==t.indexOf("*.com")||-1!==t.indexOf("*.co.kr")||-1!==t.indexOf("*.kr")||-1!==t.indexOf("*.net"))},tI=function(t){var e=t.split(",").filter(Boolean);return!!qS(e)&&(ZS||kS({code:214,stop:!0,msg:"Unknown host domain"}),JS(ZS,e))},eI="@realgrid/realreport-viewer",sI="1.4.1",iI="RealReport Runtime Viewer",rI="UNLICENSED",nI={name:"Wooritech",url:"https://real-report.com",email:"support@realgrid.com"},oI="https://real-report.com",aI="dist/realreport.es.js",AI="dist/realreport.d.ts",lI=["reports","dataviz","visualization","realreport","realgrid"],hI={registry:"https://npm.pkg.github.com"},dI={type:"git",url:"git://github.com/realgrid/realreport-viewer.git"},cI=["dist/**/*"],uI={clean:"rimraf dist dist.js/realreport .zpack/realreport-latest.tgz .npm/dist",makehash:"git rev-parse --short HEAD > .commithash",zpack:"node scripts/zpack.js",build:"npm run makehash && npm run clean && rollup -c ./scripts/rollup/rollup.product.config.js","build:webroot":"rimraf webroot/js/realreport && rollup -c ./scripts/rollup/rollup.webroot.config.js --watch","build:example":"rimraf webroot/js/realreport && rollup -c ./scripts/rollup/rollup.example.config.js","build:e2e":"rimraf e2e/js/realreport && rollup -c ./scripts/rollup/rollup.e2e.config.js --watch","build:service":"rimraf ../realreport-service/public/static/realreport/current/ && rollup -c ./scripts/rollup/rollup.service.config.js","web:e2e":"npx live-server e2e --port=6080 --host=localhost",test:"jest --config jest.config.ts",e2e:"run-p build:e2e web:e2e",cover:"c8 -o ./.coverage node .build/tests/index.js"},pI={"@babel/core":"^7.16.5","@babel/preset-env":"^7.16.5","@playwright/test":"^1.22.2","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^21.0.1","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.1.1","@rollup/plugin-replace":"^3.0.0","@rollup/plugin-typescript":"^8.3.0","@types/copyfiles":"^2.4.1","@types/jest":"^27.0.3","@types/node":"^17.0.0","@types/tldjs":"^2.3.1","@typescript-eslint/eslint-plugin":"^5.8.1","@typescript-eslint/parser":"^5.8.1","@vercel/ncc":"^0.33.0","@wooritech/rockhammer":"^1.0.12",c8:"^7.10.0",copyfiles:"^2.4.1",eslint:"^8.5.0","eslint-plugin-jest":"^25.3.2",jest:"^27.4.5",jszip:"^3.7.1","match-url-wildcard":"0.0.4","npm-packlist":"^3.0.0","npm-run-all":"^4.1.5",prettier:"^2.5.1",rimraf:"^3.0.2",rollup:"^2.61.1","rollup-plugin-copy":"^3.4.0","rollup-plugin-css-bundle":"^1.0.4","rollup-plugin-dts":"^4.0.1","rollup-plugin-sizes":"^1.0.4","rollup-plugin-terser":"^7.0.2","ts-jest":"^27.1.2","ts-node":"^10.4.0",tslib:"^2.3.1",typescript:"^4.5.4"},_I={highcharts:"^10.x"},gI={},fI={name:eI,version:sI,description:iI,license:rI,author:nI,homepage:oI,main:aI,types:AI,keywords:lI,publishConfig:hI,repository:dI,files:cI,scripts:uI,devDependencies:pI,peerDependencies:_I,dependencies:gI},mI=Object.freeze({__proto__:null,name:eI,version:sI,description:iI,license:rI,author:nI,homepage:oI,main:aI,types:AI,keywords:lI,publishConfig:hI,repository:dI,files:cI,scripts:uI,devDependencies:pI,peerDependencies:_I,dependencies:gI,default:fI}),wI={zoom:1},yI={type:"hwp"},CI={type:"png"},bI=function(){function t(t,e){void 0===e&&(e=wI),this._cm=!1,this._currentPage=1,this.$_checkL(),t||kS({code:213,stop:!0}),this.containerId=t,this._container=new hp(t),this._container.zoom=e.zoom}return t.prototype._checkPrintContainer=function(t){this._container.pages||kS({code:217,stop:!0,msg:"Page does not exist in the viewer"}),t&&Array.isArray(t)&&t.length>0&&t.map((function(t){t.is&&kS(t.errorParams)}))},t.prototype._checkPrintContainerZoom=function(){1!==this._container.zoom&&kS({code:219,stop:!0,msg:"페이지 배율 값이 100%인 경우만 내보내기가 가능합니다. 페이지 배율 값이 100%인지 확인해 주세요."})},Object.defineProperty(t.prototype,"containerId",{get:function(){return this._containerId},set:function(t){this._containerId="string"==typeof t?t:t.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return null==mI?void 0:sI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoom",{get:function(){return this._container.zoom},set:function(t){this._container.zoom=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageCount",{get:function(){return this._container.pageCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"page",{get:function(){return this._currentPage},set:function(t){t!==this.page&&(this._container.page=t-1,this._currentPage=Math.max(1,Math.min(t,this.pageCount)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reportHtml",{get:function(){return this._checkPrintContainer(),this._container.getPrintHtml()},enumerable:!1,configurable:!0}),t.prototype.getHtml=function(){return this._checkPrintContainer(),this._container.getPrintHtml()},t.prototype.first=function(){this._checkPrintContainer(),this.page=1},t.prototype.prev=function(){this._checkPrintContainer(),this.page--},t.prototype.next=function(){this._checkPrintContainer(),this.page++},t.prototype.last=function(){this._checkPrintContainer(),this.page=this._container.pageCount},t.prototype.zoomIn=function(t){void 0===t&&(t=.1),this._checkPrintContainer(),this._container.zoom+=t},t.prototype.zoomOut=function(t){void 0===t&&(t=.1),this._checkPrintContainer(),this._container.zoom-=t},t.prototype.fitToHeight=function(){this._checkPrintContainer(),this._container.fitToHeight()},t.prototype.fitToPage=function(){this._checkPrintContainer(),this._container.fitToPage()},t.prototype.fitToWidth=function(){this._checkPrintContainer(),this._container.fitToWidth()},t.prototype.$_checkL=function(){var t=null,e="";try{e="undefined"!=typeof process&&process.env&&process.env.hasOwnProperty("realReportLic")?process.env.realReportLic:realReportLic||void 0,t=new US.h(e)}catch(t){return void kS({code:200,stop:!0,msg:MS(t)})}this._cm=null!==t&&t.validate([{name:"RealReport",lic:["Enterprise"]}])&&tI(t.lic.server)||t.validate([{name:"RealReport",lic:["Subscription","Limited","Evaluation"]}])&&!t.expired("expire",1)&&tI(t.lic.server),this._cm||kS({code:200,stop:!0,msg:MS()})},t}(),vI=bI,BI=function(){function t(){this._blobstream=null,this._blob=null}return Object.defineProperty(t.prototype,"stream",{get:function(){return this._blobstream||(this._blobstream=new window.blobStream),this._blobstream},enumerable:!1,configurable:!0}),t.prototype.blob=function(){return r(this,void 0,void 0,(function(){var t=this;return n(this,(function(e){return[2,new Promise((function(e,s){t._blobstream.on("finish",(function(){t._blob=t._blobstream.toBlob("application/pdf"),t._url=window.URL.createObjectURL(t._blob),e(t._blobstream)}))}))]}))}))},t.prototype.open=function(){return r(this,void 0,void 0,(function(){return n(this,(function(t){return this._url&&window.open(this._url),[2]}))}))},t.prototype.url=function(){return this._url},t.prototype.download=function(t){return r(this,void 0,void 0,(function(){var e;return n(this,(function(s){return this._url&&(e=document.createElement("a"),document.body.appendChild(e),e.href=this._url,e.download=t,e.style.position="fixed",e.target="_blank",e.click(),document.body.removeChild(e)),[2]}))}))},t}(),EI="페이지 배율 값이 100%인 경우만 내보내기가 가능합니다. 페이지 배율 값이 100%인지 확인해 주세요.",PI=function(t){function e(e,s,i,r){var n=t.call(this,e,r)||this;return n.reportForm=s,n.dataSet=i,n}return s(e,t),Object.defineProperty(e.prototype,"reportForm",{get:function(){return this._reportForm},set:function(t){this._report&&(this._report=null),this._reportForm=t,this._report=(new HA).load(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataSet",{get:function(){return this._dataSet},set:function(t){this._reportDataProvider&&(this._reportDataProvider=null),this._dataSet=t,this._reportDataProvider=new qa,"object"==typeof t&&this._reportDataProvider.load(t)},enumerable:!1,configurable:!0}),e.prototype.preview=function(t){var e;void 0===t&&(t={async:!0,pageMark:!0,noScroll:!1}),this._checkReport();var s=i({report:this._report,data:this._reportDataProvider,preview:!0,id:this.containerId},t);null===(e=this._container)||void 0===e||e.print(s)},e.prototype.exportPdf=function(t){return r(this,void 0,void 0,(function(){var e,s,i,r,o;return n(this,(function(n){switch(n.label){case 0:return this._checkPrintContainer([{is:1!==this._container.zoom,errorParams:{code:219,stop:!0,msg:EI}}]),e=t.fonts,s=t.filename,i=t.preview,r=new BI,o=r.stream,(new lE).export(this._report,this._container.pages,e,o),[4,r.blob()];case 1:return n.sent(),i?[4,r.open()]:[3,3];case 2:n.sent(),n.label=3;case 3:return s?[4,r.download(s)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2,r.stream]}}))}))},e.prototype.exportImage=function(t){void 0===t&&(t=CI),this._checkPrintContainer([{is:1!==this._container.zoom,errorParams:{code:219,stop:!0,msg:EI}}]),(new hv).export(this._report,this._container.pages,t)},e.prototype.exportDocument=function(t){void 0===t&&(t=yI),this._checkPrintContainer([{is:1!==this._container.zoom,errorParams:{code:219,stop:!0,msg:EI}}]),(new HS).export(this._report,this._container.pages,t)},e.prototype._checkReport=function(){this._report||kS({code:216,stop:!0,msg:"RealReport did not load"})},e}(vI),xI=function(){function t(t){this._grid=t}return Object.defineProperty(t.prototype,"values",{get:function(){for(var t=[],e=this._grid.getItemCount(),s=0;s<e;s++)t.push(this._grid.getDisplayValues(s,!0));return t},enumerable:!1,configurable:!0}),t}(),SI=function(){function t(){this._itemCreator={text:function(t){return new ur(t)}}}return t.prototype._setItemPositions=function(t,e){return t&&e&&(e.left&&t.setLeft(new C(e.left)),e.top&&t.setTop(new C(e.top)),e.right&&t.setRight(new C(e.right)),e.bottom&&t.setBottom(new C(e.bottom))),t},t.prototype._setItemProps=function(t,e){return this._setItemPositions(t,e),e.text&&t.setProperty("text",e.text),e.value&&t.setProperty("value",e.value),e.height&&t.setProperty("height",e.height),e.prefix&&t.setProperty("prefix",e.prefix),t},t.prototype._setItemStyles=function(t,e){if(t&&e)for(var s=0,i=Object.entries(e);s<i.length;s++){var r=i[s],n=r[0],o=r[1];t.setStyleProperty(n,o)}return t},t.prototype.createItem=function(t){var e,s="string"==typeof t?t:null!==(e=t.type)&&void 0!==e?e:"text",i=t.name,r=this._itemCreator[s],n=r&&r(i);if(this._setItemProps(n,t),t.styles&&this._setItemStyles(n,t.styles),!n)throw new Error("지원하지 않는 GridReportItem 입니다.");return n},t.prototype.createHichartSeries=function(t,e){throw new Error("지원하지 않는 GridReportItem 입니다.")},t}(),II=function(){function t(t,e){var s=e.getDataColumns(!0);this._columns=s.filter((function(e){var s;return!(null===(s=null==t?void 0:t.exclude)||void 0===s?void 0:s.includes(e.name))}))}return Object.defineProperty(t.prototype,"count",{get:function(){return this._columns.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this._columns},enumerable:!1,configurable:!0}),t}(),RI={zoom:1,layout:{autoWidth:!0}},TI=new SI,OI=function(t){function e(e,s,i){void 0===i&&(i=RI);var r=t.call(this,e,i)||this;r._grid=s._view,r._options=i,r._gridValues=new xI(s),r.reportForm={},i&&i.paper&&(r._report.paper.orientation=i.paper.orientation||FA.PORTRAIT),r.dataSet={Data1:{type:"band",values:r._gridValues.values}};return r._report.addListener({onReportItemAdded:function(t,e,s){}}),r}return s(e,t),e.prototype.preview=function(e){void 0===e&&(e={async:!1,pageMark:!1,noScroll:!0}),this._prepare(),t.prototype.preview.call(this,e)},e.prototype._addTitle=function(t){if(t){var e=TI.createItem(t);this._report.page.reportHeader.add(e)}},e.prototype._addGridHeader=function(t){if(t){var e=new rr("box");e.width="100%",t.items.map((function(t){var s=TI.createItem(t);e.add(s)})),this._report.page.body.itemsContainer.add(e)}},e.prototype._addPageHeader=function(t){var e=this;t&&t.items.map((function(t){var s=TI.createItem(t);e._report.page.pageHeader.add(s)}))},e.prototype._addGridTable=function(){var t=this,e=new tn("table"),s=this._grid.activeCellLayout,i=new II(this._options.layout,s);e.colCount=i.count,e.data="Data1";var r=0;i.columns.forEach((function(s){var i;if(s.visible){var n=s.name,o=r++,a=s.header.text,A=new ur("col-header-".concat(o));A.text=a,A.setChildProp("row",0),A.setChildProp("col",o),e.header.add(A),(null===(i=t._options.layout)||void 0===i?void 0:i.autoWidth)&&(e.columns.get(o).width=s.width),e.header.cells.items[o].setStyle("backgroundColor","rgb(228, 231, 235)");var l=new ur("col-data-item-".concat(o));l.data=e.data,l.value=n,l.setChildProp("row",0),l.setChildProp("col",o),e.dataRow.add(l)}})),i.count>0&&(e.header.cellStyles={paddingTop:"10px"},e.dataRow.cellStyles={paddingTop:"2px"}),this._report.page.body.itemsContainer.add(e)},e.prototype._prepare=function(){var t=this._options;this._addTitle(t.title),this._addTitle(t.subTitle),this._addGridHeader(t.gridHeader),this._addGridTable(),this._addPageHeader(t.pageHeader)},e}(PI),FI=function(t){function e(e,s,i){var r=t.call(this,e,i)||this;return r._reportFormSets=s,r}return s(e,t),e.prototype.preview=function(t){var e;void 0===t&&(t={async:!1,pageMark:!1,noScroll:!0}),this._checkReportFormSet(),this._reports=this._reportFormSets.map((function(t){return{report:(new HA).load(t.form),data:t.dataSet?(new qa).load(t.dataSet):null}}));var s=i({report:this._reports,data:null,preview:!0,id:this.containerId},t);null===(e=this._container)||void 0===e||e.print(s)},e.prototype.exportPdf=function(t){return r(this,void 0,void 0,(function(){return n(this,(function(t){return kS({code:300,stop:!1,msg:"This feature is coming soon."}),[2]}))}))},e.prototype.exportImage=function(t){kS({code:300,stop:!1,msg:"This feature is coming soon."})},e.prototype.exportDocument=function(t){kS({code:300,stop:!1,msg:"This feature is coming soon."})},e.prototype._checkReportFormSet=function(){this._reportFormSets&&0!==this._reportFormSets.length||kS({code:218,stop:!0,msg:"ReportForm does not exist in the viewer"})},e}(vI);return t.GridReportViewer=OI,t.ReportCompositeViewer=FI,t.ReportViewer=PI,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
