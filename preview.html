<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>RealReport Print Preview</title>
        <link rel="shortcut icon" href="#" />

        <link href="css/preview.css" rel="stylesheet" />
        <!-- ÌïòÏù¥Ï∞®Ìä∏Ïùò Í∏∞Î≥∏ Ïä§ÌÉÄÏùº Î≥ÄÍ≤ΩÌïòÎ†§Î©¥ ÏïÑÎûò ÌååÏùºÏùÑ ÏàòÏ†ïÌïòÎ©¥ Îê©ÎãàÎã§. -->
        <!-- <link href='js/highcharts/highcharts.css' rel='stylesheet' /> -->
        <link href="js/realreport/realreport.css" rel="stylesheet" />
        <script
            type="text/javascript"
            src="js/highcharts/highcharts.js"
        ></script>
        <script
            type="text/javascript"
            src="js/highcharts/highcharts-more.js"
        ></script>
        <script type="text/javascript" src="js/pdfkit.js"></script>
        <script type="text/javascript" src="datas/salary-data.js"></script>
        <script type="text/javascript" src="forms/salary.js"></script>
        <script
            type="text/javascript"
            src="js/realreport/realreport.js"
        ></script>

        <!-- ÎÑ§Ïù¥Î≤Ñ ÏßÄÎèÑ API -->
        <script
            type="text/javascript"
            src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=q096ieut17"
        ></script>
    </head>

    <body>
        <div class="root">
            <div class="container">
                <div class="main">
                    <div class="main-content">
                        <div class="preview-toolbar">
                            <div class="toolbar-scrolller">
                                <div class="toolbar-left">
                                    <div class="toolbar-items">
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickZoomOut10();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-zoomout-png"
                                            ></div>
                                        </a>
                                        <input
                                            part="input"
                                            type="text"
                                            value="100%"
                                            id="inputZoomScale"
                                            aria-label="Zoom Scale"
                                            class="mobile-hidden"
                                        />
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickZoomIn10();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-zoomin-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickZoom100();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-100-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickFitToWidth();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-fit-to-width-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickFitToHeight();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-fit-to-height-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickFitToPage();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-fit-to-page-png"
                                            ></div>
                                        </a>
                                    </div>
                                </div>
                                <div class="toolbar-center">
                                    <div class="toolbar-items">
                                        <a
                                            class="toolbar-icon-button mobile-hidden"
                                            onclick="onClickFirstPage();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-first-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button mobile-hidden"
                                            onclick="onClickPrevPage();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-prev-png"
                                            ></div>
                                        </a>
                                        <div class="toolbar-item mobile-hidden">
                                            <input
                                                part="input"
                                                type="text"
                                                value="1"
                                                id="inputPageNumber"
                                                aria-label="Page number"
                                            />
                                            <span style="margin: 0 4px">/</span>
                                            <span
                                                style="margin: 0 4px"
                                                id="totalpage"
                                                >1</span
                                            >
                                        </div>
                                        <a
                                            class="toolbar-icon-button mobile-hidden"
                                            onclick="onClickNextPage();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-next-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button mobile-hidden"
                                            onclick="onClickLastPage();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-last-png"
                                            ></div>
                                        </a>
                                    </div>
                                </div>
                                <div class="toolbar-right">
                                    <div
                                        id="printPopup"
                                        class="toolbar-items mobile-gap"
                                    >
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickPrintPopup()"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-print-png"
                                            ></div>
                                        </a>
                                    </div>
                                    <span class="vertical-separator"></span>
                                    <div class="toolbar-items mobile-gap">
                                        <a
                                            class="toolbar-icon-button mobile-hidden"
                                            onclick="onClickPrintHiddenFrame()"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-print-png"
                                            ></div>
                                        </a>
                                    </div>
                                    <span
                                        class="vertical-separator mobile-hidden"
                                    ></span>
                                    <div class="toolbar-items mobile-gap">
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickExportPdf();"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-pdf-png"
                                            ></div>
                                        </a>
                                        <!-- <a
                                            class="toolbar-icon-button mobile-hidden"
                                            onclick="onClickExportDoc('hwp');"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-hwp-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button mobile-hidden"
                                            onclick="onClickExportDoc('docx');"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-docx-png"
                                            ></div>
                                        </a> -->
                                        <!-- <a class="toolbar-icon-button mobile-hidden" onclick="onClickExportDoc('pptx');">
                                        <div class="toolbar-icon icon preview-pptx-png"></div>
                                    </a> -->
                                    </div>
                                    <!-- <span class="vertical-separator"></span> -->
                                    <!-- <div class="toolbar-items mobile-gap">
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickExportImage('png');"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-png-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickExportImage('jpeg');"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-jpeg-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button"
                                            onclick="onClickExportImage('gif');"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-gif-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button mobile-hidden"
                                            onclick="onClickExportImage('tiff', 'g3');"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-tiffg3-png"
                                            ></div>
                                        </a>
                                        <a
                                            class="toolbar-icon-button mobile-hidden"
                                            onclick="onClickExportImage('tiff', 'g4');"
                                        >
                                            <div
                                                class="toolbar-icon icon preview-tiffg4-png"
                                            ></div>
                                        </a>
                                    </div> -->
                                </div>
                            </div>
                        </div>
                        <div class="scroller">
                            <div id="realreport"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script type="text/javascript">
            // ÏïÑÎûò ÎùºÏù¥ÏÑ†Ïä§Îäî Ïú†Ìö®Í∏∞Í∞Ñ 2025ÎÖÑ 5Ïõî 31Ïùº ÍπåÏßÄ localhost,127.0.0.1,realreport.co.kr,real-report.com ÎèÑÎ©îÏù∏ÏóêÏÑú ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎäî ÎùºÏù¥ÏÑ†Ïä§ ÏûÖÎãàÎã§.
            var realReportLic =
                'upVcPE+wPOn1V3OcjC3PuAUt7xtLcP5XVzS0GnpZwpnbdxrzWi3SH9lnNreNwRub/31bQcGrnP/Nq/NkIKx9AkkSD8KWTVlm9aI3507Qm2POAklYqFD9ZGXyjOMqbrgvr3+iyFPC2UvKqt1f0nYq0Fe/mONIYEy4CkGU/2dJ94leC1UWt2Y/gOPSfHZhPA2TCr/ODTGzdoYBrs4Ui2AU8g==';
            // RealReportÍ∞Ä ÏúÑÏπòÌï† Ïª®ÌÖåÏù¥ÎÑà ÏöîÏÜåÏùò id
            var containerId = 'realreport';
            // RealReport Viewer Í∞ùÏ≤¥ Î≥ÄÏàò
            var viewer;

            //--------------------------------------------------------------------------------------------------
            // public methods
            //--------------------------------------------------------------------------------------------------

            var hidePrintPopup = function () {
                const popupBtn = document.getElementById('printPopup');
                popupBtn.style.display = 'none';
            };
            /**
             * Î¶¨Ìè¨Ìä∏ Ïª®ÌÖåÏù¥ÎÑà Î∞è viewer Í∞ùÏ≤¥Î•º Ï¥àÍ∏∞Ìôî ÌïòÎäî Ìï®Ïàò
             * */
            var clearReport = function () {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                delete viewer;
            };

            const setHtml = function (id, value, prefix, surfix) {
                if (id) {
                    const el = document.getElementById(id);
                    if (el) el.innerHTML = `${prefix}${value}${surfix}`;
                }
            };

            const setTotalPage = function (id) {
                if (viewer) {
                    setHtml(id, viewer.pageCount, '', '');
                }
            };

            /**
             * Î¶¨Ìè¨Ìä∏ ÎØ∏Î¶¨Î≥¥Í∏∞ Ïã§Ìñâ
             * */
            var previewReport = function (reports, isMap) {
                clearReport();
                // Ïó¨Îü¨ ÏñëÏãùÏùÑ ÌïòÎÇòÏùò ÎØ∏Î¶¨Î≥¥Í∏∞Î°ú Ï∂úÎ†• ÌïòÍ∏∞ ÏúÑÌï¥ report Í∞ùÏ≤¥Î•º Î≥ÄÏàòÎ°ú ÎÑòÍ≤®Ï§ÄÎã§.
                if (Array.isArray(reports) && reports.length > 1) {
                    // Ïó¨Îü¨ ÏñëÏãù Î¶¨Ìè¨Ìä∏Îäî ReportCompositeViewer Í∞ùÏ≤¥Î•º Ïù¥Ïö©ÌïúÎã§.
                    // ÏÉùÏÑ± Ïù∏ÏûêÎäî Ïª®ÌÖåÏù¥ÎÑàIdÏôÄ reportÍ∞ùÏ≤¥
                    // ÎèÑÏõÄÎßê Ï∞∏Ï°∞ üí° https://real-report.com/docs/api/ReportCompositeViewer
                    viewer = new RealReport.ReportCompositeViewer(
                        containerId,
                        reports,
                    );
                } else {
                    // Îã®Ïùº ÏñëÏãù Î¶¨Ìè¨Ìä∏Îäî ReportViewer Í∞ùÏ≤¥Î•º Ïù¥Ïö©ÌïúÎã§.
                    // ÏÉùÏÑ±Ïù∏ÏûêÎäî Ïª®ÌÖåÏù¥ÎÑàId, Î¶¨Ìè¨Ìä∏ ÏñëÏãù, Îç∞Ïù¥ÌÑ∞
                    // ÎèÑÏõÄÎßê Ï∞∏Ï°∞ üí° https://real-report.com/docs/api/ReportViewer
                    viewer = new RealReport.ReportViewer(
                        containerId,
                        reports.form,
                        reports.dataSet,
                    );
                }

                // async: trueÏù∏ Í≤ΩÏö∞ Îß§ ÌéòÏù¥ÏßÄÍ∞Ä ÎØ∏Î¶¨Î≥¥Í∏∞Îê†Îïå ÎßàÎã§ Ìò∏Ï∂úÎêòÎäî ÏΩúÎ∞± Ìï®Ïàò
                const pageCallback = (ctx, page, pageNo) => {
                    console.log(`${pageNo} ÌéòÏù¥ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏôÑÎ£å`);
                };

                // async: trueÏù∏ Í≤ΩÏö∞ Î™®Îì† ÌéòÏù¥ÏßÄÏùò ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä ÏôÑÎ£åÎê†Îïå Ìò∏Ï∂úÎêòÎäî ÏΩúÎ∞± Ìï®Ïàò
                const endCallback = (ctx, pages) => {
                    console.log('Î™®Îì† ÌéòÏù¥ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏôÑÎ£å');
                    setTotalPage('totalpage');
                    setZoomScaleInputValue('inputZoomScale');
                    setPageInputValue('inputPageNumber');
                    if (window.innerWidth < 768) {
                        viewer.fitToWidth();
                        viewer.zoom = viewer.zoom - 0.01;
                    }

                    if (reports?.form?.report?.name === 'duam') {
                        var container = document.getElementById('daum');
                        var options = {
                            center: new kakao.maps.LatLng(37.3871, 127.1134),
                            level: 3,
                        };
                        var map = new kakao.maps.Map(container, options);

                        var markerPosition = new kakao.maps.LatLng(
                            37.3871,
                            127.1134,
                        );
                        var marker = new kakao.maps.Marker({
                            position: markerPosition,
                        });
                        marker.setMap(map);
                    }

                    if (reports?.form?.report?.name === 'naver') {
                        var mapOptions = {
                            center: new naver.maps.LatLng(
                                37.392020,
                                127.078172,
                            ),
                            zoom: 18,
                        };

                        var map = new naver.maps.Map('map', mapOptions);

                        const marker = new naver.maps.Marker({
                            position: new naver.maps.LatLng(
                                37.392020,
                                127.078172,
                            ),
                            map: map,
                            title: '(Ï£º)Ïö∞Î¶¨ÌÖåÌÅ¨Ïù∏ÌÑ∞ÎÇ¥ÏÖîÎÇ†',
                        });
                    }
                };

                // ÎØ∏Î¶¨Î≥¥Í∏∞ Ìï®Ïàò preview() Ìò∏Ï∂ú
                // Ìò∏Ï∂ú Ïù∏ÏûêÎäî PreviewOptionsÎ°ú ÏûêÏÑ∏Ìïú ÏÜçÏÑ±ÏùÄ ÎèÑÏõÄÎßê Ï∞∏Ï°∞
                // üí° https://real-report.com/docs/api/ReportViewer#preview
                if (viewer)
                    viewer.preview({
                        async: true,
                        pageMark: false,
                        noScroll: true,
                        callback: pageCallback,
                        endCallback: endCallback,
                    });

                return viewer;
            };

            /**
             * RealGrid Î¶¨Ìè¨Ìä∏ ÎØ∏Î¶¨Î≥¥Í∏∞ Ïã§Ìñâ
             * ÎèÑÏõÄÎßê Ï∞∏Ï°∞ üí° https://real-report.com/docs/api/GridReportViewer#preview
             * */
            var previewGridReport = function (grid, options) {
                clearReport();

                if (grid) {
                    viewer = new RealReport.GridReportViewer(
                        containerId,
                        grid,
                        options,
                    );
                }

                const pageCallback = (ctx, page, pageNo) => {
                    console.log(`${pageNo} ÌéòÏù¥ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏôÑÎ£å`);
                };

                const endCallback = (ctx, pages) => {
                    console.log('Î™®Îì† ÌéòÏù¥ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏôÑÎ£å');
                    setTotalPage('totalpage');
                    setPageInputValue('inputPageNumber');
                    setZoomScaleInputValue('inputZoomScale');
                };

                if (viewer)
                    viewer.preview({
                        async: true,
                        pageMark: false,
                        noScroll: true,
                        callback: pageCallback,
                        endCallback,
                    });

                return viewer;
            };

            /**
             * Ïù∏ÏáÑÎ•º ÏúÑÌï¥ Î≥ÑÎèÑ ÌéòÏù¥ÏßÄÎ°ú ÎØ∏Î¶¨Î≥¥Í∏∞ ÌïòÎäî Î∞©Î≤ï
             * ÎèÑÏõÄÎßê Ï∞∏Ï°∞ üí° https://real-report.com/docs/api/ReportViewer#print
             * */
            var printPopup = function () {
                if (viewer) {
                    const w = Math.min(screen.width, 1024);
                    const h = Math.min(screen.height, 768);
                    const x = (screen.width - w) / 2;
                    const y = (screen.height - h) / 2;
                    const win = window.open(
                        './print.html',
                        'print',
                        'left=' +
                            x +
                            ',top=' +
                            y +
                            ',width=' +
                            w +
                            ',height=' +
                            h,
                    );

                    // ÌéòÏù¥ÏßÄÍ∞Ä Î°úÎìúÎêú Îã§Ïùå Ï¶âÏãú ÌîÑÎ¶∞Ìä∏ Ïã§Ìñâ
                    win.addEventListener('DOMContentLoaded', function (e) {
                        const dom = win.document.getElementById('realreport');
                        dom.innerHTML = viewer.reportHtml;
                        // Ïã§Ï†ú ÌîÑÎ¶∞Ìä∏ Ìï®Ïàò Ìò∏Ï∂ú (ÏïÑÎûò Ï£ºÏÑù Ï†úÍ±∞)
                        win.print();
                    });

                    // ÌîÑÎ¶∞Ìä∏Ìïú Îã§Ïùå ÌåùÏóÖÏ∞Ω Îã´Í∏∞
                    win.addEventListener('afterprint', function (e) {
                        win.close();
                    });
                }
            };

            var initPreviewReport = function (reports) {
                clearReport();
                viewer = new RealReport.ReportViewer(
                    containerId,
                    reports[0].form,
                    reports[0].dataSet,
                );
                // async: trueÏù∏ Í≤ΩÏö∞ Îß§ ÌéòÏù¥ÏßÄÍ∞Ä ÎØ∏Î¶¨Î≥¥Í∏∞Îê†Îïå ÎßàÎã§ Ìò∏Ï∂úÎêòÎäî ÏΩúÎ∞± Ìï®Ïàò
                const pageCallback = (ctx, page, pageNo) => {
                    console.log(`${pageNo} ÌéòÏù¥ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏôÑÎ£å`);
                };

                // async: trueÏù∏ Í≤ΩÏö∞ Î™®Îì† ÌéòÏù¥ÏßÄÏùò ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä ÏôÑÎ£åÎê†Îïå Ìò∏Ï∂úÎêòÎäî ÏΩúÎ∞± Ìï®Ïàò
                const endCallback = (ctx, pages) => {
                    setTotalPage('totalpage');
                    setZoomScaleInputValue('inputZoomScale');
                    setPageInputValue('inputPageNumber');
                    if (window.innerWidth > 1024) {
                        viewer.fitToHeight();
                    } else {
                        viewer.fitToWidth();
                        viewer.zoom = viewer.zoom - 0.01;
                    }
                };

                if (viewer)
                    viewer.preview({
                        async: true,
                        pageMark: false,
                        noScroll: true,
                        callback: pageCallback,
                        endCallback: endCallback,
                    });

                return viewer;
            };
            //--------------------------------------------------------------------------------------------------
            // Ïù¥Î≤§Ìä∏ Ìï∏Îì§ÎßÅ
            //--------------------------------------------------------------------------------------------------

            /**
             * z ÎπÑÏú® ÎßåÌÅº ÌôïÎåÄ ÎòêÎäî Ï∂ïÏÜå
             * üí° https://real-report.com/docs/api/ReportViewer#zoom
             * */
            const onClickZoom = (z) => {
                if (viewer) {
                    viewer.zoom = z;
                }
            };

            /**
             * ÎØ∏Î¶¨Î≥¥Í∏∞ ÌôîÎ©¥ 10% ÌôïÎåÄ
             * üí° https://real-report.com/docs/api/ReportViewer#zoomin
             * */
            const onClickZoomIn10 = function () {
                if (viewer) {
                    viewer.zoomIn();
                    setZoomScaleInputValue('inputZoomScale');
                }
            };

            /**
             * ÎØ∏Î¶¨Î≥¥Í∏∞ ÌôîÎ©¥ 10% Ï∂ïÏÜå
             * üí° https://real-report.com/docs/api/ReportViewer#zoomout
             * */
            const onClickZoomOut10 = function () {
                if (viewer) {
                    viewer.zoomOut();
                    setZoomScaleInputValue('inputZoomScale');
                }
            };

            /**
             * ÎØ∏Î¶¨Î≥¥Í∏∞ ÌôîÎ©¥ 1:1 ÎπÑÏú®
             * üí° https://real-report.com/docs/api/ReportViewer#zoomout
             * */
            const onClickZoom100 = function () {
                if (viewer) {
                    viewer.zoom = 1;
                    setZoomScaleInputValue('inputZoomScale');
                }
            };

            /**
             * ÎØ∏Î¶¨Î≥¥Í∏∞ ÌéòÏù¥ÏßÄ ÌÅ¨Í∏∞Î•º Ïª®ÌÖåÏù¥ÎÑà ÎÜíÏù¥Ïóê ÎßûÍ≤å Ï°∞Ï†ï
             * üí° https://real-report.com/docs/api/ReportViewer#fittoheight
             * */
            const onClickFitToHeight = function () {
                if (viewer) {
                    viewer.fitToHeight();
                    setZoomScaleInputValue('inputZoomScale');
                }
            };

            /**
             * ÎØ∏Î¶¨Î≥¥Í∏∞ ÌéòÏù¥ÏßÄ ÌÅ¨Í∏∞Î•º Ïª®ÌÖåÏù¥ÎÑà ÎÑàÎπÑÏóê ÎßûÍ≤å Ï°∞Ï†ï
             * üí° https://real-report.com/docs/api/ReportViewer#fittowidth
             * */
            const onClickFitToWidth = function () {
                if (viewer) {
                    viewer.fitToWidth();
                    setZoomScaleInputValue('inputZoomScale');
                }
            };

            /**
             * ÎØ∏Î¶¨Î≥¥Í∏∞ ÌéòÏù¥ÏßÄ ÌÅ¨Í∏∞Î•º Ïª®ÌÖåÏù¥ÎÑà ÎÑàÎπÑÏôÄ ÎÜíÏù¥Ïóê ÎßûÍ≤å Ï°∞Ï†ï
             * üí° https://real-report.com/docs/api/ReportViewer#fittopage
             * */
            const onClickFitToPage = function () {
                if (viewer) {
                    viewer.fitToPage();
                    setZoomScaleInputValue('inputZoomScale');
                }
            };

            /**
             * Ï≤´ Î≤àÏß∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
             * üí° https://real-report.com/docs/api/ReportViewer#first
             * */
            const onClickFirstPage = function () {
                if (viewer) {
                    viewer.first();
                    setPageInputValue('inputPageNumber');
                }
            };

            /**
             * ÎßàÏßÄÎßâ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
             * üí° https://real-report.com/docs/api/ReportViewer#last
             * */
            const onClickLastPage = function () {
                if (viewer) {
                    viewer.last();
                    setPageInputValue('inputPageNumber');
                }
            };

            /**
             * Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
             * üí° https://real-report.com/docs/api/ReportViewer#prev
             * */
            const onClickPrevPage = function () {
                if (viewer) {
                    viewer.prev();
                    setPageInputValue('inputPageNumber');
                }
            };

            /**
             * Îã§Ïùå ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
             * üí° https://real-report.com/docs/api/ReportViewer#next
             * */
            const onClickNextPage = function () {
                if (viewer) {
                    viewer.next();
                    setPageInputValue('inputPageNumber');
                }
            };

            /**
             * PDF ÎÇ¥Î≥¥ÎÇ¥Í∏∞
             * üí° https://real-report.com/docs/api/ReportViewer#exportpdf
             * */
            const onClickExportPdf = function () {
                base64convert('/js/pdffonts/NanumGothic.otf', true).then(
                    (regularFont) => {
                        base64convert(
                            '/js/pdffonts/NanumGothicBold.otf',
                            true,
                        ).then(async (boldFont) => {
                            const fonts = [
                                {
                                    name: 'regular',
                                    content: regularFont,
                                    style: 'normal',
                                    weight: 'normal',
                                },
                                {
                                    name: 'bold',
                                    content: boldFont,
                                    style: 'normal',
                                    weight: 'bold',
                                },
                            ];

                            if (viewer) {
                                const options = {
                                    fonts,
                                    filename: 'sample-report',
                                    preview: false,
                                    // ownerPassword: '!QAZXSW2', // ÏÜåÏú†Ïûê ÏïîÌò∏
                                    // userPassword: '1qazxsw2', // ÏÇ¨Ïö©Ïûê ÏïîÌò∏
                                    permissions: {
                                        printing: 'highResolution', // 'lowResolution' | 'highResolution' Ïù∏ÏáÑ ÌóàÏö© Ïó¨Î∂Ä
                                        modifying: true, // ÌååÏùº ÏàòÏ†ï ÌóàÏö© Ïó¨Î∂Ä
                                        copying: true, // ÌÖçÏä§Ìä∏ ÎòêÎäî Í∑∏ÎûòÌîΩ Î≥µÏÇ¨ ÌóàÏö© Ïó¨Î∂Ä
                                        annotating: true, // Ï£ºÏÑù Î∞è ÏñëÏãù ÏûëÏÑ± ÌóàÏö© Ïó¨Î∂Ä
                                        fillingForms: true, // ÏñëÏãù ÏûëÏÑ± Î∞è ÏÑúÎ™Ö ÌóàÏö© Ïó¨Î∂Ä
                                        contentAccessibility: true, // Ï†ëÍ∑ºÏÑ±ÏùÑ ÏúÑÌïú ÌÖçÏä§Ìä∏ Î≥µÏÇ¨ ÌóàÏö© Ïó¨Î∂Ä
                                        documentAssembly: true,
                                    },
                                    pdfVersion: '1.7ext3', // '1.3' | '1.4' | '1.5' | '1.6' | '1.7' | '1.7ext3'
                                };
                                viewer.zoom = 1;
                                viewer.exportPdf(options);
                            }
                        });
                    },
                );
            };

            /**
             * HWP, DOCX, PPTX Î¨∏ÏÑú ÎÇ¥Î≥¥ÎÇ¥Í∏∞
             * üí° https://real-report.com/docs/api/ReportViewer#exportdocument
             * */
            const onClickExportDoc = function (type) {
                if (viewer) {
                    viewer.exportDocument({ type });
                }
            };

            /**
             * PNG, JPEG, GIF, TIF, TIFF Ïù¥ÎØ∏ÏßÄ ÎÇ¥Î≥¥ÎÇ¥Í∏∞ Ìï®Ïàò
             * üí° https://real-report.com/docs/api/ReportViewer#exportimage
             * */
            const onClickExportImage = function (type, encoding, fileName) {
                if (viewer) {
                    var originZoom = viewer.zoom;
                    viewer.zoom = 1;
                    var options = { type };
                    if (encoding) options.tiff = { encoding };
                    if (fileName) options.fileName = fileName;
                    viewer.exportImage(options);
                    viewer.zoom = originZoom;
                }
            };

            /**
             * Ïà®Í≤®ÏßÑ iFrameÏùÑ Ïù¥Ïö©Ìï¥ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏÉÅÌÉúÏóêÏÑú Î∞îÎ°ú Ï∂úÎ†•
             * */
            const onClickPrintHiddenFrame = function () {
                if (viewer) {
                    function closePrint() {
                        document.body.removeChild(this.__container__);
                    }

                    function setPrint() {
                        this.contentWindow.__container__ = this;
                        this.contentWindow.onbeforeunload = closePrint;
                        this.contentWindow.onafterprint = closePrint;
                        const dom =
                            this.contentWindow.document.getElementById(
                                'realreport',
                            );
                        dom.innerHTML = viewer.reportHtml;

                        setTimeout(() => {
                            this.contentWindow.focus(); // Required for IE
                            this.contentWindow.print();
                        }, 1);
                    }

                    function printPage(sURL) {
                        var oHideFrame = document.createElement('iframe');
                        oHideFrame.onload = setPrint;
                        oHideFrame.style.position = '';
                        oHideFrame.style.right = '0';
                        oHideFrame.style.bottom = '0';
                        oHideFrame.style.width = '0';
                        oHideFrame.style.height = '0';
                        oHideFrame.style.border = '0';
                        oHideFrame.src = sURL;
                        document.body.appendChild(oHideFrame);
                    }

                    printPage('./print.html');
                }
            };

            const onClickPrintPopup = function () {
                printPopup();
            };

            //--------------------------------------------------------------------------------------------------
            // private methods
            //--------------------------------------------------------------------------------------------------

            const zoom = document.getElementById('inputZoomScale');
            zoom.addEventListener('change', (e) => {
                let zoom = e.target.value;
                if (zoom.endsWith('%')) zoom = zoom.replace('%', '');
                if (!isNaN(zoom)) {
                    viewer.zoom = zoom / 100;
                    setZoomScaleInputValue('inputZoomScale');
                }
            });

            const page = document.getElementById('inputPageNumber');
            page.addEventListener('change', (e) => {
                const page = e.target.value;
                if (!isNaN(page)) {
                    viewer.page = page;
                    setPageInputValue('inputPageNumber');
                }
            });

            const setInputValue = function (id, value, prefix, surfix) {
                if (id) {
                    const input = document.getElementById(id);
                    if (input)
                        input.value = `${prefix || ''}${value}${surfix || ''}`;
                }
            };

            const setZoomScaleInputValue = function (id) {
                setInputValue(id, Math.trunc(viewer.zoom * 100), '', '%');
            };

            const setPageInputValue = function (id) {
                if (viewer) {
                    setInputValue(id, viewer.page);
                }
            };

            async function base64convert(url, split) {
                const data = await fetch(url);
                const blob = await data.blob();

                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(blob);
                    reader.onloadend = () => {
                        const base64data = reader.result;
                        resolve(split ? base64data.split(',')[1] : base64data);
                    };
                });
            }
        </script>
    </body>
</html>
